<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>Build: Animated ProgressBar.cpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.4.7 -->
<div class="tabs">
  <ul>
    <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="classes.html"><span>Classes</span></a></li>
    <li id="current"><a href="files.html"><span>Files</span></a></li>
    <li><a href="dirs.html"><span>Directories</span></a></li>
    <li>
      <form action="search.php" method="get">
        <table cellspacing="0" cellpadding="0" border="0">
          <tr>
            <td><label>&nbsp;<u>S</u>earch&nbsp;for&nbsp;</label></td>
            <td><input type="text" name="query" value="" size="20" accesskey="s"/></td>
          </tr>
        </table>
      </form>
    </li>
  </ul></div>
<div class="tabs">
  <ul>
    <li><a href="files.html"><span>File&nbsp;List</span></a></li>
    <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
  </ul></div>
<div class="nav">
<a class="el" href="dir_3179ea33d55a76dc38212d9eab798728.html">export</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_e5664b4b56927c8728eb3192fa60e338.html">hdc2</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_1eb12a41a47efb9efcd82fa98f4f4dbd.html">FTP</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_80cc1f21a78ab7941088ea567f236150.html">ja2src</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_994ab287602efefceafe55287a3657d6.html">Build</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_993125ff2f564b24e9362451a2d9a95b.html">Utils</a></div>
<h1>Animated ProgressBar.cpp</h1><a href="Animated_01ProgressBar_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="preprocessor">#ifdef PRECOMPILEDHEADERS</span>
<a name="l00002"></a>00002 <span class="preprocessor"></span><span class="preprocessor">      #include "<a class="code" href="Utils_01All_8h.html">Utils All.h</a>"</span>
<a name="l00003"></a>00003 <span class="preprocessor">#else</span>
<a name="l00004"></a>00004 <span class="preprocessor"></span><span class="preprocessor">      #include "types.h"</span>
<a name="l00005"></a>00005 <span class="preprocessor">      #include "<a class="code" href="Animated_01ProgressBar_8h.html">Animated ProgressBar.h</a>"</span>
<a name="l00006"></a>00006 <span class="preprocessor">      #include "<a class="code" href="MemMan_8h.html">MemMan.h</a>"</span>
<a name="l00007"></a>00007 <span class="preprocessor">      #include "debug.h"</span>
<a name="l00008"></a>00008 <span class="preprocessor">      #include "<a class="code" href="Font_01Control_8h.html">Font Control.h</a>"</span>
<a name="l00009"></a>00009 <span class="preprocessor">      #include "<a class="code" href="vsurface_8h.html">vsurface.h</a>"</span>
<a name="l00010"></a>00010 <span class="preprocessor">      #include "<a class="code" href="video_8h.html">video.h</a>"</span>
<a name="l00011"></a>00011 <span class="preprocessor">      #include "<a class="code" href="Render_01Dirty_8h.html">Render Dirty.h</a>"</span>
<a name="l00012"></a>00012 <span class="preprocessor">      #include "music control.h"</span>
<a name="l00013"></a>00013 <span class="preprocessor">#endif</span>
<a name="l00014"></a>00014 <span class="preprocessor"></span>
<a name="l00015"></a><a class="code" href="Animated_01ProgressBar_8cpp.html#56c22717416a7f5b40b2b31e7d8c3018">00015</a> <span class="keywordtype">double</span> <a class="code" href="Animated_01ProgressBar_8cpp.html#56c22717416a7f5b40b2b31e7d8c3018">rStart</a>, <a class="code" href="Animated_01ProgressBar_8cpp.html#be9524c36ea941bd223c3a5095ff73ec">rEnd</a>;
<a name="l00016"></a><a class="code" href="Animated_01ProgressBar_8cpp.html#a938fbeb5cba1999a91310a5b01eb389">00016</a> <span class="keywordtype">double</span> <a class="code" href="Animated_01ProgressBar_8cpp.html#a938fbeb5cba1999a91310a5b01eb389">rActual</a>;
<a name="l00017"></a>00017 
<a name="l00018"></a>00018 
<a name="l00019"></a>00019 
<a name="l00020"></a>00020 <span class="preprocessor">#define MAX_PROGRESSBARS 4</span>
<a name="l00021"></a>00021 <span class="preprocessor"></span>
<a name="l00022"></a><a class="code" href="Animated_01ProgressBar_8h.html#50a5c1599b088e7aca62806aee9298bf">00022</a> <a class="code" href="structPROGRESSBAR.html">PROGRESSBAR</a> *<a class="code" href="Animated_01ProgressBar_8cpp.html#50a5c1599b088e7aca62806aee9298bf">pBar</a>[ MAX_PROGRESSBARS ];
<a name="l00023"></a>00023 
<a name="l00024"></a><a class="code" href="Animated_01ProgressBar_8cpp.html#3ce0e78ec1a484a04f62c5d56c5d80e1">00024</a> <a class="code" href="Types_8h.html#112e3146cb38b6ee95e64d85842e380a">BOOLEAN</a> <a class="code" href="Animated_01ProgressBar_8cpp.html#3ce0e78ec1a484a04f62c5d56c5d80e1">gfUseLoadScreenProgressBar</a> = FALSE;
<a name="l00025"></a><a class="code" href="Animated_01ProgressBar_8cpp.html#a052fbe1f9921988814798f985e74983">00025</a> <a class="code" href="Types_8h.html#09f1a1fb2293e33483cc8d44aefb1eb1">UINT16</a> <a class="code" href="Animated_01ProgressBar_8cpp.html#a052fbe1f9921988814798f985e74983">gusLeftmostShaded</a> = 0;
<a name="l00026"></a>00026 
<a name="l00027"></a>00027 <span class="keyword">extern</span> <a class="code" href="Types_8h.html#112e3146cb38b6ee95e64d85842e380a">BOOLEAN</a> <a class="code" href="Loading_01Screen_8cpp.html#a8acb4f6109f531fc1ef8e9d46b1e595">bShowSmallImage</a>;
<a name="l00028"></a>00028 
<a name="l00029"></a><a class="code" href="Animated_01ProgressBar_8h.html#2609ddbad25119a1d49877bfb2e29c3f">00029</a> <span class="keywordtype">void</span> <a class="code" href="Animated_01ProgressBar_8cpp.html#2609ddbad25119a1d49877bfb2e29c3f">CreateLoadingScreenProgressBar</a>()
<a name="l00030"></a>00030 {
<a name="l00031"></a>00031       <a class="code" href="Animated_01ProgressBar_8cpp.html#a052fbe1f9921988814798f985e74983">gusLeftmostShaded</a> = 162;
<a name="l00032"></a>00032       <a class="code" href="Animated_01ProgressBar_8cpp.html#3ce0e78ec1a484a04f62c5d56c5d80e1">gfUseLoadScreenProgressBar</a> = TRUE;
<a name="l00033"></a>00033 
<a name="l00034"></a>00034       <span class="comment">// Special case -&gt; show small image centered</span>
<a name="l00035"></a>00035       <span class="keywordflow">if</span> (<a class="code" href="Loading_01Screen_8cpp.html#a8acb4f6109f531fc1ef8e9d46b1e595">bShowSmallImage</a> == TRUE)
<a name="l00036"></a>00036       {
<a name="l00037"></a>00037             <span class="keywordflow">if</span> (<a class="code" href="local_8h.html#ab63323abefef76cc235f7f6eb161b90">iResolution</a> &gt; 0)
<a name="l00038"></a>00038             {
<a name="l00039"></a>00039                   <a class="code" href="Animated_01ProgressBar_8cpp.html#d377396e8c5ae9a8c8383d3ef6e963a9">CreateProgressBar</a>(0, <a class="code" href="local_8h.html#220ff901ddb226482c63dd3e7b480026">iScreenWidthOffset</a> + 162, <a class="code" href="local_8h.html#7d571415be97ebceabfb7b8228bf1b1b">iScreenHeightOffset</a> + 427, <a class="code" href="local_8h.html#220ff901ddb226482c63dd3e7b480026">iScreenWidthOffset</a> + 480, <a class="code" href="local_8h.html#7d571415be97ebceabfb7b8228bf1b1b">iScreenHeightOffset</a> + 443);
<a name="l00040"></a>00040             }
<a name="l00041"></a>00041       }
<a name="l00042"></a>00042       <span class="keywordflow">else</span>
<a name="l00043"></a>00043       {
<a name="l00044"></a>00044             <span class="keywordflow">if</span> (<a class="code" href="local_8h.html#ab63323abefef76cc235f7f6eb161b90">iResolution</a> == 0)
<a name="l00045"></a>00045             {
<a name="l00046"></a>00046                   <a class="code" href="Animated_01ProgressBar_8cpp.html#d377396e8c5ae9a8c8383d3ef6e963a9">CreateProgressBar</a>(0, 162, 427, 480, 443);
<a name="l00047"></a>00047             }
<a name="l00048"></a>00048             <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="local_8h.html#ab63323abefef76cc235f7f6eb161b90">iResolution</a> == 1)
<a name="l00049"></a>00049             {
<a name="l00050"></a>00050                   <a class="code" href="Animated_01ProgressBar_8cpp.html#d377396e8c5ae9a8c8383d3ef6e963a9">CreateProgressBar</a>(0, 202, 533, 600, 554);
<a name="l00051"></a>00051             }
<a name="l00052"></a>00052             <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="local_8h.html#ab63323abefef76cc235f7f6eb161b90">iResolution</a> == 2)
<a name="l00053"></a>00053             {
<a name="l00054"></a>00054                   <a class="code" href="Animated_01ProgressBar_8cpp.html#d377396e8c5ae9a8c8383d3ef6e963a9">CreateProgressBar</a>(0, 259, 683, 767, 708);
<a name="l00055"></a>00055             }
<a name="l00056"></a>00056       }
<a name="l00057"></a>00057 }
<a name="l00058"></a>00058 
<a name="l00059"></a><a class="code" href="Animated_01ProgressBar_8h.html#a3d71ea9a7e538303093fd2fbf026201">00059</a> <span class="keywordtype">void</span> <a class="code" href="Animated_01ProgressBar_8cpp.html#a3d71ea9a7e538303093fd2fbf026201">RemoveLoadingScreenProgressBar</a>()
<a name="l00060"></a>00060 {
<a name="l00061"></a>00061       <a class="code" href="Animated_01ProgressBar_8cpp.html#3ce0e78ec1a484a04f62c5d56c5d80e1">gfUseLoadScreenProgressBar</a> = FALSE;
<a name="l00062"></a>00062       <a class="code" href="Animated_01ProgressBar_8cpp.html#27b91e4c8bd3719a3266aaa45fb29c9e">RemoveProgressBar</a>( 0 );
<a name="l00063"></a>00063       <a class="code" href="Font_8cpp.html#1513b9080348f45e52cc45e68cbeddee">SetFontShadow</a>(DEFAULT_SHADOW);
<a name="l00064"></a>00064 }
<a name="l00065"></a>00065 
<a name="l00066"></a>00066 <span class="comment">//This creates a single progress bar given the coordinates without a panel (containing a title and background).</span>
<a name="l00067"></a>00067 <span class="comment">//A panel is automatically created if you specify a title using SetProgressBarTitle</span>
<a name="l00068"></a><a class="code" href="Animated_01ProgressBar_8h.html#d377396e8c5ae9a8c8383d3ef6e963a9">00068</a> <a class="code" href="Types_8h.html#112e3146cb38b6ee95e64d85842e380a">BOOLEAN</a> <a class="code" href="Animated_01ProgressBar_8cpp.html#d377396e8c5ae9a8c8383d3ef6e963a9">CreateProgressBar</a>( <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubProgressBarID, <a class="code" href="Types_8h.html#09f1a1fb2293e33483cc8d44aefb1eb1">UINT16</a> usLeft, <a class="code" href="Types_8h.html#09f1a1fb2293e33483cc8d44aefb1eb1">UINT16</a> usTop, <a class="code" href="Types_8h.html#09f1a1fb2293e33483cc8d44aefb1eb1">UINT16</a> usRight, <a class="code" href="Types_8h.html#09f1a1fb2293e33483cc8d44aefb1eb1">UINT16</a> usBottom )
<a name="l00069"></a>00069 {
<a name="l00070"></a>00070       <a class="code" href="structPROGRESSBAR.html">PROGRESSBAR</a> *pNew;
<a name="l00071"></a>00071       <span class="comment">//Allocate new progress bar</span>
<a name="l00072"></a>00072       pNew = (<a class="code" href="structPROGRESSBAR.html">PROGRESSBAR</a>*)MemAlloc( <span class="keyword">sizeof</span>( <a class="code" href="structPROGRESSBAR.html">PROGRESSBAR</a> ) );
<a name="l00073"></a>00073       Assert( pNew );
<a name="l00074"></a>00074 
<a name="l00075"></a>00075       <span class="keywordflow">if</span>( <a class="code" href="Animated_01ProgressBar_8cpp.html#50a5c1599b088e7aca62806aee9298bf">pBar</a>[ ubProgressBarID ] )
<a name="l00076"></a>00076             <a class="code" href="Animated_01ProgressBar_8cpp.html#27b91e4c8bd3719a3266aaa45fb29c9e">RemoveProgressBar</a>( ubProgressBarID );
<a name="l00077"></a>00077 
<a name="l00078"></a>00078       memset( pNew, 0, <span class="keyword">sizeof</span>( PROGRESSBAR ) );
<a name="l00079"></a>00079 
<a name="l00080"></a>00080       <a class="code" href="Animated_01ProgressBar_8cpp.html#50a5c1599b088e7aca62806aee9298bf">pBar</a>[ ubProgressBarID ] = pNew;
<a name="l00081"></a>00081       pNew-&gt;<a class="code" href="structPROGRESSBAR.html#0f0ea1426b2c62e0ae91f8b193f5f2db">ubProgressBarID</a> = ubProgressBarID;
<a name="l00082"></a>00082       <span class="comment">//Assign coordinates</span>
<a name="l00083"></a>00083       pNew-&gt;<a class="code" href="structPROGRESSBAR.html#7af4253c459428c04900584adac62df9">usBarLeft</a> = usLeft;
<a name="l00084"></a>00084       pNew-&gt;<a class="code" href="structPROGRESSBAR.html#c49f56d2abfd3642f1a5eb2883d60074">usBarTop</a> = usTop;
<a name="l00085"></a>00085       pNew-&gt;<a class="code" href="structPROGRESSBAR.html#db1f5cf8f78256b47ca09e15964f69f1">usBarRight</a> = usRight;
<a name="l00086"></a>00086       pNew-&gt;<a class="code" href="structPROGRESSBAR.html#070f34d486f273b980fd7a0aac9879c9">usBarBottom</a> = usBottom;
<a name="l00087"></a>00087       <span class="comment">//Init default data</span>
<a name="l00088"></a>00088       pNew-&gt;<a class="code" href="structPROGRESSBAR.html#6b982f7c5504af68c3b0f603e4d87f20">fPanel</a> = FALSE;
<a name="l00089"></a>00089       pNew-&gt;<a class="code" href="structPROGRESSBAR.html#0a2137b51d66125b82f9cefa006744fe">usMsgFont</a> = (<a class="code" href="Types_8h.html#09f1a1fb2293e33483cc8d44aefb1eb1">UINT16</a>)FONT12POINT1;
<a name="l00090"></a>00090       pNew-&gt;<a class="code" href="structPROGRESSBAR.html#110a1a713025a6d0c828831d0164d0a7">ubMsgFontForeColor</a> = FONT_BLACK;
<a name="l00091"></a>00091       pNew-&gt;<a class="code" href="structPROGRESSBAR.html#6c63dbeda13a02e92224935fdb821463">ubMsgFontShadowColor</a> = 0;
<a name="l00092"></a>00092       <a class="code" href="Animated_01ProgressBar_8cpp.html#ebebb810bb9ad2a6912475609f07a0d0">SetRelativeStartAndEndPercentage</a>( pNew-&gt;<a class="code" href="structPROGRESSBAR.html#0f0ea1426b2c62e0ae91f8b193f5f2db">ubProgressBarID</a>, 0, 100, NULL );
<a name="l00093"></a>00093       pNew-&gt;<a class="code" href="structPROGRESSBAR.html#cfba76f486f8b12233c27183ccdf2128">swzTitle</a> = NULL;
<a name="l00094"></a>00094 
<a name="l00095"></a>00095       <span class="comment">//Default the progress bar's color to be red</span>
<a name="l00096"></a>00096       pNew-&gt;<a class="code" href="structPROGRESSBAR.html#b0f4291a4fd4251fdc9003683d14966f">ubColorFillRed</a> = 150;
<a name="l00097"></a>00097       pNew-&gt;<a class="code" href="structPROGRESSBAR.html#79f0367d62a3193cfef30cee2e9260e9">ubColorFillGreen</a> = 0;
<a name="l00098"></a>00098       pNew-&gt;<a class="code" href="structPROGRESSBAR.html#7d75ae623afd0454e302c1952b893400">ubColorFillBlue</a> = 0;
<a name="l00099"></a>00099 
<a name="l00100"></a>00100       pNew-&gt;<a class="code" href="structPROGRESSBAR.html#fc3d8b0591dc0bb04dd8ec11f4f78759">fDisplayText</a> = FALSE;
<a name="l00101"></a>00101 
<a name="l00102"></a>00102       <span class="keywordflow">return</span> TRUE;
<a name="l00103"></a>00103 }
<a name="l00104"></a>00104 
<a name="l00105"></a>00105 <span class="comment">//You may also define a panel to go in behind the progress bar.  You can now assign a title to go with</span>
<a name="l00106"></a>00106 <span class="comment">//the panel.</span>
<a name="l00107"></a><a class="code" href="Animated_01ProgressBar_8h.html#e3c5454cfaff4aea0825296026d6051b">00107</a> <span class="keywordtype">void</span> <a class="code" href="Animated_01ProgressBar_8cpp.html#e3c5454cfaff4aea0825296026d6051b">DefineProgressBarPanel</a>( <a class="code" href="Types_8h.html#e1e6edbbc26d6fbc71a90190d0266018">UINT32</a> ubID, <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> r, <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> g, <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> b,
<a name="l00108"></a>00108                                                                                      <a class="code" href="Types_8h.html#09f1a1fb2293e33483cc8d44aefb1eb1">UINT16</a> usLeft, <a class="code" href="Types_8h.html#09f1a1fb2293e33483cc8d44aefb1eb1">UINT16</a> usTop, <a class="code" href="Types_8h.html#09f1a1fb2293e33483cc8d44aefb1eb1">UINT16</a> usRight, <a class="code" href="Types_8h.html#09f1a1fb2293e33483cc8d44aefb1eb1">UINT16</a> usBottom )
<a name="l00109"></a>00109 {
<a name="l00110"></a>00110       <a class="code" href="structPROGRESSBAR.html">PROGRESSBAR</a> *pCurr;
<a name="l00111"></a>00111       Assert( ubID &lt; MAX_PROGRESSBARS );
<a name="l00112"></a>00112       pCurr = <a class="code" href="Animated_01ProgressBar_8cpp.html#50a5c1599b088e7aca62806aee9298bf">pBar</a>[ ubID ];
<a name="l00113"></a>00113       <span class="keywordflow">if</span>( !pCurr )
<a name="l00114"></a>00114             <span class="keywordflow">return</span>;
<a name="l00115"></a>00115 
<a name="l00116"></a>00116       pCurr-&gt;<a class="code" href="structPROGRESSBAR.html#6b982f7c5504af68c3b0f603e4d87f20">fPanel</a> = TRUE;
<a name="l00117"></a>00117       pCurr-&gt;<a class="code" href="structPROGRESSBAR.html#26da74bec95e6c0f5bd7b0aff1e14f37">usPanelLeft</a> = usLeft;
<a name="l00118"></a>00118       pCurr-&gt;<a class="code" href="structPROGRESSBAR.html#60ff267d6ab2674b2605b93181a84403">usPanelTop</a> = usTop;
<a name="l00119"></a>00119       pCurr-&gt;<a class="code" href="structPROGRESSBAR.html#03fdf7d22cffb61b31e7f542d4030afb">usPanelRight</a> = usRight;
<a name="l00120"></a>00120       pCurr-&gt;<a class="code" href="structPROGRESSBAR.html#9b74d1c72a32ce9af672d20ed1b4691f">usPanelBottom</a> = usBottom;
<a name="l00121"></a>00121       pCurr-&gt;<a class="code" href="structPROGRESSBAR.html#44e1c980789677d6099633354c2308e6">usColor</a> = <a class="code" href="himage_8cpp.html#d29939ffcd39c7d1cc0a91222702d361">Get16BPPColor</a>( FROMRGB( r, g, b ) );
<a name="l00122"></a>00122       <span class="comment">//Calculate the slightly lighter and darker versions of the same rgb color</span>
<a name="l00123"></a>00123       pCurr-&gt;<a class="code" href="structPROGRESSBAR.html#d826fe4e8dd166e062533dea6ff0ec10">usLtColor</a> = <a class="code" href="himage_8cpp.html#d29939ffcd39c7d1cc0a91222702d361">Get16BPPColor</a>( FROMRGB( (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)min( 255, (<a class="code" href="Types_8h.html#09f1a1fb2293e33483cc8d44aefb1eb1">UINT16</a>)(r*1.33)), 
<a name="l00124"></a>00124                                                                                                                                      (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)min( 255, (<a class="code" href="Types_8h.html#09f1a1fb2293e33483cc8d44aefb1eb1">UINT16</a>)(g*1.33)),
<a name="l00125"></a>00125                                                                                                                                      (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)min( 255, (<a class="code" href="Types_8h.html#09f1a1fb2293e33483cc8d44aefb1eb1">UINT16</a>)(b*1.33)) ));
<a name="l00126"></a>00126       pCurr-&gt;<a class="code" href="structPROGRESSBAR.html#9bd25da3a50747e54b2f740eb62b625f">usDkColor</a> = <a class="code" href="himage_8cpp.html#d29939ffcd39c7d1cc0a91222702d361">Get16BPPColor</a>( FROMRGB( (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)(r*0.75), (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)(g*0.75), (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)(b*0.75) ) );
<a name="l00127"></a>00127 }
<a name="l00128"></a>00128 
<a name="l00129"></a>00129 <span class="comment">//Assigning a title for the panel will automatically position the text horizontally centered on the</span>
<a name="l00130"></a>00130 <span class="comment">//panel and vertically centered from the top of the panel, to the top of the progress bar.</span>
<a name="l00131"></a><a class="code" href="Animated_01ProgressBar_8h.html#12c62255d4a96c6fe7e09e2e75788e41">00131</a> <span class="keywordtype">void</span> <a class="code" href="Animated_01ProgressBar_8cpp.html#12c62255d4a96c6fe7e09e2e75788e41">SetProgressBarTitle</a>( <a class="code" href="Types_8h.html#e1e6edbbc26d6fbc71a90190d0266018">UINT32</a> ubID, <a class="code" href="Types_8h.html#09f1a1fb2293e33483cc8d44aefb1eb1">UINT16</a> *pString, <a class="code" href="Types_8h.html#e1e6edbbc26d6fbc71a90190d0266018">UINT32</a> usFont, <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubForeColor, <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubShadowColor )
<a name="l00132"></a>00132 {
<a name="l00133"></a>00133       <a class="code" href="structPROGRESSBAR.html">PROGRESSBAR</a> *pCurr;
<a name="l00134"></a>00134       Assert( ubID &lt; MAX_PROGRESSBARS );
<a name="l00135"></a>00135       pCurr = <a class="code" href="Animated_01ProgressBar_8cpp.html#50a5c1599b088e7aca62806aee9298bf">pBar</a>[ ubID ];
<a name="l00136"></a>00136       <span class="keywordflow">if</span>( !pCurr )
<a name="l00137"></a>00137             <span class="keywordflow">return</span>;
<a name="l00138"></a>00138       <span class="keywordflow">if</span>( pCurr-&gt;<a class="code" href="structPROGRESSBAR.html#cfba76f486f8b12233c27183ccdf2128">swzTitle</a> )
<a name="l00139"></a>00139       {
<a name="l00140"></a>00140             MemFree( pCurr-&gt;<a class="code" href="structPROGRESSBAR.html#cfba76f486f8b12233c27183ccdf2128">swzTitle</a> );
<a name="l00141"></a>00141             pCurr-&gt;<a class="code" href="structPROGRESSBAR.html#cfba76f486f8b12233c27183ccdf2128">swzTitle</a> = NULL;
<a name="l00142"></a>00142       }
<a name="l00143"></a>00143       <span class="keywordflow">if</span>( pString &amp;&amp; wcslen( pString ) )
<a name="l00144"></a>00144       {
<a name="l00145"></a>00145             pCurr-&gt;<a class="code" href="structPROGRESSBAR.html#cfba76f486f8b12233c27183ccdf2128">swzTitle</a> = (<a class="code" href="Types_8h.html#09f1a1fb2293e33483cc8d44aefb1eb1">UINT16</a>*)MemAlloc( <span class="keyword">sizeof</span>( <a class="code" href="Types_8h.html#09f1a1fb2293e33483cc8d44aefb1eb1">UINT16</a> ) * ( wcslen( pString ) + 1 ) );
<a name="l00146"></a>00146             swprintf( pCurr-&gt;<a class="code" href="structPROGRESSBAR.html#cfba76f486f8b12233c27183ccdf2128">swzTitle</a>, pString );
<a name="l00147"></a>00147       }
<a name="l00148"></a>00148       pCurr-&gt;<a class="code" href="structPROGRESSBAR.html#712df05d6df84518bbb0f2a63122d411">usTitleFont</a> = (<a class="code" href="Types_8h.html#09f1a1fb2293e33483cc8d44aefb1eb1">UINT16</a>)usFont;
<a name="l00149"></a>00149       pCurr-&gt;<a class="code" href="structPROGRESSBAR.html#64609d64d0383732047c9e728e286558">ubTitleFontForeColor</a> = ubForeColor;
<a name="l00150"></a>00150       pCurr-&gt;<a class="code" href="structPROGRESSBAR.html#5cc01d58f4969a96c5071fd9783330aa">ubTitleFontShadowColor</a> = ubShadowColor;
<a name="l00151"></a>00151 }
<a name="l00152"></a>00152 
<a name="l00153"></a>00153 <span class="comment">//Unless you set up the attributes, any text you pass to SetRelativeStartAndEndPercentage will</span>
<a name="l00154"></a>00154 <span class="comment">//default to FONT12POINT1 in a black color.</span>
<a name="l00155"></a><a class="code" href="Animated_01ProgressBar_8h.html#ae4c7fc205c784b43326e5ea8b345124">00155</a> <span class="keywordtype">void</span> <a class="code" href="Animated_01ProgressBar_8cpp.html#ae4c7fc205c784b43326e5ea8b345124">SetProgressBarMsgAttributes</a>( <a class="code" href="Types_8h.html#e1e6edbbc26d6fbc71a90190d0266018">UINT32</a> ubID, <a class="code" href="Types_8h.html#e1e6edbbc26d6fbc71a90190d0266018">UINT32</a> usFont, <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubForeColor, <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubShadowColor )
<a name="l00156"></a>00156 {
<a name="l00157"></a>00157       <a class="code" href="structPROGRESSBAR.html">PROGRESSBAR</a> *pCurr;
<a name="l00158"></a>00158       Assert( ubID &lt; MAX_PROGRESSBARS );
<a name="l00159"></a>00159       pCurr = <a class="code" href="Animated_01ProgressBar_8cpp.html#50a5c1599b088e7aca62806aee9298bf">pBar</a>[ ubID ];
<a name="l00160"></a>00160       <span class="keywordflow">if</span>( !pCurr )
<a name="l00161"></a>00161             <span class="keywordflow">return</span>;
<a name="l00162"></a>00162       pCurr-&gt;<a class="code" href="structPROGRESSBAR.html#0a2137b51d66125b82f9cefa006744fe">usMsgFont</a> = (<a class="code" href="Types_8h.html#09f1a1fb2293e33483cc8d44aefb1eb1">UINT16</a>)usFont;
<a name="l00163"></a>00163       pCurr-&gt;<a class="code" href="structPROGRESSBAR.html#110a1a713025a6d0c828831d0164d0a7">ubMsgFontForeColor</a> = ubForeColor;
<a name="l00164"></a>00164       pCurr-&gt;<a class="code" href="structPROGRESSBAR.html#6c63dbeda13a02e92224935fdb821463">ubMsgFontShadowColor</a> = ubShadowColor;
<a name="l00165"></a>00165 }
<a name="l00166"></a>00166 
<a name="l00167"></a>00167 
<a name="l00168"></a>00168 <span class="comment">//When finished, the progress bar needs to be removed.</span>
<a name="l00169"></a><a class="code" href="Animated_01ProgressBar_8h.html#27b91e4c8bd3719a3266aaa45fb29c9e">00169</a> <span class="keywordtype">void</span> <a class="code" href="Animated_01ProgressBar_8cpp.html#27b91e4c8bd3719a3266aaa45fb29c9e">RemoveProgressBar</a>( <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubID )
<a name="l00170"></a>00170 {
<a name="l00171"></a>00171       Assert( ubID &lt; MAX_PROGRESSBARS );
<a name="l00172"></a>00172       <span class="keywordflow">if</span>( <a class="code" href="Animated_01ProgressBar_8cpp.html#50a5c1599b088e7aca62806aee9298bf">pBar</a>[ubID] )
<a name="l00173"></a>00173       {
<a name="l00174"></a>00174             <span class="keywordflow">if</span>( <a class="code" href="Animated_01ProgressBar_8cpp.html#50a5c1599b088e7aca62806aee9298bf">pBar</a>[ubID]-&gt;swzTitle )
<a name="l00175"></a>00175                   MemFree( <a class="code" href="Animated_01ProgressBar_8cpp.html#50a5c1599b088e7aca62806aee9298bf">pBar</a>[ubID]-&gt;swzTitle );
<a name="l00176"></a>00176             MemFree( <a class="code" href="Animated_01ProgressBar_8cpp.html#50a5c1599b088e7aca62806aee9298bf">pBar</a>[ubID] );
<a name="l00177"></a>00177             <a class="code" href="Animated_01ProgressBar_8cpp.html#50a5c1599b088e7aca62806aee9298bf">pBar</a>[ubID] = NULL;
<a name="l00178"></a>00178             <span class="keywordflow">return</span>;
<a name="l00179"></a>00179       }
<a name="l00180"></a>00180 }
<a name="l00181"></a>00181 
<a name="l00182"></a>00182 <span class="comment">//An important setup function.  The best explanation is through example.  The example being the loading</span>
<a name="l00183"></a>00183 <span class="comment">//of a file -- there are many stages of the map loading.  In JA2, the first step is to load the tileset.</span>
<a name="l00184"></a>00184 <span class="comment">//Because it is a large chunk of the total loading of the map, we may gauge that it takes up 30% of the</span>
<a name="l00185"></a>00185 <span class="comment">//total load.  Because it is also at the beginning, we would pass in the arguments ( 0, 30, "text" ).</span>
<a name="l00186"></a>00186 <span class="comment">//As the process animates using UpdateProgressBar( 0 to 100 ), the total progress bar will only reach 30%</span>
<a name="l00187"></a>00187 <span class="comment">//at the 100% mark within UpdateProgressBar.  At that time, you would go onto the next step, resetting the</span>
<a name="l00188"></a>00188 <span class="comment">//relative start and end percentage from 30 to whatever, until your done.</span>
<a name="l00189"></a><a class="code" href="Animated_01ProgressBar_8h.html#ebebb810bb9ad2a6912475609f07a0d0">00189</a> <span class="keywordtype">void</span> <a class="code" href="Animated_01ProgressBar_8cpp.html#ebebb810bb9ad2a6912475609f07a0d0">SetRelativeStartAndEndPercentage</a>( <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubID, <a class="code" href="Types_8h.html#e1e6edbbc26d6fbc71a90190d0266018">UINT32</a> uiRelStartPerc, <a class="code" href="Types_8h.html#e1e6edbbc26d6fbc71a90190d0266018">UINT32</a> uiRelEndPerc, <a class="code" href="Types_8h.html#09f1a1fb2293e33483cc8d44aefb1eb1">UINT16</a> *<a class="code" href="Button_01System_8cpp.html#ac22642f3052cc77a6991a262ce4ad23">str</a>)
<a name="l00190"></a>00190 {
<a name="l00191"></a>00191       <a class="code" href="structPROGRESSBAR.html">PROGRESSBAR</a> *pCurr;
<a name="l00192"></a>00192       <a class="code" href="Types_8h.html#09f1a1fb2293e33483cc8d44aefb1eb1">UINT16</a> usStartX, usStartY;
<a name="l00193"></a>00193 
<a name="l00194"></a>00194       Assert( ubID &lt; MAX_PROGRESSBARS );
<a name="l00195"></a>00195       pCurr = <a class="code" href="Animated_01ProgressBar_8cpp.html#50a5c1599b088e7aca62806aee9298bf">pBar</a>[ ubID ];
<a name="l00196"></a>00196       <span class="keywordflow">if</span>( !pCurr )
<a name="l00197"></a>00197             <span class="keywordflow">return</span>;
<a name="l00198"></a>00198 
<a name="l00199"></a>00199       pCurr-&gt;<a class="code" href="structPROGRESSBAR.html#071f62b3a1048313e648ed00d8e3d97a">rStart</a> = uiRelStartPerc*0.01;
<a name="l00200"></a>00200       pCurr-&gt;<a class="code" href="structPROGRESSBAR.html#df229ae4f71f9a4320f6cdbdcca22029">rEnd</a> = uiRelEndPerc*0.01;
<a name="l00201"></a>00201 
<a name="l00202"></a>00202       <span class="comment">//Render the entire panel now, as it doesn't need update during the normal rendering</span>
<a name="l00203"></a>00203       <span class="keywordflow">if</span>( pCurr-&gt;<a class="code" href="structPROGRESSBAR.html#6b982f7c5504af68c3b0f603e4d87f20">fPanel</a> )
<a name="l00204"></a>00204       {
<a name="l00205"></a>00205             <span class="comment">//Draw panel</span>
<a name="l00206"></a>00206             <a class="code" href="vsurface_8cpp.html#10d0257b54c4d27b2d82ead2a46cd581">ColorFillVideoSurfaceArea</a>( FRAME_BUFFER, 
<a name="l00207"></a>00207                   pCurr-&gt;<a class="code" href="structPROGRESSBAR.html#26da74bec95e6c0f5bd7b0aff1e14f37">usPanelLeft</a>, pCurr-&gt;<a class="code" href="structPROGRESSBAR.html#60ff267d6ab2674b2605b93181a84403">usPanelTop</a>, pCurr-&gt;<a class="code" href="structPROGRESSBAR.html#03fdf7d22cffb61b31e7f542d4030afb">usPanelRight</a>, pCurr-&gt;<a class="code" href="structPROGRESSBAR.html#9b74d1c72a32ce9af672d20ed1b4691f">usPanelBottom</a>, pCurr-&gt;<a class="code" href="structPROGRESSBAR.html#d826fe4e8dd166e062533dea6ff0ec10">usLtColor</a> );
<a name="l00208"></a>00208             <a class="code" href="vsurface_8cpp.html#10d0257b54c4d27b2d82ead2a46cd581">ColorFillVideoSurfaceArea</a>( FRAME_BUFFER, 
<a name="l00209"></a>00209                   pCurr-&gt;<a class="code" href="structPROGRESSBAR.html#26da74bec95e6c0f5bd7b0aff1e14f37">usPanelLeft</a>+1, pCurr-&gt;<a class="code" href="structPROGRESSBAR.html#60ff267d6ab2674b2605b93181a84403">usPanelTop</a>+1, pCurr-&gt;<a class="code" href="structPROGRESSBAR.html#03fdf7d22cffb61b31e7f542d4030afb">usPanelRight</a>, pCurr-&gt;<a class="code" href="structPROGRESSBAR.html#9b74d1c72a32ce9af672d20ed1b4691f">usPanelBottom</a>, pCurr-&gt;<a class="code" href="structPROGRESSBAR.html#9bd25da3a50747e54b2f740eb62b625f">usDkColor</a> );
<a name="l00210"></a>00210             <a class="code" href="vsurface_8cpp.html#10d0257b54c4d27b2d82ead2a46cd581">ColorFillVideoSurfaceArea</a>( FRAME_BUFFER, 
<a name="l00211"></a>00211                   pCurr-&gt;<a class="code" href="structPROGRESSBAR.html#26da74bec95e6c0f5bd7b0aff1e14f37">usPanelLeft</a>+1, pCurr-&gt;<a class="code" href="structPROGRESSBAR.html#60ff267d6ab2674b2605b93181a84403">usPanelTop</a>+1, pCurr-&gt;<a class="code" href="structPROGRESSBAR.html#03fdf7d22cffb61b31e7f542d4030afb">usPanelRight</a>-1, pCurr-&gt;<a class="code" href="structPROGRESSBAR.html#9b74d1c72a32ce9af672d20ed1b4691f">usPanelBottom</a>-1, pCurr-&gt;<a class="code" href="structPROGRESSBAR.html#44e1c980789677d6099633354c2308e6">usColor</a> );
<a name="l00212"></a>00212             <a class="code" href="video_8cpp.html#4ed7790da612ff97bf9c05cf186823bc">InvalidateRegion</a>( pCurr-&gt;<a class="code" href="structPROGRESSBAR.html#26da74bec95e6c0f5bd7b0aff1e14f37">usPanelLeft</a>, pCurr-&gt;<a class="code" href="structPROGRESSBAR.html#60ff267d6ab2674b2605b93181a84403">usPanelTop</a>, pCurr-&gt;<a class="code" href="structPROGRESSBAR.html#03fdf7d22cffb61b31e7f542d4030afb">usPanelRight</a>, pCurr-&gt;<a class="code" href="structPROGRESSBAR.html#9b74d1c72a32ce9af672d20ed1b4691f">usPanelBottom</a> );
<a name="l00213"></a>00213             <span class="comment">//Draw title</span>
<a name="l00214"></a>00214 
<a name="l00215"></a>00215             <span class="keywordflow">if</span>( pCurr-&gt;<a class="code" href="structPROGRESSBAR.html#cfba76f486f8b12233c27183ccdf2128">swzTitle</a> )
<a name="l00216"></a>00216             {
<a name="l00217"></a>00217                   usStartX = pCurr-&gt;<a class="code" href="structPROGRESSBAR.html#26da74bec95e6c0f5bd7b0aff1e14f37">usPanelLeft</a> +                                                                                                                             <span class="comment">// left position</span>
<a name="l00218"></a>00218                                                  (pCurr-&gt;<a class="code" href="structPROGRESSBAR.html#03fdf7d22cffb61b31e7f542d4030afb">usPanelRight</a> - pCurr-&gt;<a class="code" href="structPROGRESSBAR.html#26da74bec95e6c0f5bd7b0aff1e14f37">usPanelLeft</a>)/2 -                                           <span class="comment">// + half width</span>
<a name="l00219"></a>00219                                                  <a class="code" href="Font_8cpp.html#3bbbfeabebae07a03f719f35607c6e4f">StringPixLength</a>( pCurr-&gt;<a class="code" href="structPROGRESSBAR.html#cfba76f486f8b12233c27183ccdf2128">swzTitle</a>, pCurr-&gt;<a class="code" href="structPROGRESSBAR.html#712df05d6df84518bbb0f2a63122d411">usTitleFont</a> ) / 2;      <span class="comment">// - half string width</span>
<a name="l00220"></a>00220                   usStartY = pCurr-&gt;<a class="code" href="structPROGRESSBAR.html#60ff267d6ab2674b2605b93181a84403">usPanelTop</a> + 3;
<a name="l00221"></a>00221                   <a class="code" href="Font_8cpp.html#fa4871009f0473cca0380217753947dc">SetFont</a>( pCurr-&gt;<a class="code" href="structPROGRESSBAR.html#712df05d6df84518bbb0f2a63122d411">usTitleFont</a> );
<a name="l00222"></a>00222                   <a class="code" href="Font_8cpp.html#388be5810478c3f3bdb861f144085d70">SetFontForeground</a>( pCurr-&gt;<a class="code" href="structPROGRESSBAR.html#64609d64d0383732047c9e728e286558">ubTitleFontForeColor</a> );
<a name="l00223"></a>00223                   <a class="code" href="Font_8cpp.html#1513b9080348f45e52cc45e68cbeddee">SetFontShadow</a>( pCurr-&gt;<a class="code" href="structPROGRESSBAR.html#5cc01d58f4969a96c5071fd9783330aa">ubTitleFontShadowColor</a> );
<a name="l00224"></a>00224                   <a class="code" href="Font_8cpp.html#a1fe8cc526be9e2c96b5dd66e348506f">SetFontBackground</a>( 0 );
<a name="l00225"></a>00225                   <a class="code" href="Font_8cpp.html#b3e12cf19a0ca58abf6689cc8eca3ead">mprintf</a>( usStartX, usStartY, pCurr-&gt;<a class="code" href="structPROGRESSBAR.html#cfba76f486f8b12233c27183ccdf2128">swzTitle</a> );
<a name="l00226"></a>00226             }
<a name="l00227"></a>00227       }
<a name="l00228"></a>00228 
<a name="l00229"></a>00229       <span class="keywordflow">if</span>( pCurr-&gt;<a class="code" href="structPROGRESSBAR.html#fc3d8b0591dc0bb04dd8ec11f4f78759">fDisplayText</a> )
<a name="l00230"></a>00230       {
<a name="l00231"></a>00231             <span class="comment">//Draw message</span>
<a name="l00232"></a>00232             <span class="keywordflow">if</span>( str )
<a name="l00233"></a>00233             {
<a name="l00234"></a>00234                   <span class="keywordflow">if</span>( pCurr-&gt;<a class="code" href="structPROGRESSBAR.html#8954022fd6993e432fa789946bd2c958">fUseSaveBuffer</a> )
<a name="l00235"></a>00235                   {
<a name="l00236"></a>00236                         <a class="code" href="Types_8h.html#09f1a1fb2293e33483cc8d44aefb1eb1">UINT16</a> usFontHeight = <a class="code" href="Font_8cpp.html#35cddf34696d33489efb820caf968907">GetFontHeight</a>( pCurr-&gt;<a class="code" href="structPROGRESSBAR.html#0a2137b51d66125b82f9cefa006744fe">usMsgFont</a> );
<a name="l00237"></a>00237 
<a name="l00238"></a>00238                         <a class="code" href="Render_01Dirty_8cpp.html#ce65fac8b540eee1a5bf4902d2dcb0c5">RestoreExternBackgroundRect</a>( pCurr-&gt;<a class="code" href="structPROGRESSBAR.html#7af4253c459428c04900584adac62df9">usBarLeft</a>, pCurr-&gt;<a class="code" href="structPROGRESSBAR.html#070f34d486f273b980fd7a0aac9879c9">usBarBottom</a>, (<a class="code" href="Types_8h.html#30f500129d8c688af07726d5d34ce52d">INT16</a>)(pCurr-&gt;<a class="code" href="structPROGRESSBAR.html#db1f5cf8f78256b47ca09e15964f69f1">usBarRight</a>-pCurr-&gt;<a class="code" href="structPROGRESSBAR.html#7af4253c459428c04900584adac62df9">usBarLeft</a>), (<a class="code" href="Types_8h.html#30f500129d8c688af07726d5d34ce52d">INT16</a>)(usFontHeight + 3) );
<a name="l00239"></a>00239                   }
<a name="l00240"></a>00240 
<a name="l00241"></a>00241                   <a class="code" href="Font_8cpp.html#fa4871009f0473cca0380217753947dc">SetFont</a>( pCurr-&gt;<a class="code" href="structPROGRESSBAR.html#0a2137b51d66125b82f9cefa006744fe">usMsgFont</a> );
<a name="l00242"></a>00242                   <a class="code" href="Font_8cpp.html#388be5810478c3f3bdb861f144085d70">SetFontForeground</a>( pCurr-&gt;<a class="code" href="structPROGRESSBAR.html#110a1a713025a6d0c828831d0164d0a7">ubMsgFontForeColor</a> );
<a name="l00243"></a>00243                   <a class="code" href="Font_8cpp.html#1513b9080348f45e52cc45e68cbeddee">SetFontShadow</a>( pCurr-&gt;<a class="code" href="structPROGRESSBAR.html#6c63dbeda13a02e92224935fdb821463">ubMsgFontShadowColor</a> );
<a name="l00244"></a>00244                   <a class="code" href="Font_8cpp.html#a1fe8cc526be9e2c96b5dd66e348506f">SetFontBackground</a>( 0 );
<a name="l00245"></a>00245                   <a class="code" href="Font_8cpp.html#b3e12cf19a0ca58abf6689cc8eca3ead">mprintf</a>( pCurr-&gt;<a class="code" href="structPROGRESSBAR.html#7af4253c459428c04900584adac62df9">usBarLeft</a>, pCurr-&gt;<a class="code" href="structPROGRESSBAR.html#070f34d486f273b980fd7a0aac9879c9">usBarBottom</a> + 3, str );
<a name="l00246"></a>00246             }
<a name="l00247"></a>00247       }
<a name="l00248"></a>00248 }
<a name="l00249"></a>00249 
<a name="l00250"></a>00250 <span class="comment">//This part renders the progress bar at the percentage level that you specify.  If you have set relative</span>
<a name="l00251"></a>00251 <span class="comment">//percentage values in the above function, then the uiPercentage will be reflected based off of the relative</span>
<a name="l00252"></a>00252 <span class="comment">//percentages.  </span>
<a name="l00253"></a><a class="code" href="Animated_01ProgressBar_8h.html#ac43360d5976310c78ab9bedb84750f2">00253</a> <span class="keywordtype">void</span> <a class="code" href="Animated_01ProgressBar_8cpp.html#ac43360d5976310c78ab9bedb84750f2">RenderProgressBar</a>( <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubID, <a class="code" href="Types_8h.html#e1e6edbbc26d6fbc71a90190d0266018">UINT32</a> uiPercentage )
<a name="l00254"></a>00254 {
<a name="l00255"></a>00255       <span class="keyword">static</span> <a class="code" href="Types_8h.html#e1e6edbbc26d6fbc71a90190d0266018">UINT32</a> uiLastTime = 0;
<a name="l00256"></a>00256       <a class="code" href="Types_8h.html#e1e6edbbc26d6fbc71a90190d0266018">UINT32</a> uiCurTime = GetJA2Clock();
<a name="l00257"></a>00257       <span class="keywordtype">double</span> <a class="code" href="Animated_01ProgressBar_8cpp.html#a938fbeb5cba1999a91310a5b01eb389">rActual</a>;
<a name="l00258"></a>00258       <a class="code" href="structPROGRESSBAR.html">PROGRESSBAR</a> *pCurr=NULL;
<a name="l00259"></a>00259       <span class="comment">//UINT32 r, g;</span>
<a name="l00260"></a>00260       <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a> <a class="code" href="expat_8h.html#1ec43dcd6a3fbf3a71aeb34b1a88a82e">end</a>;
<a name="l00261"></a>00261 
<a name="l00262"></a>00262       Assert( ubID &lt; MAX_PROGRESSBARS );
<a name="l00263"></a>00263       pCurr = <a class="code" href="Animated_01ProgressBar_8cpp.html#50a5c1599b088e7aca62806aee9298bf">pBar</a>[ubID];
<a name="l00264"></a>00264 
<a name="l00265"></a>00265       <span class="keywordflow">if</span>( pCurr == NULL )
<a name="l00266"></a>00266             <span class="keywordflow">return</span>;
<a name="l00267"></a>00267 
<a name="l00268"></a>00268       <span class="keywordflow">if</span>( pCurr )
<a name="l00269"></a>00269       {
<a name="l00270"></a>00270             rActual = pCurr-&gt;<a class="code" href="structPROGRESSBAR.html#071f62b3a1048313e648ed00d8e3d97a">rStart</a>+(pCurr-&gt;<a class="code" href="structPROGRESSBAR.html#df229ae4f71f9a4320f6cdbdcca22029">rEnd</a>-pCurr-&gt;<a class="code" href="structPROGRESSBAR.html#071f62b3a1048313e648ed00d8e3d97a">rStart</a>)*uiPercentage*0.01;
<a name="l00271"></a>00271 
<a name="l00272"></a>00272             <span class="keywordflow">if</span>( rActual - pCurr-&gt;<a class="code" href="structPROGRESSBAR.html#49bc483fc61defd1566e0bb34e8cca24">rLastActual</a> &lt; 0.01 )
<a name="l00273"></a>00273             {
<a name="l00274"></a>00274                   <span class="keywordflow">return</span>;
<a name="l00275"></a>00275             }
<a name="l00276"></a>00276 
<a name="l00277"></a>00277             pCurr-&gt;<a class="code" href="structPROGRESSBAR.html#49bc483fc61defd1566e0bb34e8cca24">rLastActual</a> = ( <a class="code" href="Types_8h.html#eb90fd78c942591ef3a935cf98baf4f8">DOUBLE</a> )( ( <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a>)( rActual * 100 ) * 0.01 );
<a name="l00278"></a>00278 
<a name="l00279"></a>00279             end = (<a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a>)(pCurr-&gt;<a class="code" href="structPROGRESSBAR.html#7af4253c459428c04900584adac62df9">usBarLeft</a>+2.0+rActual*(pCurr-&gt;<a class="code" href="structPROGRESSBAR.html#db1f5cf8f78256b47ca09e15964f69f1">usBarRight</a>-pCurr-&gt;<a class="code" href="structPROGRESSBAR.html#7af4253c459428c04900584adac62df9">usBarLeft</a>-4));
<a name="l00280"></a>00280             <span class="keywordflow">if</span>( end &lt; pCurr-&gt;usBarLeft+2 || end &gt; pCurr-&gt;<a class="code" href="structPROGRESSBAR.html#db1f5cf8f78256b47ca09e15964f69f1">usBarRight</a>-2 )
<a name="l00281"></a>00281             {
<a name="l00282"></a>00282                   <span class="keywordflow">return</span>;
<a name="l00283"></a>00283             }
<a name="l00284"></a>00284             <span class="keywordflow">if</span>( <a class="code" href="Animated_01ProgressBar_8cpp.html#3ce0e78ec1a484a04f62c5d56c5d80e1">gfUseLoadScreenProgressBar</a> )
<a name="l00285"></a>00285             {
<a name="l00286"></a>00286                   <a class="code" href="vsurface_8cpp.html#10d0257b54c4d27b2d82ead2a46cd581">ColorFillVideoSurfaceArea</a>( FRAME_BUFFER,  
<a name="l00287"></a>00287                         pCurr-&gt;<a class="code" href="structPROGRESSBAR.html#7af4253c459428c04900584adac62df9">usBarLeft</a>, pCurr-&gt;<a class="code" href="structPROGRESSBAR.html#c49f56d2abfd3642f1a5eb2883d60074">usBarTop</a>, end, pCurr-&gt;<a class="code" href="structPROGRESSBAR.html#070f34d486f273b980fd7a0aac9879c9">usBarBottom</a>, 
<a name="l00288"></a>00288                         <a class="code" href="himage_8cpp.html#d29939ffcd39c7d1cc0a91222702d361">Get16BPPColor</a>(FROMRGB( pCurr-&gt;<a class="code" href="structPROGRESSBAR.html#b0f4291a4fd4251fdc9003683d14966f">ubColorFillRed</a>, pCurr-&gt;<a class="code" href="structPROGRESSBAR.html#79f0367d62a3193cfef30cee2e9260e9">ubColorFillGreen</a>, pCurr-&gt;<a class="code" href="structPROGRESSBAR.html#7d75ae623afd0454e302c1952b893400">ubColorFillBlue</a> )) );
<a name="l00289"></a>00289                   <span class="comment">//if( pCurr-&gt;usBarRight &gt; gusLeftmostShaded )</span>
<a name="l00290"></a>00290                   <span class="comment">//{</span>
<a name="l00291"></a>00291                   <span class="comment">//    ShadowVideoSurfaceRect( FRAME_BUFFER, gusLeftmostShaded+1, pCurr-&gt;usBarTop, end, pCurr-&gt;usBarBottom );      </span>
<a name="l00292"></a>00292                   <span class="comment">//    gusLeftmostShaded = (UINT16)end;</span>
<a name="l00293"></a>00293                   <span class="comment">//}</span>
<a name="l00294"></a>00294             }
<a name="l00295"></a>00295             <span class="keywordflow">else</span>
<a name="l00296"></a>00296             {
<a name="l00297"></a>00297                   <span class="comment">//Border edge of the progress bar itself in gray</span>
<a name="l00298"></a>00298                   <a class="code" href="vsurface_8cpp.html#10d0257b54c4d27b2d82ead2a46cd581">ColorFillVideoSurfaceArea</a>( FRAME_BUFFER,  
<a name="l00299"></a>00299                         pCurr-&gt;<a class="code" href="structPROGRESSBAR.html#7af4253c459428c04900584adac62df9">usBarLeft</a>, pCurr-&gt;<a class="code" href="structPROGRESSBAR.html#c49f56d2abfd3642f1a5eb2883d60074">usBarTop</a>, pCurr-&gt;<a class="code" href="structPROGRESSBAR.html#db1f5cf8f78256b47ca09e15964f69f1">usBarRight</a>, pCurr-&gt;<a class="code" href="structPROGRESSBAR.html#070f34d486f273b980fd7a0aac9879c9">usBarBottom</a>, 
<a name="l00300"></a>00300                         <a class="code" href="himage_8cpp.html#d29939ffcd39c7d1cc0a91222702d361">Get16BPPColor</a>(FROMRGB(160, 160, 160)) );
<a name="l00301"></a>00301                   <span class="comment">//Interior of progress bar in black</span>
<a name="l00302"></a>00302                   <a class="code" href="vsurface_8cpp.html#10d0257b54c4d27b2d82ead2a46cd581">ColorFillVideoSurfaceArea</a>( FRAME_BUFFER,  
<a name="l00303"></a>00303                         pCurr-&gt;<a class="code" href="structPROGRESSBAR.html#7af4253c459428c04900584adac62df9">usBarLeft</a>+2, pCurr-&gt;<a class="code" href="structPROGRESSBAR.html#c49f56d2abfd3642f1a5eb2883d60074">usBarTop</a>+2, pCurr-&gt;<a class="code" href="structPROGRESSBAR.html#db1f5cf8f78256b47ca09e15964f69f1">usBarRight</a>-2, pCurr-&gt;<a class="code" href="structPROGRESSBAR.html#070f34d486f273b980fd7a0aac9879c9">usBarBottom</a>-2, 
<a name="l00304"></a>00304                         <a class="code" href="himage_8cpp.html#d29939ffcd39c7d1cc0a91222702d361">Get16BPPColor</a>(FROMRGB(  0,   0,   0)) );
<a name="l00305"></a>00305                   <a class="code" href="vsurface_8cpp.html#10d0257b54c4d27b2d82ead2a46cd581">ColorFillVideoSurfaceArea</a>(FRAME_BUFFER,   pCurr-&gt;<a class="code" href="structPROGRESSBAR.html#7af4253c459428c04900584adac62df9">usBarLeft</a>+2, pCurr-&gt;<a class="code" href="structPROGRESSBAR.html#c49f56d2abfd3642f1a5eb2883d60074">usBarTop</a>+2, end, pCurr-&gt;<a class="code" href="structPROGRESSBAR.html#070f34d486f273b980fd7a0aac9879c9">usBarBottom</a>-2, <a class="code" href="himage_8cpp.html#d29939ffcd39c7d1cc0a91222702d361">Get16BPPColor</a>(FROMRGB(72 , 155, 24)));
<a name="l00306"></a>00306             }
<a name="l00307"></a>00307             <a class="code" href="video_8cpp.html#4ed7790da612ff97bf9c05cf186823bc">InvalidateRegion</a>( pCurr-&gt;<a class="code" href="structPROGRESSBAR.html#7af4253c459428c04900584adac62df9">usBarLeft</a>, pCurr-&gt;<a class="code" href="structPROGRESSBAR.html#c49f56d2abfd3642f1a5eb2883d60074">usBarTop</a>, pCurr-&gt;<a class="code" href="structPROGRESSBAR.html#db1f5cf8f78256b47ca09e15964f69f1">usBarRight</a>, pCurr-&gt;<a class="code" href="structPROGRESSBAR.html#070f34d486f273b980fd7a0aac9879c9">usBarBottom</a> );
<a name="l00308"></a>00308             <a class="code" href="Render_01Dirty_8cpp.html#8db36a227ea1a41076c6dc7de2a28084">ExecuteBaseDirtyRectQueue</a>();
<a name="l00309"></a>00309             <a class="code" href="video_8cpp.html#cb214b937b77ff6e2f5f80a7fe45ea5a">EndFrameBufferRender</a>();
<a name="l00310"></a>00310             <a class="code" href="video_8cpp.html#fbefe3edde80cc30c690c11d5c063789">RefreshScreen</a>( NULL );
<a name="l00311"></a>00311       }
<a name="l00312"></a>00312 
<a name="l00313"></a>00313       <span class="comment">// update music here</span>
<a name="l00314"></a>00314       <span class="keywordflow">if</span>( uiCurTime &gt; ( uiLastTime + 200 ) )
<a name="l00315"></a>00315       {
<a name="l00316"></a>00316             <a class="code" href="Music_01Control_8cpp.html#fe76db7052ef3800502abd32ca5fea69">MusicPoll</a>( TRUE );
<a name="l00317"></a>00317             uiLastTime = GetJA2Clock();
<a name="l00318"></a>00318       }
<a name="l00319"></a>00319 }
<a name="l00320"></a>00320 
<a name="l00321"></a><a class="code" href="Animated_01ProgressBar_8h.html#a93e211a701ff7b571156396f1cfa9f7">00321</a> <span class="keywordtype">void</span> <a class="code" href="Animated_01ProgressBar_8cpp.html#a93e211a701ff7b571156396f1cfa9f7">SetProgressBarColor</a>( <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubID, <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubColorFillRed, <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubColorFillGreen, <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubColorFillBlue )
<a name="l00322"></a>00322 {
<a name="l00323"></a>00323       <a class="code" href="structPROGRESSBAR.html">PROGRESSBAR</a> *pCurr=NULL;
<a name="l00324"></a>00324 
<a name="l00325"></a>00325       Assert( ubID &lt; MAX_PROGRESSBARS );
<a name="l00326"></a>00326 
<a name="l00327"></a>00327       pCurr = <a class="code" href="Animated_01ProgressBar_8cpp.html#50a5c1599b088e7aca62806aee9298bf">pBar</a>[ubID];
<a name="l00328"></a>00328       <span class="keywordflow">if</span>( pCurr == NULL )
<a name="l00329"></a>00329             <span class="keywordflow">return</span>;
<a name="l00330"></a>00330 
<a name="l00331"></a>00331       pCurr-&gt;<a class="code" href="structPROGRESSBAR.html#b0f4291a4fd4251fdc9003683d14966f">ubColorFillRed</a> = ubColorFillRed;
<a name="l00332"></a>00332       pCurr-&gt;<a class="code" href="structPROGRESSBAR.html#79f0367d62a3193cfef30cee2e9260e9">ubColorFillGreen</a> = ubColorFillGreen;
<a name="l00333"></a>00333       pCurr-&gt;<a class="code" href="structPROGRESSBAR.html#7d75ae623afd0454e302c1952b893400">ubColorFillBlue</a> = ubColorFillBlue;
<a name="l00334"></a>00334 }
<a name="l00335"></a>00335 
<a name="l00336"></a>00336 
<a name="l00337"></a><a class="code" href="Animated_01ProgressBar_8h.html#d4c53f32d57d12a7226d3ae49ce5da62">00337</a> <span class="keywordtype">void</span> <a class="code" href="Animated_01ProgressBar_8cpp.html#d4c53f32d57d12a7226d3ae49ce5da62">SetProgressBarTextDisplayFlag</a>( <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubID, <a class="code" href="Types_8h.html#112e3146cb38b6ee95e64d85842e380a">BOOLEAN</a> fDisplayText, <a class="code" href="Types_8h.html#112e3146cb38b6ee95e64d85842e380a">BOOLEAN</a> fUseSaveBuffer, <a class="code" href="Types_8h.html#112e3146cb38b6ee95e64d85842e380a">BOOLEAN</a> fSaveScreenToFrameBuffer )
<a name="l00338"></a>00338 {
<a name="l00339"></a>00339       <a class="code" href="structPROGRESSBAR.html">PROGRESSBAR</a> *pCurr=NULL;
<a name="l00340"></a>00340 
<a name="l00341"></a>00341 
<a name="l00342"></a>00342       Assert( ubID &lt; MAX_PROGRESSBARS );
<a name="l00343"></a>00343 
<a name="l00344"></a>00344       pCurr = <a class="code" href="Animated_01ProgressBar_8cpp.html#50a5c1599b088e7aca62806aee9298bf">pBar</a>[ubID];
<a name="l00345"></a>00345       <span class="keywordflow">if</span>( pCurr == NULL )
<a name="l00346"></a>00346             <span class="keywordflow">return</span>;
<a name="l00347"></a>00347 
<a name="l00348"></a>00348       pCurr-&gt;<a class="code" href="structPROGRESSBAR.html#fc3d8b0591dc0bb04dd8ec11f4f78759">fDisplayText</a> = fDisplayText;
<a name="l00349"></a>00349 
<a name="l00350"></a>00350       pCurr-&gt;<a class="code" href="structPROGRESSBAR.html#8954022fd6993e432fa789946bd2c958">fUseSaveBuffer</a> = fUseSaveBuffer;
<a name="l00351"></a>00351 
<a name="l00352"></a>00352       <span class="comment">//if we are to use the save buffer, blit the portion of the screen to the save buffer</span>
<a name="l00353"></a>00353       <span class="keywordflow">if</span>( fSaveScreenToFrameBuffer )
<a name="l00354"></a>00354       {
<a name="l00355"></a>00355             <a class="code" href="Types_8h.html#09f1a1fb2293e33483cc8d44aefb1eb1">UINT16</a> usFontHeight = <a class="code" href="Font_8cpp.html#35cddf34696d33489efb820caf968907">GetFontHeight</a>( pCurr-&gt;<a class="code" href="structPROGRESSBAR.html#0a2137b51d66125b82f9cefa006744fe">usMsgFont</a> )+3;
<a name="l00356"></a>00356 
<a name="l00357"></a>00357             <span class="comment">//blit everything to the save buffer ( cause the save buffer can bleed through )</span>
<a name="l00358"></a>00358             <a class="code" href="Render_01Dirty_8cpp.html#8be2dfedf23206c3c48200cc6279564f">BlitBufferToBuffer</a>(<a class="code" href="Interface_8cpp.html#b1f03a82938a7f565246d4c03d78ad03">guiRENDERBUFFER</a>, <a class="code" href="Map_01Screen_01Interface_8cpp.html#7d9956b05e9b87e244d4fdab6c4f71e4">guiSAVEBUFFER</a>, pCurr-&gt;<a class="code" href="structPROGRESSBAR.html#7af4253c459428c04900584adac62df9">usBarLeft</a>, pCurr-&gt;<a class="code" href="structPROGRESSBAR.html#070f34d486f273b980fd7a0aac9879c9">usBarBottom</a>, (<a class="code" href="Types_8h.html#09f1a1fb2293e33483cc8d44aefb1eb1">UINT16</a>)(pCurr-&gt;<a class="code" href="structPROGRESSBAR.html#db1f5cf8f78256b47ca09e15964f69f1">usBarRight</a>-pCurr-&gt;<a class="code" href="structPROGRESSBAR.html#7af4253c459428c04900584adac62df9">usBarLeft</a>), usFontHeight );
<a name="l00359"></a>00359       }
<a name="l00360"></a>00360 }
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Sat Sep 9 13:47:51 2006 for Build by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.4.7 </small></address>
</body>
</html>
