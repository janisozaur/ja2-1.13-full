<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>Build: Civ Quotes.cpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.4.7 -->
<div class="tabs">
  <ul>
    <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="classes.html"><span>Classes</span></a></li>
    <li id="current"><a href="files.html"><span>Files</span></a></li>
    <li><a href="dirs.html"><span>Directories</span></a></li>
    <li>
      <form action="search.php" method="get">
        <table cellspacing="0" cellpadding="0" border="0">
          <tr>
            <td><label>&nbsp;<u>S</u>earch&nbsp;for&nbsp;</label></td>
            <td><input type="text" name="query" value="" size="20" accesskey="s"/></td>
          </tr>
        </table>
      </form>
    </li>
  </ul></div>
<div class="tabs">
  <ul>
    <li><a href="files.html"><span>File&nbsp;List</span></a></li>
    <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
  </ul></div>
<div class="nav">
<a class="el" href="dir_3179ea33d55a76dc38212d9eab798728.html">export</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_e5664b4b56927c8728eb3192fa60e338.html">hdc2</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_1eb12a41a47efb9efcd82fa98f4f4dbd.html">FTP</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_80cc1f21a78ab7941088ea567f236150.html">ja2src</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_994ab287602efefceafe55287a3657d6.html">Build</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_43ed33c8f48e75fecb0508860a16371c.html">Tactical</a></div>
<h1>Civ Quotes.cpp</h1><a href="Civ_01Quotes_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">// WANNE 2 &lt;changed some lines&gt;</span>
<a name="l00002"></a>00002 <span class="preprocessor">#ifdef PRECOMPILEDHEADERS</span>
<a name="l00003"></a>00003 <span class="preprocessor"></span><span class="preprocessor">      #include "<a class="code" href="Tactical_01All_8h.html">Tactical All.h</a>"</span>
<a name="l00004"></a>00004 <span class="preprocessor">#endif</span>
<a name="l00005"></a>00005 <span class="preprocessor"></span>
<a name="l00006"></a>00006 
<a name="l00007"></a>00007 <span class="preprocessor">#define                 DIALOGUE_DEFAULT_WIDTH              200</span>
<a name="l00008"></a>00008 <span class="preprocessor"></span><span class="preprocessor">#define                 EXTREAMLY_LOW_TOWN_LOYALTY    20</span>
<a name="l00009"></a>00009 <span class="preprocessor"></span><span class="preprocessor">#define                 HIGH_TOWN_LOYALTY                               80</span>
<a name="l00010"></a>00010 <span class="preprocessor"></span><span class="preprocessor">#define                 CIV_QUOTE_HINT                                        99</span>
<a name="l00011"></a>00011 <span class="preprocessor"></span>
<a name="l00012"></a>00012 
<a name="l00013"></a><a class="code" href="structCIV__QUOTE.html">00013</a> <span class="keyword">typedef</span> <span class="keyword">struct</span>
<a name="l00014"></a>00014 <span class="keyword"></span>{
<a name="l00015"></a><a class="code" href="structCIV__QUOTE.html#11666c88419f66271bcb22d8a4f71058">00015</a>       <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubNumEntries;
<a name="l00016"></a><a class="code" href="structCIV__QUOTE.html#0a2f7c195b62b9cf9a1073d90bc52785">00016</a>       <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubUnusedCurrentEntry;
<a name="l00017"></a>00017 
<a name="l00018"></a>00018 } <a class="code" href="structCIV__QUOTE.html">CIV_QUOTE</a>;
<a name="l00019"></a>00019 
<a name="l00020"></a>00020 <span class="keyword">extern</span> <span class="keywordtype">void</span> <a class="code" href="Civ_01Quotes_8cpp.html#acd2da1c41da07e6d7c3d98daf32ff57">CaptureTimerCallback</a>( <span class="keywordtype">void</span> );
<a name="l00021"></a>00021 
<a name="l00022"></a><a class="code" href="Overhead_8cpp.html#8c2056e1636ef0d1ba9d93a42c6f1ef5">00022</a> <a class="code" href="Types_8h.html#112e3146cb38b6ee95e64d85842e380a">BOOLEAN</a> <a class="code" href="Civ_01Quotes_8cpp.html#8c2056e1636ef0d1ba9d93a42c6f1ef5">gfSurrendered</a> = FALSE;
<a name="l00023"></a>00023 
<a name="l00024"></a><a class="code" href="Civ_01Quotes_8cpp.html#c259a10701206b8c8dd6df405c556310">00024</a> <a class="code" href="structCIV__QUOTE.html">CIV_QUOTE</a>   <a class="code" href="Civ_01Quotes_8cpp.html#c259a10701206b8c8dd6df405c556310">gCivQuotes</a>[ <a class="code" href="Civ_01Quotes_8h.html#2db06901d03245a790e5571701aba3dfbb9b52384a2b7f1415f0b1b3de60ecad">NUM_CIV_QUOTES</a> ];
<a name="l00025"></a>00025 
<a name="l00026"></a><a class="code" href="Civ_01Quotes_8cpp.html#f664987ef2729286d986f9f90cf996da">00026</a> <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> <a class="code" href="Civ_01Quotes_8cpp.html#f664987ef2729286d986f9f90cf996da">gubNumEntries</a>[ <a class="code" href="Civ_01Quotes_8h.html#2db06901d03245a790e5571701aba3dfbb9b52384a2b7f1415f0b1b3de60ecad">NUM_CIV_QUOTES</a> ] =
<a name="l00027"></a>00027 {
<a name="l00028"></a>00028       15,
<a name="l00029"></a>00029       15,
<a name="l00030"></a>00030       15,
<a name="l00031"></a>00031       15,
<a name="l00032"></a>00032       15,
<a name="l00033"></a>00033       15,
<a name="l00034"></a>00034       15,
<a name="l00035"></a>00035       15,
<a name="l00036"></a>00036       15,
<a name="l00037"></a>00037       15,
<a name="l00038"></a>00038 
<a name="l00039"></a>00039       15,
<a name="l00040"></a>00040       15,
<a name="l00041"></a>00041       15,
<a name="l00042"></a>00042       15,
<a name="l00043"></a>00043       15,
<a name="l00044"></a>00044       15,
<a name="l00045"></a>00045       15,
<a name="l00046"></a>00046       15,
<a name="l00047"></a>00047       15,
<a name="l00048"></a>00048       15,
<a name="l00049"></a>00049 
<a name="l00050"></a>00050       5,
<a name="l00051"></a>00051       5,
<a name="l00052"></a>00052       15,
<a name="l00053"></a>00053       15,
<a name="l00054"></a>00054       15,
<a name="l00055"></a>00055       15,
<a name="l00056"></a>00056       15,
<a name="l00057"></a>00057       15,
<a name="l00058"></a>00058       15,
<a name="l00059"></a>00059       15,
<a name="l00060"></a>00060 
<a name="l00061"></a>00061       15,
<a name="l00062"></a>00062       15,
<a name="l00063"></a>00063       2,
<a name="l00064"></a>00064       15,
<a name="l00065"></a>00065       15,
<a name="l00066"></a>00066       10,
<a name="l00067"></a>00067       10,
<a name="l00068"></a>00068       5,
<a name="l00069"></a>00069       3,
<a name="l00070"></a>00070       10,
<a name="l00071"></a>00071 
<a name="l00072"></a>00072       3,
<a name="l00073"></a>00073       3,
<a name="l00074"></a>00074       3,
<a name="l00075"></a>00075       3,
<a name="l00076"></a>00076       3,
<a name="l00077"></a>00077       3,
<a name="l00078"></a>00078       3,
<a name="l00079"></a>00079       3,
<a name="l00080"></a>00080       3,
<a name="l00081"></a>00081       3
<a name="l00082"></a>00082 };
<a name="l00083"></a>00083 
<a name="l00084"></a>00084 
<a name="l00085"></a><a class="code" href="structQUOTE__SYSTEM__STRUCT.html">00085</a> <span class="keyword">typedef</span> <span class="keyword">struct</span>
<a name="l00086"></a>00086 <span class="keyword"></span>{
<a name="l00087"></a><a class="code" href="structQUOTE__SYSTEM__STRUCT.html#8641bb125b9845bc684f6b1e0495f613">00087</a>       <a class="code" href="Types_8h.html#112e3146cb38b6ee95e64d85842e380a">BOOLEAN</a>                       bActive;
<a name="l00088"></a><a class="code" href="structQUOTE__SYSTEM__STRUCT.html#180f15926616cd29d39702073690253f">00088</a>       <a class="code" href="struct__MOUSE__REGION.html">MOUSE_REGION</a>      MouseRegion;
<a name="l00089"></a><a class="code" href="structQUOTE__SYSTEM__STRUCT.html#687ed161b2d099e92fdd785fcaca73a3">00089</a>       <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a>                         iVideoOverlay;
<a name="l00090"></a><a class="code" href="structQUOTE__SYSTEM__STRUCT.html#333f1783acf7ad6a1d80ed483ce32cf4">00090</a>       <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a>                         <a class="code" href="mapscreen_8cpp.html#db5cbd83dc3fe3bcc57e6b38f6e57ba5">iDialogueBox</a>;
<a name="l00091"></a><a class="code" href="structQUOTE__SYSTEM__STRUCT.html#fa55d1e66ceef372cf7cfef72c978eb0">00091</a>       <a class="code" href="Types_8h.html#e1e6edbbc26d6fbc71a90190d0266018">UINT32</a>                        uiTimeOfCreation;
<a name="l00092"></a><a class="code" href="structQUOTE__SYSTEM__STRUCT.html#65fe9920ac9ca22df543ad4a51a87eba">00092</a>       <a class="code" href="Types_8h.html#e1e6edbbc26d6fbc71a90190d0266018">UINT32</a>                        uiDelayTime;
<a name="l00093"></a><a class="code" href="structQUOTE__SYSTEM__STRUCT.html#dba8564bfd3011dc21ff6a65262be774">00093</a>       <a class="code" href="structSOLDIERTYPE.html">SOLDIERTYPE</a> *     pCiv;
<a name="l00094"></a>00094 } <a class="code" href="structQUOTE__SYSTEM__STRUCT.html">QUOTE_SYSTEM_STRUCT</a>;
<a name="l00095"></a>00095 
<a name="l00096"></a>00096 
<a name="l00097"></a><a class="code" href="Civ_01Quotes_8cpp.html#46a4e0cbd887477d994d947d3b630589">00097</a> <a class="code" href="structQUOTE__SYSTEM__STRUCT.html">QUOTE_SYSTEM_STRUCT</a>     <a class="code" href="Civ_01Quotes_8cpp.html#46a4e0cbd887477d994d947d3b630589">gCivQuoteData</a>;
<a name="l00098"></a>00098 
<a name="l00099"></a><a class="code" href="Civ_01Quotes_8cpp.html#897259a18788d08860dbec9ebe6053fe">00099</a> <a class="code" href="Types_8h.html#30f500129d8c688af07726d5d34ce52d">INT16</a>       <a class="code" href="Civ_01Quotes_8cpp.html#897259a18788d08860dbec9ebe6053fe">gzCivQuote</a>[ 320 ];
<a name="l00100"></a><a class="code" href="Civ_01Quotes_8cpp.html#d611b03c442716a7c4e41225ab65df05">00100</a> <a class="code" href="Types_8h.html#09f1a1fb2293e33483cc8d44aefb1eb1">UINT16</a>      <a class="code" href="Civ_01Quotes_8cpp.html#d611b03c442716a7c4e41225ab65df05">gusCivQuoteBoxWidth</a>;
<a name="l00101"></a><a class="code" href="Civ_01Quotes_8cpp.html#d88432c785584daf9676f87b4c87fb3a">00101</a> <a class="code" href="Types_8h.html#09f1a1fb2293e33483cc8d44aefb1eb1">UINT16</a>      <a class="code" href="Civ_01Quotes_8cpp.html#d88432c785584daf9676f87b4c87fb3a">gusCivQuoteBoxHeight</a>;
<a name="l00102"></a>00102 
<a name="l00103"></a>00103 
<a name="l00104"></a><a class="code" href="Civ_01Quotes_8cpp.html#00b9058f3c653c6a816a04ee34928785">00104</a> <span class="keywordtype">void</span> <a class="code" href="Civ_01Quotes_8cpp.html#00b9058f3c653c6a816a04ee34928785">CopyNumEntriesIntoQuoteStruct</a>( )
<a name="l00105"></a>00105 {
<a name="l00106"></a>00106       <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a> cnt;
<a name="l00107"></a>00107 
<a name="l00108"></a>00108       <span class="keywordflow">for</span> ( cnt = 0; cnt &lt; <a class="code" href="Civ_01Quotes_8h.html#2db06901d03245a790e5571701aba3dfbb9b52384a2b7f1415f0b1b3de60ecad">NUM_CIV_QUOTES</a>; cnt++ )
<a name="l00109"></a>00109       {
<a name="l00110"></a>00110             <a class="code" href="Civ_01Quotes_8cpp.html#c259a10701206b8c8dd6df405c556310">gCivQuotes</a>[ cnt ].ubNumEntries = <a class="code" href="Civ_01Quotes_8cpp.html#f664987ef2729286d986f9f90cf996da">gubNumEntries</a>[ cnt ];
<a name="l00111"></a>00111       }
<a name="l00112"></a>00112 
<a name="l00113"></a>00113 }
<a name="l00114"></a>00114 
<a name="l00115"></a>00115 
<a name="l00116"></a><a class="code" href="Civ_01Quotes_8cpp.html#25f8761aa8b4b5e6e41dae7f4a50ea3e">00116</a> <a class="code" href="Types_8h.html#112e3146cb38b6ee95e64d85842e380a">BOOLEAN</a> <a class="code" href="Civ_01Quotes_8cpp.html#25f8761aa8b4b5e6e41dae7f4a50ea3e">GetCivQuoteText</a>( <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubCivQuoteID, <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubEntryID, <a class="code" href="Types_8h.html#30f500129d8c688af07726d5d34ce52d">INT16</a> *zQuote )
<a name="l00117"></a>00117 {
<a name="l00118"></a>00118       <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> zFileName[164];
<a name="l00119"></a>00119 
<a name="l00120"></a>00120       <span class="comment">// Build filename....</span>
<a name="l00121"></a>00121       <span class="keywordflow">if</span> ( ubCivQuoteID == CIV_QUOTE_HINT )
<a name="l00122"></a>00122       {
<a name="l00123"></a>00123     <span class="keywordflow">if</span> ( <a class="code" href="strategicmap_8cpp.html#da715721a8ceedd42acf6ddb33e63ce0">gbWorldSectorZ</a> &gt; 0 )
<a name="l00124"></a>00124     {
<a name="l00125"></a>00125               <span class="comment">//sprintf( zFileName, "NPCData\\miners.edt" );</span>
<a name="l00126"></a>00126             sprintf( (<span class="keywordtype">char</span> *)zFileName,<span class="stringliteral">"NPCDATA\\CIV%02d.edt"</span>, <a class="code" href="Civ_01Quotes_8h.html#2db06901d03245a790e5571701aba3df755fe041476c58845a3ee67a2b8e05a1">CIV_QUOTE_MINERS_NOT_FOR_PLAYER</a> );
<a name="l00127"></a>00127     }
<a name="l00128"></a>00128     <span class="keywordflow">else</span>
<a name="l00129"></a>00129     {
<a name="l00130"></a>00130               sprintf( (<span class="keywordtype">char</span> *)zFileName, <span class="stringliteral">"NPCData\\%c%d.edt"</span>, <span class="charliteral">'A'</span> + (<a class="code" href="strategicmap_8cpp.html#ea322310ced0e35ee18a2ee7b32aac5b">gWorldSectorY</a> - 1) , <a class="code" href="strategicmap_8cpp.html#49d9aed144a633fda4ba1990f002d703">gWorldSectorX</a> );
<a name="l00131"></a>00131     }
<a name="l00132"></a>00132       }
<a name="l00133"></a>00133       <span class="keywordflow">else</span>
<a name="l00134"></a>00134       {
<a name="l00135"></a>00135             sprintf( (<span class="keywordtype">char</span> *)zFileName,<span class="stringliteral">"NPCDATA\\CIV%02d.edt"</span>,ubCivQuoteID );
<a name="l00136"></a>00136       }
<a name="l00137"></a>00137 
<a name="l00138"></a>00138       CHECKF( <a class="code" href="FileMan_8cpp.html#8eb098ceba9cecc2c60c7e40c964e147">FileExists</a>( (<a class="code" href="Types_8h.html#ba0652aa53ceb4404f77e13a0c993b0e">STR</a>)zFileName ) );
<a name="l00139"></a>00139 
<a name="l00140"></a>00140       <span class="comment">// Get data...</span>
<a name="l00141"></a>00141       <a class="code" href="Encrypted_01File_8cpp.html#4829a9b091fed92156de5aae7ba5037c">LoadEncryptedDataFromFile</a>( (<a class="code" href="Types_8h.html#ba0652aa53ceb4404f77e13a0c993b0e">STR</a>)zFileName, (<a class="code" href="Types_8h.html#94ebfccc6e846c28751f8d616371f1e5">STR16</a>)zQuote, ubEntryID * 320, 320 );
<a name="l00142"></a>00142 
<a name="l00143"></a>00143       <span class="keywordflow">if</span>( zQuote[0] == 0 ) 
<a name="l00144"></a>00144       {
<a name="l00145"></a>00145             <span class="keywordflow">return</span>( FALSE );
<a name="l00146"></a>00146       }
<a name="l00147"></a>00147 
<a name="l00148"></a>00148       <span class="keywordflow">return</span>( TRUE );
<a name="l00149"></a>00149 }
<a name="l00150"></a>00150 
<a name="l00151"></a><a class="code" href="Civ_01Quotes_8cpp.html#ac3d6090756d1b022b0c48ffcc155c31">00151</a> <span class="keywordtype">void</span> <a class="code" href="Civ_01Quotes_8cpp.html#ac3d6090756d1b022b0c48ffcc155c31">SurrenderMessageBoxCallBack</a>( <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubExitValue )
<a name="l00152"></a>00152 {
<a name="l00153"></a>00153       <a class="code" href="structSOLDIERTYPE.html">SOLDIERTYPE</a> *pTeamSoldier;
<a name="l00154"></a>00154       <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a>                   cnt = 0;
<a name="l00155"></a>00155 
<a name="l00156"></a>00156       <span class="keywordflow">if</span> ( ubExitValue == MSG_BOX_RETURN_YES )
<a name="l00157"></a>00157       {
<a name="l00158"></a>00158             <span class="comment">// CJC Dec 1 2002: fix multiple captures</span>
<a name="l00159"></a>00159             <a class="code" href="Queen_01Command_8cpp.html#e6ee054347c9fea2bda57eecd323a702">BeginCaptureSquence</a>();
<a name="l00160"></a>00160 
<a name="l00161"></a>00161     <span class="comment">// Do capture....</span>
<a name="l00162"></a>00162             cnt = <a class="code" href="Overhead_8cpp.html#46bd754f8875c305ab18731ed10e3364">gTacticalStatus</a>.<a class="code" href="structTacticalStatusType.html#2ecddfe580bb019bc92cc4859eaf3edc">Team</a>[ <a class="code" href="Campaign_8cpp.html#47b2067ff75193e24776eda5297400ff">gbPlayerNum</a> ].<a class="code" href="structTacticalTeamType.html#f8fe819ad07b242f5dbf97fd4c69b00d">bFirstID</a>;
<a name="l00163"></a>00163 
<a name="l00164"></a>00164             <span class="keywordflow">for</span> ( pTeamSoldier = <a class="code" href="Overhead_8cpp.html#2b9a828d7d92ec404b2f9a39fc001177">MercPtrs</a>[ cnt ]; cnt &lt;= <a class="code" href="Overhead_8cpp.html#46bd754f8875c305ab18731ed10e3364">gTacticalStatus</a>.<a class="code" href="structTacticalStatusType.html#2ecddfe580bb019bc92cc4859eaf3edc">Team</a>[ <a class="code" href="Campaign_8cpp.html#47b2067ff75193e24776eda5297400ff">gbPlayerNum</a> ].<a class="code" href="structTacticalTeamType.html#6a887279dad735dc302f21c1e559d5ce">bLastID</a>; cnt++,pTeamSoldier++)
<a name="l00165"></a>00165             {
<a name="l00166"></a>00166                   <span class="comment">// Are we active and in sector.....</span>
<a name="l00167"></a>00167                   <span class="keywordflow">if</span> ( pTeamSoldier-&gt;<a class="code" href="structSOLDIERTYPE.html#653dad4e2520784e293eca9f948b8532">bActive</a> &amp;&amp; pTeamSoldier-&gt;<a class="code" href="structSOLDIERTYPE.html#b0096f321a0de4f0617283f7b3212aa0">bInSector</a> )
<a name="l00168"></a>00168                   {
<a name="l00169"></a>00169         <a class="code" href="Soldier_01Ani_8cpp.html#c294aa65f0375eb6343a2de2a25dafcc">if</a> ( pTeamSoldier-&gt;<a class="code" href="structSOLDIERTYPE.html#e308dea18533bf5ab2bcee5bbe27391c">bLife</a> != 0 )
<a name="l00170"></a>00170                         {
<a name="l00171"></a>00171                               <a class="code" href="Queen_01Command_8cpp.html#960be89c7c057d267ca17aa99e0eaf12">EnemyCapturesPlayerSoldier</a>( pTeamSoldier );
<a name="l00172"></a>00172 
<a name="l00173"></a>00173                               <a class="code" href="Overhead_8cpp.html#50643ef37ccbebf77a5369d15fd98788">RemoveSoldierFromTacticalSector</a>( pTeamSoldier, TRUE );
<a name="l00174"></a>00174                         }
<a name="l00175"></a>00175                   }
<a name="l00176"></a>00176     }
<a name="l00177"></a>00177 
<a name="l00178"></a>00178             <a class="code" href="Queen_01Command_8cpp.html#2547800f566c4e90ec455371acf7efdd">EndCaptureSequence</a>( );
<a name="l00179"></a>00179 
<a name="l00180"></a>00180             <a class="code" href="Civ_01Quotes_8cpp.html#8c2056e1636ef0d1ba9d93a42c6f1ef5">gfSurrendered</a> = TRUE;
<a name="l00181"></a>00181             <a class="code" href="Timer_01Control_8cpp.html#ea6ae1cc206c97b220fafdb86bf158e5">SetCustomizableTimerCallbackAndDelay</a>( 3000, <a class="code" href="Civ_01Quotes_8cpp.html#acd2da1c41da07e6d7c3d98daf32ff57">CaptureTimerCallback</a>, FALSE );
<a name="l00182"></a>00182 
<a name="l00183"></a>00183             <a class="code" href="ai_8h.html#2d2dfafa627e9e83dd1b60f538138f7e">ActionDone</a>( <a class="code" href="Civ_01Quotes_8cpp.html#46a4e0cbd887477d994d947d3b630589">gCivQuoteData</a>.<a class="code" href="structQUOTE__SYSTEM__STRUCT.html#dba8564bfd3011dc21ff6a65262be774">pCiv</a> );
<a name="l00184"></a>00184       }
<a name="l00185"></a>00185       <span class="keywordflow">else</span>
<a name="l00186"></a>00186       {
<a name="l00187"></a>00187             <a class="code" href="ai_8h.html#2d2dfafa627e9e83dd1b60f538138f7e">ActionDone</a>( <a class="code" href="Civ_01Quotes_8cpp.html#46a4e0cbd887477d994d947d3b630589">gCivQuoteData</a>.<a class="code" href="structQUOTE__SYSTEM__STRUCT.html#dba8564bfd3011dc21ff6a65262be774">pCiv</a> );
<a name="l00188"></a>00188       }
<a name="l00189"></a>00189 }
<a name="l00190"></a>00190 
<a name="l00191"></a><a class="code" href="Civ_01Quotes_8cpp.html#668d73e6a53e410c417fabb3f70c50de">00191</a> <span class="keywordtype">void</span> <a class="code" href="Civ_01Quotes_8cpp.html#668d73e6a53e410c417fabb3f70c50de">ShutDownQuoteBox</a>( <a class="code" href="Types_8h.html#112e3146cb38b6ee95e64d85842e380a">BOOLEAN</a> fForce )
<a name="l00192"></a>00192 {
<a name="l00193"></a>00193       <span class="keywordflow">if</span> ( !<a class="code" href="Civ_01Quotes_8cpp.html#46a4e0cbd887477d994d947d3b630589">gCivQuoteData</a>.<a class="code" href="structQUOTE__SYSTEM__STRUCT.html#8641bb125b9845bc684f6b1e0495f613">bActive</a> )
<a name="l00194"></a>00194       {
<a name="l00195"></a>00195             <span class="keywordflow">return</span>;
<a name="l00196"></a>00196       }
<a name="l00197"></a>00197       
<a name="l00198"></a>00198       <span class="comment">// Check for min time....</span>
<a name="l00199"></a>00199       <span class="keywordflow">if</span> ( ( GetJA2Clock( ) - <a class="code" href="Civ_01Quotes_8cpp.html#46a4e0cbd887477d994d947d3b630589">gCivQuoteData</a>.<a class="code" href="structQUOTE__SYSTEM__STRUCT.html#fa55d1e66ceef372cf7cfef72c978eb0">uiTimeOfCreation</a> ) &gt; 300 || fForce )
<a name="l00200"></a>00200       {
<a name="l00201"></a>00201             <a class="code" href="Render_01Dirty_8cpp.html#0522d0982c3f7c9f6d60ce4c3f669a3e">RemoveVideoOverlay</a>( <a class="code" href="Civ_01Quotes_8cpp.html#46a4e0cbd887477d994d947d3b630589">gCivQuoteData</a>.<a class="code" href="structQUOTE__SYSTEM__STRUCT.html#687ed161b2d099e92fdd785fcaca73a3">iVideoOverlay</a> );
<a name="l00202"></a>00202 
<a name="l00203"></a>00203             <span class="comment">// Remove mouse region...</span>
<a name="l00204"></a>00204             <a class="code" href="mousesystem_8cpp.html#f2581a6cadb531c87ebd6b3f5b70f258">MSYS_RemoveRegion</a>( &amp;(<a class="code" href="Civ_01Quotes_8cpp.html#46a4e0cbd887477d994d947d3b630589">gCivQuoteData</a>.<a class="code" href="structQUOTE__SYSTEM__STRUCT.html#180f15926616cd29d39702073690253f">MouseRegion</a>) );
<a name="l00205"></a>00205 
<a name="l00206"></a>00206     <a class="code" href="MercTextBox_8cpp.html#9fb5266c0334e5697b57e0191f261f9f">RemoveMercPopupBoxFromIndex</a>( <a class="code" href="Civ_01Quotes_8cpp.html#46a4e0cbd887477d994d947d3b630589">gCivQuoteData</a>.<a class="code" href="structQUOTE__SYSTEM__STRUCT.html#333f1783acf7ad6a1d80ed483ce32cf4">iDialogueBox</a> );
<a name="l00207"></a>00207     <a class="code" href="Civ_01Quotes_8cpp.html#46a4e0cbd887477d994d947d3b630589">gCivQuoteData</a>.<a class="code" href="structQUOTE__SYSTEM__STRUCT.html#333f1783acf7ad6a1d80ed483ce32cf4">iDialogueBox</a> = -1;
<a name="l00208"></a>00208 
<a name="l00209"></a>00209             <a class="code" href="Civ_01Quotes_8cpp.html#46a4e0cbd887477d994d947d3b630589">gCivQuoteData</a>.<a class="code" href="structQUOTE__SYSTEM__STRUCT.html#8641bb125b9845bc684f6b1e0495f613">bActive</a> = FALSE;
<a name="l00210"></a>00210 
<a name="l00211"></a>00211             <span class="comment">// do we need to do anything at the end of the civ quote?</span>
<a name="l00212"></a>00212             <span class="keywordflow">if</span> ( <a class="code" href="Civ_01Quotes_8cpp.html#46a4e0cbd887477d994d947d3b630589">gCivQuoteData</a>.<a class="code" href="structQUOTE__SYSTEM__STRUCT.html#dba8564bfd3011dc21ff6a65262be774">pCiv</a> &amp;&amp; <a class="code" href="Civ_01Quotes_8cpp.html#46a4e0cbd887477d994d947d3b630589">gCivQuoteData</a>.<a class="code" href="structQUOTE__SYSTEM__STRUCT.html#dba8564bfd3011dc21ff6a65262be774">pCiv</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#70fc2b64ddf6ed6358c954ff3f200ce7">bAction</a> == <a class="code" href="ai_8h.html#21d5e8f8cdaa838586b31007df0a950be0a0afbead0db144e6da11231dbf9199">AI_ACTION_OFFER_SURRENDER</a> )
<a name="l00213"></a>00213             {
<a name="l00214"></a>00214                   <a class="code" href="MessageBoxScreen_8cpp.html#ff890475da4a6f8d61959852ea396a03">DoMessageBox</a>( <a class="code" href="MessageBoxScreen_8h.html#2f1398dba5e4a5616b83437528bdb28edfaaee6cf60e9dcec27ec0650dbbc39f">MSG_BOX_BASIC_STYLE</a>, <a class="code" href="__DutchText_8cpp.html#7813bcd58c4aa688254799c95ea7c6fa">Message</a>[ <a class="code" href="Text_8h.html#2bace310ffbaa508709e8fbb38af6ef313a67833a85be679f1fd392b627f103e">STR_SURRENDER</a> ], <a class="code" href="screenids_8h.html#a4ee5dea8709d2b490486a62df77faf29873e16bc1530dedb416060abbeea6d0">GAME_SCREEN</a>, ( <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> )MSG_BOX_FLAG_YESNO, <a class="code" href="Civ_01Quotes_8cpp.html#ac3d6090756d1b022b0c48ffcc155c31">SurrenderMessageBoxCallBack</a>, NULL );
<a name="l00215"></a>00215             }
<a name="l00216"></a>00216       }
<a name="l00217"></a>00217 }
<a name="l00218"></a>00218 
<a name="l00219"></a><a class="code" href="Civ_01Quotes_8h.html#1dc5f72dac9601719d4249d6da51f485">00219</a> <a class="code" href="Types_8h.html#112e3146cb38b6ee95e64d85842e380a">BOOLEAN</a> <a class="code" href="Civ_01Quotes_8cpp.html#1dc5f72dac9601719d4249d6da51f485">ShutDownQuoteBoxIfActive</a>( )
<a name="l00220"></a>00220 {
<a name="l00221"></a>00221       <span class="keywordflow">if</span> ( <a class="code" href="Civ_01Quotes_8cpp.html#46a4e0cbd887477d994d947d3b630589">gCivQuoteData</a>.<a class="code" href="structQUOTE__SYSTEM__STRUCT.html#8641bb125b9845bc684f6b1e0495f613">bActive</a> )
<a name="l00222"></a>00222       {
<a name="l00223"></a>00223             <a class="code" href="Civ_01Quotes_8cpp.html#668d73e6a53e410c417fabb3f70c50de">ShutDownQuoteBox</a>( TRUE );
<a name="l00224"></a>00224 
<a name="l00225"></a>00225             <span class="keywordflow">return</span>( TRUE );
<a name="l00226"></a>00226       }
<a name="l00227"></a>00227 
<a name="l00228"></a>00228       <span class="keywordflow">return</span>( FALSE );
<a name="l00229"></a>00229 }
<a name="l00230"></a>00230 
<a name="l00231"></a>00231 
<a name="l00232"></a><a class="code" href="Civ_01Quotes_8h.html#d11e61c034e184ba78fbc5f5a509ad91">00232</a> <a class="code" href="Types_8h.html#7ebe70ceca856797319175e30bcf003d">INT8</a> <a class="code" href="Civ_01Quotes_8cpp.html#d11e61c034e184ba78fbc5f5a509ad91">GetCivType</a>( <a class="code" href="structSOLDIERTYPE.html">SOLDIERTYPE</a> *pCiv )
<a name="l00233"></a>00233 {
<a name="l00234"></a>00234       <span class="keywordflow">if</span> ( pCiv-&gt;<a class="code" href="structSOLDIERTYPE.html#5a5648a1bb3507cc41f6be199c51a3f8">ubProfile</a> != NO_PROFILE )
<a name="l00235"></a>00235       {
<a name="l00236"></a>00236             <span class="keywordflow">return</span>( CIV_TYPE_NA );
<a name="l00237"></a>00237       }
<a name="l00238"></a>00238 
<a name="l00239"></a>00239       <span class="comment">// ATE: Check if this person is married.....</span>
<a name="l00240"></a>00240       <span class="comment">// 1 ) check sector....</span>
<a name="l00241"></a>00241       <span class="keywordflow">if</span> ( <a class="code" href="strategicmap_8cpp.html#49d9aed144a633fda4ba1990f002d703">gWorldSectorX</a> == 10 &amp;&amp; <a class="code" href="strategicmap_8cpp.html#ea322310ced0e35ee18a2ee7b32aac5b">gWorldSectorY</a> == 6 &amp;&amp; <a class="code" href="strategicmap_8cpp.html#da715721a8ceedd42acf6ddb33e63ce0">gbWorldSectorZ</a> == 0 )
<a name="l00242"></a>00242       {
<a name="l00243"></a>00243     <span class="comment">// 2 ) the only female....</span>
<a name="l00244"></a>00244     <span class="keywordflow">if</span> ( pCiv-&gt;<a class="code" href="structSOLDIERTYPE.html#d250d43185690987945d6884efdf79fc">ubCivilianGroup</a> == 0 &amp;&amp; pCiv-&gt;<a class="code" href="structSOLDIERTYPE.html#74a40a8aaf3efe840cdaf6be62556d82">bTeam</a> != <a class="code" href="Campaign_8cpp.html#47b2067ff75193e24776eda5297400ff">gbPlayerNum</a> &amp;&amp; pCiv-&gt;<a class="code" href="structSOLDIERTYPE.html#b082364eed3d7883662f69e1fd96be1a">ubBodyType</a> == <a class="code" href="Animation_01Data_8h.html#d295a916825180b548473dec560093a7040d5c40e76c4103ced101507f96e2f6">REGFEMALE</a> )
<a name="l00245"></a>00245             {
<a name="l00246"></a>00246                   <span class="comment">// She's a ho!</span>
<a name="l00247"></a>00247                   <span class="keywordflow">return</span>( CIV_TYPE_MARRIED_PC );
<a name="l00248"></a>00248             }
<a name="l00249"></a>00249       }
<a name="l00250"></a>00250 
<a name="l00251"></a>00251       <span class="comment">// OK, look for enemy type - MUST be on enemy team, merc bodytype</span>
<a name="l00252"></a>00252       <span class="keywordflow">if</span> ( pCiv-&gt;<a class="code" href="structSOLDIERTYPE.html#74a40a8aaf3efe840cdaf6be62556d82">bTeam</a> == ENEMY_TEAM &amp;&amp; IS_MERC_BODY_TYPE( pCiv ) )
<a name="l00253"></a>00253       {
<a name="l00254"></a>00254             <span class="keywordflow">return</span>( CIV_TYPE_ENEMY );
<a name="l00255"></a>00255       }
<a name="l00256"></a>00256 
<a name="l00257"></a>00257       <span class="keywordflow">if</span> ( pCiv-&gt;<a class="code" href="structSOLDIERTYPE.html#74a40a8aaf3efe840cdaf6be62556d82">bTeam</a> != CIV_TEAM &amp;&amp; pCiv-&gt;<a class="code" href="structSOLDIERTYPE.html#74a40a8aaf3efe840cdaf6be62556d82">bTeam</a> != MILITIA_TEAM )
<a name="l00258"></a>00258       {
<a name="l00259"></a>00259             <span class="keywordflow">return</span>( CIV_TYPE_NA );
<a name="l00260"></a>00260       }
<a name="l00261"></a>00261 
<a name="l00262"></a>00262       <span class="keywordflow">switch</span>( pCiv-&gt;<a class="code" href="structSOLDIERTYPE.html#b082364eed3d7883662f69e1fd96be1a">ubBodyType</a> )
<a name="l00263"></a>00263       {
<a name="l00264"></a>00264             <span class="keywordflow">case</span> <a class="code" href="Animation_01Data_8h.html#d295a916825180b548473dec560093a788083a907978249a0160b5b1dd9ee4a4">REGMALE</a>:
<a name="l00265"></a>00265             <span class="keywordflow">case</span> <a class="code" href="Animation_01Data_8h.html#d295a916825180b548473dec560093a7e6eac15857ce481c9ed507f7459a3507">BIGMALE</a>:
<a name="l00266"></a>00266             <span class="keywordflow">case</span> <a class="code" href="Animation_01Data_8h.html#d295a916825180b548473dec560093a73a7e8d65cd007e97390c6a3ae18062ce">STOCKYMALE</a>:
<a name="l00267"></a>00267             <span class="keywordflow">case</span> <a class="code" href="Animation_01Data_8h.html#d295a916825180b548473dec560093a7040d5c40e76c4103ced101507f96e2f6">REGFEMALE</a>:
<a name="l00268"></a>00268             <span class="keywordflow">case</span> <a class="code" href="Animation_01Data_8h.html#d295a916825180b548473dec560093a72254b6f06629056dd86be50df5347676">FATCIV</a>:
<a name="l00269"></a>00269             <span class="keywordflow">case</span> <a class="code" href="Animation_01Data_8h.html#d295a916825180b548473dec560093a7f084d9af5cfa408362f35095268783f6">MANCIV</a>:
<a name="l00270"></a>00270             <span class="keywordflow">case</span> <a class="code" href="Animation_01Data_8h.html#d295a916825180b548473dec560093a7af422ea2d015cab1eb7d0cf653186a05">MINICIV</a>:
<a name="l00271"></a>00271             <span class="keywordflow">case</span> <a class="code" href="Animation_01Data_8h.html#d295a916825180b548473dec560093a734700b4c6e766408a86e53420c62163c">DRESSCIV</a>:
<a name="l00272"></a>00272             <span class="keywordflow">case</span> <a class="code" href="Animation_01Data_8h.html#d295a916825180b548473dec560093a75db4e8d299d195df30798a12cd332f5a">CRIPPLECIV</a>:
<a name="l00273"></a>00273 
<a name="l00274"></a>00274                   <span class="keywordflow">return</span>( CIV_TYPE_ADULT );
<a name="l00275"></a>00275                   <span class="keywordflow">break</span>;
<a name="l00276"></a>00276 
<a name="l00277"></a>00277             <span class="keywordflow">case</span> <a class="code" href="Animation_01Data_8h.html#d295a916825180b548473dec560093a78e8f2de8ab141e991ee2b34ebb1dfda1">ADULTFEMALEMONSTER</a>:
<a name="l00278"></a>00278             <span class="keywordflow">case</span> <a class="code" href="Animation_01Data_8h.html#d295a916825180b548473dec560093a79dec21a470d88f8b8a8704cb9b5ac827">AM_MONSTER</a>:
<a name="l00279"></a>00279             <span class="keywordflow">case</span> <a class="code" href="Animation_01Data_8h.html#d295a916825180b548473dec560093a75f60be3c60e156d8cec34802d7f3607b">YAF_MONSTER</a>:
<a name="l00280"></a>00280             <span class="keywordflow">case</span> <a class="code" href="Animation_01Data_8h.html#d295a916825180b548473dec560093a725460f03079c143c4456f779763fa23b">YAM_MONSTER</a>:
<a name="l00281"></a>00281             <span class="keywordflow">case</span> <a class="code" href="Animation_01Data_8h.html#d295a916825180b548473dec560093a7c6b7363ef12dbe5ad2377613a3d33db9">LARVAE_MONSTER</a>:
<a name="l00282"></a>00282             <span class="keywordflow">case</span> <a class="code" href="Animation_01Data_8h.html#d295a916825180b548473dec560093a7e687bcc336b8be3ac4aac1346046d095">INFANT_MONSTER</a>:
<a name="l00283"></a>00283             <span class="keywordflow">case</span> <a class="code" href="Animation_01Data_8h.html#d295a916825180b548473dec560093a75f327a7c32f4f979f42e8d6f6adbf587">QUEENMONSTER</a>:
<a name="l00284"></a>00284 
<a name="l00285"></a>00285                   <span class="keywordflow">return</span>( CIV_TYPE_NA );
<a name="l00286"></a>00286 
<a name="l00287"></a>00287             <span class="keywordflow">case</span> <a class="code" href="Animation_01Data_8h.html#d295a916825180b548473dec560093a7d280093211f32a309c7e52bc1e4570c8">HATKIDCIV</a>:
<a name="l00288"></a>00288             <span class="keywordflow">case</span> <a class="code" href="Animation_01Data_8h.html#d295a916825180b548473dec560093a7572e26862c1a3864663d8fe55b2f7f4d">KIDCIV</a>:
<a name="l00289"></a>00289 
<a name="l00290"></a>00290                   <span class="keywordflow">return</span>( CIV_TYPE_KID );
<a name="l00291"></a>00291 
<a name="l00292"></a>00292             <span class="keywordflow">default</span>:
<a name="l00293"></a>00293 
<a name="l00294"></a>00294                   <span class="keywordflow">return</span>( CIV_TYPE_NA );
<a name="l00295"></a>00295       }
<a name="l00296"></a>00296 
<a name="l00297"></a>00297       <span class="comment">//return( CIV_TYPE_NA ); // not needed when there is a default! (jonathanl)</span>
<a name="l00298"></a>00298 }
<a name="l00299"></a>00299 
<a name="l00300"></a>00300 
<a name="l00301"></a><a class="code" href="Civ_01Quotes_8cpp.html#564547207c53083b916de6f70b14023e">00301</a> <span class="keywordtype">void</span> <a class="code" href="Civ_01Quotes_8cpp.html#564547207c53083b916de6f70b14023e">RenderCivQuoteBoxOverlay</a>( <a class="code" href="struct__VIDEO__OVERLAY.html">VIDEO_OVERLAY</a> *pBlitter )
<a name="l00302"></a>00302 {
<a name="l00303"></a>00303       <span class="keywordflow">if</span> ( <a class="code" href="Civ_01Quotes_8cpp.html#46a4e0cbd887477d994d947d3b630589">gCivQuoteData</a>.<a class="code" href="structQUOTE__SYSTEM__STRUCT.html#687ed161b2d099e92fdd785fcaca73a3">iVideoOverlay</a> != -1 )
<a name="l00304"></a>00304       {
<a name="l00305"></a>00305             <a class="code" href="MercTextBox_8cpp.html#1a30460151dbdd05f52104b447177f1c">RenderMercPopUpBoxFromIndex</a>( <a class="code" href="Civ_01Quotes_8cpp.html#46a4e0cbd887477d994d947d3b630589">gCivQuoteData</a>.<a class="code" href="structQUOTE__SYSTEM__STRUCT.html#333f1783acf7ad6a1d80ed483ce32cf4">iDialogueBox</a>, pBlitter-&gt;<a class="code" href="struct__VIDEO__OVERLAY.html#642759f932a874e352d7ce0eb7623cea">sX</a>, pBlitter-&gt;<a class="code" href="struct__VIDEO__OVERLAY.html#b54ace22d7d47bd7bc9e74a1ca607c7a">sY</a>,  pBlitter-&gt;<a class="code" href="struct__VIDEO__OVERLAY.html#f37dfb7dc1b9498f8f9f831d033b691b">uiDestBuff</a> );
<a name="l00306"></a>00306 
<a name="l00307"></a>00307             <a class="code" href="video_8cpp.html#4ed7790da612ff97bf9c05cf186823bc">InvalidateRegion</a>( pBlitter-&gt;<a class="code" href="struct__VIDEO__OVERLAY.html#642759f932a874e352d7ce0eb7623cea">sX</a>, pBlitter-&gt;<a class="code" href="struct__VIDEO__OVERLAY.html#b54ace22d7d47bd7bc9e74a1ca607c7a">sY</a>, pBlitter-&gt;<a class="code" href="struct__VIDEO__OVERLAY.html#642759f932a874e352d7ce0eb7623cea">sX</a> + <a class="code" href="Civ_01Quotes_8cpp.html#d611b03c442716a7c4e41225ab65df05">gusCivQuoteBoxWidth</a>, pBlitter-&gt;<a class="code" href="struct__VIDEO__OVERLAY.html#b54ace22d7d47bd7bc9e74a1ca607c7a">sY</a> + <a class="code" href="Civ_01Quotes_8cpp.html#d88432c785584daf9676f87b4c87fb3a">gusCivQuoteBoxHeight</a> );
<a name="l00308"></a>00308       }
<a name="l00309"></a>00309 }
<a name="l00310"></a>00310 
<a name="l00311"></a>00311 
<a name="l00312"></a><a class="code" href="Civ_01Quotes_8cpp.html#fca379c322e2bad393f0eedcbf4ffcb5">00312</a> <span class="keywordtype">void</span> <a class="code" href="Civ_01Quotes_8cpp.html#fca379c322e2bad393f0eedcbf4ffcb5">QuoteOverlayClickCallback</a>( <a class="code" href="struct__MOUSE__REGION.html">MOUSE_REGION</a> * pRegion, <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a> iReason )
<a name="l00313"></a>00313 {
<a name="l00314"></a>00314       <span class="keyword">static</span> <a class="code" href="Types_8h.html#112e3146cb38b6ee95e64d85842e380a">BOOLEAN</a> fLButtonDown = FALSE;
<a name="l00315"></a>00315 
<a name="l00316"></a>00316       <span class="keywordflow">if</span> (iReason &amp; MSYS_CALLBACK_REASON_LBUTTON_DWN )
<a name="l00317"></a>00317       {
<a name="l00318"></a>00318             fLButtonDown = TRUE;
<a name="l00319"></a>00319       }
<a name="l00320"></a>00320 
<a name="l00321"></a>00321       <span class="keywordflow">if</span> (iReason &amp; MSYS_CALLBACK_REASON_LBUTTON_UP &amp;&amp; fLButtonDown )
<a name="l00322"></a>00322       {
<a name="l00323"></a>00323             <span class="comment">// Shutdown quote box....</span>
<a name="l00324"></a>00324             <a class="code" href="Civ_01Quotes_8cpp.html#668d73e6a53e410c417fabb3f70c50de">ShutDownQuoteBox</a>( FALSE );
<a name="l00325"></a>00325       }
<a name="l00326"></a>00326       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (iReason &amp; MSYS_CALLBACK_REASON_LOST_MOUSE )
<a name="l00327"></a>00327       {
<a name="l00328"></a>00328             fLButtonDown = FALSE;
<a name="l00329"></a>00329       }
<a name="l00330"></a>00330 }
<a name="l00331"></a>00331 
<a name="l00332"></a>00332 
<a name="l00333"></a><a class="code" href="Civ_01Quotes_8h.html#77d064dff1b7b3fc582fd2de3a6faed6">00333</a> <span class="keywordtype">void</span> <a class="code" href="Civ_01Quotes_8cpp.html#77d064dff1b7b3fc582fd2de3a6faed6">BeginCivQuote</a>( <a class="code" href="structSOLDIERTYPE.html">SOLDIERTYPE</a> *pCiv, <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubCivQuoteID, <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubEntryID, <a class="code" href="Types_8h.html#30f500129d8c688af07726d5d34ce52d">INT16</a> sX, <a class="code" href="Types_8h.html#30f500129d8c688af07726d5d34ce52d">INT16</a> sY )
<a name="l00334"></a>00334 {
<a name="l00335"></a>00335       <a class="code" href="structVIDEO__OVERLAY__DESC.html">VIDEO_OVERLAY_DESC</a>            VideoOverlayDesc;
<a name="l00336"></a>00336       <a class="code" href="Types_8h.html#30f500129d8c688af07726d5d34ce52d">INT16</a>                                                 zQuote[ 320 ];
<a name="l00337"></a>00337 
<a name="l00338"></a>00338       <span class="comment">// OK, do we have another on?</span>
<a name="l00339"></a>00339       <span class="keywordflow">if</span> ( <a class="code" href="Civ_01Quotes_8cpp.html#46a4e0cbd887477d994d947d3b630589">gCivQuoteData</a>.<a class="code" href="structQUOTE__SYSTEM__STRUCT.html#8641bb125b9845bc684f6b1e0495f613">bActive</a> )
<a name="l00340"></a>00340       {
<a name="l00341"></a>00341             <span class="comment">// Delete?</span>
<a name="l00342"></a>00342             <a class="code" href="Civ_01Quotes_8cpp.html#668d73e6a53e410c417fabb3f70c50de">ShutDownQuoteBox</a>( TRUE );
<a name="l00343"></a>00343       }
<a name="l00344"></a>00344 
<a name="l00345"></a>00345       <span class="comment">// get text</span>
<a name="l00346"></a>00346       <span class="keywordflow">if</span> ( !<a class="code" href="Civ_01Quotes_8cpp.html#25f8761aa8b4b5e6e41dae7f4a50ea3e">GetCivQuoteText</a>( ubCivQuoteID, ubEntryID, zQuote ) )
<a name="l00347"></a>00347       {
<a name="l00348"></a>00348             <span class="keywordflow">return</span>;
<a name="l00349"></a>00349       }
<a name="l00350"></a>00350 
<a name="l00351"></a>00351 <span class="preprocessor">#ifdef TAIWANESE</span>
<a name="l00352"></a>00352 <span class="preprocessor"></span>      swprintf( (<span class="keywordtype">wchar_t</span> *)<a class="code" href="Civ_01Quotes_8cpp.html#897259a18788d08860dbec9ebe6053fe">gzCivQuote</a>, (<span class="keywordtype">wchar_t</span> *)L<span class="stringliteral">"%s"</span>, zQuote );
<a name="l00353"></a>00353 <span class="preprocessor">#else</span>
<a name="l00354"></a>00354 <span class="preprocessor"></span>      swprintf( (<span class="keywordtype">wchar_t</span> *)gzCivQuote, (<span class="keywordtype">wchar_t</span> *)L<span class="stringliteral">"\"%s\""</span>, zQuote );
<a name="l00355"></a>00355 <span class="preprocessor">#endif</span>
<a name="l00356"></a>00356 <span class="preprocessor"></span>
<a name="l00357"></a>00357 
<a name="l00358"></a>00358       <span class="keywordflow">if</span> ( ubCivQuoteID == CIV_QUOTE_HINT )
<a name="l00359"></a>00359       {
<a name="l00360"></a>00360             <a class="code" href="message_8cpp.html#61480a4176cd65baf8abf767e5a228e4">MapScreenMessage</a>( FONT_MCOLOR_WHITE, MSG_DIALOG, L<span class="stringliteral">"%s"</span>,  gzCivQuote );
<a name="l00361"></a>00361       }
<a name="l00362"></a>00362 
<a name="l00363"></a>00363       <span class="comment">// Create video oeverlay....</span>
<a name="l00364"></a>00364       memset( &amp;VideoOverlayDesc, 0, <span class="keyword">sizeof</span>( <a class="code" href="structVIDEO__OVERLAY__DESC.html">VIDEO_OVERLAY_DESC</a> ) );
<a name="l00365"></a>00365       
<a name="l00366"></a>00366       <span class="comment">// Prepare text box</span>
<a name="l00367"></a>00367   SET_USE_WINFONTS( TRUE );
<a name="l00368"></a>00368   SET_WINFONT( <a class="code" href="Font_01Control_8cpp.html#bca764e412c8b1ac0378843b8077b348">giSubTitleWinFont</a> );       
<a name="l00369"></a>00369       <a class="code" href="Civ_01Quotes_8cpp.html#46a4e0cbd887477d994d947d3b630589">gCivQuoteData</a>.<a class="code" href="structQUOTE__SYSTEM__STRUCT.html#333f1783acf7ad6a1d80ed483ce32cf4">iDialogueBox</a> = <a class="code" href="MercTextBox_8cpp.html#8810f946968e58419fc4221f0e917596">PrepareMercPopupBox</a>( <a class="code" href="Civ_01Quotes_8cpp.html#46a4e0cbd887477d994d947d3b630589">gCivQuoteData</a>.<a class="code" href="structQUOTE__SYSTEM__STRUCT.html#333f1783acf7ad6a1d80ed483ce32cf4">iDialogueBox</a> , <a class="code" href="MercTextBox_8h.html#341163acd830e6c164e03eff6bc76e8e2ed0fec44f6c9a1675e3613745831e27">BASIC_MERC_POPUP_BACKGROUND</a>, <a class="code" href="MercTextBox_8h.html#3276d725d47d86d80f1207353d71f7b3909f8df05588f15a4fbbc745c27ab5cf">BASIC_MERC_POPUP_BORDER</a>, (<a class="code" href="Types_8h.html#94ebfccc6e846c28751f8d616371f1e5">STR16</a>)gzCivQuote, DIALOGUE_DEFAULT_WIDTH, 0, 0, 0, &amp;<a class="code" href="Civ_01Quotes_8cpp.html#d611b03c442716a7c4e41225ab65df05">gusCivQuoteBoxWidth</a>, &amp;<a class="code" href="Civ_01Quotes_8cpp.html#d88432c785584daf9676f87b4c87fb3a">gusCivQuoteBoxHeight</a> );
<a name="l00370"></a>00370   SET_USE_WINFONTS( FALSE );
<a name="l00371"></a>00371 
<a name="l00372"></a>00372       <span class="comment">// OK, find center for box......</span>
<a name="l00373"></a>00373       sX = sX - ( <a class="code" href="Civ_01Quotes_8cpp.html#d611b03c442716a7c4e41225ab65df05">gusCivQuoteBoxWidth</a> / 2 );
<a name="l00374"></a>00374       sY = sY - ( <a class="code" href="Civ_01Quotes_8cpp.html#d88432c785584daf9676f87b4c87fb3a">gusCivQuoteBoxHeight</a> / 2 );
<a name="l00375"></a>00375 
<a name="l00376"></a>00376       <span class="comment">// OK, limit to screen......</span>
<a name="l00377"></a>00377       {
<a name="l00378"></a>00378             <span class="keywordflow">if</span> ( sX &lt; 0 )
<a name="l00379"></a>00379             {
<a name="l00380"></a>00380                   sX = 0;
<a name="l00381"></a>00381             }
<a name="l00382"></a>00382 
<a name="l00383"></a>00383             <span class="comment">// CHECK FOR LEFT/RIGHT</span>
<a name="l00384"></a>00384             <span class="keywordflow">if</span> ( ( sX + <a class="code" href="Civ_01Quotes_8cpp.html#d611b03c442716a7c4e41225ab65df05">gusCivQuoteBoxWidth</a> ) &gt; <a class="code" href="local_8h.html#599adbe412c60e0cc5abb86be7ee4507">SCREEN_WIDTH</a> )
<a name="l00385"></a>00385             {
<a name="l00386"></a>00386                   sX = <a class="code" href="local_8h.html#599adbe412c60e0cc5abb86be7ee4507">SCREEN_WIDTH</a> - <a class="code" href="Civ_01Quotes_8cpp.html#d611b03c442716a7c4e41225ab65df05">gusCivQuoteBoxWidth</a>;
<a name="l00387"></a>00387             }
<a name="l00388"></a>00388 
<a name="l00389"></a>00389             <span class="comment">// Now check for top</span>
<a name="l00390"></a>00390             <span class="keywordflow">if</span> ( sY &lt; <a class="code" href="Rain_8cpp.html#4227e29b8d1a98d8a9f917db0d782ff5">gsVIEWPORT_WINDOW_START_Y</a> )
<a name="l00391"></a>00391             {
<a name="l00392"></a>00392                   sY = <a class="code" href="Rain_8cpp.html#4227e29b8d1a98d8a9f917db0d782ff5">gsVIEWPORT_WINDOW_START_Y</a>;
<a name="l00393"></a>00393             }
<a name="l00394"></a>00394 
<a name="l00395"></a>00395             <span class="comment">// Check for bottom</span>
<a name="l00396"></a>00396             <span class="keywordflow">if</span> ( ( sY + <a class="code" href="Civ_01Quotes_8cpp.html#d88432c785584daf9676f87b4c87fb3a">gusCivQuoteBoxHeight</a> ) &gt; (<a class="code" href="local_8h.html#f1c710caf1e3a9e81829078054e83799">SCREEN_HEIGHT</a> - <a class="code" href="Interface_8cpp.html#b154f0f60576a52ad1324903ffbb6d4a">INV_INTERFACE_HEIGHT</a>))
<a name="l00397"></a>00397             {
<a name="l00398"></a>00398                   sY = (<a class="code" href="local_8h.html#f1c710caf1e3a9e81829078054e83799">SCREEN_HEIGHT</a> - <a class="code" href="Interface_8cpp.html#b154f0f60576a52ad1324903ffbb6d4a">INV_INTERFACE_HEIGHT</a>) - <a class="code" href="Civ_01Quotes_8cpp.html#d88432c785584daf9676f87b4c87fb3a">gusCivQuoteBoxHeight</a>;
<a name="l00399"></a>00399             }
<a name="l00400"></a>00400       }
<a name="l00401"></a>00401 
<a name="l00402"></a>00402       VideoOverlayDesc.<a class="code" href="structVIDEO__OVERLAY__DESC.html#96d4005ddc801d3f28412ebdfacdc494">sLeft</a>               = sX;
<a name="l00403"></a>00403       VideoOverlayDesc.<a class="code" href="structVIDEO__OVERLAY__DESC.html#1f3e4a28a9180f61a96c87be905494fc">sTop</a>                      = sY;
<a name="l00404"></a>00404       VideoOverlayDesc.<a class="code" href="structVIDEO__OVERLAY__DESC.html#216b5a6a52e458d4e55fb10d20ad4a2f">sRight</a>              = VideoOverlayDesc.<a class="code" href="structVIDEO__OVERLAY__DESC.html#96d4005ddc801d3f28412ebdfacdc494">sLeft</a> + <a class="code" href="Civ_01Quotes_8cpp.html#d611b03c442716a7c4e41225ab65df05">gusCivQuoteBoxWidth</a>;
<a name="l00405"></a>00405       VideoOverlayDesc.<a class="code" href="structVIDEO__OVERLAY__DESC.html#6f4b9c5a1c23ee9bf64422a4bbfaf0fa">sBottom</a>             = VideoOverlayDesc.<a class="code" href="structVIDEO__OVERLAY__DESC.html#1f3e4a28a9180f61a96c87be905494fc">sTop</a> + <a class="code" href="Civ_01Quotes_8cpp.html#d88432c785584daf9676f87b4c87fb3a">gusCivQuoteBoxHeight</a>;
<a name="l00406"></a>00406       VideoOverlayDesc.<a class="code" href="structVIDEO__OVERLAY__DESC.html#3347788a46bcc37438dec623632337b5">sX</a>                              = VideoOverlayDesc.<a class="code" href="structVIDEO__OVERLAY__DESC.html#96d4005ddc801d3f28412ebdfacdc494">sLeft</a>;
<a name="l00407"></a>00407       VideoOverlayDesc.<a class="code" href="structVIDEO__OVERLAY__DESC.html#b75911eefa03e47a23379247b414f1cd">sY</a>                              = VideoOverlayDesc.<a class="code" href="structVIDEO__OVERLAY__DESC.html#1f3e4a28a9180f61a96c87be905494fc">sTop</a>;
<a name="l00408"></a>00408       VideoOverlayDesc.<a class="code" href="structVIDEO__OVERLAY__DESC.html#959686921380cbcdc6f28845716eebde">BltCallback</a> = <a class="code" href="Civ_01Quotes_8cpp.html#564547207c53083b916de6f70b14023e">RenderCivQuoteBoxOverlay</a>;
<a name="l00409"></a>00409 
<a name="l00410"></a>00410       <a class="code" href="Civ_01Quotes_8cpp.html#46a4e0cbd887477d994d947d3b630589">gCivQuoteData</a>.<a class="code" href="structQUOTE__SYSTEM__STRUCT.html#687ed161b2d099e92fdd785fcaca73a3">iVideoOverlay</a> =  <a class="code" href="Render_01Dirty_8cpp.html#3f8583e9f189b1ccffa799dde4215978">RegisterVideoOverlay</a>( 0, &amp;VideoOverlayDesc );
<a name="l00411"></a>00411 
<a name="l00412"></a>00412 
<a name="l00413"></a>00413       <span class="comment">//Define main region</span>
<a name="l00414"></a>00414       <a class="code" href="mousesystem_8cpp.html#dce08766ef4cbacb9372efe12d26a1e0">MSYS_DefineRegion</a>( &amp;(<a class="code" href="Civ_01Quotes_8cpp.html#46a4e0cbd887477d994d947d3b630589">gCivQuoteData</a>.<a class="code" href="structQUOTE__SYSTEM__STRUCT.html#180f15926616cd29d39702073690253f">MouseRegion</a>), VideoOverlayDesc.<a class="code" href="structVIDEO__OVERLAY__DESC.html#96d4005ddc801d3f28412ebdfacdc494">sLeft</a>, VideoOverlayDesc.<a class="code" href="structVIDEO__OVERLAY__DESC.html#1f3e4a28a9180f61a96c87be905494fc">sTop</a>,  VideoOverlayDesc.<a class="code" href="structVIDEO__OVERLAY__DESC.html#216b5a6a52e458d4e55fb10d20ad4a2f">sRight</a>, VideoOverlayDesc.<a class="code" href="structVIDEO__OVERLAY__DESC.html#6f4b9c5a1c23ee9bf64422a4bbfaf0fa">sBottom</a>, MSYS_PRIORITY_HIGHEST,
<a name="l00415"></a>00415                                      <a class="code" href="Cursors_8h.html#5e184f913c35dbf305f3c369dee23e19b855da01a6ebcbd6bdad89a28b4ce5c8">CURSOR_NORMAL</a>, MSYS_NO_CALLBACK, <a class="code" href="Civ_01Quotes_8cpp.html#fca379c322e2bad393f0eedcbf4ffcb5">QuoteOverlayClickCallback</a> ); 
<a name="l00416"></a>00416       <span class="comment">// Add region</span>
<a name="l00417"></a>00417       <a class="code" href="mousesystem_8cpp.html#d654da5fdc0c95350f4c40c17ed3933d">MSYS_AddRegion</a>( &amp;(<a class="code" href="Civ_01Quotes_8cpp.html#46a4e0cbd887477d994d947d3b630589">gCivQuoteData</a>.<a class="code" href="structQUOTE__SYSTEM__STRUCT.html#180f15926616cd29d39702073690253f">MouseRegion</a>) );
<a name="l00418"></a>00418 
<a name="l00419"></a>00419 
<a name="l00420"></a>00420       <a class="code" href="Civ_01Quotes_8cpp.html#46a4e0cbd887477d994d947d3b630589">gCivQuoteData</a>.<a class="code" href="structQUOTE__SYSTEM__STRUCT.html#8641bb125b9845bc684f6b1e0495f613">bActive</a> = TRUE;
<a name="l00421"></a>00421 
<a name="l00422"></a>00422       <a class="code" href="Civ_01Quotes_8cpp.html#46a4e0cbd887477d994d947d3b630589">gCivQuoteData</a>.<a class="code" href="structQUOTE__SYSTEM__STRUCT.html#fa55d1e66ceef372cf7cfef72c978eb0">uiTimeOfCreation</a> = GetJA2Clock( );
<a name="l00423"></a>00423 
<a name="l00424"></a>00424       <a class="code" href="Civ_01Quotes_8cpp.html#46a4e0cbd887477d994d947d3b630589">gCivQuoteData</a>.<a class="code" href="structQUOTE__SYSTEM__STRUCT.html#65fe9920ac9ca22df543ad4a51a87eba">uiDelayTime</a> = <a class="code" href="Dialogue_01Control_8cpp.html#f0462712feef8218362f064b259dafe5">FindDelayForString</a>( (<a class="code" href="Types_8h.html#94ebfccc6e846c28751f8d616371f1e5">STR16</a>)gzCivQuote ) + 500;
<a name="l00425"></a>00425       
<a name="l00426"></a>00426       <a class="code" href="Civ_01Quotes_8cpp.html#46a4e0cbd887477d994d947d3b630589">gCivQuoteData</a>.<a class="code" href="structQUOTE__SYSTEM__STRUCT.html#dba8564bfd3011dc21ff6a65262be774">pCiv</a> = pCiv;
<a name="l00427"></a>00427 
<a name="l00428"></a>00428 }
<a name="l00429"></a>00429 
<a name="l00430"></a><a class="code" href="Civ_01Quotes_8cpp.html#ce7e7e396c00dd035630f2ea699c4148">00430</a> <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> <a class="code" href="Civ_01Quotes_8cpp.html#ce7e7e396c00dd035630f2ea699c4148">DetermineCivQuoteEntry</a>( <a class="code" href="structSOLDIERTYPE.html">SOLDIERTYPE</a> *pCiv, <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> *pubCivHintToUse, <a class="code" href="Types_8h.html#112e3146cb38b6ee95e64d85842e380a">BOOLEAN</a> fCanUseHints )
<a name="l00431"></a>00431 {
<a name="l00432"></a>00432       <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubCivType;
<a name="l00433"></a>00433       <a class="code" href="Types_8h.html#7ebe70ceca856797319175e30bcf003d">INT8</a>  bTownId;
<a name="l00434"></a>00434       <a class="code" href="Types_8h.html#112e3146cb38b6ee95e64d85842e380a">BOOLEAN</a>     bCivLowLoyalty = FALSE;
<a name="l00435"></a>00435       <a class="code" href="Types_8h.html#112e3146cb38b6ee95e64d85842e380a">BOOLEAN</a>     bCivHighLoyalty = FALSE;
<a name="l00436"></a>00436       <a class="code" href="Types_8h.html#7ebe70ceca856797319175e30bcf003d">INT8</a>        bCivHint;
<a name="l00437"></a>00437   <a class="code" href="Types_8h.html#7ebe70ceca856797319175e30bcf003d">INT8</a>    bMineId;
<a name="l00438"></a>00438   <a class="code" href="Types_8h.html#112e3146cb38b6ee95e64d85842e380a">BOOLEAN</a> bMiners = FALSE;
<a name="l00439"></a>00439 
<a name="l00440"></a>00440       (*pubCivHintToUse) = 0;
<a name="l00441"></a>00441 
<a name="l00442"></a>00442       ubCivType = <a class="code" href="Civ_01Quotes_8cpp.html#d11e61c034e184ba78fbc5f5a509ad91">GetCivType</a>( pCiv );
<a name="l00443"></a>00443 
<a name="l00444"></a>00444       <span class="keywordflow">if</span> ( ubCivType == CIV_TYPE_ENEMY )
<a name="l00445"></a>00445       {
<a name="l00446"></a>00446             <span class="comment">// Determine what type of quote to say...</span>
<a name="l00447"></a>00447             <span class="comment">// Are are we going to attack?</span>
<a name="l00448"></a>00448 
<a name="l00449"></a>00449             <span class="keywordflow">if</span> ( pCiv-&gt;<a class="code" href="structSOLDIERTYPE.html#70fc2b64ddf6ed6358c954ff3f200ce7">bAction</a> == <a class="code" href="ai_8h.html#21d5e8f8cdaa838586b31007df0a950b260e54a79dd8e6db573a8216c3a63efc">AI_ACTION_TOSS_PROJECTILE</a> || pCiv-&gt;<a class="code" href="structSOLDIERTYPE.html#70fc2b64ddf6ed6358c954ff3f200ce7">bAction</a> == <a class="code" href="ai_8h.html#21d5e8f8cdaa838586b31007df0a950b6247fbdbad71e877e20dc79b610060b8">AI_ACTION_FIRE_GUN</a> ||
<a name="l00450"></a>00450                                           pCiv-&gt;<a class="code" href="structSOLDIERTYPE.html#70fc2b64ddf6ed6358c954ff3f200ce7">bAction</a> == <a class="code" href="ai_8h.html#21d5e8f8cdaa838586b31007df0a950b6247fbdbad71e877e20dc79b610060b8">AI_ACTION_FIRE_GUN</a> || pCiv-&gt;<a class="code" href="structSOLDIERTYPE.html#70fc2b64ddf6ed6358c954ff3f200ce7">bAction</a> == <a class="code" href="ai_8h.html#21d5e8f8cdaa838586b31007df0a950bcc74cedcb5afbd32c5b21b1ecc59b9ec">AI_ACTION_KNIFE_MOVE</a> )
<a name="l00451"></a>00451             {
<a name="l00452"></a>00452                   <span class="keywordflow">return</span>( <a class="code" href="Civ_01Quotes_8h.html#2db06901d03245a790e5571701aba3dffa53b1b269ebdc30f9d7afbb3cfbb83f">CIV_QUOTE_ENEMY_THREAT</a> );
<a name="l00453"></a>00453             }
<a name="l00454"></a>00454             <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( pCiv-&gt;<a class="code" href="structSOLDIERTYPE.html#70fc2b64ddf6ed6358c954ff3f200ce7">bAction</a> == <a class="code" href="ai_8h.html#21d5e8f8cdaa838586b31007df0a950be0a0afbead0db144e6da11231dbf9199">AI_ACTION_OFFER_SURRENDER</a> )
<a name="l00455"></a>00455             {
<a name="l00456"></a>00456                   <span class="keywordflow">return</span>( <a class="code" href="Civ_01Quotes_8h.html#2db06901d03245a790e5571701aba3df930be0d4d6cb3a410328dbb7a1841ce7">CIV_QUOTE_ENEMY_OFFER_SURRENDER</a> );
<a name="l00457"></a>00457             }
<a name="l00458"></a>00458             <span class="comment">// Hurt?</span>
<a name="l00459"></a>00459             <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( pCiv-&gt;<a class="code" href="structSOLDIERTYPE.html#e308dea18533bf5ab2bcee5bbe27391c">bLife</a> &lt; 30 )
<a name="l00460"></a>00460             {
<a name="l00461"></a>00461                   <span class="keywordflow">return</span>( <a class="code" href="Civ_01Quotes_8h.html#2db06901d03245a790e5571701aba3df6178e8a2cc24a30a9a1cc32a828c90b8">CIV_QUOTE_ENEMY_HURT</a> );
<a name="l00462"></a>00462             }
<a name="l00463"></a>00463             <span class="comment">// elite?</span>
<a name="l00464"></a>00464             <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( pCiv-&gt;<a class="code" href="structSOLDIERTYPE.html#44fa01e0e2eef538a2566810626be040">ubSoldierClass</a> == <a class="code" href="Soldier_01Control_8h.html#d559b3ed307be626eacea8b56942de61a3398ebdb00774b852a6dc6a1ba38764">SOLDIER_CLASS_ELITE</a> )
<a name="l00465"></a>00465             {
<a name="l00466"></a>00466                   <span class="keywordflow">return</span>( <a class="code" href="Civ_01Quotes_8h.html#2db06901d03245a790e5571701aba3dffdfad342940d710509091b12433019c2">CIV_QUOTE_ENEMY_ELITE</a> );
<a name="l00467"></a>00467             }
<a name="l00468"></a>00468             <span class="keywordflow">else</span>
<a name="l00469"></a>00469             {
<a name="l00470"></a>00470                   <span class="keywordflow">return</span>( <a class="code" href="Civ_01Quotes_8h.html#2db06901d03245a790e5571701aba3df5a4157d82d39873022f1c772bb970fa0">CIV_QUOTE_ENEMY_ADMIN</a> );
<a name="l00471"></a>00471             }
<a name="l00472"></a>00472       }
<a name="l00473"></a>00473 
<a name="l00474"></a>00474       <span class="comment">// Are we in a town sector?</span>
<a name="l00475"></a>00475       <span class="comment">// get town id</span>
<a name="l00476"></a>00476       bTownId = <a class="code" href="strategicmap_8cpp.html#99dffd29ea4571bc0c833d45636f1403">GetTownIdForSector</a>( <a class="code" href="strategicmap_8cpp.html#49d9aed144a633fda4ba1990f002d703">gWorldSectorX</a>, <a class="code" href="strategicmap_8cpp.html#ea322310ced0e35ee18a2ee7b32aac5b">gWorldSectorY</a> );
<a name="l00477"></a>00477 
<a name="l00478"></a>00478 
<a name="l00479"></a>00479       <span class="comment">// If a married PC...</span>
<a name="l00480"></a>00480       <span class="keywordflow">if</span> ( ubCivType == CIV_TYPE_MARRIED_PC )
<a name="l00481"></a>00481       {
<a name="l00482"></a>00482             <span class="keywordflow">return</span>( <a class="code" href="Civ_01Quotes_8h.html#2db06901d03245a790e5571701aba3dfe5d99e5d2f3aa11d95a941a67642043d">CIV_QUOTE_PC_MARRIED</a> );
<a name="l00483"></a>00483       }
<a name="l00484"></a>00484 
<a name="l00485"></a>00485       <span class="comment">// CIV GROUPS FIRST!</span>
<a name="l00486"></a>00486       <span class="comment">// Hicks.....</span>
<a name="l00487"></a>00487       <span class="keywordflow">if</span> ( pCiv-&gt;<a class="code" href="structSOLDIERTYPE.html#d250d43185690987945d6884efdf79fc">ubCivilianGroup</a> == <a class="code" href="Overhead_01Types_8h.html#e6cdb622357fec6e889e47579a0785248e818a9693e42cfdf988862de0f393aa">HICKS_CIV_GROUP</a> )
<a name="l00488"></a>00488       {
<a name="l00489"></a>00489             <span class="comment">// Are they friendly?</span>
<a name="l00490"></a>00490             <span class="comment">//if ( gTacticalStatus.fCivGroupHostile[ HICKS_CIV_GROUP ] &lt; CIV_GROUP_WILL_BECOME_HOSTILE )</span>
<a name="l00491"></a>00491             <span class="keywordflow">if</span> ( pCiv-&gt;<a class="code" href="structSOLDIERTYPE.html#165874ef5822faaf165da91996ad4a7b">bNeutral</a> )
<a name="l00492"></a>00492             {
<a name="l00493"></a>00493                   <span class="keywordflow">return</span>( <a class="code" href="Civ_01Quotes_8h.html#2db06901d03245a790e5571701aba3df566ac9d218be13c316c439cf2c0b97f0">CIV_QUOTE_HICKS_FRIENDLY</a> );
<a name="l00494"></a>00494             }
<a name="l00495"></a>00495             <span class="keywordflow">else</span>
<a name="l00496"></a>00496             {
<a name="l00497"></a>00497                   <span class="keywordflow">return</span>( <a class="code" href="Civ_01Quotes_8h.html#2db06901d03245a790e5571701aba3dfac511049c7f2a40cdf15fed7e2452cd7">CIV_QUOTE_HICKS_ENEMIES</a> );
<a name="l00498"></a>00498             }
<a name="l00499"></a>00499       }
<a name="l00500"></a>00500 
<a name="l00501"></a>00501       <span class="comment">// Goons.....</span>
<a name="l00502"></a>00502       <span class="keywordflow">if</span> ( pCiv-&gt;<a class="code" href="structSOLDIERTYPE.html#d250d43185690987945d6884efdf79fc">ubCivilianGroup</a> == <a class="code" href="Overhead_01Types_8h.html#e6cdb622357fec6e889e47579a0785249cebb97519ab2d7c94dabe2509bef978">KINGPIN_CIV_GROUP</a> )
<a name="l00503"></a>00503       {
<a name="l00504"></a>00504             <span class="comment">// Are they friendly?</span>
<a name="l00505"></a>00505             <span class="comment">//if ( gTacticalStatus.fCivGroupHostile[ KINGPIN_CIV_GROUP ] &lt; CIV_GROUP_WILL_BECOME_HOSTILE )</span>
<a name="l00506"></a>00506             <span class="keywordflow">if</span> ( pCiv-&gt;<a class="code" href="structSOLDIERTYPE.html#165874ef5822faaf165da91996ad4a7b">bNeutral</a> )
<a name="l00507"></a>00507             {
<a name="l00508"></a>00508                   <span class="keywordflow">return</span>( <a class="code" href="Civ_01Quotes_8h.html#2db06901d03245a790e5571701aba3dfab77a1afaf51415f2296854c70f406c2">CIV_QUOTE_GOONS_FRIENDLY</a> );
<a name="l00509"></a>00509             }
<a name="l00510"></a>00510             <span class="keywordflow">else</span>
<a name="l00511"></a>00511             {
<a name="l00512"></a>00512                   <span class="keywordflow">return</span>( <a class="code" href="Civ_01Quotes_8h.html#2db06901d03245a790e5571701aba3df225687ac9a9c9e065c9107324f8e9142">CIV_QUOTE_GOONS_ENEMIES</a> );
<a name="l00513"></a>00513             }
<a name="l00514"></a>00514       }
<a name="l00515"></a>00515 
<a name="l00516"></a>00516       <span class="comment">// ATE: Cowering people take precedence....</span>
<a name="l00517"></a>00517       <span class="keywordflow">if</span> ( ( pCiv-&gt;<a class="code" href="structSOLDIERTYPE.html#eb633099940bc20ff5a969bce84eab42">uiStatusFlags</a> &amp; SOLDIER_COWERING ) || ( pCiv-&gt;<a class="code" href="structSOLDIERTYPE.html#74a40a8aaf3efe840cdaf6be62556d82">bTeam</a> == CIV_TEAM &amp;&amp; ( <a class="code" href="Overhead_8cpp.html#46bd754f8875c305ab18731ed10e3364">gTacticalStatus</a>.<a class="code" href="structTacticalStatusType.html#89eb954f99ad4f28b84d7cf675c8ed32">uiFlags</a> &amp; INCOMBAT ) ) )
<a name="l00518"></a>00518       {
<a name="l00519"></a>00519             <span class="keywordflow">if</span> ( ubCivType == CIV_TYPE_ADULT )
<a name="l00520"></a>00520             {
<a name="l00521"></a>00521                   <span class="keywordflow">return</span>( <a class="code" href="Civ_01Quotes_8h.html#2db06901d03245a790e5571701aba3df69ba39427984d9ca1f7cfefdfb52d080">CIV_QUOTE_ADULTS_COWER</a> );
<a name="l00522"></a>00522             }
<a name="l00523"></a>00523             <span class="keywordflow">else</span>
<a name="l00524"></a>00524             {
<a name="l00525"></a>00525                   <span class="keywordflow">return</span>( <a class="code" href="Civ_01Quotes_8h.html#2db06901d03245a790e5571701aba3df1b9d5a5e93e98df97cbb43d48f851a28">CIV_QUOTE_KIDS_COWER</a> );
<a name="l00526"></a>00526             }
<a name="l00527"></a>00527       }
<a name="l00528"></a>00528 
<a name="l00529"></a>00529       <span class="comment">// Kid slaves...</span>
<a name="l00530"></a>00530       <span class="keywordflow">if</span> ( pCiv-&gt;<a class="code" href="structSOLDIERTYPE.html#d250d43185690987945d6884efdf79fc">ubCivilianGroup</a> == <a class="code" href="Overhead_01Types_8h.html#e6cdb622357fec6e889e47579a078524d632d88111b2f6f118a3d76c243a7cce">FACTORY_KIDS_GROUP</a> )
<a name="l00531"></a>00531       {
<a name="l00532"></a>00532             <span class="comment">// Check fact.....</span>
<a name="l00533"></a>00533             <span class="keywordflow">if</span> ( <a class="code" href="Quests_8cpp.html#6744b59d27bf2791d0c2fefe18e548d3">CheckFact</a>( <a class="code" href="Quests_8h.html#aead3e57f613f07868a1b2afb6b943f107b83b50892b5fe7830e72e4f45e1bf6">FACT_DOREEN_HAD_CHANGE_OF_HEART</a>, 0 ) || !<a class="code" href="Quests_8cpp.html#6744b59d27bf2791d0c2fefe18e548d3">CheckFact</a>( <a class="code" href="Quests_8h.html#aead3e57f613f07868a1b2afb6b943f10c919c9c65b7a9696e2ee36fbf56505b">FACT_DOREEN_ALIVE</a>, 0 ) )
<a name="l00534"></a>00534             {
<a name="l00535"></a>00535                   <span class="keywordflow">return</span>( <a class="code" href="Civ_01Quotes_8h.html#2db06901d03245a790e5571701aba3df8535e8ab77e4784907cbb16b13bef57e">CIV_QUOTE_KID_SLAVES_FREE</a> );
<a name="l00536"></a>00536             }
<a name="l00537"></a>00537             <span class="keywordflow">else</span>
<a name="l00538"></a>00538             {
<a name="l00539"></a>00539                   <span class="keywordflow">return</span>( <a class="code" href="Civ_01Quotes_8h.html#2db06901d03245a790e5571701aba3df95f04028de2009114a17da4f201f9219">CIV_QUOTE_KID_SLAVES</a> );
<a name="l00540"></a>00540             }
<a name="l00541"></a>00541       }
<a name="l00542"></a>00542 
<a name="l00543"></a>00543       <span class="comment">// BEGGERS</span>
<a name="l00544"></a>00544       <span class="keywordflow">if</span> ( pCiv-&gt;<a class="code" href="structSOLDIERTYPE.html#d250d43185690987945d6884efdf79fc">ubCivilianGroup</a> == <a class="code" href="Overhead_01Types_8h.html#e6cdb622357fec6e889e47579a078524978122a0b040526326267369ab5e34d3">BEGGARS_CIV_GROUP</a> )
<a name="l00545"></a>00545       {
<a name="l00546"></a>00546             <span class="comment">// Check if we are in a town...</span>
<a name="l00547"></a>00547             <span class="keywordflow">if</span>( bTownId != <a class="code" href="mapscreen_8h.html#4d1dc70bee62b945929c96dfafebe105d008cfe091b982e6d052565ed0b5acd8">BLANK_SECTOR</a> &amp;&amp; <a class="code" href="strategicmap_8cpp.html#da715721a8ceedd42acf6ddb33e63ce0">gbWorldSectorZ</a> == 0 )
<a name="l00548"></a>00548             {
<a name="l00549"></a>00549                   <span class="keywordflow">if</span> ( bTownId == <a class="code" href="mapscreen_8h.html#4d1dc70bee62b945929c96dfafebe10555d5a38897a02d66fd24bf2d6d92dee8">SAN_MONA</a> &amp;&amp; ubCivType == CIV_TYPE_ADULT )
<a name="l00550"></a>00550                   {
<a name="l00551"></a>00551                         <span class="keywordflow">return</span>( <a class="code" href="Civ_01Quotes_8h.html#2db06901d03245a790e5571701aba3dfc9219b9dd2a68d76fa9449c4c4faf3dc">CIV_QUOTE_SAN_MONA_BEGGERS</a> );
<a name="l00552"></a>00552                   }
<a name="l00553"></a>00553             }
<a name="l00554"></a>00554 
<a name="l00555"></a>00555             <span class="comment">// DO normal beggers...</span>
<a name="l00556"></a>00556             <span class="keywordflow">if</span> ( ubCivType == CIV_TYPE_ADULT )
<a name="l00557"></a>00557             {
<a name="l00558"></a>00558                   <span class="keywordflow">return</span>( <a class="code" href="Civ_01Quotes_8h.html#2db06901d03245a790e5571701aba3dfb1e84b9d34afda0f6a0933e0b3e57a1a">CIV_QUOTE_ADULTS_BEGGING</a> );
<a name="l00559"></a>00559             }
<a name="l00560"></a>00560             <span class="keywordflow">else</span>
<a name="l00561"></a>00561             {
<a name="l00562"></a>00562                   <span class="keywordflow">return</span>( <a class="code" href="Civ_01Quotes_8h.html#2db06901d03245a790e5571701aba3df84ea6b7a19aa18c8d5fcd35acad2d6f5">CIV_QUOTE_KIDS_BEGGING</a> );
<a name="l00563"></a>00563             }
<a name="l00564"></a>00564       }
<a name="l00565"></a>00565 
<a name="l00566"></a>00566       <span class="comment">// REBELS</span>
<a name="l00567"></a>00567       <span class="keywordflow">if</span> ( pCiv-&gt;<a class="code" href="structSOLDIERTYPE.html#d250d43185690987945d6884efdf79fc">ubCivilianGroup</a> == <a class="code" href="Overhead_01Types_8h.html#e6cdb622357fec6e889e47579a0785241787570cc516fbde66bef1057d466c0e">REBEL_CIV_GROUP</a> )
<a name="l00568"></a>00568       {
<a name="l00569"></a>00569             <span class="comment">// DO normal beggers...</span>
<a name="l00570"></a>00570             <span class="keywordflow">if</span> ( ubCivType == CIV_TYPE_ADULT )
<a name="l00571"></a>00571             {
<a name="l00572"></a>00572                   <span class="keywordflow">return</span>( <a class="code" href="Civ_01Quotes_8h.html#2db06901d03245a790e5571701aba3df680bf94c33d6136e11d38d71e5ef4c92">CIV_QUOTE_ADULTS_REBELS</a> );
<a name="l00573"></a>00573             }
<a name="l00574"></a>00574             <span class="keywordflow">else</span>
<a name="l00575"></a>00575             {
<a name="l00576"></a>00576                   <span class="keywordflow">return</span>( <a class="code" href="Civ_01Quotes_8h.html#2db06901d03245a790e5571701aba3dfa88c949b3aa900659ff145356f5b2123">CIV_QUOTE_KIDS_REBELS</a> );
<a name="l00577"></a>00577             }
<a name="l00578"></a>00578       }
<a name="l00579"></a>00579 
<a name="l00580"></a>00580       <span class="comment">// Do miltitia...</span>
<a name="l00581"></a>00581       <span class="keywordflow">if</span> ( pCiv-&gt;<a class="code" href="structSOLDIERTYPE.html#74a40a8aaf3efe840cdaf6be62556d82">bTeam</a> == MILITIA_TEAM )
<a name="l00582"></a>00582       {
<a name="l00583"></a>00583             <span class="comment">// Different types....</span>
<a name="l00584"></a>00584             <span class="keywordflow">if</span> ( pCiv-&gt;<a class="code" href="structSOLDIERTYPE.html#44fa01e0e2eef538a2566810626be040">ubSoldierClass</a> == <a class="code" href="Soldier_01Control_8h.html#d559b3ed307be626eacea8b56942de615d87e4b53a22c14df589d9df96ddb0dc">SOLDIER_CLASS_GREEN_MILITIA</a> )
<a name="l00585"></a>00585             {
<a name="l00586"></a>00586                   <span class="keywordflow">return</span>( <a class="code" href="Civ_01Quotes_8h.html#2db06901d03245a790e5571701aba3df6b3f7233193f25c39f70d08eb54b535e">CIV_QUOTE_GREEN_MILITIA</a> );
<a name="l00587"></a>00587             }
<a name="l00588"></a>00588             <span class="keywordflow">if</span> ( pCiv-&gt;<a class="code" href="structSOLDIERTYPE.html#44fa01e0e2eef538a2566810626be040">ubSoldierClass</a> == <a class="code" href="Soldier_01Control_8h.html#d559b3ed307be626eacea8b56942de610534cbb3d918376e9f10be3bf049666e">SOLDIER_CLASS_REG_MILITIA</a> )
<a name="l00589"></a>00589             {
<a name="l00590"></a>00590                   <span class="keywordflow">return</span>( <a class="code" href="Civ_01Quotes_8h.html#2db06901d03245a790e5571701aba3df60e6737f8d2d62e225093404db607fba">CIV_QUOTE_MEDIUM_MILITIA</a> );
<a name="l00591"></a>00591             }
<a name="l00592"></a>00592             <span class="keywordflow">if</span> ( pCiv-&gt;<a class="code" href="structSOLDIERTYPE.html#44fa01e0e2eef538a2566810626be040">ubSoldierClass</a> == <a class="code" href="Soldier_01Control_8h.html#d559b3ed307be626eacea8b56942de61f2c9f1bbece4a7bd58b4a83a54dac6b6">SOLDIER_CLASS_ELITE_MILITIA</a> )
<a name="l00593"></a>00593             {
<a name="l00594"></a>00594                   <span class="keywordflow">return</span>( <a class="code" href="Civ_01Quotes_8h.html#2db06901d03245a790e5571701aba3df4895bfd3aec2b90b8fcc2e18bcb72740">CIV_QUOTE_ELITE_MILITIA</a> );
<a name="l00595"></a>00595             }
<a name="l00596"></a>00596       }
<a name="l00597"></a>00597 
<a name="l00598"></a>00598   <span class="comment">// If we are in medunna, and queen is dead, use these...</span>
<a name="l00599"></a>00599   <span class="keywordflow">if</span> ( bTownId == <a class="code" href="mapscreen_8h.html#4d1dc70bee62b945929c96dfafebe105b27f2688f728440518c090cc805f6282">MEDUNA</a> &amp;&amp; <a class="code" href="Quests_8cpp.html#6744b59d27bf2791d0c2fefe18e548d3">CheckFact</a>( <a class="code" href="Quests_8h.html#aead3e57f613f07868a1b2afb6b943f1c2c1fc03e7f5f0870adbf041d9a26c6a">FACT_QUEEN_DEAD</a>, 0 ) )
<a name="l00600"></a>00600   {
<a name="l00601"></a>00601     <span class="keywordflow">return</span>( <a class="code" href="Civ_01Quotes_8h.html#2db06901d03245a790e5571701aba3dfeffcd969a8ab8d67be72e4c72cfe33ed">CIV_QUOTE_DEIDRANNA_DEAD</a> );
<a name="l00602"></a>00602   }
<a name="l00603"></a>00603 
<a name="l00604"></a>00604       <span class="comment">// if in a town</span>
<a name="l00605"></a>00605       <span class="keywordflow">if</span>( ( bTownId != <a class="code" href="mapscreen_8h.html#4d1dc70bee62b945929c96dfafebe105d008cfe091b982e6d052565ed0b5acd8">BLANK_SECTOR</a> ) &amp;&amp; ( <a class="code" href="strategicmap_8cpp.html#da715721a8ceedd42acf6ddb33e63ce0">gbWorldSectorZ</a> == 0 ) &amp;&amp; <a class="code" href="Strategic_01Town_01Loyalty_8cpp.html#9b06c65f6833d5d0ed217d0c959d80dd">gfTownUsesLoyalty</a>[ bTownId ] )
<a name="l00606"></a>00606       {
<a name="l00607"></a>00607             <span class="comment">// Check loyalty special quotes.....</span>
<a name="l00608"></a>00608             <span class="comment">// EXTREMELY LOW TOWN LOYALTY...</span>
<a name="l00609"></a>00609             <span class="keywordflow">if</span> ( <a class="code" href="Strategic_01Town_01Loyalty_8cpp.html#53aef3e8e8681f01397608fbb9dcf56e">gTownLoyalty</a>[ bTownId ].ubRating &lt; EXTREAMLY_LOW_TOWN_LOYALTY )
<a name="l00610"></a>00610             {
<a name="l00611"></a>00611                   bCivLowLoyalty = TRUE;
<a name="l00612"></a>00612             }
<a name="l00613"></a>00613 
<a name="l00614"></a>00614             <span class="comment">// HIGH TOWN LOYALTY...</span>
<a name="l00615"></a>00615             <span class="keywordflow">if</span> ( <a class="code" href="Strategic_01Town_01Loyalty_8cpp.html#53aef3e8e8681f01397608fbb9dcf56e">gTownLoyalty</a>[ bTownId ].ubRating &gt;= HIGH_TOWN_LOYALTY )
<a name="l00616"></a>00616             {
<a name="l00617"></a>00617                   bCivHighLoyalty = TRUE;
<a name="l00618"></a>00618             }
<a name="l00619"></a>00619       }
<a name="l00620"></a>00620 
<a name="l00621"></a>00621 
<a name="l00622"></a>00622       <span class="comment">// ATE: OK, check if we should look for a civ hint....</span>
<a name="l00623"></a>00623   <span class="keywordflow">if</span> ( fCanUseHints )
<a name="l00624"></a>00624   {
<a name="l00625"></a>00625         bCivHint = <a class="code" href="NPC_8cpp.html#f9d3b0f48ff8e90918dd486da5159eb8">ConsiderCivilianQuotes</a>( <a class="code" href="strategicmap_8cpp.html#49d9aed144a633fda4ba1990f002d703">gWorldSectorX</a>, <a class="code" href="strategicmap_8cpp.html#ea322310ced0e35ee18a2ee7b32aac5b">gWorldSectorY</a>, <a class="code" href="strategicmap_8cpp.html#da715721a8ceedd42acf6ddb33e63ce0">gbWorldSectorZ</a>,  FALSE );
<a name="l00626"></a>00626   }
<a name="l00627"></a>00627   <span class="keywordflow">else</span>
<a name="l00628"></a>00628   {
<a name="l00629"></a>00629     bCivHint = -1;
<a name="l00630"></a>00630   }
<a name="l00631"></a>00631 
<a name="l00632"></a>00632       <span class="comment">// ATE: check miners......</span>
<a name="l00633"></a>00633       <span class="keywordflow">if</span> ( pCiv-&gt;<a class="code" href="structSOLDIERTYPE.html#44fa01e0e2eef538a2566810626be040">ubSoldierClass</a> == <a class="code" href="Soldier_01Control_8h.html#d559b3ed307be626eacea8b56942de618d13f000b4b5195727feae9b48454950">SOLDIER_CLASS_MINER</a> )
<a name="l00634"></a>00634       {
<a name="l00635"></a>00635     bMiners = TRUE;
<a name="l00636"></a>00636 
<a name="l00637"></a>00637     <span class="comment">// If not a civ hint available...</span>
<a name="l00638"></a>00638     <span class="keywordflow">if</span> ( bCivHint == -1 )
<a name="l00639"></a>00639     {
<a name="l00640"></a>00640               <span class="comment">// Check if they are under our control...</span>
<a name="l00641"></a>00641 
<a name="l00642"></a>00642       <span class="comment">// Should I go talk to miner?</span>
<a name="l00643"></a>00643       <span class="comment">// Not done yet.</span>
<a name="l00644"></a>00644 
<a name="l00645"></a>00645       <span class="comment">// Are they working for us?</span>
<a name="l00646"></a>00646         bMineId = <a class="code" href="Strategic_01Mines_8cpp.html#f1d365ab247f6b02c92699d1526e585c">GetIdOfMineForSector</a>( <a class="code" href="strategicmap_8cpp.html#49d9aed144a633fda4ba1990f002d703">gWorldSectorX</a>, <a class="code" href="strategicmap_8cpp.html#ea322310ced0e35ee18a2ee7b32aac5b">gWorldSectorY</a>, <a class="code" href="strategicmap_8cpp.html#da715721a8ceedd42acf6ddb33e63ce0">gbWorldSectorZ</a> );
<a name="l00647"></a>00647 
<a name="l00648"></a>00648       <span class="keywordflow">if</span> ( <a class="code" href="Strategic_01Mines_8cpp.html#12722b782db4ec45d9dee0f97c871f6f">PlayerControlsMine</a>( bMineId ) )
<a name="l00649"></a>00649       {
<a name="l00650"></a>00650         <span class="keywordflow">return</span>( <a class="code" href="Civ_01Quotes_8h.html#2db06901d03245a790e5571701aba3dfd485e86ba59e5e06e3ab7dc0e2417afc">CIV_QUOTE_MINERS_FOR_PLAYER</a> ); 
<a name="l00651"></a>00651       }
<a name="l00652"></a>00652       <span class="keywordflow">else</span>
<a name="l00653"></a>00653       {
<a name="l00654"></a>00654         <span class="keywordflow">return</span>( <a class="code" href="Civ_01Quotes_8h.html#2db06901d03245a790e5571701aba3df755fe041476c58845a3ee67a2b8e05a1">CIV_QUOTE_MINERS_NOT_FOR_PLAYER</a> ); 
<a name="l00655"></a>00655       }
<a name="l00656"></a>00656     }
<a name="l00657"></a>00657       }
<a name="l00658"></a>00658 
<a name="l00659"></a>00659 
<a name="l00660"></a>00660       <span class="comment">// Is one availible?</span>
<a name="l00661"></a>00661       <span class="comment">// If we are to say low loyalty, do chance</span>
<a name="l00662"></a>00662       <span class="keywordflow">if</span> ( bCivHint != -1 &amp;&amp; bCivLowLoyalty &amp;&amp; !bMiners )
<a name="l00663"></a>00663       {
<a name="l00664"></a>00664             <span class="keywordflow">if</span> ( <a class="code" href="Random_8cpp.html#49f938d1313ab6ef09ac6223a16ac334">Random</a>( 100 ) &lt; 25 )
<a name="l00665"></a>00665             {
<a name="l00666"></a>00666                   <span class="comment">// Get rid of hint...</span>
<a name="l00667"></a>00667                   bCivHint = -1;
<a name="l00668"></a>00668             }
<a name="l00669"></a>00669       }
<a name="l00670"></a>00670 
<a name="l00671"></a>00671       <span class="comment">// Say hint if availible...</span>
<a name="l00672"></a>00672       <span class="keywordflow">if</span> ( bCivHint != -1 )
<a name="l00673"></a>00673       {
<a name="l00674"></a>00674             <span class="keywordflow">if</span> ( ubCivType == CIV_TYPE_ADULT )
<a name="l00675"></a>00675             {
<a name="l00676"></a>00676                   (*pubCivHintToUse) = bCivHint;
<a name="l00677"></a>00677 
<a name="l00678"></a>00678                   <span class="comment">// Set quote as used...</span>
<a name="l00679"></a>00679                   <a class="code" href="NPC_8cpp.html#f9d3b0f48ff8e90918dd486da5159eb8">ConsiderCivilianQuotes</a>( <a class="code" href="strategicmap_8cpp.html#49d9aed144a633fda4ba1990f002d703">gWorldSectorX</a>, <a class="code" href="strategicmap_8cpp.html#ea322310ced0e35ee18a2ee7b32aac5b">gWorldSectorY</a>, <a class="code" href="strategicmap_8cpp.html#da715721a8ceedd42acf6ddb33e63ce0">gbWorldSectorZ</a>, TRUE );
<a name="l00680"></a>00680 
<a name="l00681"></a>00681                   <span class="comment">// retrun value....</span>
<a name="l00682"></a>00682                   <span class="keywordflow">return</span>( CIV_QUOTE_HINT );
<a name="l00683"></a>00683             }
<a name="l00684"></a>00684       }
<a name="l00685"></a>00685 
<a name="l00686"></a>00686       <span class="keywordflow">if</span> ( bCivLowLoyalty )
<a name="l00687"></a>00687       {
<a name="l00688"></a>00688             <span class="keywordflow">if</span> ( ubCivType == CIV_TYPE_ADULT )
<a name="l00689"></a>00689             {
<a name="l00690"></a>00690                   <span class="keywordflow">return</span>( <a class="code" href="Civ_01Quotes_8h.html#2db06901d03245a790e5571701aba3dfc6574fa9136f6051dbde89cd1f13bee8">CIV_QUOTE_ADULTS_EXTREMLY_LOW_LOYALTY</a> );
<a name="l00691"></a>00691             }
<a name="l00692"></a>00692             <span class="keywordflow">else</span>
<a name="l00693"></a>00693             {
<a name="l00694"></a>00694                   <span class="keywordflow">return</span>( <a class="code" href="Civ_01Quotes_8h.html#2db06901d03245a790e5571701aba3df14cb4f4d73f78512ac07b8076f683fbd">CIV_QUOTE_KIDS_EXTREMLY_LOW_LOYALTY</a> );
<a name="l00695"></a>00695             }
<a name="l00696"></a>00696       }
<a name="l00697"></a>00697 
<a name="l00698"></a>00698       <span class="keywordflow">if</span> ( bCivHighLoyalty )
<a name="l00699"></a>00699       {
<a name="l00700"></a>00700             <span class="keywordflow">if</span> ( ubCivType == CIV_TYPE_ADULT )
<a name="l00701"></a>00701             {
<a name="l00702"></a>00702                   <span class="keywordflow">return</span>( <a class="code" href="Civ_01Quotes_8h.html#2db06901d03245a790e5571701aba3df4de6f7d5979c508a749d6c0207e1ae7a">CIV_QUOTE_ADULTS_HIGH_LOYALTY</a> );
<a name="l00703"></a>00703             }
<a name="l00704"></a>00704             <span class="keywordflow">else</span>
<a name="l00705"></a>00705             {
<a name="l00706"></a>00706                   <span class="keywordflow">return</span>( <a class="code" href="Civ_01Quotes_8h.html#2db06901d03245a790e5571701aba3df4d482817002ec877cc292f9d9f0c16c5">CIV_QUOTE_KIDS_HIGH_LOYALTY</a> );
<a name="l00707"></a>00707             }
<a name="l00708"></a>00708       }
<a name="l00709"></a>00709 
<a name="l00710"></a>00710 
<a name="l00711"></a>00711       <span class="comment">// All purpose quote here....</span>
<a name="l00712"></a>00712       <span class="keywordflow">if</span> ( ubCivType == CIV_TYPE_ADULT )
<a name="l00713"></a>00713       {
<a name="l00714"></a>00714             <span class="keywordflow">return</span>( <a class="code" href="Civ_01Quotes_8h.html#2db06901d03245a790e5571701aba3dfaf67cca6c5c4bb955a48fad7c6036d0b">CIV_QUOTE_ADULTS_ALL_PURPOSE</a> );
<a name="l00715"></a>00715       }
<a name="l00716"></a>00716       <span class="keywordflow">else</span>
<a name="l00717"></a>00717       {
<a name="l00718"></a>00718             <span class="keywordflow">return</span>( <a class="code" href="Civ_01Quotes_8h.html#2db06901d03245a790e5571701aba3df8f9a1132838eaeb23203a16acdd44f6a">CIV_QUOTE_KIDS_ALL_PURPOSE</a> );
<a name="l00719"></a>00719       }
<a name="l00720"></a>00720 
<a name="l00721"></a>00721 }
<a name="l00722"></a>00722 
<a name="l00723"></a>00723 
<a name="l00724"></a><a class="code" href="Civ_01Quotes_8h.html#28d96150bbfa13dae19e56a5ba314520">00724</a> <span class="keywordtype">void</span> <a class="code" href="Civ_01Quotes_8cpp.html#28d96150bbfa13dae19e56a5ba314520">HandleCivQuote</a>( )
<a name="l00725"></a>00725 {
<a name="l00726"></a>00726       <span class="keywordflow">if</span> ( <a class="code" href="Civ_01Quotes_8cpp.html#46a4e0cbd887477d994d947d3b630589">gCivQuoteData</a>.<a class="code" href="structQUOTE__SYSTEM__STRUCT.html#8641bb125b9845bc684f6b1e0495f613">bActive</a> )
<a name="l00727"></a>00727       {
<a name="l00728"></a>00728             <span class="comment">// Check for min time....</span>
<a name="l00729"></a>00729             <span class="keywordflow">if</span> ( ( GetJA2Clock( ) - <a class="code" href="Civ_01Quotes_8cpp.html#46a4e0cbd887477d994d947d3b630589">gCivQuoteData</a>.<a class="code" href="structQUOTE__SYSTEM__STRUCT.html#fa55d1e66ceef372cf7cfef72c978eb0">uiTimeOfCreation</a> ) &gt; <a class="code" href="Civ_01Quotes_8cpp.html#46a4e0cbd887477d994d947d3b630589">gCivQuoteData</a>.<a class="code" href="structQUOTE__SYSTEM__STRUCT.html#65fe9920ac9ca22df543ad4a51a87eba">uiDelayTime</a> )
<a name="l00730"></a>00730             {
<a name="l00731"></a>00731                   <span class="comment">// Stop!</span>
<a name="l00732"></a>00732                   <a class="code" href="Civ_01Quotes_8cpp.html#668d73e6a53e410c417fabb3f70c50de">ShutDownQuoteBox</a>( TRUE );
<a name="l00733"></a>00733             }
<a name="l00734"></a>00734       }
<a name="l00735"></a>00735 }
<a name="l00736"></a>00736 
<a name="l00737"></a><a class="code" href="Civ_01Quotes_8h.html#bafe61642969c6a2185749fe92cd9375">00737</a> <span class="keywordtype">void</span> <a class="code" href="Civ_01Quotes_8cpp.html#bafe61642969c6a2185749fe92cd9375">StartCivQuote</a>( <a class="code" href="structSOLDIERTYPE.html">SOLDIERTYPE</a> *pCiv )
<a name="l00738"></a>00738 {
<a name="l00739"></a>00739       <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubCivQuoteID;
<a name="l00740"></a>00740       <a class="code" href="Types_8h.html#30f500129d8c688af07726d5d34ce52d">INT16</a> sX, sY;
<a name="l00741"></a>00741       <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubEntryID = 0;
<a name="l00742"></a>00742       <a class="code" href="Types_8h.html#30f500129d8c688af07726d5d34ce52d">INT16</a> sScreenX, sScreenY;
<a name="l00743"></a>00743       <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubCivHintToUse;
<a name="l00744"></a>00744 
<a name="l00745"></a>00745       <span class="comment">// ATE: Check for old quote.....</span>
<a name="l00746"></a>00746       <span class="comment">// This could have been stored on last attempt...</span>
<a name="l00747"></a>00747       <span class="keywordflow">if</span> ( pCiv-&gt;<a class="code" href="structSOLDIERTYPE.html#48ea85b88c93eb65c1afdc9618ab50a2">bCurrentCivQuote</a> == CIV_QUOTE_HINT )
<a name="l00748"></a>00748       {
<a name="l00749"></a>00749             <span class="comment">// Determine which quote to say.....</span>
<a name="l00750"></a>00750     <span class="comment">// CAN'T USE HINTS, since we just did one...</span>
<a name="l00751"></a>00751     pCiv-&gt;<a class="code" href="structSOLDIERTYPE.html#48ea85b88c93eb65c1afdc9618ab50a2">bCurrentCivQuote</a> = -1;
<a name="l00752"></a>00752             pCiv-&gt;<a class="code" href="structSOLDIERTYPE.html#7d372b22295b3de710e36c7f3e9d4550">bCurrentCivQuoteDelta</a> = 0;
<a name="l00753"></a>00753             ubCivQuoteID = <a class="code" href="Civ_01Quotes_8cpp.html#ce7e7e396c00dd035630f2ea699c4148">DetermineCivQuoteEntry</a>( pCiv, &amp;ubCivHintToUse, FALSE );
<a name="l00754"></a>00754       }
<a name="l00755"></a>00755       <span class="keywordflow">else</span>
<a name="l00756"></a>00756       {
<a name="l00757"></a>00757             <span class="comment">// Determine which quote to say.....</span>
<a name="l00758"></a>00758             ubCivQuoteID = <a class="code" href="Civ_01Quotes_8cpp.html#ce7e7e396c00dd035630f2ea699c4148">DetermineCivQuoteEntry</a>( pCiv, &amp;ubCivHintToUse, TRUE );
<a name="l00759"></a>00759       }
<a name="l00760"></a>00760 
<a name="l00761"></a>00761       <span class="comment">// Determine entry id</span>
<a name="l00762"></a>00762       <span class="comment">// ATE: Try and get entry from soldier pointer....</span>
<a name="l00763"></a>00763       <span class="keywordflow">if</span> ( ubCivQuoteID != CIV_QUOTE_HINT )
<a name="l00764"></a>00764       {
<a name="l00765"></a>00765             <span class="keywordflow">if</span> ( pCiv-&gt;<a class="code" href="structSOLDIERTYPE.html#48ea85b88c93eb65c1afdc9618ab50a2">bCurrentCivQuote</a> == -1 )
<a name="l00766"></a>00766             {
<a name="l00767"></a>00767                   <span class="comment">// Pick random one</span>
<a name="l00768"></a>00768                   pCiv-&gt;<a class="code" href="structSOLDIERTYPE.html#48ea85b88c93eb65c1afdc9618ab50a2">bCurrentCivQuote</a> = (<a class="code" href="Types_8h.html#7ebe70ceca856797319175e30bcf003d">INT8</a>)<a class="code" href="Random_8cpp.html#49f938d1313ab6ef09ac6223a16ac334">Random</a>( <a class="code" href="Civ_01Quotes_8cpp.html#c259a10701206b8c8dd6df405c556310">gCivQuotes</a>[ ubCivQuoteID ].ubNumEntries - 2 );
<a name="l00769"></a>00769                   pCiv-&gt;<a class="code" href="structSOLDIERTYPE.html#7d372b22295b3de710e36c7f3e9d4550">bCurrentCivQuoteDelta</a> = 0;
<a name="l00770"></a>00770             }
<a name="l00771"></a>00771 
<a name="l00772"></a>00772             ubEntryID    = pCiv-&gt;<a class="code" href="structSOLDIERTYPE.html#48ea85b88c93eb65c1afdc9618ab50a2">bCurrentCivQuote</a> + pCiv-&gt;<a class="code" href="structSOLDIERTYPE.html#7d372b22295b3de710e36c7f3e9d4550">bCurrentCivQuoteDelta</a>;
<a name="l00773"></a>00773       }
<a name="l00774"></a>00774       <span class="keywordflow">else</span>
<a name="l00775"></a>00775       {
<a name="l00776"></a>00776             ubEntryID = ubCivHintToUse;
<a name="l00777"></a>00777 
<a name="l00778"></a>00778             <span class="comment">// ATE: set value for quote ID.....</span>
<a name="l00779"></a>00779             pCiv-&gt;<a class="code" href="structSOLDIERTYPE.html#48ea85b88c93eb65c1afdc9618ab50a2">bCurrentCivQuote</a>              = ubCivQuoteID;
<a name="l00780"></a>00780             pCiv-&gt;<a class="code" href="structSOLDIERTYPE.html#7d372b22295b3de710e36c7f3e9d4550">bCurrentCivQuoteDelta</a> = ubEntryID;
<a name="l00781"></a>00781 
<a name="l00782"></a>00782       }
<a name="l00783"></a>00783 
<a name="l00784"></a>00784       <span class="comment">// Determine location...</span>
<a name="l00785"></a>00785       <span class="comment">// Get location of civ on screen.....</span>
<a name="l00786"></a>00786       <a class="code" href="Soldier_01Find_8cpp.html#b30c2b209e35ad322aafd4c4f583cf15">GetSoldierScreenPos</a>( pCiv, &amp;sScreenX, &amp;sScreenY );
<a name="l00787"></a>00787       sX = sScreenX;
<a name="l00788"></a>00788       sY = sScreenY;
<a name="l00789"></a>00789 
<a name="l00790"></a>00790       <span class="comment">// begin quote</span>
<a name="l00791"></a>00791       <a class="code" href="Civ_01Quotes_8cpp.html#77d064dff1b7b3fc582fd2de3a6faed6">BeginCivQuote</a>( pCiv, ubCivQuoteID, ubEntryID, sX, sY );
<a name="l00792"></a>00792 
<a name="l00793"></a>00793       <span class="comment">// Increment use</span>
<a name="l00794"></a>00794       <span class="keywordflow">if</span> ( ubCivQuoteID != CIV_QUOTE_HINT )
<a name="l00795"></a>00795       {
<a name="l00796"></a>00796             pCiv-&gt;<a class="code" href="structSOLDIERTYPE.html#7d372b22295b3de710e36c7f3e9d4550">bCurrentCivQuoteDelta</a>++;
<a name="l00797"></a>00797 
<a name="l00798"></a>00798             <span class="keywordflow">if</span> ( pCiv-&gt;<a class="code" href="structSOLDIERTYPE.html#7d372b22295b3de710e36c7f3e9d4550">bCurrentCivQuoteDelta</a> == 2 )
<a name="l00799"></a>00799             {
<a name="l00800"></a>00800                   pCiv-&gt;<a class="code" href="structSOLDIERTYPE.html#7d372b22295b3de710e36c7f3e9d4550">bCurrentCivQuoteDelta</a> = 0;
<a name="l00801"></a>00801             }
<a name="l00802"></a>00802       }
<a name="l00803"></a>00803 }
<a name="l00804"></a>00804 
<a name="l00805"></a>00805 
<a name="l00806"></a><a class="code" href="Civ_01Quotes_8h.html#27acf95f6c630724d3411f924f385cb4">00806</a> <span class="keywordtype">void</span> <a class="code" href="Civ_01Quotes_8cpp.html#27acf95f6c630724d3411f924f385cb4">InitCivQuoteSystem</a>( )
<a name="l00807"></a>00807 {
<a name="l00808"></a>00808       memset( &amp;<a class="code" href="Civ_01Quotes_8cpp.html#c259a10701206b8c8dd6df405c556310">gCivQuotes</a>, 0, <span class="keyword">sizeof</span>( <a class="code" href="Civ_01Quotes_8cpp.html#c259a10701206b8c8dd6df405c556310">gCivQuotes</a> ) );
<a name="l00809"></a>00809       <a class="code" href="Civ_01Quotes_8cpp.html#00b9058f3c653c6a816a04ee34928785">CopyNumEntriesIntoQuoteStruct</a>( );
<a name="l00810"></a>00810 
<a name="l00811"></a>00811       memset( &amp;<a class="code" href="Civ_01Quotes_8cpp.html#46a4e0cbd887477d994d947d3b630589">gCivQuoteData</a>, 0, <span class="keyword">sizeof</span>( <a class="code" href="Civ_01Quotes_8cpp.html#46a4e0cbd887477d994d947d3b630589">gCivQuoteData</a> ) );
<a name="l00812"></a>00812       gCivQuoteData.bActive                     = FALSE;
<a name="l00813"></a>00813       gCivQuoteData.iVideoOverlay   = -1;
<a name="l00814"></a>00814       gCivQuoteData.iDialogueBox    = -1;
<a name="l00815"></a>00815 }
<a name="l00816"></a>00816 
<a name="l00817"></a>00817 
<a name="l00818"></a><a class="code" href="Civ_01Quotes_8h.html#5d4d639be19cf56c97551ad2aae4b57d">00818</a> <a class="code" href="Types_8h.html#112e3146cb38b6ee95e64d85842e380a">BOOLEAN</a> <a class="code" href="Civ_01Quotes_8cpp.html#5d4d639be19cf56c97551ad2aae4b57d">SaveCivQuotesToSaveGameFile</a>( <a class="code" href="LibraryDataBase_8h.html#210e2fc1c18208cbf159ef9c087d6721">HWFILE</a> hFile )
<a name="l00819"></a>00819 {
<a name="l00820"></a>00820       <a class="code" href="Types_8h.html#e1e6edbbc26d6fbc71a90190d0266018">UINT32</a>      uiNumBytesWritten;
<a name="l00821"></a>00821 
<a name="l00822"></a>00822       <a class="code" href="FileMan_8cpp.html#09ed41c07d607c8c64a7e2b9fb25660c">FileWrite</a>( hFile, &amp;<a class="code" href="Civ_01Quotes_8cpp.html#c259a10701206b8c8dd6df405c556310">gCivQuotes</a>, <span class="keyword">sizeof</span>( <a class="code" href="Civ_01Quotes_8cpp.html#c259a10701206b8c8dd6df405c556310">gCivQuotes</a> ), &amp;uiNumBytesWritten );
<a name="l00823"></a>00823       <span class="keywordflow">if</span>( uiNumBytesWritten != <span class="keyword">sizeof</span>( gCivQuotes ) )
<a name="l00824"></a>00824       {
<a name="l00825"></a>00825             <span class="keywordflow">return</span>( FALSE );
<a name="l00826"></a>00826       }
<a name="l00827"></a>00827 
<a name="l00828"></a>00828       <span class="keywordflow">return</span>( TRUE );
<a name="l00829"></a>00829 }
<a name="l00830"></a>00830 
<a name="l00831"></a>00831 
<a name="l00832"></a><a class="code" href="Civ_01Quotes_8h.html#b4000c5fc58b271fe86a3dbd54cc58e5">00832</a> <a class="code" href="Types_8h.html#112e3146cb38b6ee95e64d85842e380a">BOOLEAN</a> <a class="code" href="Civ_01Quotes_8cpp.html#b4000c5fc58b271fe86a3dbd54cc58e5">LoadCivQuotesFromLoadGameFile</a>( <a class="code" href="LibraryDataBase_8h.html#210e2fc1c18208cbf159ef9c087d6721">HWFILE</a> hFile )
<a name="l00833"></a>00833 {
<a name="l00834"></a>00834       <a class="code" href="Types_8h.html#e1e6edbbc26d6fbc71a90190d0266018">UINT32</a>      uiNumBytesRead;
<a name="l00835"></a>00835 
<a name="l00836"></a>00836       <a class="code" href="FileMan_8cpp.html#1b213074411fd4c1dc8fd345e787b17e">FileRead</a>( hFile, &amp;<a class="code" href="Civ_01Quotes_8cpp.html#c259a10701206b8c8dd6df405c556310">gCivQuotes</a>, <span class="keyword">sizeof</span>( <a class="code" href="Civ_01Quotes_8cpp.html#c259a10701206b8c8dd6df405c556310">gCivQuotes</a> ), &amp;uiNumBytesRead );
<a name="l00837"></a>00837       <span class="keywordflow">if</span>( uiNumBytesRead != <span class="keyword">sizeof</span>( gCivQuotes ) )
<a name="l00838"></a>00838       {
<a name="l00839"></a>00839             <span class="keywordflow">return</span>( FALSE );
<a name="l00840"></a>00840       }
<a name="l00841"></a>00841 
<a name="l00842"></a>00842       <a class="code" href="Civ_01Quotes_8cpp.html#00b9058f3c653c6a816a04ee34928785">CopyNumEntriesIntoQuoteStruct</a>( );
<a name="l00843"></a>00843 
<a name="l00844"></a>00844       <span class="keywordflow">return</span>( TRUE );
<a name="l00845"></a>00845 }
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Sat Sep 9 13:48:00 2006 for Build by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.4.7 </small></address>
</body>
</html>
