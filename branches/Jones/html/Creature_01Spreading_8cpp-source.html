<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>Build: Creature Spreading.cpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.4.7 -->
<div class="tabs">
  <ul>
    <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="classes.html"><span>Classes</span></a></li>
    <li id="current"><a href="files.html"><span>Files</span></a></li>
    <li><a href="dirs.html"><span>Directories</span></a></li>
    <li>
      <form action="search.php" method="get">
        <table cellspacing="0" cellpadding="0" border="0">
          <tr>
            <td><label>&nbsp;<u>S</u>earch&nbsp;for&nbsp;</label></td>
            <td><input type="text" name="query" value="" size="20" accesskey="s"/></td>
          </tr>
        </table>
      </form>
    </li>
  </ul></div>
<div class="tabs">
  <ul>
    <li><a href="files.html"><span>File&nbsp;List</span></a></li>
    <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
  </ul></div>
<div class="nav">
<a class="el" href="dir_3179ea33d55a76dc38212d9eab798728.html">export</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_e5664b4b56927c8728eb3192fa60e338.html">hdc2</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_1eb12a41a47efb9efcd82fa98f4f4dbd.html">FTP</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_80cc1f21a78ab7941088ea567f236150.html">ja2src</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_994ab287602efefceafe55287a3657d6.html">Build</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_5aba590d477d4824a9090ab3f8850834.html">Strategic</a></div>
<h1>Creature Spreading.cpp</h1><a href="Creature_01Spreading_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="preprocessor">#ifdef PRECOMPILEDHEADERS</span>
<a name="l00002"></a>00002 <span class="preprocessor"></span><span class="preprocessor">      #include "<a class="code" href="Strategic_01All_8h.html">Strategic All.h</a>"</span>
<a name="l00003"></a>00003 <span class="preprocessor">      #include "<a class="code" href="GameSettings_8h.html">GameSettings.h</a>"</span>
<a name="l00004"></a>00004 <span class="preprocessor">#else</span>
<a name="l00005"></a>00005 <span class="preprocessor"></span><span class="preprocessor">      #include "types.h"</span>
<a name="l00006"></a>00006 <span class="preprocessor">      #include "fileman.h"</span>
<a name="l00007"></a>00007 <span class="preprocessor">      #include "<a class="code" href="himage_8h.html">himage.h</a>"</span>
<a name="l00008"></a>00008 <span class="preprocessor">      #include "<a class="code" href="Creature_01Spreading_8h.html">Creature Spreading.h</a>"</span>
<a name="l00009"></a>00009 <span class="preprocessor">      #include "<a class="code" href="Campaign_01Types_8h.html">Campaign Types.h</a>"</span>
<a name="l00010"></a>00010 <span class="preprocessor">      #include "<a class="code" href="Strategic_01Movement_8h.html">Strategic Movement.h</a>"</span>
<a name="l00011"></a>00011 <span class="preprocessor">      #include "<a class="code" href="Game_01Event_01Hook_8h.html">Game Event Hook.h</a>"</span>
<a name="l00012"></a>00012 <span class="preprocessor">      #include "<a class="code" href="GameSettings_8h.html">GameSettings.h</a>"</span>
<a name="l00013"></a>00013 <span class="preprocessor">      #include "Random.h"</span>
<a name="l00014"></a>00014 <span class="preprocessor">      #include "<a class="code" href="message_8h.html">message.h</a>"</span>
<a name="l00015"></a>00015 <span class="preprocessor">      #include "<a class="code" href="Font_01Control_8h.html">Font Control.h</a>"</span>
<a name="l00016"></a>00016 <span class="preprocessor">      #include "<a class="code" href="Soldier_01Init_01List_8h.html">Soldier Init List.h</a>"</span>
<a name="l00017"></a>00017 <span class="preprocessor">      #include "<a class="code" href="lighting_8h.html">lighting.h</a>"</span>
<a name="l00018"></a>00018 <span class="preprocessor">      #include "<a class="code" href="strategicmap_8h.html">strategicmap.h</a>"</span>
<a name="l00019"></a>00019 <span class="preprocessor">      #include "<a class="code" href="Game_01Clock_8h.html">Game Clock.h</a>"</span>
<a name="l00020"></a>00020 <span class="preprocessor">      #include "<a class="code" href="Strategic_01Mines_8h.html">Strategic Mines.h</a>"</span>
<a name="l00021"></a>00021 <span class="preprocessor">      #include "<a class="code" href="Music_01Control_8h.html">Music Control.h</a>"</span>
<a name="l00022"></a>00022 <span class="preprocessor">      #include "<a class="code" href="strategic_8h.html">strategic.h</a>"</span>
<a name="l00023"></a>00023 <span class="preprocessor">      #include "<a class="code" href="jascreens_8h.html">jascreens.h</a>"</span>
<a name="l00024"></a>00024 <span class="preprocessor">      #include "<a class="code" href="Town_01Militia_8h.html">Town Militia.h</a>"</span>
<a name="l00025"></a>00025 <span class="preprocessor">      #include "<a class="code" href="Strategic_01Town_01Loyalty_8h.html">Strategic Town Loyalty.h</a>"</span>
<a name="l00026"></a>00026 <span class="preprocessor">      #include "<a class="code" href="PreBattle_01Interface_8h.html">PreBattle Interface.h</a>"</span>
<a name="l00027"></a>00027 <span class="preprocessor">      #include "<a class="code" href="Map_01Edgepoints_8h.html">Map Edgepoints.h</a>"</span>
<a name="l00028"></a>00028 <span class="preprocessor">      #include "<a class="code" href="Animation_01Data_8h.html">Animation Data.h</a>"</span>
<a name="l00029"></a>00029 <span class="preprocessor">      #include "<a class="code" href="opplist_8h.html">opplist.h</a>"</span>
<a name="l00030"></a>00030 <span class="preprocessor">#endif</span>
<a name="l00031"></a>00031 <span class="preprocessor"></span>
<a name="l00032"></a>00032 <span class="preprocessor">#ifdef JA2BETAVERSION</span>
<a name="l00033"></a><a class="code" href="Queen_01Command_8cpp.html#6f17ecf03a7088f6798c48822cc50137">00033</a> <span class="preprocessor"></span>      <a class="code" href="Types_8h.html#112e3146cb38b6ee95e64d85842e380a">BOOLEAN</a> <a class="code" href="Creature_01Spreading_8cpp.html#6f17ecf03a7088f6798c48822cc50137">gfClearCreatureQuest</a> = FALSE;
<a name="l00034"></a>00034       <span class="keyword">extern</span> <a class="code" href="Types_8h.html#e1e6edbbc26d6fbc71a90190d0266018">UINT32</a> <a class="code" href="Creature_01Spreading_8cpp.html#2acea5fee65b14f2e4cb786043dcf4cc">uiMeanWhileFlags</a>;
<a name="l00035"></a>00035 <span class="preprocessor">#endif</span>
<a name="l00036"></a>00036 <span class="preprocessor"></span>
<a name="l00037"></a>00037 <span class="comment">//GAME BALANCING DEFINITIONS FOR CREATURE SPREADING</span>
<a name="l00038"></a>00038 <span class="comment">//Hopefully, adjusting these following definitions will ease the balancing of the</span>
<a name="l00039"></a>00039 <span class="comment">//creature spreading.</span>
<a name="l00040"></a>00040 <span class="comment">//The one note here is that for any definitions that have a XXX_BONUS at the end of a definition,</span>
<a name="l00041"></a>00041 <span class="comment">//it gets added on to it's counterpart via:</span>
<a name="l00042"></a>00042 <span class="comment">//                                              XXX_VALUE + Random( 1 + XXX_BONUS )</span>
<a name="l00043"></a>00043 
<a name="l00044"></a>00044 <span class="comment">//The start day random bonus that the queen begins</span>
<a name="l00045"></a>00045 <span class="comment">//#define EASY_QUEEN_START_DAY                                                10    //easy start day 10-13</span>
<a name="l00046"></a>00046 <span class="comment">//#define EASY_QUEEN_START_BONUS                                        3</span>
<a name="l00047"></a>00047 <span class="comment">//#define NORMAL_QUEEN_START_DAY                                        8           //normal start day 8-10</span>
<a name="l00048"></a>00048 <span class="comment">//#define NORMAL_QUEEN_START_BONUS                                2</span>
<a name="l00049"></a>00049 <span class="comment">//#define HARD_QUEEN_START_DAY                                                7           //hard start day 7-8</span>
<a name="l00050"></a>00050 <span class="comment">//#define HARD_QUEEN_START_BONUS                                        1</span>
<a name="l00051"></a>00051 
<a name="l00052"></a>00052 <span class="comment">//This is how often the creatures spread, once the quest begins.  The smaller the gap,</span>
<a name="l00053"></a>00053 <span class="comment">//the faster the creatures will advance.  This is also directly related to the reproduction</span>
<a name="l00054"></a>00054 <span class="comment">//rates which are applied each time the creatures spread.</span>
<a name="l00055"></a>00055 <span class="preprocessor">#define EASY_SPREAD_TIME_IN_MINUTES                         510   //easy spreads every 8.5 hours</span>
<a name="l00056"></a>00056 <span class="preprocessor"></span><span class="preprocessor">#define NORMAL_SPREAD_TIME_IN_MINUTES                       450   //normal spreads every 7.5 hours</span>
<a name="l00057"></a>00057 <span class="preprocessor"></span><span class="preprocessor">#define HARD_SPREAD_TIME_IN_MINUTES                         390   //hard spreads every 6.5 hours</span>
<a name="l00058"></a>00058 <span class="preprocessor"></span><span class="preprocessor">#define INSANE_SPREAD_TIME_IN_MINUTES                       150   //insane spreads every 2.5 hours</span>
<a name="l00059"></a>00059 <span class="preprocessor"></span>
<a name="l00060"></a>00060 <span class="comment">//Once the queen is added to the game, we can instantly let her spread x number of times</span>
<a name="l00061"></a>00061 <span class="comment">//to give her a head start.  This can also be a useful tool for having slow reproduction rates</span>
<a name="l00062"></a>00062 <span class="comment">//but quicker head start to compensate to make the creatures less aggressive overall.</span>
<a name="l00063"></a>00063 <span class="preprocessor">#define EASY_QUEEN_INIT_BONUS_SPREADS                       1</span>
<a name="l00064"></a>00064 <span class="preprocessor"></span><span class="preprocessor">#define NORMAL_QUEEN_INIT_BONUS_SPREADS               2</span>
<a name="l00065"></a>00065 <span class="preprocessor"></span><span class="preprocessor">#define HARD_QUEEN_INIT_BONUS_SPREADS                       3</span>
<a name="l00066"></a>00066 <span class="preprocessor"></span><span class="preprocessor">#define INSANE_QUEEN_INIT_BONUS_SPREADS                     5</span>
<a name="l00067"></a>00067 <span class="preprocessor"></span>
<a name="l00068"></a>00068 <span class="comment">//This value modifies the chance to populate a given sector.  This is different from the previous definition.</span>
<a name="l00069"></a>00069 <span class="comment">//This value gets applied to a potentially complicated formula, using the creature habitat to modify</span>
<a name="l00070"></a>00070 <span class="comment">//chance to populate, along with factoring in the relative distance to the hive range (to promote deeper lair</span>
<a name="l00071"></a>00071 <span class="comment">//population increases), etc.  I would recommend not tweaking the value too much in either direction from </span>
<a name="l00072"></a>00072 <span class="comment">//zero due to the fact that this can greatly effect spread times and maximum populations.  Basically, if the</span>
<a name="l00073"></a>00073 <span class="comment">//creatures are spreading too quickly, increase the value, otherwise decrease it to a negative value</span>
<a name="l00074"></a>00074 <span class="preprocessor">#define EASY_POPULATION_MODIFIER                                  0</span>
<a name="l00075"></a>00075 <span class="preprocessor"></span><span class="preprocessor">#define NORMAL_POPULATION_MODIFIER                          0</span>
<a name="l00076"></a>00076 <span class="preprocessor"></span><span class="preprocessor">#define HARD_POPULATION_MODIFIER                                  0</span>
<a name="l00077"></a>00077 <span class="preprocessor"></span><span class="preprocessor">#define INSANE_POPULATION_MODIFIER                                0</span>
<a name="l00078"></a>00078 <span class="preprocessor"></span>
<a name="l00079"></a>00079 <span class="comment">//Augments the chance that the creatures will attack a town.  The conditions for attacking a town</span>
<a name="l00080"></a>00080 <span class="comment">//are based strictly on the occupation of the creatures in each of the four mine exits.  For each creature</span>
<a name="l00081"></a>00081 <span class="comment">//there is a base chance of 10% that the creatures will feed sometime during the night.</span>
<a name="l00082"></a>00082 <span class="preprocessor">#define EASY_CREATURE_TOWN_AGGRESSIVENESS       -10</span>
<a name="l00083"></a>00083 <span class="preprocessor"></span><span class="preprocessor">#define NORMAL_CREATURE_TOWN_AGGRESSIVENESS     0</span>
<a name="l00084"></a>00084 <span class="preprocessor"></span><span class="preprocessor">#define HARD_CREATURE_TOWN_AGGRESSIVENESS       10</span>
<a name="l00085"></a>00085 <span class="preprocessor"></span><span class="preprocessor">#define INSANE_CREATURE_TOWN_AGGRESSIVENESS           50</span>
<a name="l00086"></a>00086 <span class="preprocessor"></span>
<a name="l00087"></a>00087 
<a name="l00088"></a>00088 <span class="comment">//This is how many creatures the queen produces for each cycle of spreading.  The higher</span>
<a name="l00089"></a>00089 <span class="comment">//the numbers the faster the creatures will advance.</span>
<a name="l00090"></a>00090 <span class="preprocessor">#define EASY_QUEEN_REPRODUCTION_BASE                        6 //6-7</span>
<a name="l00091"></a>00091 <span class="preprocessor"></span><span class="preprocessor">#define EASY_QUEEN_REPRODUCTION_BONUS                       1</span>
<a name="l00092"></a>00092 <span class="preprocessor"></span><span class="preprocessor">#define NORMAL_QUEEN_REPRODUCTION_BASE                7 //7-9</span>
<a name="l00093"></a>00093 <span class="preprocessor"></span><span class="preprocessor">#define NORMAL_QUEEN_REPRODUCTION_BONUS               2</span>
<a name="l00094"></a>00094 <span class="preprocessor"></span><span class="preprocessor">#define HARD_QUEEN_REPRODUCTION_BASE                        9 //9-12</span>
<a name="l00095"></a>00095 <span class="preprocessor"></span><span class="preprocessor">#define HARD_QUEEN_REPRODUCTION_BONUS                       3</span>
<a name="l00096"></a>00096 <span class="preprocessor"></span><span class="preprocessor">#define INSANE_QUEEN_REPRODUCTION_BASE                      15 //15-20</span>
<a name="l00097"></a>00097 <span class="preprocessor"></span><span class="preprocessor">#define INSANE_QUEEN_REPRODUCTION_BONUS                     5</span>
<a name="l00098"></a>00098 <span class="preprocessor"></span>
<a name="l00099"></a>00099 <span class="comment">//When either in a cave level with blue lights or there is a creature presence, then</span>
<a name="l00100"></a>00100 <span class="comment">//we override the normal music with the creature music.  The conditions are maintained</span>
<a name="l00101"></a>00101 <span class="comment">//inside the function PrepareCreaturesForBattle() in this module.</span>
<a name="l00102"></a><a class="code" href="Creature_01Spreading_8h.html#4605b946d86cc2c09fc6e765b9c89e7c">00102</a> <a class="code" href="Types_8h.html#112e3146cb38b6ee95e64d85842e380a">BOOLEAN</a> <a class="code" href="Creature_01Spreading_8cpp.html#4605b946d86cc2c09fc6e765b9c89e7c">gfUseCreatureMusic</a> = FALSE;
<a name="l00103"></a><a class="code" href="Creature_01Spreading_8cpp.html#6846a6c6febabdd94edaa35217aabfc8">00103</a> <a class="code" href="Types_8h.html#112e3146cb38b6ee95e64d85842e380a">BOOLEAN</a> <a class="code" href="SaveLoadGame_8cpp.html#6846a6c6febabdd94edaa35217aabfc8">gfCreatureMeanwhileScenePlayed</a> = FALSE;
<a name="l00104"></a>00104 <span class="keyword">enum</span>
<a name="l00105"></a>00105 {
<a name="l00106"></a>00106       <a class="code" href="Creature_01Spreading_8cpp.html#188c132f478fb544e0213ea0020585bcc593579d35b0f087c8b9a39b34ad705d">QUEEN_LAIR</a>,                   <span class="comment">//where the queen lives.  Highly protected</span>
<a name="l00107"></a>00107       <a class="code" href="Creature_01Spreading_8cpp.html#188c132f478fb544e0213ea0020585bc2ac8ec47e8b8e49969e0cf9c580654cf">LAIR</a>,                                     <span class="comment">//part of the queen's lair -- lots of babies and defending mothers</span>
<a name="l00108"></a>00108       <a class="code" href="Creature_01Spreading_8cpp.html#188c132f478fb544e0213ea0020585bc2ac5fa94536136286b813ffa4a2aec1e">LAIR_ENTRANCE</a>,          <span class="comment">//where the creatures access the mine.  </span>
<a name="l00109"></a>00109       <a class="code" href="Creature_01Spreading_8cpp.html#188c132f478fb544e0213ea0020585bc8cb8d444f6fa92714c918fd7a1e8a00d">INNER_MINE</a>,                   <span class="comment">//parts of the mines that aren't close to the outside world</span>
<a name="l00110"></a>00110       <a class="code" href="Creature_01Spreading_8cpp.html#188c132f478fb544e0213ea0020585bc0252708b8e3dd2a2b5feb404649f1a59">OUTER_MINE</a>,                   <span class="comment">//area's where miners work, close to towns, creatures love to eat :)</span>
<a name="l00111"></a>00111       <a class="code" href="Creature_01Spreading_8cpp.html#188c132f478fb544e0213ea0020585bcfa564bf961f4259b57ab12d62977f530">FEEDING_GROUNDS</a>,  <span class="comment">//creatures love to populate these sectors :)</span>
<a name="l00112"></a>00112       <a class="code" href="Creature_01Spreading_8cpp.html#188c132f478fb544e0213ea0020585bc0a79da9c3e34dedd3f6ff49262678e07">MINE_EXIT</a>,                    <span class="comment">//the area that creatures can initiate town attacks if lots of monsters.</span>
<a name="l00113"></a>00113 };
<a name="l00114"></a>00114 
<a name="l00115"></a><a class="code" href="structCREATURE__DIRECTIVE.html">00115</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structCREATURE__DIRECTIVE.html">CREATURE_DIRECTIVE</a>
<a name="l00116"></a>00116 {
<a name="l00117"></a><a class="code" href="structCREATURE__DIRECTIVE.html#bfbb4d4ab657f447f405bd987d8f719e">00117</a>       <span class="keyword">struct </span><a class="code" href="structCREATURE__DIRECTIVE.html">CREATURE_DIRECTIVE</a> *<a class="code" href="structCREATURE__DIRECTIVE.html#bfbb4d4ab657f447f405bd987d8f719e">next</a>;
<a name="l00118"></a><a class="code" href="structCREATURE__DIRECTIVE.html#bff6a87fbf7df1c95b8f9f2e0f74f09d">00118</a>       <a class="code" href="structUNDERGROUND__SECTORINFO.html">UNDERGROUND_SECTORINFO</a> *<a class="code" href="structCREATURE__DIRECTIVE.html#bff6a87fbf7df1c95b8f9f2e0f74f09d">pLevel</a>;
<a name="l00119"></a>00119 }<a class="code" href="structCREATURE__DIRECTIVE.html">CREATURE_DIRECTIVE</a>;
<a name="l00120"></a>00120 
<a name="l00121"></a><a class="code" href="Creature_01Spreading_8cpp.html#f6419c60c42874dbb013443c02534a6a">00121</a> <a class="code" href="structCREATURE__DIRECTIVE.html">CREATURE_DIRECTIVE</a> *<a class="code" href="Creature_01Spreading_8cpp.html#f6419c60c42874dbb013443c02534a6a">lair</a>;
<a name="l00122"></a><a class="code" href="Creature_01Spreading_8cpp.html#6c1ae8dabd332f455970b1cfc21bbedd">00122</a> <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a> <a class="code" href="Creature_01Spreading_8cpp.html#6c1ae8dabd332f455970b1cfc21bbedd">giHabitatedDistance</a> = 0;
<a name="l00123"></a><a class="code" href="Creature_01Spreading_8cpp.html#2ca411c8ef1417eeda35cc309a4f2220">00123</a> <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a> <a class="code" href="Creature_01Spreading_8cpp.html#2ca411c8ef1417eeda35cc309a4f2220">giPopulationModifier</a> = 0;
<a name="l00124"></a><a class="code" href="Creature_01Spreading_8cpp.html#b9d0d6cd30a304c1dba1c41a5312c190">00124</a> <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a> <a class="code" href="Creature_01Spreading_8cpp.html#b9d0d6cd30a304c1dba1c41a5312c190">giLairID</a> = 0;
<a name="l00125"></a><a class="code" href="Creature_01Spreading_8cpp.html#da7da2c006075a287418792f1a6a8d56">00125</a> <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a> <a class="code" href="Creature_01Spreading_8cpp.html#da7da2c006075a287418792f1a6a8d56">giDestroyedLairID</a> = 0;
<a name="l00126"></a>00126 
<a name="l00127"></a>00127 <span class="comment">//various information required for keeping track of the battle sector involved for</span>
<a name="l00128"></a>00128 <span class="comment">//prebattle interface, autoresolve, etc.</span>
<a name="l00129"></a><a class="code" href="Creature_01Spreading_8h.html#8d461824120f22908152c8f8cfdb61c7">00129</a> <a class="code" href="Types_8h.html#30f500129d8c688af07726d5d34ce52d">INT16</a> <a class="code" href="Creature_01Spreading_8cpp.html#8d461824120f22908152c8f8cfdb61c7">gsCreatureInsertionCode</a> = 0;
<a name="l00130"></a><a class="code" href="Creature_01Spreading_8h.html#16b4049935948e13e25173ea4f6ccfc7">00130</a> <a class="code" href="Types_8h.html#30f500129d8c688af07726d5d34ce52d">INT16</a> <a class="code" href="Creature_01Spreading_8cpp.html#16b4049935948e13e25173ea4f6ccfc7">gsCreatureInsertionGridNo</a> = 0;
<a name="l00131"></a><a class="code" href="Creature_01Spreading_8h.html#f234c8f6543322a61901fd234e431951">00131</a> <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> <a class="code" href="Creature_01Spreading_8cpp.html#f234c8f6543322a61901fd234e431951">gubNumCreaturesAttackingTown</a> = 0;
<a name="l00132"></a><a class="code" href="Creature_01Spreading_8h.html#84dcf8f90fc8c931c4e818e226ea6ddf">00132</a> <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> <a class="code" href="Creature_01Spreading_8cpp.html#84dcf8f90fc8c931c4e818e226ea6ddf">gubYoungMalesAttackingTown</a> = 0;
<a name="l00133"></a><a class="code" href="Creature_01Spreading_8h.html#9fea695dcd093a43ef47a7682e039438">00133</a> <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> <a class="code" href="Creature_01Spreading_8cpp.html#9fea695dcd093a43ef47a7682e039438">gubYoungFemalesAttackingTown</a> = 0;
<a name="l00134"></a><a class="code" href="Creature_01Spreading_8h.html#e6c1a6856edb6dd314dd9144cb2da5ed">00134</a> <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> <a class="code" href="Creature_01Spreading_8cpp.html#e6c1a6856edb6dd314dd9144cb2da5ed">gubAdultMalesAttackingTown</a> = 0;
<a name="l00135"></a><a class="code" href="Creature_01Spreading_8h.html#10769de3c8b8b1ddb1f7c05dfa93fa8c">00135</a> <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> <a class="code" href="Creature_01Spreading_8cpp.html#10769de3c8b8b1ddb1f7c05dfa93fa8c">gubAdultFemalesAttackingTown</a> = 0;
<a name="l00136"></a><a class="code" href="Creature_01Spreading_8h.html#b6b4580c49857ec8823250aae0b26aba">00136</a> <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> <a class="code" href="Creature_01Spreading_8cpp.html#b6b4580c49857ec8823250aae0b26aba">gubCreatureBattleCode</a> = <a class="code" href="Creature_01Spreading_8h.html#d4a9934b75947f1fae21deee31688bb7c5bf5e7c9e8282a9d074fdaa8157d347">CREATURE_BATTLE_CODE_NONE</a>;
<a name="l00137"></a><a class="code" href="Creature_01Spreading_8h.html#c17982f0be7b0c4ad1e9eb99650944b6">00137</a> <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> <a class="code" href="Creature_01Spreading_8cpp.html#c17982f0be7b0c4ad1e9eb99650944b6">gubSectorIDOfCreatureAttack</a> = 0;
<a name="l00138"></a>00138 
<a name="l00139"></a>00139 <span class="keyword">extern</span> <a class="code" href="structUNDERGROUND__SECTORINFO.html">UNDERGROUND_SECTORINFO</a>* <a class="code" href="Creature_01Spreading_8cpp.html#8416712124d291c97f383014e261bb16">FindUnderGroundSector</a>( <a class="code" href="Types_8h.html#30f500129d8c688af07726d5d34ce52d">INT16</a> sMapX, <a class="code" href="Types_8h.html#30f500129d8c688af07726d5d34ce52d">INT16</a> sMapY, <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> bMapZ );
<a name="l00140"></a>00140 <span class="keyword">extern</span> <a class="code" href="structUNDERGROUND__SECTORINFO.html">UNDERGROUND_SECTORINFO</a>* <a class="code" href="Campaign_01Init_8cpp.html#dee207fe2b28c60152c0584c6e326e93">NewUndergroundNode</a>( <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubSectorX, <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubSectorY, <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubSectorZ );
<a name="l00141"></a>00141 <span class="keyword">extern</span> <span class="keywordtype">void</span> <a class="code" href="Campaign_01Init_8cpp.html#a588f1fc8a8722334dfff2f624f1321d">BuildUndergroundSectorInfoList</a>();
<a name="l00142"></a>00142 <span class="keywordtype">void</span> <a class="code" href="Creature_01Spreading_8cpp.html#bea04c743d552953de1139301e7045c8">DeleteCreatureDirectives</a>();
<a name="l00143"></a>00143 
<a name="l00144"></a>00144 <span class="keyword">extern</span> <a class="code" href="structMINE__STATUS__TYPE.html">MINE_STATUS_TYPE</a> <a class="code" href="Creature_01Spreading_8cpp.html#9380f2e39f34095d76ba1abab44dab29">gMineStatus</a>[ <a class="code" href="Strategic_01Mines_8h.html#a3dfb65ce3006aaab287357097352604c1e5d8fe484e44dd37bde096e12f2cf4">MAX_NUMBER_OF_MINES</a> ];
<a name="l00145"></a>00145 
<a name="l00146"></a><a class="code" href="Creature_01Spreading_8cpp.html#8e7ff57cc9d6c0be2023e242d3053509">00146</a> <a class="code" href="structCREATURE__DIRECTIVE.html">CREATURE_DIRECTIVE</a>* <a class="code" href="Creature_01Spreading_8cpp.html#8e7ff57cc9d6c0be2023e242d3053509">NewDirective</a>( <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubSectorID, <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubSectorZ, <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubCreatureHabitat )
<a name="l00147"></a>00147 {
<a name="l00148"></a>00148       <a class="code" href="structCREATURE__DIRECTIVE.html">CREATURE_DIRECTIVE</a> *curr;
<a name="l00149"></a>00149       <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubSectorX, ubSectorY;
<a name="l00150"></a>00150       curr = (<a class="code" href="structCREATURE__DIRECTIVE.html">CREATURE_DIRECTIVE</a>*)MemAlloc( <span class="keyword">sizeof</span>( <a class="code" href="structCREATURE__DIRECTIVE.html">CREATURE_DIRECTIVE</a> ) );
<a name="l00151"></a>00151       Assert( curr );
<a name="l00152"></a>00152       ubSectorX = (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)((ubSectorID % 16) + 1);
<a name="l00153"></a>00153       ubSectorY = (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)((ubSectorID / 16) + 1);
<a name="l00154"></a>00154       curr-&gt;<a class="code" href="structCREATURE__DIRECTIVE.html#bff6a87fbf7df1c95b8f9f2e0f74f09d">pLevel</a> = <a class="code" href="Creature_01Spreading_8cpp.html#8416712124d291c97f383014e261bb16">FindUnderGroundSector</a>( ubSectorX, ubSectorY, ubSectorZ );
<a name="l00155"></a>00155       <span class="keywordflow">if</span>( !curr-&gt;<a class="code" href="structCREATURE__DIRECTIVE.html#bff6a87fbf7df1c95b8f9f2e0f74f09d">pLevel</a> )
<a name="l00156"></a>00156       {
<a name="l00157"></a>00157             AssertMsg( 0, <a class="code" href="DEBUG_8cpp.html#88565bf27eec0b2003eb5bc9426b8e4b">String</a>( <span class="stringliteral">"Could not find underground sector node (%c%db_%d) that should exist."</span>,
<a name="l00158"></a>00158                   ubSectorY + <span class="charliteral">'A'</span> - 1, ubSectorX, ubSectorZ ) );
<a name="l00159"></a>00159             <span class="keywordflow">return</span> 0;
<a name="l00160"></a>00160       }
<a name="l00161"></a>00161 
<a name="l00162"></a>00162       curr-&gt;<a class="code" href="structCREATURE__DIRECTIVE.html#bff6a87fbf7df1c95b8f9f2e0f74f09d">pLevel</a>-&gt;<a class="code" href="structUNDERGROUND__SECTORINFO.html#f311bb8900c816d69dd6bebf904b5b29">ubCreatureHabitat</a> = ubCreatureHabitat;
<a name="l00163"></a>00163       Assert( curr-&gt;<a class="code" href="structCREATURE__DIRECTIVE.html#bff6a87fbf7df1c95b8f9f2e0f74f09d">pLevel</a> );
<a name="l00164"></a>00164       curr-&gt;<a class="code" href="structCREATURE__DIRECTIVE.html#bfbb4d4ab657f447f405bd987d8f719e">next</a> = NULL;
<a name="l00165"></a>00165       <span class="keywordflow">return</span> curr;
<a name="l00166"></a>00166 }
<a name="l00167"></a>00167 
<a name="l00168"></a><a class="code" href="Creature_01Spreading_8cpp.html#77d1e0856783e7827edcbdbe35044727">00168</a> <span class="keywordtype">void</span> <a class="code" href="Creature_01Spreading_8cpp.html#77d1e0856783e7827edcbdbe35044727">InitLairDrassen</a>()
<a name="l00169"></a>00169 {
<a name="l00170"></a>00170       <a class="code" href="structCREATURE__DIRECTIVE.html">CREATURE_DIRECTIVE</a> *curr;
<a name="l00171"></a>00171       <a class="code" href="Creature_01Spreading_8cpp.html#b9d0d6cd30a304c1dba1c41a5312c190">giLairID</a> = 1;
<a name="l00172"></a>00172       <span class="comment">//initialize the linked list of lairs</span>
<a name="l00173"></a>00173       <a class="code" href="Creature_01Spreading_8cpp.html#f6419c60c42874dbb013443c02534a6a">lair</a> = <a class="code" href="Creature_01Spreading_8cpp.html#8e7ff57cc9d6c0be2023e242d3053509">NewDirective</a>( <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643ddebc8efb3493e5278b3c22ae880fd98">SEC_F13</a>, 3, <a class="code" href="Creature_01Spreading_8cpp.html#188c132f478fb544e0213ea0020585bcc593579d35b0f087c8b9a39b34ad705d">QUEEN_LAIR</a> );
<a name="l00174"></a>00174       curr = <a class="code" href="Creature_01Spreading_8cpp.html#f6419c60c42874dbb013443c02534a6a">lair</a>;
<a name="l00175"></a>00175       <span class="keywordflow">if</span>( !curr-&gt;<a class="code" href="structCREATURE__DIRECTIVE.html#bff6a87fbf7df1c95b8f9f2e0f74f09d">pLevel</a>-&gt;<a class="code" href="structUNDERGROUND__SECTORINFO.html#1cf13c2feb769c29017a524d58ebe8c4">ubNumCreatures</a> )
<a name="l00176"></a>00176       {
<a name="l00177"></a>00177             curr-&gt;<a class="code" href="structCREATURE__DIRECTIVE.html#bff6a87fbf7df1c95b8f9f2e0f74f09d">pLevel</a>-&gt;<a class="code" href="structUNDERGROUND__SECTORINFO.html#1cf13c2feb769c29017a524d58ebe8c4">ubNumCreatures</a> = 1;   <span class="comment">//for the queen.</span>
<a name="l00178"></a>00178       }
<a name="l00179"></a>00179       curr-&gt;<a class="code" href="structCREATURE__DIRECTIVE.html#bfbb4d4ab657f447f405bd987d8f719e">next</a> = <a class="code" href="Creature_01Spreading_8cpp.html#8e7ff57cc9d6c0be2023e242d3053509">NewDirective</a>( <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c66026435a1de6a2897ce565364c097c7170ada0">SEC_G13</a>, 3, <a class="code" href="Creature_01Spreading_8cpp.html#188c132f478fb544e0213ea0020585bc2ac8ec47e8b8e49969e0cf9c580654cf">LAIR</a> );
<a name="l00180"></a>00180       curr = curr-&gt;<a class="code" href="structCREATURE__DIRECTIVE.html#bfbb4d4ab657f447f405bd987d8f719e">next</a>;
<a name="l00181"></a>00181       curr-&gt;<a class="code" href="structCREATURE__DIRECTIVE.html#bfbb4d4ab657f447f405bd987d8f719e">next</a> = <a class="code" href="Creature_01Spreading_8cpp.html#8e7ff57cc9d6c0be2023e242d3053509">NewDirective</a>( <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c66026435a1de6a2897ce565364c097c7170ada0">SEC_G13</a>, 2, <a class="code" href="Creature_01Spreading_8cpp.html#188c132f478fb544e0213ea0020585bc2ac5fa94536136286b813ffa4a2aec1e">LAIR_ENTRANCE</a> );
<a name="l00182"></a>00182       curr = curr-&gt;<a class="code" href="structCREATURE__DIRECTIVE.html#bfbb4d4ab657f447f405bd987d8f719e">next</a>;
<a name="l00183"></a>00183       curr-&gt;<a class="code" href="structCREATURE__DIRECTIVE.html#bfbb4d4ab657f447f405bd987d8f719e">next</a> = <a class="code" href="Creature_01Spreading_8cpp.html#8e7ff57cc9d6c0be2023e242d3053509">NewDirective</a>( <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643ddebc8efb3493e5278b3c22ae880fd98">SEC_F13</a>, 2, <a class="code" href="Creature_01Spreading_8cpp.html#188c132f478fb544e0213ea0020585bc8cb8d444f6fa92714c918fd7a1e8a00d">INNER_MINE</a> );
<a name="l00184"></a>00184       curr = curr-&gt;<a class="code" href="structCREATURE__DIRECTIVE.html#bfbb4d4ab657f447f405bd987d8f719e">next</a>;
<a name="l00185"></a>00185       curr-&gt;<a class="code" href="structCREATURE__DIRECTIVE.html#bfbb4d4ab657f447f405bd987d8f719e">next</a> = <a class="code" href="Creature_01Spreading_8cpp.html#8e7ff57cc9d6c0be2023e242d3053509">NewDirective</a>( <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c660264379208189c749fece42d995546ebdb1dc">SEC_E13</a>, 2, <a class="code" href="Creature_01Spreading_8cpp.html#188c132f478fb544e0213ea0020585bc8cb8d444f6fa92714c918fd7a1e8a00d">INNER_MINE</a> );
<a name="l00186"></a>00186       curr = curr-&gt;<a class="code" href="structCREATURE__DIRECTIVE.html#bfbb4d4ab657f447f405bd987d8f719e">next</a>;
<a name="l00187"></a>00187       curr-&gt;<a class="code" href="structCREATURE__DIRECTIVE.html#bfbb4d4ab657f447f405bd987d8f719e">next</a> = <a class="code" href="Creature_01Spreading_8cpp.html#8e7ff57cc9d6c0be2023e242d3053509">NewDirective</a>( <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c660264379208189c749fece42d995546ebdb1dc">SEC_E13</a>, 1, <a class="code" href="Creature_01Spreading_8cpp.html#188c132f478fb544e0213ea0020585bc0252708b8e3dd2a2b5feb404649f1a59">OUTER_MINE</a> );
<a name="l00188"></a>00188       curr = curr-&gt;<a class="code" href="structCREATURE__DIRECTIVE.html#bfbb4d4ab657f447f405bd987d8f719e">next</a>;
<a name="l00189"></a>00189       curr-&gt;<a class="code" href="structCREATURE__DIRECTIVE.html#bfbb4d4ab657f447f405bd987d8f719e">next</a> = <a class="code" href="Creature_01Spreading_8cpp.html#8e7ff57cc9d6c0be2023e242d3053509">NewDirective</a>( <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c66026435b0fbd8598540769dcf8f24e3134f48c">SEC_D13</a>, 1, <a class="code" href="Creature_01Spreading_8cpp.html#188c132f478fb544e0213ea0020585bc0a79da9c3e34dedd3f6ff49262678e07">MINE_EXIT</a> );
<a name="l00190"></a>00190 }
<a name="l00191"></a>00191 
<a name="l00192"></a><a class="code" href="Creature_01Spreading_8cpp.html#5572c91bcdaccde46e41a22a19d4b3e9">00192</a> <span class="keywordtype">void</span> <a class="code" href="Creature_01Spreading_8cpp.html#5572c91bcdaccde46e41a22a19d4b3e9">InitLairCambria</a>()
<a name="l00193"></a>00193 {
<a name="l00194"></a>00194       <a class="code" href="structCREATURE__DIRECTIVE.html">CREATURE_DIRECTIVE</a> *curr;
<a name="l00195"></a>00195       <a class="code" href="Creature_01Spreading_8cpp.html#b9d0d6cd30a304c1dba1c41a5312c190">giLairID</a> = 2;
<a name="l00196"></a>00196       <span class="comment">//initialize the linked list of lairs</span>
<a name="l00197"></a>00197       <a class="code" href="Creature_01Spreading_8cpp.html#f6419c60c42874dbb013443c02534a6a">lair</a> = <a class="code" href="Creature_01Spreading_8cpp.html#8e7ff57cc9d6c0be2023e242d3053509">NewDirective</a>( <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c660264371f9d533cddaf682f9ea2ce8fc7d6812">SEC_J8</a>, 3, <a class="code" href="Creature_01Spreading_8cpp.html#188c132f478fb544e0213ea0020585bcc593579d35b0f087c8b9a39b34ad705d">QUEEN_LAIR</a> );
<a name="l00198"></a>00198       curr = <a class="code" href="Creature_01Spreading_8cpp.html#f6419c60c42874dbb013443c02534a6a">lair</a>;
<a name="l00199"></a>00199       <span class="keywordflow">if</span>( !curr-&gt;<a class="code" href="structCREATURE__DIRECTIVE.html#bff6a87fbf7df1c95b8f9f2e0f74f09d">pLevel</a>-&gt;<a class="code" href="structUNDERGROUND__SECTORINFO.html#1cf13c2feb769c29017a524d58ebe8c4">ubNumCreatures</a> )
<a name="l00200"></a>00200       {
<a name="l00201"></a>00201             curr-&gt;<a class="code" href="structCREATURE__DIRECTIVE.html#bff6a87fbf7df1c95b8f9f2e0f74f09d">pLevel</a>-&gt;<a class="code" href="structUNDERGROUND__SECTORINFO.html#1cf13c2feb769c29017a524d58ebe8c4">ubNumCreatures</a> = 1;   <span class="comment">//for the queen.</span>
<a name="l00202"></a>00202       }
<a name="l00203"></a>00203       curr-&gt;<a class="code" href="structCREATURE__DIRECTIVE.html#bfbb4d4ab657f447f405bd987d8f719e">next</a> = <a class="code" href="Creature_01Spreading_8cpp.html#8e7ff57cc9d6c0be2023e242d3053509">NewDirective</a>( <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c660264303e0da7939fba7e3ffd739064bee4abd">SEC_I8</a>, 3, <a class="code" href="Creature_01Spreading_8cpp.html#188c132f478fb544e0213ea0020585bc2ac8ec47e8b8e49969e0cf9c580654cf">LAIR</a> );
<a name="l00204"></a>00204       curr = curr-&gt;<a class="code" href="structCREATURE__DIRECTIVE.html#bfbb4d4ab657f447f405bd987d8f719e">next</a>;
<a name="l00205"></a>00205       curr-&gt;<a class="code" href="structCREATURE__DIRECTIVE.html#bfbb4d4ab657f447f405bd987d8f719e">next</a> = <a class="code" href="Creature_01Spreading_8cpp.html#8e7ff57cc9d6c0be2023e242d3053509">NewDirective</a>( <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643897f1cfaae4b38d8022feec3521887df">SEC_H8</a>, 3, <a class="code" href="Creature_01Spreading_8cpp.html#188c132f478fb544e0213ea0020585bc2ac8ec47e8b8e49969e0cf9c580654cf">LAIR</a> );
<a name="l00206"></a>00206       curr = curr-&gt;<a class="code" href="structCREATURE__DIRECTIVE.html#bfbb4d4ab657f447f405bd987d8f719e">next</a>;
<a name="l00207"></a>00207       curr-&gt;<a class="code" href="structCREATURE__DIRECTIVE.html#bfbb4d4ab657f447f405bd987d8f719e">next</a> = <a class="code" href="Creature_01Spreading_8cpp.html#8e7ff57cc9d6c0be2023e242d3053509">NewDirective</a>( <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643897f1cfaae4b38d8022feec3521887df">SEC_H8</a>, 2, <a class="code" href="Creature_01Spreading_8cpp.html#188c132f478fb544e0213ea0020585bc2ac5fa94536136286b813ffa4a2aec1e">LAIR_ENTRANCE</a> );
<a name="l00208"></a>00208       curr = curr-&gt;<a class="code" href="structCREATURE__DIRECTIVE.html#bfbb4d4ab657f447f405bd987d8f719e">next</a>;
<a name="l00209"></a>00209       curr-&gt;<a class="code" href="structCREATURE__DIRECTIVE.html#bfbb4d4ab657f447f405bd987d8f719e">next</a> = <a class="code" href="Creature_01Spreading_8cpp.html#8e7ff57cc9d6c0be2023e242d3053509">NewDirective</a>( <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c660264374355821705df24bff50e8d681dce273">SEC_H9</a>, 2, <a class="code" href="Creature_01Spreading_8cpp.html#188c132f478fb544e0213ea0020585bc8cb8d444f6fa92714c918fd7a1e8a00d">INNER_MINE</a> );
<a name="l00210"></a>00210       curr = curr-&gt;<a class="code" href="structCREATURE__DIRECTIVE.html#bfbb4d4ab657f447f405bd987d8f719e">next</a>;
<a name="l00211"></a>00211       curr-&gt;<a class="code" href="structCREATURE__DIRECTIVE.html#bfbb4d4ab657f447f405bd987d8f719e">next</a> = <a class="code" href="Creature_01Spreading_8cpp.html#8e7ff57cc9d6c0be2023e242d3053509">NewDirective</a>( <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c660264374355821705df24bff50e8d681dce273">SEC_H9</a>, 1, <a class="code" href="Creature_01Spreading_8cpp.html#188c132f478fb544e0213ea0020585bc0252708b8e3dd2a2b5feb404649f1a59">OUTER_MINE</a> );
<a name="l00212"></a>00212       curr = curr-&gt;<a class="code" href="structCREATURE__DIRECTIVE.html#bfbb4d4ab657f447f405bd987d8f719e">next</a>;
<a name="l00213"></a>00213       curr-&gt;<a class="code" href="structCREATURE__DIRECTIVE.html#bfbb4d4ab657f447f405bd987d8f719e">next</a> = <a class="code" href="Creature_01Spreading_8cpp.html#8e7ff57cc9d6c0be2023e242d3053509">NewDirective</a>( <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643897f1cfaae4b38d8022feec3521887df">SEC_H8</a>, 1, <a class="code" href="Creature_01Spreading_8cpp.html#188c132f478fb544e0213ea0020585bc0a79da9c3e34dedd3f6ff49262678e07">MINE_EXIT</a> );
<a name="l00214"></a>00214 }
<a name="l00215"></a>00215 
<a name="l00216"></a><a class="code" href="Creature_01Spreading_8cpp.html#c2220030c8c85b6694b3fb02a408bdce">00216</a> <span class="keywordtype">void</span> <a class="code" href="Creature_01Spreading_8cpp.html#c2220030c8c85b6694b3fb02a408bdce">InitLairAlma</a>()
<a name="l00217"></a>00217 {
<a name="l00218"></a>00218       <a class="code" href="structCREATURE__DIRECTIVE.html">CREATURE_DIRECTIVE</a> *curr;
<a name="l00219"></a>00219       <a class="code" href="Creature_01Spreading_8cpp.html#b9d0d6cd30a304c1dba1c41a5312c190">giLairID</a> = 3;
<a name="l00220"></a>00220       <span class="comment">//initialize the linked list of lairs</span>
<a name="l00221"></a>00221       <a class="code" href="Creature_01Spreading_8cpp.html#f6419c60c42874dbb013443c02534a6a">lair</a> = <a class="code" href="Creature_01Spreading_8cpp.html#8e7ff57cc9d6c0be2023e242d3053509">NewDirective</a>( <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c66026439fc6a5d69c60d8780a4d3a095d59db1f">SEC_K13</a>, 3, <a class="code" href="Creature_01Spreading_8cpp.html#188c132f478fb544e0213ea0020585bcc593579d35b0f087c8b9a39b34ad705d">QUEEN_LAIR</a> );
<a name="l00222"></a>00222       curr = <a class="code" href="Creature_01Spreading_8cpp.html#f6419c60c42874dbb013443c02534a6a">lair</a>;
<a name="l00223"></a>00223       <span class="keywordflow">if</span>( !curr-&gt;<a class="code" href="structCREATURE__DIRECTIVE.html#bff6a87fbf7df1c95b8f9f2e0f74f09d">pLevel</a>-&gt;<a class="code" href="structUNDERGROUND__SECTORINFO.html#1cf13c2feb769c29017a524d58ebe8c4">ubNumCreatures</a> )
<a name="l00224"></a>00224       {
<a name="l00225"></a>00225             curr-&gt;<a class="code" href="structCREATURE__DIRECTIVE.html#bff6a87fbf7df1c95b8f9f2e0f74f09d">pLevel</a>-&gt;<a class="code" href="structUNDERGROUND__SECTORINFO.html#1cf13c2feb769c29017a524d58ebe8c4">ubNumCreatures</a> = 1;   <span class="comment">//for the queen.</span>
<a name="l00226"></a>00226       }
<a name="l00227"></a>00227       curr-&gt;<a class="code" href="structCREATURE__DIRECTIVE.html#bfbb4d4ab657f447f405bd987d8f719e">next</a> = <a class="code" href="Creature_01Spreading_8cpp.html#8e7ff57cc9d6c0be2023e242d3053509">NewDirective</a>( <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643521c52619249a7f28f637882cbffba2f">SEC_J13</a>, 3, <a class="code" href="Creature_01Spreading_8cpp.html#188c132f478fb544e0213ea0020585bc2ac8ec47e8b8e49969e0cf9c580654cf">LAIR</a> );
<a name="l00228"></a>00228       curr = curr-&gt;<a class="code" href="structCREATURE__DIRECTIVE.html#bfbb4d4ab657f447f405bd987d8f719e">next</a>;
<a name="l00229"></a>00229       curr-&gt;<a class="code" href="structCREATURE__DIRECTIVE.html#bfbb4d4ab657f447f405bd987d8f719e">next</a> = <a class="code" href="Creature_01Spreading_8cpp.html#8e7ff57cc9d6c0be2023e242d3053509">NewDirective</a>( <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643521c52619249a7f28f637882cbffba2f">SEC_J13</a>, 2, <a class="code" href="Creature_01Spreading_8cpp.html#188c132f478fb544e0213ea0020585bc2ac5fa94536136286b813ffa4a2aec1e">LAIR_ENTRANCE</a> );
<a name="l00230"></a>00230       curr = curr-&gt;<a class="code" href="structCREATURE__DIRECTIVE.html#bfbb4d4ab657f447f405bd987d8f719e">next</a>;
<a name="l00231"></a>00231       curr-&gt;<a class="code" href="structCREATURE__DIRECTIVE.html#bfbb4d4ab657f447f405bd987d8f719e">next</a> = <a class="code" href="Creature_01Spreading_8cpp.html#8e7ff57cc9d6c0be2023e242d3053509">NewDirective</a>( <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643a05c7598f53eec8740a10141c850d547">SEC_J14</a>, 2, <a class="code" href="Creature_01Spreading_8cpp.html#188c132f478fb544e0213ea0020585bc8cb8d444f6fa92714c918fd7a1e8a00d">INNER_MINE</a> );
<a name="l00232"></a>00232       curr = curr-&gt;<a class="code" href="structCREATURE__DIRECTIVE.html#bfbb4d4ab657f447f405bd987d8f719e">next</a>;
<a name="l00233"></a>00233       curr-&gt;<a class="code" href="structCREATURE__DIRECTIVE.html#bfbb4d4ab657f447f405bd987d8f719e">next</a> = <a class="code" href="Creature_01Spreading_8cpp.html#8e7ff57cc9d6c0be2023e242d3053509">NewDirective</a>( <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643a05c7598f53eec8740a10141c850d547">SEC_J14</a>, 1, <a class="code" href="Creature_01Spreading_8cpp.html#188c132f478fb544e0213ea0020585bc0252708b8e3dd2a2b5feb404649f1a59">OUTER_MINE</a> );
<a name="l00234"></a>00234       curr = curr-&gt;<a class="code" href="structCREATURE__DIRECTIVE.html#bfbb4d4ab657f447f405bd987d8f719e">next</a>;
<a name="l00235"></a>00235       curr-&gt;<a class="code" href="structCREATURE__DIRECTIVE.html#bfbb4d4ab657f447f405bd987d8f719e">next</a> = <a class="code" href="Creature_01Spreading_8cpp.html#8e7ff57cc9d6c0be2023e242d3053509">NewDirective</a>( <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643c236a562a9b38d2ee3c7d7ed06e88faf">SEC_I14</a>, 1, <a class="code" href="Creature_01Spreading_8cpp.html#188c132f478fb544e0213ea0020585bc0a79da9c3e34dedd3f6ff49262678e07">MINE_EXIT</a> );
<a name="l00236"></a>00236 }
<a name="l00237"></a>00237 
<a name="l00238"></a><a class="code" href="Creature_01Spreading_8cpp.html#dd1f0206b2213ecb031039488bea0a79">00238</a> <span class="keywordtype">void</span> <a class="code" href="Creature_01Spreading_8cpp.html#dd1f0206b2213ecb031039488bea0a79">InitLairGrumm</a>()
<a name="l00239"></a>00239 {
<a name="l00240"></a>00240       <a class="code" href="structCREATURE__DIRECTIVE.html">CREATURE_DIRECTIVE</a> *curr;
<a name="l00241"></a>00241       <a class="code" href="Creature_01Spreading_8cpp.html#b9d0d6cd30a304c1dba1c41a5312c190">giLairID</a> = 4;
<a name="l00242"></a>00242       <span class="comment">//initialize the linked list of lairs</span>
<a name="l00243"></a>00243       <a class="code" href="Creature_01Spreading_8cpp.html#f6419c60c42874dbb013443c02534a6a">lair</a> = <a class="code" href="Creature_01Spreading_8cpp.html#8e7ff57cc9d6c0be2023e242d3053509">NewDirective</a>( <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643c574685ddadb46cde3f6bc8bf340ab6f">SEC_G4</a>, 3, <a class="code" href="Creature_01Spreading_8cpp.html#188c132f478fb544e0213ea0020585bcc593579d35b0f087c8b9a39b34ad705d">QUEEN_LAIR</a> );
<a name="l00244"></a>00244       curr = <a class="code" href="Creature_01Spreading_8cpp.html#f6419c60c42874dbb013443c02534a6a">lair</a>;
<a name="l00245"></a>00245       <span class="keywordflow">if</span>( !curr-&gt;<a class="code" href="structCREATURE__DIRECTIVE.html#bff6a87fbf7df1c95b8f9f2e0f74f09d">pLevel</a>-&gt;<a class="code" href="structUNDERGROUND__SECTORINFO.html#1cf13c2feb769c29017a524d58ebe8c4">ubNumCreatures</a> )
<a name="l00246"></a>00246       {
<a name="l00247"></a>00247             curr-&gt;<a class="code" href="structCREATURE__DIRECTIVE.html#bff6a87fbf7df1c95b8f9f2e0f74f09d">pLevel</a>-&gt;<a class="code" href="structUNDERGROUND__SECTORINFO.html#1cf13c2feb769c29017a524d58ebe8c4">ubNumCreatures</a> = 1;   <span class="comment">//for the queen.</span>
<a name="l00248"></a>00248       }
<a name="l00249"></a>00249       curr-&gt;<a class="code" href="structCREATURE__DIRECTIVE.html#bfbb4d4ab657f447f405bd987d8f719e">next</a> = <a class="code" href="Creature_01Spreading_8cpp.html#8e7ff57cc9d6c0be2023e242d3053509">NewDirective</a>( <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643ba99b9a0f226090c79368e6b45295d2d">SEC_H4</a>, 3, <a class="code" href="Creature_01Spreading_8cpp.html#188c132f478fb544e0213ea0020585bc2ac8ec47e8b8e49969e0cf9c580654cf">LAIR</a> );
<a name="l00250"></a>00250       curr = curr-&gt;<a class="code" href="structCREATURE__DIRECTIVE.html#bfbb4d4ab657f447f405bd987d8f719e">next</a>;
<a name="l00251"></a>00251       curr-&gt;<a class="code" href="structCREATURE__DIRECTIVE.html#bfbb4d4ab657f447f405bd987d8f719e">next</a> = <a class="code" href="Creature_01Spreading_8cpp.html#8e7ff57cc9d6c0be2023e242d3053509">NewDirective</a>( <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643ba99b9a0f226090c79368e6b45295d2d">SEC_H4</a>, 2, <a class="code" href="Creature_01Spreading_8cpp.html#188c132f478fb544e0213ea0020585bc2ac5fa94536136286b813ffa4a2aec1e">LAIR_ENTRANCE</a> );
<a name="l00252"></a>00252       curr = curr-&gt;<a class="code" href="structCREATURE__DIRECTIVE.html#bfbb4d4ab657f447f405bd987d8f719e">next</a>;
<a name="l00253"></a>00253       curr-&gt;<a class="code" href="structCREATURE__DIRECTIVE.html#bfbb4d4ab657f447f405bd987d8f719e">next</a> = <a class="code" href="Creature_01Spreading_8cpp.html#8e7ff57cc9d6c0be2023e242d3053509">NewDirective</a>( <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643c6ced202c824aa65d9d2f53922400fa1">SEC_H3</a>, 2, <a class="code" href="Creature_01Spreading_8cpp.html#188c132f478fb544e0213ea0020585bc8cb8d444f6fa92714c918fd7a1e8a00d">INNER_MINE</a> );
<a name="l00254"></a>00254       curr = curr-&gt;<a class="code" href="structCREATURE__DIRECTIVE.html#bfbb4d4ab657f447f405bd987d8f719e">next</a>;
<a name="l00255"></a>00255       curr-&gt;<a class="code" href="structCREATURE__DIRECTIVE.html#bfbb4d4ab657f447f405bd987d8f719e">next</a> = <a class="code" href="Creature_01Spreading_8cpp.html#8e7ff57cc9d6c0be2023e242d3053509">NewDirective</a>( <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c66026433c69f8fd7a337039e5b24166ee8ac210">SEC_I3</a>, 2, <a class="code" href="Creature_01Spreading_8cpp.html#188c132f478fb544e0213ea0020585bc8cb8d444f6fa92714c918fd7a1e8a00d">INNER_MINE</a> );
<a name="l00256"></a>00256       curr = curr-&gt;<a class="code" href="structCREATURE__DIRECTIVE.html#bfbb4d4ab657f447f405bd987d8f719e">next</a>;
<a name="l00257"></a>00257       curr-&gt;<a class="code" href="structCREATURE__DIRECTIVE.html#bfbb4d4ab657f447f405bd987d8f719e">next</a> = <a class="code" href="Creature_01Spreading_8cpp.html#8e7ff57cc9d6c0be2023e242d3053509">NewDirective</a>( <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c66026433c69f8fd7a337039e5b24166ee8ac210">SEC_I3</a>, 1, <a class="code" href="Creature_01Spreading_8cpp.html#188c132f478fb544e0213ea0020585bc0252708b8e3dd2a2b5feb404649f1a59">OUTER_MINE</a> );
<a name="l00258"></a>00258       curr = curr-&gt;<a class="code" href="structCREATURE__DIRECTIVE.html#bfbb4d4ab657f447f405bd987d8f719e">next</a>;
<a name="l00259"></a>00259       curr-&gt;<a class="code" href="structCREATURE__DIRECTIVE.html#bfbb4d4ab657f447f405bd987d8f719e">next</a> = <a class="code" href="Creature_01Spreading_8cpp.html#8e7ff57cc9d6c0be2023e242d3053509">NewDirective</a>( <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643c6ced202c824aa65d9d2f53922400fa1">SEC_H3</a>, 1, <a class="code" href="Creature_01Spreading_8cpp.html#188c132f478fb544e0213ea0020585bc0a79da9c3e34dedd3f6ff49262678e07">MINE_EXIT</a> );
<a name="l00260"></a>00260 }
<a name="l00261"></a>00261 
<a name="l00262"></a>00262 <span class="preprocessor">#ifdef JA2BETAVERSION</span>
<a name="l00263"></a>00263 <span class="preprocessor"></span><span class="keyword">extern</span> <a class="code" href="Types_8h.html#112e3146cb38b6ee95e64d85842e380a">BOOLEAN</a> <a class="code" href="AI_01Viewer_8cpp.html#b5eaa0e4ce749a89a0f47a7cdd345ac9">gfExitViewer</a>;
<a name="l00264"></a>00264 <span class="preprocessor">#endif</span>
<a name="l00265"></a>00265 <span class="preprocessor"></span>
<a name="l00266"></a><a class="code" href="Creature_01Spreading_8h.html#0c30b630488ea8d1b9215fac8c688bda">00266</a> <span class="keywordtype">void</span> <a class="code" href="Creature_01Spreading_8cpp.html#0c30b630488ea8d1b9215fac8c688bda">InitCreatureQuest</a>()
<a name="l00267"></a>00267 {
<a name="l00268"></a>00268       <a class="code" href="structUNDERGROUND__SECTORINFO.html">UNDERGROUND_SECTORINFO</a> *curr;
<a name="l00269"></a>00269       <a class="code" href="Types_8h.html#112e3146cb38b6ee95e64d85842e380a">BOOLEAN</a> fPlayMeanwhile = FALSE;
<a name="l00270"></a>00270       <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a> i=-1;
<a name="l00271"></a>00271       <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a> iChosenMine;
<a name="l00272"></a>00272       <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a> iRandom;
<a name="l00273"></a>00273       <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a> iNumMinesInfectible;
<a name="l00274"></a>00274 <span class="preprocessor">      #ifdef JA2BETAVERSION</span>
<a name="l00275"></a>00275 <span class="preprocessor"></span>            <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a> iOrigRandom;
<a name="l00276"></a>00276 <span class="preprocessor">      #endif</span>
<a name="l00277"></a>00277 <span class="preprocessor"></span>      <a class="code" href="Types_8h.html#112e3146cb38b6ee95e64d85842e380a">BOOLEAN</a> fMineInfectible[4];
<a name="l00278"></a>00278 
<a name="l00279"></a>00279       <span class="keywordflow">if</span>( <a class="code" href="Creature_01Spreading_8cpp.html#b9d0d6cd30a304c1dba1c41a5312c190">giLairID</a> )
<a name="l00280"></a>00280       {
<a name="l00281"></a>00281             <span class="keywordflow">return</span>; <span class="comment">//already active!</span>
<a name="l00282"></a>00282       }
<a name="l00283"></a>00283 
<a name="l00284"></a>00284 <span class="preprocessor">      #ifdef JA2BETAVERSION</span>
<a name="l00285"></a>00285 <span class="preprocessor"></span>      <span class="keywordflow">if</span>( <a class="code" href="gameloop_8cpp.html#8cd832c7f0ec6ab02ba9fddd4a2257aa">guiCurrentScreen</a> != <a class="code" href="screenids_8h.html#a4ee5dea8709d2b490486a62df77faf2eddea7bb8551411e5bfb6f052177bc01">AIVIEWER_SCREEN</a> )
<a name="l00286"></a>00286       { 
<a name="l00287"></a>00287             fPlayMeanwhile = TRUE;
<a name="l00288"></a>00288       }
<a name="l00289"></a>00289 <span class="preprocessor">      #else</span>
<a name="l00290"></a>00290 <span class="preprocessor"></span>            fPlayMeanwhile = TRUE;
<a name="l00291"></a>00291 <span class="preprocessor">      #endif</span>
<a name="l00292"></a>00292 <span class="preprocessor"></span>
<a name="l00293"></a>00293       <span class="keywordflow">if</span>( fPlayMeanwhile &amp;&amp; !<a class="code" href="SaveLoadGame_8cpp.html#6846a6c6febabdd94edaa35217aabfc8">gfCreatureMeanwhileScenePlayed</a> )
<a name="l00294"></a>00294       {
<a name="l00295"></a>00295             <span class="comment">//Start the meanwhile scene for the queen ordering the release of the creatures.</span>
<a name="l00296"></a>00296             <a class="code" href="Meanwhile_8cpp.html#6421bb08583e8264f79e5cba2a2d545d">HandleCreatureRelease</a>();
<a name="l00297"></a>00297             <a class="code" href="SaveLoadGame_8cpp.html#6846a6c6febabdd94edaa35217aabfc8">gfCreatureMeanwhileScenePlayed</a> = TRUE;
<a name="l00298"></a>00298       }
<a name="l00299"></a>00299 
<a name="l00300"></a>00300       <a class="code" href="Creature_01Spreading_8cpp.html#6c1ae8dabd332f455970b1cfc21bbedd">giHabitatedDistance</a> = 0;      
<a name="l00301"></a>00301       <span class="keywordflow">switch</span>( <a class="code" href="GameSettings_8cpp.html#f9f2d5fd368ccadcc26bebc202d52ae7">gGameOptions</a>.<a class="code" href="structGAME__OPTIONS.html#4fb44167906152722f6af5cc9f7c1a99">ubDifficultyLevel</a> )
<a name="l00302"></a>00302       {
<a name="l00303"></a>00303             <span class="keywordflow">case</span> <a class="code" href="GameSettings_8h.html#c205be2172292384dd687b5471a87eddbd3b0d23f4dc30ef17b50a14c3f54589">DIF_LEVEL_EASY</a>:
<a name="l00304"></a>00304                   <a class="code" href="Creature_01Spreading_8cpp.html#2ca411c8ef1417eeda35cc309a4f2220">giPopulationModifier</a> = EASY_POPULATION_MODIFIER;
<a name="l00305"></a>00305                   <span class="keywordflow">break</span>;
<a name="l00306"></a>00306             <span class="keywordflow">case</span> <a class="code" href="GameSettings_8h.html#c205be2172292384dd687b5471a87edddd0259b09fef163c6aa62268574191cb">DIF_LEVEL_MEDIUM</a>:
<a name="l00307"></a>00307                   <a class="code" href="Creature_01Spreading_8cpp.html#2ca411c8ef1417eeda35cc309a4f2220">giPopulationModifier</a> = NORMAL_POPULATION_MODIFIER;
<a name="l00308"></a>00308                   <span class="keywordflow">break</span>;
<a name="l00309"></a>00309             <span class="keywordflow">case</span> <a class="code" href="GameSettings_8h.html#c205be2172292384dd687b5471a87edd3d0b73026f1c7122798d578613aa4575">DIF_LEVEL_HARD</a>:
<a name="l00310"></a>00310                   <a class="code" href="Creature_01Spreading_8cpp.html#2ca411c8ef1417eeda35cc309a4f2220">giPopulationModifier</a> = HARD_POPULATION_MODIFIER;
<a name="l00311"></a>00311                   <span class="keywordflow">break</span>;
<a name="l00312"></a>00312             <span class="keywordflow">case</span> <a class="code" href="GameSettings_8h.html#c205be2172292384dd687b5471a87eddc657c89fd754a6f20b3869250288a702">DIF_LEVEL_INSANE</a>:
<a name="l00313"></a>00313                   <a class="code" href="Creature_01Spreading_8cpp.html#2ca411c8ef1417eeda35cc309a4f2220">giPopulationModifier</a> = INSANE_POPULATION_MODIFIER;
<a name="l00314"></a>00314                   <span class="keywordflow">break</span>;
<a name="l00315"></a>00315       }
<a name="l00316"></a>00316 
<a name="l00317"></a>00317       <span class="comment">//Determine which of the four maps are infectible by creatures.  Infectible mines</span>
<a name="l00318"></a>00318       <span class="comment">//are those that are player controlled and unlimited.  We don't want the creatures to</span>
<a name="l00319"></a>00319       <span class="comment">//infect the mine that runs out.</span>
<a name="l00320"></a>00320 
<a name="l00321"></a>00321       <span class="comment">//Default them all to infectible</span>
<a name="l00322"></a>00322       memset( fMineInfectible, 1, <span class="keyword">sizeof</span>( <a class="code" href="Types_8h.html#112e3146cb38b6ee95e64d85842e380a">BOOLEAN</a> ) * 4 );
<a name="l00323"></a>00323 
<a name="l00324"></a>00324       <span class="keywordflow">if</span>( <a class="code" href="Creature_01Spreading_8cpp.html#9380f2e39f34095d76ba1abab44dab29">gMineStatus</a>[ <a class="code" href="Strategic_01AI_8h.html#a9908284c0827729f14cf9b2489e14799a73db68e32a680bed112c2b9f556bc4">DRASSEN_MINE</a> ].fAttackedHeadMiner || 
<a name="l00325"></a>00325                   <a class="code" href="Creature_01Spreading_8cpp.html#9380f2e39f34095d76ba1abab44dab29">gMineStatus</a>[ <a class="code" href="Strategic_01AI_8h.html#a9908284c0827729f14cf9b2489e14799a73db68e32a680bed112c2b9f556bc4">DRASSEN_MINE</a> ].uiOreRunningOutPoint ||
<a name="l00326"></a>00326                   <a class="code" href="strategic_8cpp.html#6f48fb0ea28e3d4889423290f1a6ede8">StrategicMap</a>[ SECTOR_INFO_TO_STRATEGIC_INDEX( <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c66026435b0fbd8598540769dcf8f24e3134f48c">SEC_D13</a> ) ].fEnemyControlled )
<a name="l00327"></a>00327       { <span class="comment">//If head miner was attacked, ore will/has run out, or enemy controlled</span>
<a name="l00328"></a>00328             fMineInfectible[ 0 ] = FALSE;
<a name="l00329"></a>00329       }
<a name="l00330"></a>00330       <span class="keywordflow">if</span>( <a class="code" href="Creature_01Spreading_8cpp.html#9380f2e39f34095d76ba1abab44dab29">gMineStatus</a>[ <a class="code" href="Strategic_01AI_8h.html#a9908284c0827729f14cf9b2489e1479ca3d6330b3689d84e632e764cd954482">CAMBRIA_MINE</a> ].fAttackedHeadMiner || 
<a name="l00331"></a>00331                   <a class="code" href="Creature_01Spreading_8cpp.html#9380f2e39f34095d76ba1abab44dab29">gMineStatus</a>[ <a class="code" href="Strategic_01AI_8h.html#a9908284c0827729f14cf9b2489e1479ca3d6330b3689d84e632e764cd954482">CAMBRIA_MINE</a> ].uiOreRunningOutPoint ||
<a name="l00332"></a>00332                   <a class="code" href="strategic_8cpp.html#6f48fb0ea28e3d4889423290f1a6ede8">StrategicMap</a>[ SECTOR_INFO_TO_STRATEGIC_INDEX( <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643897f1cfaae4b38d8022feec3521887df">SEC_H8</a> ) ].fEnemyControlled )
<a name="l00333"></a>00333       { <span class="comment">//If head miner was attacked, ore will/has run out, or enemy controlled</span>
<a name="l00334"></a>00334             fMineInfectible[ 1 ] = FALSE;
<a name="l00335"></a>00335       }
<a name="l00336"></a>00336       <span class="keywordflow">if</span>( <a class="code" href="Creature_01Spreading_8cpp.html#9380f2e39f34095d76ba1abab44dab29">gMineStatus</a>[ <a class="code" href="Strategic_01AI_8h.html#a9908284c0827729f14cf9b2489e1479b2e38a672cdd443d231dd0144a447675">ALMA_MINE</a> ].fAttackedHeadMiner || 
<a name="l00337"></a>00337                   <a class="code" href="Creature_01Spreading_8cpp.html#9380f2e39f34095d76ba1abab44dab29">gMineStatus</a>[ <a class="code" href="Strategic_01AI_8h.html#a9908284c0827729f14cf9b2489e1479b2e38a672cdd443d231dd0144a447675">ALMA_MINE</a> ].uiOreRunningOutPoint ||
<a name="l00338"></a>00338                   <a class="code" href="strategic_8cpp.html#6f48fb0ea28e3d4889423290f1a6ede8">StrategicMap</a>[ SECTOR_INFO_TO_STRATEGIC_INDEX( <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643c236a562a9b38d2ee3c7d7ed06e88faf">SEC_I14</a> ) ].fEnemyControlled )
<a name="l00339"></a>00339       { <span class="comment">//If head miner was attacked, ore will/has run out, or enemy controlled</span>
<a name="l00340"></a>00340             fMineInfectible[ 2 ] = FALSE;
<a name="l00341"></a>00341       }
<a name="l00342"></a>00342       <span class="keywordflow">if</span>( <a class="code" href="Creature_01Spreading_8cpp.html#9380f2e39f34095d76ba1abab44dab29">gMineStatus</a>[ <a class="code" href="Strategic_01AI_8h.html#a9908284c0827729f14cf9b2489e1479b67ceeaf4ebbe68cb3f9fad537704930">GRUMM_MINE</a> ].fAttackedHeadMiner || 
<a name="l00343"></a>00343                   <a class="code" href="Creature_01Spreading_8cpp.html#9380f2e39f34095d76ba1abab44dab29">gMineStatus</a>[ <a class="code" href="Strategic_01AI_8h.html#a9908284c0827729f14cf9b2489e1479b67ceeaf4ebbe68cb3f9fad537704930">GRUMM_MINE</a> ].uiOreRunningOutPoint ||
<a name="l00344"></a>00344                   <a class="code" href="strategic_8cpp.html#6f48fb0ea28e3d4889423290f1a6ede8">StrategicMap</a>[ SECTOR_INFO_TO_STRATEGIC_INDEX( <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643c6ced202c824aa65d9d2f53922400fa1">SEC_H3</a> ) ].fEnemyControlled )
<a name="l00345"></a>00345       { <span class="comment">//If head miner was attacked, ore will/has run out, or enemy controlled</span>
<a name="l00346"></a>00346             fMineInfectible[ 3 ] = FALSE;
<a name="l00347"></a>00347       }
<a name="l00348"></a>00348 
<a name="l00349"></a>00349 <span class="preprocessor">      #ifdef JA2BETAVERSION</span>
<a name="l00350"></a>00350 <span class="preprocessor"></span>      <span class="keywordflow">if</span>( <a class="code" href="gameloop_8cpp.html#8cd832c7f0ec6ab02ba9fddd4a2257aa">guiCurrentScreen</a> == <a class="code" href="screenids_8h.html#a4ee5dea8709d2b490486a62df77faf2eddea7bb8551411e5bfb6f052177bc01">AIVIEWER_SCREEN</a> )
<a name="l00351"></a>00351       { <span class="comment">//If in the AIViewer, allow any mine to get infected</span>
<a name="l00352"></a>00352             memset( fMineInfectible, 1, <span class="keyword">sizeof</span>( BOOLEAN ) * 4 );
<a name="l00353"></a>00353       }
<a name="l00354"></a>00354 <span class="preprocessor">      #endif</span>
<a name="l00355"></a>00355 <span class="preprocessor"></span>
<a name="l00356"></a>00356       iNumMinesInfectible = fMineInfectible[0] + fMineInfectible[1] + fMineInfectible[2] + fMineInfectible[3];
<a name="l00357"></a>00357 
<a name="l00358"></a>00358       <span class="keywordflow">if</span>( !iNumMinesInfectible )
<a name="l00359"></a>00359       {
<a name="l00360"></a>00360             <span class="keywordflow">return</span>;
<a name="l00361"></a>00361       }
<a name="l00362"></a>00362 
<a name="l00363"></a>00363       <span class="comment">//Choose one of the infectible mines randomly</span>
<a name="l00364"></a>00364       iRandom = <a class="code" href="Random_8cpp.html#49f938d1313ab6ef09ac6223a16ac334">Random</a>( iNumMinesInfectible ) + 1;
<a name="l00365"></a>00365 
<a name="l00366"></a>00366 <span class="preprocessor">      #ifdef JA2BETAVERSION</span>
<a name="l00367"></a>00367 <span class="preprocessor"></span>            iOrigRandom = iRandom;
<a name="l00368"></a>00368 <span class="preprocessor">      #endif</span>
<a name="l00369"></a>00369 <span class="preprocessor"></span>
<a name="l00370"></a>00370       iChosenMine = 0;
<a name="l00371"></a>00371 
<a name="l00372"></a>00372       <span class="keywordflow">for</span>( i = 0; i &lt; 4; i++ )
<a name="l00373"></a>00373       {
<a name="l00374"></a>00374             <span class="keywordflow">if</span>( iRandom )
<a name="l00375"></a>00375             {
<a name="l00376"></a>00376                   iChosenMine++;
<a name="l00377"></a>00377                   <span class="keywordflow">if</span>( fMineInfectible[i] )
<a name="l00378"></a>00378                   {
<a name="l00379"></a>00379                         iRandom--;
<a name="l00380"></a>00380                   }
<a name="l00381"></a>00381             }
<a name="l00382"></a>00382       }
<a name="l00383"></a>00383 
<a name="l00384"></a>00384       <span class="comment">//Now, choose a start location for the queen.</span>
<a name="l00385"></a>00385       <span class="keywordflow">switch</span>( iChosenMine )
<a name="l00386"></a>00386       {
<a name="l00387"></a>00387             <span class="keywordflow">case</span> 1: <span class="comment">//Drassen</span>
<a name="l00388"></a>00388                   <a class="code" href="Creature_01Spreading_8cpp.html#77d1e0856783e7827edcbdbe35044727">InitLairDrassen</a>();
<a name="l00389"></a>00389                   curr = <a class="code" href="Creature_01Spreading_8cpp.html#8416712124d291c97f383014e261bb16">FindUnderGroundSector</a>( 13, 5, 1 );
<a name="l00390"></a>00390                   curr-&gt;<a class="code" href="structUNDERGROUND__SECTORINFO.html#e241a74243d5d203cf2c807fc597c5b5">uiFlags</a> |= SF_PENDING_ALTERNATE_MAP; 
<a name="l00391"></a>00391                   <span class="keywordflow">break</span>;
<a name="l00392"></a>00392             <span class="keywordflow">case</span> 2: <span class="comment">//Cambria</span>
<a name="l00393"></a>00393                   <a class="code" href="Creature_01Spreading_8cpp.html#5572c91bcdaccde46e41a22a19d4b3e9">InitLairCambria</a>();
<a name="l00394"></a>00394                   curr = <a class="code" href="Creature_01Spreading_8cpp.html#8416712124d291c97f383014e261bb16">FindUnderGroundSector</a>( 9, 8, 1 );
<a name="l00395"></a>00395                   curr-&gt;<a class="code" href="structUNDERGROUND__SECTORINFO.html#e241a74243d5d203cf2c807fc597c5b5">uiFlags</a> |= SF_PENDING_ALTERNATE_MAP; <span class="comment">//entrance</span>
<a name="l00396"></a>00396                   <span class="keywordflow">break</span>;
<a name="l00397"></a>00397             <span class="keywordflow">case</span> 3: <span class="comment">//Alma's mine</span>
<a name="l00398"></a>00398                   <a class="code" href="Creature_01Spreading_8cpp.html#c2220030c8c85b6694b3fb02a408bdce">InitLairAlma</a>();
<a name="l00399"></a>00399                   curr = <a class="code" href="Creature_01Spreading_8cpp.html#8416712124d291c97f383014e261bb16">FindUnderGroundSector</a>( 14, 10, 1 );
<a name="l00400"></a>00400                   curr-&gt;<a class="code" href="structUNDERGROUND__SECTORINFO.html#e241a74243d5d203cf2c807fc597c5b5">uiFlags</a> |= SF_PENDING_ALTERNATE_MAP;
<a name="l00401"></a>00401                   <span class="keywordflow">break</span>;
<a name="l00402"></a>00402             <span class="keywordflow">case</span> 4: <span class="comment">//Grumm's mine</span>
<a name="l00403"></a>00403                   <a class="code" href="Creature_01Spreading_8cpp.html#dd1f0206b2213ecb031039488bea0a79">InitLairGrumm</a>();
<a name="l00404"></a>00404                   curr = <a class="code" href="Creature_01Spreading_8cpp.html#8416712124d291c97f383014e261bb16">FindUnderGroundSector</a>( 4, 8, 2 );
<a name="l00405"></a>00405                   curr-&gt;<a class="code" href="structUNDERGROUND__SECTORINFO.html#e241a74243d5d203cf2c807fc597c5b5">uiFlags</a> |= SF_PENDING_ALTERNATE_MAP;
<a name="l00406"></a>00406                   <span class="keywordflow">break</span>;
<a name="l00407"></a>00407             <span class="keywordflow">default</span>:
<a name="l00408"></a>00408 <span class="preprocessor">                  #ifdef JA2BETAVERSION</span>
<a name="l00409"></a>00409 <span class="preprocessor"></span>                  {
<a name="l00410"></a>00410                         <a class="code" href="Types_8h.html#09f1a1fb2293e33483cc8d44aefb1eb1">UINT16</a> <a class="code" href="Button_01System_8cpp.html#ac22642f3052cc77a6991a262ce4ad23">str</a>[512];
<a name="l00411"></a>00411                         swprintf( str, L<span class="stringliteral">"Creature quest never chose a lair and won't infect any mines.  Infectible mines = %d, iRandom = %d.  "</span>
<a name="l00412"></a>00412                                                                    L<span class="stringliteral">"This isn't a bug if you are not receiving income from any mines."</span>, iNumMinesInfectible, iOrigRandom );
<a name="l00413"></a>00413                         <a class="code" href="MessageBoxScreen_8cpp.html#f480404e936544ddb29a371b785dc2f3">DoScreenIndependantMessageBox</a>( str, MSG_BOX_FLAG_OK, NULL );
<a name="l00414"></a>00414                   }
<a name="l00415"></a>00415 <span class="preprocessor">                  #endif</span>
<a name="l00416"></a>00416 <span class="preprocessor"></span>                  <span class="keywordflow">return</span>;     
<a name="l00417"></a>00417       }
<a name="l00418"></a>00418 
<a name="l00419"></a>00419       <span class="comment">//Now determine how often we will spread the creatures.</span>
<a name="l00420"></a>00420       <span class="keywordflow">switch</span>( <a class="code" href="GameSettings_8cpp.html#f9f2d5fd368ccadcc26bebc202d52ae7">gGameOptions</a>.<a class="code" href="structGAME__OPTIONS.html#4fb44167906152722f6af5cc9f7c1a99">ubDifficultyLevel</a> )
<a name="l00421"></a>00421       {
<a name="l00422"></a>00422             <span class="keywordflow">case</span> <a class="code" href="GameSettings_8h.html#c205be2172292384dd687b5471a87eddbd3b0d23f4dc30ef17b50a14c3f54589">DIF_LEVEL_EASY</a>:
<a name="l00423"></a>00423                   i = EASY_QUEEN_INIT_BONUS_SPREADS;
<a name="l00424"></a>00424                   <a class="code" href="Game_01Event_01Hook_8h.html#d70aba281d84c1b460b60146dddf3dfa">AddPeriodStrategicEvent</a>( <a class="code" href="Game_01Event_01Hook_8h.html#08f51f22ad2ed13a25181c2604573110a37239c97abb8729d18ef5576251bba8">EVENT_CREATURE_SPREAD</a>, EASY_SPREAD_TIME_IN_MINUTES, 0 );
<a name="l00425"></a>00425                   <span class="keywordflow">break</span>;
<a name="l00426"></a>00426             <span class="keywordflow">case</span> <a class="code" href="GameSettings_8h.html#c205be2172292384dd687b5471a87edddd0259b09fef163c6aa62268574191cb">DIF_LEVEL_MEDIUM</a>:
<a name="l00427"></a>00427                   i = NORMAL_QUEEN_INIT_BONUS_SPREADS;
<a name="l00428"></a>00428                   <a class="code" href="Game_01Event_01Hook_8h.html#d70aba281d84c1b460b60146dddf3dfa">AddPeriodStrategicEvent</a>( <a class="code" href="Game_01Event_01Hook_8h.html#08f51f22ad2ed13a25181c2604573110a37239c97abb8729d18ef5576251bba8">EVENT_CREATURE_SPREAD</a>, NORMAL_SPREAD_TIME_IN_MINUTES, 0 );
<a name="l00429"></a>00429                   <span class="keywordflow">break</span>;
<a name="l00430"></a>00430             <span class="keywordflow">case</span> <a class="code" href="GameSettings_8h.html#c205be2172292384dd687b5471a87edd3d0b73026f1c7122798d578613aa4575">DIF_LEVEL_HARD</a>:
<a name="l00431"></a>00431                   i = HARD_QUEEN_INIT_BONUS_SPREADS;
<a name="l00432"></a>00432                   <a class="code" href="Game_01Event_01Hook_8h.html#d70aba281d84c1b460b60146dddf3dfa">AddPeriodStrategicEvent</a>( <a class="code" href="Game_01Event_01Hook_8h.html#08f51f22ad2ed13a25181c2604573110a37239c97abb8729d18ef5576251bba8">EVENT_CREATURE_SPREAD</a>, HARD_SPREAD_TIME_IN_MINUTES, 0 );
<a name="l00433"></a>00433                   <span class="keywordflow">break</span>;
<a name="l00434"></a>00434             <span class="keywordflow">case</span> <a class="code" href="GameSettings_8h.html#c205be2172292384dd687b5471a87eddc657c89fd754a6f20b3869250288a702">DIF_LEVEL_INSANE</a>:
<a name="l00435"></a>00435                   i = INSANE_QUEEN_INIT_BONUS_SPREADS;
<a name="l00436"></a>00436                   <a class="code" href="Game_01Event_01Hook_8h.html#d70aba281d84c1b460b60146dddf3dfa">AddPeriodStrategicEvent</a>( <a class="code" href="Game_01Event_01Hook_8h.html#08f51f22ad2ed13a25181c2604573110a37239c97abb8729d18ef5576251bba8">EVENT_CREATURE_SPREAD</a>, INSANE_SPREAD_TIME_IN_MINUTES, 0 );
<a name="l00437"></a>00437                   <span class="keywordflow">break</span>;
<a name="l00438"></a>00438       }
<a name="l00439"></a>00439 
<a name="l00440"></a>00440       <span class="comment">//Set things up so that the creatures can plan attacks on helpless miners and civilians while</span>
<a name="l00441"></a>00441       <span class="comment">//they are sleeping.  They do their planning at 10PM every day, and decide to attack sometime</span>
<a name="l00442"></a>00442       <span class="comment">//during the night.</span>
<a name="l00443"></a>00443       <a class="code" href="Game_01Event_01Hook_8h.html#f60232ffb0902b711dd2fe102c2d37ca">AddEveryDayStrategicEvent</a>( <a class="code" href="Game_01Event_01Hook_8h.html#08f51f22ad2ed13a25181c26045731107ec444cb57af27773c3b1608b637381a">EVENT_CREATURE_NIGHT_PLANNING</a>, 1320, 0 );
<a name="l00444"></a>00444 
<a name="l00445"></a>00445       <span class="comment">//Got to give the queen some early protection, so do some creature spreading.</span>
<a name="l00446"></a>00446       <span class="keywordflow">while</span>( i-- )
<a name="l00447"></a>00447       { <span class="comment">//# times spread is based on difficulty, and the values in the defines.</span>
<a name="l00448"></a>00448             <a class="code" href="Creature_01Spreading_8cpp.html#b67932d756971817d98837a41575f26c">SpreadCreatures</a>();
<a name="l00449"></a>00449       }
<a name="l00450"></a>00450 }
<a name="l00451"></a>00451 
<a name="l00452"></a><a class="code" href="Creature_01Spreading_8cpp.html#641ab6139d4c01d03780a76613874c3c">00452</a> <span class="keywordtype">void</span> <a class="code" href="Creature_01Spreading_8cpp.html#641ab6139d4c01d03780a76613874c3c">AddCreatureToNode</a>( <a class="code" href="structCREATURE__DIRECTIVE.html">CREATURE_DIRECTIVE</a> *node )
<a name="l00453"></a>00453 {
<a name="l00454"></a>00454       node-&gt;<a class="code" href="structCREATURE__DIRECTIVE.html#bff6a87fbf7df1c95b8f9f2e0f74f09d">pLevel</a>-&gt;<a class="code" href="structUNDERGROUND__SECTORINFO.html#1cf13c2feb769c29017a524d58ebe8c4">ubNumCreatures</a>++;
<a name="l00455"></a>00455       
<a name="l00456"></a>00456       <span class="keywordflow">if</span>( node-&gt;<a class="code" href="structCREATURE__DIRECTIVE.html#bff6a87fbf7df1c95b8f9f2e0f74f09d">pLevel</a>-&gt;<a class="code" href="structUNDERGROUND__SECTORINFO.html#e241a74243d5d203cf2c807fc597c5b5">uiFlags</a> &amp; SF_PENDING_ALTERNATE_MAP )
<a name="l00457"></a>00457       { <span class="comment">//there is an alternate map meaning that there is a dynamic opening.  From now on</span>
<a name="l00458"></a>00458             <span class="comment">//we substitute this map.</span>
<a name="l00459"></a>00459             node-&gt;<a class="code" href="structCREATURE__DIRECTIVE.html#bff6a87fbf7df1c95b8f9f2e0f74f09d">pLevel</a>-&gt;<a class="code" href="structUNDERGROUND__SECTORINFO.html#e241a74243d5d203cf2c807fc597c5b5">uiFlags</a> &amp;= ~SF_PENDING_ALTERNATE_MAP;
<a name="l00460"></a>00460             node-&gt;<a class="code" href="structCREATURE__DIRECTIVE.html#bff6a87fbf7df1c95b8f9f2e0f74f09d">pLevel</a>-&gt;<a class="code" href="structUNDERGROUND__SECTORINFO.html#e241a74243d5d203cf2c807fc597c5b5">uiFlags</a> |= SF_USE_ALTERNATE_MAP;
<a name="l00461"></a>00461       }
<a name="l00462"></a>00462 }
<a name="l00463"></a>00463 
<a name="l00464"></a><a class="code" href="Creature_01Spreading_8cpp.html#57699bbe96cd2fa808c0075303c56251">00464</a> <a class="code" href="Types_8h.html#112e3146cb38b6ee95e64d85842e380a">BOOLEAN</a> <a class="code" href="Creature_01Spreading_8cpp.html#57699bbe96cd2fa808c0075303c56251">PlaceNewCreature</a>( <a class="code" href="structCREATURE__DIRECTIVE.html">CREATURE_DIRECTIVE</a> *node, <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a> iDistance )
<a name="l00465"></a>00465 {
<a name="l00466"></a>00466 DebugMsg (<a class="code" href="DEBUG_8cpp.html#a7985c2fd033797fc67a03b2c26e07c6">TOPIC_JA2</a>,DBG_LEVEL_3,<span class="stringliteral">"CreatureSpreading1"</span>);
<a name="l00467"></a>00467       <span class="keywordflow">if</span>( !node )
<a name="l00468"></a>00468             <span class="keywordflow">return</span> FALSE;
<a name="l00469"></a>00469       <span class="comment">//check to see if the creatures are permitted to spread into certain areas.  There are 4 mines (human perspective), and</span>
<a name="l00470"></a>00470       <span class="comment">//creatures won't spread to them until the player controls them.  Additionally, if the player has recently cleared the </span>
<a name="l00471"></a>00471       <span class="comment">//mine, then temporarily prevent the spreading of creatures.</span>
<a name="l00472"></a>00472 
<a name="l00473"></a>00473       <span class="keywordflow">if</span>( <a class="code" href="Creature_01Spreading_8cpp.html#6c1ae8dabd332f455970b1cfc21bbedd">giHabitatedDistance</a> == iDistance ) 
<a name="l00474"></a>00474       {     <span class="comment">//FRONT-LINE CONDITIONS -- consider expansion or frontline fortification.  The formulae used</span>
<a name="l00475"></a>00475             <span class="comment">//in this sector are geared towards outer expansion.</span>
<a name="l00476"></a>00476             <span class="comment">//we have reached the distance limitation for the spreading.  We will determine if</span>
<a name="l00477"></a>00477             <span class="comment">//the area is populated enough to spread further.  The minimum population must be 4 before </span>
<a name="l00478"></a>00478             <span class="comment">//spreading is even considered.</span>
<a name="l00479"></a>00479             <span class="keywordflow">if</span>( node-&gt;<a class="code" href="structCREATURE__DIRECTIVE.html#bff6a87fbf7df1c95b8f9f2e0f74f09d">pLevel</a>-&gt;<a class="code" href="structUNDERGROUND__SECTORINFO.html#1cf13c2feb769c29017a524d58ebe8c4">ubNumCreatures</a>*10 - 10 &lt;= (<a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a>)<a class="code" href="Random_8cpp.html#49f938d1313ab6ef09ac6223a16ac334">Random</a>( 60 ) )
<a name="l00480"></a>00480             { <span class="comment">// x&lt;=1   100%</span>
<a name="l00481"></a>00481                   <span class="comment">// x==2            83%</span>
<a name="l00482"></a>00482                   <span class="comment">// x==3            67%</span>
<a name="l00483"></a>00483                   <span class="comment">// x==4            50%</span>
<a name="l00484"></a>00484                   <span class="comment">// x==5            33%</span>
<a name="l00485"></a>00485                   <span class="comment">// x==6            17%</span>
<a name="l00486"></a>00486                   <span class="comment">// x&gt;=7             0%</span>
<a name="l00487"></a>00487                   <a class="code" href="Creature_01Spreading_8cpp.html#641ab6139d4c01d03780a76613874c3c">AddCreatureToNode</a>( node );
<a name="l00488"></a>00488                   <span class="keywordflow">return</span> TRUE;
<a name="l00489"></a>00489             }
<a name="l00490"></a>00490       }
<a name="l00491"></a>00491       <span class="keywordflow">else</span> <span class="keywordflow">if</span>( <a class="code" href="Creature_01Spreading_8cpp.html#6c1ae8dabd332f455970b1cfc21bbedd">giHabitatedDistance</a> &gt; iDistance )
<a name="l00492"></a>00492       { <span class="comment">//we are within the "safe" habitated area of the creature's area of influence.  The chance of</span>
<a name="l00493"></a>00493             <span class="comment">//increasing the population inside this sector depends on how deep we are within the sector.</span>
<a name="l00494"></a>00494             <span class="keywordflow">if</span>( node-&gt;<a class="code" href="structCREATURE__DIRECTIVE.html#bff6a87fbf7df1c95b8f9f2e0f74f09d">pLevel</a>-&gt;<a class="code" href="structUNDERGROUND__SECTORINFO.html#1cf13c2feb769c29017a524d58ebe8c4">ubNumCreatures</a> &lt; <a class="code" href="GameSettings_8cpp.html#5c32f930e2fef384505c4b91803a92c2">gGameExternalOptions</a>.<a class="code" href="structGAME__EXTERNAL__OPTIONS.html#e0dd958b9c8219730a767a875dda20d5">iMaxEnemyGroupSize</a> ||
<a name="l00495"></a>00495                     node-&gt;<a class="code" href="structCREATURE__DIRECTIVE.html#bff6a87fbf7df1c95b8f9f2e0f74f09d">pLevel</a>-&gt;<a class="code" href="structUNDERGROUND__SECTORINFO.html#1cf13c2feb769c29017a524d58ebe8c4">ubNumCreatures</a> &lt; 32 &amp;&amp; node-&gt;<a class="code" href="structCREATURE__DIRECTIVE.html#bff6a87fbf7df1c95b8f9f2e0f74f09d">pLevel</a>-&gt;<a class="code" href="structUNDERGROUND__SECTORINFO.html#f311bb8900c816d69dd6bebf904b5b29">ubCreatureHabitat</a> == <a class="code" href="Creature_01Spreading_8cpp.html#188c132f478fb544e0213ea0020585bcc593579d35b0f087c8b9a39b34ad705d">QUEEN_LAIR</a> )
<a name="l00496"></a>00496             { <span class="comment">//there is ALWAYS a chance to habitate an interior sector, though the chances are slim for </span>
<a name="l00497"></a>00497                   <span class="comment">//highly occupied sectors.  This chance is modified by the type of area we are in.</span>
<a name="l00498"></a>00498                   <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a> iAbsoluteMaxPopulation;
<a name="l00499"></a>00499                   <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a> iMaxPopulation=-1;
<a name="l00500"></a>00500                   <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a> iChanceToPopulate;
<a name="l00501"></a>00501                   <span class="keywordflow">switch</span>( node-&gt;<a class="code" href="structCREATURE__DIRECTIVE.html#bff6a87fbf7df1c95b8f9f2e0f74f09d">pLevel</a>-&gt;<a class="code" href="structUNDERGROUND__SECTORINFO.html#f311bb8900c816d69dd6bebf904b5b29">ubCreatureHabitat</a> )
<a name="l00502"></a>00502                   {
<a name="l00503"></a>00503                         <span class="keywordflow">case</span> <a class="code" href="Creature_01Spreading_8cpp.html#188c132f478fb544e0213ea0020585bcc593579d35b0f087c8b9a39b34ad705d">QUEEN_LAIR</a>: <span class="comment">//Defend the queen bonus</span>
<a name="l00504"></a>00504                               iAbsoluteMaxPopulation = 32;
<a name="l00505"></a>00505                               <span class="keywordflow">break</span>;
<a name="l00506"></a>00506                         <span class="keywordflow">case</span> <a class="code" href="Creature_01Spreading_8cpp.html#188c132f478fb544e0213ea0020585bc2ac8ec47e8b8e49969e0cf9c580654cf">LAIR</a>: <span class="comment">//Smaller defend the queen bonus</span>
<a name="l00507"></a>00507                               iAbsoluteMaxPopulation = 18;
<a name="l00508"></a>00508                               <span class="keywordflow">break</span>;
<a name="l00509"></a>00509                         <span class="keywordflow">case</span> <a class="code" href="Creature_01Spreading_8cpp.html#188c132f478fb544e0213ea0020585bc2ac5fa94536136286b813ffa4a2aec1e">LAIR_ENTRANCE</a>: <span class="comment">//Smallest defend the queen bonus</span>
<a name="l00510"></a>00510                               iAbsoluteMaxPopulation = 15;
<a name="l00511"></a>00511                               <span class="keywordflow">break</span>;
<a name="l00512"></a>00512                         <span class="keywordflow">case</span> <a class="code" href="Creature_01Spreading_8cpp.html#188c132f478fb544e0213ea0020585bc8cb8d444f6fa92714c918fd7a1e8a00d">INNER_MINE</a>: <span class="comment">//neg bonus -- actually promotes expansion over population, and decrease max pop here.</span>
<a name="l00513"></a>00513                               iAbsoluteMaxPopulation = 12;
<a name="l00514"></a>00514                               <span class="keywordflow">break</span>;
<a name="l00515"></a>00515                         <span class="keywordflow">case</span> <a class="code" href="Creature_01Spreading_8cpp.html#188c132f478fb544e0213ea0020585bc0252708b8e3dd2a2b5feb404649f1a59">OUTER_MINE</a>: <span class="comment">//neg bonus -- actually promotes expansion over population, and decrease max pop here.</span>
<a name="l00516"></a>00516                               iAbsoluteMaxPopulation = 10;
<a name="l00517"></a>00517                               <span class="keywordflow">break</span>;
<a name="l00518"></a>00518                         <span class="keywordflow">case</span> <a class="code" href="Creature_01Spreading_8cpp.html#188c132f478fb544e0213ea0020585bcfa564bf961f4259b57ab12d62977f530">FEEDING_GROUNDS</a>: <span class="comment">//get free food bonus!  yummy humans :)</span>
<a name="l00519"></a>00519                               iAbsoluteMaxPopulation = 15;
<a name="l00520"></a>00520                               <span class="keywordflow">break</span>;
<a name="l00521"></a>00521                         <span class="keywordflow">case</span> <a class="code" href="Creature_01Spreading_8cpp.html#188c132f478fb544e0213ea0020585bc0a79da9c3e34dedd3f6ff49262678e07">MINE_EXIT</a>:   <span class="comment">//close access to humans (don't want to overwhelm them)</span>
<a name="l00522"></a>00522                               iAbsoluteMaxPopulation = 10;
<a name="l00523"></a>00523                               <span class="keywordflow">break</span>;
<a name="l00524"></a>00524                         <span class="keywordflow">default</span>:
<a name="l00525"></a>00525                               Assert( 0 );
<a name="l00526"></a>00526                               <span class="keywordflow">return</span> FALSE;
<a name="l00527"></a>00527                   }
<a name="l00528"></a>00528 
<a name="l00529"></a>00529                   <span class="keywordflow">switch</span>( <a class="code" href="GameSettings_8cpp.html#f9f2d5fd368ccadcc26bebc202d52ae7">gGameOptions</a>.<a class="code" href="structGAME__OPTIONS.html#4fb44167906152722f6af5cc9f7c1a99">ubDifficultyLevel</a> )
<a name="l00530"></a>00530                   {
<a name="l00531"></a>00531                         <span class="keywordflow">case</span> <a class="code" href="GameSettings_8h.html#c205be2172292384dd687b5471a87eddbd3b0d23f4dc30ef17b50a14c3f54589">DIF_LEVEL_EASY</a>: <span class="comment">//50%</span>
<a name="l00532"></a>00532                               iAbsoluteMaxPopulation /= 2; <span class="comment">//Half</span>
<a name="l00533"></a>00533                               <span class="keywordflow">break</span>;
<a name="l00534"></a>00534                         <span class="keywordflow">case</span> <a class="code" href="GameSettings_8h.html#c205be2172292384dd687b5471a87edddd0259b09fef163c6aa62268574191cb">DIF_LEVEL_MEDIUM</a>: <span class="comment">//80%</span>
<a name="l00535"></a>00535                               iAbsoluteMaxPopulation = iAbsoluteMaxPopulation * 4 / 5;
<a name="l00536"></a>00536                               <span class="keywordflow">break</span>;
<a name="l00537"></a>00537                         <span class="keywordflow">case</span> <a class="code" href="GameSettings_8h.html#c205be2172292384dd687b5471a87edd3d0b73026f1c7122798d578613aa4575">DIF_LEVEL_HARD</a>: <span class="comment">//100%</span>
<a name="l00538"></a>00538                               <span class="keywordflow">break</span>;
<a name="l00539"></a>00539                         <span class="keywordflow">case</span> <a class="code" href="GameSettings_8h.html#c205be2172292384dd687b5471a87eddc657c89fd754a6f20b3869250288a702">DIF_LEVEL_INSANE</a>: <span class="comment">//200%</span>
<a name="l00540"></a>00540                               iAbsoluteMaxPopulation *= 2;
<a name="l00541"></a>00541                               <span class="keywordflow">break</span>;
<a name="l00542"></a>00542                   }
<a name="l00543"></a>00543 
<a name="l00544"></a>00544                   <span class="comment">//Calculate the desired max population percentage based purely on current distant to creature range.</span>
<a name="l00545"></a>00545                   <span class="comment">//The closer we are to the lair, the closer this value will be to 100.</span>
<a name="l00546"></a>00546                   iMaxPopulation = 100 - iDistance * 100 / <a class="code" href="Creature_01Spreading_8cpp.html#6c1ae8dabd332f455970b1cfc21bbedd">giHabitatedDistance</a>;
<a name="l00547"></a>00547                   iMaxPopulation = max( iMaxPopulation, 25 );
<a name="l00548"></a>00548                   <span class="comment">//Now, convert the previous value into a numeric population.</span>
<a name="l00549"></a>00549                   iMaxPopulation = iAbsoluteMaxPopulation * iMaxPopulation / 100;
<a name="l00550"></a>00550                   iMaxPopulation = max( iMaxPopulation, 4 );
<a name="l00551"></a>00551                   
<a name="l00552"></a>00552 
<a name="l00553"></a>00553                   <span class="comment">//The chance to populate a sector is higher for lower populations.  This is calculated on</span>
<a name="l00554"></a>00554                   <span class="comment">//the ratio of current population to the max population.</span>
<a name="l00555"></a>00555                   iChanceToPopulate = 100 - node-&gt;<a class="code" href="structCREATURE__DIRECTIVE.html#bff6a87fbf7df1c95b8f9f2e0f74f09d">pLevel</a>-&gt;<a class="code" href="structUNDERGROUND__SECTORINFO.html#1cf13c2feb769c29017a524d58ebe8c4">ubNumCreatures</a> * 100 / iMaxPopulation;
<a name="l00556"></a>00556 
<a name="l00557"></a>00557                   <span class="keywordflow">if</span>( !node-&gt;<a class="code" href="structCREATURE__DIRECTIVE.html#bff6a87fbf7df1c95b8f9f2e0f74f09d">pLevel</a>-&gt;<a class="code" href="structUNDERGROUND__SECTORINFO.html#1cf13c2feb769c29017a524d58ebe8c4">ubNumCreatures</a> || iChanceToPopulate &gt; (<a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a>)<a class="code" href="Random_8cpp.html#49f938d1313ab6ef09ac6223a16ac334">Random</a>( 100 ) 
<a name="l00558"></a>00558                               &amp;&amp; iMaxPopulation &gt; node-&gt;<a class="code" href="structCREATURE__DIRECTIVE.html#bff6a87fbf7df1c95b8f9f2e0f74f09d">pLevel</a>-&gt;<a class="code" href="structUNDERGROUND__SECTORINFO.html#1cf13c2feb769c29017a524d58ebe8c4">ubNumCreatures</a> )
<a name="l00559"></a>00559                   {
<a name="l00560"></a>00560                         <a class="code" href="Creature_01Spreading_8cpp.html#641ab6139d4c01d03780a76613874c3c">AddCreatureToNode</a>( node );
<a name="l00561"></a>00561                         <span class="keywordflow">return</span> TRUE;
<a name="l00562"></a>00562                   }
<a name="l00563"></a>00563             }
<a name="l00564"></a>00564       }
<a name="l00565"></a>00565       <span class="keywordflow">else</span>
<a name="l00566"></a>00566       { <span class="comment">//we are in a new area, so we will populate it</span>
<a name="l00567"></a>00567             <a class="code" href="Creature_01Spreading_8cpp.html#641ab6139d4c01d03780a76613874c3c">AddCreatureToNode</a>( node );
<a name="l00568"></a>00568             <a class="code" href="Creature_01Spreading_8cpp.html#6c1ae8dabd332f455970b1cfc21bbedd">giHabitatedDistance</a>++;
<a name="l00569"></a>00569             <span class="keywordflow">return</span> TRUE;
<a name="l00570"></a>00570       }
<a name="l00571"></a>00571       <span class="keywordflow">if</span>( <a class="code" href="Creature_01Spreading_8cpp.html#57699bbe96cd2fa808c0075303c56251">PlaceNewCreature</a>( node-&gt;<a class="code" href="structCREATURE__DIRECTIVE.html#bfbb4d4ab657f447f405bd987d8f719e">next</a>, iDistance + 1 ) )
<a name="l00572"></a>00572             <span class="keywordflow">return</span> TRUE;
<a name="l00573"></a>00573       <span class="keywordflow">return</span> FALSE;
<a name="l00574"></a>00574 }
<a name="l00575"></a>00575 
<a name="l00576"></a><a class="code" href="Creature_01Spreading_8h.html#b67932d756971817d98837a41575f26c">00576</a> <span class="keywordtype">void</span> <a class="code" href="Creature_01Spreading_8cpp.html#b67932d756971817d98837a41575f26c">SpreadCreatures</a>()
<a name="l00577"></a>00577 {
<a name="l00578"></a>00578       <a class="code" href="Types_8h.html#09f1a1fb2293e33483cc8d44aefb1eb1">UINT16</a> usNewCreatures=0;
<a name="l00579"></a>00579 
<a name="l00580"></a>00580       <span class="keywordflow">if</span>( <a class="code" href="Creature_01Spreading_8cpp.html#b9d0d6cd30a304c1dba1c41a5312c190">giLairID</a> == -1 )
<a name="l00581"></a>00581       {
<a name="l00582"></a>00582             <a class="code" href="Creature_01Spreading_8cpp.html#b56ac18f1ca36b410f70eeb5e634d972">DecayCreatures</a>();
<a name="l00583"></a>00583             <span class="keywordflow">return</span>;
<a name="l00584"></a>00584       }
<a name="l00585"></a>00585       
<a name="l00586"></a>00586       <span class="comment">//queen just produced a litter of creature larvae.  Let's do some spreading now.</span>
<a name="l00587"></a>00587       <span class="keywordflow">switch</span>( <a class="code" href="GameSettings_8cpp.html#f9f2d5fd368ccadcc26bebc202d52ae7">gGameOptions</a>.<a class="code" href="structGAME__OPTIONS.html#4fb44167906152722f6af5cc9f7c1a99">ubDifficultyLevel</a> )
<a name="l00588"></a>00588       {
<a name="l00589"></a>00589             <span class="keywordflow">case</span> <a class="code" href="GameSettings_8h.html#c205be2172292384dd687b5471a87eddbd3b0d23f4dc30ef17b50a14c3f54589">DIF_LEVEL_EASY</a>:
<a name="l00590"></a>00590                   usNewCreatures = (<a class="code" href="Types_8h.html#09f1a1fb2293e33483cc8d44aefb1eb1">UINT16</a>)(EASY_QUEEN_REPRODUCTION_BASE + <a class="code" href="Random_8cpp.html#49f938d1313ab6ef09ac6223a16ac334">Random</a>( 1 + EASY_QUEEN_REPRODUCTION_BONUS ));
<a name="l00591"></a>00591                   <span class="keywordflow">break</span>;
<a name="l00592"></a>00592             <span class="keywordflow">case</span> <a class="code" href="GameSettings_8h.html#c205be2172292384dd687b5471a87edddd0259b09fef163c6aa62268574191cb">DIF_LEVEL_MEDIUM</a>:
<a name="l00593"></a>00593                   usNewCreatures = (<a class="code" href="Types_8h.html#09f1a1fb2293e33483cc8d44aefb1eb1">UINT16</a>)(NORMAL_QUEEN_REPRODUCTION_BASE + <a class="code" href="Random_8cpp.html#49f938d1313ab6ef09ac6223a16ac334">Random</a>( 1 + NORMAL_QUEEN_REPRODUCTION_BONUS ));
<a name="l00594"></a>00594                   <span class="keywordflow">break</span>;
<a name="l00595"></a>00595             <span class="keywordflow">case</span> <a class="code" href="GameSettings_8h.html#c205be2172292384dd687b5471a87edd3d0b73026f1c7122798d578613aa4575">DIF_LEVEL_HARD</a>:
<a name="l00596"></a>00596                   usNewCreatures = (<a class="code" href="Types_8h.html#09f1a1fb2293e33483cc8d44aefb1eb1">UINT16</a>)(HARD_QUEEN_REPRODUCTION_BASE + <a class="code" href="Random_8cpp.html#49f938d1313ab6ef09ac6223a16ac334">Random</a>( 1 + HARD_QUEEN_REPRODUCTION_BONUS ));
<a name="l00597"></a>00597                   <span class="keywordflow">break</span>;
<a name="l00598"></a>00598             <span class="keywordflow">case</span> <a class="code" href="GameSettings_8h.html#c205be2172292384dd687b5471a87eddc657c89fd754a6f20b3869250288a702">DIF_LEVEL_INSANE</a>:
<a name="l00599"></a>00599                   usNewCreatures = (<a class="code" href="Types_8h.html#09f1a1fb2293e33483cc8d44aefb1eb1">UINT16</a>)(INSANE_QUEEN_REPRODUCTION_BASE + <a class="code" href="Random_8cpp.html#49f938d1313ab6ef09ac6223a16ac334">Random</a>( 1 + INSANE_QUEEN_REPRODUCTION_BONUS ));
<a name="l00600"></a>00600                   <span class="keywordflow">break</span>;
<a name="l00601"></a>00601       }
<a name="l00602"></a>00602 
<a name="l00603"></a>00603       <span class="keywordflow">while</span>( usNewCreatures-- )
<a name="l00604"></a>00604       { 
<a name="l00605"></a>00605             <span class="comment">//Note, this function can and will fail if the population gets dense.  This is a necessary</span>
<a name="l00606"></a>00606             <span class="comment">//feature.  Otherwise, the queen would fill all the cave levels with MAX_STRATEGIC_TEAM_SIZE monsters, and that would</span>
<a name="l00607"></a>00607             <span class="comment">//be bad.</span>
<a name="l00608"></a>00608             <a class="code" href="Creature_01Spreading_8cpp.html#57699bbe96cd2fa808c0075303c56251">PlaceNewCreature</a>( <a class="code" href="Creature_01Spreading_8cpp.html#f6419c60c42874dbb013443c02534a6a">lair</a>, 0 );
<a name="l00609"></a>00609       }
<a name="l00610"></a>00610 }
<a name="l00611"></a>00611 
<a name="l00612"></a><a class="code" href="Creature_01Spreading_8h.html#b56ac18f1ca36b410f70eeb5e634d972">00612</a> <span class="keywordtype">void</span> <a class="code" href="Creature_01Spreading_8cpp.html#b56ac18f1ca36b410f70eeb5e634d972">DecayCreatures</a>()
<a name="l00613"></a>00613 { <span class="comment">//when the queen dies, we need to kill off the creatures over a period of time.</span>
<a name="l00614"></a>00614 
<a name="l00615"></a>00615 }
<a name="l00616"></a>00616 
<a name="l00617"></a><a class="code" href="Creature_01Spreading_8cpp.html#d26b0aa77231d54c661ebe0daeebe1d1">00617</a> <span class="keywordtype">void</span> <a class="code" href="Creature_01Spreading_8cpp.html#d26b0aa77231d54c661ebe0daeebe1d1">AddCreaturesToBattle</a>( <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubNumYoungMales, <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubNumYoungFemales, <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubNumAdultMales, <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubNumAdultFemales )
<a name="l00618"></a>00618 {
<a name="l00619"></a>00619       <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a> iRandom;
<a name="l00620"></a>00620       <a class="code" href="structSOLDIERTYPE.html">SOLDIERTYPE</a> *<a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>;
<a name="l00621"></a>00621       <a class="code" href="structMAPEDGEPOINTINFO.html">MAPEDGEPOINTINFO</a> MapEdgepointInfo;
<a name="l00622"></a>00622       <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> bDesiredDirection=0;
<a name="l00623"></a>00623       <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubCurrSlot = 0;
<a name="l00624"></a>00624 
<a name="l00625"></a>00625       <span class="keywordflow">switch</span>( <a class="code" href="Creature_01Spreading_8cpp.html#8d461824120f22908152c8f8cfdb61c7">gsCreatureInsertionCode</a> )
<a name="l00626"></a>00626       {
<a name="l00627"></a>00627             <span class="keywordflow">case</span> <a class="code" href="strategic_8h.html#ff44cf33e83896b8e5102305d23db5acaf4e843509b79956327448d90992593b">INSERTION_CODE_NORTH</a>:    bDesiredDirection = <a class="code" href="Overhead_01Types_8h.html#df5bf54a26a76adf253f57d88ade82b716c2c7abfbd3bad3343b0dcaa858bb49">SOUTHEAST</a>;                                                            <span class="keywordflow">break</span>;
<a name="l00628"></a>00628             <span class="keywordflow">case</span> <a class="code" href="strategic_8h.html#ff44cf33e83896b8e5102305d23db5ac7e28426b7b12bf9c174fa95cf09f33da">INSERTION_CODE_EAST</a>:           bDesiredDirection = <a class="code" href="Overhead_01Types_8h.html#df5bf54a26a76adf253f57d88ade82b76aa90951b336be999de204e61dd366d4">SOUTHWEST</a>;                                                            <span class="keywordflow">break</span>;
<a name="l00629"></a>00629             <span class="keywordflow">case</span> <a class="code" href="strategic_8h.html#ff44cf33e83896b8e5102305d23db5ac9f962d8ab64324342f1fba4ccce32878">INSERTION_CODE_SOUTH</a>:    bDesiredDirection = <a class="code" href="Overhead_01Types_8h.html#df5bf54a26a76adf253f57d88ade82b7c8aee466c121a3c3c942f58e1d8864d4">NORTHWEST</a>;                                                            <span class="keywordflow">break</span>;
<a name="l00630"></a>00630             <span class="keywordflow">case</span> <a class="code" href="strategic_8h.html#ff44cf33e83896b8e5102305d23db5ac78d91ba8ebd6b031684490ceeba2b93f">INSERTION_CODE_WEST</a>:           bDesiredDirection = <a class="code" href="Overhead_01Types_8h.html#df5bf54a26a76adf253f57d88ade82b7a6671505783298e4cb967931c1c1ac5b">NORTHEAST</a>;                                                            <span class="keywordflow">break</span>;
<a name="l00631"></a>00631             <span class="keywordflow">case</span> <a class="code" href="strategic_8h.html#ff44cf33e83896b8e5102305d23db5ac6a7bdb362607484db311fa7fef1dec3e">INSERTION_CODE_GRIDNO</a>:                                                                                                                                                         <span class="keywordflow">break</span>;
<a name="l00632"></a>00632             <span class="keywordflow">default</span>:  AssertMsg( 0, <span class="stringliteral">"Illegal direction passed to AddCreaturesToBattle()"</span> );     <span class="keywordflow">break</span>;
<a name="l00633"></a>00633       }
<a name="l00634"></a>00634 
<a name="l00635"></a>00635 <span class="preprocessor">      #ifdef JA2TESTVERSION</span>
<a name="l00636"></a>00636 <span class="preprocessor"></span>            <a class="code" href="message_8cpp.html#818e47bc59bd5a5755f06ec51cd74928">ScreenMsg</a>( FONT_RED, MSG_INTERFACE, L<span class="stringliteral">"Creature attackers have arrived!"</span> );
<a name="l00637"></a>00637 <span class="preprocessor">      #endif</span>
<a name="l00638"></a>00638 <span class="preprocessor"></span>
<a name="l00639"></a>00639       <span class="keywordflow">if</span>( <a class="code" href="Creature_01Spreading_8cpp.html#8d461824120f22908152c8f8cfdb61c7">gsCreatureInsertionCode</a> != <a class="code" href="strategic_8h.html#ff44cf33e83896b8e5102305d23db5ac6a7bdb362607484db311fa7fef1dec3e">INSERTION_CODE_GRIDNO</a> )
<a name="l00640"></a>00640       {
<a name="l00641"></a>00641             <a class="code" href="Map_01Edgepoints_8cpp.html#a8b24d284cdaf1c9fe88475db322b0bb">ChooseMapEdgepoints</a>( &amp;MapEdgepointInfo, (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)<a class="code" href="Creature_01Spreading_8cpp.html#8d461824120f22908152c8f8cfdb61c7">gsCreatureInsertionCode</a>, (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)(ubNumYoungMales+ubNumYoungFemales+ubNumAdultMales+ubNumAdultFemales) );
<a name="l00642"></a>00642             ubCurrSlot = 0;
<a name="l00643"></a>00643       }
<a name="l00644"></a>00644       <span class="keywordflow">while</span>( ubNumYoungMales || ubNumYoungFemales || ubNumAdultMales || ubNumAdultFemales )
<a name="l00645"></a>00645       {
<a name="l00646"></a>00646             iRandom = (<a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a>)<a class="code" href="Random_8cpp.html#49f938d1313ab6ef09ac6223a16ac334">Random</a>( ubNumYoungMales + ubNumYoungFemales + ubNumAdultMales + ubNumAdultFemales );
<a name="l00647"></a>00647             <span class="keywordflow">if</span>( ubNumYoungMales &amp;&amp;  iRandom &lt; (<a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a>)ubNumYoungMales )
<a name="l00648"></a>00648             {
<a name="l00649"></a>00649                   ubNumYoungMales--;
<a name="l00650"></a>00650                   <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a> = <a class="code" href="Soldier_01Create_8cpp.html#8cab55cbaca83a73080a0c9da5d887e1">TacticalCreateCreature</a>( <a class="code" href="Animation_01Data_8h.html#d295a916825180b548473dec560093a725460f03079c143c4456f779763fa23b">YAM_MONSTER</a> );
<a name="l00651"></a>00651             }
<a name="l00652"></a>00652             <span class="keywordflow">else</span> <span class="keywordflow">if</span>( ubNumYoungFemales &amp;&amp; iRandom &lt; (<a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a>)(ubNumYoungMales + ubNumYoungFemales) )
<a name="l00653"></a>00653             {
<a name="l00654"></a>00654                   ubNumYoungFemales--;
<a name="l00655"></a>00655                   <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a> = <a class="code" href="Soldier_01Create_8cpp.html#8cab55cbaca83a73080a0c9da5d887e1">TacticalCreateCreature</a>( <a class="code" href="Animation_01Data_8h.html#d295a916825180b548473dec560093a75f60be3c60e156d8cec34802d7f3607b">YAF_MONSTER</a> );
<a name="l00656"></a>00656             }
<a name="l00657"></a>00657             <span class="keywordflow">else</span> <span class="keywordflow">if</span>( ubNumAdultMales &amp;&amp; iRandom &lt; (<a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a>)(ubNumYoungMales + ubNumYoungFemales + ubNumAdultMales) )
<a name="l00658"></a>00658             {
<a name="l00659"></a>00659                   ubNumAdultMales--;
<a name="l00660"></a>00660                   <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a> = <a class="code" href="Soldier_01Create_8cpp.html#8cab55cbaca83a73080a0c9da5d887e1">TacticalCreateCreature</a>( <a class="code" href="Animation_01Data_8h.html#d295a916825180b548473dec560093a79dec21a470d88f8b8a8704cb9b5ac827">AM_MONSTER</a> );
<a name="l00661"></a>00661             }
<a name="l00662"></a>00662             <span class="keywordflow">else</span> <span class="keywordflow">if</span>( ubNumAdultFemales &amp;&amp; iRandom &lt; (<a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a>)(ubNumYoungMales + ubNumYoungFemales + ubNumAdultMales + ubNumAdultFemales ) )
<a name="l00663"></a>00663             {
<a name="l00664"></a>00664                   ubNumAdultFemales--;
<a name="l00665"></a>00665                   <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a> = <a class="code" href="Soldier_01Create_8cpp.html#8cab55cbaca83a73080a0c9da5d887e1">TacticalCreateCreature</a>( <a class="code" href="Animation_01Data_8h.html#d295a916825180b548473dec560093a78e8f2de8ab141e991ee2b34ebb1dfda1">ADULTFEMALEMONSTER</a> );
<a name="l00666"></a>00666             }
<a name="l00667"></a>00667             <span class="keywordflow">else</span>
<a name="l00668"></a>00668             {
<a name="l00669"></a>00669                   <a class="code" href="Creature_01Spreading_8cpp.html#8d461824120f22908152c8f8cfdb61c7">gsCreatureInsertionCode</a> = 0;
<a name="l00670"></a>00670                   <a class="code" href="Creature_01Spreading_8cpp.html#16b4049935948e13e25173ea4f6ccfc7">gsCreatureInsertionGridNo</a> = 0;
<a name="l00671"></a>00671                   <a class="code" href="Creature_01Spreading_8cpp.html#f234c8f6543322a61901fd234e431951">gubNumCreaturesAttackingTown</a> = 0;
<a name="l00672"></a>00672                   <a class="code" href="Creature_01Spreading_8cpp.html#84dcf8f90fc8c931c4e818e226ea6ddf">gubYoungMalesAttackingTown</a> = 0;
<a name="l00673"></a>00673                   <a class="code" href="Creature_01Spreading_8cpp.html#9fea695dcd093a43ef47a7682e039438">gubYoungFemalesAttackingTown</a> = 0;
<a name="l00674"></a>00674                   <a class="code" href="Creature_01Spreading_8cpp.html#e6c1a6856edb6dd314dd9144cb2da5ed">gubAdultMalesAttackingTown</a> = 0;
<a name="l00675"></a>00675                   <a class="code" href="Creature_01Spreading_8cpp.html#10769de3c8b8b1ddb1f7c05dfa93fa8c">gubAdultFemalesAttackingTown</a> = 0;
<a name="l00676"></a>00676                   <a class="code" href="Creature_01Spreading_8cpp.html#b6b4580c49857ec8823250aae0b26aba">gubCreatureBattleCode</a> = <a class="code" href="Creature_01Spreading_8h.html#d4a9934b75947f1fae21deee31688bb7c5bf5e7c9e8282a9d074fdaa8157d347">CREATURE_BATTLE_CODE_NONE</a>;
<a name="l00677"></a>00677                   <a class="code" href="Creature_01Spreading_8cpp.html#c17982f0be7b0c4ad1e9eb99650944b6">gubSectorIDOfCreatureAttack</a> = 0;
<a name="l00678"></a>00678                   <a class="code" href="opplist_8cpp.html#f4fab2865204e018ead0e5c076b97be4">AllTeamsLookForAll</a>( FALSE );
<a name="l00679"></a>00679 
<a name="l00680"></a>00680                   Assert(0);
<a name="l00681"></a>00681                   <span class="keywordflow">return</span>;
<a name="l00682"></a>00682             }
<a name="l00683"></a>00683             <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#2d9015bbe94d02cd9c6b20515007d927">ubInsertionDirection</a> = bDesiredDirection;
<a name="l00684"></a>00684             <span class="comment">//Setup the position</span>
<a name="l00685"></a>00685             <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#1e83daaaf894f2205884f2b37cc78b22">ubStrategicInsertionCode</a> = <a class="code" href="strategic_8h.html#ff44cf33e83896b8e5102305d23db5ac6a7bdb362607484db311fa7fef1dec3e">INSERTION_CODE_GRIDNO</a>;
<a name="l00686"></a>00686             <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#d48cac73b411925c27e1b8f9b48a4134">bHunting</a> = TRUE;
<a name="l00687"></a>00687             <span class="keywordflow">if</span>( <a class="code" href="Creature_01Spreading_8cpp.html#8d461824120f22908152c8f8cfdb61c7">gsCreatureInsertionCode</a> != <a class="code" href="strategic_8h.html#ff44cf33e83896b8e5102305d23db5ac6a7bdb362607484db311fa7fef1dec3e">INSERTION_CODE_GRIDNO</a> )
<a name="l00688"></a>00688             {
<a name="l00689"></a>00689                   <span class="keywordflow">if</span>( ubCurrSlot &lt; MapEdgepointInfo.<a class="code" href="structMAPEDGEPOINTINFO.html#2042da9404fa0a2413d677d00a166dfc">ubNumPoints</a> )
<a name="l00690"></a>00690                   { <span class="comment">//using an edgepoint</span>
<a name="l00691"></a>00691                         <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#a03e39af0c54104ce6b5713317655a70">usStrategicInsertionData</a> = MapEdgepointInfo.<a class="code" href="structMAPEDGEPOINTINFO.html#07ea65b17e93201d95aeea08dc4237ea">sGridNo</a>[ ubCurrSlot++ ];
<a name="l00692"></a>00692                   }
<a name="l00693"></a>00693                   <span class="keywordflow">else</span> 
<a name="l00694"></a>00694                   { <span class="comment">//no edgepoints left, so put him at the entrypoint.</span>
<a name="l00695"></a>00695                         <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#1e83daaaf894f2205884f2b37cc78b22">ubStrategicInsertionCode</a> = (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)<a class="code" href="Creature_01Spreading_8cpp.html#8d461824120f22908152c8f8cfdb61c7">gsCreatureInsertionCode</a>;
<a name="l00696"></a>00696                   }
<a name="l00697"></a>00697             }
<a name="l00698"></a>00698             <span class="keywordflow">else</span>
<a name="l00699"></a>00699             {
<a name="l00700"></a>00700                   <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#a03e39af0c54104ce6b5713317655a70">usStrategicInsertionData</a> = <a class="code" href="Creature_01Spreading_8cpp.html#16b4049935948e13e25173ea4f6ccfc7">gsCreatureInsertionGridNo</a>;
<a name="l00701"></a>00701             }
<a name="l00702"></a>00702             <a class="code" href="strategicmap_8cpp.html#547801d3817519278d63bcd07122f20e">UpdateMercInSector</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>, <a class="code" href="strategicmap_8cpp.html#49d9aed144a633fda4ba1990f002d703">gWorldSectorX</a>, <a class="code" href="strategicmap_8cpp.html#ea322310ced0e35ee18a2ee7b32aac5b">gWorldSectorY</a>, 0 );
<a name="l00703"></a>00703       }
<a name="l00704"></a>00704       <a class="code" href="Creature_01Spreading_8cpp.html#8d461824120f22908152c8f8cfdb61c7">gsCreatureInsertionCode</a> = 0;
<a name="l00705"></a>00705       <a class="code" href="Creature_01Spreading_8cpp.html#16b4049935948e13e25173ea4f6ccfc7">gsCreatureInsertionGridNo</a> = 0;
<a name="l00706"></a>00706       <a class="code" href="Creature_01Spreading_8cpp.html#f234c8f6543322a61901fd234e431951">gubNumCreaturesAttackingTown</a> = 0;
<a name="l00707"></a>00707       <a class="code" href="Creature_01Spreading_8cpp.html#84dcf8f90fc8c931c4e818e226ea6ddf">gubYoungMalesAttackingTown</a> = 0;
<a name="l00708"></a>00708       <a class="code" href="Creature_01Spreading_8cpp.html#9fea695dcd093a43ef47a7682e039438">gubYoungFemalesAttackingTown</a> = 0;
<a name="l00709"></a>00709       <a class="code" href="Creature_01Spreading_8cpp.html#e6c1a6856edb6dd314dd9144cb2da5ed">gubAdultMalesAttackingTown</a> = 0;
<a name="l00710"></a>00710       <a class="code" href="Creature_01Spreading_8cpp.html#10769de3c8b8b1ddb1f7c05dfa93fa8c">gubAdultFemalesAttackingTown</a> = 0;
<a name="l00711"></a>00711       <a class="code" href="Creature_01Spreading_8cpp.html#b6b4580c49857ec8823250aae0b26aba">gubCreatureBattleCode</a> = <a class="code" href="Creature_01Spreading_8h.html#d4a9934b75947f1fae21deee31688bb7c5bf5e7c9e8282a9d074fdaa8157d347">CREATURE_BATTLE_CODE_NONE</a>;
<a name="l00712"></a>00712       <a class="code" href="Creature_01Spreading_8cpp.html#c17982f0be7b0c4ad1e9eb99650944b6">gubSectorIDOfCreatureAttack</a> = 0;
<a name="l00713"></a>00713       <a class="code" href="opplist_8cpp.html#f4fab2865204e018ead0e5c076b97be4">AllTeamsLookForAll</a>( FALSE );
<a name="l00714"></a>00714 }
<a name="l00715"></a>00715 
<a name="l00716"></a><a class="code" href="Creature_01Spreading_8cpp.html#17e1df1dd4b2bb93b9031d32d0e4a542">00716</a> <span class="keywordtype">void</span> <a class="code" href="Creature_01Spreading_8cpp.html#17e1df1dd4b2bb93b9031d32d0e4a542">ChooseTownSectorToAttack</a>( <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubSectorID, <a class="code" href="Types_8h.html#112e3146cb38b6ee95e64d85842e380a">BOOLEAN</a> fOverrideTest )
<a name="l00717"></a>00717 {
<a name="l00718"></a>00718       <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a> iRandom;
<a name="l00719"></a>00719       <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubSectorX, ubSectorY;
<a name="l00720"></a>00720       ubSectorX = (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)((ubSectorID % 16) + 1);
<a name="l00721"></a>00721       ubSectorY = (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)((ubSectorID / 16) + 1);
<a name="l00722"></a>00722 
<a name="l00723"></a>00723       <span class="keywordflow">if</span>( !fOverrideTest )
<a name="l00724"></a>00724       {
<a name="l00725"></a>00725             iRandom = <a class="code" href="Random_8cpp.html#ca9f12606e77e67e4a79ee8ec0cba956">PreRandom</a>( 100 );
<a name="l00726"></a>00726             <span class="keywordflow">switch</span>( ubSectorID )
<a name="l00727"></a>00727             {
<a name="l00728"></a>00728                   <span class="keywordflow">case</span> <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c66026435b0fbd8598540769dcf8f24e3134f48c">SEC_D13</a>: <span class="comment">//DRASSEN</span>
<a name="l00729"></a>00729                         <span class="keywordflow">if</span>( iRandom &lt; 45 )
<a name="l00730"></a>00730                               ubSectorID = <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c66026435b0fbd8598540769dcf8f24e3134f48c">SEC_D13</a>;
<a name="l00731"></a>00731                         <span class="keywordflow">else</span> <span class="keywordflow">if</span>( iRandom &lt; 70 )
<a name="l00732"></a>00732                               ubSectorID = <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643e84863fb1442cf38c7311021990a9bc3">SEC_C13</a>;
<a name="l00733"></a>00733                         <span class="keywordflow">else</span>
<a name="l00734"></a>00734                               ubSectorID = <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c66026436d911e0461303edb9fe227735f787c22">SEC_B13</a>;
<a name="l00735"></a>00735                         <span class="keywordflow">break</span>;
<a name="l00736"></a>00736                   <span class="keywordflow">case</span> <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643c6ced202c824aa65d9d2f53922400fa1">SEC_H3</a>: <span class="comment">//GRUMM</span>
<a name="l00737"></a>00737                         <span class="keywordflow">if</span>( iRandom &lt; 35 )
<a name="l00738"></a>00738                               ubSectorID = <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643c6ced202c824aa65d9d2f53922400fa1">SEC_H3</a>;
<a name="l00739"></a>00739                         <span class="keywordflow">else</span> <span class="keywordflow">if</span>( iRandom &lt; 55 )
<a name="l00740"></a>00740                               ubSectorID = <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c660264379c7198e0d00238a4c3cfe6454fa6936">SEC_H2</a>;
<a name="l00741"></a>00741                         <span class="keywordflow">else</span> <span class="keywordflow">if</span>( iRandom &lt; 70 )
<a name="l00742"></a>00742                               ubSectorID = <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c660264309137054660d73ef1f5301d5ff96144b">SEC_G2</a>;
<a name="l00743"></a>00743                         <span class="keywordflow">else</span> <span class="keywordflow">if</span>( iRandom &lt; 85 )
<a name="l00744"></a>00744                               ubSectorID = <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643a24273723441a8bfdfc7367e2d2a29b1">SEC_H1</a>;
<a name="l00745"></a>00745                         <span class="keywordflow">else</span>
<a name="l00746"></a>00746                               ubSectorID = <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643017ca621475f0a51e675ed5e1e87d3f6">SEC_G1</a>;
<a name="l00747"></a>00747                         <span class="keywordflow">break</span>;
<a name="l00748"></a>00748                   <span class="keywordflow">case</span> <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643897f1cfaae4b38d8022feec3521887df">SEC_H8</a>: <span class="comment">//CAMBRIA</span>
<a name="l00749"></a>00749                         <span class="keywordflow">if</span>( iRandom &lt; 35 )
<a name="l00750"></a>00750                               ubSectorID = <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643897f1cfaae4b38d8022feec3521887df">SEC_H8</a>;
<a name="l00751"></a>00751                         <span class="keywordflow">else</span> <span class="keywordflow">if</span>( iRandom &lt; 55 )
<a name="l00752"></a>00752                               ubSectorID = <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643d037ec147301d1498cd5ea0307da2d34">SEC_G8</a>;
<a name="l00753"></a>00753                         <span class="keywordflow">else</span> <span class="keywordflow">if</span>( iRandom &lt; 70 )
<a name="l00754"></a>00754                               ubSectorID = <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643e0a7185e05270b8ffacff9816031ae8e">SEC_F8</a>;
<a name="l00755"></a>00755                         <span class="keywordflow">else</span> <span class="keywordflow">if</span>( iRandom &lt; 85 )
<a name="l00756"></a>00756                               ubSectorID = <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643fa4b17f23c10d54767184540803edce8">SEC_G9</a>;
<a name="l00757"></a>00757                         <span class="keywordflow">else</span>
<a name="l00758"></a>00758                               ubSectorID = <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643a20fa3a3e3da7996c9d5fab6d2fb6e84">SEC_F9</a>;
<a name="l00759"></a>00759                         <span class="keywordflow">break</span>;
<a name="l00760"></a>00760                   <span class="keywordflow">case</span> <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643c236a562a9b38d2ee3c7d7ed06e88faf">SEC_I14</a>: <span class="comment">//ALMA</span>
<a name="l00761"></a>00761                         <span class="keywordflow">if</span>( iRandom &lt; 45 )
<a name="l00762"></a>00762                               ubSectorID = <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643c236a562a9b38d2ee3c7d7ed06e88faf">SEC_I14</a>;
<a name="l00763"></a>00763                         <span class="keywordflow">else</span> <span class="keywordflow">if</span>( iRandom &lt; 65 )
<a name="l00764"></a>00764                               ubSectorID = <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c66026434c49cae4ea3baeedd77443968a3166c0">SEC_I13</a>;
<a name="l00765"></a>00765                         <span class="keywordflow">else</span> <span class="keywordflow">if</span>( iRandom &lt; 85 )
<a name="l00766"></a>00766                               ubSectorID = <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c660264366323a5525ca3cd54932950695c8568f">SEC_H14</a>;
<a name="l00767"></a>00767                         <span class="keywordflow">else</span>
<a name="l00768"></a>00768                               ubSectorID = <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c66026438001804c2db19d8207f0a9c3831c1641">SEC_H13</a>;
<a name="l00769"></a>00769                         <span class="keywordflow">break</span>;
<a name="l00770"></a>00770                   <span class="keywordflow">default</span>:
<a name="l00771"></a>00771                         Assert( 0 );
<a name="l00772"></a>00772                         <span class="keywordflow">return</span>;
<a name="l00773"></a>00773             }
<a name="l00774"></a>00774       }
<a name="l00775"></a>00775       <span class="keywordflow">switch</span>( ubSectorID )
<a name="l00776"></a>00776       {
<a name="l00777"></a>00777             <span class="keywordflow">case</span> <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c66026435b0fbd8598540769dcf8f24e3134f48c">SEC_D13</a>: <span class="comment">//DRASSEN</span>
<a name="l00778"></a>00778                   <a class="code" href="Creature_01Spreading_8cpp.html#8d461824120f22908152c8f8cfdb61c7">gsCreatureInsertionCode</a> = <a class="code" href="strategic_8h.html#ff44cf33e83896b8e5102305d23db5ac6a7bdb362607484db311fa7fef1dec3e">INSERTION_CODE_GRIDNO</a>;
<a name="l00779"></a>00779                   <a class="code" href="Creature_01Spreading_8cpp.html#16b4049935948e13e25173ea4f6ccfc7">gsCreatureInsertionGridNo</a> = 20703;
<a name="l00780"></a>00780                   <span class="keywordflow">break</span>;
<a name="l00781"></a>00781             <span class="keywordflow">case</span> <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643e84863fb1442cf38c7311021990a9bc3">SEC_C13</a>:
<a name="l00782"></a>00782                   <a class="code" href="Creature_01Spreading_8cpp.html#8d461824120f22908152c8f8cfdb61c7">gsCreatureInsertionCode</a> = <a class="code" href="strategic_8h.html#ff44cf33e83896b8e5102305d23db5ac9f962d8ab64324342f1fba4ccce32878">INSERTION_CODE_SOUTH</a>;
<a name="l00783"></a>00783                   <span class="keywordflow">break</span>;
<a name="l00784"></a>00784             <span class="keywordflow">case</span> <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c66026436d911e0461303edb9fe227735f787c22">SEC_B13</a>:
<a name="l00785"></a>00785                   <a class="code" href="Creature_01Spreading_8cpp.html#8d461824120f22908152c8f8cfdb61c7">gsCreatureInsertionCode</a> = <a class="code" href="strategic_8h.html#ff44cf33e83896b8e5102305d23db5ac9f962d8ab64324342f1fba4ccce32878">INSERTION_CODE_SOUTH</a>;
<a name="l00786"></a>00786                   <span class="keywordflow">break</span>;
<a name="l00787"></a>00787             <span class="keywordflow">case</span> <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643c6ced202c824aa65d9d2f53922400fa1">SEC_H3</a>: <span class="comment">//GRUMM</span>
<a name="l00788"></a>00788                   <a class="code" href="Creature_01Spreading_8cpp.html#8d461824120f22908152c8f8cfdb61c7">gsCreatureInsertionCode</a> = <a class="code" href="strategic_8h.html#ff44cf33e83896b8e5102305d23db5ac6a7bdb362607484db311fa7fef1dec3e">INSERTION_CODE_GRIDNO</a>;
<a name="l00789"></a>00789                   <a class="code" href="Creature_01Spreading_8cpp.html#16b4049935948e13e25173ea4f6ccfc7">gsCreatureInsertionGridNo</a> = 10303;
<a name="l00790"></a>00790                   <span class="keywordflow">break</span>;
<a name="l00791"></a>00791             <span class="keywordflow">case</span> <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c660264379c7198e0d00238a4c3cfe6454fa6936">SEC_H2</a>:
<a name="l00792"></a>00792                   <a class="code" href="Creature_01Spreading_8cpp.html#8d461824120f22908152c8f8cfdb61c7">gsCreatureInsertionCode</a> = <a class="code" href="strategic_8h.html#ff44cf33e83896b8e5102305d23db5ac7e28426b7b12bf9c174fa95cf09f33da">INSERTION_CODE_EAST</a>;
<a name="l00793"></a>00793                   <span class="keywordflow">break</span>;
<a name="l00794"></a>00794             <span class="keywordflow">case</span> <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c660264309137054660d73ef1f5301d5ff96144b">SEC_G2</a>:
<a name="l00795"></a>00795                   <a class="code" href="Creature_01Spreading_8cpp.html#8d461824120f22908152c8f8cfdb61c7">gsCreatureInsertionCode</a> = <a class="code" href="strategic_8h.html#ff44cf33e83896b8e5102305d23db5ac9f962d8ab64324342f1fba4ccce32878">INSERTION_CODE_SOUTH</a>;
<a name="l00796"></a>00796                   <span class="keywordflow">break</span>;
<a name="l00797"></a>00797             <span class="keywordflow">case</span> <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643a24273723441a8bfdfc7367e2d2a29b1">SEC_H1</a>:
<a name="l00798"></a>00798                   <a class="code" href="Creature_01Spreading_8cpp.html#8d461824120f22908152c8f8cfdb61c7">gsCreatureInsertionCode</a> = <a class="code" href="strategic_8h.html#ff44cf33e83896b8e5102305d23db5ac7e28426b7b12bf9c174fa95cf09f33da">INSERTION_CODE_EAST</a>;
<a name="l00799"></a>00799                   <span class="keywordflow">break</span>;
<a name="l00800"></a>00800             <span class="keywordflow">case</span> <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643017ca621475f0a51e675ed5e1e87d3f6">SEC_G1</a>:
<a name="l00801"></a>00801                   <a class="code" href="Creature_01Spreading_8cpp.html#8d461824120f22908152c8f8cfdb61c7">gsCreatureInsertionCode</a> = <a class="code" href="strategic_8h.html#ff44cf33e83896b8e5102305d23db5ac9f962d8ab64324342f1fba4ccce32878">INSERTION_CODE_SOUTH</a>;
<a name="l00802"></a>00802                   <span class="keywordflow">break</span>;
<a name="l00803"></a>00803             <span class="keywordflow">case</span> <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643897f1cfaae4b38d8022feec3521887df">SEC_H8</a>: <span class="comment">//CAMBRIA</span>
<a name="l00804"></a>00804                   <a class="code" href="Creature_01Spreading_8cpp.html#8d461824120f22908152c8f8cfdb61c7">gsCreatureInsertionCode</a> = <a class="code" href="strategic_8h.html#ff44cf33e83896b8e5102305d23db5ac6a7bdb362607484db311fa7fef1dec3e">INSERTION_CODE_GRIDNO</a>;
<a name="l00805"></a>00805                   <a class="code" href="Creature_01Spreading_8cpp.html#16b4049935948e13e25173ea4f6ccfc7">gsCreatureInsertionGridNo</a> = 13005;
<a name="l00806"></a>00806                   <span class="keywordflow">break</span>;
<a name="l00807"></a>00807             <span class="keywordflow">case</span> <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643d037ec147301d1498cd5ea0307da2d34">SEC_G8</a>:
<a name="l00808"></a>00808                   <a class="code" href="Creature_01Spreading_8cpp.html#8d461824120f22908152c8f8cfdb61c7">gsCreatureInsertionCode</a> = <a class="code" href="strategic_8h.html#ff44cf33e83896b8e5102305d23db5ac9f962d8ab64324342f1fba4ccce32878">INSERTION_CODE_SOUTH</a>;
<a name="l00809"></a>00809                   <span class="keywordflow">break</span>;
<a name="l00810"></a>00810             <span class="keywordflow">case</span> <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643e0a7185e05270b8ffacff9816031ae8e">SEC_F8</a>:
<a name="l00811"></a>00811                   <a class="code" href="Creature_01Spreading_8cpp.html#8d461824120f22908152c8f8cfdb61c7">gsCreatureInsertionCode</a> = <a class="code" href="strategic_8h.html#ff44cf33e83896b8e5102305d23db5ac9f962d8ab64324342f1fba4ccce32878">INSERTION_CODE_SOUTH</a>;
<a name="l00812"></a>00812                   <span class="keywordflow">break</span>;
<a name="l00813"></a>00813             <span class="keywordflow">case</span> <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643fa4b17f23c10d54767184540803edce8">SEC_G9</a>:
<a name="l00814"></a>00814                   <a class="code" href="Creature_01Spreading_8cpp.html#8d461824120f22908152c8f8cfdb61c7">gsCreatureInsertionCode</a> = <a class="code" href="strategic_8h.html#ff44cf33e83896b8e5102305d23db5ac78d91ba8ebd6b031684490ceeba2b93f">INSERTION_CODE_WEST</a>;
<a name="l00815"></a>00815                   <span class="keywordflow">break</span>;
<a name="l00816"></a>00816             <span class="keywordflow">case</span> <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643a20fa3a3e3da7996c9d5fab6d2fb6e84">SEC_F9</a>:
<a name="l00817"></a>00817                   <a class="code" href="Creature_01Spreading_8cpp.html#8d461824120f22908152c8f8cfdb61c7">gsCreatureInsertionCode</a> = <a class="code" href="strategic_8h.html#ff44cf33e83896b8e5102305d23db5ac9f962d8ab64324342f1fba4ccce32878">INSERTION_CODE_SOUTH</a>;
<a name="l00818"></a>00818                   <span class="keywordflow">break</span>;
<a name="l00819"></a>00819             <span class="keywordflow">case</span> <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643c236a562a9b38d2ee3c7d7ed06e88faf">SEC_I14</a>: <span class="comment">//ALMA</span>
<a name="l00820"></a>00820                   <a class="code" href="Creature_01Spreading_8cpp.html#8d461824120f22908152c8f8cfdb61c7">gsCreatureInsertionCode</a> = <a class="code" href="strategic_8h.html#ff44cf33e83896b8e5102305d23db5ac6a7bdb362607484db311fa7fef1dec3e">INSERTION_CODE_GRIDNO</a>;
<a name="l00821"></a>00821                   <a class="code" href="Creature_01Spreading_8cpp.html#16b4049935948e13e25173ea4f6ccfc7">gsCreatureInsertionGridNo</a> = 9726;
<a name="l00822"></a>00822                   <span class="keywordflow">break</span>;
<a name="l00823"></a>00823             <span class="keywordflow">case</span> <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c66026434c49cae4ea3baeedd77443968a3166c0">SEC_I13</a>:
<a name="l00824"></a>00824                   <a class="code" href="Creature_01Spreading_8cpp.html#8d461824120f22908152c8f8cfdb61c7">gsCreatureInsertionCode</a> = <a class="code" href="strategic_8h.html#ff44cf33e83896b8e5102305d23db5ac7e28426b7b12bf9c174fa95cf09f33da">INSERTION_CODE_EAST</a>;
<a name="l00825"></a>00825                   <span class="keywordflow">break</span>;
<a name="l00826"></a>00826             <span class="keywordflow">case</span> <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c660264366323a5525ca3cd54932950695c8568f">SEC_H14</a>:
<a name="l00827"></a>00827                   <a class="code" href="Creature_01Spreading_8cpp.html#8d461824120f22908152c8f8cfdb61c7">gsCreatureInsertionCode</a> = <a class="code" href="strategic_8h.html#ff44cf33e83896b8e5102305d23db5ac9f962d8ab64324342f1fba4ccce32878">INSERTION_CODE_SOUTH</a>;
<a name="l00828"></a>00828                   <span class="keywordflow">break</span>;
<a name="l00829"></a>00829             <span class="keywordflow">case</span> <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c66026438001804c2db19d8207f0a9c3831c1641">SEC_H13</a>:
<a name="l00830"></a>00830                   <a class="code" href="Creature_01Spreading_8cpp.html#8d461824120f22908152c8f8cfdb61c7">gsCreatureInsertionCode</a> = <a class="code" href="strategic_8h.html#ff44cf33e83896b8e5102305d23db5ac7e28426b7b12bf9c174fa95cf09f33da">INSERTION_CODE_EAST</a>;
<a name="l00831"></a>00831                   <span class="keywordflow">break</span>;
<a name="l00832"></a>00832             <span class="keywordflow">default</span>:
<a name="l00833"></a>00833                   <span class="keywordflow">return</span>;
<a name="l00834"></a>00834       }
<a name="l00835"></a>00835       <a class="code" href="Creature_01Spreading_8cpp.html#c17982f0be7b0c4ad1e9eb99650944b6">gubSectorIDOfCreatureAttack</a> = ubSectorID;
<a name="l00836"></a>00836 }
<a name="l00837"></a>00837 
<a name="l00838"></a><a class="code" href="Creature_01Spreading_8h.html#476ce6a8ad19819c72b82a733ea65204">00838</a> <span class="keywordtype">void</span> <a class="code" href="Creature_01Spreading_8cpp.html#476ce6a8ad19819c72b82a733ea65204">CreatureAttackTown</a>( <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubSectorID, <a class="code" href="Types_8h.html#112e3146cb38b6ee95e64d85842e380a">BOOLEAN</a> fOverrideTest )
<a name="l00839"></a>00839 { <span class="comment">//This is the launching point of the creature attack.</span>
<a name="l00840"></a>00840       <a class="code" href="structUNDERGROUND__SECTORINFO.html">UNDERGROUND_SECTORINFO</a> *pSector;
<a name="l00841"></a>00841       <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubSectorX, ubSectorY;
<a name="l00842"></a>00842 
<a name="l00843"></a>00843       <span class="keywordflow">if</span>( <a class="code" href="Map_01Information_8cpp.html#0d739dcb74321d819ef2bfcb1eb5a669">gfWorldLoaded</a> &amp;&amp; <a class="code" href="Overhead_8cpp.html#46bd754f8875c305ab18731ed10e3364">gTacticalStatus</a>.<a class="code" href="structTacticalStatusType.html#a921ee4fc79277889d9c1cec0985d3a3">fEnemyInSector</a> )
<a name="l00844"></a>00844       { <span class="comment">//Battle currently in progress, repost the event</span>
<a name="l00845"></a>00845             <a class="code" href="Game_01Event_01Hook_8h.html#d0da2cc582f16f4f54f328db96d7ca56">AddStrategicEvent</a>( <a class="code" href="Game_01Event_01Hook_8h.html#08f51f22ad2ed13a25181c260457311045c2adfea062cdbcf6a48276c30dd162">EVENT_CREATURE_ATTACK</a>, <a class="code" href="Game_01Clock_8cpp.html#4d255e800fba4d64144a7639d5f3421d">GetWorldTotalMin</a>() + <a class="code" href="Random_8cpp.html#49f938d1313ab6ef09ac6223a16ac334">Random</a>( 10 ), ubSectorID );
<a name="l00846"></a>00846             <span class="keywordflow">return</span>;
<a name="l00847"></a>00847       }
<a name="l00848"></a>00848 
<a name="l00849"></a>00849       <a class="code" href="Creature_01Spreading_8cpp.html#b6b4580c49857ec8823250aae0b26aba">gubCreatureBattleCode</a> = <a class="code" href="Creature_01Spreading_8h.html#d4a9934b75947f1fae21deee31688bb7c5bf5e7c9e8282a9d074fdaa8157d347">CREATURE_BATTLE_CODE_NONE</a>;
<a name="l00850"></a>00850       
<a name="l00851"></a>00851       ubSectorX = (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)((ubSectorID % 16) + 1);
<a name="l00852"></a>00852       ubSectorY = (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)((ubSectorID / 16) + 1);
<a name="l00853"></a>00853 
<a name="l00854"></a>00854       <span class="keywordflow">if</span>( !fOverrideTest )
<a name="l00855"></a>00855       {
<a name="l00856"></a>00856             <span class="comment">//Record the number of creatures in the sector.</span>
<a name="l00857"></a>00857             pSector = <a class="code" href="Creature_01Spreading_8cpp.html#8416712124d291c97f383014e261bb16">FindUnderGroundSector</a>( ubSectorX, ubSectorY, 1 );
<a name="l00858"></a>00858             <span class="keywordflow">if</span>( !pSector )
<a name="l00859"></a>00859             {
<a name="l00860"></a>00860                   <a class="code" href="Creature_01Spreading_8cpp.html#476ce6a8ad19819c72b82a733ea65204">CreatureAttackTown</a>( ubSectorID, TRUE );
<a name="l00861"></a>00861                   <span class="keywordflow">return</span>;
<a name="l00862"></a>00862             }
<a name="l00863"></a>00863             <a class="code" href="Creature_01Spreading_8cpp.html#f234c8f6543322a61901fd234e431951">gubNumCreaturesAttackingTown</a> = pSector-&gt;<a class="code" href="structUNDERGROUND__SECTORINFO.html#1cf13c2feb769c29017a524d58ebe8c4">ubNumCreatures</a>;
<a name="l00864"></a>00864             <span class="keywordflow">if</span>( !<a class="code" href="Creature_01Spreading_8cpp.html#f234c8f6543322a61901fd234e431951">gubNumCreaturesAttackingTown</a> )
<a name="l00865"></a>00865             {
<a name="l00866"></a>00866                   <a class="code" href="Creature_01Spreading_8cpp.html#476ce6a8ad19819c72b82a733ea65204">CreatureAttackTown</a>( ubSectorID, TRUE );
<a name="l00867"></a>00867                   <span class="keywordflow">return</span>;
<a name="l00868"></a>00868             }
<a name="l00869"></a>00869 
<a name="l00870"></a>00870             pSector-&gt;<a class="code" href="structUNDERGROUND__SECTORINFO.html#1cf13c2feb769c29017a524d58ebe8c4">ubNumCreatures</a> = 0;
<a name="l00871"></a>00871             
<a name="l00872"></a>00872             <span class="comment">//Choose one of the town sectors to attack.  Sectors closer to </span>
<a name="l00873"></a>00873             <span class="comment">//the mine entrance have a greater chance of being chosen.</span>
<a name="l00874"></a>00874             <a class="code" href="Creature_01Spreading_8cpp.html#17e1df1dd4b2bb93b9031d32d0e4a542">ChooseTownSectorToAttack</a>( ubSectorID, FALSE );
<a name="l00875"></a>00875             ubSectorX = (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)((<a class="code" href="Creature_01Spreading_8cpp.html#c17982f0be7b0c4ad1e9eb99650944b6">gubSectorIDOfCreatureAttack</a> % 16) + 1);
<a name="l00876"></a>00876             ubSectorY = (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)((<a class="code" href="Creature_01Spreading_8cpp.html#c17982f0be7b0c4ad1e9eb99650944b6">gubSectorIDOfCreatureAttack</a> / 16) + 1);
<a name="l00877"></a>00877       }
<a name="l00878"></a>00878       <span class="keywordflow">else</span>
<a name="l00879"></a>00879       {
<a name="l00880"></a>00880             <a class="code" href="Creature_01Spreading_8cpp.html#17e1df1dd4b2bb93b9031d32d0e4a542">ChooseTownSectorToAttack</a>( ubSectorID, TRUE );
<a name="l00881"></a>00881             <a class="code" href="Creature_01Spreading_8cpp.html#f234c8f6543322a61901fd234e431951">gubNumCreaturesAttackingTown</a> = 5;
<a name="l00882"></a>00882       }
<a name="l00883"></a>00883       
<a name="l00884"></a>00884       <span class="comment">//Now that the sector has been chosen, attack it!</span>
<a name="l00885"></a>00885       <span class="keywordflow">if</span>( <a class="code" href="Strategic_01Movement_8cpp.html#4d205f5fb613eef14ca95cb6ad7a5c97">PlayerGroupsInSector</a>( ubSectorX, ubSectorY, 0 ) )
<a name="l00886"></a>00886       { <span class="comment">//we have players in the sector</span>
<a name="l00887"></a>00887             <span class="keywordflow">if</span>( ubSectorX == <a class="code" href="strategicmap_8cpp.html#49d9aed144a633fda4ba1990f002d703">gWorldSectorX</a> &amp;&amp; ubSectorY == <a class="code" href="strategicmap_8cpp.html#ea322310ced0e35ee18a2ee7b32aac5b">gWorldSectorY</a> &amp;&amp; !<a class="code" href="strategicmap_8cpp.html#da715721a8ceedd42acf6ddb33e63ce0">gbWorldSectorZ</a> )
<a name="l00888"></a>00888             { <span class="comment">//This is the currently loaded sector.  All we have to do is change the music and insert </span>
<a name="l00889"></a>00889                   <span class="comment">//the creatures tactically.</span>
<a name="l00890"></a>00890                   <span class="keywordflow">if</span>( <a class="code" href="gameloop_8cpp.html#8cd832c7f0ec6ab02ba9fddd4a2257aa">guiCurrentScreen</a> == <a class="code" href="screenids_8h.html#a4ee5dea8709d2b490486a62df77faf29873e16bc1530dedb416060abbeea6d0">GAME_SCREEN</a> )
<a name="l00891"></a>00891                   {
<a name="l00892"></a>00892                         <a class="code" href="Creature_01Spreading_8cpp.html#b6b4580c49857ec8823250aae0b26aba">gubCreatureBattleCode</a> = <a class="code" href="Creature_01Spreading_8h.html#d4a9934b75947f1fae21deee31688bb7a5f74fa804901139aeea8467bcce900c">CREATURE_BATTLE_CODE_TACTICALLYADD</a>;
<a name="l00893"></a>00893                   }
<a name="l00894"></a>00894                   <span class="keywordflow">else</span>
<a name="l00895"></a>00895                   {
<a name="l00896"></a>00896                         <a class="code" href="Creature_01Spreading_8cpp.html#b6b4580c49857ec8823250aae0b26aba">gubCreatureBattleCode</a> = <a class="code" href="Creature_01Spreading_8h.html#d4a9934b75947f1fae21deee31688bb7c0ff93114a1c62ffb2446852a219c799">CREATURE_BATTLE_CODE_PREBATTLEINTERFACE</a>;
<a name="l00897"></a>00897                   }
<a name="l00898"></a>00898             }
<a name="l00899"></a>00899             <span class="keywordflow">else</span>
<a name="l00900"></a>00900             {
<a name="l00901"></a>00901                   <a class="code" href="Creature_01Spreading_8cpp.html#b6b4580c49857ec8823250aae0b26aba">gubCreatureBattleCode</a> = <a class="code" href="Creature_01Spreading_8h.html#d4a9934b75947f1fae21deee31688bb7c0ff93114a1c62ffb2446852a219c799">CREATURE_BATTLE_CODE_PREBATTLEINTERFACE</a>;
<a name="l00902"></a>00902             }
<a name="l00903"></a>00903       }
<a name="l00904"></a>00904       <span class="keywordflow">else</span> <span class="keywordflow">if</span>( <a class="code" href="Town_01Militia_8cpp.html#d5f4d1a7e2d1489b786239270acbdda1">CountAllMilitiaInSector</a>( ubSectorX, ubSectorY ) )
<a name="l00905"></a>00905       { <span class="comment">//we have militia in the sector</span>
<a name="l00906"></a>00906         <a class="code" href="Creature_01Spreading_8cpp.html#b6b4580c49857ec8823250aae0b26aba">gubCreatureBattleCode</a> = <a class="code" href="Creature_01Spreading_8h.html#d4a9934b75947f1fae21deee31688bb7629c91b3df8b6ff30ad39d9cbd76c4da">CREATURE_BATTLE_CODE_AUTORESOLVE</a>;
<a name="l00907"></a>00907       }
<a name="l00908"></a>00908       <span class="keywordflow">else</span> <span class="keywordflow">if</span>( !<a class="code" href="strategic_8cpp.html#6f48fb0ea28e3d4889423290f1a6ede8">StrategicMap</a>[ ubSectorX + MAP_WORLD_X * ubSectorY ].fEnemyControlled )
<a name="l00909"></a>00909       { <span class="comment">//player controlled sector -- eat some civilians</span>
<a name="l00910"></a>00910             <a class="code" href="Strategic_01Town_01Loyalty_8cpp.html#2c12c95399514d0b3cc7f65e46369113">AdjustLoyaltyForCivsEatenByMonsters</a>( ubSectorX, ubSectorY, <a class="code" href="Creature_01Spreading_8cpp.html#f234c8f6543322a61901fd234e431951">gubNumCreaturesAttackingTown</a> );
<a name="l00911"></a>00911             <a class="code" href="Campaign_01Types_8h.html#d83c6f699f17a47cf6a662c91d959126">SectorInfo</a>[ ubSectorID ].<a class="code" href="structSECTORINFO.html#9c353c0895fbd6e04c771025745dd7fb">ubDayOfLastCreatureAttack</a> = (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)<a class="code" href="Game_01Clock_8cpp.html#41db6fb136e18cfede5f7c1eea89d7fb">GetWorldDay</a>();
<a name="l00912"></a>00912             <span class="keywordflow">return</span>;
<a name="l00913"></a>00913       }
<a name="l00914"></a>00914       <span class="keywordflow">else</span> 
<a name="l00915"></a>00915       { <span class="comment">//enemy controlled sectors don't get attacked.</span>
<a name="l00916"></a>00916             <span class="keywordflow">return</span>;
<a name="l00917"></a>00917       }
<a name="l00918"></a>00918 
<a name="l00919"></a>00919       <a class="code" href="Campaign_01Types_8h.html#d83c6f699f17a47cf6a662c91d959126">SectorInfo</a>[ ubSectorID ].<a class="code" href="structSECTORINFO.html#9c353c0895fbd6e04c771025745dd7fb">ubDayOfLastCreatureAttack</a> = (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)<a class="code" href="Game_01Clock_8cpp.html#41db6fb136e18cfede5f7c1eea89d7fb">GetWorldDay</a>();
<a name="l00920"></a>00920       <span class="keywordflow">switch</span>( <a class="code" href="Creature_01Spreading_8cpp.html#b6b4580c49857ec8823250aae0b26aba">gubCreatureBattleCode</a> )
<a name="l00921"></a>00921       {
<a name="l00922"></a>00922             <span class="keywordflow">case</span> <a class="code" href="Creature_01Spreading_8h.html#d4a9934b75947f1fae21deee31688bb7c0ff93114a1c62ffb2446852a219c799">CREATURE_BATTLE_CODE_PREBATTLEINTERFACE</a>:
<a name="l00923"></a>00923                   <a class="code" href="PreBattle_01Interface_8cpp.html#3f0b4f53e21b1c2ff4651c51a54fdc45">InitPreBattleInterface</a>( NULL, TRUE );
<a name="l00924"></a>00924                   <span class="keywordflow">break</span>;
<a name="l00925"></a>00925             <span class="keywordflow">case</span> <a class="code" href="Creature_01Spreading_8h.html#d4a9934b75947f1fae21deee31688bb7629c91b3df8b6ff30ad39d9cbd76c4da">CREATURE_BATTLE_CODE_AUTORESOLVE</a>:
<a name="l00926"></a>00926                   <a class="code" href="PreBattle_01Interface_8cpp.html#c2b7344a3b53c65feabd6a9679ca5157">gfAutomaticallyStartAutoResolve</a> = TRUE;
<a name="l00927"></a>00927                   <a class="code" href="PreBattle_01Interface_8cpp.html#3f0b4f53e21b1c2ff4651c51a54fdc45">InitPreBattleInterface</a>( NULL, TRUE );
<a name="l00928"></a>00928                   <span class="keywordflow">break</span>;
<a name="l00929"></a>00929             <span class="keywordflow">case</span> <a class="code" href="Creature_01Spreading_8h.html#d4a9934b75947f1fae21deee31688bb7a5f74fa804901139aeea8467bcce900c">CREATURE_BATTLE_CODE_TACTICALLYADD</a>:
<a name="l00930"></a>00930                   <a class="code" href="Creature_01Spreading_8cpp.html#34177bd8648086123b70108eb97c7b91">PrepareCreaturesForBattle</a>();
<a name="l00931"></a>00931                   <span class="keywordflow">break</span>;
<a name="l00932"></a>00932       }
<a name="l00933"></a>00933       <a class="code" href="Game_01Clock_8cpp.html#fd1b8232424eb26ffe5477c5fe244b53">InterruptTime</a>();
<a name="l00934"></a>00934       <a class="code" href="Game_01Clock_8cpp.html#426aeef836203b725ffe02df6a9a9299">PauseGame</a>();
<a name="l00935"></a>00935       <a class="code" href="Game_01Clock_8cpp.html#4b28955e12b707b3a642529b787ec142">LockPauseState</a>( 2 );
<a name="l00936"></a>00936 }
<a name="l00937"></a>00937 
<a name="l00938"></a>00938 <span class="comment">//Called by campaign init.</span>
<a name="l00939"></a><a class="code" href="Creature_01Spreading_8h.html#ef059839417caa2cf6730c6e3a3c862d">00939</a> <span class="keywordtype">void</span> <a class="code" href="Creature_01Spreading_8cpp.html#ef059839417caa2cf6730c6e3a3c862d">ChooseCreatureQuestStartDay</a>()
<a name="l00940"></a>00940 {
<a name="l00941"></a>00941 <span class="comment">//    INT32 iRandom, iDay;</span>
<a name="l00942"></a>00942       <span class="keywordflow">if</span>( !(<a class="code" href="GameSettings_8cpp.html#f9f2d5fd368ccadcc26bebc202d52ae7">gGameOptions</a>.<a class="code" href="structGAME__OPTIONS.html#385fe2b8245d05dd17cb88b9354a2962">ubGameStyle</a> == <a class="code" href="GameSettings_8h.html#157d5577a5b2f5986037d0d09c7dc77dfd61d6dbb557b45a6354ad22f67f23de">STYLE_SCIFI</a>) || !<a class="code" href="GameSettings_8cpp.html#5c32f930e2fef384505c4b91803a92c2">gGameExternalOptions</a>.<a class="code" href="structGAME__EXTERNAL__OPTIONS.html#21d510b6efb7f779d25684d653aca5b2">fEnableCrepitus</a>)
<a name="l00943"></a>00943             <span class="keywordflow">return</span>; <span class="comment">//only available in science fiction mode.</span>
<a name="l00944"></a>00944       <span class="comment">//Post the event.  Once it becomes due, it will setup the queen monster's location, and</span>
<a name="l00945"></a>00945       <span class="comment">//begin spreading and attacking towns from there.</span>
<a name="l00946"></a>00946       <span class="keywordflow">switch</span>( <a class="code" href="GameSettings_8cpp.html#f9f2d5fd368ccadcc26bebc202d52ae7">gGameOptions</a>.<a class="code" href="structGAME__OPTIONS.html#4fb44167906152722f6af5cc9f7c1a99">ubDifficultyLevel</a> )
<a name="l00947"></a>00947       {
<a name="l00948"></a>00948             <span class="keywordflow">case</span> <a class="code" href="GameSettings_8h.html#c205be2172292384dd687b5471a87eddbd3b0d23f4dc30ef17b50a14c3f54589">DIF_LEVEL_EASY</a>:
<a name="l00949"></a>00949                   <span class="comment">//AddPeriodStrategicEvent( EVENT_BEGIN_CREATURE_QUEST, (EASY_QUEEN_START_DAY + Random( 1 + EASY_QUEEN_START_BONUS )) * 1440 , 0 );</span>
<a name="l00950"></a>00950                   <span class="keywordflow">break</span>;
<a name="l00951"></a>00951             <span class="keywordflow">case</span> <a class="code" href="GameSettings_8h.html#c205be2172292384dd687b5471a87edddd0259b09fef163c6aa62268574191cb">DIF_LEVEL_MEDIUM</a>:
<a name="l00952"></a>00952                   <span class="comment">//AddPeriodStrategicEvent( EVENT_BEGIN_CREATURE_QUEST, (NORMAL_QUEEN_START_DAY + Random( 1 + NORMAL_QUEEN_START_BONUS )) * 1440, 0 );</span>
<a name="l00953"></a>00953                   <span class="keywordflow">break</span>;
<a name="l00954"></a>00954             <span class="keywordflow">case</span> <a class="code" href="GameSettings_8h.html#c205be2172292384dd687b5471a87edd3d0b73026f1c7122798d578613aa4575">DIF_LEVEL_HARD</a>:
<a name="l00955"></a>00955                   <span class="comment">//AddPeriodStrategicEvent( EVENT_BEGIN_CREATURE_QUEST, (HARD_QUEEN_START_DAY + Random( 1 + HARD_QUEEN_START_BONUS )) * 1440, 0 );</span>
<a name="l00956"></a>00956                   <span class="keywordflow">break</span>;
<a name="l00957"></a>00957             <span class="keywordflow">case</span> <a class="code" href="GameSettings_8h.html#c205be2172292384dd687b5471a87eddc657c89fd754a6f20b3869250288a702">DIF_LEVEL_INSANE</a>:
<a name="l00958"></a>00958                   <span class="comment">//AddPeriodStrategicEvent( EVENT_BEGIN_CREATURE_QUEST, (INSANE_QUEEN_START_DAY + Random( 1 + INSANE_QUEEN_START_BONUS )) * 1440, 0 );</span>
<a name="l00959"></a>00959                   <span class="keywordflow">break</span>;
<a name="l00960"></a>00960       }
<a name="l00961"></a>00961 }
<a name="l00962"></a>00962 
<a name="l00963"></a><a class="code" href="Creature_01Spreading_8cpp.html#7c35db9a66046f04d45192e8210f6198">00963</a> <span class="keywordtype">void</span> <a class="code" href="Creature_01Spreading_8cpp.html#7c35db9a66046f04d45192e8210f6198">DeleteDirectiveNode</a>( <a class="code" href="structCREATURE__DIRECTIVE.html">CREATURE_DIRECTIVE</a> **node )
<a name="l00964"></a>00964 {
<a name="l00965"></a>00965       <span class="keywordflow">if</span>( (*node)-&gt;next ) 
<a name="l00966"></a>00966             <a class="code" href="Creature_01Spreading_8cpp.html#7c35db9a66046f04d45192e8210f6198">DeleteDirectiveNode</a>( &amp;((*node)-&gt;next) );
<a name="l00967"></a>00967       MemFree( *node );
<a name="l00968"></a>00968       *node = NULL;
<a name="l00969"></a>00969 }
<a name="l00970"></a>00970 
<a name="l00971"></a>00971 <span class="comment">//Recursively delete all nodes (from the top down).</span>
<a name="l00972"></a><a class="code" href="Creature_01Spreading_8cpp.html#bea04c743d552953de1139301e7045c8">00972</a> <span class="keywordtype">void</span> <a class="code" href="Creature_01Spreading_8cpp.html#bea04c743d552953de1139301e7045c8">DeleteCreatureDirectives</a>()
<a name="l00973"></a>00973 {
<a name="l00974"></a>00974       <span class="keywordflow">if</span>( <a class="code" href="Creature_01Spreading_8cpp.html#f6419c60c42874dbb013443c02534a6a">lair</a> )
<a name="l00975"></a>00975             <a class="code" href="Creature_01Spreading_8cpp.html#7c35db9a66046f04d45192e8210f6198">DeleteDirectiveNode</a>( &amp;<a class="code" href="Creature_01Spreading_8cpp.html#f6419c60c42874dbb013443c02534a6a">lair</a> );
<a name="l00976"></a>00976       <a class="code" href="Creature_01Spreading_8cpp.html#b9d0d6cd30a304c1dba1c41a5312c190">giLairID</a> = 0;
<a name="l00977"></a>00977 }
<a name="l00978"></a>00978 
<a name="l00979"></a><a class="code" href="Creature_01Spreading_8h.html#b93d4c3008332af3d18fef3693554901">00979</a> <span class="keywordtype">void</span> <a class="code" href="Creature_01Spreading_8cpp.html#b93d4c3008332af3d18fef3693554901">ClearCreatureQuest</a>()
<a name="l00980"></a>00980 {
<a name="l00981"></a>00981       <span class="comment">//This will remove all of the underground sector information and reinitialize it.</span>
<a name="l00982"></a>00982       <span class="comment">//The only part that doesn't get added are the queen's lair.</span>
<a name="l00983"></a>00983       <a class="code" href="Campaign_01Init_8cpp.html#a588f1fc8a8722334dfff2f624f1321d">BuildUndergroundSectorInfoList</a>();
<a name="l00984"></a>00984       <a class="code" href="Game_01Event_01Hook_8h.html#0f4bec2a78f8f741c550be068eed3941">DeleteAllStrategicEventsOfType</a>( <a class="code" href="Game_01Event_01Hook_8h.html#08f51f22ad2ed13a25181c2604573110bf1b28fbd856a4b1e3e194c32757ea49">EVENT_BEGIN_CREATURE_QUEST</a> );
<a name="l00985"></a>00985       <a class="code" href="Creature_01Spreading_8cpp.html#bea04c743d552953de1139301e7045c8">DeleteCreatureDirectives</a>();
<a name="l00986"></a>00986 }
<a name="l00987"></a>00987 
<a name="l00988"></a><a class="code" href="Queen_01Command_8cpp.html#e468deb371d18f26d581e0406db42d22">00988</a> <span class="keywordtype">void</span> <a class="code" href="Creature_01Spreading_8cpp.html#e468deb371d18f26d581e0406db42d22">EndCreatureQuest</a>()
<a name="l00989"></a>00989 {
<a name="l00990"></a>00990       <a class="code" href="structCREATURE__DIRECTIVE.html">CREATURE_DIRECTIVE</a> *curr;
<a name="l00991"></a>00991       <a class="code" href="structUNDERGROUND__SECTORINFO.html">UNDERGROUND_SECTORINFO</a> *pSector;
<a name="l00992"></a>00992       <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a> i;
<a name="l00993"></a>00993       
<a name="l00994"></a>00994       <span class="comment">//By setting the lairID to -1, when it comes time to spread creatures,</span>
<a name="l00995"></a>00995       <span class="comment">//They will get subtracted instead.</span>
<a name="l00996"></a>00996       <a class="code" href="Creature_01Spreading_8cpp.html#da7da2c006075a287418792f1a6a8d56">giDestroyedLairID</a> = <a class="code" href="Creature_01Spreading_8cpp.html#b9d0d6cd30a304c1dba1c41a5312c190">giLairID</a>;
<a name="l00997"></a>00997       <a class="code" href="Creature_01Spreading_8cpp.html#b9d0d6cd30a304c1dba1c41a5312c190">giLairID</a> = -1;
<a name="l00998"></a>00998 
<a name="l00999"></a>00999       <span class="comment">//Also nuke all of the creatures in all of the other mine sectors.  This</span>
<a name="l01000"></a>01000       <span class="comment">//is keyed on the fact that the queen monster is killed.</span>
<a name="l01001"></a>01001       curr = <a class="code" href="Creature_01Spreading_8cpp.html#f6419c60c42874dbb013443c02534a6a">lair</a>;
<a name="l01002"></a>01002       <span class="keywordflow">if</span>( curr )
<a name="l01003"></a>01003       { <span class="comment">//skip first node (there could be other creatures around.</span>
<a name="l01004"></a>01004             curr = curr-&gt;<a class="code" href="structCREATURE__DIRECTIVE.html#bfbb4d4ab657f447f405bd987d8f719e">next</a>;
<a name="l01005"></a>01005       }
<a name="l01006"></a>01006       <span class="keywordflow">while</span>( curr )
<a name="l01007"></a>01007       {
<a name="l01008"></a>01008             curr-&gt;<a class="code" href="structCREATURE__DIRECTIVE.html#bff6a87fbf7df1c95b8f9f2e0f74f09d">pLevel</a>-&gt;<a class="code" href="structUNDERGROUND__SECTORINFO.html#1cf13c2feb769c29017a524d58ebe8c4">ubNumCreatures</a> = 0;
<a name="l01009"></a>01009             curr = curr-&gt;<a class="code" href="structCREATURE__DIRECTIVE.html#bfbb4d4ab657f447f405bd987d8f719e">next</a>;
<a name="l01010"></a>01010       }
<a name="l01011"></a>01011 
<a name="l01012"></a>01012       <span class="comment">//Remove the creatures that are trapped underneath Tixa</span>
<a name="l01013"></a>01013       pSector = <a class="code" href="Creature_01Spreading_8cpp.html#8416712124d291c97f383014e261bb16">FindUnderGroundSector</a>( 9, 10, 2 );
<a name="l01014"></a>01014       <span class="keywordflow">if</span>( pSector )
<a name="l01015"></a>01015       {
<a name="l01016"></a>01016             pSector-&gt;<a class="code" href="structUNDERGROUND__SECTORINFO.html#1cf13c2feb769c29017a524d58ebe8c4">ubNumCreatures</a> = 0;
<a name="l01017"></a>01017       }
<a name="l01018"></a>01018 
<a name="l01019"></a>01019       <span class="comment">//Also find and nuke all creatures on any surface levels!!!</span>
<a name="l01020"></a>01020       <span class="comment">//KM: Sept 3, 1999 patch</span>
<a name="l01021"></a>01021       <span class="keywordflow">for</span>( i = 0; i &lt; 255; i++ )
<a name="l01022"></a>01022       {
<a name="l01023"></a>01023             <a class="code" href="Campaign_01Types_8h.html#d83c6f699f17a47cf6a662c91d959126">SectorInfo</a>[ i ].ubNumCreatures = 0;
<a name="l01024"></a>01024             <a class="code" href="Campaign_01Types_8h.html#d83c6f699f17a47cf6a662c91d959126">SectorInfo</a>[ i ].<a class="code" href="structSECTORINFO.html#b8faf43018235184f433698c2bf6e439">ubCreaturesInBattle</a> = 0;
<a name="l01025"></a>01025       }
<a name="l01026"></a>01026 }
<a name="l01027"></a>01027 
<a name="l01028"></a><a class="code" href="Creature_01Spreading_8h.html#b2b13a9b2015db27a16ea6aa0c0ab538">01028</a> <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> <a class="code" href="Creature_01Spreading_8cpp.html#b2b13a9b2015db27a16ea6aa0c0ab538">CreaturesInUndergroundSector</a>( <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubSectorID, <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubSectorZ )
<a name="l01029"></a>01029 {
<a name="l01030"></a>01030       <a class="code" href="structUNDERGROUND__SECTORINFO.html">UNDERGROUND_SECTORINFO</a> *pSector;
<a name="l01031"></a>01031       <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubSectorX, ubSectorY;
<a name="l01032"></a>01032       ubSectorX = (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)SECTORX( ubSectorID );
<a name="l01033"></a>01033       ubSectorY = (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)SECTORY( ubSectorID );
<a name="l01034"></a>01034       pSector = <a class="code" href="Creature_01Spreading_8cpp.html#8416712124d291c97f383014e261bb16">FindUnderGroundSector</a>( ubSectorX, ubSectorY, ubSectorZ );
<a name="l01035"></a>01035       <span class="keywordflow">if</span>( pSector )
<a name="l01036"></a>01036             <span class="keywordflow">return</span> pSector-&gt;<a class="code" href="structUNDERGROUND__SECTORINFO.html#1cf13c2feb769c29017a524d58ebe8c4">ubNumCreatures</a>;
<a name="l01037"></a>01037       <span class="keywordflow">return</span> 0;
<a name="l01038"></a>01038 }
<a name="l01039"></a>01039 
<a name="l01040"></a><a class="code" href="Creature_01Spreading_8h.html#17d018e6c7ba5e14c2272f02667170f3">01040</a> <a class="code" href="Types_8h.html#112e3146cb38b6ee95e64d85842e380a">BOOLEAN</a> <a class="code" href="Creature_01Spreading_8cpp.html#17d018e6c7ba5e14c2272f02667170f3">MineClearOfMonsters</a>( <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubMineIndex )
<a name="l01041"></a>01041 {
<a name="l01042"></a>01042       Assert( ( ubMineIndex &gt;= 0 ) &amp;&amp; ( ubMineIndex &lt; <a class="code" href="Strategic_01Mines_8h.html#a3dfb65ce3006aaab287357097352604c1e5d8fe484e44dd37bde096e12f2cf4">MAX_NUMBER_OF_MINES</a> ) );
<a name="l01043"></a>01043 
<a name="l01044"></a>01044       <span class="keywordflow">if</span>( !<a class="code" href="Creature_01Spreading_8cpp.html#9380f2e39f34095d76ba1abab44dab29">gMineStatus</a>[ ubMineIndex ].fPrevInvadedByMonsters )
<a name="l01045"></a>01045       {
<a name="l01046"></a>01046             <span class="keywordflow">switch</span>( ubMineIndex )
<a name="l01047"></a>01047             {
<a name="l01048"></a>01048                   <span class="keywordflow">case</span> <a class="code" href="Strategic_01Mines_8h.html#a3dfb65ce3006aaab287357097352604c7ee78fd3eff50eb424fd5cff44ffcf9">MINE_GRUMM</a>:
<a name="l01049"></a>01049                         <span class="keywordflow">if</span>( <a class="code" href="Creature_01Spreading_8cpp.html#b2b13a9b2015db27a16ea6aa0c0ab538">CreaturesInUndergroundSector</a>( <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643c6ced202c824aa65d9d2f53922400fa1">SEC_H3</a>, 1 ) )
<a name="l01050"></a>01050                               <span class="keywordflow">return</span> FALSE;
<a name="l01051"></a>01051                         <span class="keywordflow">if</span>( <a class="code" href="Creature_01Spreading_8cpp.html#b2b13a9b2015db27a16ea6aa0c0ab538">CreaturesInUndergroundSector</a>( <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c66026433c69f8fd7a337039e5b24166ee8ac210">SEC_I3</a>, 1 ) )
<a name="l01052"></a>01052                               <span class="keywordflow">return</span> FALSE;
<a name="l01053"></a>01053                         <span class="keywordflow">if</span>( <a class="code" href="Creature_01Spreading_8cpp.html#b2b13a9b2015db27a16ea6aa0c0ab538">CreaturesInUndergroundSector</a>( <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c66026433c69f8fd7a337039e5b24166ee8ac210">SEC_I3</a>, 2 ) )
<a name="l01054"></a>01054                               <span class="keywordflow">return</span> FALSE;
<a name="l01055"></a>01055                         <span class="keywordflow">if</span>( <a class="code" href="Creature_01Spreading_8cpp.html#b2b13a9b2015db27a16ea6aa0c0ab538">CreaturesInUndergroundSector</a>( SEC_H3, 2 ) )
<a name="l01056"></a>01056                               <span class="keywordflow">return</span> FALSE;
<a name="l01057"></a>01057                         <span class="keywordflow">if</span>( <a class="code" href="Creature_01Spreading_8cpp.html#b2b13a9b2015db27a16ea6aa0c0ab538">CreaturesInUndergroundSector</a>( <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643ba99b9a0f226090c79368e6b45295d2d">SEC_H4</a>, 2 ) )
<a name="l01058"></a>01058                               <span class="keywordflow">return</span> FALSE;
<a name="l01059"></a>01059                         <span class="keywordflow">break</span>;
<a name="l01060"></a>01060                   <span class="keywordflow">case</span> <a class="code" href="Strategic_01Mines_8h.html#a3dfb65ce3006aaab287357097352604a3e0b1f58c32fa6fac0c08f2b4d376ee">MINE_CAMBRIA</a>:
<a name="l01061"></a>01061                         <span class="keywordflow">if</span>( <a class="code" href="Creature_01Spreading_8cpp.html#b2b13a9b2015db27a16ea6aa0c0ab538">CreaturesInUndergroundSector</a>( <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643897f1cfaae4b38d8022feec3521887df">SEC_H8</a>, 1 ) )
<a name="l01062"></a>01062                               <span class="keywordflow">return</span> FALSE;
<a name="l01063"></a>01063                         <span class="keywordflow">if</span>( <a class="code" href="Creature_01Spreading_8cpp.html#b2b13a9b2015db27a16ea6aa0c0ab538">CreaturesInUndergroundSector</a>( <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c660264374355821705df24bff50e8d681dce273">SEC_H9</a>, 1 ) )
<a name="l01064"></a>01064                               <span class="keywordflow">return</span> FALSE;
<a name="l01065"></a>01065                         <span class="keywordflow">break</span>;
<a name="l01066"></a>01066                   <span class="keywordflow">case</span> <a class="code" href="Strategic_01Mines_8h.html#a3dfb65ce3006aaab2873570973526041b10b0e5419209512e09528eaac0b2d8">MINE_ALMA</a>:
<a name="l01067"></a>01067                         <span class="keywordflow">if</span>( <a class="code" href="Creature_01Spreading_8cpp.html#b2b13a9b2015db27a16ea6aa0c0ab538">CreaturesInUndergroundSector</a>( <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643c236a562a9b38d2ee3c7d7ed06e88faf">SEC_I14</a>, 1 ) )
<a name="l01068"></a>01068                               <span class="keywordflow">return</span> FALSE;
<a name="l01069"></a>01069                         <span class="keywordflow">if</span>( <a class="code" href="Creature_01Spreading_8cpp.html#b2b13a9b2015db27a16ea6aa0c0ab538">CreaturesInUndergroundSector</a>( <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643a05c7598f53eec8740a10141c850d547">SEC_J14</a>, 1 ) )
<a name="l01070"></a>01070                               <span class="keywordflow">return</span> FALSE;
<a name="l01071"></a>01071                         <span class="keywordflow">break</span>;
<a name="l01072"></a>01072                   <span class="keywordflow">case</span> <a class="code" href="Strategic_01Mines_8h.html#a3dfb65ce3006aaab2873570973526047f551893f781b71159ee466c6e042fdf">MINE_DRASSEN</a>:
<a name="l01073"></a>01073                         <span class="keywordflow">if</span>( <a class="code" href="Creature_01Spreading_8cpp.html#b2b13a9b2015db27a16ea6aa0c0ab538">CreaturesInUndergroundSector</a>( <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c66026435b0fbd8598540769dcf8f24e3134f48c">SEC_D13</a>, 1 ) )
<a name="l01074"></a>01074                               <span class="keywordflow">return</span> FALSE;
<a name="l01075"></a>01075                         <span class="keywordflow">if</span>( <a class="code" href="Creature_01Spreading_8cpp.html#b2b13a9b2015db27a16ea6aa0c0ab538">CreaturesInUndergroundSector</a>( <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c660264379208189c749fece42d995546ebdb1dc">SEC_E13</a>, 1 ) )
<a name="l01076"></a>01076                               <span class="keywordflow">return</span> FALSE;
<a name="l01077"></a>01077                         <span class="keywordflow">break</span>;
<a name="l01078"></a>01078                   <span class="keywordflow">case</span> <a class="code" href="Strategic_01Mines_8h.html#a3dfb65ce3006aaab28735709735260454b82376c4cc451433076d3d314938c5">MINE_CHITZENA</a>:
<a name="l01079"></a>01079                   <span class="keywordflow">case</span> <a class="code" href="Strategic_01Mines_8h.html#a3dfb65ce3006aaab287357097352604e81d998794b380afdcefe28c965cd53a">MINE_SAN_MONA</a>:
<a name="l01080"></a>01080                         <span class="comment">// these are never attacked</span>
<a name="l01081"></a>01081                         <span class="keywordflow">break</span>;
<a name="l01082"></a>01082 
<a name="l01083"></a>01083                   <span class="keywordflow">default</span>:
<a name="l01084"></a>01084 <span class="preprocessor">                        #ifdef JA2BETAVERSION</span>
<a name="l01085"></a>01085 <span class="preprocessor"></span>                              <a class="code" href="message_8cpp.html#818e47bc59bd5a5755f06ec51cd74928">ScreenMsg</a>( FONT_RED, MSG_ERROR, L<span class="stringliteral">"Attempting to check if mine is clear but mine index is invalid (%d)."</span>, ubMineIndex );
<a name="l01086"></a>01086 <span class="preprocessor">                        #endif</span>
<a name="l01087"></a>01087 <span class="preprocessor"></span>                        <span class="keywordflow">break</span>;
<a name="l01088"></a>01088             }
<a name="l01089"></a>01089       }
<a name="l01090"></a>01090       <span class="keywordflow">else</span>
<a name="l01091"></a>01091       { <span class="comment">//mine was previously invaded by creatures.  Don't allow mine production until queen is dead.</span>
<a name="l01092"></a>01092             <span class="keywordflow">if</span>( <a class="code" href="Creature_01Spreading_8cpp.html#b9d0d6cd30a304c1dba1c41a5312c190">giLairID</a> != -1 )
<a name="l01093"></a>01093             {
<a name="l01094"></a>01094                   <span class="keywordflow">return</span> FALSE;
<a name="l01095"></a>01095             }
<a name="l01096"></a>01096       }
<a name="l01097"></a>01097       <span class="keywordflow">return</span> TRUE;
<a name="l01098"></a>01098 }
<a name="l01099"></a>01099 
<a name="l01100"></a><a class="code" href="Creature_01Spreading_8h.html#e6a1f80156b376d242c3e5ae1a24ad17">01100</a> <span class="keywordtype">void</span> <a class="code" href="Creature_01Spreading_8cpp.html#e6a1f80156b376d242c3e5ae1a24ad17">DetermineCreatureTownComposition</a>( <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubNumCreatures, 
<a name="l01101"></a>01101                                                                                                                    <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> *pubNumYoungMales, <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> *pubNumYoungFemales,
<a name="l01102"></a>01102                                                                                                                    <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> *pubNumAdultMales, <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> *pubNumAdultFemales )
<a name="l01103"></a>01103 {
<a name="l01104"></a>01104       <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a> i, iRandom;
<a name="l01105"></a>01105       <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubYoungMalePercentage = 10;
<a name="l01106"></a>01106       <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubYoungFemalePercentage = 65;
<a name="l01107"></a>01107       <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubAdultMalePercentage = 5;
<a name="l01108"></a>01108       <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubAdultFemalePercentage = 20;
<a name="l01109"></a>01109       
<a name="l01110"></a>01110       <span class="comment">//First step is to convert the percentages into the numbers we will use.</span>
<a name="l01111"></a>01111       ubYoungFemalePercentage += ubYoungMalePercentage;
<a name="l01112"></a>01112       ubAdultMalePercentage += ubYoungFemalePercentage;
<a name="l01113"></a>01113       ubAdultFemalePercentage += ubAdultMalePercentage;
<a name="l01114"></a>01114       <span class="keywordflow">if</span>( ubAdultFemalePercentage != 100 )
<a name="l01115"></a>01115       {
<a name="l01116"></a>01116             AssertMsg( 0, <span class="stringliteral">"Percentage for adding creatures don't add up to 100."</span> );
<a name="l01117"></a>01117       }
<a name="l01118"></a>01118       <span class="comment">//Second step is to determine the breakdown of the creatures randomly.</span>
<a name="l01119"></a>01119       i = ubNumCreatures;
<a name="l01120"></a>01120       <span class="keywordflow">while</span>( i-- )
<a name="l01121"></a>01121       {
<a name="l01122"></a>01122             iRandom = <a class="code" href="Random_8cpp.html#49f938d1313ab6ef09ac6223a16ac334">Random</a>( 100 );
<a name="l01123"></a>01123             <span class="keywordflow">if</span>( iRandom &lt; ubYoungMalePercentage )
<a name="l01124"></a>01124                   (*pubNumYoungMales)++;
<a name="l01125"></a>01125             <span class="keywordflow">else</span> <span class="keywordflow">if</span>( iRandom &lt; ubYoungFemalePercentage )
<a name="l01126"></a>01126                   (*pubNumYoungFemales)++;
<a name="l01127"></a>01127             <span class="keywordflow">else</span> <span class="keywordflow">if</span>( iRandom &lt; ubAdultMalePercentage )
<a name="l01128"></a>01128                   (*pubNumAdultMales)++;
<a name="l01129"></a>01129             <span class="keywordflow">else</span>
<a name="l01130"></a>01130                   (*pubNumAdultFemales)++;
<a name="l01131"></a>01131       }
<a name="l01132"></a>01132 }
<a name="l01133"></a>01133 
<a name="l01134"></a><a class="code" href="Creature_01Spreading_8h.html#1749b09ac46cd289c2f32f4baf24d2a7">01134</a> <span class="keywordtype">void</span> <a class="code" href="Creature_01Spreading_8cpp.html#1749b09ac46cd289c2f32f4baf24d2a7">DetermineCreatureTownCompositionBasedOnTacticalInformation</a>( <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> *pubNumCreatures, 
<a name="l01135"></a>01135                                                                                                                    <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> *pubNumYoungMales, <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> *pubNumYoungFemales,
<a name="l01136"></a>01136                                                                                                                    <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> *pubNumAdultMales, <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> *pubNumAdultFemales )
<a name="l01137"></a>01137 {
<a name="l01138"></a>01138       <a class="code" href="structSECTORINFO.html">SECTORINFO</a> *pSector;
<a name="l01139"></a>01139       <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a> i;
<a name="l01140"></a>01140       <a class="code" href="structSOLDIERTYPE.html">SOLDIERTYPE</a> *<a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>;
<a name="l01141"></a>01141 
<a name="l01142"></a>01142       pSector = &amp;<a class="code" href="Campaign_01Types_8h.html#d83c6f699f17a47cf6a662c91d959126">SectorInfo</a>[ SECTOR( <a class="code" href="strategicmap_8cpp.html#49d9aed144a633fda4ba1990f002d703">gWorldSectorX</a>, <a class="code" href="strategicmap_8cpp.html#ea322310ced0e35ee18a2ee7b32aac5b">gWorldSectorY</a> ) ];
<a name="l01143"></a>01143       *pubNumCreatures = 0;
<a name="l01144"></a>01144       pSector-&gt;<a class="code" href="structSECTORINFO.html#0125eb261146326531514ee40fa73875">ubNumCreatures</a> = 0;
<a name="l01145"></a>01145       pSector-&gt;<a class="code" href="structSECTORINFO.html#b8faf43018235184f433698c2bf6e439">ubCreaturesInBattle</a> = 0;
<a name="l01146"></a>01146       <span class="keywordflow">for</span>( i = <a class="code" href="Overhead_8cpp.html#46bd754f8875c305ab18731ed10e3364">gTacticalStatus</a>.<a class="code" href="structTacticalStatusType.html#2ecddfe580bb019bc92cc4859eaf3edc">Team</a>[ CREATURE_TEAM ].<a class="code" href="structTacticalTeamType.html#f8fe819ad07b242f5dbf97fd4c69b00d">bFirstID</a>; i &lt;= <a class="code" href="Overhead_8cpp.html#46bd754f8875c305ab18731ed10e3364">gTacticalStatus</a>.<a class="code" href="structTacticalStatusType.html#2ecddfe580bb019bc92cc4859eaf3edc">Team</a>[ CREATURE_TEAM ].<a class="code" href="structTacticalTeamType.html#6a887279dad735dc302f21c1e559d5ce">bLastID</a>; i++ )
<a name="l01147"></a>01147       {
<a name="l01148"></a>01148             <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a> = <a class="code" href="Overhead_8cpp.html#2b9a828d7d92ec404b2f9a39fc001177">MercPtrs</a>[ i ];
<a name="l01149"></a>01149             <span class="keywordflow">if</span>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#653dad4e2520784e293eca9f948b8532">bActive</a> &amp;&amp; <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#b0096f321a0de4f0617283f7b3212aa0">bInSector</a> &amp;&amp; <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#e308dea18533bf5ab2bcee5bbe27391c">bLife</a> )
<a name="l01150"></a>01150             {
<a name="l01151"></a>01151                   <span class="keywordflow">switch</span>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#b082364eed3d7883662f69e1fd96be1a">ubBodyType</a> )
<a name="l01152"></a>01152                   {
<a name="l01153"></a>01153                         <span class="keywordflow">case</span> <a class="code" href="Animation_01Data_8h.html#d295a916825180b548473dec560093a78e8f2de8ab141e991ee2b34ebb1dfda1">ADULTFEMALEMONSTER</a>:
<a name="l01154"></a>01154                               (*pubNumCreatures)++;
<a name="l01155"></a>01155                               (*pubNumAdultFemales)++;
<a name="l01156"></a>01156                               <span class="keywordflow">break</span>;
<a name="l01157"></a>01157                         <span class="keywordflow">case</span> <a class="code" href="Animation_01Data_8h.html#d295a916825180b548473dec560093a79dec21a470d88f8b8a8704cb9b5ac827">AM_MONSTER</a>:
<a name="l01158"></a>01158                               (*pubNumCreatures)++;
<a name="l01159"></a>01159                               (*pubNumAdultMales)++;
<a name="l01160"></a>01160                               <span class="keywordflow">break</span>;
<a name="l01161"></a>01161                         <span class="keywordflow">case</span> <a class="code" href="Animation_01Data_8h.html#d295a916825180b548473dec560093a75f60be3c60e156d8cec34802d7f3607b">YAF_MONSTER</a>:
<a name="l01162"></a>01162                               (*pubNumCreatures)++;
<a name="l01163"></a>01163                               (*pubNumYoungFemales)++;
<a name="l01164"></a>01164                               <span class="keywordflow">break</span>;
<a name="l01165"></a>01165                         <span class="keywordflow">case</span> <a class="code" href="Animation_01Data_8h.html#d295a916825180b548473dec560093a725460f03079c143c4456f779763fa23b">YAM_MONSTER</a>:
<a name="l01166"></a>01166                               (*pubNumCreatures)++;
<a name="l01167"></a>01167                               (*pubNumYoungMales)++;
<a name="l01168"></a>01168                               <span class="keywordflow">break</span>;
<a name="l01169"></a>01169                   }
<a name="l01170"></a>01170             }
<a name="l01171"></a>01171       }
<a name="l01172"></a>01172 }
<a name="l01173"></a>01173 
<a name="l01174"></a>01174 
<a name="l01175"></a>01175 
<a name="l01176"></a><a class="code" href="Creature_01Spreading_8h.html#34177bd8648086123b70108eb97c7b91">01176</a> <a class="code" href="Types_8h.html#112e3146cb38b6ee95e64d85842e380a">BOOLEAN</a> <a class="code" href="Creature_01Spreading_8cpp.html#34177bd8648086123b70108eb97c7b91">PrepareCreaturesForBattle</a>()
<a name="l01177"></a>01177 {
<a name="l01178"></a>01178       <a class="code" href="structUNDERGROUND__SECTORINFO.html">UNDERGROUND_SECTORINFO</a> *pSector;
<a name="l01179"></a>01179       <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a> i, iRandom;
<a name="l01180"></a>01180       <a class="code" href="structtagSGPPaletteEntry.html">SGPPaletteEntry</a>   LColors[3];
<a name="l01181"></a>01181       <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubNumColors;
<a name="l01182"></a>01182       <a class="code" href="Types_8h.html#112e3146cb38b6ee95e64d85842e380a">BOOLEAN</a> fQueen;
<a name="l01183"></a>01183       <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubLarvaePercentage;
<a name="l01184"></a>01184       <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubInfantPercentage;
<a name="l01185"></a>01185       <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubYoungMalePercentage;
<a name="l01186"></a>01186       <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubYoungFemalePercentage;
<a name="l01187"></a>01187       <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubAdultMalePercentage;
<a name="l01188"></a>01188       <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubAdultFemalePercentage;
<a name="l01189"></a>01189       <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubCreatureHabitat;
<a name="l01190"></a>01190       <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubNumLarvae = 0;
<a name="l01191"></a>01191       <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubNumInfants = 0;
<a name="l01192"></a>01192       <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubNumYoungMales = 0;
<a name="l01193"></a>01193       <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubNumYoungFemales = 0;
<a name="l01194"></a>01194       <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubNumAdultMales = 0;
<a name="l01195"></a>01195       <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubNumAdultFemales = 0;
<a name="l01196"></a>01196       <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubPercentage = 0;
<a name="l01197"></a>01197       <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubNumCreatures;
<a name="l01198"></a>01198 
<a name="l01199"></a>01199       <span class="keywordflow">if</span>( !<a class="code" href="Creature_01Spreading_8cpp.html#b6b4580c49857ec8823250aae0b26aba">gubCreatureBattleCode</a> )
<a name="l01200"></a>01200       {
<a name="l01201"></a>01201             ubNumColors = <a class="code" href="lighting_8cpp.html#79e6327c40974d28885deecdbb85139a">LightGetColors</a>( LColors );
<a name="l01202"></a>01202             <span class="comment">//if( ubNumColors != 1 )</span>
<a name="l01203"></a>01203             <span class="comment">//    ScreenMsg( FONT_RED, MSG_ERROR, L"This map has more than one light color -- KM, LC : 1" );</span>
<a name="l01204"></a>01204 
<a name="l01205"></a>01205             <span class="comment">//By default, we only play creature music in the cave levels (the creature levels all consistently</span>
<a name="l01206"></a>01206             <span class="comment">//have blue lights while human occupied mines have red lights.  We always play creature music</span>
<a name="l01207"></a>01207             <span class="comment">//when creatures are in the level.</span>
<a name="l01208"></a>01208             <span class="keywordflow">if</span>( LColors-&gt;<a class="code" href="structtagSGPPaletteEntry.html#57cf9f2ed2fac27904c5646af85d3b40">peBlue</a> )
<a name="l01209"></a>01209                   <a class="code" href="Creature_01Spreading_8cpp.html#4605b946d86cc2c09fc6e765b9c89e7c">gfUseCreatureMusic</a> = TRUE;
<a name="l01210"></a>01210             <span class="keywordflow">else</span>
<a name="l01211"></a>01211                   <a class="code" href="Creature_01Spreading_8cpp.html#4605b946d86cc2c09fc6e765b9c89e7c">gfUseCreatureMusic</a> = FALSE;
<a name="l01212"></a>01212 
<a name="l01213"></a>01213             <span class="keywordflow">if</span>( !<a class="code" href="strategicmap_8cpp.html#da715721a8ceedd42acf6ddb33e63ce0">gbWorldSectorZ</a> )
<a name="l01214"></a>01214                   <span class="keywordflow">return</span> FALSE;  <span class="comment">//Creatures don't attack overworld with this battle code.</span>
<a name="l01215"></a>01215             pSector = <a class="code" href="Creature_01Spreading_8cpp.html#8416712124d291c97f383014e261bb16">FindUnderGroundSector</a>( <a class="code" href="strategicmap_8cpp.html#49d9aed144a633fda4ba1990f002d703">gWorldSectorX</a>, <a class="code" href="strategicmap_8cpp.html#ea322310ced0e35ee18a2ee7b32aac5b">gWorldSectorY</a>, <a class="code" href="strategicmap_8cpp.html#da715721a8ceedd42acf6ddb33e63ce0">gbWorldSectorZ</a> );
<a name="l01216"></a>01216             <span class="keywordflow">if</span>( !pSector )
<a name="l01217"></a>01217             {
<a name="l01218"></a>01218                   <span class="keywordflow">return</span> FALSE;
<a name="l01219"></a>01219             }
<a name="l01220"></a>01220             <span class="keywordflow">if</span>( !pSector-&gt;<a class="code" href="structUNDERGROUND__SECTORINFO.html#1cf13c2feb769c29017a524d58ebe8c4">ubNumCreatures</a> )
<a name="l01221"></a>01221             {
<a name="l01222"></a>01222                   <span class="keywordflow">return</span> FALSE;
<a name="l01223"></a>01223             }
<a name="l01224"></a>01224             <a class="code" href="Creature_01Spreading_8cpp.html#4605b946d86cc2c09fc6e765b9c89e7c">gfUseCreatureMusic</a> = TRUE; <span class="comment">//creatures are here, so play creature music</span>
<a name="l01225"></a>01225             ubCreatureHabitat = pSector-&gt;<a class="code" href="structUNDERGROUND__SECTORINFO.html#f311bb8900c816d69dd6bebf904b5b29">ubCreatureHabitat</a>;
<a name="l01226"></a>01226             ubNumCreatures = pSector-&gt;<a class="code" href="structUNDERGROUND__SECTORINFO.html#1cf13c2feb769c29017a524d58ebe8c4">ubNumCreatures</a>;
<a name="l01227"></a>01227       }
<a name="l01228"></a>01228       <span class="keywordflow">else</span>
<a name="l01229"></a>01229       { <span class="comment">//creatures are attacking a town sector</span>
<a name="l01230"></a>01230             <a class="code" href="Creature_01Spreading_8cpp.html#4605b946d86cc2c09fc6e765b9c89e7c">gfUseCreatureMusic</a> = TRUE;
<a name="l01231"></a>01231             <a class="code" href="Music_01Control_8cpp.html#6048469cd3be966558a4ba87cbbf41ef">SetMusicMode</a>( <a class="code" href="Music_01Control_8h.html#537bb0477379f935f13aee9969289d1f6c8b61de03b4ca1994b0ee9c8d99b0e1">MUSIC_TACTICAL_NOTHING</a> );
<a name="l01232"></a>01232             ubCreatureHabitat = <a class="code" href="Creature_01Spreading_8cpp.html#188c132f478fb544e0213ea0020585bc0a79da9c3e34dedd3f6ff49262678e07">MINE_EXIT</a>;
<a name="l01233"></a>01233             ubNumCreatures = <a class="code" href="Creature_01Spreading_8cpp.html#f234c8f6543322a61901fd234e431951">gubNumCreaturesAttackingTown</a>;
<a name="l01234"></a>01234       }
<a name="l01235"></a>01235 
<a name="l01236"></a>01236       <span class="keywordflow">switch</span>( ubCreatureHabitat )
<a name="l01237"></a>01237       {
<a name="l01238"></a>01238             <span class="keywordflow">case</span> <a class="code" href="Creature_01Spreading_8cpp.html#188c132f478fb544e0213ea0020585bcc593579d35b0f087c8b9a39b34ad705d">QUEEN_LAIR</a>: 
<a name="l01239"></a>01239                   fQueen = TRUE;
<a name="l01240"></a>01240                   ubLarvaePercentage = 20;
<a name="l01241"></a>01241                   ubInfantPercentage = 40;
<a name="l01242"></a>01242                   ubYoungMalePercentage = 0;
<a name="l01243"></a>01243                   ubYoungFemalePercentage = 0;
<a name="l01244"></a>01244                   ubAdultMalePercentage = 30;
<a name="l01245"></a>01245                   ubAdultFemalePercentage = 10;
<a name="l01246"></a>01246                   <span class="keywordflow">break</span>;
<a name="l01247"></a>01247             <span class="keywordflow">case</span> <a class="code" href="Creature_01Spreading_8cpp.html#188c132f478fb544e0213ea0020585bc2ac8ec47e8b8e49969e0cf9c580654cf">LAIR</a>: 
<a name="l01248"></a>01248                   fQueen = FALSE;
<a name="l01249"></a>01249                   ubLarvaePercentage = 15;
<a name="l01250"></a>01250                   ubInfantPercentage = 35;
<a name="l01251"></a>01251                   ubYoungMalePercentage = 10;
<a name="l01252"></a>01252                   ubYoungFemalePercentage = 5;
<a name="l01253"></a>01253                   ubAdultMalePercentage = 25;
<a name="l01254"></a>01254                   ubAdultFemalePercentage = 10;
<a name="l01255"></a>01255                   <span class="keywordflow">break</span>;
<a name="l01256"></a>01256             <span class="keywordflow">case</span> <a class="code" href="Creature_01Spreading_8cpp.html#188c132f478fb544e0213ea0020585bc2ac5fa94536136286b813ffa4a2aec1e">LAIR_ENTRANCE</a>: 
<a name="l01257"></a>01257                   fQueen = FALSE;
<a name="l01258"></a>01258                   ubLarvaePercentage = 0;
<a name="l01259"></a>01259                   ubInfantPercentage = 15;
<a name="l01260"></a>01260                   ubYoungMalePercentage = 30;
<a name="l01261"></a>01261                   ubYoungFemalePercentage = 10;
<a name="l01262"></a>01262                   ubAdultMalePercentage = 35;
<a name="l01263"></a>01263                   ubAdultFemalePercentage = 10;
<a name="l01264"></a>01264                   <span class="keywordflow">break</span>;
<a name="l01265"></a>01265             <span class="keywordflow">case</span> <a class="code" href="Creature_01Spreading_8cpp.html#188c132f478fb544e0213ea0020585bc8cb8d444f6fa92714c918fd7a1e8a00d">INNER_MINE</a>: 
<a name="l01266"></a>01266                   fQueen = FALSE;
<a name="l01267"></a>01267                   ubLarvaePercentage = 0;
<a name="l01268"></a>01268                   ubInfantPercentage = 0;
<a name="l01269"></a>01269                   ubYoungMalePercentage = 20;
<a name="l01270"></a>01270                   ubYoungFemalePercentage = 40;
<a name="l01271"></a>01271                   ubAdultMalePercentage = 10;
<a name="l01272"></a>01272                   ubAdultFemalePercentage = 30;
<a name="l01273"></a>01273                   <span class="keywordflow">break</span>;
<a name="l01274"></a>01274             <span class="keywordflow">case</span> <a class="code" href="Creature_01Spreading_8cpp.html#188c132f478fb544e0213ea0020585bc0252708b8e3dd2a2b5feb404649f1a59">OUTER_MINE</a>: 
<a name="l01275"></a>01275             <span class="keywordflow">case</span> <a class="code" href="Creature_01Spreading_8cpp.html#188c132f478fb544e0213ea0020585bc0a79da9c3e34dedd3f6ff49262678e07">MINE_EXIT</a>:   
<a name="l01276"></a>01276                   fQueen = FALSE;
<a name="l01277"></a>01277                   ubLarvaePercentage = 0;
<a name="l01278"></a>01278                   ubInfantPercentage = 0;
<a name="l01279"></a>01279                   ubYoungMalePercentage = 10;
<a name="l01280"></a>01280                   ubYoungFemalePercentage = 65;
<a name="l01281"></a>01281                   ubAdultMalePercentage = 5;
<a name="l01282"></a>01282                   ubAdultFemalePercentage = 20;
<a name="l01283"></a>01283                   <span class="keywordflow">break</span>;
<a name="l01284"></a>01284             <span class="keywordflow">default</span>:
<a name="l01285"></a>01285 <span class="preprocessor">                  #ifdef JA2BETAVERSION</span>
<a name="l01286"></a>01286 <span class="preprocessor"></span>                        <a class="code" href="message_8cpp.html#818e47bc59bd5a5755f06ec51cd74928">ScreenMsg</a>( FONT_RED, MSG_ERROR, L<span class="stringliteral">"Invalid creature habitat ID of %d for PrepareCreaturesForBattle.  Ignoring..."</span>, ubCreatureHabitat );
<a name="l01287"></a>01287 <span class="preprocessor">                  #endif</span>
<a name="l01288"></a>01288 <span class="preprocessor"></span>                  <span class="keywordflow">return</span> FALSE;
<a name="l01289"></a>01289       }
<a name="l01290"></a>01290       
<a name="l01291"></a>01291       <span class="comment">//First step is to convert the percentages into the numbers we will use.</span>
<a name="l01292"></a>01292       <span class="keywordflow">if</span>( fQueen )
<a name="l01293"></a>01293       {
<a name="l01294"></a>01294             ubNumCreatures--;
<a name="l01295"></a>01295       }
<a name="l01296"></a>01296       ubInfantPercentage += ubLarvaePercentage;
<a name="l01297"></a>01297       ubYoungMalePercentage += ubInfantPercentage;
<a name="l01298"></a>01298       ubYoungFemalePercentage += ubYoungMalePercentage;
<a name="l01299"></a>01299       ubAdultMalePercentage += ubYoungFemalePercentage;
<a name="l01300"></a>01300       ubAdultFemalePercentage += ubAdultMalePercentage;
<a name="l01301"></a>01301       <span class="keywordflow">if</span>( ubAdultFemalePercentage != 100 )
<a name="l01302"></a>01302       {
<a name="l01303"></a>01303             AssertMsg( 0, <span class="stringliteral">"Percentage for adding creatures don't add up to 100."</span> );
<a name="l01304"></a>01304       }
<a name="l01305"></a>01305       <span class="comment">//Second step is to determine the breakdown of the creatures randomly.</span>
<a name="l01306"></a>01306       i = ubNumCreatures;
<a name="l01307"></a>01307       <span class="keywordflow">while</span>( i-- )
<a name="l01308"></a>01308       {
<a name="l01309"></a>01309             iRandom = <a class="code" href="Random_8cpp.html#49f938d1313ab6ef09ac6223a16ac334">Random</a>( 100 );
<a name="l01310"></a>01310             <span class="keywordflow">if</span>( iRandom &lt; ubLarvaePercentage )
<a name="l01311"></a>01311                   ubNumLarvae++;
<a name="l01312"></a>01312             <span class="keywordflow">else</span> <span class="keywordflow">if</span>( iRandom &lt; ubInfantPercentage )
<a name="l01313"></a>01313                   ubNumInfants++;
<a name="l01314"></a>01314             <span class="keywordflow">else</span> <span class="keywordflow">if</span>( iRandom &lt; ubYoungMalePercentage )
<a name="l01315"></a>01315                   ubNumYoungMales++;
<a name="l01316"></a>01316             <span class="keywordflow">else</span> <span class="keywordflow">if</span>( iRandom &lt; ubYoungFemalePercentage )
<a name="l01317"></a>01317                   ubNumYoungFemales++;
<a name="l01318"></a>01318             <span class="keywordflow">else</span> <span class="keywordflow">if</span>( iRandom &lt; ubAdultMalePercentage )
<a name="l01319"></a>01319                   ubNumAdultMales++;
<a name="l01320"></a>01320             <span class="keywordflow">else</span>
<a name="l01321"></a>01321                   ubNumAdultFemales++;
<a name="l01322"></a>01322       }
<a name="l01323"></a>01323 
<a name="l01324"></a>01324       <span class="keywordflow">if</span>( <a class="code" href="strategicmap_8cpp.html#da715721a8ceedd42acf6ddb33e63ce0">gbWorldSectorZ</a> )
<a name="l01325"></a>01325       {
<a name="l01326"></a>01326             <a class="code" href="structUNDERGROUND__SECTORINFO.html">UNDERGROUND_SECTORINFO</a> *pUndergroundSector;
<a name="l01327"></a>01327             pUndergroundSector = <a class="code" href="Creature_01Spreading_8cpp.html#8416712124d291c97f383014e261bb16">FindUnderGroundSector</a>( <a class="code" href="strategicmap_8cpp.html#49d9aed144a633fda4ba1990f002d703">gWorldSectorX</a>, <a class="code" href="strategicmap_8cpp.html#ea322310ced0e35ee18a2ee7b32aac5b">gWorldSectorY</a>, <a class="code" href="strategicmap_8cpp.html#da715721a8ceedd42acf6ddb33e63ce0">gbWorldSectorZ</a> );
<a name="l01328"></a>01328             <span class="keywordflow">if</span>( !pUndergroundSector )
<a name="l01329"></a>01329             { <span class="comment">//No info?!!!!!</span>
<a name="l01330"></a>01330                   AssertMsg( 0, <span class="stringliteral">"Please report underground sector you are in or going to and send save if possible.  KM : 0"</span> );
<a name="l01331"></a>01331                   <span class="keywordflow">return</span> FALSE;
<a name="l01332"></a>01332             }
<a name="l01333"></a>01333             pUndergroundSector-&gt;<a class="code" href="structUNDERGROUND__SECTORINFO.html#af68b9e54e383bae939f566572b52ac5">ubCreaturesInBattle</a> = pUndergroundSector-&gt;<a class="code" href="structUNDERGROUND__SECTORINFO.html#1cf13c2feb769c29017a524d58ebe8c4">ubNumCreatures</a>;
<a name="l01334"></a>01334       }
<a name="l01335"></a>01335       <span class="keywordflow">else</span>
<a name="l01336"></a>01336       {
<a name="l01337"></a>01337             <a class="code" href="structSECTORINFO.html">SECTORINFO</a> *pSector;
<a name="l01338"></a>01338             pSector = &amp;<a class="code" href="Campaign_01Types_8h.html#d83c6f699f17a47cf6a662c91d959126">SectorInfo</a>[ SECTOR( <a class="code" href="strategicmap_8cpp.html#49d9aed144a633fda4ba1990f002d703">gWorldSectorX</a>, <a class="code" href="strategicmap_8cpp.html#ea322310ced0e35ee18a2ee7b32aac5b">gWorldSectorY</a> ) ];
<a name="l01339"></a>01339             pSector-&gt;<a class="code" href="structSECTORINFO.html#0125eb261146326531514ee40fa73875">ubNumCreatures</a> = ubNumCreatures;
<a name="l01340"></a>01340             pSector-&gt;<a class="code" href="structSECTORINFO.html#b8faf43018235184f433698c2bf6e439">ubCreaturesInBattle</a> = ubNumCreatures;
<a name="l01341"></a>01341       }
<a name="l01342"></a>01342 
<a name="l01343"></a>01343       <span class="keywordflow">switch</span>( <a class="code" href="Creature_01Spreading_8cpp.html#b6b4580c49857ec8823250aae0b26aba">gubCreatureBattleCode</a> )
<a name="l01344"></a>01344       {
<a name="l01345"></a>01345             <span class="keywordflow">case</span> <a class="code" href="Creature_01Spreading_8h.html#d4a9934b75947f1fae21deee31688bb7c5bf5e7c9e8282a9d074fdaa8157d347">CREATURE_BATTLE_CODE_NONE</a>: <span class="comment">//in the mines</span>
<a name="l01346"></a>01346                   <a class="code" href="Soldier_01Init_01List_8cpp.html#f22b98d511f4f0d2d10b7ef75979c143">AddSoldierInitListCreatures</a>( fQueen, ubNumLarvae, ubNumInfants,   
<a name="l01347"></a>01347                         ubNumYoungMales, ubNumYoungFemales, ubNumAdultMales, ubNumAdultFemales );
<a name="l01348"></a>01348                   <span class="keywordflow">break</span>;
<a name="l01349"></a>01349             <span class="keywordflow">case</span> <a class="code" href="Creature_01Spreading_8h.html#d4a9934b75947f1fae21deee31688bb7a5f74fa804901139aeea8467bcce900c">CREATURE_BATTLE_CODE_TACTICALLYADD</a>: <span class="comment">//creature attacking a town sector</span>
<a name="l01350"></a>01350             <span class="keywordflow">case</span> <a class="code" href="Creature_01Spreading_8h.html#d4a9934b75947f1fae21deee31688bb7c0ff93114a1c62ffb2446852a219c799">CREATURE_BATTLE_CODE_PREBATTLEINTERFACE</a>:
<a name="l01351"></a>01351                   <a class="code" href="Creature_01Spreading_8cpp.html#d26b0aa77231d54c661ebe0daeebe1d1">AddCreaturesToBattle</a>( ubNumYoungMales, ubNumYoungFemales, ubNumAdultMales, ubNumAdultFemales );
<a name="l01352"></a>01352                   <span class="keywordflow">break</span>;
<a name="l01353"></a>01353             <span class="keywordflow">case</span> <a class="code" href="Creature_01Spreading_8h.html#d4a9934b75947f1fae21deee31688bb7629c91b3df8b6ff30ad39d9cbd76c4da">CREATURE_BATTLE_CODE_AUTORESOLVE</a>:
<a name="l01354"></a>01354                   <span class="keywordflow">return</span> FALSE;
<a name="l01355"></a>01355       }
<a name="l01356"></a>01356       <span class="keywordflow">return</span> TRUE;
<a name="l01357"></a>01357 }
<a name="l01358"></a>01358 
<a name="l01359"></a><a class="code" href="Creature_01Spreading_8h.html#b3d460f3f31cfd0fa35271cec76a5057">01359</a> <span class="keywordtype">void</span> <a class="code" href="Creature_01Spreading_8cpp.html#b3d460f3f31cfd0fa35271cec76a5057">CreatureNightPlanning</a>()
<a name="l01360"></a>01360 { <span class="comment">//Check the populations of the mine exits, and factor a chance for them to attack at night.</span>
<a name="l01361"></a>01361       <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubNumCreatures;
<a name="l01362"></a>01362       ubNumCreatures = <a class="code" href="Creature_01Spreading_8cpp.html#b2b13a9b2015db27a16ea6aa0c0ab538">CreaturesInUndergroundSector</a>( <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643c6ced202c824aa65d9d2f53922400fa1">SEC_H3</a>, 1 );
<a name="l01363"></a>01363       <span class="keywordflow">if</span>( ubNumCreatures &gt; 1 &amp;&amp; ubNumCreatures * 10 &gt; (<a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a>)<a class="code" href="Random_8cpp.html#ca9f12606e77e67e4a79ee8ec0cba956">PreRandom</a>( 100 ) )
<a name="l01364"></a>01364       { <span class="comment">//10% chance for each creature to decide it's time to attack.</span>
<a name="l01365"></a>01365             <a class="code" href="Game_01Event_01Hook_8h.html#d0da2cc582f16f4f54f328db96d7ca56">AddStrategicEvent</a>( <a class="code" href="Game_01Event_01Hook_8h.html#08f51f22ad2ed13a25181c260457311045c2adfea062cdbcf6a48276c30dd162">EVENT_CREATURE_ATTACK</a>, <a class="code" href="Game_01Clock_8cpp.html#4d255e800fba4d64144a7639d5f3421d">GetWorldTotalMin</a>() + 1 + <a class="code" href="Random_8cpp.html#ca9f12606e77e67e4a79ee8ec0cba956">PreRandom</a>( 429 ), <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643c6ced202c824aa65d9d2f53922400fa1">SEC_H3</a> );
<a name="l01366"></a>01366       }
<a name="l01367"></a>01367       ubNumCreatures = <a class="code" href="Creature_01Spreading_8cpp.html#b2b13a9b2015db27a16ea6aa0c0ab538">CreaturesInUndergroundSector</a>( <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c66026435b0fbd8598540769dcf8f24e3134f48c">SEC_D13</a>, 1 );
<a name="l01368"></a>01368       <span class="keywordflow">if</span>( ubNumCreatures &gt; 1 &amp;&amp; ubNumCreatures * 10 &gt; (<a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a>)<a class="code" href="Random_8cpp.html#ca9f12606e77e67e4a79ee8ec0cba956">PreRandom</a>( 100 ) )
<a name="l01369"></a>01369       { <span class="comment">//10% chance for each creature to decide it's time to attack.</span>
<a name="l01370"></a>01370             <a class="code" href="Game_01Event_01Hook_8h.html#d0da2cc582f16f4f54f328db96d7ca56">AddStrategicEvent</a>( <a class="code" href="Game_01Event_01Hook_8h.html#08f51f22ad2ed13a25181c260457311045c2adfea062cdbcf6a48276c30dd162">EVENT_CREATURE_ATTACK</a>, <a class="code" href="Game_01Clock_8cpp.html#4d255e800fba4d64144a7639d5f3421d">GetWorldTotalMin</a>() + 1 + <a class="code" href="Random_8cpp.html#ca9f12606e77e67e4a79ee8ec0cba956">PreRandom</a>( 429 ), <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c66026435b0fbd8598540769dcf8f24e3134f48c">SEC_D13</a> );
<a name="l01371"></a>01371       }
<a name="l01372"></a>01372       ubNumCreatures = <a class="code" href="Creature_01Spreading_8cpp.html#b2b13a9b2015db27a16ea6aa0c0ab538">CreaturesInUndergroundSector</a>( <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643c236a562a9b38d2ee3c7d7ed06e88faf">SEC_I14</a>, 1 );
<a name="l01373"></a>01373       <span class="keywordflow">if</span>( ubNumCreatures &gt; 1 &amp;&amp; ubNumCreatures * 10 &gt; (<a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a>)<a class="code" href="Random_8cpp.html#ca9f12606e77e67e4a79ee8ec0cba956">PreRandom</a>( 100 ) )
<a name="l01374"></a>01374       { <span class="comment">//10% chance for each creature to decide it's time to attack.</span>
<a name="l01375"></a>01375             <a class="code" href="Game_01Event_01Hook_8h.html#d0da2cc582f16f4f54f328db96d7ca56">AddStrategicEvent</a>( <a class="code" href="Game_01Event_01Hook_8h.html#08f51f22ad2ed13a25181c260457311045c2adfea062cdbcf6a48276c30dd162">EVENT_CREATURE_ATTACK</a>, <a class="code" href="Game_01Clock_8cpp.html#4d255e800fba4d64144a7639d5f3421d">GetWorldTotalMin</a>() + 1 + <a class="code" href="Random_8cpp.html#ca9f12606e77e67e4a79ee8ec0cba956">PreRandom</a>( 429 ), <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643c236a562a9b38d2ee3c7d7ed06e88faf">SEC_I14</a> );
<a name="l01376"></a>01376       }
<a name="l01377"></a>01377       ubNumCreatures = <a class="code" href="Creature_01Spreading_8cpp.html#b2b13a9b2015db27a16ea6aa0c0ab538">CreaturesInUndergroundSector</a>( <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643897f1cfaae4b38d8022feec3521887df">SEC_H8</a>, 1 );
<a name="l01378"></a>01378       <span class="keywordflow">if</span>( ubNumCreatures &gt; 1 &amp;&amp; ubNumCreatures * 10 &gt; (<a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a>)<a class="code" href="Random_8cpp.html#ca9f12606e77e67e4a79ee8ec0cba956">PreRandom</a>( 100 ) )
<a name="l01379"></a>01379       { <span class="comment">//10% chance for each creature to decide it's time to attack.</span>
<a name="l01380"></a>01380             <a class="code" href="Game_01Event_01Hook_8h.html#d0da2cc582f16f4f54f328db96d7ca56">AddStrategicEvent</a>( <a class="code" href="Game_01Event_01Hook_8h.html#08f51f22ad2ed13a25181c260457311045c2adfea062cdbcf6a48276c30dd162">EVENT_CREATURE_ATTACK</a>, <a class="code" href="Game_01Clock_8cpp.html#4d255e800fba4d64144a7639d5f3421d">GetWorldTotalMin</a>() + 1 +<a class="code" href="Random_8cpp.html#ca9f12606e77e67e4a79ee8ec0cba956">PreRandom</a>( 429 ), <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643897f1cfaae4b38d8022feec3521887df">SEC_H8</a> );
<a name="l01381"></a>01381       }
<a name="l01382"></a>01382 }
<a name="l01383"></a>01383 
<a name="l01384"></a>01384 
<a name="l01385"></a><a class="code" href="Creature_01Spreading_8h.html#b0e2645075d94de60e291c6ff55b49b8">01385</a> <span class="keywordtype">void</span> <a class="code" href="Creature_01Spreading_8cpp.html#b0e2645075d94de60e291c6ff55b49b8">CheckConditionsForTriggeringCreatureQuest</a>( <a class="code" href="Types_8h.html#30f500129d8c688af07726d5d34ce52d">INT16</a> sSectorX, <a class="code" href="Types_8h.html#30f500129d8c688af07726d5d34ce52d">INT16</a> sSectorY, <a class="code" href="Types_8h.html#7ebe70ceca856797319175e30bcf003d">INT8</a> bSectorZ )
<a name="l01386"></a>01386 {
<a name="l01387"></a>01387       <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubValidMines = 0;
<a name="l01388"></a>01388       <span class="keywordflow">if</span>( !(<a class="code" href="GameSettings_8cpp.html#f9f2d5fd368ccadcc26bebc202d52ae7">gGameOptions</a>.<a class="code" href="structGAME__OPTIONS.html#385fe2b8245d05dd17cb88b9354a2962">ubGameStyle</a> == <a class="code" href="GameSettings_8h.html#157d5577a5b2f5986037d0d09c7dc77dfd61d6dbb557b45a6354ad22f67f23de">STYLE_SCIFI</a>) || !<a class="code" href="GameSettings_8cpp.html#5c32f930e2fef384505c4b91803a92c2">gGameExternalOptions</a>.<a class="code" href="structGAME__EXTERNAL__OPTIONS.html#21d510b6efb7f779d25684d653aca5b2">fEnableCrepitus</a>)
<a name="l01389"></a>01389             <span class="keywordflow">return</span>; <span class="comment">//No scifi, no creatures...</span>
<a name="l01390"></a>01390       <span class="keywordflow">if</span>( <a class="code" href="Creature_01Spreading_8cpp.html#b9d0d6cd30a304c1dba1c41a5312c190">giLairID</a> )
<a name="l01391"></a>01391             <span class="keywordflow">return</span>;     <span class="comment">//Creature quest already begun</span>
<a name="l01392"></a>01392 
<a name="l01393"></a>01393       <span class="comment">//Count the number of "infectible mines" the player occupies</span>
<a name="l01394"></a>01394       <span class="keywordflow">if</span>( !<a class="code" href="strategic_8cpp.html#6f48fb0ea28e3d4889423290f1a6ede8">StrategicMap</a>[ SECTOR_INFO_TO_STRATEGIC_INDEX( <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c66026435b0fbd8598540769dcf8f24e3134f48c">SEC_D13</a> ) ].fEnemyControlled )
<a name="l01395"></a>01395       { 
<a name="l01396"></a>01396             ubValidMines++;
<a name="l01397"></a>01397       }
<a name="l01398"></a>01398       <span class="keywordflow">if</span>( !<a class="code" href="strategic_8cpp.html#6f48fb0ea28e3d4889423290f1a6ede8">StrategicMap</a>[ SECTOR_INFO_TO_STRATEGIC_INDEX( <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643897f1cfaae4b38d8022feec3521887df">SEC_H8</a> ) ].fEnemyControlled )
<a name="l01399"></a>01399       { 
<a name="l01400"></a>01400             ubValidMines++;
<a name="l01401"></a>01401       }
<a name="l01402"></a>01402       <span class="keywordflow">if</span>( !<a class="code" href="strategic_8cpp.html#6f48fb0ea28e3d4889423290f1a6ede8">StrategicMap</a>[ SECTOR_INFO_TO_STRATEGIC_INDEX( <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643c236a562a9b38d2ee3c7d7ed06e88faf">SEC_I14</a> ) ].fEnemyControlled )
<a name="l01403"></a>01403       { 
<a name="l01404"></a>01404             ubValidMines++;
<a name="l01405"></a>01405       }
<a name="l01406"></a>01406       <span class="keywordflow">if</span>( !<a class="code" href="strategic_8cpp.html#6f48fb0ea28e3d4889423290f1a6ede8">StrategicMap</a>[ SECTOR_INFO_TO_STRATEGIC_INDEX( <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643c6ced202c824aa65d9d2f53922400fa1">SEC_H3</a> ) ].fEnemyControlled )
<a name="l01407"></a>01407       {
<a name="l01408"></a>01408             ubValidMines++;
<a name="l01409"></a>01409       }
<a name="l01410"></a>01410 
<a name="l01411"></a>01411       <span class="keywordflow">if</span>( ubValidMines &gt;= 3 )
<a name="l01412"></a>01412       {
<a name="l01413"></a>01413             <a class="code" href="Creature_01Spreading_8cpp.html#0c30b630488ea8d1b9215fac8c688bda">InitCreatureQuest</a>();
<a name="l01414"></a>01414       }
<a name="l01415"></a>01415 }
<a name="l01416"></a>01416 
<a name="l01417"></a>01417 
<a name="l01418"></a><a class="code" href="Creature_01Spreading_8h.html#2674ec695827cc7a6d23a0da4ef507fc">01418</a> <a class="code" href="Types_8h.html#112e3146cb38b6ee95e64d85842e380a">BOOLEAN</a> <a class="code" href="Creature_01Spreading_8cpp.html#2674ec695827cc7a6d23a0da4ef507fc">SaveCreatureDirectives</a>( <a class="code" href="LibraryDataBase_8h.html#210e2fc1c18208cbf159ef9c087d6721">HWFILE</a> hFile )
<a name="l01419"></a>01419 {
<a name="l01420"></a>01420       <a class="code" href="Types_8h.html#e1e6edbbc26d6fbc71a90190d0266018">UINT32</a> uiNumBytesWritten;
<a name="l01421"></a>01421 
<a name="l01422"></a>01422       <a class="code" href="FileMan_8cpp.html#09ed41c07d607c8c64a7e2b9fb25660c">FileWrite</a>( hFile, &amp;<a class="code" href="Creature_01Spreading_8cpp.html#6c1ae8dabd332f455970b1cfc21bbedd">giHabitatedDistance</a>, 4, &amp;uiNumBytesWritten );
<a name="l01423"></a>01423       <span class="keywordflow">if</span>( uiNumBytesWritten != <span class="keyword">sizeof</span>( <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a> ) )
<a name="l01424"></a>01424       {
<a name="l01425"></a>01425             <span class="keywordflow">return</span>( FALSE );
<a name="l01426"></a>01426       }
<a name="l01427"></a>01427 
<a name="l01428"></a>01428       <a class="code" href="FileMan_8cpp.html#09ed41c07d607c8c64a7e2b9fb25660c">FileWrite</a>( hFile, &amp;<a class="code" href="Creature_01Spreading_8cpp.html#2ca411c8ef1417eeda35cc309a4f2220">giPopulationModifier</a>, 4, &amp;uiNumBytesWritten );
<a name="l01429"></a>01429       <span class="keywordflow">if</span>( uiNumBytesWritten != <span class="keyword">sizeof</span>( INT32 ) )
<a name="l01430"></a>01430       {
<a name="l01431"></a>01431             <span class="keywordflow">return</span>( FALSE );
<a name="l01432"></a>01432       }
<a name="l01433"></a>01433       <a class="code" href="FileMan_8cpp.html#09ed41c07d607c8c64a7e2b9fb25660c">FileWrite</a>( hFile, &amp;<a class="code" href="Creature_01Spreading_8cpp.html#b9d0d6cd30a304c1dba1c41a5312c190">giLairID</a>, 4, &amp;uiNumBytesWritten );
<a name="l01434"></a>01434       <span class="keywordflow">if</span>( uiNumBytesWritten != <span class="keyword">sizeof</span>( INT32 ) )
<a name="l01435"></a>01435       {
<a name="l01436"></a>01436             <span class="keywordflow">return</span>( FALSE );
<a name="l01437"></a>01437       }
<a name="l01438"></a>01438       <a class="code" href="FileMan_8cpp.html#09ed41c07d607c8c64a7e2b9fb25660c">FileWrite</a>( hFile, &amp;<a class="code" href="Creature_01Spreading_8cpp.html#4605b946d86cc2c09fc6e765b9c89e7c">gfUseCreatureMusic</a>, 1, &amp;uiNumBytesWritten );
<a name="l01439"></a>01439       <span class="keywordflow">if</span>( uiNumBytesWritten != <span class="keyword">sizeof</span>( <a class="code" href="Types_8h.html#112e3146cb38b6ee95e64d85842e380a">BOOLEAN</a> ) )
<a name="l01440"></a>01440       {
<a name="l01441"></a>01441             <span class="keywordflow">return</span>( FALSE );
<a name="l01442"></a>01442       }
<a name="l01443"></a>01443       <a class="code" href="FileMan_8cpp.html#09ed41c07d607c8c64a7e2b9fb25660c">FileWrite</a>( hFile, &amp;<a class="code" href="Creature_01Spreading_8cpp.html#da7da2c006075a287418792f1a6a8d56">giDestroyedLairID</a>, 4, &amp;uiNumBytesWritten );
<a name="l01444"></a>01444       <span class="keywordflow">if</span>( uiNumBytesWritten != <span class="keyword">sizeof</span>( INT32 ) )
<a name="l01445"></a>01445       {
<a name="l01446"></a>01446             <span class="keywordflow">return</span>( FALSE );
<a name="l01447"></a>01447       }
<a name="l01448"></a>01448 
<a name="l01449"></a>01449       <span class="keywordflow">return</span>( TRUE );
<a name="l01450"></a>01450 }
<a name="l01451"></a>01451 
<a name="l01452"></a><a class="code" href="Creature_01Spreading_8h.html#687d052b75c339b7ed9047a3197dc009">01452</a> <a class="code" href="Types_8h.html#112e3146cb38b6ee95e64d85842e380a">BOOLEAN</a> <a class="code" href="Creature_01Spreading_8cpp.html#687d052b75c339b7ed9047a3197dc009">LoadCreatureDirectives</a>( <a class="code" href="LibraryDataBase_8h.html#210e2fc1c18208cbf159ef9c087d6721">HWFILE</a> hFile, <a class="code" href="Types_8h.html#e1e6edbbc26d6fbc71a90190d0266018">UINT32</a> uiSavedGameVersion )
<a name="l01453"></a>01453 {
<a name="l01454"></a>01454       <a class="code" href="Types_8h.html#e1e6edbbc26d6fbc71a90190d0266018">UINT32</a> uiNumBytesRead;
<a name="l01455"></a>01455       <a class="code" href="FileMan_8cpp.html#1b213074411fd4c1dc8fd345e787b17e">FileRead</a>( hFile, &amp;<a class="code" href="Creature_01Spreading_8cpp.html#6c1ae8dabd332f455970b1cfc21bbedd">giHabitatedDistance</a>, 4, &amp;uiNumBytesRead );
<a name="l01456"></a>01456       <span class="keywordflow">if</span>( uiNumBytesRead != <span class="keyword">sizeof</span>( <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a> ) )
<a name="l01457"></a>01457       {
<a name="l01458"></a>01458             <span class="keywordflow">return</span>( FALSE );
<a name="l01459"></a>01459       }
<a name="l01460"></a>01460 
<a name="l01461"></a>01461       <a class="code" href="FileMan_8cpp.html#1b213074411fd4c1dc8fd345e787b17e">FileRead</a>( hFile, &amp;<a class="code" href="Creature_01Spreading_8cpp.html#2ca411c8ef1417eeda35cc309a4f2220">giPopulationModifier</a>, 4, &amp;uiNumBytesRead );
<a name="l01462"></a>01462       <span class="keywordflow">if</span>( uiNumBytesRead != <span class="keyword">sizeof</span>( INT32 ) )
<a name="l01463"></a>01463       {
<a name="l01464"></a>01464             <span class="keywordflow">return</span>( FALSE );
<a name="l01465"></a>01465       }
<a name="l01466"></a>01466       <a class="code" href="FileMan_8cpp.html#1b213074411fd4c1dc8fd345e787b17e">FileRead</a>( hFile, &amp;<a class="code" href="Creature_01Spreading_8cpp.html#b9d0d6cd30a304c1dba1c41a5312c190">giLairID</a>, 4, &amp;uiNumBytesRead );
<a name="l01467"></a>01467       <span class="keywordflow">if</span>( uiNumBytesRead != <span class="keyword">sizeof</span>( INT32 ) )
<a name="l01468"></a>01468       {
<a name="l01469"></a>01469             <span class="keywordflow">return</span>( FALSE );
<a name="l01470"></a>01470       }
<a name="l01471"></a>01471       
<a name="l01472"></a>01472       <a class="code" href="FileMan_8cpp.html#1b213074411fd4c1dc8fd345e787b17e">FileRead</a>( hFile, &amp;<a class="code" href="Creature_01Spreading_8cpp.html#4605b946d86cc2c09fc6e765b9c89e7c">gfUseCreatureMusic</a>, 1, &amp;uiNumBytesRead );
<a name="l01473"></a>01473       <span class="keywordflow">if</span>( uiNumBytesRead != <span class="keyword">sizeof</span>( <a class="code" href="Types_8h.html#112e3146cb38b6ee95e64d85842e380a">BOOLEAN</a> ) )
<a name="l01474"></a>01474       {
<a name="l01475"></a>01475             <span class="keywordflow">return</span>( FALSE );
<a name="l01476"></a>01476       }
<a name="l01477"></a>01477 
<a name="l01478"></a>01478       <span class="keywordflow">if</span>( uiSavedGameVersion &gt;= 82 )
<a name="l01479"></a>01479       {
<a name="l01480"></a>01480             <a class="code" href="FileMan_8cpp.html#1b213074411fd4c1dc8fd345e787b17e">FileRead</a>( hFile, &amp;<a class="code" href="Creature_01Spreading_8cpp.html#da7da2c006075a287418792f1a6a8d56">giDestroyedLairID</a>, 4, &amp;uiNumBytesRead );
<a name="l01481"></a>01481             <span class="keywordflow">if</span>( uiNumBytesRead != <span class="keyword">sizeof</span>( INT32 ) )
<a name="l01482"></a>01482             {
<a name="l01483"></a>01483                   <span class="keywordflow">return</span>( FALSE );
<a name="l01484"></a>01484             }
<a name="l01485"></a>01485       }
<a name="l01486"></a>01486       <span class="keywordflow">else</span>
<a name="l01487"></a>01487       {
<a name="l01488"></a>01488             <a class="code" href="Creature_01Spreading_8cpp.html#da7da2c006075a287418792f1a6a8d56">giDestroyedLairID</a> = 0;
<a name="l01489"></a>01489       }
<a name="l01490"></a>01490 
<a name="l01491"></a>01491 <span class="preprocessor">      #ifdef JA2BETAVERSION</span>
<a name="l01492"></a>01492 <span class="preprocessor"></span>            <span class="keywordflow">if</span>( <a class="code" href="Creature_01Spreading_8cpp.html#6f17ecf03a7088f6798c48822cc50137">gfClearCreatureQuest</a> &amp;&amp; <a class="code" href="Creature_01Spreading_8cpp.html#b9d0d6cd30a304c1dba1c41a5312c190">giLairID</a> != -1 )
<a name="l01493"></a>01493             {
<a name="l01494"></a>01494                   <a class="code" href="Creature_01Spreading_8cpp.html#b9d0d6cd30a304c1dba1c41a5312c190">giLairID</a> = 0;
<a name="l01495"></a>01495                   <a class="code" href="SaveLoadGame_8cpp.html#6846a6c6febabdd94edaa35217aabfc8">gfCreatureMeanwhileScenePlayed</a> = FALSE;
<a name="l01496"></a>01496                   <a class="code" href="Creature_01Spreading_8cpp.html#2acea5fee65b14f2e4cb786043dcf4cc">uiMeanWhileFlags</a> &amp;= ~(0x00000800);
<a name="l01497"></a>01497             }
<a name="l01498"></a>01498             <a class="code" href="Creature_01Spreading_8cpp.html#6f17ecf03a7088f6798c48822cc50137">gfClearCreatureQuest</a> = FALSE;
<a name="l01499"></a>01499 <span class="preprocessor">      #endif</span>
<a name="l01500"></a>01500 <span class="preprocessor"></span>
<a name="l01501"></a>01501       <span class="keywordflow">switch</span>( <a class="code" href="Creature_01Spreading_8cpp.html#b9d0d6cd30a304c1dba1c41a5312c190">giLairID</a> )
<a name="l01502"></a>01502       {
<a name="l01503"></a>01503             <span class="keywordflow">case</span> -1:                                                                <span class="keywordflow">break</span>; <span class="comment">//creature quest finished -- it's okay</span>
<a name="l01504"></a>01504             <span class="keywordflow">case</span> 0:                                                                       <span class="keywordflow">break</span>; <span class="comment">//lair doesn't exist yet -- it's okay</span>
<a name="l01505"></a>01505             <span class="keywordflow">case</span> 1:           <a class="code" href="Creature_01Spreading_8cpp.html#77d1e0856783e7827edcbdbe35044727">InitLairDrassen</a>();      <span class="keywordflow">break</span>;
<a name="l01506"></a>01506             <span class="keywordflow">case</span> 2:           <a class="code" href="Creature_01Spreading_8cpp.html#5572c91bcdaccde46e41a22a19d4b3e9">InitLairCambria</a>();      <span class="keywordflow">break</span>;
<a name="l01507"></a>01507             <span class="keywordflow">case</span> 3:           <a class="code" href="Creature_01Spreading_8cpp.html#c2220030c8c85b6694b3fb02a408bdce">InitLairAlma</a>();               <span class="keywordflow">break</span>;
<a name="l01508"></a>01508             <span class="keywordflow">case</span> 4:           <a class="code" href="Creature_01Spreading_8cpp.html#dd1f0206b2213ecb031039488bea0a79">InitLairGrumm</a>();        <span class="keywordflow">break</span>;
<a name="l01509"></a>01509             <span class="keywordflow">default</span>:
<a name="l01510"></a>01510 <span class="preprocessor">                  #ifdef JA2BETAVERSION</span>
<a name="l01511"></a>01511 <span class="preprocessor"></span>                        <a class="code" href="message_8cpp.html#818e47bc59bd5a5755f06ec51cd74928">ScreenMsg</a>( FONT_RED, MSG_ERROR, L<span class="stringliteral">"Invalid restoration of creature lair ID of %d.  Save game potentially hosed."</span>, <a class="code" href="Creature_01Spreading_8cpp.html#b9d0d6cd30a304c1dba1c41a5312c190">giLairID</a> );
<a name="l01512"></a>01512 <span class="preprocessor">                  #endif</span>
<a name="l01513"></a>01513 <span class="preprocessor"></span>                  <span class="keywordflow">break</span>;
<a name="l01514"></a>01514       }
<a name="l01515"></a>01515 
<a name="l01516"></a>01516       <span class="keywordflow">return</span>( TRUE );
<a name="l01517"></a>01517 }
<a name="l01518"></a>01518 
<a name="l01519"></a><a class="code" href="Creature_01Spreading_8h.html#3c4f2c3b3476edcf5d5a0e42754d3809">01519</a> <span class="keywordtype">void</span> <a class="code" href="Creature_01Spreading_8cpp.html#3c4f2c3b3476edcf5d5a0e42754d3809">ForceCreaturesToAvoidMineTemporarily</a>( <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubMineIndex )
<a name="l01520"></a>01520 {
<a name="l01521"></a>01521       <a class="code" href="Creature_01Spreading_8cpp.html#9380f2e39f34095d76ba1abab44dab29">gMineStatus</a>[ <a class="code" href="Strategic_01Mines_8h.html#a3dfb65ce3006aaab287357097352604c7ee78fd3eff50eb424fd5cff44ffcf9">MINE_GRUMM</a> ].<a class="code" href="structMINE__STATUS__TYPE.html#5617403e33a585f58b7368193635da70">usValidDayCreaturesCanInfest</a> = (<a class="code" href="Types_8h.html#09f1a1fb2293e33483cc8d44aefb1eb1">UINT16</a>)(<a class="code" href="Game_01Clock_8cpp.html#41db6fb136e18cfede5f7c1eea89d7fb">GetWorldDay</a>() + 2);
<a name="l01522"></a>01522 }
<a name="l01523"></a>01523 
<a name="l01524"></a><a class="code" href="Creature_01Spreading_8h.html#dd0b5e253e0bbbb23b1d4c4733f60d5c">01524</a> <a class="code" href="Types_8h.html#112e3146cb38b6ee95e64d85842e380a">BOOLEAN</a> <a class="code" href="Creature_01Spreading_8cpp.html#dd0b5e253e0bbbb23b1d4c4733f60d5c">PlayerGroupIsInACreatureInfestedMine</a>()
<a name="l01525"></a>01525 {
<a name="l01526"></a>01526       <a class="code" href="structCREATURE__DIRECTIVE.html">CREATURE_DIRECTIVE</a> *curr;
<a name="l01527"></a>01527       <a class="code" href="structSOLDIERTYPE.html">SOLDIERTYPE</a> *<a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>;
<a name="l01528"></a>01528       <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a> i;
<a name="l01529"></a>01529       <a class="code" href="Types_8h.html#30f500129d8c688af07726d5d34ce52d">INT16</a> sSectorX, sSectorY;
<a name="l01530"></a>01530       <a class="code" href="Types_8h.html#7ebe70ceca856797319175e30bcf003d">INT8</a> bSectorZ;
<a name="l01531"></a>01531       <a class="code" href="Types_8h.html#112e3146cb38b6ee95e64d85842e380a">BOOLEAN</a> fPlayerInSector = FALSE;
<a name="l01532"></a>01532 
<a name="l01533"></a>01533       <span class="keywordflow">if</span>( <a class="code" href="Creature_01Spreading_8cpp.html#b9d0d6cd30a304c1dba1c41a5312c190">giLairID</a> &lt;= 0 )
<a name="l01534"></a>01534       { <span class="comment">//Creature quest inactive</span>
<a name="l01535"></a>01535             <span class="keywordflow">return</span> FALSE;
<a name="l01536"></a>01536       }
<a name="l01537"></a>01537 
<a name="l01538"></a>01538       <span class="comment">//Lair is active, so look for live soldier in any creature level</span>
<a name="l01539"></a>01539       curr = <a class="code" href="Creature_01Spreading_8cpp.html#f6419c60c42874dbb013443c02534a6a">lair</a>;
<a name="l01540"></a>01540       <span class="keywordflow">while</span>( curr )
<a name="l01541"></a>01541       {
<a name="l01542"></a>01542             sSectorX = curr-&gt;<a class="code" href="structCREATURE__DIRECTIVE.html#bff6a87fbf7df1c95b8f9f2e0f74f09d">pLevel</a>-&gt;<a class="code" href="structUNDERGROUND__SECTORINFO.html#20f20d9457f57356a12a9edb40dba87d">ubSectorX</a>;
<a name="l01543"></a>01543             sSectorY = curr-&gt;<a class="code" href="structCREATURE__DIRECTIVE.html#bff6a87fbf7df1c95b8f9f2e0f74f09d">pLevel</a>-&gt;<a class="code" href="structUNDERGROUND__SECTORINFO.html#b009cc94665a4bec6da4e8aedff2570e">ubSectorY</a>;
<a name="l01544"></a>01544             bSectorZ = (<a class="code" href="Types_8h.html#7ebe70ceca856797319175e30bcf003d">INT8</a>)curr-&gt;<a class="code" href="structCREATURE__DIRECTIVE.html#bff6a87fbf7df1c95b8f9f2e0f74f09d">pLevel</a>-&gt;<a class="code" href="structUNDERGROUND__SECTORINFO.html#77a1e97dc913c0dac2912c380b5a0001">ubSectorZ</a>;
<a name="l01545"></a>01545             <span class="comment">//Loop through all the creature directives (mine sectors that are infectible) and</span>
<a name="l01546"></a>01546             <span class="comment">//see if players are there.</span>
<a name="l01547"></a>01547             <span class="keywordflow">for</span>( i = <a class="code" href="Overhead_8cpp.html#46bd754f8875c305ab18731ed10e3364">gTacticalStatus</a>.<a class="code" href="structTacticalStatusType.html#2ecddfe580bb019bc92cc4859eaf3edc">Team</a>[ OUR_TEAM ].<a class="code" href="structTacticalTeamType.html#f8fe819ad07b242f5dbf97fd4c69b00d">bFirstID</a>; i &lt;= <a class="code" href="Overhead_8cpp.html#46bd754f8875c305ab18731ed10e3364">gTacticalStatus</a>.<a class="code" href="structTacticalStatusType.html#2ecddfe580bb019bc92cc4859eaf3edc">Team</a>[ OUR_TEAM ].<a class="code" href="structTacticalTeamType.html#6a887279dad735dc302f21c1e559d5ce">bLastID</a>; i++ )
<a name="l01548"></a>01548             {
<a name="l01549"></a>01549                   <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a> = <a class="code" href="Overhead_8cpp.html#2b9a828d7d92ec404b2f9a39fc001177">MercPtrs</a>[ i ];
<a name="l01550"></a>01550                   <span class="keywordflow">if</span>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#653dad4e2520784e293eca9f948b8532">bActive</a> &amp;&amp; <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#e308dea18533bf5ab2bcee5bbe27391c">bLife</a> &amp;&amp; 
<a name="l01551"></a>01551                               <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#6784346500db10daed06c2db02b855c0">sSectorX</a> == sSectorX &amp;&amp;
<a name="l01552"></a>01552                               <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#6dd68e70c3000beb79e4ac45d28a0cbf">sSectorY</a> == sSectorY &amp;&amp; 
<a name="l01553"></a>01553                               <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#b70b761f0405cc179c1ffba84484df28">bSectorZ</a> == bSectorZ &amp;&amp;
<a name="l01554"></a>01554                               !<a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#f66e3396115e7d6b63d661a57d3e6895">fBetweenSectors</a> )
<a name="l01555"></a>01555                   {
<a name="l01556"></a>01556                         <span class="keywordflow">return</span> TRUE;
<a name="l01557"></a>01557                   }
<a name="l01558"></a>01558             }
<a name="l01559"></a>01559             curr = curr-&gt;<a class="code" href="structCREATURE__DIRECTIVE.html#bfbb4d4ab657f447f405bd987d8f719e">next</a>;
<a name="l01560"></a>01560       }
<a name="l01561"></a>01561 
<a name="l01562"></a>01562       <span class="comment">//Lair is active, but no mercs are in these sectors</span>
<a name="l01563"></a>01563       <span class="keywordflow">return</span> FALSE;
<a name="l01564"></a>01564 }
<a name="l01565"></a>01565 
<a name="l01566"></a>01566 <span class="comment">//Returns TRUE if valid and creature quest over, FALSE if creature quest active or not yet started</span>
<a name="l01567"></a><a class="code" href="Creature_01Spreading_8h.html#d95436d08611f1c55d28713fce67a3ce">01567</a> <a class="code" href="Types_8h.html#112e3146cb38b6ee95e64d85842e380a">BOOLEAN</a> <a class="code" href="Creature_01Spreading_8cpp.html#d95436d08611f1c55d28713fce67a3ce">GetWarpOutOfMineCodes</a>( <a class="code" href="Types_8h.html#30f500129d8c688af07726d5d34ce52d">INT16</a> *psSectorX, <a class="code" href="Types_8h.html#30f500129d8c688af07726d5d34ce52d">INT16</a> *psSectorY, <a class="code" href="Types_8h.html#7ebe70ceca856797319175e30bcf003d">INT8</a> *pbSectorZ, <a class="code" href="Types_8h.html#30f500129d8c688af07726d5d34ce52d">INT16</a> *psInsertionGridNo )
<a name="l01568"></a>01568 {
<a name="l01569"></a>01569   <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a> iSwitchValue;
<a name="l01570"></a>01570 
<a name="l01571"></a>01571       <span class="keywordflow">if</span>( !<a class="code" href="Map_01Information_8cpp.html#0d739dcb74321d819ef2bfcb1eb5a669">gfWorldLoaded</a> )
<a name="l01572"></a>01572       {
<a name="l01573"></a>01573             <span class="keywordflow">return</span> FALSE;
<a name="l01574"></a>01574       }
<a name="l01575"></a>01575 
<a name="l01576"></a>01576   <span class="keywordflow">if</span> ( <a class="code" href="strategicmap_8cpp.html#da715721a8ceedd42acf6ddb33e63ce0">gbWorldSectorZ</a> == 0 )
<a name="l01577"></a>01577   {
<a name="l01578"></a>01578     <span class="keywordflow">return</span>( FALSE );
<a name="l01579"></a>01579   }
<a name="l01580"></a>01580 
<a name="l01581"></a>01581   iSwitchValue = <a class="code" href="Creature_01Spreading_8cpp.html#b9d0d6cd30a304c1dba1c41a5312c190">giLairID</a>;
<a name="l01582"></a>01582 
<a name="l01583"></a>01583       <span class="keywordflow">if</span>( iSwitchValue == -1 )
<a name="l01584"></a>01584       {
<a name="l01585"></a>01585             iSwitchValue = <a class="code" href="Creature_01Spreading_8cpp.html#da7da2c006075a287418792f1a6a8d56">giDestroyedLairID</a>;
<a name="l01586"></a>01586       }
<a name="l01587"></a>01587 
<a name="l01588"></a>01588       <span class="keywordflow">if</span>( !iSwitchValue )
<a name="l01589"></a>01589       {
<a name="l01590"></a>01590             <span class="keywordflow">return</span> FALSE;
<a name="l01591"></a>01591       }
<a name="l01592"></a>01592 
<a name="l01593"></a>01593       <span class="comment">//Now make sure the mercs are in the previously infested mine</span>
<a name="l01594"></a>01594       <span class="keywordflow">switch</span>( iSwitchValue )
<a name="l01595"></a>01595       {
<a name="l01596"></a>01596             <span class="keywordflow">case</span> 1: <span class="comment">//Drassen</span>
<a name="l01597"></a>01597                   <span class="keywordflow">if</span>( <a class="code" href="strategicmap_8cpp.html#49d9aed144a633fda4ba1990f002d703">gWorldSectorX</a> == 13 &amp;&amp; <a class="code" href="strategicmap_8cpp.html#ea322310ced0e35ee18a2ee7b32aac5b">gWorldSectorY</a> == 6 &amp;&amp; <a class="code" href="strategicmap_8cpp.html#da715721a8ceedd42acf6ddb33e63ce0">gbWorldSectorZ</a> == 3 ||
<a name="l01598"></a>01598                               <a class="code" href="strategicmap_8cpp.html#49d9aed144a633fda4ba1990f002d703">gWorldSectorX</a> == 13 &amp;&amp; <a class="code" href="strategicmap_8cpp.html#ea322310ced0e35ee18a2ee7b32aac5b">gWorldSectorY</a> == 7 &amp;&amp; <a class="code" href="strategicmap_8cpp.html#da715721a8ceedd42acf6ddb33e63ce0">gbWorldSectorZ</a> == 3 ||
<a name="l01599"></a>01599                               <a class="code" href="strategicmap_8cpp.html#49d9aed144a633fda4ba1990f002d703">gWorldSectorX</a> == 13 &amp;&amp; <a class="code" href="strategicmap_8cpp.html#ea322310ced0e35ee18a2ee7b32aac5b">gWorldSectorY</a> == 7 &amp;&amp; <a class="code" href="strategicmap_8cpp.html#da715721a8ceedd42acf6ddb33e63ce0">gbWorldSectorZ</a> == 2 ||
<a name="l01600"></a>01600                               <a class="code" href="strategicmap_8cpp.html#49d9aed144a633fda4ba1990f002d703">gWorldSectorX</a> == 13 &amp;&amp; <a class="code" href="strategicmap_8cpp.html#ea322310ced0e35ee18a2ee7b32aac5b">gWorldSectorY</a> == 6 &amp;&amp; <a class="code" href="strategicmap_8cpp.html#da715721a8ceedd42acf6ddb33e63ce0">gbWorldSectorZ</a> == 2 ||
<a name="l01601"></a>01601                               <a class="code" href="strategicmap_8cpp.html#49d9aed144a633fda4ba1990f002d703">gWorldSectorX</a> == 13 &amp;&amp; <a class="code" href="strategicmap_8cpp.html#ea322310ced0e35ee18a2ee7b32aac5b">gWorldSectorY</a> == 5 &amp;&amp; <a class="code" href="strategicmap_8cpp.html#da715721a8ceedd42acf6ddb33e63ce0">gbWorldSectorZ</a> == 2 ||
<a name="l01602"></a>01602                               <a class="code" href="strategicmap_8cpp.html#49d9aed144a633fda4ba1990f002d703">gWorldSectorX</a> == 13 &amp;&amp; <a class="code" href="strategicmap_8cpp.html#ea322310ced0e35ee18a2ee7b32aac5b">gWorldSectorY</a> == 5 &amp;&amp; <a class="code" href="strategicmap_8cpp.html#da715721a8ceedd42acf6ddb33e63ce0">gbWorldSectorZ</a> == 1 ||
<a name="l01603"></a>01603                               <a class="code" href="strategicmap_8cpp.html#49d9aed144a633fda4ba1990f002d703">gWorldSectorX</a> == 13 &amp;&amp; <a class="code" href="strategicmap_8cpp.html#ea322310ced0e35ee18a2ee7b32aac5b">gWorldSectorY</a> == 4 &amp;&amp; <a class="code" href="strategicmap_8cpp.html#da715721a8ceedd42acf6ddb33e63ce0">gbWorldSectorZ</a> == 1 )
<a name="l01604"></a>01604                   {
<a name="l01605"></a>01605                         *psSectorX = 13;
<a name="l01606"></a>01606                         *psSectorY = 4;
<a name="l01607"></a>01607                         *pbSectorZ = 0;
<a name="l01608"></a>01608                         *psInsertionGridNo = 20700;
<a name="l01609"></a>01609                         <span class="keywordflow">return</span> TRUE;
<a name="l01610"></a>01610                   }
<a name="l01611"></a>01611                   <span class="keywordflow">break</span>;
<a name="l01612"></a>01612             <span class="keywordflow">case</span> 3: <span class="comment">//Cambria</span>
<a name="l01613"></a>01613                   <span class="keywordflow">if</span>( <a class="code" href="strategicmap_8cpp.html#49d9aed144a633fda4ba1990f002d703">gWorldSectorX</a> == 8 &amp;&amp; <a class="code" href="strategicmap_8cpp.html#ea322310ced0e35ee18a2ee7b32aac5b">gWorldSectorY</a> == 9 &amp;&amp; <a class="code" href="strategicmap_8cpp.html#da715721a8ceedd42acf6ddb33e63ce0">gbWorldSectorZ</a> == 3 ||
<a name="l01614"></a>01614                               <a class="code" href="strategicmap_8cpp.html#49d9aed144a633fda4ba1990f002d703">gWorldSectorX</a> == 8 &amp;&amp; <a class="code" href="strategicmap_8cpp.html#ea322310ced0e35ee18a2ee7b32aac5b">gWorldSectorY</a> == 8 &amp;&amp; <a class="code" href="strategicmap_8cpp.html#da715721a8ceedd42acf6ddb33e63ce0">gbWorldSectorZ</a> == 3 ||
<a name="l01615"></a>01615                               <a class="code" href="strategicmap_8cpp.html#49d9aed144a633fda4ba1990f002d703">gWorldSectorX</a> == 8 &amp;&amp; <a class="code" href="strategicmap_8cpp.html#ea322310ced0e35ee18a2ee7b32aac5b">gWorldSectorY</a> == 8 &amp;&amp; <a class="code" href="strategicmap_8cpp.html#da715721a8ceedd42acf6ddb33e63ce0">gbWorldSectorZ</a> == 2 ||
<a name="l01616"></a>01616                               <a class="code" href="strategicmap_8cpp.html#49d9aed144a633fda4ba1990f002d703">gWorldSectorX</a> == 9 &amp;&amp; <a class="code" href="strategicmap_8cpp.html#ea322310ced0e35ee18a2ee7b32aac5b">gWorldSectorY</a> == 8 &amp;&amp; <a class="code" href="strategicmap_8cpp.html#da715721a8ceedd42acf6ddb33e63ce0">gbWorldSectorZ</a> == 2 ||
<a name="l01617"></a>01617                               <a class="code" href="strategicmap_8cpp.html#49d9aed144a633fda4ba1990f002d703">gWorldSectorX</a> == 9 &amp;&amp; <a class="code" href="strategicmap_8cpp.html#ea322310ced0e35ee18a2ee7b32aac5b">gWorldSectorY</a> == 8 &amp;&amp; <a class="code" href="strategicmap_8cpp.html#da715721a8ceedd42acf6ddb33e63ce0">gbWorldSectorZ</a> == 1 ||
<a name="l01618"></a>01618                               <a class="code" href="strategicmap_8cpp.html#49d9aed144a633fda4ba1990f002d703">gWorldSectorX</a> == 8 &amp;&amp; <a class="code" href="strategicmap_8cpp.html#ea322310ced0e35ee18a2ee7b32aac5b">gWorldSectorY</a> == 8 &amp;&amp; <a class="code" href="strategicmap_8cpp.html#da715721a8ceedd42acf6ddb33e63ce0">gbWorldSectorZ</a> == 1 )
<a name="l01619"></a>01619                   {
<a name="l01620"></a>01620                         *psSectorX = 8;
<a name="l01621"></a>01621                         *psSectorY = 8;
<a name="l01622"></a>01622                         *pbSectorZ = 0;
<a name="l01623"></a>01623                         *psInsertionGridNo = 13002;
<a name="l01624"></a>01624                         <span class="keywordflow">return</span> TRUE;
<a name="l01625"></a>01625                   }
<a name="l01626"></a>01626                   <span class="keywordflow">break</span>;
<a name="l01627"></a>01627             <span class="keywordflow">case</span> 2: <span class="comment">//Alma</span>
<a name="l01628"></a>01628                   <span class="keywordflow">if</span>( <a class="code" href="strategicmap_8cpp.html#49d9aed144a633fda4ba1990f002d703">gWorldSectorX</a> == 13 &amp;&amp; <a class="code" href="strategicmap_8cpp.html#ea322310ced0e35ee18a2ee7b32aac5b">gWorldSectorY</a> == 11 &amp;&amp; <a class="code" href="strategicmap_8cpp.html#da715721a8ceedd42acf6ddb33e63ce0">gbWorldSectorZ</a> == 3 ||
<a name="l01629"></a>01629                               <a class="code" href="strategicmap_8cpp.html#49d9aed144a633fda4ba1990f002d703">gWorldSectorX</a> == 13 &amp;&amp; <a class="code" href="strategicmap_8cpp.html#ea322310ced0e35ee18a2ee7b32aac5b">gWorldSectorY</a> == 10 &amp;&amp; <a class="code" href="strategicmap_8cpp.html#da715721a8ceedd42acf6ddb33e63ce0">gbWorldSectorZ</a> == 3 ||
<a name="l01630"></a>01630                               <a class="code" href="strategicmap_8cpp.html#49d9aed144a633fda4ba1990f002d703">gWorldSectorX</a> == 13 &amp;&amp; <a class="code" href="strategicmap_8cpp.html#ea322310ced0e35ee18a2ee7b32aac5b">gWorldSectorY</a> == 10 &amp;&amp; <a class="code" href="strategicmap_8cpp.html#da715721a8ceedd42acf6ddb33e63ce0">gbWorldSectorZ</a> == 2 ||
<a name="l01631"></a>01631                               <a class="code" href="strategicmap_8cpp.html#49d9aed144a633fda4ba1990f002d703">gWorldSectorX</a> == 14 &amp;&amp; <a class="code" href="strategicmap_8cpp.html#ea322310ced0e35ee18a2ee7b32aac5b">gWorldSectorY</a> == 10 &amp;&amp; <a class="code" href="strategicmap_8cpp.html#da715721a8ceedd42acf6ddb33e63ce0">gbWorldSectorZ</a> == 2 ||
<a name="l01632"></a>01632                               <a class="code" href="strategicmap_8cpp.html#49d9aed144a633fda4ba1990f002d703">gWorldSectorX</a> == 14 &amp;&amp; <a class="code" href="strategicmap_8cpp.html#ea322310ced0e35ee18a2ee7b32aac5b">gWorldSectorY</a> == 10 &amp;&amp; <a class="code" href="strategicmap_8cpp.html#da715721a8ceedd42acf6ddb33e63ce0">gbWorldSectorZ</a> == 1 ||
<a name="l01633"></a>01633                               <a class="code" href="strategicmap_8cpp.html#49d9aed144a633fda4ba1990f002d703">gWorldSectorX</a> == 14 &amp;&amp; <a class="code" href="strategicmap_8cpp.html#ea322310ced0e35ee18a2ee7b32aac5b">gWorldSectorY</a> == 9 &amp;&amp; <a class="code" href="strategicmap_8cpp.html#da715721a8ceedd42acf6ddb33e63ce0">gbWorldSectorZ</a> == 1 )
<a name="l01634"></a>01634                   {
<a name="l01635"></a>01635                         *psSectorX = 14;
<a name="l01636"></a>01636                         *psSectorY = 9;
<a name="l01637"></a>01637                         *pbSectorZ = 0;
<a name="l01638"></a>01638                         *psInsertionGridNo = 9085;
<a name="l01639"></a>01639                         <span class="keywordflow">return</span> TRUE;
<a name="l01640"></a>01640                   }
<a name="l01641"></a>01641                   <span class="keywordflow">break</span>;
<a name="l01642"></a>01642             <span class="keywordflow">case</span> 4: <span class="comment">//Grumm</span>
<a name="l01643"></a>01643                   <span class="keywordflow">if</span>( <a class="code" href="strategicmap_8cpp.html#49d9aed144a633fda4ba1990f002d703">gWorldSectorX</a> == 4 &amp;&amp; <a class="code" href="strategicmap_8cpp.html#ea322310ced0e35ee18a2ee7b32aac5b">gWorldSectorY</a> == 7 &amp;&amp; <a class="code" href="strategicmap_8cpp.html#da715721a8ceedd42acf6ddb33e63ce0">gbWorldSectorZ</a> == 3 ||
<a name="l01644"></a>01644                               <a class="code" href="strategicmap_8cpp.html#49d9aed144a633fda4ba1990f002d703">gWorldSectorX</a> == 4 &amp;&amp; <a class="code" href="strategicmap_8cpp.html#ea322310ced0e35ee18a2ee7b32aac5b">gWorldSectorY</a> == 8 &amp;&amp; <a class="code" href="strategicmap_8cpp.html#da715721a8ceedd42acf6ddb33e63ce0">gbWorldSectorZ</a> == 3 ||
<a name="l01645"></a>01645                               <a class="code" href="strategicmap_8cpp.html#49d9aed144a633fda4ba1990f002d703">gWorldSectorX</a> == 3 &amp;&amp; <a class="code" href="strategicmap_8cpp.html#ea322310ced0e35ee18a2ee7b32aac5b">gWorldSectorY</a> == 8 &amp;&amp; <a class="code" href="strategicmap_8cpp.html#da715721a8ceedd42acf6ddb33e63ce0">gbWorldSectorZ</a> == 2 ||
<a name="l01646"></a>01646                               <a class="code" href="strategicmap_8cpp.html#49d9aed144a633fda4ba1990f002d703">gWorldSectorX</a> == 3 &amp;&amp; <a class="code" href="strategicmap_8cpp.html#ea322310ced0e35ee18a2ee7b32aac5b">gWorldSectorY</a> == 8 &amp;&amp; <a class="code" href="strategicmap_8cpp.html#da715721a8ceedd42acf6ddb33e63ce0">gbWorldSectorZ</a> == 2 ||
<a name="l01647"></a>01647                               <a class="code" href="strategicmap_8cpp.html#49d9aed144a633fda4ba1990f002d703">gWorldSectorX</a> == 3 &amp;&amp; <a class="code" href="strategicmap_8cpp.html#ea322310ced0e35ee18a2ee7b32aac5b">gWorldSectorY</a> == 9 &amp;&amp; <a class="code" href="strategicmap_8cpp.html#da715721a8ceedd42acf6ddb33e63ce0">gbWorldSectorZ</a> == 2 ||
<a name="l01648"></a>01648                               <a class="code" href="strategicmap_8cpp.html#49d9aed144a633fda4ba1990f002d703">gWorldSectorX</a> == 3 &amp;&amp; <a class="code" href="strategicmap_8cpp.html#ea322310ced0e35ee18a2ee7b32aac5b">gWorldSectorY</a> == 9 &amp;&amp; <a class="code" href="strategicmap_8cpp.html#da715721a8ceedd42acf6ddb33e63ce0">gbWorldSectorZ</a> == 1 ||
<a name="l01649"></a>01649                               <a class="code" href="strategicmap_8cpp.html#49d9aed144a633fda4ba1990f002d703">gWorldSectorX</a> == 3 &amp;&amp; <a class="code" href="strategicmap_8cpp.html#ea322310ced0e35ee18a2ee7b32aac5b">gWorldSectorY</a> == 8 &amp;&amp; <a class="code" href="strategicmap_8cpp.html#da715721a8ceedd42acf6ddb33e63ce0">gbWorldSectorZ</a> == 1 )
<a name="l01650"></a>01650                   {
<a name="l01651"></a>01651                         *psSectorX = 3;
<a name="l01652"></a>01652                         *psSectorY = 8;
<a name="l01653"></a>01653                         *pbSectorZ = 0;
<a name="l01654"></a>01654                         *psInsertionGridNo = 9822;
<a name="l01655"></a>01655                         <span class="keywordflow">return</span> TRUE;
<a name="l01656"></a>01656                   }
<a name="l01657"></a>01657                   <span class="keywordflow">break</span>;
<a name="l01658"></a>01658       }
<a name="l01659"></a>01659       <span class="keywordflow">return</span>( FALSE );
<a name="l01660"></a>01660 }
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Sat Sep 9 13:48:00 2006 for Build by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.4.7 </small></address>
</body>
</html>
