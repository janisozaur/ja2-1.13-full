<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>Build: Radar Screen.cpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.4.7 -->
<div class="tabs">
  <ul>
    <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="classes.html"><span>Classes</span></a></li>
    <li id="current"><a href="files.html"><span>Files</span></a></li>
    <li><a href="dirs.html"><span>Directories</span></a></li>
    <li>
      <form action="search.php" method="get">
        <table cellspacing="0" cellpadding="0" border="0">
          <tr>
            <td><label>&nbsp;<u>S</u>earch&nbsp;for&nbsp;</label></td>
            <td><input type="text" name="query" value="" size="20" accesskey="s"/></td>
          </tr>
        </table>
      </form>
    </li>
  </ul></div>
<div class="tabs">
  <ul>
    <li><a href="files.html"><span>File&nbsp;List</span></a></li>
    <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
  </ul></div>
<div class="nav">
<a class="el" href="dir_3179ea33d55a76dc38212d9eab798728.html">export</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_e5664b4b56927c8728eb3192fa60e338.html">hdc2</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_1eb12a41a47efb9efcd82fa98f4f4dbd.html">FTP</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_80cc1f21a78ab7941088ea567f236150.html">ja2src</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_994ab287602efefceafe55287a3657d6.html">Build</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_b9856534af3903a3e1b7a173ba6b806c.html">TileEngine</a></div>
<h1>Radar Screen.cpp</h1><a href="Radar_01Screen_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="preprocessor">#ifdef PRECOMPILEDHEADERS</span>
<a name="l00002"></a>00002 <span class="preprocessor"></span><span class="preprocessor">      #include "<a class="code" href="TileEngine_01All_8h.html">TileEngine All.h</a>"</span>
<a name="l00003"></a>00003 <span class="preprocessor">#else</span>
<a name="l00004"></a>00004 <span class="preprocessor"></span><span class="preprocessor">      #include &lt;stdio.h&gt;</span>
<a name="l00005"></a>00005 <span class="preprocessor">      #include &lt;stdarg.h&gt;</span>
<a name="l00006"></a>00006 <span class="preprocessor">      #include &lt;time.h&gt;</span>
<a name="l00007"></a>00007 <span class="preprocessor">      #include "<a class="code" href="sgp_8h.html">sgp.h</a>"</span>
<a name="l00008"></a>00008 <span class="preprocessor">      #include "<a class="code" href="Radar_01Screen_8h.html">Radar Screen.h</a>"</span>
<a name="l00009"></a>00009 <span class="preprocessor">      #include "<a class="code" href="line_8h.html">line.h</a>"</span>
<a name="l00010"></a>00010 <span class="preprocessor">      #include "<a class="code" href="renderworld_8h.html">renderworld.h</a>"</span>
<a name="l00011"></a>00011 <span class="preprocessor">      #include "<a class="code" href="Isometric_01Utils_8h.html">Isometric Utils.h</a>"</span>
<a name="l00012"></a>00012 <span class="preprocessor">      #include "<a class="code" href="Interface_8h.html">Interface.h</a>"</span>
<a name="l00013"></a>00013 <span class="preprocessor">      #include "overhead.h"</span>
<a name="l00014"></a>00014 <span class="preprocessor">      #include "<a class="code" href="Soldier_01Control_8h.html">Soldier Control.h</a>"</span>
<a name="l00015"></a>00015 <span class="preprocessor">      #include "<a class="code" href="lighting_8h.html">lighting.h</a>"</span>
<a name="l00016"></a>00016 <span class="preprocessor">      #include "wcheck.h"</span>
<a name="l00017"></a>00017 <span class="preprocessor">      #include "<a class="code" href="sysutil_8h.html">sysutil.h</a>"</span>
<a name="l00018"></a>00018 <span class="preprocessor">      #include "render dirty.h"</span>
<a name="l00019"></a>00019 <span class="preprocessor">      #include "<a class="code" href="overhead_01map_8h.html">overhead map.h</a>"</span>
<a name="l00020"></a>00020 <span class="preprocessor">      #include "<a class="code" href="Squads_8h.html">Squads.h</a>"</span>
<a name="l00021"></a>00021 <span class="preprocessor">      #include "<a class="code" href="mousesystem_8h.html">mousesystem.h</a>"</span>
<a name="l00022"></a>00022 <span class="preprocessor">      #include "<a class="code" href="Text_8h.html">Text.h</a>"</span>
<a name="l00023"></a>00023 <span class="preprocessor">      #include "<a class="code" href="Font_01Control_8h.html">Font Control.h</a>"</span>
<a name="l00024"></a>00024 <span class="preprocessor">      #include "<a class="code" href="vobject_8h.html">vobject.h</a>"</span>
<a name="l00025"></a>00025 <span class="preprocessor">      #include "<a class="code" href="Utilities_8h.html">Utilities.h</a>"</span>
<a name="l00026"></a>00026 <span class="preprocessor">      #include "<a class="code" href="Interface_01Control_8h.html">Interface Control.h</a>"</span>
<a name="l00027"></a>00027 <span class="preprocessor">      #include "<a class="code" href="Game_01Clock_8h.html">Game Clock.h</a>"</span>
<a name="l00028"></a>00028 <span class="preprocessor">      #include "<a class="code" href="Map_01Screen_01Interface_01Map_01Inventory_8h.html">Map Screen Interface Map Inventory.h</a>"</span>
<a name="l00029"></a>00029 <span class="preprocessor">      #include "<a class="code" href="environment_8h.html">environment.h</a>"</span>
<a name="l00030"></a>00030 <span class="preprocessor">#endif</span>
<a name="l00031"></a>00031 <span class="preprocessor"></span>
<a name="l00032"></a>00032 <span class="keyword">extern</span> <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a> <a class="code" href="Map_01Screen_01Interface_01Map_8cpp.html#b52d71b8f7dc10a22568eb52e0c51a3e">iCurrentMapSectorZ</a>;
<a name="l00033"></a>00033 
<a name="l00034"></a>00034 <span class="keywordtype">void</span> <a class="code" href="Radar_01Screen_8cpp.html#9b0cdb6d38a24fd8d8b302d27d302d1c">AdjustWorldCenterFromRadarCoords</a>( <a class="code" href="Types_8h.html#30f500129d8c688af07726d5d34ce52d">INT16</a> sRadarX, <a class="code" href="Types_8h.html#30f500129d8c688af07726d5d34ce52d">INT16</a> sRadarY );
<a name="l00035"></a>00035 
<a name="l00036"></a>00036 
<a name="l00037"></a>00037 <span class="comment">// render the squad list</span>
<a name="l00038"></a>00038 <span class="keywordtype">void</span> <a class="code" href="Radar_01Screen_8cpp.html#a586b51d4decd9be949e0b5eefda92e6">RenderSquadList</a>( <span class="keywordtype">void</span> );
<a name="l00039"></a>00039 
<a name="l00040"></a>00040 <span class="comment">// squad list mvt + btn callback</span>
<a name="l00041"></a>00041 <span class="keywordtype">void</span> <a class="code" href="Radar_01Screen_8cpp.html#99d35709c5e1b47ee0c41c7539caa7ed">TacticalSquadListMvtCallback</a>( <a class="code" href="struct__MOUSE__REGION.html">MOUSE_REGION</a> * pRegion, <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a> iReason );
<a name="l00042"></a>00042 <span class="keywordtype">void</span> <a class="code" href="Radar_01Screen_8cpp.html#882c8cffa633a113016393c1802e54d0">TacticalSquadListBtnCallBack</a>(<a class="code" href="struct__MOUSE__REGION.html">MOUSE_REGION</a> * pRegion, <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a> iReason );
<a name="l00043"></a>00043 
<a name="l00044"></a>00044 <span class="comment">// the squad list font</span>
<a name="l00045"></a>00045 <span class="preprocessor">#define SQUAD_FONT COMPFONT</span>
<a name="l00046"></a>00046 <span class="preprocessor"></span>
<a name="l00047"></a>00047 <span class="preprocessor">#define SQUAD_REGION_HEIGHT 2 * RADAR_WINDOW_HEIGHT </span>
<a name="l00048"></a>00048 <span class="preprocessor"></span><span class="preprocessor">#define SQUAD_WINDOW_TM_Y RADAR_WINDOW_TM_Y + GetFontHeight( SQUAD_FONT )</span>
<a name="l00049"></a>00049 <span class="preprocessor"></span>
<a name="l00050"></a>00050 <span class="comment">// subtractor for squad list from size of radar view region height</span>
<a name="l00051"></a>00051 <span class="preprocessor">#define SUBTRACTOR_FOR_SQUAD_LIST 0</span>
<a name="l00052"></a>00052 <span class="preprocessor"></span>
<a name="l00053"></a>00053 
<a name="l00054"></a><a class="code" href="Radar_01Screen_8cpp.html#a1ea277cdcc1402a094168b8aa7a4860">00054</a> <a class="code" href="Types_8h.html#30f500129d8c688af07726d5d34ce52d">INT16</a>             <a class="code" href="Radar_01Screen_8cpp.html#a1ea277cdcc1402a094168b8aa7a4860">gsRadarX</a>;
<a name="l00055"></a><a class="code" href="Radar_01Screen_8cpp.html#0fb3f7a1e0cd24f85cc473fe4c00518c">00055</a> <a class="code" href="Types_8h.html#30f500129d8c688af07726d5d34ce52d">INT16</a>             <a class="code" href="Radar_01Screen_8cpp.html#0fb3f7a1e0cd24f85cc473fe4c00518c">gsRadarY</a>;
<a name="l00056"></a><a class="code" href="Radar_01Screen_8cpp.html#508392134f5a8c5fba0f36e022bca6f2">00056</a> <a class="code" href="Types_8h.html#e1e6edbbc26d6fbc71a90190d0266018">UINT32</a>            <a class="code" href="Radar_01Screen_8cpp.html#508392134f5a8c5fba0f36e022bca6f2">gusRadarImage</a>;
<a name="l00057"></a><a class="code" href="Radar_01Screen_8cpp.html#7145bf7c8af48b567c41ca4ad043fece">00057</a> <a class="code" href="Types_8h.html#112e3146cb38b6ee95e64d85842e380a">BOOLEAN</a>           <a class="code" href="Radar_01Screen_8cpp.html#7145bf7c8af48b567c41ca4ad043fece">fImageLoaded</a> = FALSE;
<a name="l00058"></a><a class="code" href="Radar_01Screen_8h.html#e03d181e5a8d566c4da81d19df7b8207">00058</a> <a class="code" href="Types_8h.html#112e3146cb38b6ee95e64d85842e380a">BOOLEAN</a>   <a class="code" href="Radar_01Screen_8cpp.html#e03d181e5a8d566c4da81d19df7b8207">fRenderRadarScreen</a> = TRUE;
<a name="l00059"></a><a class="code" href="Radar_01Screen_8cpp.html#f4d3e41c132bf40f2e33bdcf4eff3985">00059</a> <a class="code" href="Types_8h.html#30f500129d8c688af07726d5d34ce52d">INT16</a>             <a class="code" href="Radar_01Screen_8cpp.html#f4d3e41c132bf40f2e33bdcf4eff3985">sSelectedSquadLine</a> = -1;
<a name="l00060"></a>00060 
<a name="l00061"></a><a class="code" href="Radar_01Screen_8cpp.html#d67b5f40f4ea195962db568c90be628a">00061</a> <a class="code" href="Types_8h.html#112e3146cb38b6ee95e64d85842e380a">BOOLEAN</a>           <a class="code" href="overhead_01map_8cpp.html#d67b5f40f4ea195962db568c90be628a">gfRadarCurrentGuyFlash</a> = FALSE;
<a name="l00062"></a>00062 
<a name="l00063"></a>00063 
<a name="l00064"></a><a class="code" href="Radar_01Screen_8cpp.html#023616dfc77f42ba33148586f89d77ba">00064</a> <a class="code" href="struct__MOUSE__REGION.html">MOUSE_REGION</a> <a class="code" href="Radar_01Screen_8cpp.html#023616dfc77f42ba33148586f89d77ba">gRadarRegionSquadList</a>[ <a class="code" href="Squads_8h.html#19516aacc906a3c234aed4c5fdb53c3569e0d9a3efcedbba52faebfe02116adb">NUMBER_OF_SQUADS</a> ];
<a name="l00065"></a>00065 
<a name="l00066"></a><a class="code" href="Radar_01Screen_8h.html#a9524e7cc91d2fb4d01d96e1a6f651db">00066</a> <a class="code" href="Types_8h.html#112e3146cb38b6ee95e64d85842e380a">BOOLEAN</a> <a class="code" href="Radar_01Screen_8cpp.html#a9524e7cc91d2fb4d01d96e1a6f651db">InitRadarScreen</a>( )
<a name="l00067"></a>00067 {
<a name="l00068"></a>00068             <span class="comment">// Add region for radar</span>
<a name="l00069"></a>00069             <a class="code" href="mousesystem_8cpp.html#dce08766ef4cbacb9372efe12d26a1e0">MSYS_DefineRegion</a>( &amp;<a class="code" href="Interface_8cpp.html#5140c25b2774f152b6aefbd9645a9afe">gRadarRegion</a>, RADAR_WINDOW_X, RADAR_WINDOW_TM_Y, 
<a name="l00070"></a>00070                                                                    RADAR_WINDOW_X + RADAR_WINDOW_WIDTH,
<a name="l00071"></a>00071                                                                    RADAR_WINDOW_TM_Y + RADAR_WINDOW_HEIGHT,
<a name="l00072"></a>00072                                                                    MSYS_PRIORITY_HIGHEST, 0, 
<a name="l00073"></a>00073                                                                    <a class="code" href="Radar_01Screen_8cpp.html#119adbdcb0eb58b01c7c3e8e96566f53">RadarRegionMoveCallback</a>,
<a name="l00074"></a>00074                                                                    <a class="code" href="Radar_01Screen_8cpp.html#42da724500614c3a54260eee34f7483d">RadarRegionButtonCallback</a> );
<a name="l00075"></a>00075 
<a name="l00076"></a>00076             <span class="comment">// Add region</span>
<a name="l00077"></a>00077             <a class="code" href="mousesystem_8cpp.html#d654da5fdc0c95350f4c40c17ed3933d">MSYS_AddRegion</a>( &amp;<a class="code" href="Interface_8cpp.html#5140c25b2774f152b6aefbd9645a9afe">gRadarRegion</a> );
<a name="l00078"></a>00078 
<a name="l00079"></a>00079             <span class="comment">//disable the radar map</span>
<a name="l00080"></a>00080             <a class="code" href="mousesystem_8cpp.html#615c54bb2bb679d4ea40c755fbabd8bd">MSYS_DisableRegion</a>(&amp;<a class="code" href="Interface_8cpp.html#5140c25b2774f152b6aefbd9645a9afe">gRadarRegion</a>);
<a name="l00081"></a>00081 
<a name="l00082"></a>00082             <a class="code" href="Radar_01Screen_8cpp.html#a1ea277cdcc1402a094168b8aa7a4860">gsRadarX</a> = RADAR_WINDOW_X;
<a name="l00083"></a>00083             <a class="code" href="Radar_01Screen_8cpp.html#0fb3f7a1e0cd24f85cc473fe4c00518c">gsRadarY</a> = RADAR_WINDOW_TM_Y;
<a name="l00084"></a>00084 
<a name="l00085"></a>00085             <span class="keywordflow">return</span>( TRUE );
<a name="l00086"></a>00086 }
<a name="l00087"></a>00087 
<a name="l00088"></a><a class="code" href="Radar_01Screen_8h.html#83d2726b9748ec33df9bc532d9288f17">00088</a> <a class="code" href="Types_8h.html#112e3146cb38b6ee95e64d85842e380a">BOOLEAN</a> <a class="code" href="Radar_01Screen_8cpp.html#83d2726b9748ec33df9bc532d9288f17">LoadRadarScreenBitmap</a>(<a class="code" href="Types_8h.html#2f68f0189367ead40015f7c0ec68eb9e">CHAR8</a> * aFilename )
<a name="l00089"></a>00089 {
<a name="l00090"></a>00090       <a class="code" href="structVOBJECT__DESC.html">VOBJECT_DESC</a>      VObjectDesc;
<a name="l00091"></a>00091       <a class="code" href="Types_8h.html#2f68f0189367ead40015f7c0ec68eb9e">CHAR8</a>             zFilename[ 260 ];
<a name="l00092"></a>00092       <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a>             cnt;
<a name="l00093"></a>00093       <a class="code" href="structTAG__HVOBJECT.html">HVOBJECT</a>          hVObject;
<a name="l00094"></a>00094 
<a name="l00095"></a>00095       <a class="code" href="Sys_01Globals_8h.html#9e96e1edff6728e41ac635536c3d8304">strcpy</a>( zFilename, aFilename );
<a name="l00096"></a>00096 
<a name="l00097"></a>00097        <span class="comment">// If we have loaded, remove old one</span>
<a name="l00098"></a>00098        <span class="keywordflow">if</span> ( <a class="code" href="Radar_01Screen_8cpp.html#7145bf7c8af48b567c41ca4ad043fece">fImageLoaded</a> )
<a name="l00099"></a>00099        {    
<a name="l00100"></a>00100              <a class="code" href="vobject_8cpp.html#94715e750fad7cebd3d9d388cdff59e2">DeleteVideoObjectFromIndex</a>( <a class="code" href="Radar_01Screen_8cpp.html#508392134f5a8c5fba0f36e022bca6f2">gusRadarImage</a> );
<a name="l00101"></a>00101                   
<a name="l00102"></a>00102              <a class="code" href="Radar_01Screen_8cpp.html#7145bf7c8af48b567c41ca4ad043fece">fImageLoaded</a> = FALSE;
<a name="l00103"></a>00103        }
<a name="l00104"></a>00104 
<a name="l00105"></a>00105 <span class="comment">/* ARM - Restriction removed Nov.29/98.  Must be able to view different radar maps from map screen while underground!</span>
<a name="l00106"></a>00106 <span class="comment">       // If we are in a cave or basement..... dont get a new one...</span>
<a name="l00107"></a>00107 <span class="comment">       if( !gfBasement &amp;&amp; !gfCaves )</span>
<a name="l00108"></a>00108 <span class="comment">*/</span>
<a name="l00109"></a>00109        {
<a name="l00110"></a>00110              <span class="comment">// Remove extension</span>
<a name="l00111"></a>00111              <span class="keywordflow">for</span> ( cnt = <a class="code" href="Sys_01Globals_8h.html#6b0f634f4cee3b49739fbd456e2b9fcf">strlen</a>( zFilename )-1; cnt &gt;=0; cnt-- )
<a name="l00112"></a>00112              {
<a name="l00113"></a>00113                    <span class="keywordflow">if</span> ( zFilename[ cnt ] == <span class="charliteral">'.'</span> )
<a name="l00114"></a>00114                    {
<a name="l00115"></a>00115                          zFilename[ cnt ] = <span class="charliteral">'\0'</span>;
<a name="l00116"></a>00116                    }
<a name="l00117"></a>00117              }
<a name="l00118"></a>00118 
<a name="l00119"></a>00119              <span class="comment">// Grab the Map image</span>
<a name="l00120"></a>00120              VObjectDesc.<a class="code" href="structVOBJECT__DESC.html#2df21c3aa88a0442d5d81b021fa15bf4">fCreateFlags</a> = VOBJECT_CREATE_FROMFILE;
<a name="l00121"></a>00121              sprintf( VObjectDesc.<a class="code" href="structVOBJECT__DESC.html#6dbe3d70c19525e407a05e537cfb22f3">ImageFile</a>, <span class="stringliteral">"RADARMAPS\\%s.STI"</span>, zFilename );
<a name="l00122"></a>00122 
<a name="l00123"></a>00123              CHECKF(AddVideoObject(&amp;VObjectDesc, &amp;<a class="code" href="Radar_01Screen_8cpp.html#508392134f5a8c5fba0f36e022bca6f2">gusRadarImage</a>));
<a name="l00124"></a>00124 
<a name="l00125"></a>00125              <a class="code" href="Radar_01Screen_8cpp.html#7145bf7c8af48b567c41ca4ad043fece">fImageLoaded</a> = TRUE;
<a name="l00126"></a>00126 
<a name="l00127"></a>00127              <span class="keywordflow">if</span>( <a class="code" href="vobject_8cpp.html#bda2b0eae4cb40e612dffd307ad5c692">GetVideoObject</a>( &amp;hVObject, <a class="code" href="Radar_01Screen_8cpp.html#508392134f5a8c5fba0f36e022bca6f2">gusRadarImage</a> ) )
<a name="l00128"></a>00128              {
<a name="l00129"></a>00129                         <span class="comment">// ATE: Add a shade table!</span>
<a name="l00130"></a>00130                         hVObject-&gt;<a class="code" href="structTAG__HVOBJECT.html#9675e7b5879bd14e4e3da0cde2403b95">pShades</a>[ 0 ]  = <a class="code" href="himage_8cpp.html#66700c571d4cfefc0d46d09b1133e819">Create16BPPPaletteShaded</a>( hVObject-&gt;<a class="code" href="structTAG__HVOBJECT.html#0a79f19b17b13c7696197ff65ae5df40">pPaletteEntry</a>, 255, 255, 255, FALSE );
<a name="l00131"></a>00131                         hVObject-&gt;<a class="code" href="structTAG__HVOBJECT.html#9675e7b5879bd14e4e3da0cde2403b95">pShades</a>[ 1 ]  = <a class="code" href="himage_8cpp.html#66700c571d4cfefc0d46d09b1133e819">Create16BPPPaletteShaded</a>( hVObject-&gt;<a class="code" href="structTAG__HVOBJECT.html#0a79f19b17b13c7696197ff65ae5df40">pPaletteEntry</a>, 100, 100, 100, FALSE );
<a name="l00132"></a>00132              }
<a name="l00133"></a>00133        }
<a name="l00134"></a>00134 
<a name="l00135"></a>00135        <span class="comment">// Dirty interface</span>
<a name="l00136"></a>00136        <a class="code" href="Interface_8cpp.html#310e02e85df33f7794f5c4c11ae1844d">fInterfacePanelDirty</a> = TRUE;
<a name="l00137"></a>00137 
<a name="l00138"></a>00138       <span class="keywordflow">return</span>( TRUE );
<a name="l00139"></a>00139 }
<a name="l00140"></a>00140 
<a name="l00141"></a><a class="code" href="Radar_01Screen_8h.html#a5bd7c62db02120e9dfb222c603c2ec7">00141</a> <span class="keywordtype">void</span> <a class="code" href="Radar_01Screen_8cpp.html#a5bd7c62db02120e9dfb222c603c2ec7">ClearOutRadarMapImage</a>( <span class="keywordtype">void</span> )
<a name="l00142"></a>00142 {
<a name="l00143"></a>00143       <span class="comment">// If we have loaded, remove old one</span>
<a name="l00144"></a>00144   <span class="keywordflow">if</span> ( <a class="code" href="Radar_01Screen_8cpp.html#7145bf7c8af48b567c41ca4ad043fece">fImageLoaded</a> )
<a name="l00145"></a>00145   {   
<a name="l00146"></a>00146         <a class="code" href="vobject_8cpp.html#94715e750fad7cebd3d9d388cdff59e2">DeleteVideoObjectFromIndex</a>( <a class="code" href="Radar_01Screen_8cpp.html#508392134f5a8c5fba0f36e022bca6f2">gusRadarImage</a> );
<a name="l00147"></a>00147         <a class="code" href="Radar_01Screen_8cpp.html#7145bf7c8af48b567c41ca4ad043fece">fImageLoaded</a> = FALSE;
<a name="l00148"></a>00148   }
<a name="l00149"></a>00149 
<a name="l00150"></a>00150 }
<a name="l00151"></a>00151 
<a name="l00152"></a><a class="code" href="Radar_01Screen_8h.html#86e5d77553ff2ce98c1f8ea9f14f59d4">00152</a> <span class="keywordtype">void</span> <a class="code" href="Radar_01Screen_8cpp.html#86e5d77553ff2ce98c1f8ea9f14f59d4">MoveRadarScreen</a>()
<a name="l00153"></a>00153 {
<a name="l00154"></a>00154 
<a name="l00155"></a>00155       <span class="comment">// check if we are allowed to do anything?</span>
<a name="l00156"></a>00156       <span class="keywordflow">if</span>( <a class="code" href="Radar_01Screen_8cpp.html#e03d181e5a8d566c4da81d19df7b8207">fRenderRadarScreen</a> == FALSE )
<a name="l00157"></a>00157       {
<a name="l00158"></a>00158             <span class="keywordflow">return</span>;
<a name="l00159"></a>00159       }
<a name="l00160"></a>00160 
<a name="l00161"></a>00161       <span class="comment">// Remove old region</span>
<a name="l00162"></a>00162       <a class="code" href="mousesystem_8cpp.html#f2581a6cadb531c87ebd6b3f5b70f258">MSYS_RemoveRegion</a>( &amp;<a class="code" href="Interface_8cpp.html#5140c25b2774f152b6aefbd9645a9afe">gRadarRegion</a> );
<a name="l00163"></a>00163 
<a name="l00164"></a>00164       <span class="comment">// Add new one</span>
<a name="l00165"></a>00165 
<a name="l00166"></a>00166             <span class="comment">// Move based on inventory panel</span>
<a name="l00167"></a>00167       <span class="keywordflow">if</span>( <a class="code" href="gameloop_8cpp.html#8cd832c7f0ec6ab02ba9fddd4a2257aa">guiCurrentScreen</a> == <a class="code" href="screenids_8h.html#a4ee5dea8709d2b490486a62df77faf26f9c31d9e3c6ef2f0d8e4917d387b871">MAP_SCREEN</a> )
<a name="l00168"></a>00168       {
<a name="l00169"></a>00169             <a class="code" href="Radar_01Screen_8cpp.html#0fb3f7a1e0cd24f85cc473fe4c00518c">gsRadarY</a> = RADAR_WINDOW_STRAT_Y;
<a name="l00170"></a>00170       }
<a name="l00171"></a>00171       <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( <a class="code" href="Faces_8cpp.html#0f11b97eafe682514e8726fc188175d8">gsCurInterfacePanel</a> == <a class="code" href="Interface_8h.html#366cb4f305f8652d6d094e461a23d775c90c5ecb7d874ea2eb00e496d8983740">SM_PANEL</a> )
<a name="l00172"></a>00172       {
<a name="l00173"></a>00173             <a class="code" href="Radar_01Screen_8cpp.html#0fb3f7a1e0cd24f85cc473fe4c00518c">gsRadarY</a> = RADAR_WINDOW_TM_Y;
<a name="l00174"></a>00174       }
<a name="l00175"></a>00175       <span class="keywordflow">else</span>
<a name="l00176"></a>00176       {
<a name="l00177"></a>00177             <a class="code" href="Radar_01Screen_8cpp.html#0fb3f7a1e0cd24f85cc473fe4c00518c">gsRadarY</a> = RADAR_WINDOW_TM_Y;
<a name="l00178"></a>00178       }
<a name="l00179"></a>00179 
<a name="l00180"></a>00180       <span class="comment">// Add region for radar</span>
<a name="l00181"></a>00181       <a class="code" href="mousesystem_8cpp.html#dce08766ef4cbacb9372efe12d26a1e0">MSYS_DefineRegion</a>( &amp;<a class="code" href="Interface_8cpp.html#5140c25b2774f152b6aefbd9645a9afe">gRadarRegion</a>, RADAR_WINDOW_X, (<a class="code" href="Types_8h.html#09f1a1fb2293e33483cc8d44aefb1eb1">UINT16</a>)(<a class="code" href="Radar_01Screen_8cpp.html#0fb3f7a1e0cd24f85cc473fe4c00518c">gsRadarY</a>), 
<a name="l00182"></a>00182                                                              RADAR_WINDOW_X + RADAR_WINDOW_WIDTH,
<a name="l00183"></a>00183                                                              (<a class="code" href="Types_8h.html#09f1a1fb2293e33483cc8d44aefb1eb1">UINT16</a>)(gsRadarY + RADAR_WINDOW_HEIGHT),
<a name="l00184"></a>00184                                                              MSYS_PRIORITY_HIGHEST, 0, 
<a name="l00185"></a>00185                                                              <a class="code" href="Radar_01Screen_8cpp.html#119adbdcb0eb58b01c7c3e8e96566f53">RadarRegionMoveCallback</a>,
<a name="l00186"></a>00186                                                              <a class="code" href="Radar_01Screen_8cpp.html#42da724500614c3a54260eee34f7483d">RadarRegionButtonCallback</a> );
<a name="l00187"></a>00187 
<a name="l00188"></a>00188       <span class="comment">// Add region</span>
<a name="l00189"></a>00189       <a class="code" href="mousesystem_8cpp.html#d654da5fdc0c95350f4c40c17ed3933d">MSYS_AddRegion</a>( &amp;<a class="code" href="Interface_8cpp.html#5140c25b2774f152b6aefbd9645a9afe">gRadarRegion</a> );
<a name="l00190"></a>00190 
<a name="l00191"></a>00191 }
<a name="l00192"></a>00192 
<a name="l00193"></a>00193 
<a name="l00194"></a><a class="code" href="Radar_01Screen_8h.html#119adbdcb0eb58b01c7c3e8e96566f53">00194</a> <span class="keywordtype">void</span> <a class="code" href="Radar_01Screen_8cpp.html#119adbdcb0eb58b01c7c3e8e96566f53">RadarRegionMoveCallback</a>( <a class="code" href="struct__MOUSE__REGION.html">MOUSE_REGION</a> * pRegion, <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a> iReason )
<a name="l00195"></a>00195 {
<a name="l00196"></a>00196       <a class="code" href="Types_8h.html#30f500129d8c688af07726d5d34ce52d">INT16</a> sRadarX, sRadarY;
<a name="l00197"></a>00197 
<a name="l00198"></a>00198       <span class="comment">// check if we are allowed to do anything?</span>
<a name="l00199"></a>00199       <span class="keywordflow">if</span>( <a class="code" href="Radar_01Screen_8cpp.html#e03d181e5a8d566c4da81d19df7b8207">fRenderRadarScreen</a> == FALSE )
<a name="l00200"></a>00200       {
<a name="l00201"></a>00201             <span class="keywordflow">return</span>;
<a name="l00202"></a>00202       }
<a name="l00203"></a>00203 
<a name="l00204"></a>00204       <span class="keywordflow">if</span> (iReason == MSYS_CALLBACK_REASON_MOVE )
<a name="l00205"></a>00205       {
<a name="l00206"></a>00206             <span class="keywordflow">if</span> ( pRegion-&gt;<a class="code" href="struct__MOUSE__REGION.html#e89a970453235de67a10f6995fb83d1d">ButtonState</a> &amp; MSYS_LEFT_BUTTON )
<a name="l00207"></a>00207             {
<a name="l00208"></a>00208                   <span class="comment">// Use relative coordinates to set center of viewport</span>
<a name="l00209"></a>00209                   sRadarX = pRegion-&gt;<a class="code" href="struct__MOUSE__REGION.html#8dc7b99c79cc383aa4e78907e6954ccd">RelativeXPos</a> - ( RADAR_WINDOW_WIDTH / 2 );                       
<a name="l00210"></a>00210                   sRadarY = pRegion-&gt;<a class="code" href="struct__MOUSE__REGION.html#3710c78535d5fe051824976919b4cb37">RelativeYPos</a> - ( RADAR_WINDOW_HEIGHT / 2 );
<a name="l00211"></a>00211 
<a name="l00212"></a>00212                   <a class="code" href="Radar_01Screen_8cpp.html#9b0cdb6d38a24fd8d8b302d27d302d1c">AdjustWorldCenterFromRadarCoords</a>( sRadarX, sRadarY );
<a name="l00213"></a>00213 
<a name="l00214"></a>00214                   <a class="code" href="renderworld_8cpp.html#986f210b1a26336aa2943bdce24ffb94">SetRenderFlags</a>(RENDER_FLAG_FULL);
<a name="l00215"></a>00215 
<a name="l00216"></a>00216             }
<a name="l00217"></a>00217       }
<a name="l00218"></a>00218 }
<a name="l00219"></a>00219 
<a name="l00220"></a><a class="code" href="Radar_01Screen_8h.html#42da724500614c3a54260eee34f7483d">00220</a> <span class="keywordtype">void</span> <a class="code" href="Radar_01Screen_8cpp.html#42da724500614c3a54260eee34f7483d">RadarRegionButtonCallback</a>( <a class="code" href="struct__MOUSE__REGION.html">MOUSE_REGION</a> * pRegion, <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a> iReason )
<a name="l00221"></a>00221 {
<a name="l00222"></a>00222       <a class="code" href="Types_8h.html#30f500129d8c688af07726d5d34ce52d">INT16</a> sRadarX, sRadarY;
<a name="l00223"></a>00223 
<a name="l00224"></a>00224       <span class="comment">// check if we are allowed to do anything?</span>
<a name="l00225"></a>00225       <span class="keywordflow">if</span>( <a class="code" href="Radar_01Screen_8cpp.html#e03d181e5a8d566c4da81d19df7b8207">fRenderRadarScreen</a> == FALSE )
<a name="l00226"></a>00226       {
<a name="l00227"></a>00227             <span class="keywordflow">return</span>;
<a name="l00228"></a>00228       }
<a name="l00229"></a>00229 
<a name="l00230"></a>00230       <span class="keywordflow">if</span> (iReason &amp; MSYS_CALLBACK_REASON_LBUTTON_DWN)
<a name="l00231"></a>00231       {
<a name="l00232"></a>00232             <span class="keywordflow">if</span> ( !<a class="code" href="overhead_01map_8cpp.html#81b21f30bc370df2ea0bf170a89ff063">InOverheadMap</a>( ) )
<a name="l00233"></a>00233             {
<a name="l00234"></a>00234                   <span class="comment">// Use relative coordinates to set center of viewport</span>
<a name="l00235"></a>00235                   sRadarX = pRegion-&gt;<a class="code" href="struct__MOUSE__REGION.html#8dc7b99c79cc383aa4e78907e6954ccd">RelativeXPos</a> - ( RADAR_WINDOW_WIDTH / 2 );                       
<a name="l00236"></a>00236                   sRadarY = pRegion-&gt;<a class="code" href="struct__MOUSE__REGION.html#3710c78535d5fe051824976919b4cb37">RelativeYPos</a> - ( RADAR_WINDOW_HEIGHT / 2 );
<a name="l00237"></a>00237 
<a name="l00238"></a>00238                   <a class="code" href="Radar_01Screen_8cpp.html#9b0cdb6d38a24fd8d8b302d27d302d1c">AdjustWorldCenterFromRadarCoords</a>( sRadarX, sRadarY );
<a name="l00239"></a>00239             }
<a name="l00240"></a>00240             <span class="keywordflow">else</span>
<a name="l00241"></a>00241             {
<a name="l00242"></a>00242                   <a class="code" href="overhead_01map_8cpp.html#f8aabf66f61434ee38ae0845a28b7ec5">KillOverheadMap</a>();
<a name="l00243"></a>00243             }
<a name="l00244"></a>00244       }
<a name="l00245"></a>00245       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (iReason &amp; MSYS_CALLBACK_REASON_RBUTTON_DWN)
<a name="l00246"></a>00246       {
<a name="l00247"></a>00247             <span class="keywordflow">if</span> ( !<a class="code" href="overhead_01map_8cpp.html#81b21f30bc370df2ea0bf170a89ff063">InOverheadMap</a>( ) )
<a name="l00248"></a>00248             {
<a name="l00249"></a>00249                   <span class="comment">// WANNE 2 &lt;wenn wir im strategy screen sind, darf keine overhead map angezeigt werden!!&gt;</span>
<a name="l00250"></a>00250                   <span class="keywordflow">if</span> (<a class="code" href="local_8h.html#f1b90038040315e66020cbb56e1adcb1">fDisplayOverheadMap</a> == TRUE)
<a name="l00251"></a>00251                         <a class="code" href="overhead_01map_8cpp.html#88a2f677ea9c8918198bf1a80c8abee7">GoIntoOverheadMap</a>( );
<a name="l00252"></a>00252             }
<a name="l00253"></a>00253             <span class="keywordflow">else</span>
<a name="l00254"></a>00254             {
<a name="l00255"></a>00255                   <span class="comment">// WANNE 2 &lt;wenn wir im strategy screen sind, darf keine overhead map angezeigt werden!!&gt;</span>
<a name="l00256"></a>00256                   <span class="keywordflow">if</span> (<a class="code" href="local_8h.html#f1b90038040315e66020cbb56e1adcb1">fDisplayOverheadMap</a> == TRUE)
<a name="l00257"></a>00257                         <a class="code" href="overhead_01map_8cpp.html#f8aabf66f61434ee38ae0845a28b7ec5">KillOverheadMap</a>();
<a name="l00258"></a>00258             }
<a name="l00259"></a>00259       }
<a name="l00260"></a>00260 }
<a name="l00261"></a>00261 
<a name="l00262"></a>00262 
<a name="l00263"></a>00263 
<a name="l00264"></a><a class="code" href="Radar_01Screen_8h.html#ae6cfef6c2717e8138276732c79a9b3f">00264</a> <span class="keywordtype">void</span> <a class="code" href="Radar_01Screen_8cpp.html#ae6cfef6c2717e8138276732c79a9b3f">RenderRadarScreen</a>( )
<a name="l00265"></a>00265 {
<a name="l00266"></a>00266       <a class="code" href="Types_8h.html#30f500129d8c688af07726d5d34ce52d">INT16</a> sRadarTLX, sRadarTLY;
<a name="l00267"></a>00267       <a class="code" href="Types_8h.html#30f500129d8c688af07726d5d34ce52d">INT16</a> sRadarBRX, sRadarBRY;
<a name="l00268"></a>00268       <a class="code" href="Types_8h.html#30f500129d8c688af07726d5d34ce52d">INT16</a> sRadarCX, sRadarCY;
<a name="l00269"></a>00269       <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a> iItemNumber = 0;
<a name="l00270"></a>00270 
<a name="l00271"></a>00271       <a class="code" href="Types_8h.html#30f500129d8c688af07726d5d34ce52d">INT16</a> sX_S, sY_S;
<a name="l00272"></a>00272       <a class="code" href="Types_8h.html#30f500129d8c688af07726d5d34ce52d">INT16</a> sScreenCenterX, sScreenCenterY;
<a name="l00273"></a>00273       <a class="code" href="Types_8h.html#30f500129d8c688af07726d5d34ce52d">INT16</a> sDistToCenterY, sDistToCenterX;
<a name="l00274"></a>00274       <a class="code" href="Types_8h.html#30f500129d8c688af07726d5d34ce52d">INT16</a> sTopLeftWorldX, sTopLeftWorldY;
<a name="l00275"></a>00275       <a class="code" href="Types_8h.html#30f500129d8c688af07726d5d34ce52d">INT16</a> sTopRightWorldX, sTopRightWorldY;
<a name="l00276"></a>00276       <a class="code" href="Types_8h.html#30f500129d8c688af07726d5d34ce52d">INT16</a> sBottomLeftWorldX, sBottomLeftWorldY;
<a name="l00277"></a>00277       <a class="code" href="Types_8h.html#30f500129d8c688af07726d5d34ce52d">INT16</a> sBottomRightWorldX, sBottomRightWorldY;
<a name="l00278"></a>00278 
<a name="l00279"></a>00279 
<a name="l00280"></a>00280       <a class="code" href="structSOLDIERTYPE.html">SOLDIERTYPE</a>                               *<a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>;
<a name="l00281"></a>00281 
<a name="l00282"></a>00282       <a class="code" href="Types_8h.html#30f500129d8c688af07726d5d34ce52d">INT16</a> sXSoldPos, sYSoldPos, sXSoldScreen, sYSoldScreen, sXSoldRadar, sYSoldRadar;
<a name="l00283"></a>00283 
<a name="l00284"></a>00284       <a class="code" href="Types_8h.html#e1e6edbbc26d6fbc71a90190d0266018">UINT32</a>                                                             uiDestPitchBYTES;
<a name="l00285"></a>00285       <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>                                                              *pDestBuf;
<a name="l00286"></a>00286       <a class="code" href="Types_8h.html#09f1a1fb2293e33483cc8d44aefb1eb1">UINT16</a>                                                             usLineColor;
<a name="l00287"></a>00287       <a class="code" href="Types_8h.html#e1e6edbbc26d6fbc71a90190d0266018">UINT32</a>                                                                   cnt;
<a name="l00288"></a>00288       <a class="code" href="Types_8h.html#30f500129d8c688af07726d5d34ce52d">INT16</a>                                                              sHeight, sWidth, sX, sY;
<a name="l00289"></a>00289       <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a>                                                              iCounter = 0;
<a name="l00290"></a>00290 
<a name="l00291"></a>00291 
<a name="l00292"></a>00292       <span class="comment">// create / destroy squad list regions as nessacary</span>
<a name="l00293"></a>00293       <a class="code" href="Radar_01Screen_8cpp.html#cf920f928c1792658334b5f17f5e6dd6">CreateDestroyMouseRegionsForSquadList</a>( );
<a name="l00294"></a>00294 
<a name="l00295"></a>00295       <span class="comment">// check if we are allowed to do anything?</span>
<a name="l00296"></a>00296       <span class="keywordflow">if</span>( <a class="code" href="Radar_01Screen_8cpp.html#e03d181e5a8d566c4da81d19df7b8207">fRenderRadarScreen</a> == FALSE )
<a name="l00297"></a>00297       {
<a name="l00298"></a>00298             <a class="code" href="Radar_01Screen_8cpp.html#a586b51d4decd9be949e0b5eefda92e6">RenderSquadList</a>( );
<a name="l00299"></a>00299             <span class="keywordflow">return</span>;
<a name="l00300"></a>00300       }
<a name="l00301"></a>00301 
<a name="l00302"></a>00302       <span class="keywordflow">if</span>( <a class="code" href="Meanwhile_8cpp.html#469f9fe7efd5677c25840cf980c1fb55">AreInMeanwhile</a>( ) == TRUE )
<a name="l00303"></a>00303       {
<a name="l00304"></a>00304             <span class="comment">// in a meanwhile, don't render any map</span>
<a name="l00305"></a>00305             <a class="code" href="Radar_01Screen_8cpp.html#7145bf7c8af48b567c41ca4ad043fece">fImageLoaded</a> = FALSE;
<a name="l00306"></a>00306       }
<a name="l00307"></a>00307 
<a name="l00308"></a>00308       <span class="keywordflow">if</span> ( <a class="code" href="Interface_8cpp.html#310e02e85df33f7794f5c4c11ae1844d">fInterfacePanelDirty</a> == DIRTYLEVEL2 &amp;&amp; <a class="code" href="Radar_01Screen_8cpp.html#7145bf7c8af48b567c41ca4ad043fece">fImageLoaded</a> )
<a name="l00309"></a>00309       {
<a name="l00310"></a>00310             <span class="comment">// Set to default</span>
<a name="l00311"></a>00311             <a class="code" href="vobject_8cpp.html#6762e31c0b2a07a4309527f61eba8961">SetObjectHandleShade</a>( <a class="code" href="Radar_01Screen_8cpp.html#508392134f5a8c5fba0f36e022bca6f2">gusRadarImage</a>, 0 );
<a name="l00312"></a>00312 
<a name="l00313"></a>00313             <span class="comment">//If night time and on surface, darken the radarmap.</span>
<a name="l00314"></a>00314             <span class="keywordflow">if</span>( <a class="code" href="Game_01Clock_8cpp.html#91be080ca4f751a06c76f34485f568ab">NightTime</a>() )
<a name="l00315"></a>00315             {
<a name="l00316"></a>00316                   <span class="keywordflow">if</span>( <a class="code" href="gameloop_8cpp.html#8cd832c7f0ec6ab02ba9fddd4a2257aa">guiCurrentScreen</a> == <a class="code" href="screenids_8h.html#a4ee5dea8709d2b490486a62df77faf26f9c31d9e3c6ef2f0d8e4917d387b871">MAP_SCREEN</a> &amp;&amp; !<a class="code" href="Map_01Screen_01Interface_01Map_8cpp.html#b52d71b8f7dc10a22568eb52e0c51a3e">iCurrentMapSectorZ</a> ||
<a name="l00317"></a>00317                               <a class="code" href="gameloop_8cpp.html#8cd832c7f0ec6ab02ba9fddd4a2257aa">guiCurrentScreen</a> == <a class="code" href="screenids_8h.html#a4ee5dea8709d2b490486a62df77faf29873e16bc1530dedb416060abbeea6d0">GAME_SCREEN</a> &amp;&amp; !<a class="code" href="strategicmap_8cpp.html#da715721a8ceedd42acf6ddb33e63ce0">gbWorldSectorZ</a> )
<a name="l00318"></a>00318                   {
<a name="l00319"></a>00319                         <a class="code" href="vobject_8cpp.html#6762e31c0b2a07a4309527f61eba8961">SetObjectHandleShade</a>( gusRadarImage, 1 );
<a name="l00320"></a>00320                   }
<a name="l00321"></a>00321             }
<a name="l00322"></a>00322 
<a name="l00323"></a>00323             <a class="code" href="vobject_8cpp.html#8599b65a72008f87d4f9083c8c280d3a">BltVideoObjectFromIndex</a>(  <a class="code" href="Map_01Screen_01Interface_8cpp.html#7d9956b05e9b87e244d4fdab6c4f71e4">guiSAVEBUFFER</a>, gusRadarImage, 0, RADAR_WINDOW_X, <a class="code" href="Radar_01Screen_8cpp.html#0fb3f7a1e0cd24f85cc473fe4c00518c">gsRadarY</a>, VO_BLT_SRCTRANSPARENCY, NULL );
<a name="l00324"></a>00324       }
<a name="l00325"></a>00325 
<a name="l00326"></a>00326       <span class="comment">// FIRST DELETE WHAT'S THERE</span>
<a name="l00327"></a>00327       <a class="code" href="Render_01Dirty_8cpp.html#ce65fac8b540eee1a5bf4902d2dcb0c5">RestoreExternBackgroundRect</a>( RADAR_WINDOW_X, <a class="code" href="Radar_01Screen_8cpp.html#0fb3f7a1e0cd24f85cc473fe4c00518c">gsRadarY</a>, RADAR_WINDOW_WIDTH + 1 , RADAR_WINDOW_HEIGHT + 1 );
<a name="l00328"></a>00328 
<a name="l00329"></a>00329       <span class="comment">// Determine scale factors</span>
<a name="l00330"></a>00330 
<a name="l00331"></a>00331       <span class="comment">// Find the diustance from render center to true world center</span>
<a name="l00332"></a>00332       sDistToCenterX = <a class="code" href="renderworld_8cpp.html#1bf795f2a13e8559ffa77bc67b81dcb7">gsRenderCenterX</a> - <a class="code" href="renderworld_8cpp.html#db9e6efe13a8385af14d35d1443c79a6">gCenterWorldX</a>;
<a name="l00333"></a>00333       sDistToCenterY = <a class="code" href="renderworld_8cpp.html#086faf26457fce933b3a4f2e2ef450f3">gsRenderCenterY</a> - <a class="code" href="renderworld_8cpp.html#8350f407b742c1ef0bc3bc34ff27fda5">gCenterWorldY</a>;
<a name="l00334"></a>00334       
<a name="l00335"></a>00335       <span class="comment">// From render center in world coords, convert to render center in "screen" coords</span>
<a name="l00336"></a>00336       <a class="code" href="Isometric_01Utils_8cpp.html#fe577403021aa9d5adc18b9101823551">FromCellToScreenCoordinates</a>( sDistToCenterX , sDistToCenterY, &amp;sScreenCenterX, &amp;sScreenCenterY );
<a name="l00337"></a>00337 
<a name="l00338"></a>00338       <span class="comment">// Subtract screen center</span>
<a name="l00339"></a>00339       sScreenCenterX += <a class="code" href="renderworld_8cpp.html#11566a371fd0b98061f2d88c2fa18e8c">gsCX</a>;
<a name="l00340"></a>00340       sScreenCenterY += <a class="code" href="renderworld_8cpp.html#1aff6d0d29cf5a0ebe0e3030b3f1cc5f">gsCY</a>;
<a name="l00341"></a>00341 
<a name="l00342"></a>00342       <span class="comment">// Get corners in screen coords</span>
<a name="l00343"></a>00343       <span class="comment">// TOP LEFT</span>
<a name="l00344"></a>00344       sX_S = ( ( <a class="code" href="renderworld_8cpp.html#829facd7abae54fcc284037c443e54bf">gsVIEWPORT_END_X</a> - <a class="code" href="renderworld_8cpp.html#81bf7674212c692b12d2fd3c41050c9b">gsVIEWPORT_START_X</a> ) /2 );
<a name="l00345"></a>00345       sY_S = ( ( <a class="code" href="HelpScreen_8cpp.html#268f46eb948cd6eb0f3406b688e4ccaa">gsVIEWPORT_END_Y</a> - <a class="code" href="renderworld_8cpp.html#71c227d79f4390bf0c95bfe1050ce147">gsVIEWPORT_START_Y</a> ) /2 );
<a name="l00346"></a>00346 
<a name="l00347"></a>00347       sTopLeftWorldX = sScreenCenterX  - sX_S;
<a name="l00348"></a>00348       sTopLeftWorldY = sScreenCenterY  - sY_S;
<a name="l00349"></a>00349 
<a name="l00350"></a>00350       sTopRightWorldX = sScreenCenterX  + sX_S;
<a name="l00351"></a>00351       sTopRightWorldY = sScreenCenterY  - sY_S;
<a name="l00352"></a>00352       
<a name="l00353"></a>00353       sBottomLeftWorldX = sScreenCenterX  - sX_S;
<a name="l00354"></a>00354       sBottomLeftWorldY = sScreenCenterY  + sY_S;
<a name="l00355"></a>00355 
<a name="l00356"></a>00356       sBottomRightWorldX = sScreenCenterX  + sX_S;
<a name="l00357"></a>00357       sBottomRightWorldY = sScreenCenterY  + sY_S;
<a name="l00358"></a>00358 
<a name="l00359"></a>00359 
<a name="l00360"></a>00360       <span class="comment">// Determine radar coordinates</span>
<a name="l00361"></a>00361       sRadarCX    = (<a class="code" href="Types_8h.html#30f500129d8c688af07726d5d34ce52d">INT16</a>)( <a class="code" href="renderworld_8cpp.html#11566a371fd0b98061f2d88c2fa18e8c">gsCX</a> * <a class="code" href="renderworld_8cpp.html#9f1e8b7f9c2ac5fec0be4027938a41fb">gdScaleX</a> );
<a name="l00362"></a>00362       sRadarCY    = (<a class="code" href="Types_8h.html#30f500129d8c688af07726d5d34ce52d">INT16</a>)( <a class="code" href="renderworld_8cpp.html#1aff6d0d29cf5a0ebe0e3030b3f1cc5f">gsCY</a> * <a class="code" href="renderworld_8cpp.html#6232265ae977f0ea84196728f0d34fac">gdScaleY</a> );
<a name="l00363"></a>00363 
<a name="l00364"></a>00364 
<a name="l00365"></a>00365       sWidth            = ( RADAR_WINDOW_WIDTH );
<a name="l00366"></a>00366       sHeight           = ( RADAR_WINDOW_HEIGHT );
<a name="l00367"></a>00367       sX                      = RADAR_WINDOW_X;
<a name="l00368"></a>00368       sY                      = <a class="code" href="Radar_01Screen_8cpp.html#0fb3f7a1e0cd24f85cc473fe4c00518c">gsRadarY</a>;
<a name="l00369"></a>00369 
<a name="l00370"></a>00370 
<a name="l00371"></a>00371       sRadarTLX = (<a class="code" href="Types_8h.html#30f500129d8c688af07726d5d34ce52d">INT16</a>)( ( sTopLeftWorldX * gdScaleX ) - sRadarCX  + sX + ( sWidth /2 ) );
<a name="l00372"></a>00372       sRadarTLY = (<a class="code" href="Types_8h.html#30f500129d8c688af07726d5d34ce52d">INT16</a>)( ( sTopLeftWorldY * gdScaleY ) - sRadarCY + <a class="code" href="Radar_01Screen_8cpp.html#0fb3f7a1e0cd24f85cc473fe4c00518c">gsRadarY</a> + ( sHeight /2 ) ); 
<a name="l00373"></a>00373       sRadarBRX = (<a class="code" href="Types_8h.html#30f500129d8c688af07726d5d34ce52d">INT16</a>)( ( sBottomRightWorldX * gdScaleX ) - sRadarCX + sX + ( sWidth /2 ) );
<a name="l00374"></a>00374       sRadarBRY = (<a class="code" href="Types_8h.html#30f500129d8c688af07726d5d34ce52d">INT16</a>)( ( sBottomRightWorldY * gdScaleY ) - sRadarCY + <a class="code" href="Radar_01Screen_8cpp.html#0fb3f7a1e0cd24f85cc473fe4c00518c">gsRadarY</a> + ( sHeight /2 ) );
<a name="l00375"></a>00375 
<a name="l00376"></a>00376       pDestBuf = <a class="code" href="vsurface_8cpp.html#592b2aeda6075fcbf9d7c67dc44fbd47">LockVideoSurface</a>( FRAME_BUFFER, &amp;uiDestPitchBYTES );
<a name="l00377"></a>00377       
<a name="l00378"></a>00378 
<a name="l00379"></a>00379       <a class="code" href="line_8cpp.html#03cb6a8fa3b4bbdfcdab02c903bc7b7e">SetClippingRegionAndImageWidth</a>( uiDestPitchBYTES, RADAR_WINDOW_X, <a class="code" href="Radar_01Screen_8cpp.html#0fb3f7a1e0cd24f85cc473fe4c00518c">gsRadarY</a>, ( RADAR_WINDOW_X + RADAR_WINDOW_WIDTH - 1 ), ( <a class="code" href="Radar_01Screen_8cpp.html#0fb3f7a1e0cd24f85cc473fe4c00518c">gsRadarY</a> + RADAR_WINDOW_HEIGHT - 1 ) );
<a name="l00380"></a>00380 
<a name="l00381"></a>00381       <span class="keywordflow">if</span>( !( <a class="code" href="Interface_01Control_8cpp.html#13888453701b7175bfe2287212a0d666">guiTacticalInterfaceFlags</a> &amp; INTERFACE_MAPSCREEN ) )
<a name="l00382"></a>00382       {
<a name="l00383"></a>00383             <span class="keywordflow">if</span>(<a class="code" href="sgp_8cpp.html#46d5731b102af0b40311b8351c758c55">gbPixelDepth</a>==16)
<a name="l00384"></a>00384             {
<a name="l00385"></a>00385                   usLineColor = <a class="code" href="himage_8cpp.html#d29939ffcd39c7d1cc0a91222702d361">Get16BPPColor</a>( FROMRGB( 0, 255, 0 ) );
<a name="l00386"></a>00386                   <a class="code" href="line_8cpp.html#2806e958344a513567053e98757e64b3">RectangleDraw</a>( TRUE, sRadarTLX, sRadarTLY, sRadarBRX, sRadarBRY - 1, usLineColor, pDestBuf );
<a name="l00387"></a>00387             }
<a name="l00388"></a>00388             <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="sgp_8cpp.html#46d5731b102af0b40311b8351c758c55">gbPixelDepth</a>==8)
<a name="l00389"></a>00389             {
<a name="l00390"></a>00390                   <span class="comment">// DB Need to change this to a color from the 8-but standard palette</span>
<a name="l00391"></a>00391                   usLineColor = COLOR_GREEN;
<a name="l00392"></a>00392                   <a class="code" href="line_8cpp.html#68b44275296f85848b95e69b58b25f5e">RectangleDraw8</a>( TRUE, sRadarTLX + 1, sRadarTLY + 1, sRadarBRX + 1, sRadarBRY + 1, usLineColor, pDestBuf );
<a name="l00393"></a>00393             }
<a name="l00394"></a>00394       }
<a name="l00395"></a>00395 
<a name="l00396"></a>00396       <span class="comment">// Cycle fFlash variable</span>
<a name="l00397"></a>00397       <span class="keywordflow">if</span> ( COUNTERDONE( <a class="code" href="Timer_01Control_8h.html#9a17283e1986c46118656d6ddc9026c3187231acdc48e257ea41359325a0bec0">RADAR_MAP_BLINK</a> ) )
<a name="l00398"></a>00398       {
<a name="l00399"></a>00399             RESETCOUNTER( <a class="code" href="Timer_01Control_8h.html#9a17283e1986c46118656d6ddc9026c3187231acdc48e257ea41359325a0bec0">RADAR_MAP_BLINK</a> );
<a name="l00400"></a>00400 
<a name="l00401"></a>00401             <a class="code" href="overhead_01map_8cpp.html#d67b5f40f4ea195962db568c90be628a">gfRadarCurrentGuyFlash</a> = !<a class="code" href="overhead_01map_8cpp.html#d67b5f40f4ea195962db568c90be628a">gfRadarCurrentGuyFlash</a>;
<a name="l00402"></a>00402       }
<a name="l00403"></a>00403 
<a name="l00404"></a>00404       <span class="keywordflow">if</span>( ( <a class="code" href="Interface_01Control_8cpp.html#13888453701b7175bfe2287212a0d666">guiTacticalInterfaceFlags</a> &amp; INTERFACE_MAPSCREEN ) &amp;&amp; ( <a class="code" href="HelpScreen_8cpp.html#2f4cf093fe7eaaf55cbbf5898cd93ce7">fShowMapInventoryPool</a> == TRUE ) )
<a name="l00405"></a>00405       {
<a name="l00406"></a>00406             <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a> iNumberOfItems = 0;
<a name="l00407"></a>00407 
<a name="l00408"></a>00408             iNumberOfItems = <a class="code" href="Map_01Screen_01Interface_01Map_01Inventory_8cpp.html#f68fa633eb4af116bda1a2024f6f463f">GetTotalNumberOfItems</a>( );
<a name="l00409"></a>00409 
<a name="l00410"></a>00410             <span class="keywordflow">for</span>( iCounter = 0; iCounter &lt; <a class="code" href="Map_01Screen_01Interface_01Map_01Inventory_8cpp.html#561baad2f388f107d71120b3caf03cf9">MAP_INVENTORY_POOL_SLOT_COUNT</a>; iCounter++ )
<a name="l00411"></a>00411             {
<a name="l00412"></a>00412 
<a name="l00413"></a>00413                   iItemNumber = iCounter + <a class="code" href="Map_01Screen_01Interface_01Map_01Inventory_8cpp.html#c34410c79c7730af1d3f67d6684ec018">iCurrentInventoryPoolPage</a> * MAP_INVENTORY_POOL_SLOT_COUNT;
<a name="l00414"></a>00414                   <span class="comment">// stolen item</span>
<a name="l00415"></a>00415                   <span class="keywordflow">if</span>( ( <a class="code" href="Map_01Screen_01Interface_01Map_01Inventory_8cpp.html#8c1e63f4ec44a8d61968d9cb2b2dd19a">pInventoryPoolList</a>[ iItemNumber ].o.ubNumberOfObjects == 0 )||( <a class="code" href="Map_01Screen_01Interface_01Map_01Inventory_8cpp.html#8c1e63f4ec44a8d61968d9cb2b2dd19a">pInventoryPoolList</a>[ iItemNumber ].<a class="code" href="structWORLDITEM.html#cc0f6c24ddf55cfb9ae145f66d2196f5">sGridNo</a> == 0 ) )
<a name="l00416"></a>00416                   {
<a name="l00417"></a>00417                         <span class="comment">// yep, continue on</span>
<a name="l00418"></a>00418                         <span class="keywordflow">continue</span>;
<a name="l00419"></a>00419                   }
<a name="l00420"></a>00420 
<a name="l00421"></a>00421                   <a class="code" href="Isometric_01Utils_8cpp.html#42da2d46d5074c97787f28fdf5c51073">ConvertGridNoToXY</a>( <a class="code" href="Map_01Screen_01Interface_01Map_01Inventory_8cpp.html#8c1e63f4ec44a8d61968d9cb2b2dd19a">pInventoryPoolList</a>[ iItemNumber ].sGridNo, &amp;sXSoldPos, &amp;sYSoldPos );
<a name="l00422"></a>00422                   <a class="code" href="Isometric_01Utils_8cpp.html#9e57f3b828ab5d455b414cd056b02e58">GetWorldXYAbsoluteScreenXY</a>( sXSoldPos, sYSoldPos, &amp;sXSoldScreen, &amp;sYSoldScreen );
<a name="l00423"></a>00423 
<a name="l00424"></a>00424                   <span class="comment">// get radar x and y postion</span>
<a name="l00425"></a>00425                   sXSoldRadar = (<a class="code" href="Types_8h.html#30f500129d8c688af07726d5d34ce52d">INT16</a>)( sXSoldScreen * gdScaleX );
<a name="l00426"></a>00426                   sYSoldRadar = (<a class="code" href="Types_8h.html#30f500129d8c688af07726d5d34ce52d">INT16</a>)( sYSoldScreen * gdScaleY );
<a name="l00427"></a>00427 
<a name="l00428"></a>00428 
<a name="l00429"></a>00429                   <span class="comment">// Add starting relative to interface</span>
<a name="l00430"></a>00430                   sXSoldRadar += RADAR_WINDOW_X;
<a name="l00431"></a>00431                   sYSoldRadar += <a class="code" href="Radar_01Screen_8cpp.html#0fb3f7a1e0cd24f85cc473fe4c00518c">gsRadarY</a>;
<a name="l00432"></a>00432 
<a name="l00433"></a>00433                   <span class="comment">// if we are in 16 bit mode....kind of redundant</span>
<a name="l00434"></a>00434                   <span class="keywordflow">if</span>(<a class="code" href="sgp_8cpp.html#46d5731b102af0b40311b8351c758c55">gbPixelDepth</a>==16)
<a name="l00435"></a>00435                   {
<a name="l00436"></a>00436                         <span class="keywordflow">if</span>( ( <a class="code" href="Map_01Screen_01Interface_01Map_01Inventory_8cpp.html#850c1acffd13812a2ba7d14c7c7aff9a">fFlashHighLightInventoryItemOnradarMap</a> ) )
<a name="l00437"></a>00437                         {
<a name="l00438"></a>00438                               usLineColor = <a class="code" href="himage_8cpp.html#d29939ffcd39c7d1cc0a91222702d361">Get16BPPColor</a>( FROMRGB(  0,  255,  0 ) );
<a name="l00439"></a>00439 
<a name="l00440"></a>00440                         }
<a name="l00441"></a>00441                         <span class="keywordflow">else</span>
<a name="l00442"></a>00442                         {
<a name="l00443"></a>00443                               <span class="comment">// DB Need to add a radar color for 8-bit</span>
<a name="l00444"></a>00444                               usLineColor = <a class="code" href="himage_8cpp.html#d29939ffcd39c7d1cc0a91222702d361">Get16BPPColor</a>( FROMRGB(  255,  255,  255 ) );
<a name="l00445"></a>00445                         }
<a name="l00446"></a>00446 
<a name="l00447"></a>00447                         <span class="keywordflow">if</span>( <a class="code" href="Map_01Screen_01Interface_01Map_01Inventory_8cpp.html#dad946cc6119bf995b6ec80b59b3c3f9">iCurrentlyHighLightedItem</a> == iCounter )
<a name="l00448"></a>00448                         {
<a name="l00449"></a>00449                               <a class="code" href="line_8cpp.html#2806e958344a513567053e98757e64b3">RectangleDraw</a>( TRUE, sXSoldRadar, sYSoldRadar, sXSoldRadar + 1, sYSoldRadar + 1, usLineColor, pDestBuf );
<a name="l00450"></a>00450                         }
<a name="l00451"></a>00451                   }
<a name="l00452"></a>00452             }
<a name="l00453"></a>00453       }
<a name="l00454"></a>00454       
<a name="l00455"></a>00455       <span class="keywordflow">if</span>( !( <a class="code" href="Interface_01Control_8cpp.html#13888453701b7175bfe2287212a0d666">guiTacticalInterfaceFlags</a> &amp; INTERFACE_MAPSCREEN ) )
<a name="l00456"></a>00456       {
<a name="l00457"></a>00457             <span class="comment">// RE-RENDER RADAR</span>
<a name="l00458"></a>00458             <span class="keywordflow">for</span> ( cnt = 0; cnt &lt; <a class="code" href="Overhead_8cpp.html#d627c552ede524c66140f3410174d3d4">guiNumMercSlots</a>; cnt++ )
<a name="l00459"></a>00459             {
<a name="l00460"></a>00460                   <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a> = <a class="code" href="Overhead_8cpp.html#b139938f6b836645dd67972944d21bf3">MercSlots</a>[ cnt ];
<a name="l00461"></a>00461 
<a name="l00462"></a>00462                   <span class="keywordflow">if</span> ( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a> != NULL )
<a name="l00463"></a>00463                   {     
<a name="l00464"></a>00464                         <span class="comment">// Don't place guys in radar until visible!</span>
<a name="l00465"></a>00465                         <span class="keywordflow">if</span> ( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#73246323764393ce2a5ece7fcb7b7cf8">bVisible</a> == -1 &amp;&amp; !(<a class="code" href="Overhead_8cpp.html#46bd754f8875c305ab18731ed10e3364">gTacticalStatus</a>.<a class="code" href="structTacticalStatusType.html#89eb954f99ad4f28b84d7cf675c8ed32">uiFlags</a>&amp;SHOW_ALL_MERCS) &amp;&amp; !(<a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#2ac7fd8c383d60ee8c70ab301ddd905d">ubMiscSoldierFlags</a> &amp; SOLDIER_MISC_XRAYED) )
<a name="l00466"></a>00466                         {
<a name="l00467"></a>00467                               <span class="keywordflow">continue</span>;
<a name="l00468"></a>00468                         }
<a name="l00469"></a>00469 
<a name="l00470"></a>00470                         <span class="comment">// Don't render guys if they are dead!</span>
<a name="l00471"></a>00471                         <span class="keywordflow">if</span> ( ( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#eb633099940bc20ff5a969bce84eab42">uiStatusFlags</a> &amp; SOLDIER_DEAD ) )
<a name="l00472"></a>00472                         {
<a name="l00473"></a>00473                               <span class="keywordflow">continue</span>;
<a name="l00474"></a>00474                         }
<a name="l00475"></a>00475 
<a name="l00476"></a>00476                         <span class="comment">// Don't render crows</span>
<a name="l00477"></a>00477                         <span class="keywordflow">if</span> ( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#b082364eed3d7883662f69e1fd96be1a">ubBodyType</a> == <a class="code" href="Animation_01Data_8h.html#d295a916825180b548473dec560093a7143fbbb5aa867c244f7cf6a230545002">CROW</a> )
<a name="l00478"></a>00478                         {
<a name="l00479"></a>00479                               <span class="keywordflow">continue</span>;
<a name="l00480"></a>00480                         }
<a name="l00481"></a>00481 
<a name="l00482"></a>00482                         <span class="comment">// Get FULL screen coordinate for guy's position</span>
<a name="l00483"></a>00483                         <span class="comment">// Getxy from gridno</span>
<a name="l00484"></a>00484                         <a class="code" href="Isometric_01Utils_8cpp.html#42da2d46d5074c97787f28fdf5c51073">ConvertGridNoToXY</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#2ab66ee0f37902cd448f4a738df4f2bf">sGridNo</a>, &amp;sXSoldPos, &amp;sYSoldPos );
<a name="l00485"></a>00485                         <a class="code" href="Isometric_01Utils_8cpp.html#9e57f3b828ab5d455b414cd056b02e58">GetWorldXYAbsoluteScreenXY</a>( sXSoldPos, sYSoldPos, &amp;sXSoldScreen, &amp;sYSoldScreen );
<a name="l00486"></a>00486 
<a name="l00487"></a>00487                         sXSoldRadar = (<a class="code" href="Types_8h.html#30f500129d8c688af07726d5d34ce52d">INT16</a>)( sXSoldScreen * <a class="code" href="renderworld_8cpp.html#9f1e8b7f9c2ac5fec0be4027938a41fb">gdScaleX</a> );
<a name="l00488"></a>00488                         sYSoldRadar = (<a class="code" href="Types_8h.html#30f500129d8c688af07726d5d34ce52d">INT16</a>)( sYSoldScreen * <a class="code" href="renderworld_8cpp.html#6232265ae977f0ea84196728f0d34fac">gdScaleY</a> );
<a name="l00489"></a>00489 
<a name="l00490"></a>00490                         <span class="keywordflow">if</span> ( !<a class="code" href="Overhead_8h.html#c6ef0118bce5c2179d6f03d98ee84f5f">SoldierOnVisibleWorldTile</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a> ) )
<a name="l00491"></a>00491                         {
<a name="l00492"></a>00492                               <span class="keywordflow">continue</span>;
<a name="l00493"></a>00493                         }
<a name="l00494"></a>00494 
<a name="l00495"></a>00495                         <span class="comment">// Add starting relative to interface</span>
<a name="l00496"></a>00496                         sXSoldRadar += RADAR_WINDOW_X;
<a name="l00497"></a>00497                         sYSoldRadar += <a class="code" href="Radar_01Screen_8cpp.html#0fb3f7a1e0cd24f85cc473fe4c00518c">gsRadarY</a>;
<a name="l00498"></a>00498 
<a name="l00499"></a>00499 
<a name="l00500"></a>00500                         <span class="keywordflow">if</span>(<a class="code" href="sgp_8cpp.html#46d5731b102af0b40311b8351c758c55">gbPixelDepth</a>==16)
<a name="l00501"></a>00501                         {
<a name="l00502"></a>00502                               <span class="comment">// DB Need to add a radar color for 8-bit </span>
<a name="l00503"></a>00503 
<a name="l00504"></a>00504                               <span class="comment">// Are we a selected guy?</span>
<a name="l00505"></a>00505                               <span class="keywordflow">if</span> ( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#18aef170576da81b10d00e7b6cd3627b">ubID</a> == <a class="code" href="Interface_01Utils_8cpp.html#07d83e717b98bc3cf6628f0bb9bc9205">gusSelectedSoldier</a> )
<a name="l00506"></a>00506                               {
<a name="l00507"></a>00507                                     <span class="keywordflow">if</span> ( <a class="code" href="overhead_01map_8cpp.html#d67b5f40f4ea195962db568c90be628a">gfRadarCurrentGuyFlash</a> )
<a name="l00508"></a>00508                                     {
<a name="l00509"></a>00509                                           usLineColor = 0;
<a name="l00510"></a>00510                                     }
<a name="l00511"></a>00511                                     <span class="keywordflow">else</span>
<a name="l00512"></a>00512                                     {
<a name="l00513"></a>00513               <span class="comment">// If on roof, make darker....</span>
<a name="l00514"></a>00514               <span class="keywordflow">if</span> ( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#0d1f73c5d0ac839ec84a4792505949cb">bLevel</a> &gt; 0 )
<a name="l00515"></a>00515               {
<a name="l00516"></a>00516                                         usLineColor = <a class="code" href="himage_8cpp.html#d29939ffcd39c7d1cc0a91222702d361">Get16BPPColor</a>( FROMRGB( 150, 150, 0 ) );
<a name="l00517"></a>00517               }
<a name="l00518"></a>00518               <span class="keywordflow">else</span>
<a name="l00519"></a>00519               {
<a name="l00520"></a>00520                                             usLineColor = <a class="code" href="himage_8cpp.html#d29939ffcd39c7d1cc0a91222702d361">Get16BPPColor</a>( <a class="code" href="Overhead_8cpp.html#46bd754f8875c305ab18731ed10e3364">gTacticalStatus</a>.<a class="code" href="structTacticalStatusType.html#2ecddfe580bb019bc92cc4859eaf3edc">Team</a>[ <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#74a40a8aaf3efe840cdaf6be62556d82">bTeam</a> ].RadarColor );
<a name="l00521"></a>00521               }
<a name="l00522"></a>00522                                     }                             
<a name="l00523"></a>00523                               }
<a name="l00524"></a>00524                               <span class="keywordflow">else</span>
<a name="l00525"></a>00525                               {
<a name="l00526"></a>00526                                     usLineColor = <a class="code" href="himage_8cpp.html#d29939ffcd39c7d1cc0a91222702d361">Get16BPPColor</a>( <a class="code" href="Overhead_8cpp.html#46bd754f8875c305ab18731ed10e3364">gTacticalStatus</a>.<a class="code" href="structTacticalStatusType.html#2ecddfe580bb019bc92cc4859eaf3edc">Team</a>[ <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#74a40a8aaf3efe840cdaf6be62556d82">bTeam</a> ].RadarColor );
<a name="l00527"></a>00527 
<a name="l00528"></a>00528             <span class="comment">// Override civ team with red if hostile...</span>
<a name="l00529"></a>00529             <span class="keywordflow">if</span> ( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#74a40a8aaf3efe840cdaf6be62556d82">bTeam</a> == CIV_TEAM &amp;&amp; !<a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#165874ef5822faaf165da91996ad4a7b">bNeutral</a> &amp;&amp; ( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#1e61c0006bacccf9457c3f6c43607578">bSide</a> != <a class="code" href="Campaign_8cpp.html#47b2067ff75193e24776eda5297400ff">gbPlayerNum</a> ) )
<a name="l00530"></a>00530             {
<a name="l00531"></a>00531                                           usLineColor = <a class="code" href="himage_8cpp.html#d29939ffcd39c7d1cc0a91222702d361">Get16BPPColor</a>( FROMRGB( 255, 0, 0 ) );
<a name="l00532"></a>00532             }
<a name="l00533"></a>00533 
<a name="l00534"></a>00534                                     <span class="comment">// Render different color if an enemy and he's unconscious</span>
<a name="l00535"></a>00535                                     <span class="keywordflow">if</span> ( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#74a40a8aaf3efe840cdaf6be62556d82">bTeam</a> != <a class="code" href="Campaign_8cpp.html#47b2067ff75193e24776eda5297400ff">gbPlayerNum</a> &amp;&amp; <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#e308dea18533bf5ab2bcee5bbe27391c">bLife</a> &lt; OKLIFE )
<a name="l00536"></a>00536                                     {
<a name="l00537"></a>00537                                           usLineColor = <a class="code" href="himage_8cpp.html#d29939ffcd39c7d1cc0a91222702d361">Get16BPPColor</a>( FROMRGB( 128, 128, 128 ) );
<a name="l00538"></a>00538                                     }
<a name="l00539"></a>00539 
<a name="l00540"></a>00540             <span class="comment">// If on roof, make darker....</span>
<a name="l00541"></a>00541             <span class="keywordflow">if</span> ( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#74a40a8aaf3efe840cdaf6be62556d82">bTeam</a> == <a class="code" href="Campaign_8cpp.html#47b2067ff75193e24776eda5297400ff">gbPlayerNum</a> &amp;&amp; <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#0d1f73c5d0ac839ec84a4792505949cb">bLevel</a> &gt; 0 )
<a name="l00542"></a>00542             {
<a name="l00543"></a>00543                                       usLineColor = <a class="code" href="himage_8cpp.html#d29939ffcd39c7d1cc0a91222702d361">Get16BPPColor</a>( FROMRGB( 150, 150, 0 ) );
<a name="l00544"></a>00544             }
<a name="l00545"></a>00545                               }
<a name="l00546"></a>00546 
<a name="l00547"></a>00547                               <a class="code" href="line_8cpp.html#2806e958344a513567053e98757e64b3">RectangleDraw</a>( TRUE, sXSoldRadar, sYSoldRadar, sXSoldRadar+1, sYSoldRadar+1, usLineColor, pDestBuf ); 
<a name="l00548"></a>00548                         }
<a name="l00549"></a>00549                         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="sgp_8cpp.html#46d5731b102af0b40311b8351c758c55">gbPixelDepth</a>==8)
<a name="l00550"></a>00550                         {
<a name="l00551"></a>00551                               <span class="comment">// DB Need to change this to a color from the 8-but standard palette</span>
<a name="l00552"></a>00552                               usLineColor = COLOR_BLUE;
<a name="l00553"></a>00553                               <a class="code" href="line_8cpp.html#68b44275296f85848b95e69b58b25f5e">RectangleDraw8</a>( TRUE, sXSoldRadar, sYSoldRadar, sXSoldRadar+1, sYSoldRadar+1, usLineColor, pDestBuf );      
<a name="l00554"></a>00554                         }
<a name="l00555"></a>00555                   }
<a name="l00556"></a>00556             }
<a name="l00557"></a>00557       }
<a name="l00558"></a>00558       <a class="code" href="vsurface_8cpp.html#abe4e4124597b70b046a3b3567002cb2">UnLockVideoSurface</a>( FRAME_BUFFER );
<a name="l00559"></a>00559 
<a name="l00560"></a>00560 
<a name="l00561"></a>00561       <span class="keywordflow">if</span>( ( <a class="code" href="Interface_01Control_8cpp.html#13888453701b7175bfe2287212a0d666">guiTacticalInterfaceFlags</a> &amp; INTERFACE_MAPSCREEN ) &amp;&amp; ( <a class="code" href="HelpScreen_8cpp.html#2f4cf093fe7eaaf55cbbf5898cd93ce7">fShowMapInventoryPool</a> == TRUE ) )
<a name="l00562"></a>00562       {
<a name="l00563"></a>00563             <a class="code" href="video_8cpp.html#4ed7790da612ff97bf9c05cf186823bc">InvalidateRegion</a>( RADAR_WINDOW_X, <a class="code" href="Radar_01Screen_8cpp.html#0fb3f7a1e0cd24f85cc473fe4c00518c">gsRadarY</a>,
<a name="l00564"></a>00564                                                             RADAR_WINDOW_X + RADAR_WINDOW_WIDTH,
<a name="l00565"></a>00565                                                             <a class="code" href="Radar_01Screen_8cpp.html#0fb3f7a1e0cd24f85cc473fe4c00518c">gsRadarY</a> + RADAR_WINDOW_HEIGHT );
<a name="l00566"></a>00566       }
<a name="l00567"></a>00567 
<a name="l00568"></a>00568       <span class="keywordflow">return</span>;
<a name="l00569"></a>00569 
<a name="l00570"></a>00570 
<a name="l00571"></a>00571 }
<a name="l00572"></a>00572 
<a name="l00573"></a>00573 
<a name="l00574"></a><a class="code" href="Radar_01Screen_8cpp.html#9b0cdb6d38a24fd8d8b302d27d302d1c">00574</a> <span class="keywordtype">void</span> <a class="code" href="Radar_01Screen_8cpp.html#9b0cdb6d38a24fd8d8b302d27d302d1c">AdjustWorldCenterFromRadarCoords</a>( <a class="code" href="Types_8h.html#30f500129d8c688af07726d5d34ce52d">INT16</a> sRadarX, <a class="code" href="Types_8h.html#30f500129d8c688af07726d5d34ce52d">INT16</a> sRadarY )
<a name="l00575"></a>00575 {
<a name="l00576"></a>00576       <a class="code" href="Types_8h.html#30f500129d8c688af07726d5d34ce52d">INT16</a> sScreenX, sScreenY;
<a name="l00577"></a>00577       <a class="code" href="Types_8h.html#30f500129d8c688af07726d5d34ce52d">INT16</a> sTempX_W, sTempY_W;
<a name="l00578"></a>00578       <a class="code" href="Types_8h.html#30f500129d8c688af07726d5d34ce52d">INT16</a> sNewCenterWorldX, sNewCenterWorldY;
<a name="l00579"></a>00579       <a class="code" href="Types_8h.html#30f500129d8c688af07726d5d34ce52d">INT16</a> sNumXSteps, sNumYSteps;
<a name="l00580"></a>00580 
<a name="l00581"></a>00581       <span class="comment">// Use radar scale values to get screen values, then convert ot map values, rounding to nearest middle tile</span>
<a name="l00582"></a>00582       sScreenX = (<a class="code" href="Types_8h.html#30f500129d8c688af07726d5d34ce52d">INT16</a>) ( sRadarX / gdScaleX );
<a name="l00583"></a>00583       sScreenY = (<a class="code" href="Types_8h.html#30f500129d8c688af07726d5d34ce52d">INT16</a>) ( sRadarY / gdScaleY );
<a name="l00584"></a>00584 
<a name="l00585"></a>00585       <span class="comment">// Adjust to viewport start!</span>
<a name="l00586"></a>00586       sScreenX -= ( ( <a class="code" href="renderworld_8cpp.html#829facd7abae54fcc284037c443e54bf">gsVIEWPORT_END_X</a> - <a class="code" href="renderworld_8cpp.html#81bf7674212c692b12d2fd3c41050c9b">gsVIEWPORT_START_X</a> ) /2 );
<a name="l00587"></a>00587       sScreenY -= ( ( <a class="code" href="HelpScreen_8cpp.html#268f46eb948cd6eb0f3406b688e4ccaa">gsVIEWPORT_END_Y</a> - <a class="code" href="renderworld_8cpp.html#71c227d79f4390bf0c95bfe1050ce147">gsVIEWPORT_START_Y</a> ) /2 );
<a name="l00588"></a>00588 
<a name="l00589"></a>00589       <span class="comment">//Make sure these coordinates are multiples of scroll steps</span>
<a name="l00590"></a>00590       sNumXSteps = sScreenX  / <a class="code" href="renderworld_8cpp.html#4be52e33f966c40b6b51a2635a7585bb">SCROLL_X_STEP</a>;
<a name="l00591"></a>00591       sNumYSteps = sScreenY / <a class="code" href="renderworld_8cpp.html#749415cf996d8cec946a30b6a1b4ca38">SCROLL_Y_STEP</a>;
<a name="l00592"></a>00592 
<a name="l00593"></a>00593       sScreenX = ( sNumXSteps * <a class="code" href="renderworld_8cpp.html#4be52e33f966c40b6b51a2635a7585bb">SCROLL_X_STEP</a> );
<a name="l00594"></a>00594       sScreenY = ( sNumYSteps * <a class="code" href="renderworld_8cpp.html#749415cf996d8cec946a30b6a1b4ca38">SCROLL_Y_STEP</a> );
<a name="l00595"></a>00595 
<a name="l00596"></a>00596       <span class="comment">// Adjust back</span>
<a name="l00597"></a>00597       sScreenX += ( ( <a class="code" href="renderworld_8cpp.html#829facd7abae54fcc284037c443e54bf">gsVIEWPORT_END_X</a> - <a class="code" href="renderworld_8cpp.html#81bf7674212c692b12d2fd3c41050c9b">gsVIEWPORT_START_X</a>  ) /2 );
<a name="l00598"></a>00598       sScreenY += ( ( <a class="code" href="HelpScreen_8cpp.html#268f46eb948cd6eb0f3406b688e4ccaa">gsVIEWPORT_END_Y</a> - <a class="code" href="renderworld_8cpp.html#71c227d79f4390bf0c95bfe1050ce147">gsVIEWPORT_START_Y</a>  ) /2 );
<a name="l00599"></a>00599 
<a name="l00600"></a>00600       <span class="comment">// Subtract world center</span>
<a name="l00601"></a>00601       <span class="comment">//sScreenX += gsCX;</span>
<a name="l00602"></a>00602       <span class="comment">//sScreenY += gsCY;</span>
<a name="l00603"></a>00603 
<a name="l00604"></a>00604       <span class="comment">// Convert these into world coordinates</span>
<a name="l00605"></a>00605       <a class="code" href="Isometric_01Utils_8cpp.html#8be938f454609e784861c045e7291f11">FromScreenToCellCoordinates</a>( sScreenX, sScreenY, &amp;sTempX_W, &amp;sTempY_W );
<a name="l00606"></a>00606 
<a name="l00607"></a>00607       <span class="comment">// Adjust these to world center</span>
<a name="l00608"></a>00608       sNewCenterWorldX = (<a class="code" href="Types_8h.html#30f500129d8c688af07726d5d34ce52d">INT16</a>)(<a class="code" href="renderworld_8cpp.html#db9e6efe13a8385af14d35d1443c79a6">gCenterWorldX</a> + sTempX_W);
<a name="l00609"></a>00609       sNewCenterWorldY = (<a class="code" href="Types_8h.html#30f500129d8c688af07726d5d34ce52d">INT16</a>)(<a class="code" href="renderworld_8cpp.html#8350f407b742c1ef0bc3bc34ff27fda5">gCenterWorldY</a> + sTempY_W);
<a name="l00610"></a>00610 
<a name="l00611"></a>00611       <a class="code" href="renderworld_8cpp.html#0c40c16e2803521ac2625ca45e689b41">SetRenderCenter</a>( sNewCenterWorldX, sNewCenterWorldY );
<a name="l00612"></a>00612 
<a name="l00613"></a>00613 }
<a name="l00614"></a>00614 
<a name="l00615"></a><a class="code" href="Radar_01Screen_8h.html#b68d5852d0cb96f106846d748738dae7">00615</a> <span class="keywordtype">void</span> <a class="code" href="Radar_01Screen_8cpp.html#b68d5852d0cb96f106846d748738dae7">DisableRadarScreenRender</a>( <span class="keywordtype">void</span> )
<a name="l00616"></a>00616 {
<a name="l00617"></a>00617       <a class="code" href="Radar_01Screen_8cpp.html#e03d181e5a8d566c4da81d19df7b8207">fRenderRadarScreen</a> = FALSE;
<a name="l00618"></a>00618       <span class="keywordflow">return</span>;
<a name="l00619"></a>00619 }
<a name="l00620"></a>00620 
<a name="l00621"></a><a class="code" href="Radar_01Screen_8h.html#f8f17114c601d6ecff69183c741a6a76">00621</a> <span class="keywordtype">void</span> <a class="code" href="Radar_01Screen_8cpp.html#f8f17114c601d6ecff69183c741a6a76">EnableRadarScreenRender</a>( <span class="keywordtype">void</span> )
<a name="l00622"></a>00622 {
<a name="l00623"></a>00623       <a class="code" href="Radar_01Screen_8cpp.html#e03d181e5a8d566c4da81d19df7b8207">fRenderRadarScreen</a> = TRUE;
<a name="l00624"></a>00624       <span class="keywordflow">return</span>;
<a name="l00625"></a>00625 }
<a name="l00626"></a>00626 
<a name="l00627"></a><a class="code" href="Radar_01Screen_8h.html#4c559e0fac6d00ed552d445179ece046">00627</a> <span class="keywordtype">void</span> <a class="code" href="Radar_01Screen_8cpp.html#4c559e0fac6d00ed552d445179ece046">ToggleRadarScreenRender</a>( <span class="keywordtype">void</span> )
<a name="l00628"></a>00628 {
<a name="l00629"></a>00629       <a class="code" href="Radar_01Screen_8cpp.html#e03d181e5a8d566c4da81d19df7b8207">fRenderRadarScreen</a> = ! <a class="code" href="Radar_01Screen_8cpp.html#e03d181e5a8d566c4da81d19df7b8207">fRenderRadarScreen</a>;
<a name="l00630"></a>00630       <span class="keywordflow">return</span>;
<a name="l00631"></a>00631 }
<a name="l00632"></a>00632 
<a name="l00633"></a><a class="code" href="Radar_01Screen_8h.html#cf920f928c1792658334b5f17f5e6dd6">00633</a> <a class="code" href="Types_8h.html#112e3146cb38b6ee95e64d85842e380a">BOOLEAN</a> <a class="code" href="Radar_01Screen_8cpp.html#cf920f928c1792658334b5f17f5e6dd6">CreateDestroyMouseRegionsForSquadList</a>( <span class="keywordtype">void</span> )
<a name="l00634"></a>00634 {
<a name="l00635"></a>00635       <span class="comment">// will check the state of renderradarscreen flag and decide if we need to create mouse regions for </span>
<a name="l00636"></a>00636       <span class="keyword">static</span> <a class="code" href="Types_8h.html#112e3146cb38b6ee95e64d85842e380a">BOOLEAN</a> fCreated = FALSE;
<a name="l00637"></a>00637       <a class="code" href="Types_8h.html#30f500129d8c688af07726d5d34ce52d">INT16</a> sCounter = 0;
<a name="l00638"></a>00638       <a class="code" href="structVOBJECT__DESC.html">VOBJECT_DESC</a>    VObjectDesc; 
<a name="l00639"></a>00639       <a class="code" href="structTAG__HVOBJECT.html">HVOBJECT</a> hHandle;
<a name="l00640"></a>00640       <a class="code" href="Types_8h.html#e1e6edbbc26d6fbc71a90190d0266018">UINT32</a> uiHandle;
<a name="l00641"></a>00641 
<a name="l00642"></a>00642       <span class="keywordflow">if</span>( ( <a class="code" href="Radar_01Screen_8cpp.html#e03d181e5a8d566c4da81d19df7b8207">fRenderRadarScreen</a> == FALSE ) &amp;&amp; ( fCreated == FALSE ) )
<a name="l00643"></a>00643       {
<a name="l00644"></a>00644             <span class="comment">// create regions</span>
<a name="l00645"></a>00645             <span class="comment">// load graphics</span>
<a name="l00646"></a>00646         VObjectDesc.<a class="code" href="structVOBJECT__DESC.html#2df21c3aa88a0442d5d81b021fa15bf4">fCreateFlags</a>=VOBJECT_CREATE_FROMFILE;
<a name="l00647"></a>00647         <a class="code" href="Utilities_8cpp.html#a5e70f75b6f0518668a489ce02e007b7">FilenameForBPP</a>(<span class="stringliteral">"INTERFACE\\squadpanel.sti"</span>, VObjectDesc.<a class="code" href="structVOBJECT__DESC.html#6dbe3d70c19525e407a05e537cfb22f3">ImageFile</a>);
<a name="l00648"></a>00648         CHECKF(AddVideoObject(&amp;VObjectDesc, &amp;uiHandle));
<a name="l00649"></a>00649 
<a name="l00650"></a>00650         <a class="code" href="vobject_8cpp.html#bda2b0eae4cb40e612dffd307ad5c692">GetVideoObject</a>(&amp;hHandle, uiHandle);
<a name="l00651"></a>00651             
<a name="l00652"></a>00652         
<a name="l00653"></a>00653             <a class="code" href="vobject_8cpp.html#8a5b07441769401593743b9f52a9e353">BltVideoObject</a>( <a class="code" href="Map_01Screen_01Interface_8cpp.html#7d9956b05e9b87e244d4fdab6c4f71e4">guiSAVEBUFFER</a> , hHandle, 0,(<a class="code" href="local_8h.html#599adbe412c60e0cc5abb86be7ee4507">SCREEN_WIDTH</a> - 102 - 1), <a class="code" href="HelpScreen_8cpp.html#268f46eb948cd6eb0f3406b688e4ccaa">gsVIEWPORT_END_Y</a>, VO_BLT_SRCTRANSPARENCY,NULL );
<a name="l00654"></a>00654             <a class="code" href="Render_01Dirty_8cpp.html#ce65fac8b540eee1a5bf4902d2dcb0c5">RestoreExternBackgroundRect</a> ((<a class="code" href="local_8h.html#599adbe412c60e0cc5abb86be7ee4507">SCREEN_WIDTH</a> - 102 - 1), <a class="code" href="HelpScreen_8cpp.html#268f46eb948cd6eb0f3406b688e4ccaa">gsVIEWPORT_END_Y</a>, 102,( <a class="code" href="Types_8h.html#30f500129d8c688af07726d5d34ce52d">INT16</a> ) ( <a class="code" href="local_8h.html#f1c710caf1e3a9e81829078054e83799">SCREEN_HEIGHT</a> - <a class="code" href="HelpScreen_8cpp.html#268f46eb948cd6eb0f3406b688e4ccaa">gsVIEWPORT_END_Y</a> ) );
<a name="l00655"></a>00655             
<a name="l00656"></a>00656             <span class="keywordflow">for</span>( sCounter = 0; sCounter &lt; <a class="code" href="Squads_8h.html#19516aacc906a3c234aed4c5fdb53c3569e0d9a3efcedbba52faebfe02116adb">NUMBER_OF_SQUADS</a>; sCounter++ )
<a name="l00657"></a>00657             {
<a name="l00658"></a>00658                   <span class="comment">// run through list of squads and place appropriatly</span>
<a name="l00659"></a>00659                   <span class="keywordflow">if</span>( sCounter &lt; NUMBER_OF_SQUADS / 2 )
<a name="l00660"></a>00660                   {
<a name="l00661"></a>00661 
<a name="l00662"></a>00662                         <span class="comment">// left half of list</span>
<a name="l00663"></a>00663                         <a class="code" href="mousesystem_8cpp.html#dce08766ef4cbacb9372efe12d26a1e0">MSYS_DefineRegion</a>( &amp;<a class="code" href="Radar_01Screen_8cpp.html#023616dfc77f42ba33148586f89d77ba">gRadarRegionSquadList</a>[ sCounter ], RADAR_WINDOW_X , ( <a class="code" href="Types_8h.html#30f500129d8c688af07726d5d34ce52d">INT16</a> )( SQUAD_WINDOW_TM_Y + ( sCounter * (  ( SQUAD_REGION_HEIGHT - SUBTRACTOR_FOR_SQUAD_LIST ) / ( NUMBER_OF_SQUADS / 2 ) ) ) ), RADAR_WINDOW_X + RADAR_WINDOW_WIDTH / 2 - 1, ( <a class="code" href="Types_8h.html#30f500129d8c688af07726d5d34ce52d">INT16</a> )( SQUAD_WINDOW_TM_Y + ( ( sCounter + 1 ) * ( ( SQUAD_REGION_HEIGHT - SUBTRACTOR_FOR_SQUAD_LIST ) / ( NUMBER_OF_SQUADS / 2 ) ) ) ) ,MSYS_PRIORITY_HIGHEST,
<a name="l00664"></a>00664                                           0, <a class="code" href="Radar_01Screen_8cpp.html#99d35709c5e1b47ee0c41c7539caa7ed">TacticalSquadListMvtCallback</a>, <a class="code" href="Radar_01Screen_8cpp.html#882c8cffa633a113016393c1802e54d0">TacticalSquadListBtnCallBack</a> );
<a name="l00665"></a>00665                   }
<a name="l00666"></a>00666                   <span class="keywordflow">else</span>
<a name="l00667"></a>00667                   {
<a name="l00668"></a>00668 
<a name="l00669"></a>00669                         <span class="comment">// right half of list</span>
<a name="l00670"></a>00670                         <a class="code" href="mousesystem_8cpp.html#dce08766ef4cbacb9372efe12d26a1e0">MSYS_DefineRegion</a>( &amp;<a class="code" href="Radar_01Screen_8cpp.html#023616dfc77f42ba33148586f89d77ba">gRadarRegionSquadList</a>[ sCounter ], RADAR_WINDOW_X + RADAR_WINDOW_WIDTH / 2, ( <a class="code" href="Types_8h.html#30f500129d8c688af07726d5d34ce52d">INT16</a> )( SQUAD_WINDOW_TM_Y + ( ( sCounter - ( NUMBER_OF_SQUADS / 2) ) * ( 2 * ( SQUAD_REGION_HEIGHT - SUBTRACTOR_FOR_SQUAD_LIST ) / NUMBER_OF_SQUADS ) ) ), RADAR_WINDOW_X + RADAR_WINDOW_WIDTH  - 1, ( <a class="code" href="Types_8h.html#30f500129d8c688af07726d5d34ce52d">INT16</a> )( SQUAD_WINDOW_TM_Y + ( ( ( sCounter + 1 ) - ( NUMBER_OF_SQUADS / 2) )* ( 2 * ( SQUAD_REGION_HEIGHT - SUBTRACTOR_FOR_SQUAD_LIST ) / NUMBER_OF_SQUADS ) ) ), MSYS_PRIORITY_HIGHEST,
<a name="l00671"></a>00671                                     0, <a class="code" href="Radar_01Screen_8cpp.html#99d35709c5e1b47ee0c41c7539caa7ed">TacticalSquadListMvtCallback</a>, <a class="code" href="Radar_01Screen_8cpp.html#882c8cffa633a113016393c1802e54d0">TacticalSquadListBtnCallBack</a> );
<a name="l00672"></a>00672                   }
<a name="l00673"></a>00673 
<a name="l00674"></a>00674                   <span class="comment">// set user data</span>
<a name="l00675"></a>00675                   <a class="code" href="mousesystem_8cpp.html#df7126cc1e28adba535e334e406d5c5e">MSYS_SetRegionUserData</a>( &amp;<a class="code" href="Radar_01Screen_8cpp.html#023616dfc77f42ba33148586f89d77ba">gRadarRegionSquadList</a>[ sCounter ],0,sCounter);
<a name="l00676"></a>00676 
<a name="l00677"></a>00677             }
<a name="l00678"></a>00678 
<a name="l00679"></a>00679             <a class="code" href="vobject_8cpp.html#94715e750fad7cebd3d9d388cdff59e2">DeleteVideoObjectFromIndex</a>( uiHandle );
<a name="l00680"></a>00680 
<a name="l00681"></a>00681             <span class="comment">// reset the highlighted line</span>
<a name="l00682"></a>00682             <a class="code" href="Radar_01Screen_8cpp.html#f4d3e41c132bf40f2e33bdcf4eff3985">sSelectedSquadLine</a> = -1;
<a name="l00683"></a>00683 
<a name="l00684"></a>00684             <span class="comment">// set fact regions are created</span>
<a name="l00685"></a>00685             fCreated = TRUE;
<a name="l00686"></a>00686       }
<a name="l00687"></a>00687       <span class="keywordflow">else</span> <span class="keywordflow">if</span>( ( <a class="code" href="Radar_01Screen_8cpp.html#e03d181e5a8d566c4da81d19df7b8207">fRenderRadarScreen</a> == TRUE ) &amp;&amp; ( fCreated == TRUE ) )
<a name="l00688"></a>00688       {
<a name="l00689"></a>00689             <span class="comment">// destroy regions</span>
<a name="l00690"></a>00690 
<a name="l00691"></a>00691             <span class="keywordflow">for</span>( sCounter = 0; sCounter &lt; <a class="code" href="Squads_8h.html#19516aacc906a3c234aed4c5fdb53c3569e0d9a3efcedbba52faebfe02116adb">NUMBER_OF_SQUADS</a>; sCounter++ )
<a name="l00692"></a>00692             {
<a name="l00693"></a>00693               <a class="code" href="mousesystem_8cpp.html#f2581a6cadb531c87ebd6b3f5b70f258">MSYS_RemoveRegion</a>( &amp;<a class="code" href="Radar_01Screen_8cpp.html#023616dfc77f42ba33148586f89d77ba">gRadarRegionSquadList</a>[ sCounter ] );
<a name="l00694"></a>00694             }
<a name="l00695"></a>00695 
<a name="l00696"></a>00696             <span class="comment">// set fact regions are destroyed</span>
<a name="l00697"></a>00697             fCreated = FALSE;
<a name="l00698"></a>00698             
<a name="l00699"></a>00699 
<a name="l00700"></a>00700             <span class="keywordflow">if</span> ( <a class="code" href="gameloop_8cpp.html#8cd832c7f0ec6ab02ba9fddd4a2257aa">guiCurrentScreen</a> == <a class="code" href="screenids_8h.html#a4ee5dea8709d2b490486a62df77faf29873e16bc1530dedb416060abbeea6d0">GAME_SCREEN</a> )
<a name="l00701"></a>00701             {
<a name="l00702"></a>00702                   <span class="comment">// dirty region</span>
<a name="l00703"></a>00703                   <a class="code" href="Interface_8cpp.html#310e02e85df33f7794f5c4c11ae1844d">fInterfacePanelDirty</a> = DIRTYLEVEL2;
<a name="l00704"></a>00704                         
<a name="l00705"></a>00705                   <a class="code" href="Button_01System_8cpp.html#dd66106191abe97a8b80611179ff8996">MarkButtonsDirty</a>( );
<a name="l00706"></a>00706                         
<a name="l00707"></a>00707                   <span class="comment">// re render region</span>
<a name="l00708"></a>00708                   <a class="code" href="Interface_01Control_8cpp.html#677bc12d0b4bf62bf51675f0023a3f32">RenderTacticalInterface</a>( );
<a name="l00709"></a>00709 
<a name="l00710"></a>00710                   <a class="code" href="Button_01System_8cpp.html#d82e5028df813b9f64bea43abe59ea79">RenderButtons</a>( );
<a name="l00711"></a>00711 
<a name="l00712"></a>00712                   <span class="comment">// if game is paused, then render paused game text</span>
<a name="l00713"></a>00713                   <a class="code" href="Game_01Clock_8cpp.html#2162afe2c5d3333a6a0c599e4b73d9b0">RenderPausedGameBox</a>( );
<a name="l00714"></a>00714             }
<a name="l00715"></a>00715 
<a name="l00716"></a>00716       }
<a name="l00717"></a>00717 
<a name="l00718"></a>00718       <span class="keywordflow">return</span>( TRUE );
<a name="l00719"></a>00719 }
<a name="l00720"></a>00720 
<a name="l00721"></a>00721 
<a name="l00722"></a><a class="code" href="Radar_01Screen_8cpp.html#a586b51d4decd9be949e0b5eefda92e6">00722</a> <span class="keywordtype">void</span> <a class="code" href="Radar_01Screen_8cpp.html#a586b51d4decd9be949e0b5eefda92e6">RenderSquadList</a>( <span class="keywordtype">void</span> )
<a name="l00723"></a>00723 {
<a name="l00724"></a>00724       <span class="comment">// show list of squads</span>
<a name="l00725"></a>00725       <a class="code" href="Types_8h.html#30f500129d8c688af07726d5d34ce52d">INT16</a> sCounter = 0;
<a name="l00726"></a>00726       <a class="code" href="Types_8h.html#30f500129d8c688af07726d5d34ce52d">INT16</a> sX, sY;
<a name="l00727"></a>00727 
<a name="l00728"></a>00728       <span class="comment">// clear region</span>
<a name="l00729"></a>00729       <a class="code" href="Render_01Dirty_8cpp.html#ce65fac8b540eee1a5bf4902d2dcb0c5">RestoreExternBackgroundRect</a>( RADAR_WINDOW_X, <a class="code" href="Radar_01Screen_8cpp.html#0fb3f7a1e0cd24f85cc473fe4c00518c">gsRadarY</a>, RADAR_WINDOW_WIDTH , SQUAD_REGION_HEIGHT );
<a name="l00730"></a>00730 
<a name="l00731"></a>00731       <span class="comment">// fill area</span>
<a name="l00732"></a>00732       <a class="code" href="vsurface_8cpp.html#10d0257b54c4d27b2d82ead2a46cd581">ColorFillVideoSurfaceArea</a>( FRAME_BUFFER, RADAR_WINDOW_X, RADAR_WINDOW_TM_Y, RADAR_WINDOW_X + RADAR_WINDOW_WIDTH, RADAR_WINDOW_TM_Y + SQUAD_REGION_HEIGHT , <a class="code" href="himage_8cpp.html#d29939ffcd39c7d1cc0a91222702d361">Get16BPPColor</a>( FROMRGB(0,0,0) ) );
<a name="l00733"></a>00733 
<a name="l00734"></a>00734       <span class="comment">// set font</span>
<a name="l00735"></a>00735       <a class="code" href="Font_8cpp.html#fa4871009f0473cca0380217753947dc">SetFont</a>( SQUAD_FONT );
<a name="l00736"></a>00736 
<a name="l00737"></a>00737       <span class="keywordflow">for</span>( sCounter = 0; sCounter &lt; <a class="code" href="Squads_8h.html#19516aacc906a3c234aed4c5fdb53c3569e0d9a3efcedbba52faebfe02116adb">NUMBER_OF_SQUADS</a>; sCounter++ )
<a name="l00738"></a>00738       {
<a name="l00739"></a>00739             <span class="comment">// run through list of squads and place appropriatly</span>
<a name="l00740"></a>00740                   <span class="keywordflow">if</span>( sCounter &lt; NUMBER_OF_SQUADS / 2 )
<a name="l00741"></a>00741                   {
<a name="l00742"></a>00742                         <a class="code" href="Font_8cpp.html#d08dcd11daa6a1189cb123dff18cd7c8">FindFontCenterCoordinates</a>( RADAR_WINDOW_X , ( <a class="code" href="Types_8h.html#30f500129d8c688af07726d5d34ce52d">INT16</a> )( SQUAD_WINDOW_TM_Y + ( sCounter * ( 2 * ( SQUAD_REGION_HEIGHT - SUBTRACTOR_FOR_SQUAD_LIST ) / NUMBER_OF_SQUADS ) ) ), RADAR_WINDOW_WIDTH / 2 - 1, ( <a class="code" href="Types_8h.html#30f500129d8c688af07726d5d34ce52d">INT16</a> )( (  ( 2 * ( SQUAD_REGION_HEIGHT - SUBTRACTOR_FOR_SQUAD_LIST ) / NUMBER_OF_SQUADS ) ) ) ,<a class="code" href="__DutchText_8cpp.html#13cd9a9a510e8b4a37e74aa7daa2da32">pSquadMenuStrings</a>[ sCounter ] , SQUAD_FONT, &amp;sX, &amp;sY);
<a name="l00743"></a>00743                   }
<a name="l00744"></a>00744                   <span class="keywordflow">else</span>
<a name="l00745"></a>00745                   {
<a name="l00746"></a>00746                         <a class="code" href="Font_8cpp.html#d08dcd11daa6a1189cb123dff18cd7c8">FindFontCenterCoordinates</a>(RADAR_WINDOW_X + RADAR_WINDOW_WIDTH / 2, ( <a class="code" href="Types_8h.html#30f500129d8c688af07726d5d34ce52d">INT16</a> )( SQUAD_WINDOW_TM_Y + ( ( sCounter - ( NUMBER_OF_SQUADS / 2) ) * ( 2 * ( SQUAD_REGION_HEIGHT - SUBTRACTOR_FOR_SQUAD_LIST ) / NUMBER_OF_SQUADS ) ) ), RADAR_WINDOW_WIDTH / 2 - 1, ( <a class="code" href="Types_8h.html#30f500129d8c688af07726d5d34ce52d">INT16</a> )(   ( ( 2 * ( SQUAD_REGION_HEIGHT - SUBTRACTOR_FOR_SQUAD_LIST ) / NUMBER_OF_SQUADS ) ) ), <a class="code" href="__DutchText_8cpp.html#13cd9a9a510e8b4a37e74aa7daa2da32">pSquadMenuStrings</a>[ sCounter ] , SQUAD_FONT, &amp;sX, &amp;sY);
<a name="l00747"></a>00747                   }
<a name="l00748"></a>00748 
<a name="l00749"></a>00749                   <span class="comment">// highlight line?</span>
<a name="l00750"></a>00750                   <span class="keywordflow">if</span>( <a class="code" href="Radar_01Screen_8cpp.html#f4d3e41c132bf40f2e33bdcf4eff3985">sSelectedSquadLine</a> == sCounter)
<a name="l00751"></a>00751                   {
<a name="l00752"></a>00752                         <a class="code" href="Font_8cpp.html#388be5810478c3f3bdb861f144085d70">SetFontForeground</a>( FONT_WHITE );
<a name="l00753"></a>00753                   }
<a name="l00754"></a>00754                   <span class="keywordflow">else</span>
<a name="l00755"></a>00755                   {
<a name="l00756"></a>00756                         <span class="keywordflow">if</span>( <a class="code" href="Squads_8cpp.html#59f01a150cd9d1f148b4da3ae400cc38">IsSquadOnCurrentTacticalMap</a>( ( <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a> ) sCounter ) == TRUE )
<a name="l00757"></a>00757                         {
<a name="l00758"></a>00758                               <span class="keywordflow">if</span>( <a class="code" href="Squads_8cpp.html#7b191255333292b85d3e366c8def7a21">CurrentSquad</a>( ) == ( <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a> ) sCounter )
<a name="l00759"></a>00759                               {
<a name="l00760"></a>00760                                     <a class="code" href="Font_8cpp.html#388be5810478c3f3bdb861f144085d70">SetFontForeground</a>( FONT_LTGREEN );
<a name="l00761"></a>00761                               }
<a name="l00762"></a>00762                               <span class="keywordflow">else</span>
<a name="l00763"></a>00763                               {
<a name="l00764"></a>00764                                     <a class="code" href="Font_8cpp.html#388be5810478c3f3bdb861f144085d70">SetFontForeground</a>(  FONT_DKGREEN);
<a name="l00765"></a>00765                               }
<a name="l00766"></a>00766                         }
<a name="l00767"></a>00767                         <span class="keywordflow">else</span>
<a name="l00768"></a>00768                         {
<a name="l00769"></a>00769                               <a class="code" href="Font_8cpp.html#388be5810478c3f3bdb861f144085d70">SetFontForeground</a>( FONT_BLACK );
<a name="l00770"></a>00770                         }
<a name="l00771"></a>00771                   }
<a name="l00772"></a>00772 
<a name="l00773"></a>00773                   <a class="code" href="Font_8cpp.html#a1fe8cc526be9e2c96b5dd66e348506f">SetFontBackground</a>( FONT_BLACK );
<a name="l00774"></a>00774 
<a name="l00775"></a>00775                   <span class="keywordflow">if</span>( sCounter &lt; NUMBER_OF_SQUADS / 2 )
<a name="l00776"></a>00776                   {
<a name="l00777"></a>00777                         sX = RADAR_WINDOW_X + 2; 
<a name="l00778"></a>00778                   }
<a name="l00779"></a>00779                   <span class="keywordflow">else</span>
<a name="l00780"></a>00780                   {
<a name="l00781"></a>00781                         sX = RADAR_WINDOW_X + ( RADAR_WINDOW_WIDTH / 2 ) - 2;
<a name="l00782"></a>00782                   }
<a name="l00783"></a>00783                   <a class="code" href="Font_8cpp.html#b3e12cf19a0ca58abf6689cc8eca3ead">mprintf</a>( sX, sY , <a class="code" href="__DutchText_8cpp.html#13cd9a9a510e8b4a37e74aa7daa2da32">pSquadMenuStrings</a>[ sCounter ]);
<a name="l00784"></a>00784       }
<a name="l00785"></a>00785 }
<a name="l00786"></a>00786 
<a name="l00787"></a><a class="code" href="Radar_01Screen_8cpp.html#99d35709c5e1b47ee0c41c7539caa7ed">00787</a> <span class="keywordtype">void</span> <a class="code" href="Radar_01Screen_8cpp.html#99d35709c5e1b47ee0c41c7539caa7ed">TacticalSquadListMvtCallback</a>( <a class="code" href="struct__MOUSE__REGION.html">MOUSE_REGION</a> * pRegion, <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a> iReason )
<a name="l00788"></a>00788 {
<a name="l00789"></a>00789       <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a> iValue = -1;
<a name="l00790"></a>00790 
<a name="l00791"></a>00791       iValue = <a class="code" href="mousesystem_8cpp.html#8b64ac2435c69cf4c67ab56af8f5badc">MSYS_GetRegionUserData</a>( pRegion, 0 );
<a name="l00792"></a>00792 
<a name="l00793"></a>00793       <span class="keywordflow">if</span> (iReason &amp; MSYS_CALLBACK_REASON_GAIN_MOUSE )
<a name="l00794"></a>00794       {
<a name="l00795"></a>00795             <span class="keywordflow">if</span>( <a class="code" href="Squads_8cpp.html#59f01a150cd9d1f148b4da3ae400cc38">IsSquadOnCurrentTacticalMap</a>( iValue ) == TRUE )
<a name="l00796"></a>00796             {
<a name="l00797"></a>00797                   <a class="code" href="Radar_01Screen_8cpp.html#f4d3e41c132bf40f2e33bdcf4eff3985">sSelectedSquadLine</a> = ( <a class="code" href="Types_8h.html#30f500129d8c688af07726d5d34ce52d">INT16</a> )iValue; 
<a name="l00798"></a>00798             }
<a name="l00799"></a>00799       }
<a name="l00800"></a>00800       <span class="keywordflow">if</span> (iReason &amp; MSYS_CALLBACK_REASON_LOST_MOUSE )
<a name="l00801"></a>00801       {
<a name="l00802"></a>00802             <a class="code" href="Radar_01Screen_8cpp.html#f4d3e41c132bf40f2e33bdcf4eff3985">sSelectedSquadLine</a> = -1;
<a name="l00803"></a>00803       }
<a name="l00804"></a>00804 
<a name="l00805"></a>00805       <span class="keywordflow">return</span>;
<a name="l00806"></a>00806 
<a name="l00807"></a>00807 }
<a name="l00808"></a>00808 
<a name="l00809"></a>00809 
<a name="l00810"></a><a class="code" href="Radar_01Screen_8cpp.html#882c8cffa633a113016393c1802e54d0">00810</a> <span class="keywordtype">void</span> <a class="code" href="Radar_01Screen_8cpp.html#882c8cffa633a113016393c1802e54d0">TacticalSquadListBtnCallBack</a>(<a class="code" href="struct__MOUSE__REGION.html">MOUSE_REGION</a> * pRegion, <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a> iReason )
<a name="l00811"></a>00811 {
<a name="l00812"></a>00812       <span class="comment">// btn callback handler for team list info region</span>
<a name="l00813"></a>00813       <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a> iValue = 0;
<a name="l00814"></a>00814 
<a name="l00815"></a>00815       iValue = <a class="code" href="mousesystem_8cpp.html#8b64ac2435c69cf4c67ab56af8f5badc">MSYS_GetRegionUserData</a>( pRegion, 0 );
<a name="l00816"></a>00816 
<a name="l00817"></a>00817       <span class="keywordflow">if</span> (iReason &amp; MSYS_CALLBACK_REASON_LBUTTON_UP)
<a name="l00818"></a>00818       {
<a name="l00819"></a>00819             <span class="comment">// find out if this squad is valid and on this map..if so, set as selected</span>
<a name="l00820"></a>00820             <span class="keywordflow">if</span>( <a class="code" href="Squads_8cpp.html#59f01a150cd9d1f148b4da3ae400cc38">IsSquadOnCurrentTacticalMap</a>( iValue ) == TRUE )
<a name="l00821"></a>00821             {
<a name="l00822"></a>00822                   <span class="comment">// ok, squad is here, set as selected</span>
<a name="l00823"></a>00823                   <a class="code" href="Squads_8cpp.html#c34a967a69f00b7e6c715cd832dd090a">SetCurrentSquad</a>( iValue, FALSE );
<a name="l00824"></a>00824 
<a name="l00825"></a>00825                   <span class="comment">// stop showing</span>
<a name="l00826"></a>00826                   <a class="code" href="Radar_01Screen_8cpp.html#e03d181e5a8d566c4da81d19df7b8207">fRenderRadarScreen</a> = TRUE;
<a name="l00827"></a>00827             }
<a name="l00828"></a>00828       }
<a name="l00829"></a>00829 
<a name="l00830"></a>00830       <span class="keywordflow">return</span>;
<a name="l00831"></a>00831 }
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Sat Sep 9 13:48:50 2006 for Build by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.4.7 </small></address>
</body>
</html>
