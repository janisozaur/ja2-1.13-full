<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>Build: Soldier Ani.cpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.4.7 -->
<div class="tabs">
  <ul>
    <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="classes.html"><span>Classes</span></a></li>
    <li id="current"><a href="files.html"><span>Files</span></a></li>
    <li><a href="dirs.html"><span>Directories</span></a></li>
    <li>
      <form action="search.php" method="get">
        <table cellspacing="0" cellpadding="0" border="0">
          <tr>
            <td><label>&nbsp;<u>S</u>earch&nbsp;for&nbsp;</label></td>
            <td><input type="text" name="query" value="" size="20" accesskey="s"/></td>
          </tr>
        </table>
      </form>
    </li>
  </ul></div>
<div class="tabs">
  <ul>
    <li><a href="files.html"><span>File&nbsp;List</span></a></li>
    <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
  </ul></div>
<div class="nav">
<a class="el" href="dir_3179ea33d55a76dc38212d9eab798728.html">export</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_e5664b4b56927c8728eb3192fa60e338.html">hdc2</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_1eb12a41a47efb9efcd82fa98f4f4dbd.html">FTP</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_80cc1f21a78ab7941088ea567f236150.html">ja2src</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_994ab287602efefceafe55287a3657d6.html">Build</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_43ed33c8f48e75fecb0508860a16371c.html">Tactical</a></div>
<h1>Soldier Ani.cpp</h1><a href="Soldier_01Ani_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="preprocessor">#ifdef PRECOMPILEDHEADERS</span>
<a name="l00002"></a>00002 <span class="preprocessor"></span><span class="preprocessor">      #include "<a class="code" href="Tactical_01All_8h.html">Tactical All.h</a>"</span>
<a name="l00003"></a>00003 <span class="preprocessor">#else</span>
<a name="l00004"></a>00004 <span class="preprocessor"></span><span class="preprocessor">      #include &lt;stdio.h&gt;</span>
<a name="l00005"></a>00005 <span class="preprocessor">      #include &lt;string.h&gt;</span>
<a name="l00006"></a>00006 <span class="preprocessor">      #include "wcheck.h"</span>
<a name="l00007"></a>00007 <span class="preprocessor">      #include "stdlib.h"</span>
<a name="l00008"></a>00008 <span class="preprocessor">      #include "debug.h"</span>
<a name="l00009"></a>00009 <span class="preprocessor">      #include "<a class="code" href="MemMan_8h.html">MemMan.h</a>"</span>
<a name="l00010"></a>00010 <span class="preprocessor">      #include "<a class="code" href="Overhead_01Types_8h.html">Overhead Types.h</a>"</span>
<a name="l00011"></a>00011 <span class="preprocessor">      #include "<a class="code" href="Soldier_01Control_8h.html">Soldier Control.h</a>"</span>
<a name="l00012"></a>00012 <span class="preprocessor">      #include "<a class="code" href="Animation_01Cache_8h.html">Animation Cache.h</a>"</span>
<a name="l00013"></a>00013 <span class="preprocessor">      #include "<a class="code" href="Animation_01Data_8h.html">Animation Data.h</a>"</span>
<a name="l00014"></a>00014 <span class="preprocessor">      #include "<a class="code" href="Animation_01Control_8h.html">Animation Control.h</a>"</span>
<a name="l00015"></a>00015 <span class="preprocessor">      #include "weapons.h"</span>
<a name="l00016"></a>00016 <span class="preprocessor">      #include "soldier ani.h"</span>
<a name="l00017"></a>00017 <span class="preprocessor">      #include "Random.h"</span>
<a name="l00018"></a>00018 <span class="preprocessor">      #include "<a class="code" href="video_8h.html">video.h</a>"</span>
<a name="l00019"></a>00019 <span class="preprocessor">      #include "<a class="code" href="vobject__blitters_8h.html">vobject_blitters.h</a>"</span>
<a name="l00020"></a>00020 <span class="preprocessor">      #include "<a class="code" href="Sound_01Control_8h.html">Sound Control.h</a>"</span> 
<a name="l00021"></a>00021 <span class="preprocessor">      #include "isometric utils.h"</span>
<a name="l00022"></a>00022 <span class="preprocessor">      #include "<a class="code" href="Handle_01UI_8h.html">Handle UI.h</a>"</span>
<a name="l00023"></a>00023 <span class="preprocessor">      #include "<a class="code" href="Event_01Pump_8h.html">Event Pump.h</a>"</span>
<a name="l00024"></a>00024 <span class="preprocessor">      #include "<a class="code" href="opplist_8h.html">opplist.h</a>"</span>
<a name="l00025"></a>00025 <span class="preprocessor">      #include "<a class="code" href="lighting_8h.html">lighting.h</a>"</span>
<a name="l00026"></a>00026 <span class="preprocessor">      #include "<a class="code" href="ai_8h.html">ai.h</a>"</span>
<a name="l00027"></a>00027 <span class="preprocessor">      #include "<a class="code" href="renderworld_8h.html">renderworld.h</a>"</span>
<a name="l00028"></a>00028 <span class="preprocessor">      #include "interactive tiles.h"</span>
<a name="l00029"></a>00029 <span class="preprocessor">      #include "points.h"</span>
<a name="l00030"></a>00030 <span class="preprocessor">      #include "<a class="code" href="message_8h.html">message.h</a>"</span>
<a name="l00031"></a>00031 <span class="preprocessor">      #include "world items.h"</span>
<a name="l00032"></a>00032 <span class="preprocessor">      #include "<a class="code" href="physics_8h.html">physics.h</a>"</span>
<a name="l00033"></a>00033 <span class="preprocessor">      #include "soldier create.h"</span>
<a name="l00034"></a>00034 <span class="preprocessor">      #include "dialogue control.h"</span>
<a name="l00035"></a>00035 <span class="preprocessor">      #include "soldier functions.h"</span>
<a name="l00036"></a>00036 <span class="preprocessor">      #include "rotting corpses.h"</span>
<a name="l00037"></a>00037 <span class="preprocessor">      #include "<a class="code" href="merc_01entering_8h.html">merc entering.h</a>"</span>
<a name="l00038"></a>00038 <span class="preprocessor">      #include "soldier add.h"</span>
<a name="l00039"></a>00039 <span class="preprocessor">      #include "soldier profile.h"</span>
<a name="l00040"></a>00040 <span class="preprocessor">      #include "soldier functions.h"</span>
<a name="l00041"></a>00041 <span class="preprocessor">      #include "interface.h"</span>
<a name="l00042"></a>00042 <span class="preprocessor">      #include "<a class="code" href="qarray_8h.html">qarray.h</a>"</span>
<a name="l00043"></a>00043 <span class="preprocessor">      #include "soldier macros.h"</span>
<a name="l00044"></a>00044 <span class="preprocessor">      #include "<a class="code" href="Strategic_01Town_01Loyalty_8h.html">Strategic Town Loyalty.h</a>"</span>
<a name="l00045"></a>00045 <span class="preprocessor">      #include "<a class="code" href="Squads_8h.html">Squads.h</a>"</span>
<a name="l00046"></a>00046 <span class="preprocessor">      #include "<a class="code" href="worldman_8h.html">worldman.h</a>"</span>
<a name="l00047"></a>00047 <span class="preprocessor">      #include "structure wrap.h"</span>
<a name="l00048"></a>00048 <span class="preprocessor">      #include "pathai.h"</span>
<a name="l00049"></a>00049 <span class="preprocessor">      #include "<a class="code" href="pits_8h.html">pits.h</a>"</span>
<a name="l00050"></a>00050 <span class="preprocessor">      #include "text.h"</span>
<a name="l00051"></a>00051 <span class="preprocessor">      #include "npc.h"</span>
<a name="l00052"></a>00052 <span class="preprocessor">      #include "meanwhile.h"</span>
<a name="l00053"></a>00053 <span class="preprocessor">      #include "<a class="code" href="Explosion_01Control_8h.html">Explosion Control.h</a>"</span>
<a name="l00054"></a>00054 <span class="preprocessor">      #include "<a class="code" href="fov_8h.html">fov.h</a>"</span>
<a name="l00055"></a>00055 <span class="preprocessor">      #include "campaign.h"</span>
<a name="l00056"></a>00056 <span class="preprocessor">      #include "los.h"</span>
<a name="l00057"></a>00057 <span class="preprocessor">      #include "<a class="code" href="GameSettings_8h.html">GameSettings.h</a>"</span>
<a name="l00058"></a>00058 <span class="preprocessor">#endif</span>
<a name="l00059"></a>00059 <span class="preprocessor"></span>
<a name="l00060"></a>00060 <span class="preprocessor">#define           NO_JUMP                                                                 0</span>
<a name="l00061"></a>00061 <span class="preprocessor"></span><span class="preprocessor">#define           MAX_ANIFRAMES_PER_FLASH             2</span>
<a name="l00062"></a>00062 <span class="preprocessor"></span><span class="comment">//#define         TIME_FOR_RANDOM_ANIM_CHECK    10</span>
<a name="l00063"></a>00063 <span class="preprocessor">#define           TIME_FOR_RANDOM_ANIM_CHECK    2</span>
<a name="l00064"></a>00064 <span class="preprocessor"></span>
<a name="l00065"></a><a class="code" href="Soldier_01Ani_8cpp.html#361e9e051df8b5f3bb7916450ce169b3">00065</a> <a class="code" href="Types_8h.html#112e3146cb38b6ee95e64d85842e380a">BOOLEAN</a>           <a class="code" href="Overhead_8cpp.html#361e9e051df8b5f3bb7916450ce169b3">gfLastMercTalkedAboutKillingID</a> = NOBODY;
<a name="l00066"></a>00066 
<a name="l00067"></a>00067 <span class="keyword">extern</span> <span class="keywordtype">void</span> <a class="code" href="Strategic_01Movement_8cpp.html#c628a159fe24ec4670cfa0a57b089caa">AddFuelToVehicle</a>( <a class="code" href="structSOLDIERTYPE.html">SOLDIERTYPE</a> *<a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>, <a class="code" href="structSOLDIERTYPE.html">SOLDIERTYPE</a> *pVehicle );
<a name="l00068"></a>00068 
<a name="l00069"></a>00069 
<a name="l00070"></a><a class="code" href="Soldier_01Ani_8cpp.html#97c457fb2177f960d661206c05a35e07">00070</a> <a class="code" href="Types_8h.html#eb90fd78c942591ef3a935cf98baf4f8">DOUBLE</a>            <a class="code" href="Soldier_01Ani_8cpp.html#97c457fb2177f960d661206c05a35e07">gHopFenceForwardSEDist</a>[ NUMSOLDIERBODYTYPES ] = { 2.2, 0.7, 3.2, 0.7 };
<a name="l00071"></a><a class="code" href="Soldier_01Ani_8cpp.html#d3468dc33a8b9c021bbcb3c3c88bc8bd">00071</a> <a class="code" href="Types_8h.html#eb90fd78c942591ef3a935cf98baf4f8">DOUBLE</a>            <a class="code" href="Soldier_01Ani_8cpp.html#d3468dc33a8b9c021bbcb3c3c88bc8bd">gHopFenceForwardNWDist</a>[ NUMSOLDIERBODYTYPES ] = { 2.7, 1.0, 2.7, 1.0 };
<a name="l00072"></a><a class="code" href="Soldier_01Ani_8cpp.html#eb6fa38c41a3ae7799edeaa5fbb9a922">00072</a> <a class="code" href="Types_8h.html#eb90fd78c942591ef3a935cf98baf4f8">DOUBLE</a>      <a class="code" href="Soldier_01Ani_8cpp.html#eb6fa38c41a3ae7799edeaa5fbb9a922">gHopFenceForwardFullSEDist</a>[ NUMSOLDIERBODYTYPES ] = { 1.1, 1.0, 2.1, 1.1 };
<a name="l00073"></a><a class="code" href="Soldier_01Ani_8cpp.html#ecba8e98753416ef32d9f2c80a5a5275">00073</a> <a class="code" href="Types_8h.html#eb90fd78c942591ef3a935cf98baf4f8">DOUBLE</a>      <a class="code" href="Soldier_01Ani_8cpp.html#ecba8e98753416ef32d9f2c80a5a5275">gHopFenceForwardFullNWDist</a>[ NUMSOLDIERBODYTYPES ] = { 0.8, 0.2, 2.7, 0.8 };
<a name="l00074"></a><a class="code" href="Soldier_01Ani_8cpp.html#b3029d724e57fdd93d816a501ef2ac36">00074</a> <a class="code" href="Types_8h.html#eb90fd78c942591ef3a935cf98baf4f8">DOUBLE</a>            <a class="code" href="Soldier_01Ani_8cpp.html#b3029d724e57fdd93d816a501ef2ac36">gFalloffBackwardsDist</a>[ NUMSOLDIERBODYTYPES ] = { 1, 0.8, 1, 1 };
<a name="l00075"></a><a class="code" href="Soldier_01Ani_8cpp.html#e768d781bdb574535f4d6242f51d9c59">00075</a> <a class="code" href="Types_8h.html#eb90fd78c942591ef3a935cf98baf4f8">DOUBLE</a>            <a class="code" href="Soldier_01Ani_8cpp.html#e768d781bdb574535f4d6242f51d9c59">gClimbUpRoofDist</a>[ NUMSOLDIERBODYTYPES ] = { 2, 0.1, 2, 2 };
<a name="l00076"></a><a class="code" href="Soldier_01Ani_8cpp.html#fd65c5d09e89c52bc3e7b0aff43ae0f3">00076</a> <a class="code" href="Types_8h.html#eb90fd78c942591ef3a935cf98baf4f8">DOUBLE</a>            <a class="code" href="Soldier_01Ani_8cpp.html#fd65c5d09e89c52bc3e7b0aff43ae0f3">gClimbUpRoofLATDist</a>[ NUMSOLDIERBODYTYPES ] = { 0.7, 0.5, 0.7, 0.5 };
<a name="l00077"></a><a class="code" href="Soldier_01Ani_8cpp.html#761217107ba66a306c345ae9e7f7deba">00077</a> <a class="code" href="Types_8h.html#eb90fd78c942591ef3a935cf98baf4f8">DOUBLE</a>            <a class="code" href="Soldier_01Ani_8cpp.html#761217107ba66a306c345ae9e7f7deba">gClimbDownRoofStartDist</a>[ NUMSOLDIERBODYTYPES ] = { 5.0, 1.0, 1, 1 };
<a name="l00078"></a><a class="code" href="Soldier_01Ani_8cpp.html#d096f8000b2d7f7371dda4ca4f7741bf">00078</a> <a class="code" href="Types_8h.html#eb90fd78c942591ef3a935cf98baf4f8">DOUBLE</a>            <a class="code" href="Soldier_01Ani_8cpp.html#d096f8000b2d7f7371dda4ca4f7741bf">gClimbUpRoofDistGoingLower</a>[ NUMSOLDIERBODYTYPES ] = { 0.9, 0.1, 1, 1 };
<a name="l00079"></a>00079 
<a name="l00080"></a>00080 
<a name="l00081"></a>00081 
<a name="l00082"></a>00082 <a class="code" href="Types_8h.html#112e3146cb38b6ee95e64d85842e380a">BOOLEAN</a> <a class="code" href="Soldier_01Ani_8cpp.html#3198c81214ade4869fe94476b233b7b0">HandleSoldierDeath</a>( <a class="code" href="structSOLDIERTYPE.html">SOLDIERTYPE</a> *<a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a> , <a class="code" href="Types_8h.html#112e3146cb38b6ee95e64d85842e380a">BOOLEAN</a> *pfMadeCorpse );
<a name="l00083"></a>00083 
<a name="l00084"></a>00084 <span class="keywordtype">void</span> <a class="code" href="Soldier_01Ani_8cpp.html#a9bf3ae72a0d41cf3cdcd31c8f3d01e9">CheckForAndHandleSoldierIncompacitated</a>( <a class="code" href="structSOLDIERTYPE.html">SOLDIERTYPE</a> *<a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a> );
<a name="l00085"></a>00085 <a class="code" href="Types_8h.html#112e3146cb38b6ee95e64d85842e380a">BOOLEAN</a> <a class="code" href="Soldier_01Ani_8cpp.html#4a1f4a44abd2dd1e17348edff0830048">CheckForImproperFireGunEnd</a>( <a class="code" href="structSOLDIERTYPE.html">SOLDIERTYPE</a> *<a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a> );
<a name="l00086"></a>00086 <a class="code" href="Types_8h.html#112e3146cb38b6ee95e64d85842e380a">BOOLEAN</a> <a class="code" href="Soldier_01Ani_8cpp.html#5cc4c38d561234656735136f4d3c28a4">OKHeightDest</a>( <a class="code" href="structSOLDIERTYPE.html">SOLDIERTYPE</a> *<a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>, <a class="code" href="Types_8h.html#30f500129d8c688af07726d5d34ce52d">INT16</a> sNewGridNo );
<a name="l00087"></a>00087 <a class="code" href="Types_8h.html#112e3146cb38b6ee95e64d85842e380a">BOOLEAN</a> <a class="code" href="Soldier_01Ani_8cpp.html#b347fd92f91cd16381f0163a2da1e293">HandleUnjamAnimation</a>( <a class="code" href="structSOLDIERTYPE.html">SOLDIERTYPE</a> *<a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a> );
<a name="l00088"></a>00088 
<a name="l00089"></a>00089 <span class="keyword">extern</span> <span class="keywordtype">void</span> <a class="code" href="Overhead_8cpp.html#1e90a7e590fc2cf941a2b752e3696328">HandleSystemNewAISituation</a>( <a class="code" href="structSOLDIERTYPE.html">SOLDIERTYPE</a> *<a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>, <a class="code" href="Types_8h.html#112e3146cb38b6ee95e64d85842e380a">BOOLEAN</a> fResetABC );
<a name="l00090"></a>00090 <span class="keyword">extern</span> <span class="keywordtype">void</span> <a class="code" href="Overhead_8cpp.html#bd5ad27fbfc272e627c34fae932bb83c">PlaySoldierFootstepSound</a>( <a class="code" href="structSOLDIERTYPE.html">SOLDIERTYPE</a> *<a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a> );
<a name="l00091"></a>00091 <span class="keyword">extern</span> <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> <a class="code" href="Overhead_8cpp.html#ef2a91a26932ebb6be5ef1b2a4d917cd">NumCapableEnemyInSector</a>( );
<a name="l00092"></a>00092 <span class="keyword">extern</span> <a class="code" href="Types_8h.html#112e3146cb38b6ee95e64d85842e380a">BOOLEAN</a> <a class="code" href="Overhead_8cpp.html#4058a40ecb7db0daccc2d09ed1ddcdc8">gfKillingGuysForLosingBattle</a>;
<a name="l00093"></a>00093 
<a name="l00094"></a>00094 <span class="keyword">extern</span> <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> <a class="code" href="opplist_8cpp.html#2a6174431f0a4b68f6b1f52d3030b5cb">gubInterruptProvoker</a>;
<a name="l00095"></a>00095 
<a name="l00096"></a>00096 <span class="keyword">extern</span> <a class="code" href="Types_8h.html#09f1a1fb2293e33483cc8d44aefb1eb1">UINT16</a> <a class="code" href="Handle_01UI_8cpp.html#79cf1db0ca82a0738bf1aa9959734616">PickSoldierReadyAnimation</a>( <a class="code" href="structSOLDIERTYPE.html">SOLDIERTYPE</a> *<a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>, <a class="code" href="Types_8h.html#112e3146cb38b6ee95e64d85842e380a">BOOLEAN</a> fEndReady );
<a name="l00097"></a>00097 
<a name="l00098"></a><a class="code" href="Soldier_01Ani_8h.html#07067fd8d820c605e9ba3f89d058cc84">00098</a> <a class="code" href="Types_8h.html#112e3146cb38b6ee95e64d85842e380a">BOOLEAN</a> <a class="code" href="Soldier_01Ani_8cpp.html#07067fd8d820c605e9ba3f89d058cc84">AdjustToNextAnimationFrame</a>( <a class="code" href="structSOLDIERTYPE.html">SOLDIERTYPE</a> *<a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a> )
<a name="l00099"></a>00099 {
<a name="l00100"></a>00100       <a class="code" href="structEV__S__FIREWEAPON.html">EV_S_FIREWEAPON</a>               <a class="code" href="Event_01Pump_8cpp.html#774bce22f7a5663fe374ccd634b4841a">SFireWeapon</a>;
<a name="l00101"></a>00101 
<a name="l00102"></a>00102       <a class="code" href="Types_8h.html#09f1a1fb2293e33483cc8d44aefb1eb1">UINT16</a>                        sNewAniFrame, anAniFrame;     
<a name="l00103"></a>00103       <a class="code" href="Types_8h.html#7ebe70ceca856797319175e30bcf003d">INT8</a>                          ubCurrentHeight;
<a name="l00104"></a>00104       <a class="code" href="Types_8h.html#09f1a1fb2293e33483cc8d44aefb1eb1">UINT16</a>                        usOldAnimState;
<a name="l00105"></a>00105       <span class="keyword">static</span> <a class="code" href="Types_8h.html#e1e6edbbc26d6fbc71a90190d0266018">UINT32</a> uiJumpAddress = NO_JUMP;
<a name="l00106"></a>00106       <a class="code" href="Types_8h.html#30f500129d8c688af07726d5d34ce52d">INT16</a>                         sNewGridNo;
<a name="l00107"></a>00107       <a class="code" href="Types_8h.html#30f500129d8c688af07726d5d34ce52d">INT16</a>                         sX, sY;
<a name="l00108"></a>00108       <a class="code" href="Types_8h.html#112e3146cb38b6ee95e64d85842e380a">BOOLEAN</a>                       fStop;
<a name="l00109"></a>00109       <a class="code" href="Types_8h.html#e1e6edbbc26d6fbc71a90190d0266018">UINT32</a>                        cnt;
<a name="l00110"></a>00110       <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>                         ubDiceRoll;                               <span class="comment">// Percentile dice roll</span>
<a name="l00111"></a>00111       <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>                         ubRandomHandIndex;            <span class="comment">// Index value into random animation table to use base don what is in the guys hand...</span>
<a name="l00112"></a>00112       <a class="code" href="Types_8h.html#09f1a1fb2293e33483cc8d44aefb1eb1">UINT16</a>                        usItem;
<a name="l00113"></a>00113       <a class="code" href="structRANDOM__ANI__DEF.html">RANDOM_ANI_DEF</a>    *pAnimDef;
<a name="l00114"></a>00114       <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>                         ubNewDirection;
<a name="l00115"></a>00115       <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>                         ubDesiredHeight;
<a name="l00116"></a>00116       <a class="code" href="Types_8h.html#112e3146cb38b6ee95e64d85842e380a">BOOLEAN</a>                       bOKFireWeapon;
<a name="l00117"></a>00117       <a class="code" href="Types_8h.html#112e3146cb38b6ee95e64d85842e380a">BOOLEAN</a>                       bWeaponJammed;
<a name="l00118"></a>00118       <a class="code" href="Types_8h.html#112e3146cb38b6ee95e64d85842e380a">BOOLEAN</a>                       fFreeUpAttacker=FALSE;
<a name="l00119"></a>00119   <a class="code" href="Types_8h.html#09f1a1fb2293e33483cc8d44aefb1eb1">UINT16</a>        usUIMovementMode;
<a name="l00120"></a>00120 
<a name="l00121"></a>00121   <span class="keywordflow">do</span>
<a name="l00122"></a>00122   {
<a name="l00123"></a>00123             <span class="comment">// Get new frame code</span>
<a name="l00124"></a>00124             sNewAniFrame = <a class="code" href="Animation_01Control_8cpp.html#7ff964ad77f7f28f8f481f3e0d91b636">gusAnimInst</a>[ <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#1f73b62a5ea0dd26fa1bec1d9f522b41">usAnimState</a> ][ <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#d1221226402ff4b54671e0142ec90cd6">usAniCode</a> ];
<a name="l00125"></a>00125 
<a name="l00126"></a>00126             <span class="comment">// Handle muzzle flashes</span>
<a name="l00127"></a>00127             <span class="keywordflow">if</span> ( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#3427dfb89368f9fafbd3d15dcaa7c104">bMuzFlashCount</a> &gt; 0 )
<a name="l00128"></a>00128             {
<a name="l00129"></a>00129                   <span class="comment">// FLash for about 3 frames</span>
<a name="l00130"></a>00130                   <span class="keywordflow">if</span> ( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#3427dfb89368f9fafbd3d15dcaa7c104">bMuzFlashCount</a> &gt; MAX_ANIFRAMES_PER_FLASH )
<a name="l00131"></a>00131                   {
<a name="l00132"></a>00132                         <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#3427dfb89368f9fafbd3d15dcaa7c104">bMuzFlashCount</a> = 0;
<a name="l00133"></a>00133                         <span class="keywordflow">if</span> ( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#9eb09711b01dd216b9d0d04a281355ee">iMuzFlash</a> != -1 )
<a name="l00134"></a>00134                         {
<a name="l00135"></a>00135                               <a class="code" href="lighting_8cpp.html#4222f2b7b0ba935a4fd7b3712ec28caf">LightSpriteDestroy</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#9eb09711b01dd216b9d0d04a281355ee">iMuzFlash</a> );
<a name="l00136"></a>00136           <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#9eb09711b01dd216b9d0d04a281355ee">iMuzFlash</a> = -1;
<a name="l00137"></a>00137                         }
<a name="l00138"></a>00138                   }
<a name="l00139"></a>00139                   <span class="keywordflow">else</span>
<a name="l00140"></a>00140                   {
<a name="l00141"></a>00141                         <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#3427dfb89368f9fafbd3d15dcaa7c104">bMuzFlashCount</a>++;
<a name="l00142"></a>00142                   }
<a name="l00143"></a>00143 
<a name="l00144"></a>00144             }
<a name="l00145"></a>00145 
<a name="l00146"></a>00146             <span class="keywordflow">if</span> ( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#e1fb3320120ea081e8c12c14dac8d2ef">bBreathCollapsed</a> )
<a name="l00147"></a>00147             {
<a name="l00148"></a>00148                   <span class="comment">// ATE: If we have fallen, and we can't get up... no</span>
<a name="l00149"></a>00149                   <span class="comment">// really, if we were told to collapse but have been hit after, don't</span>
<a name="l00150"></a>00150                   <span class="comment">// do anything...</span>
<a name="l00151"></a>00151                   <span class="keywordflow">if</span> ( <a class="code" href="Animation_01Control_8cpp.html#633440a87c34a25c700ce620db87d036">gAnimControl</a>[ <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#1f73b62a5ea0dd26fa1bec1d9f522b41">usAnimState</a> ].uiFlags &amp; ( ANIM_HITSTOP | ANIM_HITFINISH ) )
<a name="l00152"></a>00152                   {
<a name="l00153"></a>00153                         <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#e1fb3320120ea081e8c12c14dac8d2ef">bBreathCollapsed</a> = FALSE;
<a name="l00154"></a>00154                   }
<a name="l00155"></a>00155                   <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#e308dea18533bf5ab2bcee5bbe27391c">bLife</a> == 0 )
<a name="l00156"></a>00156                   {
<a name="l00157"></a>00157                         <span class="comment">// Death takes precedence...</span>
<a name="l00158"></a>00158                         <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#e1fb3320120ea081e8c12c14dac8d2ef">bBreathCollapsed</a> = FALSE;
<a name="l00159"></a>00159                   }
<a name="l00160"></a>00160                   <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#10dcc042f40b20751530663b0bbbe289">usPendingAnimation</a> == <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2eb4e921a02222544c65473181fe2403dec">FALLFORWARD_ROOF</a> || <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#10dcc042f40b20751530663b0bbbe289">usPendingAnimation</a> == <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2eb8f28eaaa17687dc192c1ffa03b34f840">FALLOFF</a> || <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#1f73b62a5ea0dd26fa1bec1d9f522b41">usAnimState</a> == <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2eb4e921a02222544c65473181fe2403dec">FALLFORWARD_ROOF</a> || <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#1f73b62a5ea0dd26fa1bec1d9f522b41">usAnimState</a> == <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2eb8f28eaaa17687dc192c1ffa03b34f840">FALLOFF</a> )
<a name="l00161"></a>00161                   {
<a name="l00162"></a>00162                         <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#e1fb3320120ea081e8c12c14dac8d2ef">bBreathCollapsed</a> = FALSE;
<a name="l00163"></a>00163                   }
<a name="l00164"></a>00164                   <span class="keywordflow">else</span>
<a name="l00165"></a>00165                   {
<a name="l00166"></a>00166                         <span class="comment">// Wait here until we are free....</span>
<a name="l00167"></a>00167                         <span class="keywordflow">if</span> ( !<a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#2ef1574c7fca51355c65cfcd8ccc53f2">fInNonintAnim</a> )
<a name="l00168"></a>00168                         {
<a name="l00169"></a>00169                               <span class="comment">// UNset UI</span>
<a name="l00170"></a>00170                               <a class="code" href="Handle_01UI_8cpp.html#3ca9f7e43b153367710a1bee6c71d7bc">UnSetUIBusy</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#18aef170576da81b10d00e7b6cd3627b">ubID</a> );
<a name="l00171"></a>00171 
<a name="l00172"></a>00172                               <a class="code" href="Soldier_01Control_8cpp.html#4366eaa83d933706fa6476b7476bb8ac">SoldierCollapse</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a> );
<a name="l00173"></a>00173                               
<a name="l00174"></a>00174                               <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#e1fb3320120ea081e8c12c14dac8d2ef">bBreathCollapsed</a> = FALSE;
<a name="l00175"></a>00175 
<a name="l00176"></a>00176                               <span class="keywordflow">return</span>( TRUE );
<a name="l00177"></a>00177                         }
<a name="l00178"></a>00178                   }
<a name="l00179"></a>00179             }
<a name="l00180"></a>00180 
<a name="l00181"></a>00181             <span class="comment">// Check for special code</span>
<a name="l00182"></a>00182             <span class="keywordflow">if</span> ( sNewAniFrame &lt; 399 )
<a name="l00183"></a>00183             {
<a name="l00184"></a>00184                         
<a name="l00185"></a>00185                   <span class="comment">// Adjust / set true ani frame</span>
<a name="l00186"></a>00186                   <span class="comment">// Use -1 because ani files are 1-based, these are 0-based</span>
<a name="l00187"></a>00187                   <a class="code" href="Soldier_01Control_8cpp.html#43134a623e66c2b217f219666278fba0">ConvertAniCodeToAniFrame</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>, (<a class="code" href="Types_8h.html#30f500129d8c688af07726d5d34ce52d">INT16</a>)( sNewAniFrame - 1 ) );
<a name="l00188"></a>00188 
<a name="l00189"></a>00189                   <span class="comment">// Adjust frame control pos, and try again</span>
<a name="l00190"></a>00190                   <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#d1221226402ff4b54671e0142ec90cd6">usAniCode</a>++;
<a name="l00191"></a>00191                   <span class="keywordflow">break</span>;
<a name="l00192"></a>00192             }
<a name="l00193"></a>00193             <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( sNewAniFrame &lt; 500 )
<a name="l00194"></a>00194             {
<a name="l00195"></a>00195                   <span class="comment">// Switch on special code</span>
<a name="l00196"></a>00196                   <span class="keywordflow">switch</span>( sNewAniFrame )
<a name="l00197"></a>00197                   {
<a name="l00198"></a>00198                         <span class="keywordflow">case</span> 402:
<a name="l00199"></a>00199 
<a name="l00200"></a>00200                               <span class="comment">// DO NOT MOVE FOR THIS FRAME</span>
<a name="l00201"></a>00201                               <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#61f491a6e210c9652ea64cf21c2d3461">fPausedMove</a> = TRUE;
<a name="l00202"></a>00202                               <span class="keywordflow">break</span>;
<a name="l00203"></a>00203 
<a name="l00204"></a>00204                         <span class="keywordflow">case</span> 403:
<a name="l00205"></a>00205 
<a name="l00206"></a>00206                               <span class="comment">// MOVE GUY FORWARD SOME VALUE</span>
<a name="l00207"></a>00207                               <a class="code" href="Soldier_01Control_8cpp.html#905e2d828289ad582cafe7449e14b015">MoveMercFacingDirection</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>, FALSE, (<a class="code" href="Types_8h.html#8d06b04c04132c6f7c0fcb08c6167455">FLOAT</a>)0.7 );
<a name="l00208"></a>00208 
<a name="l00209"></a>00209                               <span class="keywordflow">break</span>;
<a name="l00210"></a>00210 
<a name="l00211"></a>00211                         <span class="keywordflow">case</span> 404:
<a name="l00212"></a>00212 
<a name="l00213"></a>00213                               <span class="comment">// MOVE GUY BACKWARD SOME VALUE</span>
<a name="l00214"></a>00214                               <span class="comment">// Use same function as forward, but is -ve values!</span>
<a name="l00215"></a>00215                               <a class="code" href="Soldier_01Control_8cpp.html#905e2d828289ad582cafe7449e14b015">MoveMercFacingDirection</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a> , TRUE, (<a class="code" href="Types_8h.html#8d06b04c04132c6f7c0fcb08c6167455">FLOAT</a>)1 );
<a name="l00216"></a>00216                               <span class="keywordflow">break</span>;
<a name="l00217"></a>00217 
<a name="l00218"></a>00218                         <span class="keywordflow">case</span> 405:
<a name="l00219"></a>00219 
<a name="l00220"></a>00220                               <span class="keywordflow">return</span>( TRUE );
<a name="l00221"></a>00221 
<a name="l00222"></a>00222                         <span class="keywordflow">case</span> 406:
<a name="l00223"></a>00223 
<a name="l00224"></a>00224                               <span class="comment">// Move merc up</span>
<a name="l00225"></a>00225                               <span class="keywordflow">if</span> ( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#8aa6174a253c3fa21a3ec41ce0174340">bDirection</a> == <a class="code" href="Overhead_01Types_8h.html#df5bf54a26a76adf253f57d88ade82b7d0611de6f28d4a9c9eac959f5344698e">NORTH</a> )
<a name="l00226"></a>00226                               {
<a name="l00227"></a>00227                                     <a class="code" href="Soldier_01Control_8cpp.html#85356885ab89da0e5fdb7a225f7db225">SetSoldierHeight</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>, (<a class="code" href="Types_8h.html#8d06b04c04132c6f7c0fcb08c6167455">FLOAT</a>)(pSoldier-&gt;sHeightAdjustment + 2 )  );
<a name="l00228"></a>00228                               }
<a name="l00229"></a>00229                               <span class="keywordflow">else</span>
<a name="l00230"></a>00230                               {
<a name="l00231"></a>00231                                     <a class="code" href="Soldier_01Control_8cpp.html#85356885ab89da0e5fdb7a225f7db225">SetSoldierHeight</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>, (<a class="code" href="Types_8h.html#8d06b04c04132c6f7c0fcb08c6167455">FLOAT</a>)( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#18caa6e91d2ba546bae716027ee6637c">sHeightAdjustment</a> + 3 ) );
<a name="l00232"></a>00232                               }
<a name="l00233"></a>00233                               <span class="keywordflow">break</span>;
<a name="l00234"></a>00234 
<a name="l00235"></a>00235                         <span class="keywordflow">case</span> 408:
<a name="l00236"></a>00236 
<a name="l00237"></a>00237                               <span class="comment">// CODE: SPECIAL MOVE CLIMB UP ROOF EVENT</span>
<a name="l00238"></a>00238 
<a name="l00239"></a>00239                   <span class="comment">// re-enable sight</span>
<a name="l00240"></a>00240                   <a class="code" href="Overhead_8cpp.html#46bd754f8875c305ab18731ed10e3364">gTacticalStatus</a>.<a class="code" href="structTacticalStatusType.html#89eb954f99ad4f28b84d7cf675c8ed32">uiFlags</a> &amp;= (~DISALLOW_SIGHT);
<a name="l00241"></a>00241                               {
<a name="l00242"></a>00242                                     <a class="code" href="Types_8h.html#30f500129d8c688af07726d5d34ce52d">INT16</a>       sXPos, sYPos;
<a name="l00243"></a>00243 
<a name="l00244"></a>00244                                     <span class="comment">//usNewGridNo = NewGridNo( (UINT16)pSoldier-&gt;sGridNo, (UINT16)DirectionInc( pSoldier-&gt;bDirection ) );</span>
<a name="l00245"></a>00245                                     <a class="code" href="Isometric_01Utils_8cpp.html#916ec848f729ed562533589f00211f5f">ConvertMapPosToWorldTileCenter</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#1cf58f06da7b4cd9bb5a55a1c4c07fdb">sTempNewGridNo</a>, &amp;sXPos, &amp;sYPos );
<a name="l00246"></a>00246                                     <a class="code" href="Soldier_01Control_8cpp.html#265ef31340bc30f973e4fd89d56c1c32">EVENT_SetSoldierPosition</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>, (<a class="code" href="Types_8h.html#8d06b04c04132c6f7c0fcb08c6167455">FLOAT</a>)sXPos, (<a class="code" href="Types_8h.html#8d06b04c04132c6f7c0fcb08c6167455">FLOAT</a>)sYPos );
<a name="l00247"></a>00247                               }
<a name="l00248"></a>00248                               <span class="comment">// Move two CC directions</span>
<a name="l00249"></a>00249                               <a class="code" href="Soldier_01Control_8cpp.html#1117087649d17ca4dfc078c0947e7f09">EVENT_SetSoldierDirection</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>, <a class="code" href="Isometric_01Utils_8cpp.html#a1a621c0ccc1f6c72c8b0bb7178c1318">gTwoCCDirection</a>[ <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#8aa6174a253c3fa21a3ec41ce0174340">bDirection</a> ] );
<a name="l00250"></a>00250 
<a name="l00251"></a>00251                               <a class="code" href="Soldier_01Control_8cpp.html#019f893295bb96f48261ded184a17cab">EVENT_SetSoldierDesiredDirection</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>, <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#8aa6174a253c3fa21a3ec41ce0174340">bDirection</a> );
<a name="l00252"></a>00252 
<a name="l00253"></a>00253                               <span class="comment">// Set desired anim height!</span>
<a name="l00254"></a>00254                               <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#f33459812e24af812d6439d62959709a">ubDesiredHeight</a> = ANIM_CROUCH;
<a name="l00255"></a>00255                               
<a name="l00256"></a>00256                               <span class="comment">// Madd</span>
<a name="l00257"></a>00257                               usUIMovementMode = <a class="code" href="Soldier_01Control_8cpp.html#3cf92e9113d74b58d642c1983186d55f">GetMoveStateBasedOnStance</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>, <a class="code" href="Animation_01Control_8cpp.html#633440a87c34a25c700ce620db87d036">gAnimControl</a>[ <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#1f73b62a5ea0dd26fa1bec1d9f522b41">usAnimState</a> ].ubEndHeight );
<a name="l00258"></a>00258                               <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#28f15074956f36e3933f6cc10647eacf">usUIMovementMode</a> = usUIMovementMode;
<a name="l00259"></a>00259 
<a name="l00260"></a>00260                               <span class="comment">// Move merc up specific height</span>
<a name="l00261"></a>00261                               <a class="code" href="Soldier_01Control_8cpp.html#85356885ab89da0e5fdb7a225f7db225">SetSoldierHeight</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>, (<a class="code" href="Types_8h.html#8d06b04c04132c6f7c0fcb08c6167455">FLOAT</a>)50 );
<a name="l00262"></a>00262 
<a name="l00263"></a>00263                               <span class="comment">// ATE: Change interface level.....</span>
<a name="l00264"></a>00264                               <span class="comment">// CJC: only if we are a player merc</span>
<a name="l00265"></a>00265                               <span class="keywordflow">if</span> (<a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#74a40a8aaf3efe840cdaf6be62556d82">bTeam</a> == <a class="code" href="Campaign_8cpp.html#47b2067ff75193e24776eda5297400ff">gbPlayerNum</a>)
<a name="l00266"></a>00266                               {
<a name="l00267"></a>00267 
<a name="l00268"></a>00268                                     <span class="keywordflow">if</span> (<a class="code" href="Overhead_8cpp.html#46bd754f8875c305ab18731ed10e3364">gTacticalStatus</a>.<a class="code" href="structTacticalStatusType.html#1aa7fa93044da366b9072c35e0a9b297">fAutoBandageMode</a>)
<a name="l00269"></a>00269                                     {
<a name="l00270"></a>00270                                           <span class="comment">// in autobandage, handle as AI, but add roof marker too</span>
<a name="l00271"></a>00271                                           <a class="code" href="ai_8h.html#59f9eb61704be305dd8baa7c476a359e">FreeUpNPCFromRoofClimb</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a> );
<a name="l00272"></a>00272                                           <a class="code" href="Soldier_01Control_8cpp.html#6973d3ad03317a9a2992888e7d1b470b">HandlePlacingRoofMarker</a>( pSoldier, pSoldier-&gt;sGridNo, TRUE, TRUE );
<a name="l00273"></a>00273                                     }
<a name="l00274"></a>00274                                     <span class="keywordflow">else</span>
<a name="l00275"></a>00275                                     {
<a name="l00276"></a>00276                                           <span class="comment">// OK, UNSET INTERFACE FIRST</span>
<a name="l00277"></a>00277                                           <a class="code" href="Handle_01UI_8cpp.html#3ca9f7e43b153367710a1bee6c71d7bc">UnSetUIBusy</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#18aef170576da81b10d00e7b6cd3627b">ubID</a> );
<a name="l00278"></a>00278 
<a name="l00279"></a>00279                                           <span class="keywordflow">if</span> ( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#18aef170576da81b10d00e7b6cd3627b">ubID</a> == <a class="code" href="Interface_01Utils_8cpp.html#07d83e717b98bc3cf6628f0bb9bc9205">gusSelectedSoldier</a> )
<a name="l00280"></a>00280                                           {
<a name="l00281"></a>00281                                                 <a class="code" href="Handle_01UI_8cpp.html#ef9bff23fefbaef397d203ecdde3cb4a">ChangeInterfaceLevel</a>( 1 );
<a name="l00282"></a>00282                                           }
<a name="l00283"></a>00283                                           <a class="code" href="Soldier_01Control_8cpp.html#6973d3ad03317a9a2992888e7d1b470b">HandlePlacingRoofMarker</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>, <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#2ab66ee0f37902cd448f4a738df4f2bf">sGridNo</a>, TRUE, TRUE );
<a name="l00284"></a>00284                                     }
<a name="l00285"></a>00285                               }
<a name="l00286"></a>00286                               <span class="keywordflow">else</span>
<a name="l00287"></a>00287                               {
<a name="l00288"></a>00288                                     <a class="code" href="ai_8h.html#59f9eb61704be305dd8baa7c476a359e">FreeUpNPCFromRoofClimb</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a> );
<a name="l00289"></a>00289                               }
<a name="l00290"></a>00290 
<a name="l00291"></a>00291                               <span class="comment">// ATE: Handle sight...</span>
<a name="l00292"></a>00292                               <a class="code" href="opplist_8cpp.html#84caab6b3c04128593b43316bfdfdf43">HandleSight</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>,SIGHT_LOOK | SIGHT_RADIO | SIGHT_INTERRUPT );
<a name="l00293"></a>00293                               <span class="keywordflow">break</span>;
<a name="l00294"></a>00294 
<a name="l00295"></a>00295                         <span class="keywordflow">case</span> 409:
<a name="l00296"></a>00296                               
<a name="l00297"></a>00297                               <span class="comment">//CODE: MOVE DOWN</span>
<a name="l00298"></a>00298                               <a class="code" href="Soldier_01Control_8cpp.html#85356885ab89da0e5fdb7a225f7db225">SetSoldierHeight</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>, (<a class="code" href="Types_8h.html#8d06b04c04132c6f7c0fcb08c6167455">FLOAT</a>)( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#18caa6e91d2ba546bae716027ee6637c">sHeightAdjustment</a> - 2 ) );
<a name="l00299"></a>00299                               <span class="keywordflow">break</span>;
<a name="l00300"></a>00300 
<a name="l00301"></a>00301                         <span class="keywordflow">case</span> 410:
<a name="l00302"></a>00302 
<a name="l00303"></a>00303                               <span class="comment">// Move merc down specific height</span>
<a name="l00304"></a>00304                               <a class="code" href="Soldier_01Control_8cpp.html#85356885ab89da0e5fdb7a225f7db225">SetSoldierHeight</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>, (<a class="code" href="Types_8h.html#8d06b04c04132c6f7c0fcb08c6167455">FLOAT</a>)0 );
<a name="l00305"></a>00305                               <span class="keywordflow">break</span>;
<a name="l00306"></a>00306 
<a name="l00307"></a>00307                         <span class="keywordflow">case</span> 411:
<a name="l00308"></a>00308 
<a name="l00309"></a>00309                               <span class="comment">// CODE: SPECIALMOVE CLIMB DOWN EVENT</span>
<a name="l00310"></a>00310                               <span class="comment">// Move two C directions</span>
<a name="l00311"></a>00311                               <a class="code" href="Soldier_01Control_8cpp.html#1117087649d17ca4dfc078c0947e7f09">EVENT_SetSoldierDirection</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>, <a class="code" href="Isometric_01Utils_8cpp.html#bc913eacd8c5a5d945f0e7e21d648e1b">gTwoCDirection</a>[ <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#8aa6174a253c3fa21a3ec41ce0174340">bDirection</a> ] );
<a name="l00312"></a>00312 
<a name="l00313"></a>00313                               <a class="code" href="Soldier_01Control_8cpp.html#019f893295bb96f48261ded184a17cab">EVENT_SetSoldierDesiredDirection</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>, <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#8aa6174a253c3fa21a3ec41ce0174340">bDirection</a> );
<a name="l00314"></a>00314                               <span class="comment">// Adjust height</span>
<a name="l00315"></a>00315                               <a class="code" href="Soldier_01Control_8cpp.html#85356885ab89da0e5fdb7a225f7db225">SetSoldierHeight</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>, (<a class="code" href="Types_8h.html#8d06b04c04132c6f7c0fcb08c6167455">FLOAT</a>)<a class="code" href="Soldier_01Ani_8cpp.html#761217107ba66a306c345ae9e7f7deba">gClimbDownRoofStartDist</a>[ <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#b082364eed3d7883662f69e1fd96be1a">ubBodyType</a> ] );
<a name="l00316"></a>00316                               <span class="comment">// Adjust position</span>
<a name="l00317"></a>00317                               <a class="code" href="Soldier_01Control_8cpp.html#905e2d828289ad582cafe7449e14b015">MoveMercFacingDirection</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a> , TRUE, (<a class="code" href="Types_8h.html#8d06b04c04132c6f7c0fcb08c6167455">FLOAT</a>)3.5 );
<a name="l00318"></a>00318                               <span class="keywordflow">break</span>;
<a name="l00319"></a>00319 
<a name="l00320"></a>00320                         <span class="keywordflow">case</span> 412:
<a name="l00321"></a>00321 
<a name="l00322"></a>00322                               <span class="comment">// CODE: HANDLING PRONE DOWN - NEED TO MOVE GUY BACKWARDS!</span>
<a name="l00323"></a>00323                               <a class="code" href="Soldier_01Control_8cpp.html#905e2d828289ad582cafe7449e14b015">MoveMercFacingDirection</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a> , FALSE, (<a class="code" href="Types_8h.html#8d06b04c04132c6f7c0fcb08c6167455">FLOAT</a>).2 );
<a name="l00324"></a>00324                               <span class="keywordflow">break</span>;
<a name="l00325"></a>00325 
<a name="l00326"></a>00326                         <span class="keywordflow">case</span> 413:
<a name="l00327"></a>00327 
<a name="l00328"></a>00328                               <span class="comment">// CODE: HANDLING PRONE UP - NEED TO MOVE GUY FORWARDS!</span>
<a name="l00329"></a>00329                               <a class="code" href="Soldier_01Control_8cpp.html#905e2d828289ad582cafe7449e14b015">MoveMercFacingDirection</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a> , TRUE, (<a class="code" href="Types_8h.html#8d06b04c04132c6f7c0fcb08c6167455">FLOAT</a>).2 );
<a name="l00330"></a>00330                               <span class="keywordflow">break</span>;
<a name="l00331"></a>00331 
<a name="l00332"></a>00332                         <span class="keywordflow">case</span> 430:
<a name="l00333"></a>00333 
<a name="l00334"></a>00334                               DebugMsg(<a class="code" href="DEBUG_8cpp.html#a7985c2fd033797fc67a03b2c26e07c6">TOPIC_JA2</a>,DBG_LEVEL_3,<span class="stringliteral">"AdjustToNextAnimationFrame: case 430"</span>);
<a name="l00335"></a>00335                               <span class="comment">// SHOOT GUN</span>
<a name="l00336"></a>00336                               <span class="comment">// MAKE AN EVENT, BUT ONLY DO STUFF IF WE OWN THE GUY!</span>
<a name="l00337"></a>00337                               <a class="code" href="Event_01Pump_8cpp.html#774bce22f7a5663fe374ccd634b4841a">SFireWeapon</a>.<a class="code" href="structEV__S__FIREWEAPON.html#6430075d69ff58a6248beca3d1221bdc">usSoldierID</a>             = <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#18aef170576da81b10d00e7b6cd3627b">ubID</a>;
<a name="l00338"></a>00338                               <a class="code" href="Event_01Pump_8cpp.html#774bce22f7a5663fe374ccd634b4841a">SFireWeapon</a>.<a class="code" href="structEV__S__FIREWEAPON.html#c3153b7c83b153b3ba58fb77e26d2ece">uiUniqueId</a>              = <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#60a04bd22cd1bd105c4dfc8b474c7f77">uiUniqueSoldierIdValue</a>;
<a name="l00339"></a>00339                               <a class="code" href="Event_01Pump_8cpp.html#774bce22f7a5663fe374ccd634b4841a">SFireWeapon</a>.<a class="code" href="structEV__S__FIREWEAPON.html#791d0ee5945301b24f275b936f0634ce">sTargetGridNo</a>           = <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#97fff971b8c532135f0c0451deac7aa1">sTargetGridNo</a>;
<a name="l00340"></a>00340                               <a class="code" href="Event_01Pump_8cpp.html#774bce22f7a5663fe374ccd634b4841a">SFireWeapon</a>.<a class="code" href="structEV__S__FIREWEAPON.html#fbec08884850866a8e34b1e1db5a20ac">bTargetLevel</a>            = <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#e29f2821a7f319ffe6405848dabb4c6b">bTargetLevel</a>;
<a name="l00341"></a>00341                               <a class="code" href="Event_01Pump_8cpp.html#774bce22f7a5663fe374ccd634b4841a">SFireWeapon</a>.<a class="code" href="structEV__S__FIREWEAPON.html#65a640dd8b318bc5db0d98bdeb8ca743">bTargetCubeLevel</a>= <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#7eaadda2fc53dcffc93c497f43223ea8">bTargetCubeLevel</a>;
<a name="l00342"></a>00342                               <a class="code" href="Event_01Pump_8cpp.html#dd8362dd57b58bb96793a39e53879a24">AddGameEvent</a>( <a class="code" href="Event_01Pump_8h.html#b0a9231a096b68acc76da6e80c97e32f4c167a780a210169badcfb8d632e7d84">S_FIREWEAPON</a>, 0, &amp;<a class="code" href="Event_01Pump_8cpp.html#774bce22f7a5663fe374ccd634b4841a">SFireWeapon</a> );
<a name="l00343"></a>00343 
<a name="l00344"></a>00344                               <span class="comment">//DIGICRAB: Burst UnCap</span>
<a name="l00345"></a>00345                               <span class="comment">//Loop around in the animation if we still have burst rounds to fire</span>
<a name="l00346"></a>00346                               <span class="keywordflow">if</span> (<a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#dd307dffd553de4a1e01f74c050e6e07">bDoBurst</a> &amp;&amp; (<a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#dd307dffd553de4a1e01f74c050e6e07">bDoBurst</a> &lt;= ((<a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#b77b23ae10e38a30c4a586d26882545b">bDoAutofire</a>)?(<a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#b77b23ae10e38a30c4a586d26882545b">bDoAutofire</a>):(<a class="code" href="Weapons_8cpp.html#0887bcd1ec2ba854bbfc4dce4cb00b33">GetShotsPerBurst</a>(&amp;<a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#13c875b952b6d634680165d127a9870b">inv</a>[<a class="code" href="Soldier_01Control_8h.html#2a5937706f1724c8f06a0396bdc87855408e678e638d95e18d5e9a2a64a96e2e">HANDPOS</a>]))) || (( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#363d85a2e4c2405db5046904d1d4549d">bWeaponMode</a> == <a class="code" href="Soldier_01Control_8h.html#db461b7936f2fc5849c8168828b69c4c7c71652644f3b7aff3b71a0626c0c133">WM_ATTACHED_GL_BURST</a> &amp;&amp; <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#dd307dffd553de4a1e01f74c050e6e07">bDoBurst</a> &lt;= <a class="code" href="Weapons_8cpp.html#fac72e30bc7c36f55257eac0542ce51d">Weapon</a>[<a class="code" href="Items_8cpp.html#7cb1bfb4454c9fec31dc641a715f6756">GetAttachedGrenadeLauncher</a>(&amp;<a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#13c875b952b6d634680165d127a9870b">inv</a>[<a class="code" href="Soldier_01Control_8h.html#2a5937706f1724c8f06a0396bdc87855408e678e638d95e18d5e9a2a64a96e2e">HANDPOS</a>])].ubShotsPerBurst)) ))
<a name="l00347"></a>00347                               {
<a name="l00348"></a>00348                                     <span class="keywordflow">if</span>(<a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#1f73b62a5ea0dd26fa1bec1d9f522b41">usAnimState</a> == 44 || <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#1f73b62a5ea0dd26fa1bec1d9f522b41">usAnimState</a> == 109 || <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#1f73b62a5ea0dd26fa1bec1d9f522b41">usAnimState</a> == 108 &amp;&amp; <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#d1221226402ff4b54671e0142ec90cd6">usAniCode</a> == 33) <span class="comment">//we are standing, crounching or prone, firing the fast shot</span>
<a name="l00349"></a>00349                                           <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#d1221226402ff4b54671e0142ec90cd6">usAniCode</a> = 3;
<a name="l00350"></a>00350                                     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#1f73b62a5ea0dd26fa1bec1d9f522b41">usAnimState</a> == 175 &amp;&amp; <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#d1221226402ff4b54671e0142ec90cd6">usAniCode</a> == 37) <span class="comment">//we are firing down to something very close, last shot</span>
<a name="l00351"></a>00351                                           <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#d1221226402ff4b54671e0142ec90cd6">usAniCode</a> = 14;
<a name="l00352"></a>00352                               }
<a name="l00353"></a>00353 
<a name="l00354"></a>00354                               <span class="comment">//DIGICRAB: Burst Sound</span>
<a name="l00355"></a>00355                               <span class="comment">//This code is stolen from Tactical\Weapons.c - UseGun(...)</span>
<a name="l00356"></a>00356                               <span class="keywordflow">if</span> (<a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#dd307dffd553de4a1e01f74c050e6e07">bDoBurst</a> &amp;&amp; <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#de22256ffc6891f71eb0a899a91d6d76">iBurstSoundID</a> == NO_SAMPLE &amp;&amp; <a class="code" href="Weapons_8cpp.html#fac72e30bc7c36f55257eac0542ce51d">Weapon</a>[ <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#549976333a3c89be2ca4a342235e1464">usAttackingWeapon</a> ].sSound != 0 &amp;&amp; <a class="code" href="Item_01Types_8h.html#f9dc4cc7a3a99ad5944940cfb7c82237">Item</a>[ <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#549976333a3c89be2ca4a342235e1464">usAttackingWeapon</a> ].usItemClass != IC_THROWING_KNIFE )
<a name="l00357"></a>00357                               {
<a name="l00358"></a>00358                                     <span class="comment">// Switch on silencer...</span>
<a name="l00359"></a>00359                                     <a class="code" href="Types_8h.html#30f500129d8c688af07726d5d34ce52d">INT16</a> noisefactor = <a class="code" href="Items_8cpp.html#291ee822ad1309e52ca55d466e214de8">GetPercentNoiseVolume</a>( &amp;<a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#13c875b952b6d634680165d127a9870b">inv</a>[ <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#99a689d831418a5e3ed638a34761514e">ubAttackingHand</a> ] );
<a name="l00360"></a>00360                                     <span class="keywordflow">if</span>( noisefactor &lt; MAX_PERCENT_NOISE_VOLUME_FOR_SILENCED_SOUND || <a class="code" href="Weapons_8cpp.html#fac72e30bc7c36f55257eac0542ce51d">Weapon</a>[ <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#549976333a3c89be2ca4a342235e1464">usAttackingWeapon</a> ].ubAttackVolume &lt;= 10 )
<a name="l00361"></a>00361                                     {
<a name="l00362"></a>00362                                           <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a> uiSound;
<a name="l00363"></a>00363 
<a name="l00364"></a>00364                                           uiSound = <a class="code" href="Weapons_8cpp.html#fac72e30bc7c36f55257eac0542ce51d">Weapon</a> [      <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#549976333a3c89be2ca4a342235e1464">usAttackingWeapon</a> ].<a class="code" href="structWEAPONTYPE.html#4affd783e6463d8ff677c366d6c3cfe0">silencedSound</a>;                
<a name="l00365"></a>00365                                           <span class="comment">//if ( Weapon[ pSoldier-&gt;usAttackingWeapon ].ubCalibre == AMMO9 || Weapon[ pSoldier-&gt;usAttackingWeapon ].ubCalibre == AMMO38 || Weapon[ pSoldier-&gt;usAttackingWeapon ].ubCalibre == AMMO57 )</span>
<a name="l00366"></a>00366                                           <span class="comment">//{</span>
<a name="l00367"></a>00367                                           <span class="comment">//    uiSound = S_SILENCER_1;</span>
<a name="l00368"></a>00368                                           <span class="comment">//}</span>
<a name="l00369"></a>00369                                           <span class="comment">//else</span>
<a name="l00370"></a>00370                                           <span class="comment">//{</span>
<a name="l00371"></a>00371                                           <span class="comment">//    uiSound = S_SILENCER_2;</span>
<a name="l00372"></a>00372                                           <span class="comment">//}</span>
<a name="l00373"></a>00373 
<a name="l00374"></a>00374                                           <span class="comment">//randomize the rate a bit so that the sound is more believable</span>
<a name="l00375"></a>00375                                           <a class="code" href="Sound_01Control_8cpp.html#6b140a8e4fcf89b7740c037ff12580a7">PlayJA2Sample</a>( uiSound, 44100-<a class="code" href="Random_8cpp.html#49f938d1313ab6ef09ac6223a16ac334">Random</a>(5000)-<a class="code" href="Random_8cpp.html#49f938d1313ab6ef09ac6223a16ac334">Random</a>(5000)-<a class="code" href="Random_8cpp.html#49f938d1313ab6ef09ac6223a16ac334">Random</a>(5000), <a class="code" href="Sound_01Control_8cpp.html#f62b2a668c2e25997578956c425723c4">SoundVolume</a>( HIGHVOLUME, <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#2ab66ee0f37902cd448f4a738df4f2bf">sGridNo</a> ), 1, <a class="code" href="Sound_01Control_8cpp.html#a258fd693b7e800828705055bf357c8d">SoundDir</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#2ab66ee0f37902cd448f4a738df4f2bf">sGridNo</a> ) );                 
<a name="l00376"></a>00376                                           
<a name="l00377"></a>00377                                     }
<a name="l00378"></a>00378                                     <span class="keywordflow">else</span>
<a name="l00379"></a>00379                                     {
<a name="l00380"></a>00380                                           <a class="code" href="Types_8h.html#7ebe70ceca856797319175e30bcf003d">INT8</a> <a class="code" href="Mss-old_8h.html#4016415eff4e2bb3df91a8a94eb51ce3">volume</a> = HIGHVOLUME;
<a name="l00381"></a>00381                                           <span class="keywordflow">if</span> ( noisefactor &lt; 100 ) volume = (volume * noisefactor) / 100;
<a name="l00382"></a>00382                                           <span class="comment">//randomize the rate a bit so that the sound is more believable</span>
<a name="l00383"></a>00383                                           <a class="code" href="Sound_01Control_8cpp.html#6b140a8e4fcf89b7740c037ff12580a7">PlayJA2Sample</a>( <a class="code" href="Weapons_8cpp.html#fac72e30bc7c36f55257eac0542ce51d">Weapon</a>[ <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#549976333a3c89be2ca4a342235e1464">usAttackingWeapon</a> ].sSound, 44100-<a class="code" href="Random_8cpp.html#49f938d1313ab6ef09ac6223a16ac334">Random</a>(5000)-<a class="code" href="Random_8cpp.html#49f938d1313ab6ef09ac6223a16ac334">Random</a>(5000)-<a class="code" href="Random_8cpp.html#49f938d1313ab6ef09ac6223a16ac334">Random</a>(5000), <a class="code" href="Sound_01Control_8cpp.html#f62b2a668c2e25997578956c425723c4">SoundVolume</a>( volume, <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#2ab66ee0f37902cd448f4a738df4f2bf">sGridNo</a> ), 1, <a class="code" href="Sound_01Control_8cpp.html#a258fd693b7e800828705055bf357c8d">SoundDir</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#2ab66ee0f37902cd448f4a738df4f2bf">sGridNo</a> ) );              
<a name="l00384"></a>00384                                     }
<a name="l00385"></a>00385                               }
<a name="l00386"></a>00386 
<a name="l00387"></a>00387                               <span class="keywordflow">break</span>;
<a name="l00388"></a>00388 
<a name="l00389"></a>00389                         <span class="keywordflow">case</span> 431:
<a name="l00390"></a>00390 
<a name="l00391"></a>00391                               <span class="comment">// FLASH FRAME WHITE</span>
<a name="l00392"></a>00392                               <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#92b3e385f0b43daf4f2648ed9efdc950">pForcedShade</a> = <a class="code" href="shading_8cpp.html#2b3d71d1e39f8aad6c3d67f3ba22b27d">White16BPPPalette</a>;
<a name="l00393"></a>00393                               <span class="keywordflow">break</span>;
<a name="l00394"></a>00394 
<a name="l00395"></a>00395                         <span class="keywordflow">case</span> 432:
<a name="l00396"></a>00396 
<a name="l00397"></a>00397                               <span class="comment">// PLAY RANDOM IMPACT SOUND!</span>
<a name="l00398"></a>00398                         <span class="comment">//    PlayJA2Sample( (UINT8)( BULLET_IMPACT_1 + Random(3) ), RATE_11025, MIDVOLUME, 1, MIDDLEPAN );</span>
<a name="l00399"></a>00399 
<a name="l00400"></a>00400                               <span class="comment">// PLAY RANDOM GETTING HIT SOUND</span>
<a name="l00401"></a>00401                         <span class="comment">//    DoMercBattleSound( pSoldier, BATTLE_SOUND_HIT1 );</span>
<a name="l00402"></a>00402 
<a name="l00403"></a>00403                               <span class="keywordflow">break</span>;
<a name="l00404"></a>00404 
<a name="l00405"></a>00405                         <span class="keywordflow">case</span> 433:
<a name="l00406"></a>00406 
<a name="l00407"></a>00407                               <span class="comment">// CODE: GENERIC HIT!</span>
<a name="l00408"></a>00408 
<a name="l00409"></a>00409                               <a class="code" href="Soldier_01Ani_8cpp.html#a9bf3ae72a0d41cf3cdcd31c8f3d01e9">CheckForAndHandleSoldierIncompacitated</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a> );
<a name="l00410"></a>00410 
<a name="l00411"></a>00411       
<a name="l00412"></a>00412                               <span class="keywordflow">break</span>;
<a name="l00413"></a>00413 
<a name="l00414"></a>00414                         <span class="keywordflow">case</span> 434:
<a name="l00415"></a>00415 
<a name="l00416"></a>00416                               <span class="comment">// JUMP TO ANOTHER ANIMATION ( BLOOD ) IF WE WANT BLOOD</span>
<a name="l00417"></a>00417                               uiJumpAddress = <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#1f73b62a5ea0dd26fa1bec1d9f522b41">usAnimState</a>;
<a name="l00418"></a>00418                               <a class="code" href="Soldier_01Control_8cpp.html#6f191e00fb4f3c5e2cbe762aa402a420">ChangeSoldierState</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>, <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2eb80931e7665f570cf5f2826c829fd6a19">FLYBACK_HIT_BLOOD_STAND</a>, 0, FALSE );
<a name="l00419"></a>00419                               <span class="keywordflow">return</span>( TRUE );
<a name="l00420"></a>00420                               <span class="keywordflow">break</span>;
<a name="l00421"></a>00421 
<a name="l00422"></a>00422                         <span class="keywordflow">case</span> 435:
<a name="l00423"></a>00423 
<a name="l00424"></a>00424                               <span class="comment">// HOOK FOR A RETURN JUMP</span>
<a name="l00425"></a>00425                               <span class="keywordflow">break</span>;
<a name="l00426"></a>00426 
<a name="l00427"></a>00427                         <span class="keywordflow">case</span> 436:
<a name="l00428"></a>00428 
<a name="l00429"></a>00429                               <span class="comment">// Loop through script to find entry address</span>
<a name="l00430"></a>00430                               <span class="keywordflow">if</span> ( uiJumpAddress == NO_JUMP )
<a name="l00431"></a>00431                               {
<a name="l00432"></a>00432                                     <span class="keywordflow">break</span>;
<a name="l00433"></a>00433                               }
<a name="l00434"></a>00434                               usOldAnimState = <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#1f73b62a5ea0dd26fa1bec1d9f522b41">usAnimState</a>;
<a name="l00435"></a>00435                               <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#d1221226402ff4b54671e0142ec90cd6">usAniCode</a>  = 0;
<a name="l00436"></a>00436 
<a name="l00437"></a>00437                               <span class="keywordflow">do</span>
<a name="l00438"></a>00438                               {
<a name="l00439"></a>00439                                     <span class="comment">// Get new frame code</span>
<a name="l00440"></a>00440                                     anAniFrame = <a class="code" href="Animation_01Control_8cpp.html#7ff964ad77f7f28f8f481f3e0d91b636">gusAnimInst</a>[ uiJumpAddress ][ <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#d1221226402ff4b54671e0142ec90cd6">usAniCode</a> ];
<a name="l00441"></a>00441       
<a name="l00442"></a>00442                                     <span class="keywordflow">if</span> ( anAniFrame == 435 )
<a name="l00443"></a>00443                                     {
<a name="l00444"></a>00444                                           <span class="comment">// START PROCESSING HERE</span>
<a name="l00445"></a>00445                                           <a class="code" href="Soldier_01Control_8cpp.html#6f191e00fb4f3c5e2cbe762aa402a420">ChangeSoldierState</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>, (<a class="code" href="Types_8h.html#09f1a1fb2293e33483cc8d44aefb1eb1">UINT16</a>)uiJumpAddress, <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#d1221226402ff4b54671e0142ec90cd6">usAniCode</a>, FALSE );
<a name="l00446"></a>00446                                           <span class="keywordflow">return</span>( TRUE );
<a name="l00447"></a>00447                                     }
<a name="l00448"></a>00448                                     <span class="comment">// Adjust frame control pos, and try again</span>
<a name="l00449"></a>00449                                     <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#d1221226402ff4b54671e0142ec90cd6">usAniCode</a>++;
<a name="l00450"></a>00450                               }
<a name="l00451"></a>00451                               <span class="keywordflow">while</span>( anAniFrame != 999 );
<a name="l00452"></a>00452 
<a name="l00453"></a>00453                               uiJumpAddress = NO_JUMP;
<a name="l00454"></a>00454 
<a name="l00455"></a>00455                               <span class="keywordflow">if</span> ( anAniFrame == 999 )
<a name="l00456"></a>00456                               {
<a name="l00457"></a>00457                                     <span class="comment">// Fail jump, re-load old anim</span>
<a name="l00458"></a>00458                                     <a class="code" href="Soldier_01Control_8cpp.html#6f191e00fb4f3c5e2cbe762aa402a420">ChangeSoldierState</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>, usOldAnimState, 0, FALSE );
<a name="l00459"></a>00459                                     <span class="keywordflow">return</span>( TRUE );
<a name="l00460"></a>00460                               }
<a name="l00461"></a>00461                               <span class="keywordflow">break</span>;
<a name="l00462"></a>00462 
<a name="l00463"></a>00463                         <span class="keywordflow">case</span> 437:
<a name="l00464"></a>00464 
<a name="l00465"></a>00465                               <span class="comment">// CHANGE DIRECTION AND GET-UP</span>
<a name="l00466"></a>00466                               <span class="comment">//sGridNo = NewGridNo( (UINT16)pSoldier-&gt;sGridNo, (UINT16)(-1 * DirectionInc( pSoldier-&gt;bDirection ) ) );</span>
<a name="l00467"></a>00467                               <span class="comment">//ConvertMapPosToWorldTileCenter( pSoldier-&gt;sGridNo, &amp;sXPos, &amp;sYPos );</span>
<a name="l00468"></a>00468                               <span class="comment">//SetSoldierPosition( pSoldier, (FLOAT)sXPos, (FLOAT)sYPos );</span>
<a name="l00469"></a>00469 
<a name="l00470"></a>00470 
<a name="l00471"></a>00471                               <span class="comment">// Reverse direction</span>
<a name="l00472"></a>00472                               <a class="code" href="Soldier_01Control_8cpp.html#1117087649d17ca4dfc078c0947e7f09">EVENT_SetSoldierDirection</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>,  <a class="code" href="Isometric_01Utils_8cpp.html#9591ab6c902758a420fd3d9f4e49ba2e">gOppositeDirection</a>[ <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#8aa6174a253c3fa21a3ec41ce0174340">bDirection</a> ] );
<a name="l00473"></a>00473                               <a class="code" href="Soldier_01Control_8cpp.html#019f893295bb96f48261ded184a17cab">EVENT_SetSoldierDesiredDirection</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>, <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#8aa6174a253c3fa21a3ec41ce0174340">bDirection</a> );
<a name="l00474"></a>00474 
<a name="l00475"></a>00475                               <a class="code" href="Soldier_01Control_8cpp.html#6f191e00fb4f3c5e2cbe762aa402a420">ChangeSoldierState</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>, <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2eb7a39d1a9bd7f10bd092ce8953e5010f2">GETUP_FROM_ROLLOVER</a>, 0 , FALSE );
<a name="l00476"></a>00476                               <span class="keywordflow">return</span>( TRUE );
<a name="l00477"></a>00477 
<a name="l00478"></a>00478                         <span class="keywordflow">case</span> 438:
<a name="l00479"></a>00479 
<a name="l00480"></a>00480                               <span class="comment">//CODE: START HOLD FLASH </span>
<a name="l00481"></a>00481                               <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#c9eddf219a89b7d5f0902a76a631c746">fForceShade</a> = TRUE;
<a name="l00482"></a>00482                               <span class="keywordflow">break</span>;
<a name="l00483"></a>00483 
<a name="l00484"></a>00484                         <span class="keywordflow">case</span> 439:
<a name="l00485"></a>00485                               
<a name="l00486"></a>00486                               <span class="comment">//CODE: END HOLD FLASH </span>
<a name="l00487"></a>00487                               <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#c9eddf219a89b7d5f0902a76a631c746">fForceShade</a> = FALSE;
<a name="l00488"></a>00488                               <span class="keywordflow">break</span>;
<a name="l00489"></a>00489 
<a name="l00490"></a>00490                         <span class="keywordflow">case</span> 440:
<a name="l00491"></a>00491                               <span class="comment">//CODE: Set buddy as dead!</span>
<a name="l00492"></a>00492                               {
<a name="l00493"></a>00493                                     <a class="code" href="Types_8h.html#112e3146cb38b6ee95e64d85842e380a">BOOLEAN</a> fMadeCorpse;
<a name="l00494"></a>00494 
<a name="l00495"></a>00495                                     <span class="comment">// ATE: Piggyback here on stopping the burn sound...</span>
<a name="l00496"></a>00496                                     <span class="keywordflow">if</span> ( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#1f73b62a5ea0dd26fa1bec1d9f522b41">usAnimState</a> == <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2ebc83ef90b8af99f3afbbb47f07e0c0242">CHARIOTS_OF_FIRE</a> ||
<a name="l00497"></a>00497                                                  <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#1f73b62a5ea0dd26fa1bec1d9f522b41">usAnimState</a> == <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2eb72ca88f07dd5672f6472f970b84a0893">BODYEXPLODING</a> )
<a name="l00498"></a>00498                                     {
<a name="l00499"></a>00499                                           <a class="code" href="soundman_8cpp.html#1f4f0a38d595958766a96b9f2d55517f">SoundStop</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#a69215f405f59c8085b3bb27f76893c3">uiPendingActionData1</a> );
<a name="l00500"></a>00500                                     }
<a name="l00501"></a>00501 
<a name="l00502"></a>00502 
<a name="l00503"></a>00503                                     <a class="code" href="Soldier_01Ani_8cpp.html#c8dc487d70dc5109dd507c1dcf8efb45">CheckForAndHandleSoldierDeath</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>, &amp;fMadeCorpse );
<a name="l00504"></a>00504 
<a name="l00505"></a>00505                                     <span class="keywordflow">if</span> ( fMadeCorpse )
<a name="l00506"></a>00506                                     {
<a name="l00507"></a>00507                                           <span class="keywordflow">return</span>( FALSE );
<a name="l00508"></a>00508                                     }
<a name="l00509"></a>00509                                     <span class="keywordflow">else</span>
<a name="l00510"></a>00510                                     {
<a name="l00511"></a>00511                                           <span class="keywordflow">return</span>( TRUE );
<a name="l00512"></a>00512                                     }
<a name="l00513"></a>00513                               }
<a name="l00514"></a>00514                               <span class="keywordflow">break</span>;
<a name="l00515"></a>00515 
<a name="l00516"></a>00516                         <span class="keywordflow">case</span> 441:
<a name="l00517"></a>00517                               <span class="comment">// CODE: Show muzzle flash</span>
<a name="l00518"></a>00518                               <span class="keywordflow">if</span> ( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#73246323764393ce2a5ece7fcb7b7cf8">bVisible</a> == -1 )
<a name="l00519"></a>00519                               {
<a name="l00520"></a>00520                                     <span class="keywordflow">break</span>;
<a name="l00521"></a>00521                               }
<a name="l00522"></a>00522 
<a name="l00523"></a>00523                               <span class="keywordflow">if</span> ( !<a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#e39bbecc66c2b6b8df1ef4d98ed6feab">fMuzzleFlash</a> )
<a name="l00524"></a>00524                               {
<a name="l00525"></a>00525                                     <span class="keywordflow">break</span>;
<a name="l00526"></a>00526                               }
<a name="l00527"></a>00527 
<a name="l00528"></a>00528                               <span class="comment">// DO ONLY IF WE'RE AT A GOOD LEVEL</span>
<a name="l00529"></a>00529                               <span class="keywordflow">if</span> ( <a class="code" href="lighting_8cpp.html#547678867f597197e26ee36811f7fa94">ubAmbientLightLevel</a> &lt; MIN_AMB_LEVEL_FOR_MERC_LIGHTS )
<a name="l00530"></a>00530                               {
<a name="l00531"></a>00531                                     <span class="keywordflow">break</span>;
<a name="l00532"></a>00532                               }
<a name="l00533"></a>00533 
<a name="l00534"></a>00534                               <span class="keywordflow">if</span>( ( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#9eb09711b01dd216b9d0d04a281355ee">iMuzFlash</a>=<a class="code" href="lighting_8cpp.html#260e0a8366f19a3b78a2eebf37de92b7">LightSpriteCreate</a>(<span class="stringliteral">"L-R03.LHT"</span>, 0 ) )==(-1))
<a name="l00535"></a>00535                               {
<a name="l00536"></a>00536                                     <span class="keywordflow">return</span>( TRUE );
<a name="l00537"></a>00537                               }
<a name="l00538"></a>00538 
<a name="l00539"></a>00539                               <a class="code" href="lighting_8cpp.html#1796f15b030b995625465220f5e97618">LightSpritePower</a>(<a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#9eb09711b01dd216b9d0d04a281355ee">iMuzFlash</a>, TRUE);
<a name="l00540"></a>00540                               <span class="comment">// Get one move forward</span>
<a name="l00541"></a>00541                               {
<a name="l00542"></a>00542                                     <a class="code" href="Types_8h.html#09f1a1fb2293e33483cc8d44aefb1eb1">UINT16</a>      usNewGridNo;
<a name="l00543"></a>00543                                     <a class="code" href="Types_8h.html#30f500129d8c688af07726d5d34ce52d">INT16</a> sXPos, sYPos;
<a name="l00544"></a>00544 
<a name="l00545"></a>00545                                     usNewGridNo = <a class="code" href="Isometric_01Utils_8cpp.html#318d8410127e29bb232ab70363bc316e">NewGridNo</a>( (<a class="code" href="Types_8h.html#09f1a1fb2293e33483cc8d44aefb1eb1">UINT16</a>)<a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#2ab66ee0f37902cd448f4a738df4f2bf">sGridNo</a>, <a class="code" href="Isometric_01Utils_8cpp.html#a4a3adf599f99864b1de33673888fd5e">DirectionInc</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#8aa6174a253c3fa21a3ec41ce0174340">bDirection</a> ) );
<a name="l00546"></a>00546                                     <a class="code" href="Isometric_01Utils_8cpp.html#5919936aba0b5f157738a66b7fe682f2">ConvertGridNoToCenterCellXY</a>( usNewGridNo, &amp;sXPos, &amp;sYPos );
<a name="l00547"></a>00547                                     <a class="code" href="lighting_8cpp.html#12179b99c01f46400e55335fde462a41">LightSpritePosition</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#9eb09711b01dd216b9d0d04a281355ee">iMuzFlash</a>, (<a class="code" href="Types_8h.html#30f500129d8c688af07726d5d34ce52d">INT16</a>)(sXPos/CELL_X_SIZE), (<a class="code" href="Types_8h.html#30f500129d8c688af07726d5d34ce52d">INT16</a>)(sYPos/CELL_Y_SIZE));
<a name="l00548"></a>00548 
<a name="l00549"></a>00549                                     <span class="comment">// Start count</span>
<a name="l00550"></a>00550                                     <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#3427dfb89368f9fafbd3d15dcaa7c104">bMuzFlashCount</a> = 1;
<a name="l00551"></a>00551                               }
<a name="l00552"></a>00552                               <span class="keywordflow">break</span>;
<a name="l00553"></a>00553 
<a name="l00554"></a>00554                         <span class="keywordflow">case</span> 442:
<a name="l00555"></a>00555 
<a name="l00556"></a>00556                           <span class="comment">//CODE: FOR A NON-INTERRUPTABLE SCRIPT - SIGNAL DONE</span>
<a name="l00557"></a>00557                               <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#2ef1574c7fca51355c65cfcd8ccc53f2">fInNonintAnim</a> = FALSE;
<a name="l00558"></a>00558 
<a name="l00559"></a>00559           <span class="comment">// ATE: if it's the begin cower animation, unset ui, cause it could</span>
<a name="l00560"></a>00560           <span class="comment">// be from player changin stance</span>
<a name="l00561"></a>00561           <span class="keywordflow">if</span> ( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#1f73b62a5ea0dd26fa1bec1d9f522b41">usAnimState</a> == <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2eb0394608956ac491cee3d2a9043a965ac">START_COWER</a> )
<a name="l00562"></a>00562           {
<a name="l00563"></a>00563             <a class="code" href="Handle_01UI_8cpp.html#3ca9f7e43b153367710a1bee6c71d7bc">UnSetUIBusy</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#18aef170576da81b10d00e7b6cd3627b">ubID</a> );
<a name="l00564"></a>00564           }
<a name="l00565"></a>00565                               <span class="keywordflow">break</span>;
<a name="l00566"></a>00566 
<a name="l00567"></a>00567                         <span class="keywordflow">case</span> 443:
<a name="l00568"></a>00568 
<a name="l00569"></a>00569                               <span class="comment">// MOVE GUY FORWARD FOR FENCE HOP ANIMATION</span>
<a name="l00570"></a>00570                               <span class="keywordflow">switch</span>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#8aa6174a253c3fa21a3ec41ce0174340">bDirection</a> )
<a name="l00571"></a>00571                               {
<a name="l00572"></a>00572                                     <span class="keywordflow">case</span> <a class="code" href="Overhead_01Types_8h.html#df5bf54a26a76adf253f57d88ade82b78ef5c0bce69283a9986011a63eea8a6b">SOUTH</a>:
<a name="l00573"></a>00573                                     <span class="keywordflow">case</span> <a class="code" href="Overhead_01Types_8h.html#df5bf54a26a76adf253f57d88ade82b7b5b3793b961949c817c7c0d99c05dad7">EAST</a>:
<a name="l00574"></a>00574 
<a name="l00575"></a>00575                                           <a class="code" href="Soldier_01Control_8cpp.html#905e2d828289ad582cafe7449e14b015">MoveMercFacingDirection</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>, FALSE, (<a class="code" href="Types_8h.html#8d06b04c04132c6f7c0fcb08c6167455">FLOAT</a>)<a class="code" href="Soldier_01Ani_8cpp.html#97c457fb2177f960d661206c05a35e07">gHopFenceForwardSEDist</a>[ <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#b082364eed3d7883662f69e1fd96be1a">ubBodyType</a> ] );
<a name="l00576"></a>00576                                           <span class="keywordflow">break</span>;
<a name="l00577"></a>00577 
<a name="l00578"></a>00578                                     <span class="keywordflow">case</span> <a class="code" href="Overhead_01Types_8h.html#df5bf54a26a76adf253f57d88ade82b7d0611de6f28d4a9c9eac959f5344698e">NORTH</a>:
<a name="l00579"></a>00579                                     <span class="keywordflow">case</span> <a class="code" href="Overhead_01Types_8h.html#df5bf54a26a76adf253f57d88ade82b7e9449e8683a8199dad36b07a63b2f523">WEST</a>:
<a name="l00580"></a>00580                                           <a class="code" href="Soldier_01Control_8cpp.html#905e2d828289ad582cafe7449e14b015">MoveMercFacingDirection</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>, FALSE, (<a class="code" href="Types_8h.html#8d06b04c04132c6f7c0fcb08c6167455">FLOAT</a>)<a class="code" href="Soldier_01Ani_8cpp.html#d3468dc33a8b9c021bbcb3c3c88bc8bd">gHopFenceForwardNWDist</a>[ <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#b082364eed3d7883662f69e1fd96be1a">ubBodyType</a> ] );
<a name="l00581"></a>00581                                           <span class="keywordflow">break</span>;
<a name="l00582"></a>00582                               }
<a name="l00583"></a>00583                               <span class="keywordflow">break</span>;
<a name="l00584"></a>00584 
<a name="l00585"></a>00585                         <span class="keywordflow">case</span> 444:
<a name="l00586"></a>00586 
<a name="l00587"></a>00587                               <span class="comment">// CODE: End Hop Fence</span>
<a name="l00588"></a>00588                               <span class="comment">// MOVE TO FORCASTED GRIDNO</span>
<a name="l00589"></a>00589                               sX = <a class="code" href="Isometric_01Utils_8cpp.html#e0e10363746997c2159f4f0b2c002d87">CenterX</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#ed4cc8266a7c56a2b5a07aa9ae90052d">sForcastGridno</a> );
<a name="l00590"></a>00590                               sY = <a class="code" href="Isometric_01Utils_8cpp.html#e7722f80f6c715e5fa8e79926c940d73">CenterY</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#ed4cc8266a7c56a2b5a07aa9ae90052d">sForcastGridno</a> );
<a name="l00591"></a>00591 
<a name="l00592"></a>00592                               <a class="code" href="Soldier_01Control_8cpp.html#7842818e583cf827a823370df00a762c">EVENT_InternalSetSoldierPosition</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>, (<a class="code" href="Types_8h.html#8d06b04c04132c6f7c0fcb08c6167455">FLOAT</a>) sX, (<a class="code" href="Types_8h.html#8d06b04c04132c6f7c0fcb08c6167455">FLOAT</a>) sY, FALSE, FALSE, FALSE );
<a name="l00593"></a>00593                               <a class="code" href="Soldier_01Control_8cpp.html#1117087649d17ca4dfc078c0947e7f09">EVENT_SetSoldierDirection</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>,  <a class="code" href="Isometric_01Utils_8cpp.html#bc913eacd8c5a5d945f0e7e21d648e1b">gTwoCDirection</a>[ <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#8aa6174a253c3fa21a3ec41ce0174340">bDirection</a> ] );
<a name="l00594"></a>00594                               <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#38beaf9cf30f3ceee9d0ce190ea80b36">sZLevelOverride</a> = -1;
<a name="l00595"></a>00595                               <a class="code" href="Soldier_01Control_8cpp.html#019f893295bb96f48261ded184a17cab">EVENT_SetSoldierDesiredDirection</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>, <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#8aa6174a253c3fa21a3ec41ce0174340">bDirection</a> );
<a name="l00596"></a>00596 
<a name="l00597"></a>00597 
<a name="l00598"></a>00598                               <span class="keywordflow">if</span> ( <a class="code" href="Overhead_8cpp.html#46bd754f8875c305ab18731ed10e3364">gTacticalStatus</a>.<a class="code" href="structTacticalStatusType.html#32021b7251048d8c62ea0c2e26b7a021">bBoxingState</a> == <a class="code" href="Overhead_01Types_8h.html#60ed5bd8e4835b98d48cf7afb819b4e519520855e41c6760acce4e85b5d2080c">BOXING_WAITING_FOR_PLAYER</a> || <a class="code" href="Overhead_8cpp.html#46bd754f8875c305ab18731ed10e3364">gTacticalStatus</a>.<a class="code" href="structTacticalStatusType.html#32021b7251048d8c62ea0c2e26b7a021">bBoxingState</a> == <a class="code" href="Overhead_01Types_8h.html#60ed5bd8e4835b98d48cf7afb819b4e55fac2cdafaeb730644fb13980a1fa22c">PRE_BOXING</a> || <a class="code" href="Overhead_8cpp.html#46bd754f8875c305ab18731ed10e3364">gTacticalStatus</a>.<a class="code" href="structTacticalStatusType.html#32021b7251048d8c62ea0c2e26b7a021">bBoxingState</a> == <a class="code" href="Overhead_01Types_8h.html#60ed5bd8e4835b98d48cf7afb819b4e57afcbf140adcf1ab9068be7ec414b3b1">BOXING</a> )
<a name="l00599"></a>00599                               {
<a name="l00600"></a>00600                                     <a class="code" href="Boxing_8cpp.html#fd1b6fb5d98a148909e6505903f49462">BoxingMovementCheck</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a> );
<a name="l00601"></a>00601                               }
<a name="l00602"></a>00602 
<a name="l00603"></a>00603                               <span class="keywordflow">if</span> ( <a class="code" href="Explosion_01Control_8cpp.html#38bdad72f3eb31bbccf55bc55205497c">SetOffBombsInGridNo</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#18aef170576da81b10d00e7b6cd3627b">ubID</a>, <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#2ab66ee0f37902cd448f4a738df4f2bf">sGridNo</a>, FALSE, <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#0d1f73c5d0ac839ec84a4792505949cb">bLevel</a> ))
<a name="l00604"></a>00604                               {
<a name="l00605"></a>00605                                     <a class="code" href="Soldier_01Control_8cpp.html#e90db6b8cf63e148848cf9fe9bbe56cf">EVENT_StopMerc</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>, <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#2ab66ee0f37902cd448f4a738df4f2bf">sGridNo</a>, <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#8aa6174a253c3fa21a3ec41ce0174340">bDirection</a> );
<a name="l00606"></a>00606                                     <span class="keywordflow">return</span>( TRUE );   
<a name="l00607"></a>00607                               }
<a name="l00608"></a>00608 
<a name="l00609"></a>00609                               <span class="comment">// If we are at our final destination, goto stance of our movement stance...</span>
<a name="l00610"></a>00610                               <span class="comment">// Only in realtime...</span>
<a name="l00611"></a>00611                               <span class="comment">//if ( !( gTacticalStatus.uiFlags &amp; INCOMBAT ) )</span>
<a name="l00612"></a>00612                               <span class="comment">// This has to be here to make guys continue along fence path</span>
<a name="l00613"></a>00613                               <span class="keywordflow">if</span> ( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#2ab66ee0f37902cd448f4a738df4f2bf">sGridNo</a> == <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#13569e868936f0aabb70ab73640be218">sFinalDestination</a> )
<a name="l00614"></a>00614                               {
<a name="l00615"></a>00615                                     <span class="keywordflow">if</span> ( <a class="code" href="Animation_01Control_8cpp.html#633440a87c34a25c700ce620db87d036">gAnimControl</a>[ <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#1f73b62a5ea0dd26fa1bec1d9f522b41">usAnimState</a> ].ubEndHeight != <a class="code" href="Animation_01Control_8cpp.html#633440a87c34a25c700ce620db87d036">gAnimControl</a>[ <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#28f15074956f36e3933f6cc10647eacf">usUIMovementMode</a> ].ubEndHeight )
<a name="l00616"></a>00616                                     {
<a name="l00617"></a>00617                                           <span class="comment">// Goto Stance...</span>
<a name="l00618"></a>00618                                           <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#c08e13a2118c98e4b8b72117e7dac653">fDontChargeAPsForStanceChange</a> = TRUE;
<a name="l00619"></a>00619                                           <a class="code" href="Soldier_01Control_8cpp.html#399090c009d2c65d23138520beb3382c">ChangeSoldierStance</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>, <a class="code" href="Animation_01Control_8cpp.html#633440a87c34a25c700ce620db87d036">gAnimControl</a>[ <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#28f15074956f36e3933f6cc10647eacf">usUIMovementMode</a> ].ubEndHeight );
<a name="l00620"></a>00620                                           <span class="keywordflow">return</span>( TRUE );
<a name="l00621"></a>00621                                     }
<a name="l00622"></a>00622                                     <span class="keywordflow">else</span>
<a name="l00623"></a>00623                                     {
<a name="l00624"></a>00624                                           <a class="code" href="Soldier_01Control_8cpp.html#abb661aaf102cd9417e7e4991838e63a">SoldierGotoStationaryStance</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a> );
<a name="l00625"></a>00625 
<a name="l00626"></a>00626                                           <span class="comment">// Set UI Busy</span>
<a name="l00627"></a>00627                                           <a class="code" href="Handle_01UI_8cpp.html#3ca9f7e43b153367710a1bee6c71d7bc">UnSetUIBusy</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#18aef170576da81b10d00e7b6cd3627b">ubID</a> );
<a name="l00628"></a>00628                                           <span class="keywordflow">return</span>( TRUE );
<a name="l00629"></a>00629                                     }
<a name="l00630"></a>00630                               }
<a name="l00631"></a>00631                               <span class="keywordflow">break</span>;
<a name="l00632"></a>00632 
<a name="l00633"></a>00633                         <span class="keywordflow">case</span> 445:
<a name="l00634"></a>00634 
<a name="l00635"></a>00635                               <span class="comment">// CODE: MOVE GUY FORWARD ONE TILE, BASED ON WHERE WE ARE FACING</span>
<a name="l00636"></a>00636                               <span class="keywordflow">switch</span>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#8aa6174a253c3fa21a3ec41ce0174340">bDirection</a> )
<a name="l00637"></a>00637                               {
<a name="l00638"></a>00638                                     <span class="keywordflow">case</span> <a class="code" href="Overhead_01Types_8h.html#df5bf54a26a76adf253f57d88ade82b78ef5c0bce69283a9986011a63eea8a6b">SOUTH</a>:
<a name="l00639"></a>00639                                     <span class="keywordflow">case</span> <a class="code" href="Overhead_01Types_8h.html#df5bf54a26a76adf253f57d88ade82b7b5b3793b961949c817c7c0d99c05dad7">EAST</a>:
<a name="l00640"></a>00640 
<a name="l00641"></a>00641                                           <a class="code" href="Soldier_01Control_8cpp.html#905e2d828289ad582cafe7449e14b015">MoveMercFacingDirection</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>, FALSE, (<a class="code" href="Types_8h.html#8d06b04c04132c6f7c0fcb08c6167455">FLOAT</a>)<a class="code" href="Soldier_01Ani_8cpp.html#eb6fa38c41a3ae7799edeaa5fbb9a922">gHopFenceForwardFullSEDist</a>[ <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#b082364eed3d7883662f69e1fd96be1a">ubBodyType</a> ] );
<a name="l00642"></a>00642                                           <span class="keywordflow">break</span>;
<a name="l00643"></a>00643 
<a name="l00644"></a>00644                                     <span class="keywordflow">case</span> <a class="code" href="Overhead_01Types_8h.html#df5bf54a26a76adf253f57d88ade82b7d0611de6f28d4a9c9eac959f5344698e">NORTH</a>:
<a name="l00645"></a>00645                                     <span class="keywordflow">case</span> <a class="code" href="Overhead_01Types_8h.html#df5bf54a26a76adf253f57d88ade82b7e9449e8683a8199dad36b07a63b2f523">WEST</a>:
<a name="l00646"></a>00646 
<a name="l00647"></a>00647                                           <a class="code" href="Soldier_01Control_8cpp.html#905e2d828289ad582cafe7449e14b015">MoveMercFacingDirection</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>, FALSE, (<a class="code" href="Types_8h.html#8d06b04c04132c6f7c0fcb08c6167455">FLOAT</a>)<a class="code" href="Soldier_01Ani_8cpp.html#ecba8e98753416ef32d9f2c80a5a5275">gHopFenceForwardFullNWDist</a>[ <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#b082364eed3d7883662f69e1fd96be1a">ubBodyType</a> ] );
<a name="l00648"></a>00648                                           <span class="keywordflow">break</span>;
<a name="l00649"></a>00649 
<a name="l00650"></a>00650                               }
<a name="l00651"></a>00651                               <span class="keywordflow">break</span>;
<a name="l00652"></a>00652 
<a name="l00653"></a>00653                         <span class="keywordflow">case</span> 446:
<a name="l00654"></a>00654 
<a name="l00655"></a>00655                               <span class="comment">// CODE: Turn pause move flag on</span>
<a name="l00656"></a>00656                               <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#eb633099940bc20ff5a969bce84eab42">uiStatusFlags</a> |= SOLDIER_PAUSEANIMOVE;
<a name="l00657"></a>00657                               <span class="keywordflow">break</span>;
<a name="l00658"></a>00658 
<a name="l00659"></a>00659                         <span class="keywordflow">case</span> 447:
<a name="l00660"></a>00660 
<a name="l00661"></a>00661                               <span class="comment">// TRY TO FALL!!!</span>
<a name="l00662"></a>00662                               <span class="keywordflow">if</span> ( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a> -&gt;fTryingToFall )
<a name="l00663"></a>00663                               {                 
<a name="l00664"></a>00664                                     <a class="code" href="Types_8h.html#30f500129d8c688af07726d5d34ce52d">INT16</a> sLastAniFrame;
<a name="l00665"></a>00665 
<a name="l00666"></a>00666                                     <span class="comment">// TRY FORWARDS...</span>
<a name="l00667"></a>00667                                     <span class="comment">// FIRST GRIDNO</span>
<a name="l00668"></a>00668                                     sNewGridNo = <a class="code" href="Isometric_01Utils_8cpp.html#318d8410127e29bb232ab70363bc316e">NewGridNo</a>( (<a class="code" href="Types_8h.html#09f1a1fb2293e33483cc8d44aefb1eb1">UINT16</a>)<a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#2ab66ee0f37902cd448f4a738df4f2bf">sGridNo</a>, (<a class="code" href="Types_8h.html#09f1a1fb2293e33483cc8d44aefb1eb1">UINT16</a>)( <a class="code" href="Isometric_01Utils_8cpp.html#a4a3adf599f99864b1de33673888fd5e">DirectionInc</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#8aa6174a253c3fa21a3ec41ce0174340">bDirection</a> ) ) );
<a name="l00669"></a>00669 
<a name="l00670"></a>00670                                     <span class="keywordflow">if</span> ( <a class="code" href="Soldier_01Ani_8cpp.html#52dee080c40e99d978e145a7fd2f3a67">OKFallDirection</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>, sNewGridNo, <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#0d1f73c5d0ac839ec84a4792505949cb">bLevel</a>, <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#8aa6174a253c3fa21a3ec41ce0174340">bDirection</a>, <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2ebe2cf9cbcbd28b520fb1ac63924b8ab2c">FALLFORWARD_HITDEATH_STOP</a> ) )
<a name="l00671"></a>00671                                     {
<a name="l00672"></a>00672                                           <span class="comment">// SECOND GRIDNO</span>
<a name="l00673"></a>00673                                           <span class="comment">// sNewGridNo = NewGridNo( (UINT16)sNewGridNo, (UINT16)( DirectionInc( pSoldier-&gt;bDirection ) ) );</span>
<a name="l00674"></a>00674 
<a name="l00675"></a>00675                                           <span class="comment">// if ( OKFallDirection( pSoldier, sNewGridNo, pSoldier-&gt;bLevel, pSoldier-&gt;bDirection, FALLFORWARD_HITDEATH_STOP ) )</span>
<a name="l00676"></a>00676                                           {
<a name="l00677"></a>00677                                                 <span class="comment">// ALL'S OK HERE...</span>
<a name="l00678"></a>00678                                                 <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#3797096c7a8b826fe2721c3931752055">fTryingToFall</a> = FALSE;
<a name="l00679"></a>00679                                                 <span class="keywordflow">break</span>;
<a name="l00680"></a>00680                                           }
<a name="l00681"></a>00681                                     }
<a name="l00682"></a>00682 
<a name="l00683"></a>00683 
<a name="l00684"></a>00684                                     <span class="comment">// IF HERE, INCREMENT DIRECTION</span>
<a name="l00685"></a>00685             <span class="comment">// ATE: Added Feb1 - can be either direction....</span>
<a name="l00686"></a>00686             <span class="keywordflow">if</span> ( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#9bcb43ee9060c160a738c6f98c57e358">fFallClockwise</a> )
<a name="l00687"></a>00687             {
<a name="l00688"></a>00688                                       <a class="code" href="Soldier_01Control_8cpp.html#1117087649d17ca4dfc078c0947e7f09">EVENT_SetSoldierDirection</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>,  <a class="code" href="Isometric_01Utils_8cpp.html#9eb8f6ae368802136cc76853785f4427">gOneCDirection</a>[ <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#8aa6174a253c3fa21a3ec41ce0174340">bDirection</a> ] );
<a name="l00689"></a>00689             }
<a name="l00690"></a>00690             <span class="keywordflow">else</span>
<a name="l00691"></a>00691             {
<a name="l00692"></a>00692                                       <a class="code" href="Soldier_01Control_8cpp.html#1117087649d17ca4dfc078c0947e7f09">EVENT_SetSoldierDirection</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>,  <a class="code" href="Isometric_01Utils_8cpp.html#0d4cbf37dd55fdc31594389f4ea65909">gOneCCDirection</a>[ <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#8aa6174a253c3fa21a3ec41ce0174340">bDirection</a> ] );
<a name="l00693"></a>00693             }
<a name="l00694"></a>00694                                     <a class="code" href="Soldier_01Control_8cpp.html#019f893295bb96f48261ded184a17cab">EVENT_SetSoldierDesiredDirection</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>, <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#8aa6174a253c3fa21a3ec41ce0174340">bDirection</a> );
<a name="l00695"></a>00695                                     sLastAniFrame = <a class="code" href="Animation_01Control_8cpp.html#7ff964ad77f7f28f8f481f3e0d91b636">gusAnimInst</a>[ <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#1f73b62a5ea0dd26fa1bec1d9f522b41">usAnimState</a> ][ ( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#d1221226402ff4b54671e0142ec90cd6">usAniCode</a> - 2 ) ];
<a name="l00696"></a>00696                                     <a class="code" href="Soldier_01Control_8cpp.html#43134a623e66c2b217f219666278fba0">ConvertAniCodeToAniFrame</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>, (<a class="code" href="Types_8h.html#30f500129d8c688af07726d5d34ce52d">INT16</a>)( sLastAniFrame ) );
<a name="l00697"></a>00697 
<a name="l00698"></a>00698                                     <span class="keywordflow">if</span> ( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#8aa6174a253c3fa21a3ec41ce0174340">bDirection</a> == <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#8a8e35636a760a2ea61592dd8aad6047">bStartFallDir</a> )
<a name="l00699"></a>00699                                     {
<a name="l00700"></a>00700                                           <span class="comment">// GO FORWARD HERE...</span>
<a name="l00701"></a>00701                                           <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a> -&gt;<a class="code" href="structSOLDIERTYPE.html#3797096c7a8b826fe2721c3931752055">fTryingToFall</a> = FALSE;
<a name="l00702"></a>00702                                           <span class="keywordflow">break</span>;;
<a name="l00703"></a>00703                                     }
<a name="l00704"></a>00704                                     <span class="comment">// IF HERE, RETURN SO WE DONOT INCREMENT DIR</span>
<a name="l00705"></a>00705                                     <span class="keywordflow">return</span>( TRUE );
<a name="l00706"></a>00706                               }
<a name="l00707"></a>00707                               <span class="keywordflow">break</span>;
<a name="l00708"></a>00708 
<a name="l00709"></a>00709                         
<a name="l00710"></a>00710                         <span class="keywordflow">case</span> 448:
<a name="l00711"></a>00711 
<a name="l00712"></a>00712                               <span class="comment">// CODE: HANDLE BURST</span>
<a name="l00713"></a>00713                               <span class="comment">// FIRST CHECK IF WE'VE REACHED MAX FOR GUN</span>
<a name="l00714"></a>00714                               fStop = FALSE;
<a name="l00715"></a>00715 
<a name="l00716"></a>00716                               <span class="keywordflow">if</span> ( ( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#363d85a2e4c2405db5046904d1d4549d">bWeaponMode</a> == <a class="code" href="Soldier_01Control_8h.html#db461b7936f2fc5849c8168828b69c4c7c71652644f3b7aff3b71a0626c0c133">WM_ATTACHED_GL_BURST</a> &amp;&amp; <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#dd307dffd553de4a1e01f74c050e6e07">bDoBurst</a> &gt; <a class="code" href="Weapons_8cpp.html#fac72e30bc7c36f55257eac0542ce51d">Weapon</a>[<a class="code" href="Items_8cpp.html#7cb1bfb4454c9fec31dc641a715f6756">GetAttachedGrenadeLauncher</a>(&amp;<a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#13c875b952b6d634680165d127a9870b">inv</a>[HANDPOS])].ubShotsPerBurst) || (<a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#363d85a2e4c2405db5046904d1d4549d">bWeaponMode</a> != <a class="code" href="Soldier_01Control_8h.html#db461b7936f2fc5849c8168828b69c4c7c71652644f3b7aff3b71a0626c0c133">WM_ATTACHED_GL_BURST</a> &amp;&amp; <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#dd307dffd553de4a1e01f74c050e6e07">bDoBurst</a> &gt; ((<a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#b77b23ae10e38a30c4a586d26882545b">bDoAutofire</a>)?(<a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#b77b23ae10e38a30c4a586d26882545b">bDoAutofire</a>):(<a class="code" href="Weapons_8cpp.html#0887bcd1ec2ba854bbfc4dce4cb00b33">GetShotsPerBurst</a>(&amp;<a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#13c875b952b6d634680165d127a9870b">inv</a>[HANDPOS])))) )
<a name="l00717"></a>00717                               {
<a name="l00718"></a>00718                                     DebugMsg(<a class="code" href="DEBUG_8cpp.html#a7985c2fd033797fc67a03b2c26e07c6">TOPIC_JA2</a>,DBG_LEVEL_3,<span class="stringliteral">"AdjustToNextAnimationFrame: Burst case 448, stopping because burst size too large"</span>);
<a name="l00719"></a>00719                                     fStop = TRUE;
<a name="l00720"></a>00720                                     fFreeUpAttacker = TRUE;
<a name="l00721"></a>00721                               }
<a name="l00722"></a>00722 
<a name="l00723"></a>00723                               <span class="comment">// CHECK IF WE HAVE AMMO LEFT, IF NOT, END ANIMATION!</span>
<a name="l00724"></a>00724                               <span class="keywordflow">if</span> ( !<a class="code" href="Points_8cpp.html#79e23528fb3285ccdcfd217080729048">EnoughAmmo</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>, FALSE, <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#99a689d831418a5e3ed638a34761514e">ubAttackingHand</a> ) )
<a name="l00725"></a>00725                               {
<a name="l00726"></a>00726                                     DebugMsg(<a class="code" href="DEBUG_8cpp.html#a7985c2fd033797fc67a03b2c26e07c6">TOPIC_JA2</a>,DBG_LEVEL_3,<span class="stringliteral">"AdjustToNextAnimationFrame: Burst case 448, stopping because not enough ammo"</span>);
<a name="l00727"></a>00727                                     fStop = TRUE;
<a name="l00728"></a>00728                                     fFreeUpAttacker = TRUE;
<a name="l00729"></a>00729                                     <span class="keywordflow">if</span> ( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#74a40a8aaf3efe840cdaf6be62556d82">bTeam</a> == <a class="code" href="Campaign_8cpp.html#47b2067ff75193e24776eda5297400ff">gbPlayerNum</a>  )
<a name="l00730"></a>00730                                     {
<a name="l00731"></a>00731                                           <a class="code" href="message_8cpp.html#818e47bc59bd5a5755f06ec51cd74928">ScreenMsg</a>( FONT_MCOLOR_LTYELLOW, MSG_INTERFACE, <a class="code" href="__DutchText_8cpp.html#f69c72cc23fedc3149347ccb542af8f8">TacticalStr</a>[ <a class="code" href="Text_8h.html#d11a20102b8fc2e6eef5e2ce9afdfbe7d246791e410e34af632069bc4000f96f">BURST_FIRE_DEPLETED_CLIP_STR</a> ] );
<a name="l00732"></a>00732                                     }
<a name="l00733"></a>00733                               }
<a name="l00734"></a>00734                               <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#dd307dffd553de4a1e01f74c050e6e07">bDoBurst</a> == 1)
<a name="l00735"></a>00735                               {
<a name="l00736"></a>00736                                     <span class="comment">// CHECK FOR GUN JAM</span>
<a name="l00737"></a>00737                                     bWeaponJammed = <a class="code" href="Weapons_8cpp.html#f52f68addd0313cf9206ccfda5ed4605">CheckForGunJam</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a> );
<a name="l00738"></a>00738                                     <span class="keywordflow">if</span> ( bWeaponJammed == TRUE )
<a name="l00739"></a>00739                                     {
<a name="l00740"></a>00740                                           DebugMsg(<a class="code" href="DEBUG_8cpp.html#a7985c2fd033797fc67a03b2c26e07c6">TOPIC_JA2</a>,DBG_LEVEL_3,<span class="stringliteral">"AdjustToNextAnimationFrame: Burst case 448, stopping because weapon jammed"</span>);
<a name="l00741"></a>00741                                           fStop = TRUE;
<a name="l00742"></a>00742                                           fFreeUpAttacker = TRUE;
<a name="l00743"></a>00743                                           <span class="comment">// stop shooting!</span>
<a name="l00744"></a>00744                                           <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#51424f18568b9ec62dcec930be427e75">bBulletsLeft</a> = 0;
<a name="l00745"></a>00745 
<a name="l00746"></a>00746                                           <span class="comment">// OK, Stop burst sound...</span>
<a name="l00747"></a>00747                                           <span class="keywordflow">if</span> ( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#de22256ffc6891f71eb0a899a91d6d76">iBurstSoundID</a> != NO_SAMPLE )
<a name="l00748"></a>00748                                           {
<a name="l00749"></a>00749                                                 <a class="code" href="soundman_8cpp.html#1f4f0a38d595958766a96b9f2d55517f">SoundStop</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#de22256ffc6891f71eb0a899a91d6d76">iBurstSoundID</a> );
<a name="l00750"></a>00750                                           }
<a name="l00751"></a>00751 
<a name="l00752"></a>00752                                           <span class="keywordflow">if</span> ( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#74a40a8aaf3efe840cdaf6be62556d82">bTeam</a> == <a class="code" href="Campaign_8cpp.html#47b2067ff75193e24776eda5297400ff">gbPlayerNum</a>  )
<a name="l00753"></a>00753                                           {
<a name="l00754"></a>00754                                                 <a class="code" href="Sound_01Control_8cpp.html#6b140a8e4fcf89b7740c037ff12580a7">PlayJA2Sample</a>( <a class="code" href="Sound_01Control_8h.html#946995a6d03371486c23b23d9ca362b5bb9bd7e071616d3004c6c2da21a340ec">S_DRYFIRE1</a>, RATE_11025, <a class="code" href="Sound_01Control_8cpp.html#f62b2a668c2e25997578956c425723c4">SoundVolume</a>( MIDVOLUME, <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#2ab66ee0f37902cd448f4a738df4f2bf">sGridNo</a> ), 1, <a class="code" href="Sound_01Control_8cpp.html#a258fd693b7e800828705055bf357c8d">SoundDir</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#2ab66ee0f37902cd448f4a738df4f2bf">sGridNo</a> ) );             
<a name="l00755"></a>00755                                                 <span class="comment">//ScreenMsg( FONT_MCOLOR_LTYELLOW, MSG_INTERFACE, L"Gun jammed!" );</span>
<a name="l00756"></a>00756                                           }
<a name="l00757"></a>00757 
<a name="l00758"></a>00758                                           DebugMsg( TOPIC_JA2, DBG_LEVEL_3, <a class="code" href="DEBUG_8cpp.html#88565bf27eec0b2003eb5bc9426b8e4b">String</a>(<span class="stringliteral">"@@@@@@@ Freeing up attacker - aborting start of attack due to burst gun jam"</span>) );
<a name="l00759"></a>00759                                           <a class="code" href="Overhead_8cpp.html#1e4783fce030a18ff553667016753e20">FreeUpAttacker</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#18aef170576da81b10d00e7b6cd3627b">ubID</a> );         
<a name="l00760"></a>00760                                     }
<a name="l00761"></a>00761                                     <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( bWeaponJammed == 255 )
<a name="l00762"></a>00762                                     {
<a name="l00763"></a>00763                                           <span class="comment">// Play intermediate animation...</span>
<a name="l00764"></a>00764                                           <span class="keywordflow">if</span> ( <a class="code" href="Soldier_01Ani_8cpp.html#b347fd92f91cd16381f0163a2da1e293">HandleUnjamAnimation</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a> ) )
<a name="l00765"></a>00765                                           {
<a name="l00766"></a>00766                                                 <span class="keywordflow">return</span>( TRUE );
<a name="l00767"></a>00767                                           }
<a name="l00768"></a>00768                                     }
<a name="l00769"></a>00769                               }
<a name="l00770"></a>00770 
<a name="l00771"></a>00771                               <span class="keywordflow">if</span> ( fStop )
<a name="l00772"></a>00772                               {
<a name="l00773"></a>00773                                     <span class="keywordflow">if</span>(<a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#b77b23ae10e38a30c4a586d26882545b">bDoAutofire</a>) <span class="comment">//reset the autofire cursor after firing</span>
<a name="l00774"></a>00774                                     {
<a name="l00775"></a>00775                                           <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#55af4b82964deaf514bd6e99bc71fbcf">autofireLastStep</a> = FALSE;
<a name="l00776"></a>00776                                           <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#b77b23ae10e38a30c4a586d26882545b">bDoAutofire</a> = 1;
<a name="l00777"></a>00777                                     }
<a name="l00778"></a>00778 
<a name="l00779"></a>00779                                     <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#714dea2b644824d24476fa0f947ca452">fDoSpread</a> = FALSE;
<a name="l00780"></a>00780                                     <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#dd307dffd553de4a1e01f74c050e6e07">bDoBurst</a> = 1;
<a name="l00781"></a>00781 <span class="comment">//                                  pSoldier-&gt;fBurstCompleted = TRUE;</span>
<a name="l00782"></a>00782                                     <span class="keywordflow">if</span> ( fFreeUpAttacker )
<a name="l00783"></a>00783                                     {
<a name="l00784"></a>00784 <span class="comment">//                                        DebugMsg( TOPIC_JA2, DBG_LEVEL_3, String("@@@@@@@ Freeing up attacker - aborting start of attack") );</span>
<a name="l00785"></a>00785 <span class="comment">//                                        FreeUpAttacker( pSoldier-&gt;ubID );         </span>
<a name="l00786"></a>00786                                     }
<a name="l00787"></a>00787 
<a name="l00788"></a>00788                                     <span class="comment">// ATE; Reduce it due to animation being stopped...</span>
<a name="l00789"></a>00789                                     DebugMsg( <a class="code" href="DEBUG_8cpp.html#a7985c2fd033797fc67a03b2c26e07c6">TOPIC_JA2</a>, DBG_LEVEL_3, <a class="code" href="DEBUG_8cpp.html#88565bf27eec0b2003eb5bc9426b8e4b">String</a>(<span class="stringliteral">"@@@@@@@ Freeing up attacker - Burst animation ended"</span>) );
<a name="l00790"></a>00790                                     <a class="code" href="Overhead_8cpp.html#de6952977d9c0a18bd743e5c7dc226ba">ReduceAttackBusyCount</a>( (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>) <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#18aef170576da81b10d00e7b6cd3627b">ubID</a>, FALSE );
<a name="l00791"></a>00791 
<a name="l00792"></a>00792 
<a name="l00793"></a>00793                                     <span class="keywordflow">if</span> ( <a class="code" href="Soldier_01Ani_8cpp.html#4a1f4a44abd2dd1e17348edff0830048">CheckForImproperFireGunEnd</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a> ) )
<a name="l00794"></a>00794                                     {
<a name="l00795"></a>00795                                           <span class="keywordflow">return</span>( TRUE );
<a name="l00796"></a>00796                                     }
<a name="l00797"></a>00797 
<a name="l00798"></a>00798                                     <span class="comment">// END: GOTO AIM STANCE BASED ON HEIGHT</span>
<a name="l00799"></a>00799                                     <span class="comment">// If we are a robot - we need to do stuff different here</span>
<a name="l00800"></a>00800                                     <span class="keywordflow">if</span> ( AM_A_ROBOT( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a> ) )
<a name="l00801"></a>00801                                     {
<a name="l00802"></a>00802                                           <a class="code" href="Soldier_01Control_8cpp.html#6f191e00fb4f3c5e2cbe762aa402a420">ChangeSoldierState</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>, <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2eb61b6dd5eb66ef4c1c1c26ae5ed4cff43">STANDING</a>, 0 , FALSE );
<a name="l00803"></a>00803                                     }
<a name="l00804"></a>00804                                     <span class="keywordflow">else</span>
<a name="l00805"></a>00805                                     {
<a name="l00806"></a>00806                                           <span class="keywordflow">switch</span> ( <a class="code" href="Animation_01Control_8cpp.html#633440a87c34a25c700ce620db87d036">gAnimControl</a>[ <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#1f73b62a5ea0dd26fa1bec1d9f522b41">usAnimState</a> ].ubEndHeight )
<a name="l00807"></a>00807                                           {
<a name="l00808"></a>00808                                                 <span class="keywordflow">case</span> ANIM_STAND:
<a name="l00809"></a>00809                                                       <a class="code" href="Soldier_01Control_8cpp.html#6f191e00fb4f3c5e2cbe762aa402a420">ChangeSoldierState</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>, <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2ebb5404e42de7f81228bbd2627d82b0646">AIM_RIFLE_STAND</a>, 0 , FALSE );
<a name="l00810"></a>00810                                                       <span class="keywordflow">break</span>;
<a name="l00811"></a>00811 
<a name="l00812"></a>00812                                                 <span class="keywordflow">case</span> ANIM_PRONE:
<a name="l00813"></a>00813                                                       <a class="code" href="Soldier_01Control_8cpp.html#6f191e00fb4f3c5e2cbe762aa402a420">ChangeSoldierState</a>( pSoldier, <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2eb56be19b35dc16cd8516f08b3d08e9422">AIM_RIFLE_PRONE</a>, 0 , FALSE );
<a name="l00814"></a>00814                                                       <span class="keywordflow">break</span>;
<a name="l00815"></a>00815 
<a name="l00816"></a>00816                                                 <span class="keywordflow">case</span> ANIM_CROUCH:
<a name="l00817"></a>00817                                                       <a class="code" href="Soldier_01Control_8cpp.html#6f191e00fb4f3c5e2cbe762aa402a420">ChangeSoldierState</a>( pSoldier, <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2eb5fa1d6dcddea771c0856416938c98e19">AIM_RIFLE_CROUCH</a>, 0 , FALSE );
<a name="l00818"></a>00818                                                       <span class="keywordflow">break</span>;
<a name="l00819"></a>00819 
<a name="l00820"></a>00820                                           }
<a name="l00821"></a>00821                                     }
<a name="l00822"></a>00822                                     <span class="keywordflow">return</span>( TRUE );
<a name="l00823"></a>00823                               }
<a name="l00824"></a>00824 
<a name="l00825"></a>00825                               <span class="comment">// MOVETO CURRENT SPREAD LOCATION</span>
<a name="l00826"></a>00826                               <span class="keywordflow">if</span> ( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#714dea2b644824d24476fa0f947ca452">fDoSpread</a> )
<a name="l00827"></a>00827                               {
<a name="l00828"></a>00828                                     <span class="keywordflow">if</span> ( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#7bf1c54b630b9b5588f6189ca5628271">sSpreadLocations</a>[ <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#714dea2b644824d24476fa0f947ca452">fDoSpread</a> - 1 ] != 0 )
<a name="l00829"></a>00829                                     {
<a name="l00830"></a>00830                                           <a class="code" href="Soldier_01Control_8cpp.html#1117087649d17ca4dfc078c0947e7f09">EVENT_SetSoldierDirection</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>, (<a class="code" href="Types_8h.html#7ebe70ceca856797319175e30bcf003d">INT8</a>)<a class="code" href="Soldier_01Control_8cpp.html#bb5e5bb82e441d4a82d8d115ee1ce1ba">GetDirectionToGridNoFromGridNo</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#2ab66ee0f37902cd448f4a738df4f2bf">sGridNo</a>, <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#7bf1c54b630b9b5588f6189ca5628271">sSpreadLocations</a>[ <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#714dea2b644824d24476fa0f947ca452">fDoSpread</a> - 1 ] ) );
<a name="l00831"></a>00831                                           <a class="code" href="Soldier_01Control_8cpp.html#019f893295bb96f48261ded184a17cab">EVENT_SetSoldierDesiredDirection</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>, <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#8aa6174a253c3fa21a3ec41ce0174340">bDirection</a> );
<a name="l00832"></a>00832                                     }
<a name="l00833"></a>00833                               }
<a name="l00834"></a>00834                               <span class="keywordflow">break</span>;
<a name="l00835"></a>00835 
<a name="l00836"></a>00836                         <span class="keywordflow">case</span> 449:
<a name="l00837"></a>00837 
<a name="l00838"></a>00838                               <span class="comment">//CODE: FINISH BURST</span>
<a name="l00839"></a>00839                               <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#714dea2b644824d24476fa0f947ca452">fDoSpread</a> = FALSE;
<a name="l00840"></a>00840                               <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#dd307dffd553de4a1e01f74c050e6e07">bDoBurst</a> = 1;
<a name="l00841"></a>00841 <span class="comment">//                      pSoldier-&gt;fBurstCompleted = TRUE;</span>
<a name="l00842"></a>00842                               <span class="keywordflow">break</span>;
<a name="l00843"></a>00843 
<a name="l00844"></a>00844                         <span class="keywordflow">case</span> 450:
<a name="l00845"></a>00845 
<a name="l00846"></a>00846                               <span class="comment">//CODE: BEGINHOPFENCE</span>
<a name="l00847"></a>00847                               <span class="comment">// MOVE TWO FACGIN GRIDNOS</span>
<a name="l00848"></a>00848                               sNewGridNo = <a class="code" href="Isometric_01Utils_8cpp.html#318d8410127e29bb232ab70363bc316e">NewGridNo</a>( (<a class="code" href="Types_8h.html#09f1a1fb2293e33483cc8d44aefb1eb1">UINT16</a>)<a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#2ab66ee0f37902cd448f4a738df4f2bf">sGridNo</a>, (<a class="code" href="Types_8h.html#09f1a1fb2293e33483cc8d44aefb1eb1">UINT16</a>)( <a class="code" href="Isometric_01Utils_8cpp.html#a4a3adf599f99864b1de33673888fd5e">DirectionInc</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#8aa6174a253c3fa21a3ec41ce0174340">bDirection</a> ) ) );
<a name="l00849"></a>00849                               sNewGridNo = <a class="code" href="Isometric_01Utils_8cpp.html#318d8410127e29bb232ab70363bc316e">NewGridNo</a>( (<a class="code" href="Types_8h.html#09f1a1fb2293e33483cc8d44aefb1eb1">UINT16</a>)sNewGridNo, (<a class="code" href="Types_8h.html#09f1a1fb2293e33483cc8d44aefb1eb1">UINT16</a>)( <a class="code" href="Isometric_01Utils_8cpp.html#a4a3adf599f99864b1de33673888fd5e">DirectionInc</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#8aa6174a253c3fa21a3ec41ce0174340">bDirection</a> ) ) );
<a name="l00850"></a>00850                               <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#ed4cc8266a7c56a2b5a07aa9ae90052d">sForcastGridno</a> = sNewGridNo;
<a name="l00851"></a>00851                               <span class="keywordflow">break</span>;
<a name="l00852"></a>00852 
<a name="l00853"></a>00853 
<a name="l00854"></a>00854                         <span class="keywordflow">case</span> 451:
<a name="l00855"></a>00855 
<a name="l00856"></a>00856                               <span class="comment">// CODE: MANAGE START z-buffer override</span>
<a name="l00857"></a>00857                               <span class="keywordflow">switch</span>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#8aa6174a253c3fa21a3ec41ce0174340">bDirection</a> )
<a name="l00858"></a>00858                               {
<a name="l00859"></a>00859                                     <span class="keywordflow">case</span> <a class="code" href="Overhead_01Types_8h.html#df5bf54a26a76adf253f57d88ade82b7d0611de6f28d4a9c9eac959f5344698e">NORTH</a>:
<a name="l00860"></a>00860                                     <span class="keywordflow">case</span> <a class="code" href="Overhead_01Types_8h.html#df5bf54a26a76adf253f57d88ade82b7e9449e8683a8199dad36b07a63b2f523">WEST</a>:
<a name="l00861"></a>00861 
<a name="l00862"></a>00862                                           <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#38beaf9cf30f3ceee9d0ce190ea80b36">sZLevelOverride</a> = TOPMOST_Z_LEVEL;
<a name="l00863"></a>00863                                           <span class="keywordflow">break</span>;
<a name="l00864"></a>00864                               }
<a name="l00865"></a>00865                               <span class="keywordflow">break</span>;
<a name="l00866"></a>00866 
<a name="l00867"></a>00867                         <span class="keywordflow">case</span> 452:
<a name="l00868"></a>00868 
<a name="l00869"></a>00869                               <span class="comment">// CODE: MANAGE END z-buffer override</span>
<a name="l00870"></a>00870                               <span class="keywordflow">switch</span>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#8aa6174a253c3fa21a3ec41ce0174340">bDirection</a> )
<a name="l00871"></a>00871                               {
<a name="l00872"></a>00872                                     <span class="keywordflow">case</span> <a class="code" href="Overhead_01Types_8h.html#df5bf54a26a76adf253f57d88ade82b78ef5c0bce69283a9986011a63eea8a6b">SOUTH</a>:
<a name="l00873"></a>00873                                     <span class="keywordflow">case</span> <a class="code" href="Overhead_01Types_8h.html#df5bf54a26a76adf253f57d88ade82b7b5b3793b961949c817c7c0d99c05dad7">EAST</a>:
<a name="l00874"></a>00874 
<a name="l00875"></a>00875                                           <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#38beaf9cf30f3ceee9d0ce190ea80b36">sZLevelOverride</a> = TOPMOST_Z_LEVEL;
<a name="l00876"></a>00876                                           <span class="keywordflow">break</span>;
<a name="l00877"></a>00877 
<a name="l00878"></a>00878                                     <span class="keywordflow">case</span> <a class="code" href="Overhead_01Types_8h.html#df5bf54a26a76adf253f57d88ade82b7d0611de6f28d4a9c9eac959f5344698e">NORTH</a>:
<a name="l00879"></a>00879                                     <span class="keywordflow">case</span> <a class="code" href="Overhead_01Types_8h.html#df5bf54a26a76adf253f57d88ade82b7e9449e8683a8199dad36b07a63b2f523">WEST</a>:
<a name="l00880"></a>00880 
<a name="l00881"></a>00881                                           <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#38beaf9cf30f3ceee9d0ce190ea80b36">sZLevelOverride</a> = -1;
<a name="l00882"></a>00882                                           <span class="keywordflow">break</span>;
<a name="l00883"></a>00883 
<a name="l00884"></a>00884                               }
<a name="l00885"></a>00885                               <span class="keywordflow">break</span>;
<a name="l00886"></a>00886 
<a name="l00887"></a>00887                         <span class="keywordflow">case</span> 453:
<a name="l00888"></a>00888 
<a name="l00889"></a>00889                               <span class="comment">//CODE: FALLOFF ROOF ( BACKWARDS ) - MOVE BACK SOME!</span>
<a name="l00890"></a>00890                               <span class="comment">// Use same function as forward, but is -ve values!</span>
<a name="l00891"></a>00891                               <a class="code" href="Soldier_01Control_8cpp.html#905e2d828289ad582cafe7449e14b015">MoveMercFacingDirection</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a> , TRUE, (<a class="code" href="Types_8h.html#8d06b04c04132c6f7c0fcb08c6167455">FLOAT</a>)<a class="code" href="Soldier_01Ani_8cpp.html#b3029d724e57fdd93d816a501ef2ac36">gFalloffBackwardsDist</a>[ <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#b082364eed3d7883662f69e1fd96be1a">ubBodyType</a> ] );
<a name="l00892"></a>00892                               <span class="keywordflow">break</span>;
<a name="l00893"></a>00893 
<a name="l00894"></a>00894                         <span class="keywordflow">case</span> 454:
<a name="l00895"></a>00895 
<a name="l00896"></a>00896                               <span class="comment">// CODE: HANDLE CLIMBING ROOF,</span>
<a name="l00897"></a>00897                               <span class="comment">// Move merc up</span>
<a name="l00898"></a>00898                               <span class="keywordflow">if</span> ( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#8aa6174a253c3fa21a3ec41ce0174340">bDirection</a> == <a class="code" href="Overhead_01Types_8h.html#df5bf54a26a76adf253f57d88ade82b7d0611de6f28d4a9c9eac959f5344698e">NORTH</a> )
<a name="l00899"></a>00899                               {
<a name="l00900"></a>00900                                     <a class="code" href="Soldier_01Control_8cpp.html#85356885ab89da0e5fdb7a225f7db225">SetSoldierHeight</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>, (<a class="code" href="Types_8h.html#8d06b04c04132c6f7c0fcb08c6167455">FLOAT</a>)(pSoldier-&gt;dHeightAdjustment + <a class="code" href="Soldier_01Ani_8cpp.html#e768d781bdb574535f4d6242f51d9c59">gClimbUpRoofDist</a>[ pSoldier-&gt;ubBodyType ] ) );
<a name="l00901"></a>00901                               }
<a name="l00902"></a>00902                               <span class="keywordflow">else</span>
<a name="l00903"></a>00903                               {
<a name="l00904"></a>00904                                     <a class="code" href="Soldier_01Control_8cpp.html#85356885ab89da0e5fdb7a225f7db225">SetSoldierHeight</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>, (<a class="code" href="Types_8h.html#8d06b04c04132c6f7c0fcb08c6167455">FLOAT</a>)(<a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#c251e17a200789d043f3b0768b35eaaa">dHeightAdjustment</a> + <a class="code" href="Soldier_01Ani_8cpp.html#e768d781bdb574535f4d6242f51d9c59">gClimbUpRoofDist</a>[ <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#b082364eed3d7883662f69e1fd96be1a">ubBodyType</a> ] ) );
<a name="l00905"></a>00905                               }
<a name="l00906"></a>00906                               <span class="keywordflow">break</span>;
<a name="l00907"></a>00907 
<a name="l00908"></a>00908                         <span class="keywordflow">case</span> 455:
<a name="l00909"></a>00909 
<a name="l00910"></a>00910                               <span class="comment">// MOVE GUY FORWARD SOME VALUE</span>
<a name="l00911"></a>00911                               <a class="code" href="Soldier_01Control_8cpp.html#905e2d828289ad582cafe7449e14b015">MoveMercFacingDirection</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>, FALSE, (<a class="code" href="Types_8h.html#8d06b04c04132c6f7c0fcb08c6167455">FLOAT</a>)<a class="code" href="Soldier_01Ani_8cpp.html#fd65c5d09e89c52bc3e7b0aff43ae0f3">gClimbUpRoofLATDist</a>[ <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#b082364eed3d7883662f69e1fd96be1a">ubBodyType</a> ] );
<a name="l00912"></a>00912 
<a name="l00913"></a>00913                               <span class="comment">// MOVE DOWN SOME VALUE TOO!</span>
<a name="l00914"></a>00914                               <a class="code" href="Soldier_01Control_8cpp.html#85356885ab89da0e5fdb7a225f7db225">SetSoldierHeight</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>, (<a class="code" href="Types_8h.html#8d06b04c04132c6f7c0fcb08c6167455">FLOAT</a>)(<a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#c251e17a200789d043f3b0768b35eaaa">dHeightAdjustment</a> - <a class="code" href="Soldier_01Ani_8cpp.html#d096f8000b2d7f7371dda4ca4f7741bf">gClimbUpRoofDistGoingLower</a>[ <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#b082364eed3d7883662f69e1fd96be1a">ubBodyType</a> ] ) );
<a name="l00915"></a>00915 
<a name="l00916"></a>00916                               <span class="keywordflow">break</span>;
<a name="l00917"></a>00917 
<a name="l00918"></a>00918                         <span class="keywordflow">case</span> 456:
<a name="l00919"></a>00919 
<a name="l00920"></a>00920                               <span class="comment">// CODE: HANDLE CLIMBING ROOF,</span>
<a name="l00921"></a>00921                               <span class="comment">// Move merc DOWN</span>
<a name="l00922"></a>00922                               <span class="keywordflow">if</span> ( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#8aa6174a253c3fa21a3ec41ce0174340">bDirection</a> == <a class="code" href="Overhead_01Types_8h.html#df5bf54a26a76adf253f57d88ade82b7d0611de6f28d4a9c9eac959f5344698e">NORTH</a> )
<a name="l00923"></a>00923                               {
<a name="l00924"></a>00924                                     <a class="code" href="Soldier_01Control_8cpp.html#85356885ab89da0e5fdb7a225f7db225">SetSoldierHeight</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>, (<a class="code" href="Types_8h.html#8d06b04c04132c6f7c0fcb08c6167455">FLOAT</a>)(pSoldier-&gt;dHeightAdjustment - <a class="code" href="Soldier_01Ani_8cpp.html#e768d781bdb574535f4d6242f51d9c59">gClimbUpRoofDist</a>[ pSoldier-&gt;ubBodyType ] ) );
<a name="l00925"></a>00925                               }
<a name="l00926"></a>00926                               <span class="keywordflow">else</span>
<a name="l00927"></a>00927                               {
<a name="l00928"></a>00928                                     <a class="code" href="Soldier_01Control_8cpp.html#85356885ab89da0e5fdb7a225f7db225">SetSoldierHeight</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>, (<a class="code" href="Types_8h.html#8d06b04c04132c6f7c0fcb08c6167455">FLOAT</a>)(<a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#c251e17a200789d043f3b0768b35eaaa">dHeightAdjustment</a> - <a class="code" href="Soldier_01Ani_8cpp.html#e768d781bdb574535f4d6242f51d9c59">gClimbUpRoofDist</a>[ <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#b082364eed3d7883662f69e1fd96be1a">ubBodyType</a> ] ) );
<a name="l00929"></a>00929                               }
<a name="l00930"></a>00930                               <span class="keywordflow">break</span>;
<a name="l00931"></a>00931 
<a name="l00932"></a>00932                         <span class="keywordflow">case</span> 457:
<a name="l00933"></a>00933 
<a name="l00934"></a>00934                               <span class="comment">// CODE: CHANGCE STANCE TO STANDING</span>
<a name="l00935"></a>00935                               <a class="code" href="Soldier_01Control_8cpp.html#84e3a78b45e32e523782c253a4addd3b">SendChangeSoldierStanceEvent</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>, ANIM_STAND );
<a name="l00936"></a>00936                               <span class="keywordflow">break</span>;
<a name="l00937"></a>00937 
<a name="l00938"></a>00938                         <span class="keywordflow">case</span> 459:
<a name="l00939"></a>00939 
<a name="l00940"></a>00940                               <span class="comment">// CODE: CHANGE ATTACKING TO FIRST HAND</span>
<a name="l00941"></a>00941                               <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#99a689d831418a5e3ed638a34761514e">ubAttackingHand</a> = HANDPOS;
<a name="l00942"></a>00942                               <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#549976333a3c89be2ca4a342235e1464">usAttackingWeapon</a> = <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#13c875b952b6d634680165d127a9870b">inv</a>[<a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#99a689d831418a5e3ed638a34761514e">ubAttackingHand</a>].<a class="code" href="structOBJECTTYPE.html#4fbe05335f161f08f354566b8e5a0a19">usItem</a>;
<a name="l00943"></a>00943                               <span class="comment">// Adjust fReloading to FALSE</span>
<a name="l00944"></a>00944                               <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#e1185996e8104ed077284c28f9595c3b">fReloading</a> = FALSE;                         
<a name="l00945"></a>00945                               <span class="keywordflow">break</span>;
<a name="l00946"></a>00946 
<a name="l00947"></a>00947                         <span class="keywordflow">case</span> 458:
<a name="l00948"></a>00948 
<a name="l00949"></a>00949                               <span class="comment">// CODE: CHANGE ATTACKING TO SECOND HAND</span>
<a name="l00950"></a>00950                               <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#99a689d831418a5e3ed638a34761514e">ubAttackingHand</a> = <a class="code" href="Soldier_01Control_8h.html#2a5937706f1724c8f06a0396bdc87855009684dc553cebead620fa082b29cb86">SECONDHANDPOS</a>;
<a name="l00951"></a>00951                               <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#549976333a3c89be2ca4a342235e1464">usAttackingWeapon</a> = <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#13c875b952b6d634680165d127a9870b">inv</a>[<a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#99a689d831418a5e3ed638a34761514e">ubAttackingHand</a>].<a class="code" href="structOBJECTTYPE.html#4fbe05335f161f08f354566b8e5a0a19">usItem</a>;
<a name="l00952"></a>00952                               <span class="comment">// Adjust fReloading to FALSE</span>
<a name="l00953"></a>00953                               <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#e1185996e8104ed077284c28f9595c3b">fReloading</a> = FALSE;
<a name="l00954"></a>00954                               <span class="keywordflow">break</span>;
<a name="l00955"></a>00955 
<a name="l00956"></a>00956                         <span class="keywordflow">case</span> 460:
<a name="l00957"></a>00957                         <span class="keywordflow">case</span> 461:
<a name="l00958"></a>00958 
<a name="l00959"></a>00959                               <span class="comment">//CODE: THORW ITEM</span>
<a name="l00960"></a>00960                               <span class="comment">// Launch ITem!</span>
<a name="l00961"></a>00961                               <span class="keywordflow">if</span> ( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#c8e5d4de5c5e5af59fc90d9c545a6bce">pTempObject</a> != NULL &amp;&amp; <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#9556c5dc19f720fb45cd2bdaa4283ddf">pThrowParams</a> != NULL )
<a name="l00962"></a>00962                               {
<a name="l00963"></a>00963                                     <span class="comment">// ATE: If we are armmed...</span>
<a name="l00964"></a>00964                                     <span class="keywordflow">if</span> ( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#9556c5dc19f720fb45cd2bdaa4283ddf">pThrowParams</a>-&gt;<a class="code" href="structTHROW__PARAMS.html#833cacaf77020edeac09592e6bd3b289">ubActionCode</a> == <a class="code" href="Soldier_01Control_8h.html#ce1ea5ceca73af21930eb45f54580537aa5766234e6785f19ee7343bc840824c">THROW_ARM_ITEM</a> )
<a name="l00965"></a>00965                                     {
<a name="l00966"></a>00966                                           <span class="comment">// ATE: Deduct points!</span>
<a name="l00967"></a>00967                                           <a class="code" href="Points_8cpp.html#2443da2dcce8326e972d806fbc4eaff8">DeductPoints</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>, <a class="code" href="Points_8cpp.html#1352a518db6a702ef8e451e59657af4e">MinAPsToThrow</a>( pSoldier, pSoldier-&gt;sTargetGridNo, FALSE ), 0 );
<a name="l00968"></a>00968                                     }
<a name="l00969"></a>00969                                     <span class="keywordflow">else</span>
<a name="l00970"></a>00970                                     {
<a name="l00971"></a>00971                                           <span class="comment">// ATE: Deduct points!</span>
<a name="l00972"></a>00972                                           <a class="code" href="Points_8cpp.html#2443da2dcce8326e972d806fbc4eaff8">DeductPoints</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>, AP_TOSS_ITEM, 0 );
<a name="l00973"></a>00973                                     }
<a name="l00974"></a>00974 
<a name="l00975"></a>00975                                     <a class="code" href="physics_8cpp.html#cf1f4a50b341f5ccab0b4f64972f26d5">CreatePhysicalObject</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#c8e5d4de5c5e5af59fc90d9c545a6bce">pTempObject</a>, <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#9556c5dc19f720fb45cd2bdaa4283ddf">pThrowParams</a>-&gt;<a class="code" href="structTHROW__PARAMS.html#9709d870d0d56014a73a3e0660514c0a">dLifeSpan</a>,  <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#9556c5dc19f720fb45cd2bdaa4283ddf">pThrowParams</a>-&gt;<a class="code" href="structTHROW__PARAMS.html#04fe9a4ba75fc3bfa6a20d2bc3730fea">dX</a>, <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#9556c5dc19f720fb45cd2bdaa4283ddf">pThrowParams</a>-&gt;<a class="code" href="structTHROW__PARAMS.html#ea7bdcfef954df0d9ff55b9292762371">dY</a>, <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#9556c5dc19f720fb45cd2bdaa4283ddf">pThrowParams</a>-&gt;<a class="code" href="structTHROW__PARAMS.html#4f5cfeb6d6e2f0d2c5e49bbdf15b6eef">dZ</a>, <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#9556c5dc19f720fb45cd2bdaa4283ddf">pThrowParams</a>-&gt;<a class="code" href="structTHROW__PARAMS.html#b4f25c040d3cbe3120191171743c27ea">dForceX</a>, <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#9556c5dc19f720fb45cd2bdaa4283ddf">pThrowParams</a>-&gt;<a class="code" href="structTHROW__PARAMS.html#ea124ec7a58046d0197e7ac4bfb0cf75">dForceY</a>, <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#9556c5dc19f720fb45cd2bdaa4283ddf">pThrowParams</a>-&gt;<a class="code" href="structTHROW__PARAMS.html#95cba0507c2dad5c27e57b4b6fae94b4">dForceZ</a>, <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#18aef170576da81b10d00e7b6cd3627b">ubID</a>, <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#9556c5dc19f720fb45cd2bdaa4283ddf">pThrowParams</a>-&gt;<a class="code" href="structTHROW__PARAMS.html#833cacaf77020edeac09592e6bd3b289">ubActionCode</a>, <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#9556c5dc19f720fb45cd2bdaa4283ddf">pThrowParams</a>-&gt;<a class="code" href="structTHROW__PARAMS.html#99d3eebb3422e287d83dade756fd866b">uiActionData</a> );
<a name="l00976"></a>00976 
<a name="l00977"></a>00977                                     <span class="comment">// Remove object</span>
<a name="l00978"></a>00978                                     <span class="comment">//RemoveObjFrom( &amp;(pSoldier-&gt;inv[ HANDPOS ] ), 0 );</span>
<a name="l00979"></a>00979 
<a name="l00980"></a>00980                                     <span class="comment">// Update UI</span>
<a name="l00981"></a>00981                                     <a class="code" href="Interface_8cpp.html#8a607488839071ed48da8a73aeaad595">DirtyMercPanelInterface</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>, DIRTYLEVEL2 );
<a name="l00982"></a>00982 
<a name="l00983"></a>00983                                     MemFree( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#c8e5d4de5c5e5af59fc90d9c545a6bce">pTempObject</a> );
<a name="l00984"></a>00984                                     <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#c8e5d4de5c5e5af59fc90d9c545a6bce">pTempObject</a> = NULL;
<a name="l00985"></a>00985 
<a name="l00986"></a>00986                                     MemFree( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#9556c5dc19f720fb45cd2bdaa4283ddf">pThrowParams</a> );
<a name="l00987"></a>00987                                     <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#9556c5dc19f720fb45cd2bdaa4283ddf">pThrowParams</a> = NULL;
<a name="l00988"></a>00988                               }
<a name="l00989"></a>00989                               <span class="keywordflow">break</span>;
<a name="l00990"></a>00990 
<a name="l00991"></a>00991                         <span class="keywordflow">case</span> 462:
<a name="l00992"></a>00992 
<a name="l00993"></a>00993                               <span class="comment">// CODE: MOVE UP FROM CLIFF CLIMB</span>
<a name="l00994"></a>00994                               <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#c251e17a200789d043f3b0768b35eaaa">dHeightAdjustment</a> += (float)2.1;
<a name="l00995"></a>00995                               <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#18caa6e91d2ba546bae716027ee6637c">sHeightAdjustment</a> = (<a class="code" href="Types_8h.html#30f500129d8c688af07726d5d34ce52d">INT16</a>)<a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#c251e17a200789d043f3b0768b35eaaa">dHeightAdjustment</a>;
<a name="l00996"></a>00996                               <span class="comment">// Move over some...</span>
<a name="l00997"></a>00997                               <span class="comment">//MoveMercFacingDirection( pSoldier , FALSE, (FLOAT)0.5 );</span>
<a name="l00998"></a>00998                               <span class="keywordflow">break</span>;
<a name="l00999"></a>00999 
<a name="l01000"></a>01000                         <span class="keywordflow">case</span> 463:
<a name="l01001"></a>01001                               
<a name="l01002"></a>01002                               <span class="comment">// MOVE GUY FORWARD SOME VALUE</span>
<a name="l01003"></a>01003                               <span class="comment">// Creature move</span>
<a name="l01004"></a>01004                               <a class="code" href="Soldier_01Control_8cpp.html#905e2d828289ad582cafe7449e14b015">MoveMercFacingDirection</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>, FALSE, (<a class="code" href="Types_8h.html#8d06b04c04132c6f7c0fcb08c6167455">FLOAT</a>)1.5 );
<a name="l01005"></a>01005                               <span class="keywordflow">break</span>;
<a name="l01006"></a>01006 
<a name="l01007"></a>01007                         <span class="keywordflow">case</span> 464:
<a name="l01008"></a>01008                               
<a name="l01009"></a>01009                               <span class="comment">// CODE: END CLIFF CLIMB</span>
<a name="l01010"></a>01010                               pSoldier-&gt;dHeightAdjustment = (float)0;
<a name="l01011"></a>01011                               pSoldier-&gt;sHeightAdjustment = (<a class="code" href="Types_8h.html#30f500129d8c688af07726d5d34ce52d">INT16</a>)pSoldier-&gt;dHeightAdjustment;
<a name="l01012"></a>01012 
<a name="l01013"></a>01013                               <span class="comment">// Set new gridno</span>
<a name="l01014"></a>01014                               {
<a name="l01015"></a>01015                                     <a class="code" href="Types_8h.html#30f500129d8c688af07726d5d34ce52d">INT16</a> sTempGridNo, sNewX, sNewY;
<a name="l01016"></a>01016 
<a name="l01017"></a>01017                                     <span class="comment">//Get Next GridNo;</span>
<a name="l01018"></a>01018                                     sTempGridNo = <a class="code" href="Isometric_01Utils_8cpp.html#318d8410127e29bb232ab70363bc316e">NewGridNo</a>( (<a class="code" href="Types_8h.html#09f1a1fb2293e33483cc8d44aefb1eb1">UINT16</a>)pSoldier-&gt;sGridNo, (<a class="code" href="Types_8h.html#30f500129d8c688af07726d5d34ce52d">INT16</a>)( <a class="code" href="Isometric_01Utils_8cpp.html#a4a3adf599f99864b1de33673888fd5e">DirectionInc</a>(pSoldier-&gt;bDirection ) ) );
<a name="l01019"></a>01019                                     
<a name="l01020"></a>01020                                     <span class="comment">// Get center XY</span>
<a name="l01021"></a>01021                                     <a class="code" href="Isometric_01Utils_8cpp.html#5919936aba0b5f157738a66b7fe682f2">ConvertGridNoToCenterCellXY</a>( sTempGridNo, &amp;sNewX, &amp;sNewY );
<a name="l01022"></a>01022 
<a name="l01023"></a>01023                                     <span class="comment">// Set position</span>
<a name="l01024"></a>01024                                     <a class="code" href="Soldier_01Control_8cpp.html#265ef31340bc30f973e4fd89d56c1c32">EVENT_SetSoldierPosition</a>( pSoldier, sNewX, sNewY );
<a name="l01025"></a>01025 
<a name="l01026"></a>01026                                     <span class="comment">// Move two CC directions</span>
<a name="l01027"></a>01027                                     <a class="code" href="Soldier_01Control_8cpp.html#1117087649d17ca4dfc078c0947e7f09">EVENT_SetSoldierDirection</a>( pSoldier, <a class="code" href="Isometric_01Utils_8cpp.html#a1a621c0ccc1f6c72c8b0bb7178c1318">gTwoCCDirection</a>[ pSoldier-&gt;bDirection ] );
<a name="l01028"></a>01028                                     <a class="code" href="Soldier_01Control_8cpp.html#019f893295bb96f48261ded184a17cab">EVENT_SetSoldierDesiredDirection</a>( pSoldier, pSoldier-&gt;bDirection );
<a name="l01029"></a>01029 
<a name="l01030"></a>01030                                     <span class="comment">// Set desired anim height!</span>
<a name="l01031"></a>01031                                     pSoldier-&gt;ubDesiredHeight = ANIM_CROUCH;
<a name="l01032"></a>01032                                     pSoldier-&gt;sFinalDestination = pSoldier-&gt;sGridNo;
<a name="l01033"></a>01033 
<a name="l01034"></a>01034                               }
<a name="l01035"></a>01035                               <span class="keywordflow">break</span>;
<a name="l01036"></a>01036 
<a name="l01037"></a>01037                         <span class="keywordflow">case</span> 465:
<a name="l01038"></a>01038 
<a name="l01039"></a>01039                               <span class="comment">// CODE: SET GUY TO LIFE OF 0</span>
<a name="l01040"></a>01040                               <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#e308dea18533bf5ab2bcee5bbe27391c">bLife</a> = 0;
<a name="l01041"></a>01041                               <span class="keywordflow">break</span>;
<a name="l01042"></a>01042 
<a name="l01043"></a>01043                         <span class="keywordflow">case</span> 466:
<a name="l01044"></a>01044 
<a name="l01045"></a>01045                               <span class="comment">// CODE: ADJUST TO OUR DEST HEIGHT</span>
<a name="l01046"></a>01046                               <span class="keywordflow">if</span> ( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#18caa6e91d2ba546bae716027ee6637c">sHeightAdjustment</a> != <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#8e167d64e24287fe16b947db5fe45e08">sDesiredHeight</a> )
<a name="l01047"></a>01047                               {
<a name="l01048"></a>01048                                     <a class="code" href="Types_8h.html#30f500129d8c688af07726d5d34ce52d">INT16</a> sDiff = <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#18caa6e91d2ba546bae716027ee6637c">sHeightAdjustment</a> - <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#8e167d64e24287fe16b947db5fe45e08">sDesiredHeight</a>;
<a name="l01049"></a>01049 
<a name="l01050"></a>01050                                     <span class="keywordflow">if</span> ( abs( sDiff ) &gt; 4 )
<a name="l01051"></a>01051                                     {
<a name="l01052"></a>01052                                           <span class="keywordflow">if</span> ( sDiff &gt; 0 )
<a name="l01053"></a>01053                                           {
<a name="l01054"></a>01054                                                 <span class="comment">// Adjust!</span>
<a name="l01055"></a>01055                                                 <a class="code" href="Soldier_01Control_8cpp.html#85356885ab89da0e5fdb7a225f7db225">SetSoldierHeight</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>, (<a class="code" href="Types_8h.html#8d06b04c04132c6f7c0fcb08c6167455">FLOAT</a>)(<a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#c251e17a200789d043f3b0768b35eaaa">dHeightAdjustment</a> - 2 ) );
<a name="l01056"></a>01056                                           }
<a name="l01057"></a>01057                                           <span class="keywordflow">else</span>
<a name="l01058"></a>01058                                           {
<a name="l01059"></a>01059                                                 <span class="comment">// Adjust!</span>
<a name="l01060"></a>01060                                                 <a class="code" href="Soldier_01Control_8cpp.html#85356885ab89da0e5fdb7a225f7db225">SetSoldierHeight</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>, (<a class="code" href="Types_8h.html#8d06b04c04132c6f7c0fcb08c6167455">FLOAT</a>)(<a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#c251e17a200789d043f3b0768b35eaaa">dHeightAdjustment</a> + 2 ) );
<a name="l01061"></a>01061                                           }
<a name="l01062"></a>01062                                     }
<a name="l01063"></a>01063                                     <span class="keywordflow">else</span>
<a name="l01064"></a>01064                                     {
<a name="l01065"></a>01065                                           <span class="comment">// Adjust!</span>
<a name="l01066"></a>01066                                           <a class="code" href="Soldier_01Control_8cpp.html#85356885ab89da0e5fdb7a225f7db225">SetSoldierHeight</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>, (<a class="code" href="Types_8h.html#8d06b04c04132c6f7c0fcb08c6167455">FLOAT</a>)(<a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#8e167d64e24287fe16b947db5fe45e08">sDesiredHeight</a>) );
<a name="l01067"></a>01067                                     }
<a name="l01068"></a>01068                               }
<a name="l01069"></a>01069                               <span class="keywordflow">else</span>
<a name="l01070"></a>01070                               {
<a name="l01071"></a>01071                                     <span class="comment">// Goto eating animation</span>
<a name="l01072"></a>01072                                     <span class="keywordflow">if</span> ( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#8e167d64e24287fe16b947db5fe45e08">sDesiredHeight</a> == 0 )
<a name="l01073"></a>01073                                     {
<a name="l01074"></a>01074                                           <a class="code" href="Soldier_01Control_8cpp.html#6f191e00fb4f3c5e2cbe762aa402a420">ChangeSoldierState</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>, <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2eb8244c531b98027ad5f7285399fdf5644">CROW_EAT</a>, 0 , FALSE );                                      
<a name="l01075"></a>01075                                     }
<a name="l01076"></a>01076                                     <span class="keywordflow">else</span>
<a name="l01077"></a>01077                                     {
<a name="l01078"></a>01078                                           <span class="comment">// We should leave now!</span>
<a name="l01079"></a>01079                                           <a class="code" href="Soldier_01Create_8cpp.html#5761f369bb132d093e5ce84db76fd7cf">TacticalRemoveSoldier</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#18aef170576da81b10d00e7b6cd3627b">ubID</a> );
<a name="l01080"></a>01080                                           <span class="keywordflow">return</span>( FALSE );
<a name="l01081"></a>01081                                     }
<a name="l01082"></a>01082                                     <span class="keywordflow">return</span>( TRUE );
<a name="l01083"></a>01083                               }
<a name="l01084"></a>01084                               <span class="keywordflow">break</span>;
<a name="l01085"></a>01085 
<a name="l01086"></a>01086                         <span class="keywordflow">case</span> 467:
<a name="l01087"></a>01087 <span class="comment"></span>
<a name="l01088"></a>01088 <span class="comment">                              ///CODE: FOR HELIDROP, SET DIRECTION</span>
<a name="l01089"></a>01089 <span class="comment"></span>                              <a class="code" href="Soldier_01Control_8cpp.html#1117087649d17ca4dfc078c0947e7f09">EVENT_SetSoldierDirection</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>, <a class="code" href="Overhead_01Types_8h.html#df5bf54a26a76adf253f57d88ade82b7b5b3793b961949c817c7c0d99c05dad7">EAST</a> );
<a name="l01090"></a>01090                               <a class="code" href="Soldier_01Control_8cpp.html#019f893295bb96f48261ded184a17cab">EVENT_SetSoldierDesiredDirection</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>, <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#8aa6174a253c3fa21a3ec41ce0174340">bDirection</a> );
<a name="l01091"></a>01091 
<a name="l01092"></a>01092                               <a class="code" href="Merc_01Entering_8cpp.html#bf36a6db64d8adb49064c81873537c50">gfIngagedInDrop</a> = FALSE;
<a name="l01093"></a>01093 
<a name="l01094"></a>01094                               <span class="comment">// OK, now get a sweetspot ( not the place we are now! )</span>
<a name="l01095"></a>01095                         <span class="comment">//    sNewGridNo =  FindGridNoFromSweetSpotExcludingSweetSpot( pSoldier, pSoldier-&gt;sGridNo, 5, &amp;ubNewDirection );</span>
<a name="l01096"></a>01096                               <span class="comment">//sNewGridNo =  FindRandomGridNoFromSweetSpotExcludingSweetSpot( pSoldier, pSoldier-&gt;sGridNo, 3, &amp;ubNewDirection );</span>
<a name="l01097"></a>01097                               
<a name="l01098"></a>01098                               sNewGridNo =  <a class="code" href="Soldier_01Add_8cpp.html#874ef5f148bb645e6cc49da08f19eb71">FindGridNoFromSweetSpotExcludingSweetSpotInQuardent</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>, <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#2ab66ee0f37902cd448f4a738df4f2bf">sGridNo</a>, 3, &amp;ubNewDirection, <a class="code" href="Overhead_01Types_8h.html#df5bf54a26a76adf253f57d88ade82b716c2c7abfbd3bad3343b0dcaa858bb49">SOUTHEAST</a> );
<a name="l01099"></a>01099 
<a name="l01100"></a>01100                               <span class="comment">// Check for merc arrives quotes...</span>
<a name="l01101"></a>01101                               <a class="code" href="Merc_01Hiring_8cpp.html#163c33f099bcc3bec4c83e5e49e81074">HandleMercArrivesQuotes</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a> );
<a name="l01102"></a>01102 
<a name="l01103"></a>01103                               <span class="comment">// Find a path to it!</span>
<a name="l01104"></a>01104                               <a class="code" href="Soldier_01Control_8cpp.html#b05ad69d15646823d9464ad2285fc865">EVENT_GetNewSoldierPath</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>, sNewGridNo, <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2eb7f92908f6f669259d971b608823d2ebb">WALKING</a> );         
<a name="l01105"></a>01105 
<a name="l01106"></a>01106                               <span class="keywordflow">return</span>( TRUE );
<a name="l01107"></a>01107                               <span class="keywordflow">break</span>;
<a name="l01108"></a>01108 
<a name="l01109"></a>01109                         <span class="keywordflow">case</span> 468:
<a name="l01110"></a>01110 
<a name="l01111"></a>01111                               <span class="comment">// CODE: End PUNCH</span>
<a name="l01112"></a>01112                               {
<a name="l01113"></a>01113                                     <a class="code" href="Types_8h.html#112e3146cb38b6ee95e64d85842e380a">BOOLEAN</a> fNPCPunch = FALSE;
<a name="l01114"></a>01114 
<a name="l01115"></a>01115                                     <span class="comment">// ATE: Put some code in for NPC punches...</span>
<a name="l01116"></a>01116                                     <span class="keywordflow">if</span> ( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#eb633099940bc20ff5a969bce84eab42">uiStatusFlags</a> &amp; SOLDIER_NPC_DOING_PUNCH )
<a name="l01117"></a>01117                                     {
<a name="l01118"></a>01118                                           fNPCPunch = TRUE;
<a name="l01119"></a>01119 
<a name="l01120"></a>01120                                           <span class="comment">// Turn off</span>
<a name="l01121"></a>01121                                           <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#eb633099940bc20ff5a969bce84eab42">uiStatusFlags</a> &amp;= (~SOLDIER_NPC_DOING_PUNCH );
<a name="l01122"></a>01122 
<a name="l01123"></a>01123                                           <span class="comment">// Trigger approach...</span>
<a name="l01124"></a>01124                                           <a class="code" href="NPC_8cpp.html#d7f92a649ae364cf3c2b7b69c4806bd0">TriggerNPCWithGivenApproach</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#5a5648a1bb3507cc41f6be199c51a3f8">ubProfile</a>, (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)<a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#304094e7d2a05131c34f41c46dfb6fad">uiPendingActionData4</a>, FALSE );
<a name="l01125"></a>01125                                     }
<a name="l01126"></a>01126 
<a name="l01127"></a>01127 
<a name="l01128"></a>01128                                     <span class="comment">// Are we a martial artist?</span>
<a name="l01129"></a>01129                                     {
<a name="l01130"></a>01130                                           <a class="code" href="Types_8h.html#112e3146cb38b6ee95e64d85842e380a">BOOLEAN</a> fMartialArtist = FALSE;
<a name="l01131"></a>01131 
<a name="l01132"></a>01132                                           <span class="keywordflow">if</span> ( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#5a5648a1bb3507cc41f6be199c51a3f8">ubProfile</a> != NO_PROFILE )
<a name="l01133"></a>01133                                           {
<a name="l01134"></a>01134                                                 <span class="keywordflow">if</span> ( <a class="code" href="Soldier_01Profile_8cpp.html#1bcff2c50b375b1eb32800aa12000289">gMercProfiles</a>[ <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#5a5648a1bb3507cc41f6be199c51a3f8">ubProfile</a> ].bSkillTrait == <a class="code" href="soldier_01profile_01type_8h.html#88183a1fc58897e3edb65b354323264b1650d88ff873e5a43f17dc0ecc7216f8">MARTIALARTS</a> || <a class="code" href="Soldier_01Profile_8cpp.html#1bcff2c50b375b1eb32800aa12000289">gMercProfiles</a>[ <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#5a5648a1bb3507cc41f6be199c51a3f8">ubProfile</a> ].bSkillTrait2 == <a class="code" href="soldier_01profile_01type_8h.html#88183a1fc58897e3edb65b354323264b1650d88ff873e5a43f17dc0ecc7216f8">MARTIALARTS</a> )
<a name="l01135"></a>01135                                                 {
<a name="l01136"></a>01136                                                       fMartialArtist = TRUE;
<a name="l01137"></a>01137                                                 }
<a name="l01138"></a>01138                                           }
<a name="l01139"></a>01139 
<a name="l01140"></a>01140                                           <span class="keywordflow">if</span> ( <a class="code" href="Animation_01Control_8cpp.html#633440a87c34a25c700ce620db87d036">gAnimControl</a>[ <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#1f73b62a5ea0dd26fa1bec1d9f522b41">usAnimState</a> ].ubHeight == ANIM_CROUCH )
<a name="l01141"></a>01141                                           {
<a name="l01142"></a>01142                                                 <span class="keywordflow">if</span> ( fNPCPunch )
<a name="l01143"></a>01143                                                 {
<a name="l01144"></a>01144                                                       <a class="code" href="Soldier_01Control_8cpp.html#399090c009d2c65d23138520beb3382c">ChangeSoldierStance</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>, ANIM_STAND );
<a name="l01145"></a>01145                                                       <span class="keywordflow">return</span>( TRUE );
<a name="l01146"></a>01146                                                 }
<a name="l01147"></a>01147                                                 <span class="keywordflow">else</span>
<a name="l01148"></a>01148                                                 {
<a name="l01149"></a>01149                                                       <a class="code" href="Soldier_01Control_8cpp.html#6f191e00fb4f3c5e2cbe762aa402a420">ChangeSoldierState</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>, <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2eb5130e76685fc2f3c83bbcfd89dbebe48">CROUCHING</a>, 0, FALSE );
<a name="l01150"></a>01150                                                       <span class="keywordflow">return</span>( TRUE );
<a name="l01151"></a>01151                                                 }
<a name="l01152"></a>01152                                           }
<a name="l01153"></a>01153                                           <span class="keywordflow">else</span>
<a name="l01154"></a>01154                                           {
<a name="l01155"></a>01155                                                 <span class="keywordflow">if</span> ( fMartialArtist &amp;&amp; !<a class="code" href="Meanwhile_8cpp.html#469f9fe7efd5677c25840cf980c1fb55">AreInMeanwhile</a>( ) )
<a name="l01156"></a>01156                                                 {
<a name="l01157"></a>01157                                                       <a class="code" href="Soldier_01Control_8cpp.html#6f191e00fb4f3c5e2cbe762aa402a420">ChangeSoldierState</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>, <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2eb1ebe695d668de6516fe993acfaea8907">NINJA_BREATH</a>, 0, FALSE );
<a name="l01158"></a>01158                                                       <span class="keywordflow">return</span>( TRUE );
<a name="l01159"></a>01159                                                 }
<a name="l01160"></a>01160                                                 <span class="keywordflow">else</span>
<a name="l01161"></a>01161                                                 {
<a name="l01162"></a>01162                                                       <a class="code" href="Soldier_01Control_8cpp.html#6f191e00fb4f3c5e2cbe762aa402a420">ChangeSoldierState</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>, <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2ebe9e82c0895525f24835d5b2e6629b7aa">PUNCH_BREATH</a>, 0, FALSE );
<a name="l01163"></a>01163                                                       <span class="keywordflow">return</span>( TRUE );
<a name="l01164"></a>01164                                                 }
<a name="l01165"></a>01165                                           }
<a name="l01166"></a>01166                                     }
<a name="l01167"></a>01167                               }
<a name="l01168"></a>01168                               <span class="keywordflow">break</span>;
<a name="l01169"></a>01169 
<a name="l01170"></a>01170                         <span class="keywordflow">case</span> 469:
<a name="l01171"></a>01171 
<a name="l01172"></a>01172                               <span class="comment">// CODE: Begin martial artist attack</span>
<a name="l01173"></a>01173                               <a class="code" href="Soldier_01Control_8cpp.html#0e2b6645e7b422c1235bfa8703fc976e">DoNinjaAttack</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a> );
<a name="l01174"></a>01174                               <span class="keywordflow">return</span>( TRUE );
<a name="l01175"></a>01175                               <span class="keywordflow">break</span>;
<a name="l01176"></a>01176                         
<a name="l01177"></a>01177                         <span class="keywordflow">case</span> 470:
<a name="l01178"></a>01178 
<a name="l01179"></a>01179                               <span class="comment">// CODE: CHECK FOR OK WEAPON SHOT!</span>
<a name="l01180"></a>01180                               bOKFireWeapon =  <a class="code" href="Weapons_8cpp.html#04badebfcffe5700b3ecc6153e740fab">OKFireWeapon</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a> );
<a name="l01181"></a>01181 
<a name="l01182"></a>01182                               <span class="keywordflow">if</span> ( bOKFireWeapon == FALSE )
<a name="l01183"></a>01183                               {
<a name="l01184"></a>01184                                     DebugMsg( <a class="code" href="DEBUG_8cpp.html#a7985c2fd033797fc67a03b2c26e07c6">TOPIC_JA2</a>, DBG_LEVEL_3, <a class="code" href="DEBUG_8cpp.html#88565bf27eec0b2003eb5bc9426b8e4b">String</a>(<span class="stringliteral">"Fire Weapon: Gun Cannot fire, code 470"</span>) );
<a name="l01185"></a>01185 
<a name="l01186"></a>01186                                     <span class="comment">// OK, SKIP x # OF FRAMES</span>
<a name="l01187"></a>01187                                     <span class="comment">// Skip 3 frames, ( a third ia added at the end of switch.. ) For a total of 4</span>
<a name="l01188"></a>01188                                     <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#d1221226402ff4b54671e0142ec90cd6">usAniCode</a> += 4;
<a name="l01189"></a>01189 
<a name="l01190"></a>01190                                     <span class="comment">// Reduce by a bullet...</span>
<a name="l01191"></a>01191                                     <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#51424f18568b9ec62dcec930be427e75">bBulletsLeft</a>--;
<a name="l01192"></a>01192 
<a name="l01193"></a>01193                                     <a class="code" href="Sound_01Control_8cpp.html#6b140a8e4fcf89b7740c037ff12580a7">PlayJA2Sample</a>( <a class="code" href="Sound_01Control_8h.html#946995a6d03371486c23b23d9ca362b5bb9bd7e071616d3004c6c2da21a340ec">S_DRYFIRE1</a>, RATE_11025, <a class="code" href="Sound_01Control_8cpp.html#f62b2a668c2e25997578956c425723c4">SoundVolume</a>( MIDVOLUME, <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#2ab66ee0f37902cd448f4a738df4f2bf">sGridNo</a> ), 1, <a class="code" href="Sound_01Control_8cpp.html#a258fd693b7e800828705055bf357c8d">SoundDir</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#2ab66ee0f37902cd448f4a738df4f2bf">sGridNo</a> ) );             
<a name="l01194"></a>01194 
<a name="l01195"></a>01195                                     <span class="comment">// Free-up!</span>
<a name="l01196"></a>01196                                     DebugMsg( TOPIC_JA2, DBG_LEVEL_3, <a class="code" href="DEBUG_8cpp.html#88565bf27eec0b2003eb5bc9426b8e4b">String</a>(<span class="stringliteral">"@@@@@@@ Freeing up attacker - gun failed to fire"</span>) );
<a name="l01197"></a>01197                                     <a class="code" href="Overhead_8cpp.html#1e4783fce030a18ff553667016753e20">FreeUpAttacker</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#18aef170576da81b10d00e7b6cd3627b">ubID</a> );
<a name="l01198"></a>01198 
<a name="l01199"></a>01199                               }
<a name="l01200"></a>01200                               <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( bOKFireWeapon == 255 )
<a name="l01201"></a>01201                               {
<a name="l01202"></a>01202                                     <span class="comment">// Play intermediate animation...</span>
<a name="l01203"></a>01203                                     <span class="keywordflow">if</span> ( <a class="code" href="Soldier_01Ani_8cpp.html#b347fd92f91cd16381f0163a2da1e293">HandleUnjamAnimation</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a> ) )
<a name="l01204"></a>01204                                     {
<a name="l01205"></a>01205                                           <span class="keywordflow">return</span>( TRUE );
<a name="l01206"></a>01206                                     }
<a name="l01207"></a>01207                               }
<a name="l01208"></a>01208                               <span class="keywordflow">break</span>;
<a name="l01209"></a>01209 
<a name="l01210"></a>01210                         <span class="keywordflow">case</span> 471:
<a name="l01211"></a>01211 
<a name="l01212"></a>01212                               <span class="comment">// CODE: Turn pause move flag off</span>
<a name="l01213"></a>01213                               <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#eb633099940bc20ff5a969bce84eab42">uiStatusFlags</a> &amp;= (~SOLDIER_PAUSEANIMOVE);
<a name="l01214"></a>01214                               <span class="keywordflow">break</span>;
<a name="l01215"></a>01215 
<a name="l01216"></a>01216                         <span class="keywordflow">case</span> 472:
<a name="l01217"></a>01217                               
<a name="l01218"></a>01218                               {
<a name="l01219"></a>01219                                     <a class="code" href="Types_8h.html#112e3146cb38b6ee95e64d85842e380a">BOOLEAN</a> fGoBackToAimAfterHit;
<a name="l01220"></a>01220 
<a name="l01221"></a>01221                                     <span class="comment">// Save old flag, then reset. If we do nothing special here, at least go back</span>
<a name="l01222"></a>01222                                     <span class="comment">// to aim if we were.</span>
<a name="l01223"></a>01223                                     fGoBackToAimAfterHit = <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#983794f51fd9d26492daf0a1cb5bf443">fGoBackToAimAfterHit</a>;
<a name="l01224"></a>01224                                     <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#983794f51fd9d26492daf0a1cb5bf443">fGoBackToAimAfterHit</a> = FALSE;
<a name="l01225"></a>01225 
<a name="l01226"></a>01226                                     <span class="keywordflow">if</span> ( !( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#eb633099940bc20ff5a969bce84eab42">uiStatusFlags</a> &amp; SOLDIER_TURNINGFROMHIT ) )
<a name="l01227"></a>01227                                     {
<a name="l01228"></a>01228                                           <span class="keywordflow">switch</span>( <a class="code" href="Animation_01Control_8cpp.html#633440a87c34a25c700ce620db87d036">gAnimControl</a>[ <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#1f73b62a5ea0dd26fa1bec1d9f522b41">usAnimState</a> ].ubEndHeight )
<a name="l01229"></a>01229                                           {
<a name="l01230"></a>01230                                                 <span class="keywordflow">case</span> ANIM_STAND:
<a name="l01231"></a>01231 
<a name="l01232"></a>01232                                                       <span class="comment">// OK, we can do some cool things here - first is to make guy walkl back a bit...</span>
<a name="l01233"></a>01233                                                 <span class="comment">//    ChangeSoldierState( pSoldier, STANDING_HIT_BEGINCROUCHDOWN, 0, FALSE );</span>
<a name="l01234"></a>01234                                                 <span class="comment">//    return( TRUE );</span>
<a name="l01235"></a>01235                                                       <span class="keywordflow">break</span>;
<a name="l01236"></a>01236 
<a name="l01237"></a>01237                                           }
<a name="l01238"></a>01238                                     }
<a name="l01239"></a>01239 
<a name="l01240"></a>01240                                     <span class="comment">// CODE: HANDLE ANY RANDOM HIT VARIATIONS WE WISH TO DO.....</span>
<a name="l01241"></a>01241                                     <span class="keywordflow">if</span> ( fGoBackToAimAfterHit )
<a name="l01242"></a>01242                                     {
<a name="l01243"></a>01243                                            <span class="keywordflow">if</span> ( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#e308dea18533bf5ab2bcee5bbe27391c">bLife</a> &gt;= OKLIFE )
<a name="l01244"></a>01244                                            {
<a name="l01245"></a>01245                                                       <a class="code" href="Soldier_01Control_8cpp.html#a0bf5d6769a62a4eef60702c78d13915">InternalSoldierReadyWeapon</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>, pSoldier-&gt;<a class="code" href="structSOLDIERTYPE.html#8aa6174a253c3fa21a3ec41ce0174340">bDirection</a>, FALSE );
<a name="l01246"></a>01246                                            }
<a name="l01247"></a>01247                                            <span class="keywordflow">return</span>( TRUE );
<a name="l01248"></a>01248                                     }
<a name="l01249"></a>01249                               }
<a name="l01250"></a>01250                               <span class="keywordflow">break</span>;
<a name="l01251"></a>01251 
<a name="l01252"></a>01252                         <span class="keywordflow">case</span> 473:
<a name="l01253"></a>01253 
<a name="l01254"></a>01254                               <span class="comment">// CODE: CHECK IF WE HAVE JUST JAMMED / OUT OF AMMO, DONOT CONTINUE, BUT</span>
<a name="l01255"></a>01255                               <span class="comment">// GOTO STATIONARY ANIM</span>
<a name="l01256"></a>01256                               <span class="keywordflow">if</span> ( <a class="code" href="Soldier_01Ani_8cpp.html#4a1f4a44abd2dd1e17348edff0830048">CheckForImproperFireGunEnd</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a> ) )
<a name="l01257"></a>01257                               {
<a name="l01258"></a>01258                                     <span class="keywordflow">return</span>( TRUE );
<a name="l01259"></a>01259                               }
<a name="l01260"></a>01260                               <span class="keywordflow">break</span>;
<a name="l01261"></a>01261 
<a name="l01262"></a>01262                         <span class="keywordflow">case</span> 474:
<a name="l01263"></a>01263 
<a name="l01264"></a>01264                               <span class="comment">// CODE: GETUP FROM SLEEP</span>
<a name="l01265"></a>01265                               <a class="code" href="Soldier_01Control_8cpp.html#399090c009d2c65d23138520beb3382c">ChangeSoldierStance</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>, ANIM_STAND );
<a name="l01266"></a>01266                               <span class="keywordflow">return</span>( TRUE );
<a name="l01267"></a>01267 
<a name="l01268"></a>01268                         <span class="keywordflow">case</span> 475:
<a name="l01269"></a>01269 
<a name="l01270"></a>01270                               <span class="comment">// CODE: END CLIMB DOWN ROOF</span>
<a name="l01271"></a>01271                               <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#f33459812e24af812d6439d62959709a">ubDesiredHeight</a> = ANIM_STAND;
<a name="l01272"></a>01272                               <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#13569e868936f0aabb70ab73640be218">sFinalDestination</a> = <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#2ab66ee0f37902cd448f4a738df4f2bf">sGridNo</a>;
<a name="l01273"></a>01273 
<a name="l01274"></a>01274                   <span class="comment">// re-enable sight</span>
<a name="l01275"></a>01275                   <a class="code" href="Overhead_8cpp.html#46bd754f8875c305ab18731ed10e3364">gTacticalStatus</a>.<a class="code" href="structTacticalStatusType.html#89eb954f99ad4f28b84d7cf675c8ed32">uiFlags</a> &amp;= (~DISALLOW_SIGHT);
<a name="l01276"></a>01276 
<a name="l01277"></a>01277                               <span class="comment">// ATE: Change interface level.....</span>
<a name="l01278"></a>01278                               <span class="comment">// CJC: only if we are a player merc</span>
<a name="l01279"></a>01279                               <span class="keywordflow">if</span> ( (<a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#74a40a8aaf3efe840cdaf6be62556d82">bTeam</a> == <a class="code" href="Campaign_8cpp.html#47b2067ff75193e24776eda5297400ff">gbPlayerNum</a>) &amp;&amp; !<a class="code" href="Overhead_8cpp.html#46bd754f8875c305ab18731ed10e3364">gTacticalStatus</a>.<a class="code" href="structTacticalStatusType.html#1aa7fa93044da366b9072c35e0a9b297">fAutoBandageMode</a>)
<a name="l01280"></a>01280                               {
<a name="l01281"></a>01281                                     <span class="keywordflow">if</span> ( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#18aef170576da81b10d00e7b6cd3627b">ubID</a> == <a class="code" href="Interface_01Utils_8cpp.html#07d83e717b98bc3cf6628f0bb9bc9205">gusSelectedSoldier</a> )
<a name="l01282"></a>01282                                     {
<a name="l01283"></a>01283                                           <a class="code" href="Handle_01UI_8cpp.html#ef9bff23fefbaef397d203ecdde3cb4a">ChangeInterfaceLevel</a>( 0 );
<a name="l01284"></a>01284                                     }
<a name="l01285"></a>01285                                     <span class="comment">// OK, UNSET INTERFACE FIRST</span>
<a name="l01286"></a>01286                                     <a class="code" href="Handle_01UI_8cpp.html#3ca9f7e43b153367710a1bee6c71d7bc">UnSetUIBusy</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#18aef170576da81b10d00e7b6cd3627b">ubID</a> );
<a name="l01287"></a>01287                               }
<a name="l01288"></a>01288                               <span class="keywordflow">else</span>
<a name="l01289"></a>01289                               {
<a name="l01290"></a>01290                                     <a class="code" href="ai_8h.html#59f9eb61704be305dd8baa7c476a359e">FreeUpNPCFromRoofClimb</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a> );
<a name="l01291"></a>01291                               }
<a name="l01292"></a>01292           <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#28f15074956f36e3933f6cc10647eacf">usUIMovementMode</a> = <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2eb7f92908f6f669259d971b608823d2ebb">WALKING</a>;
<a name="l01293"></a>01293 
<a name="l01294"></a>01294                               <span class="comment">// ATE: Handle sight...</span>
<a name="l01295"></a>01295                               <a class="code" href="opplist_8cpp.html#84caab6b3c04128593b43316bfdfdf43">HandleSight</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>,SIGHT_LOOK | SIGHT_RADIO | SIGHT_INTERRUPT );
<a name="l01296"></a>01296                               <span class="keywordflow">break</span>;
<a name="l01297"></a>01297 
<a name="l01298"></a>01298                         <span class="keywordflow">case</span> 476:
<a name="l01299"></a>01299 
<a name="l01300"></a>01300                               <span class="comment">// CODE: GOTO PREVIOUS ANIMATION</span>
<a name="l01301"></a>01301                               <a class="code" href="Soldier_01Control_8cpp.html#6f191e00fb4f3c5e2cbe762aa402a420">ChangeSoldierState</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>, ( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#7bf70f6f1b637647860538cd60b5399c">sPendingActionData2</a> ), (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#a69215f405f59c8085b3bb27f76893c3">uiPendingActionData1</a> + 1 ), FALSE );
<a name="l01302"></a>01302                               <span class="keywordflow">return</span>( TRUE );
<a name="l01303"></a>01303                               <span class="keywordflow">break</span>;
<a name="l01304"></a>01304 
<a name="l01305"></a>01305 
<a name="l01306"></a>01306                         <span class="keywordflow">case</span> 477:
<a name="l01307"></a>01307 
<a name="l01308"></a>01308                               <span class="comment">// CODE: Locate to target ( if an AI guy.. )</span>
<a name="l01309"></a>01309                               <span class="keywordflow">if</span> ( <a class="code" href="Overhead_8cpp.html#46bd754f8875c305ab18731ed10e3364">gTacticalStatus</a>.<a class="code" href="structTacticalStatusType.html#89eb954f99ad4f28b84d7cf675c8ed32">uiFlags</a> &amp; TURNBASED &amp;&amp; (<a class="code" href="Overhead_8cpp.html#46bd754f8875c305ab18731ed10e3364">gTacticalStatus</a>.<a class="code" href="structTacticalStatusType.html#89eb954f99ad4f28b84d7cf675c8ed32">uiFlags</a> &amp; INCOMBAT ) )
<a name="l01310"></a>01310                               {
<a name="l01311"></a>01311                                     <span class="keywordflow">if</span> ( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#74a40a8aaf3efe840cdaf6be62556d82">bTeam</a> != <a class="code" href="Campaign_8cpp.html#47b2067ff75193e24776eda5297400ff">gbPlayerNum</a> )
<a name="l01312"></a>01312                                     {
<a name="l01313"></a>01313                                           <span class="comment">// only locate if the enemy is visible or he's aiming at a player</span>
<a name="l01314"></a>01314                                           <span class="keywordflow">if</span> ( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#73246323764393ce2a5ece7fcb7b7cf8">bVisible</a> != -1 || (<a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#f9fbe88de500cfce55e233298ada29e4">ubTargetID</a> != NOBODY &amp;&amp; <a class="code" href="Overhead_8cpp.html#2b9a828d7d92ec404b2f9a39fc001177">MercPtrs</a>[ <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#f9fbe88de500cfce55e233298ada29e4">ubTargetID</a> ]-&gt;bTeam == <a class="code" href="Campaign_8cpp.html#47b2067ff75193e24776eda5297400ff">gbPlayerNum</a>) )
<a name="l01315"></a>01315                                           {
<a name="l01316"></a>01316                                                 <a class="code" href="Overhead_8cpp.html#b5f9e9e7ce81539227c772e653fc7775">LocateGridNo</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#97fff971b8c532135f0c0451deac7aa1">sTargetGridNo</a> );
<a name="l01317"></a>01317                                           }
<a name="l01318"></a>01318                                     }
<a name="l01319"></a>01319                               }
<a name="l01320"></a>01320                               <span class="keywordflow">break</span>;
<a name="l01321"></a>01321 
<a name="l01322"></a>01322                         <span class="keywordflow">case</span> 478:
<a name="l01323"></a>01323 
<a name="l01324"></a>01324                               <span class="comment">// CODE: Decide to turn from hit.......</span>
<a name="l01325"></a>01325                               {
<a name="l01326"></a>01326                                     <a class="code" href="Types_8h.html#7ebe70ceca856797319175e30bcf003d">INT8</a>        bNewDirection;
<a name="l01327"></a>01327                                     <a class="code" href="Types_8h.html#e1e6edbbc26d6fbc71a90190d0266018">UINT32</a>      uiChance;
<a name="l01328"></a>01328 
<a name="l01329"></a>01329                                     <span class="comment">// ONLY DO THIS IF CERTAIN CONDITIONS ARISE!</span>
<a name="l01330"></a>01330                                     <span class="comment">// For one, only do for mercs!</span>
<a name="l01331"></a>01331                                     <span class="keywordflow">if</span> ( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#b082364eed3d7883662f69e1fd96be1a">ubBodyType</a> &lt;= <a class="code" href="Animation_01Data_8h.html#d295a916825180b548473dec560093a7040d5c40e76c4103ced101507f96e2f6">REGFEMALE</a> )
<a name="l01332"></a>01332                                     {
<a name="l01333"></a>01333                                           <span class="comment">// Secondly, don't if we are going to collapse</span>
<a name="l01334"></a>01334                                           <span class="keywordflow">if</span> ( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#e308dea18533bf5ab2bcee5bbe27391c">bLife</a> &gt;= OKLIFE &amp;&amp; <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#2a44d10fbcd1df19ba5bdbb4c1e60a38">bBreath</a> &gt; 0 &amp;&amp; <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#0d1f73c5d0ac839ec84a4792505949cb">bLevel</a> == 0 )
<a name="l01335"></a>01335                                           {
<a name="l01336"></a>01336                                                 <span class="comment">// Save old direction</span>
<a name="l01337"></a>01337                                                 <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#a69215f405f59c8085b3bb27f76893c3">uiPendingActionData1</a> = <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#8aa6174a253c3fa21a3ec41ce0174340">bDirection</a>;
<a name="l01338"></a>01338 
<a name="l01339"></a>01339                                                 <span class="comment">// If we got a head shot...more chance of turning...</span>
<a name="l01340"></a>01340                                                 <span class="keywordflow">if</span> ( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#7ab073a5de1107c78c239fd45e891b59">ubHitLocation</a> != AIM_SHOT_HEAD )
<a name="l01341"></a>01341                                                 {
<a name="l01342"></a>01342                                                       uiChance = <a class="code" href="Random_8cpp.html#49f938d1313ab6ef09ac6223a16ac334">Random</a>( 100 );
<a name="l01343"></a>01343 
<a name="l01344"></a>01344                                                       <span class="comment">// 30 % chance to change direction one way</span>
<a name="l01345"></a>01345                                                       <span class="keywordflow">if</span> ( uiChance  &lt; 30 )
<a name="l01346"></a>01346                                                       {
<a name="l01347"></a>01347                                                             bNewDirection = <a class="code" href="Isometric_01Utils_8cpp.html#9eb8f6ae368802136cc76853785f4427">gOneCDirection</a>[ <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#8aa6174a253c3fa21a3ec41ce0174340">bDirection</a> ];
<a name="l01348"></a>01348                                                       }
<a name="l01349"></a>01349                                                       <span class="comment">// 30 % chance to change direction the other way</span>
<a name="l01350"></a>01350                                                       <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( uiChance &gt;= 30 &amp;&amp; uiChance &lt; 60 )
<a name="l01351"></a>01351                                                       {
<a name="l01352"></a>01352                                                             bNewDirection = <a class="code" href="Isometric_01Utils_8cpp.html#0d4cbf37dd55fdc31594389f4ea65909">gOneCCDirection</a>[ <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#8aa6174a253c3fa21a3ec41ce0174340">bDirection</a> ];
<a name="l01353"></a>01353                                                       }
<a name="l01354"></a>01354                                                       <span class="comment">// 30 % normal....</span>
<a name="l01355"></a>01355                                                       <span class="keywordflow">else</span>
<a name="l01356"></a>01356                                                       {
<a name="l01357"></a>01357                                                             bNewDirection = <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#8aa6174a253c3fa21a3ec41ce0174340">bDirection</a>;
<a name="l01358"></a>01358                                                       }
<a name="l01359"></a>01359 
<a name="l01360"></a>01360                                                       <a class="code" href="Soldier_01Control_8cpp.html#1117087649d17ca4dfc078c0947e7f09">EVENT_SetSoldierDirection</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>, bNewDirection );
<a name="l01361"></a>01361                                                       <a class="code" href="Soldier_01Control_8cpp.html#019f893295bb96f48261ded184a17cab">EVENT_SetSoldierDesiredDirection</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>, <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#8aa6174a253c3fa21a3ec41ce0174340">bDirection</a> );
<a name="l01362"></a>01362 
<a name="l01363"></a>01363                                                 }
<a name="l01364"></a>01364                                                 <span class="keywordflow">else</span>
<a name="l01365"></a>01365                                                 {
<a name="l01366"></a>01366                                                       <span class="comment">// OK, 50% chance here to turn...</span>
<a name="l01367"></a>01367                                                       uiChance = <a class="code" href="Random_8cpp.html#49f938d1313ab6ef09ac6223a16ac334">Random</a>( 100 );
<a name="l01368"></a>01368 
<a name="l01369"></a>01369                                                       <span class="keywordflow">if</span> ( uiChance &lt; 50 ) 
<a name="l01370"></a>01370                                                       {
<a name="l01371"></a>01371                                                             <span class="comment">// OK, pick a larger direction to goto....</span>
<a name="l01372"></a>01372                                                             <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#eb633099940bc20ff5a969bce84eab42">uiStatusFlags</a> |= SOLDIER_TURNINGFROMHIT;
<a name="l01373"></a>01373 
<a name="l01374"></a>01374                                                             <span class="comment">// Pick evenly between both</span>
<a name="l01375"></a>01375                                                             <span class="keywordflow">if</span> ( <a class="code" href="Random_8cpp.html#49f938d1313ab6ef09ac6223a16ac334">Random</a>( 50 ) &lt; 25 )
<a name="l01376"></a>01376                                                             {
<a name="l01377"></a>01377                                                                   bNewDirection = <a class="code" href="Isometric_01Utils_8cpp.html#9eb8f6ae368802136cc76853785f4427">gOneCDirection</a>[ <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#8aa6174a253c3fa21a3ec41ce0174340">bDirection</a> ];
<a name="l01378"></a>01378                                                                   bNewDirection = <a class="code" href="Isometric_01Utils_8cpp.html#9eb8f6ae368802136cc76853785f4427">gOneCDirection</a>[ bNewDirection ];
<a name="l01379"></a>01379                                                                   bNewDirection = <a class="code" href="Isometric_01Utils_8cpp.html#9eb8f6ae368802136cc76853785f4427">gOneCDirection</a>[ bNewDirection ];
<a name="l01380"></a>01380                                                             }
<a name="l01381"></a>01381                                                             <span class="keywordflow">else</span>
<a name="l01382"></a>01382                                                             {
<a name="l01383"></a>01383                                                                   bNewDirection = <a class="code" href="Isometric_01Utils_8cpp.html#0d4cbf37dd55fdc31594389f4ea65909">gOneCCDirection</a>[ <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#8aa6174a253c3fa21a3ec41ce0174340">bDirection</a> ];
<a name="l01384"></a>01384                                                                   bNewDirection = <a class="code" href="Isometric_01Utils_8cpp.html#0d4cbf37dd55fdc31594389f4ea65909">gOneCCDirection</a>[ bNewDirection ];
<a name="l01385"></a>01385                                                                   bNewDirection = <a class="code" href="Isometric_01Utils_8cpp.html#0d4cbf37dd55fdc31594389f4ea65909">gOneCCDirection</a>[ bNewDirection ];
<a name="l01386"></a>01386                                                             }
<a name="l01387"></a>01387 
<a name="l01388"></a>01388                                                             <a class="code" href="Soldier_01Control_8cpp.html#019f893295bb96f48261ded184a17cab">EVENT_SetSoldierDesiredDirection</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>, bNewDirection );
<a name="l01389"></a>01389                                                       }                                   
<a name="l01390"></a>01390                                                 }
<a name="l01391"></a>01391                                           }                                         
<a name="l01392"></a>01392                                     }
<a name="l01393"></a>01393                                     <span class="keywordflow">break</span>;
<a name="l01394"></a>01394                               }
<a name="l01395"></a>01395 
<a name="l01396"></a>01396                         <span class="keywordflow">case</span> 479:
<a name="l01397"></a>01397       
<a name="l01398"></a>01398                                     <span class="comment">// CODE: Return to old direction......</span>
<a name="l01399"></a>01399                                     <span class="keywordflow">if</span> ( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#b082364eed3d7883662f69e1fd96be1a">ubBodyType</a> &lt;= <a class="code" href="Animation_01Data_8h.html#d295a916825180b548473dec560093a7040d5c40e76c4103ced101507f96e2f6">REGFEMALE</a> )
<a name="l01400"></a>01400                                     {
<a name="l01401"></a>01401                                           <span class="comment">// Secondly, don't if we are going to collapse</span>
<a name="l01402"></a>01402                                           <span class="comment">//if ( pSoldier-&gt;bLife &gt;= OKLIFE &amp;&amp; pSoldier-&gt;bBreath &gt; 0 )</span>
<a name="l01403"></a>01403                                           <span class="comment">//{</span><span class="comment"></span>
<a name="l01404"></a>01404 <span class="comment">                                          ///   if ( !( pSoldier-&gt;uiStatusFlags &amp; SOLDIER_TURNINGFROMHIT ) )</span>
<a name="l01405"></a>01405 <span class="comment"></span>                                          <span class="comment">//    {</span><span class="comment"></span>
<a name="l01406"></a>01406 <span class="comment">                                          ///         pSoldier-&gt;bDirection                      = (INT8)pSoldier-&gt;uiPendingActionData1;</span>
<a name="l01407"></a>01407 <span class="comment"></span>                                          <span class="comment">//          pSoldier-&gt;bDesiredDirection = (INT8)pSoldier-&gt;uiPendingActionData1;</span>
<a name="l01408"></a>01408                                           <span class="comment">//    }</span>
<a name="l01409"></a>01409                                           <span class="comment">//}</span>
<a name="l01410"></a>01410                                     }
<a name="l01411"></a>01411                                     <span class="keywordflow">break</span>;
<a name="l01412"></a>01412 
<a name="l01413"></a>01413                         <span class="keywordflow">case</span> 480:
<a name="l01414"></a>01414 
<a name="l01415"></a>01415                               <span class="comment">// CODE: FORCE FREE ATTACKER</span>
<a name="l01416"></a>01416                               <span class="comment">// Release attacker</span>
<a name="l01417"></a>01417                               DebugMsg( <a class="code" href="DEBUG_8cpp.html#a7985c2fd033797fc67a03b2c26e07c6">TOPIC_JA2</a>, DBG_LEVEL_3, <a class="code" href="DEBUG_8cpp.html#88565bf27eec0b2003eb5bc9426b8e4b">String</a>(<span class="stringliteral">"@@@@@@@ Releasesoldierattacker, code 480"</span>) );
<a name="l01418"></a>01418 
<a name="l01419"></a>01419                               <a class="code" href="Soldier_01Control_8cpp.html#ffdbb2d52e0bf2a7f9fe3559bdcf0ffb">ReleaseSoldiersAttacker</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a> );
<a name="l01420"></a>01420 
<a name="l01421"></a>01421                               <span class="comment">//FREEUP GETTING HIT FLAG</span>
<a name="l01422"></a>01422                               <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#d20eefbafd8613a5772ddb8eb384fc71">fGettingHit</a> = FALSE;
<a name="l01423"></a>01423                               <span class="keywordflow">break</span>;
<a name="l01424"></a>01424                   
<a name="l01425"></a>01425                         <span class="keywordflow">case</span> 481:
<a name="l01426"></a>01426 
<a name="l01427"></a>01427                               <span class="comment">// CODE: CUT FENCE...</span>
<a name="l01428"></a>01428                               <a class="code" href="Structure_01Wrap_8cpp.html#68d3c0d615a0545fe9bc470dc2f3d6b8">CutWireFence</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#97fff971b8c532135f0c0451deac7aa1">sTargetGridNo</a> );
<a name="l01429"></a>01429                               <span class="keywordflow">break</span>;
<a name="l01430"></a>01430 
<a name="l01431"></a>01431                         <span class="keywordflow">case</span> 482:
<a name="l01432"></a>01432 
<a name="l01433"></a>01433                               <span class="comment">// CODE: END CRIPPLE KICKOUT...</span>
<a name="l01434"></a>01434                               <a class="code" href="Soldier_01Ani_8cpp.html#e45c413ed609ec330c7ebfb712f9c6b0">KickOutWheelchair</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a> );
<a name="l01435"></a>01435                               <span class="keywordflow">break</span>;
<a name="l01436"></a>01436 
<a name="l01437"></a>01437                         <span class="keywordflow">case</span> 483:
<a name="l01438"></a>01438 
<a name="l01439"></a>01439                               <span class="comment">// CODE: HANDLE DROP BOMB...</span>
<a name="l01440"></a>01440                               <a class="code" href="Handle_01Items_8cpp.html#9cd3f682a2c690da88d055dee14f229a">HandleSoldierDropBomb</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>, <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#7bf70f6f1b637647860538cd60b5399c">sPendingActionData2</a> );
<a name="l01441"></a>01441                               <span class="keywordflow">break</span>;
<a name="l01442"></a>01442 
<a name="l01443"></a>01443                         <span class="keywordflow">case</span> 484:
<a name="l01444"></a>01444 
<a name="l01445"></a>01445                               <span class="comment">// CODE: HANDLE REMOTE...</span>
<a name="l01446"></a>01446                               <a class="code" href="Handle_01Items_8cpp.html#5271c7468e2488cb83518cd367e10702">HandleSoldierUseRemote</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>, <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#7bf70f6f1b637647860538cd60b5399c">sPendingActionData2</a> );
<a name="l01447"></a>01447                               <span class="keywordflow">break</span>;
<a name="l01448"></a>01448 
<a name="l01449"></a>01449                         <span class="keywordflow">case</span> 485:
<a name="l01450"></a>01450 
<a name="l01451"></a>01451                               <span class="comment">// CODE: Try steal.....</span>
<a name="l01452"></a>01452                               <a class="code" href="Weapons_8cpp.html#901bff3310e2db93001e37268287d2a9">UseHandToHand</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>, <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#7bf70f6f1b637647860538cd60b5399c">sPendingActionData2</a>, TRUE );
<a name="l01453"></a>01453                               <span class="comment">//jackaians:</span>
<a name="l01454"></a>01454                               <span class="comment">//if we are not waiting for the pickup menu to be displayed</span>
<a name="l01455"></a>01455                               <span class="keywordflow">if</span> (<a class="code" href="Handle_01UI_8cpp.html#c1a811228f6db879e9c1d67b68651a1b">guiPendingOverrideEvent</a> != <a class="code" href="Handle_01UI_8h.html#af14d9a15c91cd740ff202b6335e405e262169b5107bab7d6238f916d550a0cd">G_GETTINGITEM</a>)
<a name="l01456"></a>01456                               {
<a name="l01457"></a>01457                                     <a class="code" href="Handle_01UI_8cpp.html#1a7cc8e3706f8f46d7c1212a41340dbe">PreventFromTheFreezingBug</a>(<a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>);
<a name="l01458"></a>01458                               }
<a name="l01459"></a>01459                               <span class="keywordflow">break</span>;
<a name="l01460"></a>01460 
<a name="l01461"></a>01461                         <span class="keywordflow">case</span> 486:
<a name="l01462"></a>01462 
<a name="l01463"></a>01463                               <span class="comment">// CODE: GIVE ITEM</span>
<a name="l01464"></a>01464                               <a class="code" href="Handle_01Items_8cpp.html#cdd019d685eabf074358928539a5e75f">SoldierGiveItemFromAnimation</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a> );
<a name="l01465"></a>01465                               <span class="keywordflow">if</span> (<a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#5a5648a1bb3507cc41f6be199c51a3f8">ubProfile</a> != NO_PROFILE &amp;&amp; <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#5a5648a1bb3507cc41f6be199c51a3f8">ubProfile</a> &gt;= FIRST_NPC )
<a name="l01466"></a>01466                               {
<a name="l01467"></a>01467                                     <a class="code" href="NPC_8cpp.html#d7f92a649ae364cf3c2b7b69c4806bd0">TriggerNPCWithGivenApproach</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#5a5648a1bb3507cc41f6be199c51a3f8">ubProfile</a>, <a class="code" href="NPC_8h.html#fe4ba80db4eca5533465fe913160a13a65b98756dc08fdc1a8cd7210e1e457a1">APPROACH_DONE_GIVING_ITEM</a>, FALSE );
<a name="l01468"></a>01468                               }
<a name="l01469"></a>01469                               <span class="keywordflow">break</span>;
<a name="l01470"></a>01470 
<a name="l01471"></a>01471                         <span class="keywordflow">case</span> 487:
<a name="l01472"></a>01472 
<a name="l01473"></a>01473                               <span class="comment">// CODE: DROP ITEM</span>
<a name="l01474"></a>01474                               <a class="code" href="Handle_01Items_8cpp.html#549d99e2966b380fda3c7b440f0aa9b9">SoldierHandleDropItem</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a> );
<a name="l01475"></a>01475                               <span class="keywordflow">break</span>;
<a name="l01476"></a>01476 
<a name="l01477"></a>01477                         <span class="keywordflow">case</span> 489:
<a name="l01478"></a>01478 
<a name="l01479"></a>01479 
<a name="l01480"></a>01480                               <span class="comment">//CODE: REMOVE GUY FRMO WORLD DUE TO EXPLOSION</span>
<a name="l01481"></a>01481                               <span class="comment">//ChangeSoldierState( pSoldier, RAISE_RIFLE, 0 , FALSE );</span>
<a name="l01482"></a>01482                               <span class="comment">//return( TRUE );</span>
<a name="l01483"></a>01483                               <span class="comment">//Delete guy</span>
<a name="l01484"></a>01484                               <span class="comment">//TacticalRemoveSoldier( pSoldier-&gt;ubID );</span>
<a name="l01485"></a>01485                               <span class="comment">//return( FALSE );</span>
<a name="l01486"></a>01486                               <span class="keywordflow">break</span>;
<a name="l01487"></a>01487 
<a name="l01488"></a>01488                         <span class="keywordflow">case</span> 490:
<a name="l01489"></a>01489 
<a name="l01490"></a>01490                               <span class="comment">// CODE: HANDLE END ITEM PICKUP</span>
<a name="l01491"></a>01491                               <span class="comment">//LOOK INTO HAND, RAISE RIFLE IF WE HAVE ONE....</span>
<a name="l01492"></a>01492                               <span class="comment">/*</span>
<a name="l01493"></a>01493 <span class="comment">                              if ( pSoldier-&gt;inv[ HANDPOS ].usItem != NOTHING )</span>
<a name="l01494"></a>01494 <span class="comment">                              {     </span>
<a name="l01495"></a>01495 <span class="comment">                                    // CHECK IF GUN</span>
<a name="l01496"></a>01496 <span class="comment">                                    if ( Item[ pSoldier-&gt;inv[ HANDPOS ].usItem ].usItemClass == IC_GUN )</span>
<a name="l01497"></a>01497 <span class="comment">                                    {</span>
<a name="l01498"></a>01498 <span class="comment">                                          if ( Weapon[ pSoldier-&gt;inv[ HANDPOS ].usItem ].ubWeaponClass != HANDGUNCLASS )</span>
<a name="l01499"></a>01499 <span class="comment">                                          {</span>
<a name="l01500"></a>01500 <span class="comment">                                                // RAISE</span>
<a name="l01501"></a>01501 <span class="comment">                                                ChangeSoldierState( pSoldier, RAISE_RIFLE, 0 , FALSE );</span>
<a name="l01502"></a>01502 <span class="comment">                                                return( TRUE );</span>
<a name="l01503"></a>01503 <span class="comment">                                          }</span>
<a name="l01504"></a>01504 <span class="comment"></span>
<a name="l01505"></a>01505 <span class="comment">                                    }</span>
<a name="l01506"></a>01506 <span class="comment"></span>
<a name="l01507"></a>01507 <span class="comment">                              }</span>
<a name="l01508"></a>01508 <span class="comment">                              */</span>
<a name="l01509"></a>01509                               <span class="keywordflow">break</span>;
<a name="l01510"></a>01510 
<a name="l01511"></a>01511                         <span class="keywordflow">case</span> 491:
<a name="l01512"></a>01512 
<a name="l01513"></a>01513                               <span class="comment">// CODE: HANDLE RANDOM BREATH ANIMATION</span>
<a name="l01514"></a>01514                               <span class="comment">//if ( pSoldier-&gt;bLife &gt; INJURED_CHANGE_THREASHOLD )</span>
<a name="l01515"></a>01515                               <span class="keywordflow">if</span> ( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#e308dea18533bf5ab2bcee5bbe27391c">bLife</a> &gt;= OKLIFE )
<a name="l01516"></a>01516                               {
<a name="l01517"></a>01517                                     <span class="comment">// Increment time from last update</span>
<a name="l01518"></a>01518                                     <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#39e7d76a800631392bbd05b111d1ff84">uiTimeOfLastRandomAction</a>++;
<a name="l01519"></a>01519 
<a name="l01520"></a>01520                                     <span class="keywordflow">if</span> ( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#39e7d76a800631392bbd05b111d1ff84">uiTimeOfLastRandomAction</a> &gt; TIME_FOR_RANDOM_ANIM_CHECK || <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#e308dea18533bf5ab2bcee5bbe27391c">bLife</a> &lt; INJURED_CHANGE_THREASHOLD || <a class="code" href="Drugs_01And_01Alcohol_8cpp.html#01ef796ca28c951d7baafb1e6fd02ebf">GetDrunkLevel</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a> ) &gt;= BORDERLINE )
<a name="l01521"></a>01521                                     {
<a name="l01522"></a>01522                                           <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#39e7d76a800631392bbd05b111d1ff84">uiTimeOfLastRandomAction</a> = 0;
<a name="l01523"></a>01523 
<a name="l01524"></a>01524                                           <span class="comment">// Don't do any in water!</span>
<a name="l01525"></a>01525                                           <span class="keywordflow">if</span> ( !<a class="code" href="Soldier_01Control_8cpp.html#136730f4d5bc849d712446b0b871205a">MercInWater</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a> ) )
<a name="l01526"></a>01526                                           {
<a name="l01527"></a>01527                                                 <span class="comment">// OK, make a dice roll</span>
<a name="l01528"></a>01528                                                 ubDiceRoll = (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)<a class="code" href="Random_8cpp.html#49f938d1313ab6ef09ac6223a16ac334">Random</a>( 100 );
<a name="l01529"></a>01529 
<a name="l01530"></a>01530                                                 <span class="comment">// Determine what is in our hand;</span>
<a name="l01531"></a>01531                                                 usItem = <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#13c875b952b6d634680165d127a9870b">inv</a>[ <a class="code" href="Soldier_01Control_8h.html#2a5937706f1724c8f06a0396bdc87855408e678e638d95e18d5e9a2a64a96e2e">HANDPOS</a> ].<a class="code" href="structOBJECTTYPE.html#4fbe05335f161f08f354566b8e5a0a19">usItem</a>;
<a name="l01532"></a>01532 
<a name="l01533"></a>01533                                                 <span class="comment">// Default to nothing in hand ( nothing in quotes, we do have something but not just visible )</span>
<a name="l01534"></a>01534                                                 ubRandomHandIndex = RANDOM_ANIM_NOTHINGINHAND;
<a name="l01535"></a>01535 
<a name="l01536"></a>01536                                                 <span class="keywordflow">if</span> ( usItem != NOTHING )
<a name="l01537"></a>01537                                                 {
<a name="l01538"></a>01538                                                       <span class="keywordflow">if</span> ( <a class="code" href="Item_01Types_8h.html#f9dc4cc7a3a99ad5944940cfb7c82237">Item</a>[ usItem ].usItemClass == IC_GUN )
<a name="l01539"></a>01539                                                       {
<a name="l01540"></a>01540 <span class="comment">//                                                          if ( (Item[ usItem ].fFlags &amp; ITEM_TWO_HANDED) )</span>
<a name="l01541"></a>01541                                                             <span class="keywordflow">if</span> ( (<a class="code" href="Item_01Types_8h.html#f9dc4cc7a3a99ad5944940cfb7c82237">Item</a>[ usItem ].twohanded ) )
<a name="l01542"></a>01542                                                             {
<a name="l01543"></a>01543                                                                   <span class="comment">// Set to rifle</span>
<a name="l01544"></a>01544                                                                   ubRandomHandIndex = RANDOM_ANIM_RIFLEINHAND;
<a name="l01545"></a>01545                                                             }
<a name="l01546"></a>01546                                                             <span class="keywordflow">else</span>
<a name="l01547"></a>01547                                                             {
<a name="l01548"></a>01548                                                                   <span class="comment">// Don't EVER do a trivial anim...</span>
<a name="l01549"></a>01549                                                                   <span class="keywordflow">break</span>;
<a name="l01550"></a>01550                                                             }
<a name="l01551"></a>01551                                                       }
<a name="l01552"></a>01552                                                 }
<a name="l01553"></a>01553 
<a name="l01554"></a>01554                                                 <span class="comment">// Check which animation to play....</span>
<a name="l01555"></a>01555                                                 <span class="keywordflow">for</span> ( cnt = 0; cnt &lt; MAX_RANDOM_ANIMS_PER_BODYTYPE; cnt++ )
<a name="l01556"></a>01556                                                 {
<a name="l01557"></a>01557                                                       pAnimDef = &amp;( <a class="code" href="Animation_01Control_8cpp.html#3ccc7f70edb00264699bc1dfa3ccadc7">gRandomAnimDefs</a>[ <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#b082364eed3d7883662f69e1fd96be1a">ubBodyType</a> ][ cnt ] );
<a name="l01558"></a>01558 
<a name="l01559"></a>01559                                                       <a class="code" href="Soldier_01Ani_8cpp.html#c294aa65f0375eb6343a2de2a25dafcc">if</a> ( pAnimDef-&gt;<a class="code" href="structRANDOM__ANI__DEF.html#dd076b70710e4dac391925b8fd63efa4">sAnimID</a>  != 0 )
<a name="l01560"></a>01560                                                       {
<a name="l01561"></a>01561                                                             <span class="comment">// If it's an injured animation and we are not in the threashold....</span>
<a name="l01562"></a>01562                                                             <a class="code" href="Soldier_01Ani_8cpp.html#c294aa65f0375eb6343a2de2a25dafcc">if</a> ( ( pAnimDef-&gt;<a class="code" href="structRANDOM__ANI__DEF.html#ff821237c848e7ae04981e7225bc9cd6">ubFlags</a> &amp; RANDOM_ANIM_INJURED ) &amp;&amp; <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#e308dea18533bf5ab2bcee5bbe27391c">bLife</a> &gt;= INJURED_CHANGE_THREASHOLD )
<a name="l01563"></a>01563                                                             {
<a name="l01564"></a>01564                                                                   <span class="keywordflow">continue</span>;
<a name="l01565"></a>01565                                                             }
<a name="l01566"></a>01566 
<a name="l01567"></a>01567                                                             <span class="comment">// If we need to do an injured one, don't do any others...</span>
<a name="l01568"></a>01568                                                             <span class="keywordflow">if</span> ( !( pAnimDef-&gt;<a class="code" href="structRANDOM__ANI__DEF.html#ff821237c848e7ae04981e7225bc9cd6">ubFlags</a> &amp; RANDOM_ANIM_INJURED ) &amp;&amp; <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#e308dea18533bf5ab2bcee5bbe27391c">bLife</a> &lt; INJURED_CHANGE_THREASHOLD )
<a name="l01569"></a>01569                                                             {
<a name="l01570"></a>01570                                                                   <span class="keywordflow">continue</span>;
<a name="l01571"></a>01571                                                             }
<a name="l01572"></a>01572 
<a name="l01573"></a>01573                                                             <span class="comment">// If it's a drunk animation and we are not in the threashold....</span>
<a name="l01574"></a>01574                                                             <span class="keywordflow">if</span> ( ( pAnimDef-&gt;<a class="code" href="structRANDOM__ANI__DEF.html#ff821237c848e7ae04981e7225bc9cd6">ubFlags</a> &amp; RANDOM_ANIM_DRUNK ) &amp;&amp; <a class="code" href="Drugs_01And_01Alcohol_8cpp.html#01ef796ca28c951d7baafb1e6fd02ebf">GetDrunkLevel</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a> ) &lt; BORDERLINE )
<a name="l01575"></a>01575                                                             {
<a name="l01576"></a>01576                                                                   <span class="keywordflow">continue</span>;
<a name="l01577"></a>01577                                                             }
<a name="l01578"></a>01578 
<a name="l01579"></a>01579                                                             <span class="comment">// If we need to do an injured one, don't do any others...</span>
<a name="l01580"></a>01580                                                             <span class="keywordflow">if</span> ( !( pAnimDef-&gt;<a class="code" href="structRANDOM__ANI__DEF.html#ff821237c848e7ae04981e7225bc9cd6">ubFlags</a> &amp; RANDOM_ANIM_DRUNK ) &amp;&amp; <a class="code" href="Drugs_01And_01Alcohol_8cpp.html#01ef796ca28c951d7baafb1e6fd02ebf">GetDrunkLevel</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a> ) &gt;= BORDERLINE )
<a name="l01581"></a>01581                                                             {
<a name="l01582"></a>01582                                                                   <span class="keywordflow">continue</span>;
<a name="l01583"></a>01583                                                             }
<a name="l01584"></a>01584 
<a name="l01585"></a>01585                                                             <span class="comment">// Check if it's our hand</span>
<a name="l01586"></a>01586                                                             <span class="keywordflow">if</span> ( pAnimDef-&gt;<a class="code" href="structRANDOM__ANI__DEF.html#8f272a14171b57909b2d325890b35ce3">ubHandRestriction</a> != RANDOM_ANIM_IRRELEVENTINHAND &amp;&amp; pAnimDef-&gt;<a class="code" href="structRANDOM__ANI__DEF.html#8f272a14171b57909b2d325890b35ce3">ubHandRestriction</a> != ubRandomHandIndex )
<a name="l01587"></a>01587                                                             {
<a name="l01588"></a>01588                                                                   <span class="keywordflow">continue</span>;
<a name="l01589"></a>01589                                                             }
<a name="l01590"></a>01590 
<a name="l01591"></a>01591                                                             <span class="comment">// Check if it's casual and we're in combat and it's not our guy</span>
<a name="l01592"></a>01592                                                             <span class="keywordflow">if</span> ( ( pAnimDef-&gt;<a class="code" href="structRANDOM__ANI__DEF.html#ff821237c848e7ae04981e7225bc9cd6">ubFlags</a> &amp; RANDOM_ANIM_CASUAL ) )
<a name="l01593"></a>01593                                                             {
<a name="l01594"></a>01594                                                                   <span class="comment">// If he's a bad guy, do not do it!</span>
<a name="l01595"></a>01595                                                                   <a class="code" href="Soldier_01Ani_8cpp.html#c294aa65f0375eb6343a2de2a25dafcc">if</a> ( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#74a40a8aaf3efe840cdaf6be62556d82">bTeam</a> != <a class="code" href="Campaign_8cpp.html#47b2067ff75193e24776eda5297400ff">gbPlayerNum</a>  || ( <a class="code" href="Overhead_8cpp.html#46bd754f8875c305ab18731ed10e3364">gTacticalStatus</a>.<a class="code" href="structTacticalStatusType.html#89eb954f99ad4f28b84d7cf675c8ed32">uiFlags</a> &amp; INCOMBAT ) )
<a name="l01596"></a>01596                                                                   {
<a name="l01597"></a>01597                                                                         <span class="keywordflow">continue</span>;
<a name="l01598"></a>01598                                                                   }
<a name="l01599"></a>01599                                                             }
<a name="l01600"></a>01600 
<a name="l01601"></a>01601                                                             <span class="comment">// If we are an alternate big guy and have been told to use a normal big merc ani...</span>
<a name="l01602"></a>01602                                                             <span class="keywordflow">if</span> ( ( pAnimDef-&gt;<a class="code" href="structRANDOM__ANI__DEF.html#ff821237c848e7ae04981e7225bc9cd6">ubFlags</a> &amp; RANDOM_ANIM_FIRSTBIGMERC ) &amp;&amp; ( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#f4903bdb3f290855c89afc2c2ee2853b">uiAnimSubFlags</a> &amp; SUB_ANIM_BIGGUYTHREATENSTANCE ) )
<a name="l01603"></a>01603                                                             {
<a name="l01604"></a>01604                                                                   <span class="keywordflow">continue</span>;
<a name="l01605"></a>01605                                                             }
<a name="l01606"></a>01606 
<a name="l01607"></a>01607                                                             <span class="comment">// If we are a normal big guy and have been told to use an alternate big merc ani...</span>
<a name="l01608"></a>01608                                                             <span class="keywordflow">if</span> ( ( pAnimDef-&gt;<a class="code" href="structRANDOM__ANI__DEF.html#ff821237c848e7ae04981e7225bc9cd6">ubFlags</a> &amp; RANDOM_ANIM_SECONDBIGMERC ) &amp;&amp; !( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#f4903bdb3f290855c89afc2c2ee2853b">uiAnimSubFlags</a> &amp; SUB_ANIM_BIGGUYTHREATENSTANCE ) )
<a name="l01609"></a>01609                                                             {
<a name="l01610"></a>01610                                                                   <span class="keywordflow">continue</span>;
<a name="l01611"></a>01611                                                             }
<a name="l01612"></a>01612 
<a name="l01613"></a>01613                                                             <span class="comment">// Check if it's the proper height</span>
<a name="l01614"></a>01614                                                             <span class="keywordflow">if</span> ( pAnimDef-&gt;ubAnimHeight == <a class="code" href="Animation_01Control_8cpp.html#633440a87c34a25c700ce620db87d036">gAnimControl</a>[ <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#1f73b62a5ea0dd26fa1bec1d9f522b41">usAnimState</a> ].ubEndHeight )
<a name="l01615"></a>01615                                                             {
<a name="l01616"></a>01616                                                                   <span class="comment">// OK, If we rolled a value that lies within the range for this random animation, use this one!</span>
<a name="l01617"></a>01617                                                                   <a class="code" href="Soldier_01Ani_8cpp.html#c294aa65f0375eb6343a2de2a25dafcc">if</a> ( ubDiceRoll &gt;= pAnimDef-&gt;ubStartRoll &amp;&amp; ubDiceRoll &lt;= pAnimDef-&gt;ubEndRoll )
<a name="l01618"></a>01618                                                                   {
<a name="l01619"></a>01619                                                                         <span class="comment">// Are we playing a sound</span>
<a name="l01620"></a>01620                                                                         <a class="code" href="Soldier_01Ani_8cpp.html#c294aa65f0375eb6343a2de2a25dafcc">if</a> ( pAnimDef-&gt;sAnimID == RANDOM_ANIM_SOUND )
<a name="l01621"></a>01621                                                                         {
<a name="l01622"></a>01622                           <a class="code" href="Soldier_01Ani_8cpp.html#c294aa65f0375eb6343a2de2a25dafcc">if</a> ( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#b082364eed3d7883662f69e1fd96be1a">ubBodyType</a> == <a class="code" href="Animation_01Data_8h.html#d295a916825180b548473dec560093a748505ba252c1ec37e34d882e6f4a3ecf">COW</a> )
<a name="l01623"></a>01623                           {
<a name="l01624"></a>01624                             <a class="code" href="Soldier_01Ani_8cpp.html#c294aa65f0375eb6343a2de2a25dafcc">if</a> ( <a class="code" href="Random_8cpp.html#49f938d1313ab6ef09ac6223a16ac334">Random</a>( 2 ) == 1 )
<a name="l01625"></a>01625                             {
<a name="l01626"></a>01626                               <span class="keywordflow">if</span> ( ( <a class="code" href="Overhead_8cpp.html#46bd754f8875c305ab18731ed10e3364">gTacticalStatus</a>.<a class="code" href="structTacticalStatusType.html#89eb954f99ad4f28b84d7cf675c8ed32">uiFlags</a> &amp; INCOMBAT ) &amp;&amp; <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#73246323764393ce2a5ece7fcb7b7cf8">bVisible</a> == -1 )
<a name="l01627"></a>01627                               {
<a name="l01628"></a>01628                                 <span class="comment">// DO this every 10th time or so...</span>
<a name="l01629"></a>01629                                 <a class="code" href="Soldier_01Ani_8cpp.html#c294aa65f0375eb6343a2de2a25dafcc">if</a> ( <a class="code" href="Random_8cpp.html#49f938d1313ab6ef09ac6223a16ac334">Random</a>( 100 ) &lt; 10 )
<a name="l01630"></a>01630                                 {
<a name="l01631"></a>01631                                                                                       <span class="comment">// Play sound</span>
<a name="l01632"></a>01632                                                                                       <a class="code" href="Sound_01Control_8cpp.html#8437e17be79dfa8072914b9e52d11eb5">PlayJA2SampleFromFile</a>( (<a class="code" href="Types_8h.html#2a2a31a4bbd8a0f9b35e1bca5b3e1f7f">STR8</a>) pAnimDef-&gt;zSoundFile, RATE_11025, <a class="code" href="Sound_01Control_8cpp.html#f62b2a668c2e25997578956c425723c4">SoundVolume</a>( MIDVOLUME, <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#2ab66ee0f37902cd448f4a738df4f2bf">sGridNo</a> ), 1, <a class="code" href="Sound_01Control_8cpp.html#a258fd693b7e800828705055bf357c8d">SoundDir</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#2ab66ee0f37902cd448f4a738df4f2bf">sGridNo</a> ) );                
<a name="l01633"></a>01633                                 }
<a name="l01634"></a>01634                               }
<a name="l01635"></a>01635                               <span class="keywordflow">else</span>
<a name="l01636"></a>01636                               {
<a name="l01637"></a>01637 
<a name="l01638"></a>01638                                                                                     <span class="comment">// Play sound</span>
<a name="l01639"></a>01639                                                                                     <a class="code" href="Sound_01Control_8cpp.html#8437e17be79dfa8072914b9e52d11eb5">PlayJA2SampleFromFile</a>( (<a class="code" href="Types_8h.html#2a2a31a4bbd8a0f9b35e1bca5b3e1f7f">STR8</a>)pAnimDef-&gt;zSoundFile, RATE_11025, <a class="code" href="Sound_01Control_8cpp.html#f62b2a668c2e25997578956c425723c4">SoundVolume</a>( MIDVOLUME, <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#2ab66ee0f37902cd448f4a738df4f2bf">sGridNo</a> ), 1, <a class="code" href="Sound_01Control_8cpp.html#a258fd693b7e800828705055bf357c8d">SoundDir</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#2ab66ee0f37902cd448f4a738df4f2bf">sGridNo</a> ) );             
<a name="l01640"></a>01640                               }
<a name="l01641"></a>01641                             }
<a name="l01642"></a>01642                           }
<a name="l01643"></a>01643                           <span class="keywordflow">else</span>
<a name="l01644"></a>01644                           {
<a name="l01645"></a>01645                                                                                 <span class="comment">// Play sound</span>
<a name="l01646"></a>01646                                                                                 <a class="code" href="Sound_01Control_8cpp.html#8437e17be79dfa8072914b9e52d11eb5">PlayJA2SampleFromFile</a>( (<a class="code" href="Types_8h.html#2a2a31a4bbd8a0f9b35e1bca5b3e1f7f">STR8</a>)pAnimDef-&gt;zSoundFile, RATE_11025, <a class="code" href="Sound_01Control_8cpp.html#f62b2a668c2e25997578956c425723c4">SoundVolume</a>( MIDVOLUME, <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#2ab66ee0f37902cd448f4a738df4f2bf">sGridNo</a> ), 1, <a class="code" href="Sound_01Control_8cpp.html#a258fd693b7e800828705055bf357c8d">SoundDir</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#2ab66ee0f37902cd448f4a738df4f2bf">sGridNo</a> ) );                 
<a name="l01647"></a>01647                           }
<a name="l01648"></a>01648                                                                         }
<a name="l01649"></a>01649                                                                         <span class="keywordflow">else</span>
<a name="l01650"></a>01650                                                                         {
<a name="l01651"></a>01651                                                                               <a class="code" href="Soldier_01Control_8cpp.html#6f191e00fb4f3c5e2cbe762aa402a420">ChangeSoldierState</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>, pAnimDef-&gt;sAnimID, 0 , FALSE );
<a name="l01652"></a>01652                                                                         }
<a name="l01653"></a>01653                                                                         <span class="keywordflow">return</span>( TRUE );
<a name="l01654"></a>01654                                                                   }
<a name="l01655"></a>01655                                                             }
<a name="l01656"></a>01656                                                       }
<a name="l01657"></a>01657                                                 }
<a name="l01658"></a>01658 
<a name="l01659"></a>01659                                           }
<a name="l01660"></a>01660                                     }
<a name="l01661"></a>01661                               }
<a name="l01662"></a>01662                               <span class="keywordflow">break</span>;
<a name="l01663"></a>01663 
<a name="l01664"></a>01664                         <span class="keywordflow">case</span> 492:
<a name="l01665"></a>01665 
<a name="l01666"></a>01666                               
<a name="l01667"></a>01667                               <span class="comment">// SIGNAL DODGE!</span>
<a name="l01668"></a>01668                               <span class="comment">// ATE: Only do if we're not inspecial case...</span>
<a name="l01669"></a>01669                               <span class="keywordflow">if</span> ( !( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#eb633099940bc20ff5a969bce84eab42">uiStatusFlags</a> &amp; SOLDIER_NPC_DOING_PUNCH ) )
<a name="l01670"></a>01670                               {
<a name="l01671"></a>01671                                     <a class="code" href="structSOLDIERTYPE.html">SOLDIERTYPE</a> *pTSoldier;
<a name="l01672"></a>01672                                     <a class="code" href="Types_8h.html#e1e6edbbc26d6fbc71a90190d0266018">UINT32</a> uiMercFlags;
<a name="l01673"></a>01673                                     <a class="code" href="Types_8h.html#09f1a1fb2293e33483cc8d44aefb1eb1">UINT16</a> usSoldierIndex;
<a name="l01674"></a>01674 
<a name="l01675"></a>01675                                     <span class="keywordflow">if</span> ( <a class="code" href="Soldier_01Find_8cpp.html#c1258f2b7ae03ca5e674d93082518f40">FindSoldier</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#97fff971b8c532135f0c0451deac7aa1">sTargetGridNo</a>, &amp;usSoldierIndex, &amp;uiMercFlags, FIND_SOLDIER_GRIDNO ) )
<a name="l01676"></a>01676                                     {     
<a name="l01677"></a>01677                                           <a class="code" href="Overhead_8cpp.html#f0ada03378d5018e6f225bf25ab20b24">GetSoldier</a>( &amp;pTSoldier, usSoldierIndex );       
<a name="l01678"></a>01678 
<a name="l01679"></a>01679                                           <span class="comment">// IF WE ARE AN ANIMAL, CAR, MONSTER, DONT'T DODGE</span>
<a name="l01680"></a>01680                                           <span class="keywordflow">if</span> ( IS_MERC_BODY_TYPE( pTSoldier ) )
<a name="l01681"></a>01681                                           {
<a name="l01682"></a>01682                                                 <span class="comment">// ONLY DODGE IF WE ARE SEEN</span>
<a name="l01683"></a>01683                                                 <span class="keywordflow">if</span> ( pTSoldier-&gt;<a class="code" href="structSOLDIERTYPE.html#d0a0bdddaeb7bbea617b4294b539ef32">bOppList</a>[ <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#18aef170576da81b10d00e7b6cd3627b">ubID</a> ] != 0 || pTSoldier-&gt;<a class="code" href="structSOLDIERTYPE.html#74a40a8aaf3efe840cdaf6be62556d82">bTeam</a> == <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#74a40a8aaf3efe840cdaf6be62556d82">bTeam</a> )
<a name="l01684"></a>01684                                                 {
<a name="l01685"></a>01685                                                       <span class="keywordflow">if</span> ( <a class="code" href="Animation_01Control_8cpp.html#633440a87c34a25c700ce620db87d036">gAnimControl</a>[ pTSoldier-&gt;<a class="code" href="structSOLDIERTYPE.html#1f73b62a5ea0dd26fa1bec1d9f522b41">usAnimState</a> ].ubHeight == ANIM_STAND )
<a name="l01686"></a>01686                                                       {
<a name="l01687"></a>01687                                                             <span class="comment">// OK, stop merc....</span>
<a name="l01688"></a>01688                                                             <a class="code" href="Soldier_01Control_8cpp.html#e90db6b8cf63e148848cf9fe9bbe56cf">EVENT_StopMerc</a>( pTSoldier, pTSoldier-&gt;<a class="code" href="structSOLDIERTYPE.html#2ab66ee0f37902cd448f4a738df4f2bf">sGridNo</a>, pTSoldier-&gt;bDirection );
<a name="l01689"></a>01689 
<a name="l01690"></a>01690                                                             <span class="keywordflow">if</span> ( pTSoldier-&gt;<a class="code" href="structSOLDIERTYPE.html#74a40a8aaf3efe840cdaf6be62556d82">bTeam</a> != <a class="code" href="Campaign_8cpp.html#47b2067ff75193e24776eda5297400ff">gbPlayerNum</a> )
<a name="l01691"></a>01691                                                             {
<a name="l01692"></a>01692                                                                   <a class="code" href="ai_8h.html#6cced4c42ca3081db5b89f6a584e549f">CancelAIAction</a>( pTSoldier, TRUE );
<a name="l01693"></a>01693                                                             }
<a name="l01694"></a>01694 
<a name="l01695"></a>01695                                                             <span class="comment">// Turn towards the person!</span>
<a name="l01696"></a>01696                                                             <a class="code" href="Soldier_01Control_8cpp.html#019f893295bb96f48261ded184a17cab">EVENT_SetSoldierDesiredDirection</a>( pTSoldier, <a class="code" href="Soldier_01Control_8cpp.html#1d7b6c103ede7e551e76eef2ef173f9b">GetDirectionFromGridNo</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#2ab66ee0f37902cd448f4a738df4f2bf">sGridNo</a>, pTSoldier ) );
<a name="l01697"></a>01697 
<a name="l01698"></a>01698                                                             <span class="comment">// PLAY SOLDIER'S DODGE ANIMATION</span>
<a name="l01699"></a>01699                                                             <a class="code" href="Soldier_01Control_8cpp.html#6f191e00fb4f3c5e2cbe762aa402a420">ChangeSoldierState</a>( pTSoldier, <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2eb6f5cfd5355be0ebdbf46ad661856985e">DODGE_ONE</a>, 0 , FALSE );
<a name="l01700"></a>01700                                                       }
<a name="l01701"></a>01701                                                 }
<a name="l01702"></a>01702                                           }
<a name="l01703"></a>01703                                     }
<a name="l01704"></a>01704                               }
<a name="l01705"></a>01705                               <span class="keywordflow">break</span>;
<a name="l01706"></a>01706 
<a name="l01707"></a>01707                         <span class="keywordflow">case</span> 493:
<a name="l01708"></a>01708 
<a name="l01709"></a>01709                               <span class="comment">//CODE: PICKUP ITEM!</span>
<a name="l01710"></a>01710                               <span class="comment">// CHECK IF THIS EVENT HAS BEEN SETUP</span>
<a name="l01711"></a>01711                               <span class="comment">//if ( pSoldier-&gt;ubPendingAction == MERC_PICKUPITEM )</span>
<a name="l01712"></a>01712                               <span class="comment">//{</span>
<a name="l01713"></a>01713                                     <span class="comment">// DROP ITEM</span>
<a name="l01714"></a>01714                                     <a class="code" href="Handle_01Items_8cpp.html#3dcfa407aea2f357ad73ea11f00192aa">HandleSoldierPickupItem</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>, <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#a69215f405f59c8085b3bb27f76893c3">uiPendingActionData1</a>, (<a class="code" href="Types_8h.html#30f500129d8c688af07726d5d34ce52d">INT16</a>)(<a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#304094e7d2a05131c34f41c46dfb6fad">uiPendingActionData4</a> ), <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#9262a8e1996d3ab40047dca23f4568c0">bPendingActionData3</a> );
<a name="l01715"></a>01715                                     <span class="comment">// EVENT HAS BEEN HANDLED</span>
<a name="l01716"></a>01716                                     <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#77e9ca91b8a5b17fdc0acb99901cbdad">ubPendingAction</a>            = NO_PENDING_ACTION;
<a name="l01717"></a>01717 
<a name="l01718"></a>01718                               <span class="comment">//}</span>
<a name="l01719"></a>01719                               <span class="comment">//else</span>
<a name="l01720"></a>01720                               <span class="comment">//{</span>
<a name="l01721"></a>01721                               <span class="comment">//     DebugMsg( TOPIC_JA2, DBG_LEVEL_3, "Soldier Ani: CODE 493 Error, Pickup item action called but not setup" );</span>
<a name="l01722"></a>01722                               <span class="comment">//}</span>
<a name="l01723"></a>01723                               <span class="keywordflow">break</span>;
<a name="l01724"></a>01724 
<a name="l01725"></a>01725                         <span class="keywordflow">case</span> 494:
<a name="l01726"></a>01726 
<a name="l01727"></a>01727                               <span class="comment">//CODE: OPEN STRUCT!</span>
<a name="l01728"></a>01728                               <span class="comment">// CHECK IF THIS EVENT HAS BEEN SETUP</span>
<a name="l01729"></a>01729                               <span class="comment">//if ( pSoldier-&gt;ubPendingAction == MERC_OPENSTRUCT )</span>
<a name="l01730"></a>01730                               <span class="comment">//{</span>
<a name="l01731"></a>01731                                     <a class="code" href="Interactive_01Tiles_8cpp.html#6e20911024b04704aeef5f8fd2e81e4b">SoldierHandleInteractiveObject</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a> );
<a name="l01732"></a>01732 
<a name="l01733"></a>01733                                     <span class="comment">// EVENT HAS BEEN HANDLED</span>
<a name="l01734"></a>01734                                     <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#77e9ca91b8a5b17fdc0acb99901cbdad">ubPendingAction</a>            = NO_PENDING_ACTION;
<a name="l01735"></a>01735 
<a name="l01736"></a>01736                               <span class="comment">//}</span>
<a name="l01737"></a>01737                               <span class="comment">//else</span>
<a name="l01738"></a>01738                               <span class="comment">//{</span>
<a name="l01739"></a>01739                               <span class="comment">//     DebugMsg( TOPIC_JA2, DBG_LEVEL_3, "Soldier Ani: CODE 494 Error, OPen door action called but not setup" );</span>
<a name="l01740"></a>01740                               <span class="comment">//}</span>
<a name="l01741"></a>01741                               <span class="keywordflow">break</span>;
<a name="l01742"></a>01742                               
<a name="l01743"></a>01743                         <span class="keywordflow">case</span> 495:
<a name="l01744"></a>01744 
<a name="l01745"></a>01745                                     <span class="keywordflow">if</span> (<a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#70fc2b64ddf6ed6358c954ff3f200ce7">bAction</a> == <a class="code" href="ai_8h.html#21d5e8f8cdaa838586b31007df0a950ba5497fc0ba7a574720d7e7fc9b6acadf">AI_ACTION_UNLOCK_DOOR</a> || (<a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#70fc2b64ddf6ed6358c954ff3f200ce7">bAction</a> == <a class="code" href="ai_8h.html#21d5e8f8cdaa838586b31007df0a950b8d52b4109959d549093a3709f0a0a39c">AI_ACTION_LOCK_DOOR</a> &amp;&amp; !(<a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#7d5fffce6e4f940d39e7512c1d378fe3">fAIFlags</a> &amp; AI_LOCK_DOOR_INCLUDES_CLOSE) ) )
<a name="l01746"></a>01746                                     {
<a name="l01747"></a>01747                                           <span class="comment">// EVENT HAS BEEN HANDLED</span>
<a name="l01748"></a>01748                                           <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#77e9ca91b8a5b17fdc0acb99901cbdad">ubPendingAction</a>            = NO_PENDING_ACTION;
<a name="l01749"></a>01749 
<a name="l01750"></a>01750                                           <span class="comment">// do nothing here</span>
<a name="l01751"></a>01751                                     }
<a name="l01752"></a>01752                                     <span class="keywordflow">else</span>
<a name="l01753"></a>01753                                     {
<a name="l01754"></a>01754 
<a name="l01755"></a>01755                                           <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#7d5fffce6e4f940d39e7512c1d378fe3">fAIFlags</a> &amp;= ~(AI_LOCK_DOOR_INCLUDES_CLOSE);
<a name="l01756"></a>01756 
<a name="l01757"></a>01757                                           <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#2961bd080c148a11dab6c11ee9d52471">ubDoorOpeningNoise</a> = <a class="code" href="opplist_8cpp.html#92e435266c89a20358254f1c951b4528">DoorOpeningNoise</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a> );
<a name="l01758"></a>01758 
<a name="l01759"></a>01759                                           <span class="keywordflow">if</span> ( <a class="code" href="Interactive_01Tiles_8cpp.html#6e20911024b04704aeef5f8fd2e81e4b">SoldierHandleInteractiveObject</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a> ) )
<a name="l01760"></a>01760               {
<a name="l01761"></a>01761                                             <span class="comment">// HANDLE SIGHT!</span>
<a name="l01762"></a>01762                                             <span class="comment">//HandleSight(pSoldier,SIGHT_LOOK | SIGHT_RADIO | SIGHT_INTERRUPT );</span>
<a name="l01763"></a>01763 
<a name="l01764"></a>01764                                             <a class="code" href="opplist_8cpp.html#e69d3b968d4f89c2e5bb4482476e3516">InitOpplistForDoorOpening</a>();
<a name="l01765"></a>01765                                             
<a name="l01766"></a>01766                                             <a class="code" href="opplist_8cpp.html#dd89235e898eba71e64fe3269ad08e25">MakeNoise</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#18aef170576da81b10d00e7b6cd3627b">ubID</a>, <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#2ab66ee0f37902cd448f4a738df4f2bf">sGridNo</a>, <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#0d1f73c5d0ac839ec84a4792505949cb">bLevel</a>, <a class="code" href="worlddef_8cpp.html#a1c640bcf89772795e6517da9963e0d7">gpWorldLevelData</a>[<a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#2ab66ee0f37902cd448f4a738df4f2bf">sGridNo</a>].ubTerrainID, <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#2961bd080c148a11dab6c11ee9d52471">ubDoorOpeningNoise</a>, <a class="code" href="opplist_8h.html#8585c80e32993102dff78219f1bf177d61adefb252f6421aedb8c4704bff45b8">NOISE_CREAKING</a> );
<a name="l01767"></a>01767                                       <span class="comment">//  gfDelayResolvingBestSighting = FALSE;</span>
<a name="l01768"></a>01768 
<a name="l01769"></a>01769                                             <a class="code" href="opplist_8cpp.html#2a6174431f0a4b68f6b1f52d3030b5cb">gubInterruptProvoker</a> = <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#18aef170576da81b10d00e7b6cd3627b">ubID</a>;
<a name="l01770"></a>01770                                             <a class="code" href="opplist_8cpp.html#f4fab2865204e018ead0e5c076b97be4">AllTeamsLookForAll</a>( TRUE );
<a name="l01771"></a>01771 
<a name="l01772"></a>01772                                             <span class="comment">// ATE: Now, check AI guy to cancel what he was going....</span>
<a name="l01773"></a>01773                                             <a class="code" href="Overhead_8cpp.html#1e90a7e590fc2cf941a2b752e3696328">HandleSystemNewAISituation</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>, TRUE );
<a name="l01774"></a>01774               }
<a name="l01775"></a>01775 
<a name="l01776"></a>01776                                           <span class="comment">// EVENT HAS BEEN HANDLED</span>
<a name="l01777"></a>01777                                           <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#77e9ca91b8a5b17fdc0acb99901cbdad">ubPendingAction</a>            = NO_PENDING_ACTION;
<a name="l01778"></a>01778 
<a name="l01779"></a>01779                                     }
<a name="l01780"></a>01780 
<a name="l01781"></a>01781                                     
<a name="l01782"></a>01782                               <span class="keywordflow">break</span>;
<a name="l01783"></a>01783 
<a name="l01784"></a>01784                         <span class="keywordflow">case</span> 496:
<a name="l01785"></a>01785                               <span class="comment">// CODE: GOTO PREVIOUS ANIMATION</span>
<a name="l01786"></a>01786                               <a class="code" href="Soldier_01Control_8cpp.html#6f191e00fb4f3c5e2cbe762aa402a420">ChangeSoldierState</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>, <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#79b8193df6c154341902e5409b373ce4">usOldAniState</a>, <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#223d3bee84f74dd9d95520345c706d0e">sOldAniCode</a>, FALSE );                            
<a name="l01787"></a>01787                               <span class="keywordflow">return</span>( TRUE );
<a name="l01788"></a>01788 
<a name="l01789"></a>01789                         <span class="keywordflow">case</span> 497:
<a name="l01790"></a>01790 
<a name="l01791"></a>01791                               <span class="comment">// CODE: CHECK FOR UNCONSCIOUS OR DEATH</span>
<a name="l01792"></a>01792                               <span class="comment">// IF 496 - GOTO PREVIOUS ANIMATION, OTHERWISE PAUSE ANIMATION</span>
<a name="l01793"></a>01793                               <span class="keywordflow">if</span> ( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#e308dea18533bf5ab2bcee5bbe27391c">bLife</a> == 0 )
<a name="l01794"></a>01794                               {
<a name="l01795"></a>01795 
<a name="l01796"></a>01796                                     <span class="comment">//HandleSoldierDeath( pSoldier );</span>
<a name="l01797"></a>01797 
<a name="l01798"></a>01798                                     <span class="comment">// If guy is now dead, and we have not played death sound before, play</span>
<a name="l01799"></a>01799                                     <span class="keywordflow">if</span> ( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#e308dea18533bf5ab2bcee5bbe27391c">bLife</a> == 0 &amp;&amp; !<a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#8776fc5db81036f7b2c071457dd02eb4">fDeadSoundPlayed</a>  )
<a name="l01800"></a>01800                                     {                       
<a name="l01801"></a>01801                                           <span class="keywordflow">if</span> ( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#1f73b62a5ea0dd26fa1bec1d9f522b41">usAnimState</a> != <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2ebf519f2bb07cc5f8f605e3354e4e2e806">JFK_HITDEATH</a> )
<a name="l01802"></a>01802                                           {
<a name="l01803"></a>01803                                                 <a class="code" href="Soldier_01Control_8cpp.html#62effc98ffa51ddb2fc78301c82acdb8">DoMercBattleSound</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>, <a class="code" href="Soldier_01Control_8h.html#3ab071cf265666f49f6e3f6639d69f0abf28cedf54317c01049c44943809631d">BATTLE_SOUND_DIE1</a> );
<a name="l01804"></a>01804                                           <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#8776fc5db81036f7b2c071457dd02eb4">fDeadSoundPlayed</a> = TRUE;
<a name="l01805"></a>01805                                           }
<a name="l01806"></a>01806                                     }
<a name="l01807"></a>01807 
<a name="l01808"></a>01808                                     <span class="keywordflow">if</span> ( <a class="code" href="GameSettings_8cpp.html#955420499d1cb3101625c85ea703b6bb">gGameSettings</a>.<a class="code" href="structGAME__SETTINGS.html#9d80dbd111727423b8924b5e72e3a0ed">fOptions</a>[ <a class="code" href="GameSettings_8h.html#394b3903fbf00ba2b6243f60689a5a5faee89e33212d20c92a526b40f5845345">TOPTION_BLOOD_N_GORE</a> ] )
<a name="l01809"></a>01809                                     {
<a name="l01810"></a>01810                                           <span class="comment">// If we are dead, play some death animations!!</span>
<a name="l01811"></a>01811                                           <span class="keywordflow">switch</span>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#1f73b62a5ea0dd26fa1bec1d9f522b41">usAnimState</a> )
<a name="l01812"></a>01812                                           {
<a name="l01813"></a>01813                                                 <span class="keywordflow">case</span> <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2eb45acaaee9f8cf7570b7b840b8d20dbcc">FLYBACK_HIT</a>:
<a name="l01814"></a>01814                                                       <a class="code" href="Soldier_01Control_8cpp.html#6f191e00fb4f3c5e2cbe762aa402a420">ChangeSoldierState</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>, <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2eb5bcd7c4372d4c29e14785d64946171a0">FLYBACK_HIT_DEATH</a>, 0, FALSE );
<a name="l01815"></a>01815                                                       <span class="keywordflow">break</span>;
<a name="l01816"></a>01816 
<a name="l01817"></a>01817                                                 <span class="keywordflow">case</span> <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2eb0c9fe0a8117aab849e61e9c42d219c63">GENERIC_HIT_DEATHTWITCHNB</a>:
<a name="l01818"></a>01818                                                 <span class="keywordflow">case</span> <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2eb5734c6c3b78cd8b8f5ed5d27b48b44d3">FALLFORWARD_FROMHIT_STAND</a>:
<a name="l01819"></a>01819                                                 <span class="keywordflow">case</span> <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2ebb0406929e67fde23b629e3f60baba8a8">ENDFALLFORWARD_FROMHIT_CROUCH</a>:
<a name="l01820"></a>01820 
<a name="l01821"></a>01821                                                       <a class="code" href="Soldier_01Control_8cpp.html#6f191e00fb4f3c5e2cbe762aa402a420">ChangeSoldierState</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>, <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2eb2e67b5b42c024d627d8887316ae3b01e">GENERIC_HIT_DEATH</a>, 0, FALSE );
<a name="l01822"></a>01822                                                       <span class="keywordflow">break</span>;
<a name="l01823"></a>01823 
<a name="l01824"></a>01824                                                 <span class="keywordflow">case</span> <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2ebded57ded23f58a9903b60b9788790efe">FALLBACK_HIT_DEATHTWITCHNB</a>:
<a name="l01825"></a>01825                                                 <span class="keywordflow">case</span> <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2eb8b6ec73ff14590fbd84485acdb213d6b">FALLBACK_HIT_STAND</a>:
<a name="l01826"></a>01826                                                       <a class="code" href="Soldier_01Control_8cpp.html#6f191e00fb4f3c5e2cbe762aa402a420">ChangeSoldierState</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>, <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2ebd7cc0407572496e696f7ef6b1e2c97ca">FALLBACK_HIT_DEATH</a>, 0, FALSE );
<a name="l01827"></a>01827                                                       <span class="keywordflow">break</span>;
<a name="l01828"></a>01828 
<a name="l01829"></a>01829                                                 <span class="keywordflow">case</span> <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2eb08a34d55322f517abc7b038391f25f85">PRONE_HIT_DEATHTWITCHNB</a>:
<a name="l01830"></a>01830                                                 <span class="keywordflow">case</span> <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2eb87791a2116a48401790a4477c19b1d4a">PRONE_LAY_FROMHIT</a>:
<a name="l01831"></a>01831 
<a name="l01832"></a>01832                                                       <a class="code" href="Soldier_01Control_8cpp.html#6f191e00fb4f3c5e2cbe762aa402a420">ChangeSoldierState</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>, <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2eb635e5ea103631d96fda3a4042a659afc">PRONE_HIT_DEATH</a>, 0, FALSE );
<a name="l01833"></a>01833                                                       <span class="keywordflow">break</span>;
<a name="l01834"></a>01834 
<a name="l01835"></a>01835                                                 <span class="keywordflow">case</span> <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2eb8f28eaaa17687dc192c1ffa03b34f840">FALLOFF</a>:
<a name="l01836"></a>01836                                                       <a class="code" href="Soldier_01Control_8cpp.html#6f191e00fb4f3c5e2cbe762aa402a420">ChangeSoldierState</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>, <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2eb7490325e516e0cf31a0b03ec84df068f">FALLOFF_DEATH</a>, 0, FALSE );
<a name="l01837"></a>01837                                                       <span class="keywordflow">break</span>;
<a name="l01838"></a>01838 
<a name="l01839"></a>01839                                                 <span class="keywordflow">case</span> <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2eb4e921a02222544c65473181fe2403dec">FALLFORWARD_ROOF</a>:
<a name="l01840"></a>01840                                                       <a class="code" href="Soldier_01Control_8cpp.html#6f191e00fb4f3c5e2cbe762aa402a420">ChangeSoldierState</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>, <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2eb1388740da829de4a2f7d782d24666b8f">FALLOFF_FORWARD_DEATH</a>, 0, FALSE);
<a name="l01841"></a>01841                                                       <span class="keywordflow">break</span>;
<a name="l01842"></a>01842 
<a name="l01843"></a>01843                                                 <span class="keywordflow">case</span> <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2eb01019d6aa75615bb41df61b7f8286b40">ADULTMONSTER_DYING</a>:
<a name="l01844"></a>01844                                                       <a class="code" href="Soldier_01Control_8cpp.html#6f191e00fb4f3c5e2cbe762aa402a420">ChangeSoldierState</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>, <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2eb742874fa370ee3043c10aef7081e0f3c">ADULTMONSTER_DYING_STOP</a>, 0, FALSE);
<a name="l01845"></a>01845                                                       <span class="keywordflow">break</span>;
<a name="l01846"></a>01846 
<a name="l01847"></a>01847                                                 <span class="keywordflow">case</span> <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2ebca5a3f460b36b90e592cd7e4510d455d">LARVAE_DIE</a>:
<a name="l01848"></a>01848                                                       <a class="code" href="Soldier_01Control_8cpp.html#6f191e00fb4f3c5e2cbe762aa402a420">ChangeSoldierState</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>, <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2ebd798a7fa9b50946194a16d0c684dcefa">LARVAE_DIE_STOP</a>, 0, FALSE);
<a name="l01849"></a>01849                                                       <span class="keywordflow">break</span>;
<a name="l01850"></a>01850 
<a name="l01851"></a>01851                                                 <span class="keywordflow">case</span> <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2eb535558f831f451102af07555a0482fb2">QUEEN_DIE</a>:
<a name="l01852"></a>01852                                                       <a class="code" href="Soldier_01Control_8cpp.html#6f191e00fb4f3c5e2cbe762aa402a420">ChangeSoldierState</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>, <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2ebf9845130ad404ba560f35179bfd5552a">QUEEN_DIE_STOP</a>, 0, FALSE);
<a name="l01853"></a>01853                                                       <span class="keywordflow">break</span>;
<a name="l01854"></a>01854 
<a name="l01855"></a>01855                                                 <span class="keywordflow">case</span> <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2ebeb4f625dede301568b1fb4cb9d379b23">INFANT_DIE</a>:
<a name="l01856"></a>01856                                                       <a class="code" href="Soldier_01Control_8cpp.html#6f191e00fb4f3c5e2cbe762aa402a420">ChangeSoldierState</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>, <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2eb8ad4a2deb5b86a20c1f70d2455026501">INFANT_DIE_STOP</a>, 0, FALSE);
<a name="l01857"></a>01857                                                       <span class="keywordflow">break</span>;
<a name="l01858"></a>01858 
<a name="l01859"></a>01859                                                 <span class="keywordflow">case</span> <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2ebe90b85b9c611017966e7111e286d3d61">CRIPPLE_DIE</a>:
<a name="l01860"></a>01860                                                       <a class="code" href="Soldier_01Control_8cpp.html#6f191e00fb4f3c5e2cbe762aa402a420">ChangeSoldierState</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>, <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2eb29b518363350a21c7a4b0683585d71a1">CRIPPLE_DIE_STOP</a>, 0, FALSE);
<a name="l01861"></a>01861                                                       <span class="keywordflow">break</span>;
<a name="l01862"></a>01862 
<a name="l01863"></a>01863                                                 <span class="keywordflow">case</span> <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2eb1b2e84cba4513e808905d9f00248ee80">ROBOTNW_DIE</a>:
<a name="l01864"></a>01864                                                       <a class="code" href="Soldier_01Control_8cpp.html#6f191e00fb4f3c5e2cbe762aa402a420">ChangeSoldierState</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>, <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2ebf7e742e50243959090a8e4e8c39897fa">ROBOTNW_DIE_STOP</a>, 0, FALSE);
<a name="l01865"></a>01865                                                       <span class="keywordflow">break</span>;
<a name="l01866"></a>01866 
<a name="l01867"></a>01867                                                 <span class="keywordflow">case</span> <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2eb4f0e4ac2058fbaabedd13077cab8b09a">CRIPPLE_DIE_FLYBACK</a>:
<a name="l01868"></a>01868                                                       <a class="code" href="Soldier_01Control_8cpp.html#6f191e00fb4f3c5e2cbe762aa402a420">ChangeSoldierState</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>, <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2ebad746d640661fdc0948dfddbe3d71d4b">CRIPPLE_DIE_FLYBACK_STOP</a>, 0, FALSE);
<a name="l01869"></a>01869                                                       <span class="keywordflow">break</span>;
<a name="l01870"></a>01870 
<a name="l01871"></a>01871                                                 <span class="keywordflow">default</span>:
<a name="l01872"></a>01872                                                       <span class="comment">// IF we are here - something is wrong - we should have a death animation here</span>
<a name="l01873"></a>01873                                                       DebugMsg( <a class="code" href="DEBUG_8cpp.html#a7985c2fd033797fc67a03b2c26e07c6">TOPIC_JA2</a>, DBG_LEVEL_3, <a class="code" href="DEBUG_8cpp.html#88565bf27eec0b2003eb5bc9426b8e4b">String</a>( <span class="stringliteral">"Soldier Ani: Death sequence needed for animation %d"</span>, <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#1f73b62a5ea0dd26fa1bec1d9f522b41">usAnimState</a> ) );
<a name="l01874"></a>01874 
<a name="l01875"></a>01875                                           }
<a name="l01876"></a>01876                                     }
<a name="l01877"></a>01877                                     <span class="keywordflow">else</span>
<a name="l01878"></a>01878                                     {
<a name="l01879"></a>01879                                           <a class="code" href="Types_8h.html#112e3146cb38b6ee95e64d85842e380a">BOOLEAN</a> fMadeCorpse;
<a name="l01880"></a>01880 
<a name="l01881"></a>01881                                           <a class="code" href="Soldier_01Ani_8cpp.html#c8dc487d70dc5109dd507c1dcf8efb45">CheckForAndHandleSoldierDeath</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>, &amp;fMadeCorpse );
<a name="l01882"></a>01882 
<a name="l01883"></a>01883                                           <span class="comment">// ATE: Needs to be FALSE!</span>
<a name="l01884"></a>01884                                           <span class="keywordflow">return</span>( FALSE );
<a name="l01885"></a>01885                                     }
<a name="l01886"></a>01886                                     <span class="keywordflow">return</span>( TRUE );
<a name="l01887"></a>01887 
<a name="l01888"></a>01888                               }
<a name="l01889"></a>01889                               <span class="keywordflow">else</span>
<a name="l01890"></a>01890                               {
<a name="l01891"></a>01891                                     <span class="comment">// We can safely be here as well.. ( ie - next turn we may be able to get up )</span>
<a name="l01892"></a>01892                                     <span class="comment">// DO SOME CHECKS HERE TO FREE UP ATTACKERS IF WE ARE WAITING AT SPECIFIC ANIMATIONS</span>
<a name="l01893"></a>01893                                     <span class="keywordflow">if</span> ( ( <a class="code" href="Animation_01Control_8cpp.html#633440a87c34a25c700ce620db87d036">gAnimControl</a>[ <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#1f73b62a5ea0dd26fa1bec1d9f522b41">usAnimState</a> ].uiFlags &amp; ANIM_HITFINISH ) )
<a name="l01894"></a>01894                                     {
<a name="l01895"></a>01895                                                 <a class="code" href="Soldier_01Profile_8cpp.html#e3f3df87e21a149013294e4abf66bf60">gfPotentialTeamChangeDuringDeath</a> = TRUE;
<a name="l01896"></a>01896 
<a name="l01897"></a>01897                                                 <span class="comment">// Release attacker</span>
<a name="l01898"></a>01898                                                 DebugMsg( <a class="code" href="DEBUG_8cpp.html#a7985c2fd033797fc67a03b2c26e07c6">TOPIC_JA2</a>, DBG_LEVEL_3, <a class="code" href="DEBUG_8cpp.html#88565bf27eec0b2003eb5bc9426b8e4b">String</a>(<span class="stringliteral">"@@@@@@@ Releasesoldierattacker, code 497 = check for death"</span>) );
<a name="l01899"></a>01899                                                 <a class="code" href="Soldier_01Control_8cpp.html#ffdbb2d52e0bf2a7f9fe3559bdcf0ffb">ReleaseSoldiersAttacker</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a> );
<a name="l01900"></a>01900 
<a name="l01901"></a>01901                                                 <span class="comment">// ATE: OK - the above call can potentially</span>
<a name="l01902"></a>01902                                                 <span class="comment">// render the soldier bactive to false - check heare</span>
<a name="l01903"></a>01903                                                 <span class="keywordflow">if</span> ( !<a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#653dad4e2520784e293eca9f948b8532">bActive</a> )
<a name="l01904"></a>01904                                                 {
<a name="l01905"></a>01905                                                       <span class="keywordflow">return</span>( FALSE );
<a name="l01906"></a>01906                                                 }
<a name="l01907"></a>01907 
<a name="l01908"></a>01908                                                 <a class="code" href="Soldier_01Profile_8cpp.html#e3f3df87e21a149013294e4abf66bf60">gfPotentialTeamChangeDuringDeath</a> = FALSE;
<a name="l01909"></a>01909 
<a name="l01910"></a>01910                                                 <span class="comment">// FREEUP GETTING HIT FLAG</span>
<a name="l01911"></a>01911                                                 <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#d20eefbafd8613a5772ddb8eb384fc71">fGettingHit</a> = FALSE;
<a name="l01912"></a>01912                                     }     
<a name="l01913"></a>01913 
<a name="l01914"></a>01914                                     <a class="code" href="Soldier_01Ani_8cpp.html#9620717b03067fa2a2c58e119c103ab6">HandleCheckForDeathCommonCode</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a> );
<a name="l01915"></a>01915 
<a name="l01916"></a>01916                                     <span class="keywordflow">return</span>( TRUE );
<a name="l01917"></a>01917                               }
<a name="l01918"></a>01918                               <span class="keywordflow">break</span>;
<a name="l01919"></a>01919 
<a name="l01920"></a>01920                         <span class="keywordflow">case</span> 498:
<a name="l01921"></a>01921 
<a name="l01922"></a>01922                               <span class="comment">// CONDITONAL JUMP</span>
<a name="l01923"></a>01923                               <span class="comment">// If we have a pending animation, play it, else continue</span>
<a name="l01924"></a>01924                               <span class="keywordflow">if</span> ( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#10dcc042f40b20751530663b0bbbe289">usPendingAnimation</a> != NO_PENDING_ANIMATION )
<a name="l01925"></a>01925                               {
<a name="l01926"></a>01926                                     <a class="code" href="Soldier_01Control_8cpp.html#6f191e00fb4f3c5e2cbe762aa402a420">ChangeSoldierState</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>, pSoldier-&gt;<a class="code" href="structSOLDIERTYPE.html#10dcc042f40b20751530663b0bbbe289">usPendingAnimation</a>, 0, FALSE );
<a name="l01927"></a>01927                                     <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#10dcc042f40b20751530663b0bbbe289">usPendingAnimation</a> = NO_PENDING_ANIMATION;
<a name="l01928"></a>01928                                     <span class="keywordflow">return</span>( TRUE );
<a name="l01929"></a>01929                               }
<a name="l01930"></a>01930                               <span class="keywordflow">break</span>;
<a name="l01931"></a>01931 
<a name="l01932"></a>01932                         <span class="comment">// JUMP TO NEXT STATIONARY ANIMATION ACCORDING TO HEIGHT</span>
<a name="l01933"></a>01933                         <span class="keywordflow">case</span> 499:
<a name="l01934"></a>01934 
<a name="l01935"></a>01935                               <span class="keywordflow">if</span> (!(<a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#eb633099940bc20ff5a969bce84eab42">uiStatusFlags</a> &amp; SOLDIER_PC))
<a name="l01936"></a>01936                               {
<a name="l01937"></a>01937                                     <span class="keywordflow">if</span> ( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#70fc2b64ddf6ed6358c954ff3f200ce7">bAction</a> == <a class="code" href="ai_8h.html#21d5e8f8cdaa838586b31007df0a950b7e203d40eac46d173b3d04252291e713">AI_ACTION_PULL_TRIGGER</a> )
<a name="l01938"></a>01938                                     {
<a name="l01939"></a>01939                                           <span class="keywordflow">if</span> ( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#1f73b62a5ea0dd26fa1bec1d9f522b41">usAnimState</a> == <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2eb291b0dcceeb3055bf1788e21548b9f24">AI_PULL_SWITCH</a> &amp;&amp; <a class="code" href="Overhead_8cpp.html#46bd754f8875c305ab18731ed10e3364">gTacticalStatus</a>.<a class="code" href="structTacticalStatusType.html#b44a086b36d7dd7af18e11f8fdea4d05">ubAttackBusyCount</a> == 0 &amp;&amp; <a class="code" href="AIMain_8cpp.html#bcdbe0cbaa0cf51dc6d31a595e9540f0">gubElementsOnExplosionQueue</a> == 0 )
<a name="l01940"></a>01940                                           {
<a name="l01941"></a>01941                                                 <a class="code" href="ai_8h.html#89c2c8ed81ca4440c5ab50db64614288">FreeUpNPCFromPendingAction</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a> );
<a name="l01942"></a>01942                                           }
<a name="l01943"></a>01943                                     }
<a name="l01944"></a>01944                                     <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#70fc2b64ddf6ed6358c954ff3f200ce7">bAction</a> == <a class="code" href="ai_8h.html#21d5e8f8cdaa838586b31007df0a950b1221b04fcc67d664066e467da8a5ffbe">AI_ACTION_PENDING_ACTION</a>
<a name="l01945"></a>01945                                     || <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#70fc2b64ddf6ed6358c954ff3f200ce7">bAction</a> == <a class="code" href="ai_8h.html#21d5e8f8cdaa838586b31007df0a950b65e8af0fc83447730cc2b8d86372bcaf">AI_ACTION_OPEN_OR_CLOSE_DOOR</a>
<a name="l01946"></a>01946                                     || <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#70fc2b64ddf6ed6358c954ff3f200ce7">bAction</a> == <a class="code" href="ai_8h.html#21d5e8f8cdaa838586b31007df0a950b040215f06027cab6536b687b79df4633">AI_ACTION_YELLOW_ALERT</a>
<a name="l01947"></a>01947                                     || <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#70fc2b64ddf6ed6358c954ff3f200ce7">bAction</a> == <a class="code" href="ai_8h.html#21d5e8f8cdaa838586b31007df0a950b32a0d931f53db4ddf96ac82a3b52484a">AI_ACTION_RED_ALERT</a>
<a name="l01948"></a>01948                                     || <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#70fc2b64ddf6ed6358c954ff3f200ce7">bAction</a> == <a class="code" href="ai_8h.html#21d5e8f8cdaa838586b31007df0a950b7e203d40eac46d173b3d04252291e713">AI_ACTION_PULL_TRIGGER</a>
<a name="l01949"></a>01949                                     || <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#70fc2b64ddf6ed6358c954ff3f200ce7">bAction</a> == <a class="code" href="ai_8h.html#21d5e8f8cdaa838586b31007df0a950b33f47e42fd1375b937fa9cfb14d36bf9">AI_ACTION_CREATURE_CALL</a>
<a name="l01950"></a>01950                                     || <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#70fc2b64ddf6ed6358c954ff3f200ce7">bAction</a> == <a class="code" href="ai_8h.html#21d5e8f8cdaa838586b31007df0a950ba5497fc0ba7a574720d7e7fc9b6acadf">AI_ACTION_UNLOCK_DOOR</a>
<a name="l01951"></a>01951                                     || <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#70fc2b64ddf6ed6358c954ff3f200ce7">bAction</a> == <a class="code" href="ai_8h.html#21d5e8f8cdaa838586b31007df0a950b8d52b4109959d549093a3709f0a0a39c">AI_ACTION_LOCK_DOOR</a>     )
<a name="l01952"></a>01952                                     {
<a name="l01953"></a>01953                                           <span class="keywordflow">if</span> ( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#1f73b62a5ea0dd26fa1bec1d9f522b41">usAnimState</a> == <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2eb1e0f04351d55f1ce472daf304a9b02dc">PICKUP_ITEM</a> || <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#1f73b62a5ea0dd26fa1bec1d9f522b41">usAnimState</a> == <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2eb7c2f4455243d6e11c866f25bd7c542fb">ADJACENT_GET_ITEM</a> || <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#1f73b62a5ea0dd26fa1bec1d9f522b41">usAnimState</a> == <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2eb435ed9f7dee8f130b7a2a0a8d87a0518">DROP_ITEM</a> || <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#1f73b62a5ea0dd26fa1bec1d9f522b41">usAnimState</a> == <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2eb359074f290102ee9adfcf24a21f96e1d">END_OPEN_DOOR</a> || <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#1f73b62a5ea0dd26fa1bec1d9f522b41">usAnimState</a> == <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2ebfb52aa67201c256237ee874bd0db6c89">END_OPEN_DOOR_CROUCHED</a> || <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#1f73b62a5ea0dd26fa1bec1d9f522b41">usAnimState</a> == <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2eb18428a4c326b03b066a00d1f56f25b9d">CLOSE_DOOR</a> || <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#1f73b62a5ea0dd26fa1bec1d9f522b41">usAnimState</a> == <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2eb8af8d563c30ac1265da7e3381f75308a">MONSTER_UP</a> || <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#1f73b62a5ea0dd26fa1bec1d9f522b41">usAnimState</a> == <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2ebc12c06cad6fcf15402eacfe0202d6684">AI_RADIO</a> || <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#1f73b62a5ea0dd26fa1bec1d9f522b41">usAnimState</a> == <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2eb3d334e16a7ebd6abfb3e1b544f1579b1">AI_CR_RADIO</a> || <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#1f73b62a5ea0dd26fa1bec1d9f522b41">usAnimState</a> == <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2eb3a0e36f7ce66e717ac9d4d2939668f94">END_OPENSTRUCT</a> || <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#1f73b62a5ea0dd26fa1bec1d9f522b41">usAnimState</a> == <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2ebc3c440c713506d38539948a519aa8ff5">END_OPENSTRUCT_CROUCHED</a> || <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#1f73b62a5ea0dd26fa1bec1d9f522b41">usAnimState</a> == <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2eb96850ff0f8a79f3626beb2d0690f3574">QUEEN_CALL</a> )
<a name="l01954"></a>01954                                           {
<a name="l01955"></a>01955                                                 <a class="code" href="ai_8h.html#89c2c8ed81ca4440c5ab50db64614288">FreeUpNPCFromPendingAction</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a> );
<a name="l01956"></a>01956                                           }
<a name="l01957"></a>01957                                     }
<a name="l01958"></a>01958                               }
<a name="l01959"></a>01959 
<a name="l01960"></a>01960                               ubDesiredHeight = <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#f33459812e24af812d6439d62959709a">ubDesiredHeight</a>;
<a name="l01961"></a>01961 
<a name="l01962"></a>01962                               <span class="comment">// Check if we are at the desired height</span>
<a name="l01963"></a>01963                               <span class="keywordflow">if</span> ( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#f33459812e24af812d6439d62959709a">ubDesiredHeight</a> == <a class="code" href="Animation_01Control_8cpp.html#633440a87c34a25c700ce620db87d036">gAnimControl</a>[ <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#1f73b62a5ea0dd26fa1bec1d9f522b41">usAnimState</a> ].ubEndHeight || <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#f33459812e24af812d6439d62959709a">ubDesiredHeight</a> == NO_DESIRED_HEIGHT )
<a name="l01964"></a>01964                               {                 
<a name="l01965"></a>01965                                     <span class="comment">// Adjust movement mode......</span>
<a name="l01966"></a>01966                                     <span class="keywordflow">if</span> ( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#74a40a8aaf3efe840cdaf6be62556d82">bTeam</a> == <a class="code" href="Campaign_8cpp.html#47b2067ff75193e24776eda5297400ff">gbPlayerNum</a> &amp;&amp; !<a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#906350017de01732cd79495d831a9ee1">fContinueMoveAfterStanceChange</a> )
<a name="l01967"></a>01967                                     {
<a name="l01968"></a>01968                                           usUIMovementMode =  <a class="code" href="Soldier_01Control_8cpp.html#3cf92e9113d74b58d642c1983186d55f">GetMoveStateBasedOnStance</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>, <a class="code" href="Animation_01Control_8cpp.html#633440a87c34a25c700ce620db87d036">gAnimControl</a>[ <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#1f73b62a5ea0dd26fa1bec1d9f522b41">usAnimState</a> ].ubEndHeight );
<a name="l01969"></a>01969 
<a name="l01970"></a>01970               <span class="comment">// ATE: if we are currently running but have been told to walk, don't!</span>
<a name="l01971"></a>01971               <span class="keywordflow">if</span> ( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#28f15074956f36e3933f6cc10647eacf">usUIMovementMode</a> == <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2eb1061be6c3fb88d32829cba6f6b2be304">RUNNING</a> &amp;&amp; usUIMovementMode == <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2eb7f92908f6f669259d971b608823d2ebb">WALKING</a> )
<a name="l01972"></a>01972               {
<a name="l01973"></a>01973                 <span class="comment">// No!   </span>
<a name="l01974"></a>01974               }
<a name="l01975"></a>01975               <span class="keywordflow">else</span>
<a name="l01976"></a>01976               {
<a name="l01977"></a>01977                 <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#28f15074956f36e3933f6cc10647eacf">usUIMovementMode</a> = usUIMovementMode;
<a name="l01978"></a>01978               }
<a name="l01979"></a>01979                                     }
<a name="l01980"></a>01980 
<a name="l01981"></a>01981 
<a name="l01982"></a>01982                                     <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#f33459812e24af812d6439d62959709a">ubDesiredHeight</a> = NO_DESIRED_HEIGHT;
<a name="l01983"></a>01983 
<a name="l01984"></a>01984                                     <span class="keywordflow">if</span> (<a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#89f791af3bba5f888d458d9b7f6fa296">fChangingStanceDueToSuppression</a>)
<a name="l01985"></a>01985                                     {
<a name="l01986"></a>01986                                           <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#89f791af3bba5f888d458d9b7f6fa296">fChangingStanceDueToSuppression</a> = FALSE;
<a name="l01987"></a>01987                                           DebugMsg( <a class="code" href="DEBUG_8cpp.html#a7985c2fd033797fc67a03b2c26e07c6">TOPIC_JA2</a>, DBG_LEVEL_3, <a class="code" href="DEBUG_8cpp.html#88565bf27eec0b2003eb5bc9426b8e4b">String</a>(<span class="stringliteral">"@@@@@@@ Freeing up attacker - end of suppression stance change"</span>) );
<a name="l01988"></a>01988                                           <a class="code" href="Overhead_8cpp.html#de6952977d9c0a18bd743e5c7dc226ba">ReduceAttackBusyCount</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#6e5902fd9b458a232090bcb124cea3ac">ubSuppressorID</a>, FALSE );
<a name="l01989"></a>01989                                     }
<a name="l01990"></a>01990 
<a name="l01991"></a>01991                                     <span class="keywordflow">if</span> ( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#10dcc042f40b20751530663b0bbbe289">usPendingAnimation</a> == NO_PENDING_ANIMATION &amp;&amp; ( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#3a52d1286affb8bb63c00d01e805267c">fTurningFromPronePosition</a> != 3 ) &amp;&amp; ( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#3a52d1286affb8bb63c00d01e805267c">fTurningFromPronePosition</a> != 1 ) )
<a name="l01992"></a>01992                                     {
<a name="l01993"></a>01993               <span class="keywordflow">if</span> ( <a class="code" href="Overhead_8cpp.html#46bd754f8875c305ab18731ed10e3364">gTacticalStatus</a>.<a class="code" href="structTacticalStatusType.html#b44a086b36d7dd7af18e11f8fdea4d05">ubAttackBusyCount</a> == 0 )
<a name="l01994"></a>01994               {
<a name="l01995"></a>01995                                             <span class="comment">// OK, UNSET INTERFACE FIRST</span>
<a name="l01996"></a>01996                                             <a class="code" href="Handle_01UI_8cpp.html#3ca9f7e43b153367710a1bee6c71d7bc">UnSetUIBusy</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#18aef170576da81b10d00e7b6cd3627b">ubID</a> );
<a name="l01997"></a>01997                                             <span class="comment">// ( before we could get interrupted potentially by an interrupt )</span>
<a name="l01998"></a>01998               }
<a name="l01999"></a>01999                                     }
<a name="l02000"></a>02000 
<a name="l02001"></a>02001                                     <span class="comment">// Check to see if we have changed stance and need to update visibility</span>
<a name="l02002"></a>02002                                     <span class="keywordflow">if</span> ( <a class="code" href="Animation_01Control_8cpp.html#633440a87c34a25c700ce620db87d036">gAnimControl</a>[ <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#1f73b62a5ea0dd26fa1bec1d9f522b41">usAnimState</a> ].uiFlags &amp; ANIM_STANCECHANGEANIM)
<a name="l02003"></a>02003                                     {
<a name="l02004"></a>02004                                           <span class="keywordflow">if</span> ( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#10dcc042f40b20751530663b0bbbe289">usPendingAnimation</a> == NO_PENDING_ANIMATION &amp;&amp; <a class="code" href="Overhead_8cpp.html#46bd754f8875c305ab18731ed10e3364">gTacticalStatus</a>.<a class="code" href="structTacticalStatusType.html#b44a086b36d7dd7af18e11f8fdea4d05">ubAttackBusyCount</a> == 0 &amp;&amp; <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#3a52d1286affb8bb63c00d01e805267c">fTurningFromPronePosition</a> != 3 &amp;&amp; <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#3a52d1286affb8bb63c00d01e805267c">fTurningFromPronePosition</a> != 1 )
<a name="l02005"></a>02005                                           {
<a name="l02006"></a>02006                                                 <a class="code" href="opplist_8cpp.html#84caab6b3c04128593b43316bfdfdf43">HandleSight</a>(<a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>,SIGHT_LOOK | SIGHT_RADIO | SIGHT_INTERRUPT );
<a name="l02007"></a>02007                                           }
<a name="l02008"></a>02008                                           <span class="keywordflow">else</span>
<a name="l02009"></a>02009                                           {
<a name="l02010"></a>02010                                                 <a class="code" href="opplist_8cpp.html#84caab6b3c04128593b43316bfdfdf43">HandleSight</a>(<a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>,SIGHT_LOOK | SIGHT_RADIO );
<a name="l02011"></a>02011                                           }
<a name="l02012"></a>02012 
<a name="l02013"></a>02013               <span class="comment">// Keep ui busy if we are now in a hidden interrupt</span>
<a name="l02014"></a>02014               <span class="comment">// say we're prone and we crouch, we may get a hidden</span>
<a name="l02015"></a>02015               <span class="comment">// interrupt and in such a case we'd really like the UI</span>
<a name="l02016"></a>02016               <span class="comment">// still locked</span>
<a name="l02017"></a>02017               <span class="keywordflow">if</span> ( <a class="code" href="TeamTurns_8cpp.html#782955f80e251720a735649d4e8a5987">gfHiddenInterrupt</a> )
<a name="l02018"></a>02018               {
<a name="l02019"></a>02019                             <a class="code" href="Handle_01UI_8cpp.html#c1a811228f6db879e9c1d67b68651a1b">guiPendingOverrideEvent</a>   = <a class="code" href="Handle_01UI_8h.html#af14d9a15c91cd740ff202b6335e405e1fdaeba3b145ee12467f7436d6663955">LA_BEGINUIOURTURNLOCK</a>;
<a name="l02020"></a>02020                             <a class="code" href="Handle_01UI_8cpp.html#2633147d0d1a1bafac01733902d66452">HandleTacticalUI</a>( );
<a name="l02021"></a>02021               }
<a name="l02022"></a>02022 
<a name="l02023"></a>02023                                           <span class="comment">// ATE: Now, check AI guy to cancel what he was going....</span>
<a name="l02024"></a>02024                                           <a class="code" href="Overhead_8cpp.html#1e90a7e590fc2cf941a2b752e3696328">HandleSystemNewAISituation</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>, TRUE );
<a name="l02025"></a>02025                                     }
<a name="l02026"></a>02026 
<a name="l02027"></a>02027                                     <span class="comment">// Have we finished opening doors?</span>
<a name="l02028"></a>02028                                     <span class="keywordflow">if</span> ( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#1f73b62a5ea0dd26fa1bec1d9f522b41">usAnimState</a> == <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2eb359074f290102ee9adfcf24a21f96e1d">END_OPEN_DOOR</a> || <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#1f73b62a5ea0dd26fa1bec1d9f522b41">usAnimState</a> == <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2ebfb52aa67201c256237ee874bd0db6c89">END_OPEN_DOOR_CROUCHED</a> || <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#1f73b62a5ea0dd26fa1bec1d9f522b41">usAnimState</a> == <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2ebd88d81fa3347b1d1ce9329f961272fdd">CRIPPLE_CLOSE_DOOR</a> || <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#1f73b62a5ea0dd26fa1bec1d9f522b41">usAnimState</a> == <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2ebffb17c1d21acb1e2c5a52d0317e94837">CRIPPLE_END_OPEN_DOOR</a> )
<a name="l02029"></a>02029                                     {
<a name="l02030"></a>02030                                           <span class="comment">// Are we told to continue movement...?</span>
<a name="l02031"></a>02031                                           <span class="keywordflow">if</span> ( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#cbb347ca87fea92c26a4fef7a1b27025">bEndDoorOpenCode</a> == 1 )
<a name="l02032"></a>02032                                           {
<a name="l02033"></a>02033                                                 <span class="comment">// OK, set this value to 2 such that once we are into a new gridno,</span>
<a name="l02034"></a>02034                                                 <span class="comment">// we close the door!</span>
<a name="l02035"></a>02035                                                 <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#cbb347ca87fea92c26a4fef7a1b27025">bEndDoorOpenCode</a> = 2;
<a name="l02036"></a>02036 
<a name="l02037"></a>02037                                                 <span class="comment">// yes..</span>
<a name="l02038"></a>02038                                                 <a class="code" href="Soldier_01Control_8cpp.html#b05ad69d15646823d9464ad2285fc865">EVENT_GetNewSoldierPath</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>, <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#13569e868936f0aabb70ab73640be218">sFinalDestination</a>, <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#28f15074956f36e3933f6cc10647eacf">usUIMovementMode</a> );
<a name="l02039"></a>02039 
<a name="l02040"></a>02040                                                 <span class="keywordflow">if</span> ( !( <a class="code" href="Animation_01Control_8cpp.html#633440a87c34a25c700ce620db87d036">gAnimControl</a>[ <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#1f73b62a5ea0dd26fa1bec1d9f522b41">usAnimState</a> ].uiFlags &amp; ( ANIM_MOVING ) ) )
<a name="l02041"></a>02041                                                 {
<a name="l02042"></a>02042                                                       <span class="keywordflow">if</span> ( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#e565cc6eb4167b009fc2dd1b99c824d3">sAbsoluteFinalDestination</a> != NOWHERE )
<a name="l02043"></a>02043                                                       {
<a name="l02044"></a>02044                                                             <a class="code" href="ai_8h.html#6cced4c42ca3081db5b89f6a584e549f">CancelAIAction</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>, FORCE );
<a name="l02045"></a>02045                                                       }                                                     
<a name="l02046"></a>02046                                                 }
<a name="l02047"></a>02047 
<a name="l02048"></a>02048                                                 <span class="comment">// OK, this code, pSoldier-&gt;bEndDoorOpenCode will be set to 0 if anythiing</span>
<a name="l02049"></a>02049                                                 <span class="comment">// cuases guy to stop - StopMerc() will set it...</span>
<a name="l02050"></a>02050 
<a name="l02051"></a>02051                                                 <span class="keywordflow">return</span>( TRUE );
<a name="l02052"></a>02052                                           }
<a name="l02053"></a>02053                                     }
<a name="l02054"></a>02054 
<a name="l02055"></a>02055                                     <span class="comment">// Check if we should contine into a moving animation</span>
<a name="l02056"></a>02056                                     <span class="keywordflow">if</span> ( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#10dcc042f40b20751530663b0bbbe289">usPendingAnimation</a> != NO_PENDING_ANIMATION )
<a name="l02057"></a>02057                                     {
<a name="l02058"></a>02058                                           <a class="code" href="Types_8h.html#09f1a1fb2293e33483cc8d44aefb1eb1">UINT16</a> usPendingAnimation = <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#10dcc042f40b20751530663b0bbbe289">usPendingAnimation</a>;
<a name="l02059"></a>02059 
<a name="l02060"></a>02060                                           <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#10dcc042f40b20751530663b0bbbe289">usPendingAnimation</a> = NO_PENDING_ANIMATION;
<a name="l02061"></a>02061                                           <a class="code" href="Soldier_01Control_8cpp.html#6f191e00fb4f3c5e2cbe762aa402a420">ChangeSoldierState</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>, usPendingAnimation, 0, FALSE );
<a name="l02062"></a>02062                                           <span class="keywordflow">return</span>( TRUE );
<a name="l02063"></a>02063                                     }
<a name="l02064"></a>02064 
<a name="l02065"></a>02065                                     <span class="comment">// Alrighty, do we wish to continue</span>
<a name="l02066"></a>02066                                     <span class="keywordflow">if</span> ( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#906350017de01732cd79495d831a9ee1">fContinueMoveAfterStanceChange</a> )
<a name="l02067"></a>02067                                     {
<a name="l02068"></a>02068                                           <span class="comment">// OK, if the code is == 2, get the path and try to move....</span>
<a name="l02069"></a>02069                                           <span class="keywordflow">if</span> ( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#906350017de01732cd79495d831a9ee1">fContinueMoveAfterStanceChange</a> == 2 )
<a name="l02070"></a>02070                                           {
<a name="l02071"></a>02071                                                 <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#00c7a9c8c241030433c6d931326a02cc">usPathIndex</a>++;
<a name="l02072"></a>02072 
<a name="l02073"></a>02073                                                 <span class="keywordflow">if</span> ( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#00c7a9c8c241030433c6d931326a02cc">usPathIndex</a> &gt; <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#fe684651c0a5c70874383cc13a660ee8">usPathDataSize</a> )
<a name="l02074"></a>02074                                                 {
<a name="l02075"></a>02075                                                       <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#00c7a9c8c241030433c6d931326a02cc">usPathIndex</a> = <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#fe684651c0a5c70874383cc13a660ee8">usPathDataSize</a>;
<a name="l02076"></a>02076                                                 }
<a name="l02077"></a>02077 
<a name="l02078"></a>02078                                                 <span class="keywordflow">if</span> ( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#00c7a9c8c241030433c6d931326a02cc">usPathIndex</a> == <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#fe684651c0a5c70874383cc13a660ee8">usPathDataSize</a> )
<a name="l02079"></a>02079                                                 {
<a name="l02080"></a>02080                                                       <span class="comment">// Stop, don't do anything.....</span>
<a name="l02081"></a>02081                                                 }
<a name="l02082"></a>02082                                                 <span class="keywordflow">else</span>
<a name="l02083"></a>02083                                                 {
<a name="l02084"></a>02084                                                       <a class="code" href="Soldier_01Control_8cpp.html#2f98bd1e4ef2f55b4124a6cfa69a00e3">EVENT_InitNewSoldierAnim</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>, <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#28f15074956f36e3933f6cc10647eacf">usUIMovementMode</a>, 0 , FALSE );
<a name="l02085"></a>02085 
<a name="l02086"></a>02086                                                       <span class="comment">// UNSET LOCK PENDING ACTION COUNTER FLAG</span>
<a name="l02087"></a>02087                                                       <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#eb633099940bc20ff5a969bce84eab42">uiStatusFlags</a> &amp;= ( ~SOLDIER_LOCKPENDINGACTIONCOUNTER );
<a name="l02088"></a>02088 
<a name="l02089"></a>02089                                                 }                                               
<a name="l02090"></a>02090                                           }
<a name="l02091"></a>02091                                           <span class="keywordflow">else</span>
<a name="l02092"></a>02092                                           {
<a name="l02093"></a>02093                                                 <a class="code" href="Soldier_01Control_8cpp.html#b2a2ace4d910c12400d5ab5fb2969f0e">SelectMoveAnimationFromStance</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a> );
<a name="l02094"></a>02094                                           }
<a name="l02095"></a>02095 
<a name="l02096"></a>02096                                           <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#906350017de01732cd79495d831a9ee1">fContinueMoveAfterStanceChange</a> = FALSE;
<a name="l02097"></a>02097                                           <span class="keywordflow">return</span>( TRUE );
<a name="l02098"></a>02098                                     }
<a name="l02099"></a>02099                                     <a class="code" href="Soldier_01Control_8cpp.html#abb661aaf102cd9417e7e4991838e63a">SoldierGotoStationaryStance</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a> );
<a name="l02100"></a>02100                                     <span class="keywordflow">return</span>( TRUE );
<a name="l02101"></a>02101                               }
<a name="l02102"></a>02102                               <span class="keywordflow">else</span>
<a name="l02103"></a>02103                               {
<a name="l02104"></a>02104                                     ubCurrentHeight = <a class="code" href="Animation_01Control_8cpp.html#633440a87c34a25c700ce620db87d036">gAnimControl</a>[ <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#1f73b62a5ea0dd26fa1bec1d9f522b41">usAnimState</a> ].<a class="code" href="structANIMCONTROLTYPE.html#fccdca6006bf66a4193a83b4f87dec10">ubEndHeight</a>;
<a name="l02105"></a>02105 
<a name="l02106"></a>02106                                     <span class="comment">// We need to go more, continue</span>
<a name="l02107"></a>02107                                     <span class="keywordflow">if</span> ( ubDesiredHeight == ANIM_STAND &amp;&amp; ubCurrentHeight == ANIM_CROUCH )
<a name="l02108"></a>02108                                     {
<a name="l02109"></a>02109                                            <span class="comment">// Return here because if now, we will skipp a few frames</span>
<a name="l02110"></a>02110                                            <a class="code" href="Soldier_01Control_8cpp.html#6f191e00fb4f3c5e2cbe762aa402a420">ChangeSoldierState</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>, <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2eb1b6cae859e76062deb6749216e22610d">KNEEL_UP</a>, 0 , FALSE );
<a name="l02111"></a>02111                                            <span class="keywordflow">return</span>( TRUE );
<a name="l02112"></a>02112                                     }
<a name="l02113"></a>02113                                     <span class="keywordflow">if</span> ( ubDesiredHeight == ANIM_CROUCH &amp;&amp; ubCurrentHeight == ANIM_STAND )
<a name="l02114"></a>02114                                     {
<a name="l02115"></a>02115                                            <span class="comment">// Return here because if now, we will skipp a few frames</span>
<a name="l02116"></a>02116                                            <a class="code" href="Soldier_01Control_8cpp.html#6f191e00fb4f3c5e2cbe762aa402a420">ChangeSoldierState</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>, <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2eb46a9ac5dbc94e47bb262cc481b55f16e">KNEEL_DOWN</a>, 0 , FALSE );
<a name="l02117"></a>02117                                            <span class="keywordflow">return</span>( TRUE );
<a name="l02118"></a>02118                                     }
<a name="l02119"></a>02119                                     <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( ubDesiredHeight == ANIM_PRONE &amp;&amp; ubCurrentHeight == ANIM_CROUCH )
<a name="l02120"></a>02120                                     {
<a name="l02121"></a>02121                                            <span class="comment">// Return here because if now, we will skipp a few frames</span>
<a name="l02122"></a>02122                                            <a class="code" href="Soldier_01Control_8cpp.html#6f191e00fb4f3c5e2cbe762aa402a420">ChangeSoldierState</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>, <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2ebbf08739907aab2f89b03a174f33fe872">PRONE_DOWN</a>, 0 , FALSE );
<a name="l02123"></a>02123                                            <span class="keywordflow">return</span>( TRUE );
<a name="l02124"></a>02124                                     }
<a name="l02125"></a>02125                                     <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( ubDesiredHeight == ANIM_CROUCH &amp;&amp; ubCurrentHeight == ANIM_PRONE )
<a name="l02126"></a>02126                                     {
<a name="l02127"></a>02127                                            <span class="comment">// Return here because if now, we will skipp a few frames</span>
<a name="l02128"></a>02128                                            <a class="code" href="Soldier_01Control_8cpp.html#6f191e00fb4f3c5e2cbe762aa402a420">ChangeSoldierState</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>, <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2eb9e3c526622a1549f345bc0b59336136e">PRONE_UP</a>, 0 , FALSE );
<a name="l02129"></a>02129                                            <span class="keywordflow">return</span>( TRUE );
<a name="l02130"></a>02130                                     }
<a name="l02131"></a>02131                               }
<a name="l02132"></a>02132                               <span class="comment">// IF we are here - something is wrong - we should have a death animation here</span>
<a name="l02133"></a>02133 <span class="preprocessor">                              #ifdef JA2BETAVERSION</span>
<a name="l02134"></a>02134 <span class="preprocessor"></span>                                    <a class="code" href="message_8cpp.html#818e47bc59bd5a5755f06ec51cd74928">ScreenMsg</a>( FONT_ORANGE, MSG_BETAVERSION, L<span class="stringliteral">"Soldier Ani: GOTO Stance not chained properly: %d %d %d"</span>, ubDesiredHeight, ubCurrentHeight, <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#1f73b62a5ea0dd26fa1bec1d9f522b41">usAnimState</a> );
<a name="l02135"></a>02135 <span class="preprocessor">                              #endif</span>
<a name="l02136"></a>02136 <span class="preprocessor"></span>
<a name="l02137"></a>02137                               <a class="code" href="Soldier_01Control_8cpp.html#abb661aaf102cd9417e7e4991838e63a">SoldierGotoStationaryStance</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a> );
<a name="l02138"></a>02138                               <span class="keywordflow">return</span>( TRUE );
<a name="l02139"></a>02139                   }
<a name="l02140"></a>02140 
<a name="l02141"></a>02141                   <span class="comment">// Adjust frame control pos, and try again</span>
<a name="l02142"></a>02142                   <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#d1221226402ff4b54671e0142ec90cd6">usAniCode</a>++;
<a name="l02143"></a>02143 
<a name="l02144"></a>02144             }
<a name="l02145"></a>02145             <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( sNewAniFrame &gt; 499 &amp;&amp; sNewAniFrame &lt; 599 )
<a name="l02146"></a>02146             {
<a name="l02147"></a>02147                   <span class="comment">// Jump, </span>
<a name="l02148"></a>02148                   <span class="comment">// Do not adjust, just try again</span>
<a name="l02149"></a>02149                   <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#d1221226402ff4b54671e0142ec90cd6">usAniCode</a> = sNewAniFrame - 501;                               
<a name="l02150"></a>02150             }
<a name="l02151"></a>02151             <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( sNewAniFrame &gt; 599 &amp;&amp; sNewAniFrame &lt;= 699 )
<a name="l02152"></a>02152             {
<a name="l02153"></a>02153                   <span class="comment">// Jump, to animation script</span>
<a name="l02154"></a>02154                   <a class="code" href="Soldier_01Control_8cpp.html#2f98bd1e4ef2f55b4124a6cfa69a00e3">EVENT_InitNewSoldierAnim</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>, (<a class="code" href="Types_8h.html#09f1a1fb2293e33483cc8d44aefb1eb1">UINT16</a>)(sNewAniFrame - 600 ), 0 , FALSE );
<a name="l02155"></a>02155                   <span class="keywordflow">return</span>( TRUE );
<a name="l02156"></a>02156             }
<a name="l02157"></a>02157             <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( sNewAniFrame &gt; 799 &amp;&amp; sNewAniFrame &lt;= 899 )
<a name="l02158"></a>02158             {
<a name="l02159"></a>02159                   <span class="comment">// Jump, to animation script ( But in the 100's range )</span>
<a name="l02160"></a>02160                   <a class="code" href="Soldier_01Control_8cpp.html#2f98bd1e4ef2f55b4124a6cfa69a00e3">EVENT_InitNewSoldierAnim</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>, (<a class="code" href="Types_8h.html#09f1a1fb2293e33483cc8d44aefb1eb1">UINT16</a>)(sNewAniFrame - 700 ), 0 , FALSE );
<a name="l02161"></a>02161                   <span class="keywordflow">return</span>( TRUE );
<a name="l02162"></a>02162             }
<a name="l02163"></a>02163             <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( sNewAniFrame &gt; 899 &amp;&amp; sNewAniFrame &lt;= 999 )
<a name="l02164"></a>02164             {
<a name="l02165"></a>02165                   <span class="comment">// Jump, to animation script ( But in the 200's range )</span>
<a name="l02166"></a>02166                   <a class="code" href="Soldier_01Control_8cpp.html#2f98bd1e4ef2f55b4124a6cfa69a00e3">EVENT_InitNewSoldierAnim</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>, (<a class="code" href="Types_8h.html#09f1a1fb2293e33483cc8d44aefb1eb1">UINT16</a>)(sNewAniFrame - 700 ), 0 , FALSE );
<a name="l02167"></a>02167                   <span class="keywordflow">return</span>( TRUE );
<a name="l02168"></a>02168             }
<a name="l02169"></a>02169             <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( sNewAniFrame &gt; 699 &amp;&amp; sNewAniFrame &lt; 799 )
<a name="l02170"></a>02170             {
<a name="l02171"></a>02171                   <span class="keywordflow">switch</span>( sNewAniFrame )
<a name="l02172"></a>02172                   {
<a name="l02173"></a>02173                         <span class="keywordflow">case</span> 702:
<a name="l02174"></a>02174                               <span class="comment">// Play fall to knees sound</span>
<a name="l02175"></a>02175                               <a class="code" href="Sound_01Control_8cpp.html#fde31c808018dd666dbd51cd26c6eb6e">PlaySoldierJA2Sample</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#18aef170576da81b10d00e7b6cd3627b">ubID</a>, (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)( <a class="code" href="Sound_01Control_8h.html#946995a6d03371486c23b23d9ca362b5944ebffbf5b47e58d8b84c148d21961f">FALL_1</a> + <a class="code" href="Random_8cpp.html#49f938d1313ab6ef09ac6223a16ac334">Random</a>(2) ), RATE_11025, <a class="code" href="Sound_01Control_8cpp.html#f62b2a668c2e25997578956c425723c4">SoundVolume</a>( HIGHVOLUME, <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#2ab66ee0f37902cd448f4a738df4f2bf">sGridNo</a> ), 1, <a class="code" href="Sound_01Control_8cpp.html#a258fd693b7e800828705055bf357c8d">SoundDir</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#2ab66ee0f37902cd448f4a738df4f2bf">sGridNo</a> ), FALSE );                 
<a name="l02176"></a>02176                               <span class="keywordflow">break</span>;
<a name="l02177"></a>02177 
<a name="l02178"></a>02178                         <span class="keywordflow">case</span> 703:
<a name="l02179"></a>02179                         <span class="keywordflow">case</span> 704:
<a name="l02180"></a>02180 
<a name="l02181"></a>02181                               <span class="comment">// Play footprints</span>
<a name="l02182"></a>02182                               <a class="code" href="Overhead_8cpp.html#bd5ad27fbfc272e627c34fae932bb83c">PlaySoldierFootstepSound</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a> );
<a name="l02183"></a>02183                               <span class="keywordflow">break</span>;
<a name="l02184"></a>02184 
<a name="l02185"></a>02185                         <span class="keywordflow">case</span> 705:
<a name="l02186"></a>02186                               <span class="comment">// PLay body splat sound</span>
<a name="l02187"></a>02187                               <a class="code" href="Sound_01Control_8cpp.html#fde31c808018dd666dbd51cd26c6eb6e">PlaySoldierJA2Sample</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#18aef170576da81b10d00e7b6cd3627b">ubID</a>, (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)<a class="code" href="Sound_01Control_8h.html#946995a6d03371486c23b23d9ca362b5beefb35147c7e31678cabb4d7a51e04f">BODY_SPLAT_1</a>, RATE_11025, <a class="code" href="Sound_01Control_8cpp.html#f62b2a668c2e25997578956c425723c4">SoundVolume</a>( HIGHVOLUME, <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#2ab66ee0f37902cd448f4a738df4f2bf">sGridNo</a> ), 1, <a class="code" href="Sound_01Control_8cpp.html#a258fd693b7e800828705055bf357c8d">SoundDir</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#2ab66ee0f37902cd448f4a738df4f2bf">sGridNo</a> ), TRUE );                
<a name="l02188"></a>02188                               <span class="keywordflow">break</span>;
<a name="l02189"></a>02189 
<a name="l02190"></a>02190                         <span class="keywordflow">case</span> 706:
<a name="l02191"></a>02191                               <span class="comment">// PLay head splat</span>
<a name="l02192"></a>02192                               <a class="code" href="Sound_01Control_8cpp.html#fde31c808018dd666dbd51cd26c6eb6e">PlaySoldierJA2Sample</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#18aef170576da81b10d00e7b6cd3627b">ubID</a>, (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)<a class="code" href="Sound_01Control_8h.html#946995a6d03371486c23b23d9ca362b5d4d246fed7d064577d4fb3c12466a965">HEADSPLAT_1</a>, RATE_11025, <a class="code" href="Sound_01Control_8cpp.html#f62b2a668c2e25997578956c425723c4">SoundVolume</a>( HIGHVOLUME, <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#2ab66ee0f37902cd448f4a738df4f2bf">sGridNo</a> ), 1, <a class="code" href="Sound_01Control_8cpp.html#a258fd693b7e800828705055bf357c8d">SoundDir</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#2ab66ee0f37902cd448f4a738df4f2bf">sGridNo</a> ) , TRUE );                
<a name="l02193"></a>02193                               <span class="keywordflow">break</span>;
<a name="l02194"></a>02194 
<a name="l02195"></a>02195                         <span class="keywordflow">case</span> 707:
<a name="l02196"></a>02196                               <span class="comment">// PLay creature battle cry</span>
<a name="l02197"></a>02197                               <a class="code" href="Sound_01Control_8cpp.html#ce07a5e969bc0c2ec5532c94744d786a">PlayJA2StreamingSample</a>( (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)<a class="code" href="Sound_01Control_8h.html#946995a6d03371486c23b23d9ca362b52a4389ebc58c6e555fad23266d189192">CREATURE_BATTLECRY_1</a>, RATE_11025, <a class="code" href="Sound_01Control_8cpp.html#f62b2a668c2e25997578956c425723c4">SoundVolume</a>( HIGHVOLUME, <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#2ab66ee0f37902cd448f4a738df4f2bf">sGridNo</a> ), 1, <a class="code" href="Sound_01Control_8cpp.html#a258fd693b7e800828705055bf357c8d">SoundDir</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#2ab66ee0f37902cd448f4a738df4f2bf">sGridNo</a> ) );                
<a name="l02198"></a>02198                               <span class="keywordflow">break</span>;
<a name="l02199"></a>02199 
<a name="l02200"></a>02200                         <span class="keywordflow">case</span> 708:
<a name="l02201"></a>02201 
<a name="l02202"></a>02202                               <span class="comment">// PLay lock n' load sound for gun....</span>
<a name="l02203"></a>02203                               <span class="comment">// Get LNL sound for current gun</span>
<a name="l02204"></a>02204                               {
<a name="l02205"></a>02205                                     <a class="code" href="Types_8h.html#09f1a1fb2293e33483cc8d44aefb1eb1">UINT16</a>      usItem;
<a name="l02206"></a>02206                                     <a class="code" href="Types_8h.html#09f1a1fb2293e33483cc8d44aefb1eb1">UINT16</a>      usSoundID;
<a name="l02207"></a>02207 
<a name="l02208"></a>02208                                     usItem = <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#13c875b952b6d634680165d127a9870b">inv</a>[ <a class="code" href="Soldier_01Control_8h.html#2a5937706f1724c8f06a0396bdc87855408e678e638d95e18d5e9a2a64a96e2e">HANDPOS</a> ].<a class="code" href="structOBJECTTYPE.html#4fbe05335f161f08f354566b8e5a0a19">usItem</a>;
<a name="l02209"></a>02209 
<a name="l02210"></a>02210                                     <span class="keywordflow">if</span> ( usItem != NOTHING )
<a name="l02211"></a>02211                                     {
<a name="l02212"></a>02212                                           usSoundID = <a class="code" href="Weapons_8cpp.html#fac72e30bc7c36f55257eac0542ce51d">Weapon</a>[ usItem ].<a class="code" href="structWEAPONTYPE.html#93d3d3bc19611af0a22591838ab98eee">sLocknLoadSound</a>;
<a name="l02213"></a>02213 
<a name="l02214"></a>02214                                           <span class="keywordflow">if</span> ( usSoundID != 0 )
<a name="l02215"></a>02215                                           {
<a name="l02216"></a>02216                                                 <a class="code" href="Sound_01Control_8cpp.html#6b140a8e4fcf89b7740c037ff12580a7">PlayJA2Sample</a>( usSoundID, RATE_11025, <a class="code" href="Sound_01Control_8cpp.html#f62b2a668c2e25997578956c425723c4">SoundVolume</a>( HIGHVOLUME, <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#2ab66ee0f37902cd448f4a738df4f2bf">sGridNo</a> ), 1, <a class="code" href="Sound_01Control_8cpp.html#a258fd693b7e800828705055bf357c8d">SoundDir</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#2ab66ee0f37902cd448f4a738df4f2bf">sGridNo</a> ) );             
<a name="l02217"></a>02217                                           }
<a name="l02218"></a>02218                                     }
<a name="l02219"></a>02219                               }
<a name="l02220"></a>02220                               <span class="keywordflow">break</span>;
<a name="l02221"></a>02221 
<a name="l02222"></a>02222                         <span class="keywordflow">case</span> 709:
<a name="l02223"></a>02223 
<a name="l02224"></a>02224                               <span class="comment">// Knife throw sound...</span>
<a name="l02225"></a>02225                               <a class="code" href="Sound_01Control_8cpp.html#6b140a8e4fcf89b7740c037ff12580a7">PlayJA2Sample</a>( <a class="code" href="Weapons_8cpp.html#fac72e30bc7c36f55257eac0542ce51d">Weapon</a>[ <a class="code" href="Item_01Types_8h.html#572f9555da77e1b21f4cd40aed8d20f4f31c0891b125e99ae50794766b2dbb5b">THROWING_KNIFE</a> ].sSound, RATE_11025, <a class="code" href="Sound_01Control_8cpp.html#f62b2a668c2e25997578956c425723c4">SoundVolume</a>( HIGHVOLUME, <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#2ab66ee0f37902cd448f4a738df4f2bf">sGridNo</a> ), 1, <a class="code" href="Sound_01Control_8cpp.html#a258fd693b7e800828705055bf357c8d">SoundDir</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#2ab66ee0f37902cd448f4a738df4f2bf">sGridNo</a> ) );               
<a name="l02226"></a>02226                               <span class="keywordflow">break</span>;
<a name="l02227"></a>02227 
<a name="l02228"></a>02228                         <span class="keywordflow">case</span> 710: 
<a name="l02229"></a>02229 
<a name="l02230"></a>02230                               <span class="comment">// Monster footstep in</span>
<a name="l02231"></a>02231                               <span class="keywordflow">if</span> ( <a class="code" href="Soldier_01Find_8cpp.html#020e6ae85c4b7ad07d54934ba924f6bc">SoldierOnScreen</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#18aef170576da81b10d00e7b6cd3627b">ubID</a> ) )
<a name="l02232"></a>02232                               {
<a name="l02233"></a>02233                                     <a class="code" href="Sound_01Control_8cpp.html#fde31c808018dd666dbd51cd26c6eb6e">PlaySoldierJA2Sample</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#18aef170576da81b10d00e7b6cd3627b">ubID</a>, <a class="code" href="Sound_01Control_8h.html#946995a6d03371486c23b23d9ca362b536403cbe2cfc213ccf86c2d93c686489">ACR_STEP_1</a>, RATE_11025, <a class="code" href="Sound_01Control_8cpp.html#f62b2a668c2e25997578956c425723c4">SoundVolume</a>( MIDVOLUME, <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#2ab66ee0f37902cd448f4a738df4f2bf">sGridNo</a> ), 1, <a class="code" href="Sound_01Control_8cpp.html#a258fd693b7e800828705055bf357c8d">SoundDir</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#2ab66ee0f37902cd448f4a738df4f2bf">sGridNo</a> ), TRUE );              
<a name="l02234"></a>02234                               }
<a name="l02235"></a>02235                               <span class="keywordflow">break</span>;
<a name="l02236"></a>02236 
<a name="l02237"></a>02237                         <span class="keywordflow">case</span> 711: 
<a name="l02238"></a>02238 
<a name="l02239"></a>02239                               <span class="comment">// Monster footstep in</span>
<a name="l02240"></a>02240                               <span class="keywordflow">if</span> ( <a class="code" href="Soldier_01Find_8cpp.html#020e6ae85c4b7ad07d54934ba924f6bc">SoldierOnScreen</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#18aef170576da81b10d00e7b6cd3627b">ubID</a> ) )
<a name="l02241"></a>02241                               {
<a name="l02242"></a>02242                                     <a class="code" href="Sound_01Control_8cpp.html#fde31c808018dd666dbd51cd26c6eb6e">PlaySoldierJA2Sample</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#18aef170576da81b10d00e7b6cd3627b">ubID</a>, <a class="code" href="Sound_01Control_8h.html#946995a6d03371486c23b23d9ca362b53b5b44134cab6c437e0af76b0c06594b">ACR_STEP_2</a>, RATE_11025, <a class="code" href="Sound_01Control_8cpp.html#f62b2a668c2e25997578956c425723c4">SoundVolume</a>( MIDVOLUME, <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#2ab66ee0f37902cd448f4a738df4f2bf">sGridNo</a> ), 1, <a class="code" href="Sound_01Control_8cpp.html#a258fd693b7e800828705055bf357c8d">SoundDir</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#2ab66ee0f37902cd448f4a738df4f2bf">sGridNo</a> ), TRUE );              
<a name="l02243"></a>02243                               }
<a name="l02244"></a>02244                               <span class="keywordflow">break</span>;
<a name="l02245"></a>02245 
<a name="l02246"></a>02246                         <span class="keywordflow">case</span> 712: 
<a name="l02247"></a>02247 
<a name="l02248"></a>02248                               <span class="comment">// Monster footstep in</span>
<a name="l02249"></a>02249                               <span class="keywordflow">if</span> ( <a class="code" href="Soldier_01Find_8cpp.html#020e6ae85c4b7ad07d54934ba924f6bc">SoldierOnScreen</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#18aef170576da81b10d00e7b6cd3627b">ubID</a> ) )
<a name="l02250"></a>02250                               {
<a name="l02251"></a>02251                                     <a class="code" href="Sound_01Control_8cpp.html#fde31c808018dd666dbd51cd26c6eb6e">PlaySoldierJA2Sample</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#18aef170576da81b10d00e7b6cd3627b">ubID</a>, <a class="code" href="Sound_01Control_8h.html#946995a6d03371486c23b23d9ca362b5bd40c784733ca79e9eb889547ddd52bb">LCR_MOVEMENT</a>, RATE_11025, <a class="code" href="Sound_01Control_8cpp.html#f62b2a668c2e25997578956c425723c4">SoundVolume</a>( MIDVOLUME, <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#2ab66ee0f37902cd448f4a738df4f2bf">sGridNo</a> ), 1, <a class="code" href="Sound_01Control_8cpp.html#a258fd693b7e800828705055bf357c8d">SoundDir</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#2ab66ee0f37902cd448f4a738df4f2bf">sGridNo</a> ), TRUE );                  
<a name="l02252"></a>02252                               }
<a name="l02253"></a>02253                               <span class="keywordflow">break</span>;
<a name="l02254"></a>02254 
<a name="l02255"></a>02255                         <span class="keywordflow">case</span> 713: 
<a name="l02256"></a>02256 
<a name="l02257"></a>02257                               <span class="comment">// Monster footstep in</span>
<a name="l02258"></a>02258                               <span class="keywordflow">if</span> ( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#b082364eed3d7883662f69e1fd96be1a">ubBodyType</a> == <a class="code" href="Animation_01Data_8h.html#d295a916825180b548473dec560093a7e687bcc336b8be3ac4aac1346046d095">INFANT_MONSTER</a> )
<a name="l02259"></a>02259                               {
<a name="l02260"></a>02260                                     <span class="keywordflow">if</span> ( <a class="code" href="Soldier_01Find_8cpp.html#020e6ae85c4b7ad07d54934ba924f6bc">SoldierOnScreen</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#18aef170576da81b10d00e7b6cd3627b">ubID</a> ) )
<a name="l02261"></a>02261                                     {
<a name="l02262"></a>02262                                           <a class="code" href="Sound_01Control_8cpp.html#fde31c808018dd666dbd51cd26c6eb6e">PlaySoldierJA2Sample</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#18aef170576da81b10d00e7b6cd3627b">ubID</a>, <a class="code" href="Sound_01Control_8h.html#946995a6d03371486c23b23d9ca362b5b56e2fe595d2c5a65dd0568abd57cf3c">BCR_DRAGGING</a>, RATE_11025, <a class="code" href="Sound_01Control_8cpp.html#f62b2a668c2e25997578956c425723c4">SoundVolume</a>( MIDVOLUME, <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#2ab66ee0f37902cd448f4a738df4f2bf">sGridNo</a> ), 1, <a class="code" href="Sound_01Control_8cpp.html#a258fd693b7e800828705055bf357c8d">SoundDir</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#2ab66ee0f37902cd448f4a738df4f2bf">sGridNo</a> ), TRUE );                  
<a name="l02263"></a>02263                                     }
<a name="l02264"></a>02264                               }
<a name="l02265"></a>02265                               <span class="keywordflow">break</span>;
<a name="l02266"></a>02266 
<a name="l02267"></a>02267                         <span class="keywordflow">case</span> 714:
<a name="l02268"></a>02268 
<a name="l02269"></a>02269                               <span class="comment">// Lunges....</span>
<a name="l02270"></a>02270                               <a class="code" href="Sound_01Control_8cpp.html#fde31c808018dd666dbd51cd26c6eb6e">PlaySoldierJA2Sample</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#18aef170576da81b10d00e7b6cd3627b">ubID</a>, <a class="code" href="Sound_01Control_8h.html#946995a6d03371486c23b23d9ca362b5c0c0f1143c6814f1e8dac325ef0d6708">ACR_LUNGE</a>, RATE_11025, <a class="code" href="Sound_01Control_8cpp.html#f62b2a668c2e25997578956c425723c4">SoundVolume</a>( HIGHVOLUME, <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#2ab66ee0f37902cd448f4a738df4f2bf">sGridNo</a> ), 1, <a class="code" href="Sound_01Control_8cpp.html#a258fd693b7e800828705055bf357c8d">SoundDir</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#2ab66ee0f37902cd448f4a738df4f2bf">sGridNo</a> ), TRUE );              
<a name="l02271"></a>02271                               <span class="keywordflow">break</span>;
<a name="l02272"></a>02272 
<a name="l02273"></a>02273                         <span class="keywordflow">case</span> 715:
<a name="l02274"></a>02274 
<a name="l02275"></a>02275                               <span class="comment">// Swipe</span>
<a name="l02276"></a>02276                               <a class="code" href="Sound_01Control_8cpp.html#fde31c808018dd666dbd51cd26c6eb6e">PlaySoldierJA2Sample</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#18aef170576da81b10d00e7b6cd3627b">ubID</a>, <a class="code" href="Sound_01Control_8h.html#946995a6d03371486c23b23d9ca362b5f799efa231ad5308f8e7a319da3deb7d">ACR_SWIPE</a>, RATE_11025, <a class="code" href="Sound_01Control_8cpp.html#f62b2a668c2e25997578956c425723c4">SoundVolume</a>( HIGHVOLUME, <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#2ab66ee0f37902cd448f4a738df4f2bf">sGridNo</a> ), 1, <a class="code" href="Sound_01Control_8cpp.html#a258fd693b7e800828705055bf357c8d">SoundDir</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#2ab66ee0f37902cd448f4a738df4f2bf">sGridNo</a> ), TRUE );              
<a name="l02277"></a>02277                               <span class="keywordflow">break</span>;
<a name="l02278"></a>02278 
<a name="l02279"></a>02279                         <span class="keywordflow">case</span> 716:
<a name="l02280"></a>02280 
<a name="l02281"></a>02281                               <span class="comment">// Eat flesh</span>
<a name="l02282"></a>02282                               <a class="code" href="Sound_01Control_8cpp.html#fde31c808018dd666dbd51cd26c6eb6e">PlaySoldierJA2Sample</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#18aef170576da81b10d00e7b6cd3627b">ubID</a>, <a class="code" href="Sound_01Control_8h.html#946995a6d03371486c23b23d9ca362b56115c21e67baaed78ac5cf6d45f6ebd9">ACR_EATFLESH</a>, RATE_11025, <a class="code" href="Sound_01Control_8cpp.html#f62b2a668c2e25997578956c425723c4">SoundVolume</a>( HIGHVOLUME, <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#2ab66ee0f37902cd448f4a738df4f2bf">sGridNo</a> ), 1, <a class="code" href="Sound_01Control_8cpp.html#a258fd693b7e800828705055bf357c8d">SoundDir</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#2ab66ee0f37902cd448f4a738df4f2bf">sGridNo</a> ), TRUE );                 
<a name="l02283"></a>02283                               <span class="keywordflow">break</span>;
<a name="l02284"></a>02284 
<a name="l02285"></a>02285                         <span class="keywordflow">case</span> 717:
<a name="l02286"></a>02286 
<a name="l02287"></a>02287                               <span class="comment">// Battle cry</span>
<a name="l02288"></a>02288                               {
<a name="l02289"></a>02289                                     <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a>             iSoundID=0;
<a name="l02290"></a>02290                                     <a class="code" href="Types_8h.html#112e3146cb38b6ee95e64d85842e380a">BOOLEAN</a>           fDoCry = FALSE;
<a name="l02291"></a>02291 
<a name="l02292"></a>02292                                     <span class="comment">//if ( SoldierOnScreen( pSoldier-&gt;ubID ) )</span>
<a name="l02293"></a>02293                                     {
<a name="l02294"></a>02294                                           <span class="keywordflow">switch</span>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#b4e39ed2a9e7da5cfd2284224398a896">usActionData</a> )
<a name="l02295"></a>02295                                           {
<a name="l02296"></a>02296                                                 <span class="keywordflow">case</span> <a class="code" href="ai_8h.html#87c5b7ef80df8cc40b69e386ae3e90011a4164aa9403959f913fbb4f024385a0">CALL_1_PREY</a>:
<a name="l02297"></a>02297 
<a name="l02298"></a>02298                                                       <span class="keywordflow">if</span> ( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#b082364eed3d7883662f69e1fd96be1a">ubBodyType</a> == <a class="code" href="Animation_01Data_8h.html#d295a916825180b548473dec560093a75f327a7c32f4f979f42e8d6f6adbf587">QUEENMONSTER</a> )
<a name="l02299"></a>02299                                                       {
<a name="l02300"></a>02300                                                             iSoundID = <a class="code" href="Sound_01Control_8h.html#946995a6d03371486c23b23d9ca362b5b51e393ceca5457ea131c0dc1ee9dd44">LQ_SMELLS_THREAT</a>;
<a name="l02301"></a>02301                                                       }
<a name="l02302"></a>02302                                                       <span class="keywordflow">else</span>
<a name="l02303"></a>02303                                                       {
<a name="l02304"></a>02304                                                             iSoundID = <a class="code" href="Sound_01Control_8h.html#946995a6d03371486c23b23d9ca362b55858c247f63ee292c49534086aaad77a">ACR_SMEEL_PREY</a>;
<a name="l02305"></a>02305                                                       }
<a name="l02306"></a>02306                                                       fDoCry = TRUE;
<a name="l02307"></a>02307                                                       <span class="keywordflow">break</span>;
<a name="l02308"></a>02308 
<a name="l02309"></a>02309                                                 <span class="keywordflow">case</span> <a class="code" href="ai_8h.html#87c5b7ef80df8cc40b69e386ae3e9001fd1c18675a778ace0189fa6408110374">CALL_MULTIPLE_PREY</a>:
<a name="l02310"></a>02310 
<a name="l02311"></a>02311                                                       <span class="keywordflow">if</span> ( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#b082364eed3d7883662f69e1fd96be1a">ubBodyType</a> == <a class="code" href="Animation_01Data_8h.html#d295a916825180b548473dec560093a75f327a7c32f4f979f42e8d6f6adbf587">QUEENMONSTER</a> )
<a name="l02312"></a>02312                                                       {
<a name="l02313"></a>02313                                                             iSoundID = <a class="code" href="Sound_01Control_8h.html#946995a6d03371486c23b23d9ca362b5b51e393ceca5457ea131c0dc1ee9dd44">LQ_SMELLS_THREAT</a>;
<a name="l02314"></a>02314                                                       }
<a name="l02315"></a>02315                                                       <span class="keywordflow">else</span>
<a name="l02316"></a>02316                                                       {
<a name="l02317"></a>02317                                                             iSoundID = <a class="code" href="Sound_01Control_8h.html#946995a6d03371486c23b23d9ca362b532a0f7e4ef2a34627bb27937195c984d">ACR_SMELL_THREAT</a>;
<a name="l02318"></a>02318                                                       }
<a name="l02319"></a>02319                                                       fDoCry = TRUE;
<a name="l02320"></a>02320                                                       <span class="keywordflow">break</span>;
<a name="l02321"></a>02321 
<a name="l02322"></a>02322                                                 <span class="keywordflow">case</span> <a class="code" href="ai_8h.html#87c5b7ef80df8cc40b69e386ae3e900160ec17273e6a5b5e01ccfbedb5d30d50">CALL_ATTACKED</a>:
<a name="l02323"></a>02323 
<a name="l02324"></a>02324                                                       <span class="keywordflow">if</span> ( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#b082364eed3d7883662f69e1fd96be1a">ubBodyType</a> == <a class="code" href="Animation_01Data_8h.html#d295a916825180b548473dec560093a75f327a7c32f4f979f42e8d6f6adbf587">QUEENMONSTER</a> )
<a name="l02325"></a>02325                                                       {
<a name="l02326"></a>02326                                                             iSoundID = <a class="code" href="Sound_01Control_8h.html#946995a6d03371486c23b23d9ca362b5f0e50affb4572093e5be3cda24f77b8b">LQ_ENRAGED_ATTACK</a>;
<a name="l02327"></a>02327                                                       }
<a name="l02328"></a>02328                                                       <span class="keywordflow">else</span>
<a name="l02329"></a>02329                                                       {
<a name="l02330"></a>02330                                                             iSoundID = <a class="code" href="Sound_01Control_8h.html#946995a6d03371486c23b23d9ca362b532a0f7e4ef2a34627bb27937195c984d">ACR_SMELL_THREAT</a>;
<a name="l02331"></a>02331                                                       }
<a name="l02332"></a>02332                                                       fDoCry = TRUE;
<a name="l02333"></a>02333                                                       <span class="keywordflow">break</span>;
<a name="l02334"></a>02334 
<a name="l02335"></a>02335                                                 <span class="keywordflow">case</span> <a class="code" href="ai_8h.html#87c5b7ef80df8cc40b69e386ae3e900169ecbe2b5daff49c32a0c07e4e6f961a">CALL_CRIPPLED</a>:
<a name="l02336"></a>02336 
<a name="l02337"></a>02337                                                       <span class="keywordflow">if</span> ( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#b082364eed3d7883662f69e1fd96be1a">ubBodyType</a> == <a class="code" href="Animation_01Data_8h.html#d295a916825180b548473dec560093a75f327a7c32f4f979f42e8d6f6adbf587">QUEENMONSTER</a> )
<a name="l02338"></a>02338                                                       {
<a name="l02339"></a>02339                                                             iSoundID = <a class="code" href="Sound_01Control_8h.html#946995a6d03371486c23b23d9ca362b5eddda317bb96aad501f5c63f9bb51ad3">LQ_CRIPPLED</a>;
<a name="l02340"></a>02340                                                       }
<a name="l02341"></a>02341                                                       <span class="keywordflow">else</span>
<a name="l02342"></a>02342                                                       {
<a name="l02343"></a>02343                                                             iSoundID = <a class="code" href="Sound_01Control_8h.html#946995a6d03371486c23b23d9ca362b55862a0b9824ccdde2296b00a8dcb92ad">ACR_CRIPPLED</a>;
<a name="l02344"></a>02344                                                       }
<a name="l02345"></a>02345                                                       fDoCry = TRUE;
<a name="l02346"></a>02346                                                       <span class="keywordflow">break</span>;
<a name="l02347"></a>02347                                           }
<a name="l02348"></a>02348 
<a name="l02349"></a>02349                                           <span class="keywordflow">if</span> ( fDoCry )
<a name="l02350"></a>02350                                           {
<a name="l02351"></a>02351                                                 <a class="code" href="Sound_01Control_8cpp.html#6b140a8e4fcf89b7740c037ff12580a7">PlayJA2Sample</a>( iSoundID, RATE_11025, <a class="code" href="Sound_01Control_8cpp.html#f62b2a668c2e25997578956c425723c4">SoundVolume</a>( HIGHVOLUME, <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#2ab66ee0f37902cd448f4a738df4f2bf">sGridNo</a> ), 1, <a class="code" href="Sound_01Control_8cpp.html#a258fd693b7e800828705055bf357c8d">SoundDir</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#2ab66ee0f37902cd448f4a738df4f2bf">sGridNo</a> ) );              
<a name="l02352"></a>02352                                           }
<a name="l02353"></a>02353                                     }
<a name="l02354"></a>02354                               }
<a name="l02355"></a>02355                               <span class="keywordflow">break</span>;
<a name="l02356"></a>02356 
<a name="l02357"></a>02357                         <span class="keywordflow">case</span> 718:
<a name="l02358"></a>02358 
<a name="l02359"></a>02359 
<a name="l02360"></a>02360                               <a class="code" href="Sound_01Control_8cpp.html#fde31c808018dd666dbd51cd26c6eb6e">PlaySoldierJA2Sample</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#18aef170576da81b10d00e7b6cd3627b">ubID</a>, <a class="code" href="Sound_01Control_8h.html#946995a6d03371486c23b23d9ca362b5fb1af8701ddb046623e3f8ff3079fc2e">LQ_RUPTURING</a>, RATE_11025, <a class="code" href="Sound_01Control_8cpp.html#f62b2a668c2e25997578956c425723c4">SoundVolume</a>( HIGHVOLUME, <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#2ab66ee0f37902cd448f4a738df4f2bf">sGridNo</a> ), 1, <a class="code" href="Sound_01Control_8cpp.html#a258fd693b7e800828705055bf357c8d">SoundDir</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#2ab66ee0f37902cd448f4a738df4f2bf">sGridNo</a> ), TRUE );                                               
<a name="l02361"></a>02361                               <span class="keywordflow">break</span>;
<a name="l02362"></a>02362 
<a name="l02363"></a>02363                         <span class="keywordflow">case</span> 719:
<a name="l02364"></a>02364 
<a name="l02365"></a>02365                               <span class="comment">// Spit attack start sound...                         </span>
<a name="l02366"></a>02366                               <a class="code" href="Sound_01Control_8cpp.html#fde31c808018dd666dbd51cd26c6eb6e">PlaySoldierJA2Sample</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#18aef170576da81b10d00e7b6cd3627b">ubID</a>, <a class="code" href="Sound_01Control_8h.html#946995a6d03371486c23b23d9ca362b5f0e50affb4572093e5be3cda24f77b8b">LQ_ENRAGED_ATTACK</a>, RATE_11025, <a class="code" href="Sound_01Control_8cpp.html#f62b2a668c2e25997578956c425723c4">SoundVolume</a>( HIGHVOLUME, <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#2ab66ee0f37902cd448f4a738df4f2bf">sGridNo</a> ), 1, <a class="code" href="Sound_01Control_8cpp.html#a258fd693b7e800828705055bf357c8d">SoundDir</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#2ab66ee0f37902cd448f4a738df4f2bf">sGridNo</a> ), TRUE );                                                
<a name="l02367"></a>02367                               <span class="keywordflow">break</span>;
<a name="l02368"></a>02368 
<a name="l02369"></a>02369                         <span class="keywordflow">case</span> 720:
<a name="l02370"></a>02370 
<a name="l02371"></a>02371                               <span class="comment">// Spit attack start sound...                         </span>
<a name="l02372"></a>02372                               <a class="code" href="Sound_01Control_8cpp.html#fde31c808018dd666dbd51cd26c6eb6e">PlaySoldierJA2Sample</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#18aef170576da81b10d00e7b6cd3627b">ubID</a>, <a class="code" href="Sound_01Control_8h.html#946995a6d03371486c23b23d9ca362b5c69d06bdbdb6cf373a2afecb0cb568c1">LQ_WHIP_ATTACK</a>, RATE_11025, <a class="code" href="Sound_01Control_8cpp.html#f62b2a668c2e25997578956c425723c4">SoundVolume</a>( HIGHVOLUME, <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#2ab66ee0f37902cd448f4a738df4f2bf">sGridNo</a> ), 1, <a class="code" href="Sound_01Control_8cpp.html#a258fd693b7e800828705055bf357c8d">SoundDir</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#2ab66ee0f37902cd448f4a738df4f2bf">sGridNo</a> ), TRUE );                                             
<a name="l02373"></a>02373                               <span class="keywordflow">break</span>;
<a name="l02374"></a>02374 
<a name="l02375"></a>02375                         <span class="keywordflow">case</span> 721:
<a name="l02376"></a>02376                               <span class="comment">// Play fall from knees to ground...</span>
<a name="l02377"></a>02377                               <a class="code" href="Sound_01Control_8cpp.html#fde31c808018dd666dbd51cd26c6eb6e">PlaySoldierJA2Sample</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#18aef170576da81b10d00e7b6cd3627b">ubID</a>, (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)( <a class="code" href="Sound_01Control_8h.html#946995a6d03371486c23b23d9ca362b5995475fd5c436d871d165119bf793e67">FALL_TO_GROUND_1</a> + <a class="code" href="Random_8cpp.html#49f938d1313ab6ef09ac6223a16ac334">Random</a>(3) ), RATE_11025, <a class="code" href="Sound_01Control_8cpp.html#f62b2a668c2e25997578956c425723c4">SoundVolume</a>( HIGHVOLUME, <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#2ab66ee0f37902cd448f4a738df4f2bf">sGridNo</a> ), 1, <a class="code" href="Sound_01Control_8cpp.html#a258fd693b7e800828705055bf357c8d">SoundDir</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#2ab66ee0f37902cd448f4a738df4f2bf">sGridNo</a> ), FALSE );             
<a name="l02378"></a>02378                               <span class="keywordflow">if</span> ( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#1f73b62a5ea0dd26fa1bec1d9f522b41">usAnimState</a> == <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2eb5734c6c3b78cd8b8f5ed5d27b48b44d3">FALLFORWARD_FROMHIT_STAND</a> )
<a name="l02379"></a>02379                               {
<a name="l02380"></a>02380                                     <a class="code" href="Items_8cpp.html#9158ee3e8707754d6c6b9d8422964df3">CheckEquipmentForFragileItemDamage</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>, 20 );
<a name="l02381"></a>02381                               }
<a name="l02382"></a>02382                               <span class="keywordflow">break</span>;
<a name="l02383"></a>02383 
<a name="l02384"></a>02384                         <span class="keywordflow">case</span> 722:
<a name="l02385"></a>02385                               <span class="comment">// Play fall heavy</span>
<a name="l02386"></a>02386                               <a class="code" href="Sound_01Control_8cpp.html#fde31c808018dd666dbd51cd26c6eb6e">PlaySoldierJA2Sample</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#18aef170576da81b10d00e7b6cd3627b">ubID</a>, (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)( <a class="code" href="Sound_01Control_8h.html#946995a6d03371486c23b23d9ca362b5141c09e5bbe5a96599787720dcc6bc41">HEAVY_FALL_1</a> ), RATE_11025, <a class="code" href="Sound_01Control_8cpp.html#f62b2a668c2e25997578956c425723c4">SoundVolume</a>( HIGHVOLUME, <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#2ab66ee0f37902cd448f4a738df4f2bf">sGridNo</a> ), 1, <a class="code" href="Sound_01Control_8cpp.html#a258fd693b7e800828705055bf357c8d">SoundDir</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#2ab66ee0f37902cd448f4a738df4f2bf">sGridNo</a> ), FALSE );                 
<a name="l02387"></a>02387                               <span class="keywordflow">if</span> ( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#1f73b62a5ea0dd26fa1bec1d9f522b41">usAnimState</a> == <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2eb895efb01905b4bfc2f8d0ef505b7e9bd">FALLFORWARD_FROMHIT_CROUCH</a> )
<a name="l02388"></a>02388                               {
<a name="l02389"></a>02389                                     <a class="code" href="Items_8cpp.html#9158ee3e8707754d6c6b9d8422964df3">CheckEquipmentForFragileItemDamage</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>, 15 );
<a name="l02390"></a>02390                               }
<a name="l02391"></a>02391                               <span class="keywordflow">break</span>;
<a name="l02392"></a>02392 
<a name="l02393"></a>02393                         <span class="keywordflow">case</span> 723:
<a name="l02394"></a>02394 
<a name="l02395"></a>02395                               <span class="comment">// Play armpit noise...</span>
<a name="l02396"></a>02396                               <a class="code" href="Sound_01Control_8cpp.html#fde31c808018dd666dbd51cd26c6eb6e">PlaySoldierJA2Sample</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#18aef170576da81b10d00e7b6cd3627b">ubID</a>, (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)( <a class="code" href="Sound_01Control_8h.html#946995a6d03371486c23b23d9ca362b51e152f277150686f6d2931614e753928">IDLE_ARMPIT</a> ), RATE_11025, <a class="code" href="Sound_01Control_8cpp.html#f62b2a668c2e25997578956c425723c4">SoundVolume</a>( LOWVOLUME, <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#2ab66ee0f37902cd448f4a738df4f2bf">sGridNo</a> ), 1, <a class="code" href="Sound_01Control_8cpp.html#a258fd693b7e800828705055bf357c8d">SoundDir</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#2ab66ee0f37902cd448f4a738df4f2bf">sGridNo</a> ), TRUE );              
<a name="l02397"></a>02397                               <span class="keywordflow">break</span>;
<a name="l02398"></a>02398 
<a name="l02399"></a>02399                         <span class="keywordflow">case</span> 724:
<a name="l02400"></a>02400 
<a name="l02401"></a>02401                               <span class="comment">// Play ass scratch</span>
<a name="l02402"></a>02402                               <span class="comment">// PlaySoldierJA2Sample( pSoldier-&gt;ubID, (UINT8)( IDLE_SCRATCH ), RATE_11025, SoundVolume( HIGHVOLUME, pSoldier-&gt;sGridNo ), 1, SoundDir( pSoldier-&gt;sGridNo ), TRUE );               </span>
<a name="l02403"></a>02403                               <span class="keywordflow">break</span>;
<a name="l02404"></a>02404 
<a name="l02405"></a>02405                         <span class="keywordflow">case</span> 725:
<a name="l02406"></a>02406 
<a name="l02407"></a>02407                               <span class="comment">// Play back crack</span>
<a name="l02408"></a>02408                               <a class="code" href="Sound_01Control_8cpp.html#fde31c808018dd666dbd51cd26c6eb6e">PlaySoldierJA2Sample</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#18aef170576da81b10d00e7b6cd3627b">ubID</a>, (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)( <a class="code" href="Sound_01Control_8h.html#946995a6d03371486c23b23d9ca362b5e4b76e4f40a32c258cf4fe46d9ed30f2">IDLE_BACKCRACK</a> ), RATE_11025, <a class="code" href="Sound_01Control_8cpp.html#f62b2a668c2e25997578956c425723c4">SoundVolume</a>( LOWVOLUME, <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#2ab66ee0f37902cd448f4a738df4f2bf">sGridNo</a> ), 1, <a class="code" href="Sound_01Control_8cpp.html#a258fd693b7e800828705055bf357c8d">SoundDir</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#2ab66ee0f37902cd448f4a738df4f2bf">sGridNo</a> ), TRUE );                 
<a name="l02409"></a>02409                               <span class="keywordflow">break</span>;
<a name="l02410"></a>02410 
<a name="l02411"></a>02411                         <span class="keywordflow">case</span> 726:
<a name="l02412"></a>02412 
<a name="l02413"></a>02413                               <span class="comment">// Kickin door</span>
<a name="l02414"></a>02414                               <a class="code" href="Sound_01Control_8cpp.html#fde31c808018dd666dbd51cd26c6eb6e">PlaySoldierJA2Sample</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#18aef170576da81b10d00e7b6cd3627b">ubID</a>, (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)( <a class="code" href="Sound_01Control_8h.html#946995a6d03371486c23b23d9ca362b5612db2ffd473117fc598c95190855cac">KICKIN_DOOR</a> ), RATE_11025, <a class="code" href="Sound_01Control_8cpp.html#f62b2a668c2e25997578956c425723c4">SoundVolume</a>( HIGHVOLUME, <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#2ab66ee0f37902cd448f4a738df4f2bf">sGridNo</a> ), 1, <a class="code" href="Sound_01Control_8cpp.html#a258fd693b7e800828705055bf357c8d">SoundDir</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#2ab66ee0f37902cd448f4a738df4f2bf">sGridNo</a> ), TRUE );             
<a name="l02415"></a>02415                               <span class="keywordflow">break</span>;
<a name="l02416"></a>02416 
<a name="l02417"></a>02417                         <span class="keywordflow">case</span> 727:
<a name="l02418"></a>02418 
<a name="l02419"></a>02419                               <span class="comment">// Swoosh</span>
<a name="l02420"></a>02420                               <a class="code" href="Sound_01Control_8cpp.html#fde31c808018dd666dbd51cd26c6eb6e">PlaySoldierJA2Sample</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#18aef170576da81b10d00e7b6cd3627b">ubID</a>, (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)( <a class="code" href="Sound_01Control_8h.html#946995a6d03371486c23b23d9ca362b51635867d39b03659d71cd25b0c55b48b">SWOOSH_1</a> + <a class="code" href="Random_8cpp.html#49f938d1313ab6ef09ac6223a16ac334">Random</a>( 6 ) ), RATE_11025, <a class="code" href="Sound_01Control_8cpp.html#f62b2a668c2e25997578956c425723c4">SoundVolume</a>( HIGHVOLUME, <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#2ab66ee0f37902cd448f4a738df4f2bf">sGridNo</a> ), 1, <a class="code" href="Sound_01Control_8cpp.html#a258fd693b7e800828705055bf357c8d">SoundDir</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#2ab66ee0f37902cd448f4a738df4f2bf">sGridNo</a> ), TRUE );                                            
<a name="l02421"></a>02421                               <span class="keywordflow">break</span>;
<a name="l02422"></a>02422 
<a name="l02423"></a>02423                         <span class="keywordflow">case</span> 728:
<a name="l02424"></a>02424 
<a name="l02425"></a>02425                               <span class="comment">// Creature fall</span>
<a name="l02426"></a>02426                               <a class="code" href="Sound_01Control_8cpp.html#fde31c808018dd666dbd51cd26c6eb6e">PlaySoldierJA2Sample</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#18aef170576da81b10d00e7b6cd3627b">ubID</a>, (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)( <a class="code" href="Sound_01Control_8h.html#946995a6d03371486c23b23d9ca362b50dada5cd53dc810aa7f300b5f27b8d21">ACR_FALL_1</a> ), RATE_11025, <a class="code" href="Sound_01Control_8cpp.html#f62b2a668c2e25997578956c425723c4">SoundVolume</a>( HIGHVOLUME, <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#2ab66ee0f37902cd448f4a738df4f2bf">sGridNo</a> ), 1, <a class="code" href="Sound_01Control_8cpp.html#a258fd693b7e800828705055bf357c8d">SoundDir</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#2ab66ee0f37902cd448f4a738df4f2bf">sGridNo</a> ), TRUE );                                            
<a name="l02427"></a>02427                               <span class="keywordflow">break</span>;
<a name="l02428"></a>02428 
<a name="l02429"></a>02429                         <span class="keywordflow">case</span> 729:
<a name="l02430"></a>02430 
<a name="l02431"></a>02431                               <span class="comment">// grab roof....</span>
<a name="l02432"></a>02432                               <a class="code" href="Sound_01Control_8cpp.html#fde31c808018dd666dbd51cd26c6eb6e">PlaySoldierJA2Sample</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#18aef170576da81b10d00e7b6cd3627b">ubID</a>, (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)( <a class="code" href="Sound_01Control_8h.html#946995a6d03371486c23b23d9ca362b5391e733cdc97aaab58ff4e9b66ff97e9">GRAB_ROOF</a> ), RATE_11025, <a class="code" href="Sound_01Control_8cpp.html#f62b2a668c2e25997578956c425723c4">SoundVolume</a>( HIGHVOLUME, <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#2ab66ee0f37902cd448f4a738df4f2bf">sGridNo</a> ), 1, <a class="code" href="Sound_01Control_8cpp.html#a258fd693b7e800828705055bf357c8d">SoundDir</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#2ab66ee0f37902cd448f4a738df4f2bf">sGridNo</a> ), TRUE );                                             
<a name="l02433"></a>02433                               <span class="keywordflow">break</span>;
<a name="l02434"></a>02434 
<a name="l02435"></a>02435                         <span class="keywordflow">case</span> 730:
<a name="l02436"></a>02436 
<a name="l02437"></a>02437                               <span class="comment">// end climb roof....</span>
<a name="l02438"></a>02438                               <a class="code" href="Sound_01Control_8cpp.html#fde31c808018dd666dbd51cd26c6eb6e">PlaySoldierJA2Sample</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#18aef170576da81b10d00e7b6cd3627b">ubID</a>, (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)( <a class="code" href="Sound_01Control_8h.html#946995a6d03371486c23b23d9ca362b55fe644d67259bac4b090d248b12ecb03">LAND_ON_ROOF</a> ), RATE_11025, <a class="code" href="Sound_01Control_8cpp.html#f62b2a668c2e25997578956c425723c4">SoundVolume</a>( HIGHVOLUME, <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#2ab66ee0f37902cd448f4a738df4f2bf">sGridNo</a> ), 1, <a class="code" href="Sound_01Control_8cpp.html#a258fd693b7e800828705055bf357c8d">SoundDir</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#2ab66ee0f37902cd448f4a738df4f2bf">sGridNo</a> ), TRUE );                                                
<a name="l02439"></a>02439                               <span class="keywordflow">break</span>;
<a name="l02440"></a>02440 
<a name="l02441"></a>02441                         <span class="keywordflow">case</span> 731:
<a name="l02442"></a>02442 
<a name="l02443"></a>02443                               <span class="comment">// Stop climb roof..</span>
<a name="l02444"></a>02444                               <a class="code" href="Sound_01Control_8cpp.html#fde31c808018dd666dbd51cd26c6eb6e">PlaySoldierJA2Sample</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#18aef170576da81b10d00e7b6cd3627b">ubID</a>, (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)( <a class="code" href="Sound_01Control_8h.html#946995a6d03371486c23b23d9ca362b5995475fd5c436d871d165119bf793e67">FALL_TO_GROUND_1</a> + <a class="code" href="Random_8cpp.html#49f938d1313ab6ef09ac6223a16ac334">Random</a>(3) ), RATE_11025, <a class="code" href="Sound_01Control_8cpp.html#f62b2a668c2e25997578956c425723c4">SoundVolume</a>( HIGHVOLUME, <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#2ab66ee0f37902cd448f4a738df4f2bf">sGridNo</a> ), 1, <a class="code" href="Sound_01Control_8cpp.html#a258fd693b7e800828705055bf357c8d">SoundDir</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#2ab66ee0f37902cd448f4a738df4f2bf">sGridNo</a> ), TRUE );              
<a name="l02445"></a>02445                               <span class="keywordflow">break</span>;
<a name="l02446"></a>02446 
<a name="l02447"></a>02447                         <span class="keywordflow">case</span> 732:
<a name="l02448"></a>02448 
<a name="l02449"></a>02449                               <span class="comment">// Play die sound</span>
<a name="l02450"></a>02450                               <a class="code" href="Soldier_01Control_8cpp.html#62effc98ffa51ddb2fc78301c82acdb8">DoMercBattleSound</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>, <a class="code" href="Soldier_01Control_8h.html#3ab071cf265666f49f6e3f6639d69f0abf28cedf54317c01049c44943809631d">BATTLE_SOUND_DIE1</a> );
<a name="l02451"></a>02451                               <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#8776fc5db81036f7b2c071457dd02eb4">fDeadSoundPlayed</a> = TRUE;
<a name="l02452"></a>02452                               <span class="keywordflow">break</span>;
<a name="l02453"></a>02453 
<a name="l02454"></a>02454                         <span class="keywordflow">case</span> 750:
<a name="l02455"></a>02455 
<a name="l02456"></a>02456                               <span class="comment">// CODE: Move Vehicle UP</span>
<a name="l02457"></a>02457                               <span class="keywordflow">if</span> ( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#eb633099940bc20ff5a969bce84eab42">uiStatusFlags</a> &amp; SOLDIER_VEHICLE )
<a name="l02458"></a>02458                               {
<a name="l02459"></a>02459                               <span class="comment">//    SetSoldierHeight( pSoldier, (FLOAT)( pSoldier-&gt;sHeightAdjustment + 1 ) );</span>
<a name="l02460"></a>02460                               }
<a name="l02461"></a>02461                               <span class="keywordflow">break</span>;
<a name="l02462"></a>02462 
<a name="l02463"></a>02463                         <span class="keywordflow">case</span> 751:
<a name="l02464"></a>02464 
<a name="l02465"></a>02465                               <span class="comment">// CODE: Move vehicle down</span>
<a name="l02466"></a>02466                               <span class="keywordflow">if</span> ( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#eb633099940bc20ff5a969bce84eab42">uiStatusFlags</a> &amp; SOLDIER_VEHICLE )
<a name="l02467"></a>02467                               {
<a name="l02468"></a>02468                         <span class="comment">//          SetSoldierHeight( pSoldier, (FLOAT)( pSoldier-&gt;sHeightAdjustment - 1 ) );</span>
<a name="l02469"></a>02469                               }
<a name="l02470"></a>02470                               <span class="keywordflow">break</span>;
<a name="l02471"></a>02471 
<a name="l02472"></a>02472                         <span class="keywordflow">case</span> 752:
<a name="l02473"></a>02473 
<a name="l02474"></a>02474                               <span class="comment">// Code: decapitate</span>
<a name="l02475"></a>02475                               <a class="code" href="Rotting_01Corpses_8cpp.html#78d7f0ec13c8d10ce92db4fac6fe6414">DecapitateCorpse</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>, <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#97fff971b8c532135f0c0451deac7aa1">sTargetGridNo</a>, <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#e29f2821a7f319ffe6405848dabb4c6b">bTargetLevel</a> );
<a name="l02476"></a>02476                               <span class="keywordflow">break</span>;
<a name="l02477"></a>02477 
<a name="l02478"></a>02478                         <span class="keywordflow">case</span> 753:
<a name="l02479"></a>02479 
<a name="l02480"></a>02480                               <span class="comment">// code: freeup attcker</span>
<a name="l02481"></a>02481                               DebugMsg( <a class="code" href="DEBUG_8cpp.html#a7985c2fd033797fc67a03b2c26e07c6">TOPIC_JA2</a>, DBG_LEVEL_3, <a class="code" href="DEBUG_8cpp.html#88565bf27eec0b2003eb5bc9426b8e4b">String</a>(<span class="stringliteral">"@@@@@@@ Reducing attacker busy count..., CODE FROM ANIMATION %s ( %d )"</span>, <a class="code" href="Animation_01Control_8cpp.html#633440a87c34a25c700ce620db87d036">gAnimControl</a>[ <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#1f73b62a5ea0dd26fa1bec1d9f522b41">usAnimState</a> ].zAnimStr, <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#1f73b62a5ea0dd26fa1bec1d9f522b41">usAnimState</a> ) );
<a name="l02482"></a>02482                               <a class="code" href="Overhead_8cpp.html#de6952977d9c0a18bd743e5c7dc226ba">ReduceAttackBusyCount</a>( (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>) <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#18aef170576da81b10d00e7b6cd3627b">ubID</a>, FALSE );
<a name="l02483"></a>02483 
<a name="l02484"></a>02484           <span class="comment">// ATE: Here, reduce again if creaturequeen tentical attack...</span>
<a name="l02485"></a>02485           <span class="keywordflow">if</span> ( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#1f73b62a5ea0dd26fa1bec1d9f522b41">usAnimState</a> == <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2eb7a31b4bc105bae98ed24b38bf746fff5">QUEEN_SWIPE</a> )
<a name="l02486"></a>02486           {
<a name="l02487"></a>02487                                 DebugMsg( <a class="code" href="DEBUG_8cpp.html#a7985c2fd033797fc67a03b2c26e07c6">TOPIC_JA2</a>, DBG_LEVEL_3, <a class="code" href="DEBUG_8cpp.html#88565bf27eec0b2003eb5bc9426b8e4b">String</a>(<span class="stringliteral">"@@@@@@@ Reducing attacker busy count for end of queen swipe"</span> ) );
<a name="l02488"></a>02488                                 <a class="code" href="Overhead_8cpp.html#de6952977d9c0a18bd743e5c7dc226ba">ReduceAttackBusyCount</a>( (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>) <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#18aef170576da81b10d00e7b6cd3627b">ubID</a>, FALSE );
<a name="l02489"></a>02489           }
<a name="l02490"></a>02490                               <span class="keywordflow">break</span>;
<a name="l02491"></a>02491 
<a name="l02492"></a>02492                         <span class="keywordflow">case</span> 754:
<a name="l02493"></a>02493 
<a name="l02494"></a>02494                               <a class="code" href="pits_8cpp.html#e357a416b15cb36cfc54e007da0633eb">HandleFallIntoPitFromAnimation</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#18aef170576da81b10d00e7b6cd3627b">ubID</a> );
<a name="l02495"></a>02495                               <span class="keywordflow">break</span>;
<a name="l02496"></a>02496 
<a name="l02497"></a>02497                         <span class="keywordflow">case</span> 755 :
<a name="l02498"></a>02498 
<a name="l02499"></a>02499                               <a class="code" href="Weapons_8cpp.html#de17ad0ca2457ec2ab4a361ba4d6589d">DishoutQueenSwipeDamage</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a> );
<a name="l02500"></a>02500                               <span class="keywordflow">break</span>;
<a name="l02501"></a>02501 
<a name="l02502"></a>02502                         <span class="keywordflow">case</span> 756:
<a name="l02503"></a>02503 
<a name="l02504"></a>02504                               <span class="comment">// Reload robot....</span>
<a name="l02505"></a>02505                               {
<a name="l02506"></a>02506                                     <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>                   ubPerson;
<a name="l02507"></a>02507                                     <a class="code" href="structSOLDIERTYPE.html">SOLDIERTYPE</a> *pRobot;
<a name="l02508"></a>02508 
<a name="l02509"></a>02509                                     <span class="comment">// Get pointer...</span>
<a name="l02510"></a>02510                                     ubPerson = <a class="code" href="worldman_8cpp.html#87338f0c77765726813428fd184bfcd8">WhoIsThere2</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#7bf70f6f1b637647860538cd60b5399c">sPendingActionData2</a>, <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#0d1f73c5d0ac839ec84a4792505949cb">bLevel</a> );
<a name="l02511"></a>02511 
<a name="l02512"></a>02512                                     <span class="keywordflow">if</span> ( ubPerson != NOBODY &amp;&amp; <a class="code" href="Overhead_8cpp.html#2b9a828d7d92ec404b2f9a39fc001177">MercPtrs</a>[ ubPerson ]-&gt;uiStatusFlags &amp; SOLDIER_ROBOT )
<a name="l02513"></a>02513                                     {
<a name="l02514"></a>02514                                           pRobot = <a class="code" href="Overhead_8cpp.html#2b9a828d7d92ec404b2f9a39fc001177">MercPtrs</a>[ ubPerson ];
<a name="l02515"></a>02515 
<a name="l02516"></a>02516                                           <a class="code" href="Items_8cpp.html#298457e1bbeb31631f8a26037c6631e4">ReloadGun</a>( pRobot, &amp;(pRobot-&gt;<a class="code" href="structSOLDIERTYPE.html#13c875b952b6d634680165d127a9870b">inv</a>[ <a class="code" href="Soldier_01Control_8h.html#2a5937706f1724c8f06a0396bdc87855408e678e638d95e18d5e9a2a64a96e2e">HANDPOS</a> ] ), <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#c8e5d4de5c5e5af59fc90d9c545a6bce">pTempObject</a> );
<a name="l02517"></a>02517 
<a name="l02518"></a>02518                                           <span class="comment">// OK, check what was returned and place in inventory if it's non-zero</span>
<a name="l02519"></a>02519                                           <span class="keywordflow">if</span> ( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#c8e5d4de5c5e5af59fc90d9c545a6bce">pTempObject</a>-&gt;<a class="code" href="structOBJECTTYPE.html#4fbe05335f161f08f354566b8e5a0a19">usItem</a> != NOTHING )
<a name="l02520"></a>02520                                           {
<a name="l02521"></a>02521                                                 <span class="comment">// Add to inv..</span>
<a name="l02522"></a>02522                                                 <a class="code" href="Items_8cpp.html#b0cdccd7f510d5464ab386cb5b69c28f">AutoPlaceObject</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>, pSoldier-&gt;<a class="code" href="structSOLDIERTYPE.html#c8e5d4de5c5e5af59fc90d9c545a6bce">pTempObject</a>, TRUE );
<a name="l02523"></a>02523                                           }
<a name="l02524"></a>02524 
<a name="l02525"></a>02525                                           MemFree( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#c8e5d4de5c5e5af59fc90d9c545a6bce">pTempObject</a> );
<a name="l02526"></a>02526                                           <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#c8e5d4de5c5e5af59fc90d9c545a6bce">pTempObject</a> = NULL;
<a name="l02527"></a>02527                                     }
<a name="l02528"></a>02528                               }
<a name="l02529"></a>02529                               <span class="keywordflow">break</span>;
<a name="l02530"></a>02530 
<a name="l02531"></a>02531                         <span class="keywordflow">case</span> 757:
<a name="l02532"></a>02532 
<a name="l02533"></a>02533                               <span class="comment">// INcrement attacker busy count....</span>
<a name="l02534"></a>02534                               <a class="code" href="Overhead_8cpp.html#46bd754f8875c305ab18731ed10e3364">gTacticalStatus</a>.<a class="code" href="structTacticalStatusType.html#b44a086b36d7dd7af18e11f8fdea4d05">ubAttackBusyCount</a>++;
<a name="l02535"></a>02535                               DebugMsg( TOPIC_JA2, DBG_LEVEL_3, <a class="code" href="DEBUG_8cpp.html#88565bf27eec0b2003eb5bc9426b8e4b">String</a>(<span class="stringliteral">"!!!!! Incrementing attacker busy count..., CODE FROM ANIMATION %s ( %d ) : Count now %d"</span>, <a class="code" href="Animation_01Control_8cpp.html#633440a87c34a25c700ce620db87d036">gAnimControl</a>[ <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#1f73b62a5ea0dd26fa1bec1d9f522b41">usAnimState</a> ].zAnimStr, <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#1f73b62a5ea0dd26fa1bec1d9f522b41">usAnimState</a>, <a class="code" href="Overhead_8cpp.html#46bd754f8875c305ab18731ed10e3364">gTacticalStatus</a>.<a class="code" href="structTacticalStatusType.html#b44a086b36d7dd7af18e11f8fdea4d05">ubAttackBusyCount</a> ) );
<a name="l02536"></a>02536                               <span class="keywordflow">break</span>;
<a name="l02537"></a>02537 
<a name="l02538"></a>02538                         <span class="keywordflow">case</span> 758:
<a name="l02539"></a>02539 
<a name="l02540"></a>02540                               <span class="comment">// Trigger after slap...</span>
<a name="l02541"></a>02541                               <a class="code" href="NPC_8cpp.html#d7f92a649ae364cf3c2b7b69c4806bd0">TriggerNPCWithGivenApproach</a>( <a class="code" href="Soldier_01Profile_8h.html#acaa92dcb344e96138c964deae3e2fa158561257be7e2f96f82c0fdb51d7f964">QUEEN</a>, <a class="code" href="NPC_8h.html#fe4ba80db4eca5533465fe913160a13ab03dc54bc62e0afa9aef7cd9256c263b">APPROACH_DONE_SLAPPED</a> , TRUE );
<a name="l02542"></a>02542                               <span class="keywordflow">break</span>;
<a name="l02543"></a>02543 
<a name="l02544"></a>02544                         <span class="keywordflow">case</span> 759:
<a name="l02545"></a>02545 
<a name="l02546"></a>02546                               <span class="comment">// Getting hit by slap</span>
<a name="l02547"></a>02547                               {
<a name="l02548"></a>02548                                     <a class="code" href="structSOLDIERTYPE.html">SOLDIERTYPE</a> *pTarget;
<a name="l02549"></a>02549 
<a name="l02550"></a>02550                                     pTarget = <a class="code" href="Soldier_01Profile_8cpp.html#2a54c4a06df8ed61529646f23682ef9d">FindSoldierByProfileID</a>( <a class="code" href="Soldier_01Profile_8h.html#acaa92dcb344e96138c964deae3e2fa16960fe1226f34f684b9dbdf6ab84817f">ELLIOT</a>, FALSE );
<a name="l02551"></a>02551 
<a name="l02552"></a>02552                                     <span class="keywordflow">if</span> ( pTarget )
<a name="l02553"></a>02553                                     {
<a name="l02554"></a>02554                                           <a class="code" href="Soldier_01Control_8cpp.html#2f98bd1e4ef2f55b4124a6cfa69a00e3">EVENT_InitNewSoldierAnim</a>( pTarget, <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2eb8ffd24e6641f68d9087e9ff7529fb6b2">SLAP_HIT</a>, 0 , FALSE );                                                                     
<a name="l02555"></a>02555 
<a name="l02556"></a>02556                                           <span class="comment">// Play noise....</span>
<a name="l02557"></a>02557                                           <span class="comment">//PlaySoldierJA2Sample( pTarget-&gt;ubID, ( S_SLAP_IMPACT ), RATE_11025, SoundVolume( HIGHVOLUME, pTarget-&gt;sGridNo ), 1, SoundDir( pTarget-&gt;sGridNo ), TRUE );             </span>
<a name="l02558"></a>02558 
<a name="l02559"></a>02559                                           <span class="comment">//DoMercBattleSound( pTarget, (INT8)( BATTLE_SOUND_HIT1 + Random( 2 ) ) );</span>
<a name="l02560"></a>02560 
<a name="l02561"></a>02561                                     }
<a name="l02562"></a>02562                               }
<a name="l02563"></a>02563                               <span class="keywordflow">break</span>;
<a name="l02564"></a>02564 
<a name="l02565"></a>02565                         <span class="keywordflow">case</span> 760:
<a name="l02566"></a>02566 
<a name="l02567"></a>02567                               <span class="comment">// Get some blood.....</span>
<a name="l02568"></a>02568                               <span class="comment">// Corpse Id is from pending action data</span>
<a name="l02569"></a>02569                               <a class="code" href="Rotting_01Corpses_8cpp.html#00ba86b1737d15734938b63ba485b083">GetBloodFromCorpse</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a> );
<a name="l02570"></a>02570                               <span class="comment">// Dirty interface....</span>
<a name="l02571"></a>02571                               <a class="code" href="Interface_8cpp.html#8a607488839071ed48da8a73aeaad595">DirtyMercPanelInterface</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>, DIRTYLEVEL2 );
<a name="l02572"></a>02572                               <span class="keywordflow">break</span>;
<a name="l02573"></a>02573 
<a name="l02574"></a>02574                         <span class="keywordflow">case</span> 761:
<a name="l02575"></a>02575 
<a name="l02576"></a>02576                               {
<a name="l02577"></a>02577                                     <span class="comment">// Dish out damage!</span>
<a name="l02578"></a>02578                                     <a class="code" href="Soldier_01Control_8cpp.html#fd682f78ff74004954749b59e523e7ce">EVENT_SoldierGotHit</a>( <a class="code" href="Overhead_8cpp.html#2b9a828d7d92ec404b2f9a39fc001177">MercPtrs</a>[ <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#304094e7d2a05131c34f41c46dfb6fad">uiPendingActionData4</a> ], TAKE_DAMAGE_BLADE, (<a class="code" href="Types_8h.html#30f500129d8c688af07726d5d34ce52d">INT16</a>) 25, (<a class="code" href="Types_8h.html#30f500129d8c688af07726d5d34ce52d">INT16</a>) 25, <a class="code" href="Isometric_01Utils_8cpp.html#9591ab6c902758a420fd3d9f4e49ba2e">gOppositeDirection</a>[ <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#8aa6174a253c3fa21a3ec41ce0174340">bDirection</a> ], 50, <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#18aef170576da81b10d00e7b6cd3627b">ubID</a>, 0, ANIM_PRONE, 0, 0 );
<a name="l02579"></a>02579                               }
<a name="l02580"></a>02580                               <span class="keywordflow">break</span>;
<a name="l02581"></a>02581 
<a name="l02582"></a>02582                         <span class="keywordflow">case</span> 762:
<a name="l02583"></a>02583                               {
<a name="l02584"></a>02584                                     <span class="comment">// CODE: Set off Trigger</span>
<a name="l02585"></a>02585                                     <a class="code" href="Types_8h.html#7ebe70ceca856797319175e30bcf003d">INT8</a>  bPanicTrigger;
<a name="l02586"></a>02586 
<a name="l02587"></a>02587                                     bPanicTrigger = <a class="code" href="ai_8h.html#3b35c9a19cdfec1ea7fd44a0eb15a0ae">ClosestPanicTrigger</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a> );
<a name="l02588"></a>02588                                     <a class="code" href="Explosion_01Control_8cpp.html#d8bc4ed51c714aaa300ef23e9207e088">SetOffPanicBombs</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#18aef170576da81b10d00e7b6cd3627b">ubID</a>, bPanicTrigger );
<a name="l02589"></a>02589                                     <span class="comment">// any AI guy has been specially given keys for this, now take them</span>
<a name="l02590"></a>02590                                     <span class="comment">// away</span>
<a name="l02591"></a>02591                                     <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#7f520f3cdb6d5f0d3db75e1e9ca3f29d">bHasKeys</a> = <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#7f520f3cdb6d5f0d3db75e1e9ca3f29d">bHasKeys</a> &gt;&gt; 1;
<a name="l02592"></a>02592 
<a name="l02593"></a>02593                               }
<a name="l02594"></a>02594                               <span class="keywordflow">break</span>;
<a name="l02595"></a>02595 
<a name="l02596"></a>02596                         <span class="keywordflow">case</span> 763:
<a name="l02597"></a>02597 
<a name="l02598"></a>02598                               <span class="comment">// CODE: Drop item at gridno</span>
<a name="l02599"></a>02599                               <span class="keywordflow">if</span> ( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#c8e5d4de5c5e5af59fc90d9c545a6bce">pTempObject</a> != NULL )
<a name="l02600"></a>02600                               {
<a name="l02601"></a>02601                                     <span class="keywordflow">if</span> ( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#73246323764393ce2a5ece7fcb7b7cf8">bVisible</a> != -1 )
<a name="l02602"></a>02602                                     {
<a name="l02603"></a>02603                                           <a class="code" href="Sound_01Control_8cpp.html#6b140a8e4fcf89b7740c037ff12580a7">PlayJA2Sample</a>( <a class="code" href="Sound_01Control_8h.html#946995a6d03371486c23b23d9ca362b5b30cdcae32c76ebd3b56c743fcb46671">THROW_IMPACT_2</a>, RATE_11025, <a class="code" href="Sound_01Control_8cpp.html#f62b2a668c2e25997578956c425723c4">SoundVolume</a>( MIDVOLUME, <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#2ab66ee0f37902cd448f4a738df4f2bf">sGridNo</a> ), 1, <a class="code" href="Sound_01Control_8cpp.html#a258fd693b7e800828705055bf357c8d">SoundDir</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#2ab66ee0f37902cd448f4a738df4f2bf">sGridNo</a> ) );               
<a name="l02604"></a>02604                                     }
<a name="l02605"></a>02605 
<a name="l02606"></a>02606                                     <a class="code" href="Handle_01Items_8cpp.html#ca7f6f6da97e9a4c2b737296485f5c84">AddItemToPool</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#7bf70f6f1b637647860538cd60b5399c">sPendingActionData2</a>, <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#c8e5d4de5c5e5af59fc90d9c545a6bce">pTempObject</a>, 1, <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#0d1f73c5d0ac839ec84a4792505949cb">bLevel</a>, 0 , -1 );
<a name="l02607"></a>02607                                     <a class="code" href="Handle_01Items_8cpp.html#ef92c00fc5ad51b4a9064e4a09d59492">NotifySoldiersToLookforItems</a>( );
<a name="l02608"></a>02608 
<a name="l02609"></a>02609                                     MemFree( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#c8e5d4de5c5e5af59fc90d9c545a6bce">pTempObject</a> );
<a name="l02610"></a>02610                                     <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#c8e5d4de5c5e5af59fc90d9c545a6bce">pTempObject</a> = NULL;
<a name="l02611"></a>02611                               }
<a name="l02612"></a>02612                               <span class="keywordflow">break</span>;
<a name="l02613"></a>02613       
<a name="l02614"></a>02614                         <span class="keywordflow">case</span> 764:
<a name="l02615"></a>02615 
<a name="l02616"></a>02616                               <a class="code" href="Sound_01Control_8cpp.html#fde31c808018dd666dbd51cd26c6eb6e">PlaySoldierJA2Sample</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#18aef170576da81b10d00e7b6cd3627b">ubID</a>, <a class="code" href="Sound_01Control_8h.html#946995a6d03371486c23b23d9ca362b517542d5c79274100ceffd1fe943e7fd1">PICKING_LOCK</a>, RATE_11025, <a class="code" href="Sound_01Control_8cpp.html#f62b2a668c2e25997578956c425723c4">SoundVolume</a>( HIGHVOLUME, <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#2ab66ee0f37902cd448f4a738df4f2bf">sGridNo</a> ), 1, <a class="code" href="Sound_01Control_8cpp.html#a258fd693b7e800828705055bf357c8d">SoundDir</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#2ab66ee0f37902cd448f4a738df4f2bf">sGridNo</a> ), TRUE );                                               
<a name="l02617"></a>02617                               <span class="keywordflow">break</span>;
<a name="l02618"></a>02618 
<a name="l02619"></a>02619                         <span class="keywordflow">case</span> 765:
<a name="l02620"></a>02620 
<a name="l02621"></a>02621                               <span class="comment">// Flyback hit - do blood!</span>
<a name="l02622"></a>02622                               <span class="comment">// PLace in existing tile and one back...</span>
<a name="l02623"></a>02623                               {
<a name="l02624"></a>02624                                     <a class="code" href="Types_8h.html#30f500129d8c688af07726d5d34ce52d">INT16</a> sNewGridNo;
<a name="l02625"></a>02625 
<a name="l02626"></a>02626                                     <a class="code" href="Smell_8cpp.html#016e1dc45d5426299b1dfeb67714d0a9">InternalDropBlood</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#2ab66ee0f37902cd448f4a738df4f2bf">sGridNo</a>, <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#0d1f73c5d0ac839ec84a4792505949cb">bLevel</a>, 0, (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)(MAXBLOODQUANTITY), 1 );
<a name="l02627"></a>02627 
<a name="l02628"></a>02628                                     <span class="comment">// Move forward one gridno....</span>
<a name="l02629"></a>02629                                     sNewGridNo = <a class="code" href="Isometric_01Utils_8cpp.html#318d8410127e29bb232ab70363bc316e">NewGridNo</a>( (<a class="code" href="Types_8h.html#09f1a1fb2293e33483cc8d44aefb1eb1">UINT16</a>)<a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#2ab66ee0f37902cd448f4a738df4f2bf">sGridNo</a>, (<a class="code" href="Types_8h.html#09f1a1fb2293e33483cc8d44aefb1eb1">UINT16</a>)( <a class="code" href="Isometric_01Utils_8cpp.html#a4a3adf599f99864b1de33673888fd5e">DirectionInc</a>( <a class="code" href="Isometric_01Utils_8cpp.html#9591ab6c902758a420fd3d9f4e49ba2e">gOppositeDirection</a>[ <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#8aa6174a253c3fa21a3ec41ce0174340">bDirection</a> ] ) ) );
<a name="l02630"></a>02630 
<a name="l02631"></a>02631                                     <a class="code" href="Smell_8cpp.html#016e1dc45d5426299b1dfeb67714d0a9">InternalDropBlood</a>( sNewGridNo, <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#0d1f73c5d0ac839ec84a4792505949cb">bLevel</a>, 0, (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)(MAXBLOODQUANTITY), 1 );
<a name="l02632"></a>02632 
<a name="l02633"></a>02633                               }
<a name="l02634"></a>02634                               <span class="keywordflow">break</span>;
<a name="l02635"></a>02635 
<a name="l02636"></a>02636                         <span class="keywordflow">case</span> 766:
<a name="l02637"></a>02637 
<a name="l02638"></a>02638                               <span class="comment">// Say COOL quote</span>
<a name="l02639"></a>02639                               <a class="code" href="Soldier_01Control_8cpp.html#62effc98ffa51ddb2fc78301c82acdb8">DoMercBattleSound</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>, <a class="code" href="Soldier_01Control_8h.html#3ab071cf265666f49f6e3f6639d69f0aeb62247b5212b82ddca160c00682284b">BATTLE_SOUND_COOL1</a> );                            
<a name="l02640"></a>02640                               <span class="keywordflow">break</span>;
<a name="l02641"></a>02641 
<a name="l02642"></a>02642                         <span class="keywordflow">case</span> 767:
<a name="l02643"></a>02643 
<a name="l02644"></a>02644                               <span class="comment">// Slap sound effect</span>
<a name="l02645"></a>02645                               <a class="code" href="Sound_01Control_8cpp.html#fde31c808018dd666dbd51cd26c6eb6e">PlaySoldierJA2Sample</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#18aef170576da81b10d00e7b6cd3627b">ubID</a>, <a class="code" href="Sound_01Control_8h.html#946995a6d03371486c23b23d9ca362b5be0dce8180ad5ab21eeeba1aef117266">SLAP_2</a>, RATE_11025, <a class="code" href="Sound_01Control_8cpp.html#f62b2a668c2e25997578956c425723c4">SoundVolume</a>( HIGHVOLUME, <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#2ab66ee0f37902cd448f4a738df4f2bf">sGridNo</a> ), 1, <a class="code" href="Sound_01Control_8cpp.html#a258fd693b7e800828705055bf357c8d">SoundDir</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#2ab66ee0f37902cd448f4a738df4f2bf">sGridNo</a> ), FALSE );                
<a name="l02646"></a>02646                               <span class="keywordflow">break</span>;
<a name="l02647"></a>02647 
<a name="l02648"></a>02648                         <span class="keywordflow">case</span> 768:
<a name="l02649"></a>02649 
<a name="l02650"></a>02650                               <span class="comment">// OK, after ending first aid, stand up if not in combat....</span>
<a name="l02651"></a>02651                               <span class="keywordflow">if</span> ( <a class="code" href="Overhead_8cpp.html#ef2a91a26932ebb6be5ef1b2a4d917cd">NumCapableEnemyInSector</a>( ) == 0 )
<a name="l02652"></a>02652                               {
<a name="l02653"></a>02653                                     <span class="comment">// Stand up...</span>
<a name="l02654"></a>02654                                     <a class="code" href="Soldier_01Control_8cpp.html#399090c009d2c65d23138520beb3382c">ChangeSoldierStance</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>, ANIM_STAND );
<a name="l02655"></a>02655                                     <span class="keywordflow">return</span>( FALSE );
<a name="l02656"></a>02656                               }
<a name="l02657"></a>02657           <span class="keywordflow">break</span>;
<a name="l02658"></a>02658 
<a name="l02659"></a>02659         <span class="keywordflow">case</span> 769:
<a name="l02660"></a>02660 
<a name="l02661"></a>02661           <span class="comment">// ATE: LOOK HERE FOR CODE IN INTERNALS FOR</span>
<a name="l02662"></a>02662           <span class="comment">// REFUELING A VEHICLE</span>
<a name="l02663"></a>02663           <span class="comment">// THE GAS_CAN IS IN THE MERCS MAIN HAND AT THIS TIME</span>
<a name="l02664"></a>02664           {
<a name="l02665"></a>02665             <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>                   ubPerson;
<a name="l02666"></a>02666                                     <a class="code" href="structSOLDIERTYPE.html">SOLDIERTYPE</a> *pVehicle;
<a name="l02667"></a>02667 
<a name="l02668"></a>02668                                     <span class="comment">// Get pointer to vehicle...</span>
<a name="l02669"></a>02669                                     ubPerson = <a class="code" href="worldman_8cpp.html#87338f0c77765726813428fd184bfcd8">WhoIsThere2</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#7bf70f6f1b637647860538cd60b5399c">sPendingActionData2</a>, <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#0d1f73c5d0ac839ec84a4792505949cb">bLevel</a> );
<a name="l02670"></a>02670                                     pVehicle = <a class="code" href="Overhead_8cpp.html#2b9a828d7d92ec404b2f9a39fc001177">MercPtrs</a>[ ubPerson ];
<a name="l02671"></a>02671 
<a name="l02672"></a>02672             <span class="comment">// this is a ubID for soldiertype....</span>
<a name="l02673"></a>02673                                     <a class="code" href="Strategic_01Movement_8cpp.html#c628a159fe24ec4670cfa0a57b089caa">AddFuelToVehicle</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>, pVehicle );
<a name="l02674"></a>02674 
<a name="l02675"></a>02675             <a class="code" href="Interface_8cpp.html#310e02e85df33f7794f5c4c11ae1844d">fInterfacePanelDirty</a> = DIRTYLEVEL2;
<a name="l02676"></a>02676           }
<a name="l02677"></a>02677                               <span class="keywordflow">break</span>;
<a name="l02678"></a>02678 
<a name="l02679"></a>02679         <span class="keywordflow">case</span> 770:
<a name="l02680"></a>02680 
<a name="l02681"></a>02681                           <a class="code" href="Sound_01Control_8cpp.html#6b140a8e4fcf89b7740c037ff12580a7">PlayJA2Sample</a>( <a class="code" href="Sound_01Control_8h.html#946995a6d03371486c23b23d9ca362b5049b440b7323eca67f3e0e2987964774">USE_WIRE_CUTTERS</a>, RATE_11025, HIGHVOLUME, 1, MIDDLEPAN );
<a name="l02682"></a>02682           <span class="keywordflow">break</span>;
<a name="l02683"></a>02683                     
<a name="l02684"></a>02684         <span class="keywordflow">case</span> 771:
<a name="l02685"></a>02685 
<a name="l02686"></a>02686                           <a class="code" href="Sound_01Control_8cpp.html#6b140a8e4fcf89b7740c037ff12580a7">PlayJA2Sample</a>( <a class="code" href="Sound_01Control_8h.html#946995a6d03371486c23b23d9ca362b5b2809f1e4314b49fce93c3d9d6b81531">BLOODCAT_ATTACK</a>, RATE_11025, HIGHVOLUME, 1, MIDDLEPAN );
<a name="l02687"></a>02687           <span class="keywordflow">break</span>;
<a name="l02688"></a>02688 
<a name="l02689"></a>02689                         <span class="keywordflow">case</span> 772:
<a name="l02690"></a>02690 
<a name="l02691"></a>02691                           <span class="comment">//CODE: FOR A REALTIME NON-INTERRUPTABLE SCRIPT - SIGNAL DONE</span>
<a name="l02692"></a>02692                               <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#1c27a651291802ce2785106908f159cb">fRTInNonintAnim</a> = FALSE;
<a name="l02693"></a>02693                               <span class="keywordflow">break</span>;
<a name="l02694"></a>02694 
<a name="l02695"></a>02695         <span class="keywordflow">case</span> 773:
<a name="l02696"></a>02696 
<a name="l02697"></a>02697           <span class="comment">// Kneel up...</span>
<a name="l02698"></a>02698                               <span class="keywordflow">if</span> ( !<a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#b09907716d07ec869e7ef2094d365715">bStealthMode</a> )
<a name="l02699"></a>02699                               {
<a name="l02700"></a>02700                                     <a class="code" href="Sound_01Control_8cpp.html#fde31c808018dd666dbd51cd26c6eb6e">PlaySoldierJA2Sample</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#18aef170576da81b10d00e7b6cd3627b">ubID</a>, <a class="code" href="Sound_01Control_8h.html#946995a6d03371486c23b23d9ca362b5239bc3d50a9474f051dd3c7158e793a5">KNEEL_UP_SOUND</a>, RATE_11025, <a class="code" href="Sound_01Control_8cpp.html#f62b2a668c2e25997578956c425723c4">SoundVolume</a>( MIDVOLUME, <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#2ab66ee0f37902cd448f4a738df4f2bf">sGridNo</a> ), 1, <a class="code" href="Sound_01Control_8cpp.html#a258fd693b7e800828705055bf357c8d">SoundDir</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#2ab66ee0f37902cd448f4a738df4f2bf">sGridNo</a> ), TRUE );                
<a name="l02701"></a>02701                               }
<a name="l02702"></a>02702           <span class="keywordflow">break</span>;
<a name="l02703"></a>02703 
<a name="l02704"></a>02704         <span class="keywordflow">case</span> 774:
<a name="l02705"></a>02705 
<a name="l02706"></a>02706           <span class="comment">// Kneel down..</span>
<a name="l02707"></a>02707                               <span class="keywordflow">if</span> ( !<a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#b09907716d07ec869e7ef2094d365715">bStealthMode</a> )
<a name="l02708"></a>02708                               {
<a name="l02709"></a>02709                                     <a class="code" href="Sound_01Control_8cpp.html#fde31c808018dd666dbd51cd26c6eb6e">PlaySoldierJA2Sample</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#18aef170576da81b10d00e7b6cd3627b">ubID</a>, <a class="code" href="Sound_01Control_8h.html#946995a6d03371486c23b23d9ca362b54fa778929d1dccd1267b7df342171154">KNEEL_DOWN_SOUND</a>, RATE_11025, <a class="code" href="Sound_01Control_8cpp.html#f62b2a668c2e25997578956c425723c4">SoundVolume</a>( MIDVOLUME, <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#2ab66ee0f37902cd448f4a738df4f2bf">sGridNo</a> ), 1, <a class="code" href="Sound_01Control_8cpp.html#a258fd693b7e800828705055bf357c8d">SoundDir</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#2ab66ee0f37902cd448f4a738df4f2bf">sGridNo</a> ), TRUE );              
<a name="l02710"></a>02710                               }
<a name="l02711"></a>02711           <span class="keywordflow">break</span>;
<a name="l02712"></a>02712 
<a name="l02713"></a>02713         <span class="keywordflow">case</span> 775:
<a name="l02714"></a>02714 
<a name="l02715"></a>02715           <span class="comment">// prone up..</span>
<a name="l02716"></a>02716                               <span class="keywordflow">if</span> ( !<a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#b09907716d07ec869e7ef2094d365715">bStealthMode</a> )
<a name="l02717"></a>02717                               {
<a name="l02718"></a>02718                                     <a class="code" href="Sound_01Control_8cpp.html#fde31c808018dd666dbd51cd26c6eb6e">PlaySoldierJA2Sample</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#18aef170576da81b10d00e7b6cd3627b">ubID</a>, <a class="code" href="Sound_01Control_8h.html#946995a6d03371486c23b23d9ca362b5fda44ec5acf6062e6df8fc97c9b9fff0">PRONE_UP_SOUND</a>, RATE_11025, <a class="code" href="Sound_01Control_8cpp.html#f62b2a668c2e25997578956c425723c4">SoundVolume</a>( MIDVOLUME, <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#2ab66ee0f37902cd448f4a738df4f2bf">sGridNo</a> ), 1, <a class="code" href="Sound_01Control_8cpp.html#a258fd693b7e800828705055bf357c8d">SoundDir</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#2ab66ee0f37902cd448f4a738df4f2bf">sGridNo</a> ), TRUE );                
<a name="l02719"></a>02719                               }
<a name="l02720"></a>02720           <span class="keywordflow">break</span>;
<a name="l02721"></a>02721 
<a name="l02722"></a>02722         <span class="keywordflow">case</span> 776:
<a name="l02723"></a>02723 
<a name="l02724"></a>02724           <span class="comment">// prone down..</span>
<a name="l02725"></a>02725                               <span class="keywordflow">if</span> ( !<a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#b09907716d07ec869e7ef2094d365715">bStealthMode</a> )
<a name="l02726"></a>02726                               {
<a name="l02727"></a>02727                                     <a class="code" href="Sound_01Control_8cpp.html#fde31c808018dd666dbd51cd26c6eb6e">PlaySoldierJA2Sample</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#18aef170576da81b10d00e7b6cd3627b">ubID</a>, <a class="code" href="Sound_01Control_8h.html#946995a6d03371486c23b23d9ca362b5e3b71ee9c3c9e9643e6e91dcf95ad1ab">PRONE_DOWN_SOUND</a>, RATE_11025, <a class="code" href="Sound_01Control_8cpp.html#f62b2a668c2e25997578956c425723c4">SoundVolume</a>( MIDVOLUME, <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#2ab66ee0f37902cd448f4a738df4f2bf">sGridNo</a> ), 1, <a class="code" href="Sound_01Control_8cpp.html#a258fd693b7e800828705055bf357c8d">SoundDir</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#2ab66ee0f37902cd448f4a738df4f2bf">sGridNo</a> ), TRUE );              
<a name="l02728"></a>02728                               }
<a name="l02729"></a>02729           <span class="keywordflow">break</span>;
<a name="l02730"></a>02730 
<a name="l02731"></a>02731         <span class="keywordflow">case</span> 777:
<a name="l02732"></a>02732 
<a name="l02733"></a>02733           <span class="comment">// picking something up</span>
<a name="l02734"></a>02734                               <span class="keywordflow">if</span> ( !<a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#b09907716d07ec869e7ef2094d365715">bStealthMode</a> )
<a name="l02735"></a>02735                               {
<a name="l02736"></a>02736                                     <a class="code" href="Sound_01Control_8cpp.html#fde31c808018dd666dbd51cd26c6eb6e">PlaySoldierJA2Sample</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#18aef170576da81b10d00e7b6cd3627b">ubID</a>, <a class="code" href="Sound_01Control_8h.html#946995a6d03371486c23b23d9ca362b5bdb2f803e24f4b75976728ea77ecd95e">PICKING_SOMETHING_UP</a>, RATE_11025, <a class="code" href="Sound_01Control_8cpp.html#f62b2a668c2e25997578956c425723c4">SoundVolume</a>( HIGHVOLUME, <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#2ab66ee0f37902cd448f4a738df4f2bf">sGridNo</a> ), 1, <a class="code" href="Sound_01Control_8cpp.html#a258fd693b7e800828705055bf357c8d">SoundDir</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#2ab66ee0f37902cd448f4a738df4f2bf">sGridNo</a> ), TRUE );               
<a name="l02737"></a>02737                               }
<a name="l02738"></a>02738           <span class="keywordflow">break</span>;
<a name="l02739"></a>02739 
<a name="l02740"></a>02740         <span class="keywordflow">case</span> 778:
<a name="l02741"></a>02741                               <span class="keywordflow">if</span> ( !<a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#b09907716d07ec869e7ef2094d365715">bStealthMode</a> )
<a name="l02742"></a>02742                               {
<a name="l02743"></a>02743                                     <a class="code" href="Sound_01Control_8cpp.html#fde31c808018dd666dbd51cd26c6eb6e">PlaySoldierJA2Sample</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#18aef170576da81b10d00e7b6cd3627b">ubID</a>, <a class="code" href="Sound_01Control_8h.html#946995a6d03371486c23b23d9ca362b5eb12f86c56a3c2d78251c2f2ad948eae">ENTER_DEEP_WATER_1</a>, RATE_11025, <a class="code" href="Sound_01Control_8cpp.html#f62b2a668c2e25997578956c425723c4">SoundVolume</a>( HIGHVOLUME, <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#2ab66ee0f37902cd448f4a738df4f2bf">sGridNo</a> ), 1, <a class="code" href="Sound_01Control_8cpp.html#a258fd693b7e800828705055bf357c8d">SoundDir</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#2ab66ee0f37902cd448f4a738df4f2bf">sGridNo</a> ), TRUE );                 
<a name="l02744"></a>02744                               }
<a name="l02745"></a>02745           <span class="keywordflow">break</span>;
<a name="l02746"></a>02746 
<a name="l02747"></a>02747         <span class="keywordflow">case</span> 779:
<a name="l02748"></a>02748 
<a name="l02749"></a>02749                               <a class="code" href="Sound_01Control_8cpp.html#fde31c808018dd666dbd51cd26c6eb6e">PlaySoldierJA2Sample</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#18aef170576da81b10d00e7b6cd3627b">ubID</a>, <a class="code" href="Sound_01Control_8h.html#946995a6d03371486c23b23d9ca362b529535bd8963191849859b7785f80958a">COW_FALL</a>, RATE_11025, <a class="code" href="Sound_01Control_8cpp.html#f62b2a668c2e25997578956c425723c4">SoundVolume</a>( HIGHVOLUME, <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#2ab66ee0f37902cd448f4a738df4f2bf">sGridNo</a> ), 1, <a class="code" href="Sound_01Control_8cpp.html#a258fd693b7e800828705055bf357c8d">SoundDir</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#2ab66ee0f37902cd448f4a738df4f2bf">sGridNo</a> ), TRUE );               
<a name="l02750"></a>02750           <span class="keywordflow">break</span>;
<a name="l02751"></a>02751 
<a name="l02752"></a>02752         <span class="keywordflow">case</span> 780:
<a name="l02753"></a>02753 
<a name="l02754"></a>02754                               <a class="code" href="Sound_01Control_8cpp.html#fde31c808018dd666dbd51cd26c6eb6e">PlaySoldierJA2Sample</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#18aef170576da81b10d00e7b6cd3627b">ubID</a>, <a class="code" href="Sound_01Control_8h.html#946995a6d03371486c23b23d9ca362b5b2bc6bf981b001ba89ed71efa327d545">COW_HIT_SND</a>, RATE_11025, <a class="code" href="Sound_01Control_8cpp.html#f62b2a668c2e25997578956c425723c4">SoundVolume</a>( HIGHVOLUME, <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#2ab66ee0f37902cd448f4a738df4f2bf">sGridNo</a> ), 1, <a class="code" href="Sound_01Control_8cpp.html#a258fd693b7e800828705055bf357c8d">SoundDir</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#2ab66ee0f37902cd448f4a738df4f2bf">sGridNo</a> ), TRUE );                  
<a name="l02755"></a>02755           <span class="keywordflow">break</span>;
<a name="l02756"></a>02756 
<a name="l02757"></a>02757         <span class="keywordflow">case</span> 781:
<a name="l02758"></a>02758 
<a name="l02759"></a>02759                               <a class="code" href="Sound_01Control_8cpp.html#fde31c808018dd666dbd51cd26c6eb6e">PlaySoldierJA2Sample</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#18aef170576da81b10d00e7b6cd3627b">ubID</a>, <a class="code" href="Sound_01Control_8h.html#946995a6d03371486c23b23d9ca362b58503a4cb0bbe6ba48e45ab50df952a69">ACR_DIE_PART2</a>, RATE_11025, <a class="code" href="Sound_01Control_8cpp.html#f62b2a668c2e25997578956c425723c4">SoundVolume</a>( HIGHVOLUME, <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#2ab66ee0f37902cd448f4a738df4f2bf">sGridNo</a> ), 1, <a class="code" href="Sound_01Control_8cpp.html#a258fd693b7e800828705055bf357c8d">SoundDir</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#2ab66ee0f37902cd448f4a738df4f2bf">sGridNo</a> ), FALSE );               
<a name="l02760"></a>02760           <span class="keywordflow">break</span>;
<a name="l02761"></a>02761 
<a name="l02762"></a>02762         <span class="keywordflow">case</span> 782:
<a name="l02763"></a>02763 
<a name="l02764"></a>02764                               <a class="code" href="Sound_01Control_8cpp.html#fde31c808018dd666dbd51cd26c6eb6e">PlaySoldierJA2Sample</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#18aef170576da81b10d00e7b6cd3627b">ubID</a>, <a class="code" href="Sound_01Control_8h.html#946995a6d03371486c23b23d9ca362b547505056bb77f23805089fc1b33a70c7">CREATURE_DISSOLVE_1</a>, RATE_11025, <a class="code" href="Sound_01Control_8cpp.html#f62b2a668c2e25997578956c425723c4">SoundVolume</a>( HIGHVOLUME, <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#2ab66ee0f37902cd448f4a738df4f2bf">sGridNo</a> ), 1, <a class="code" href="Sound_01Control_8cpp.html#a258fd693b7e800828705055bf357c8d">SoundDir</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#2ab66ee0f37902cd448f4a738df4f2bf">sGridNo</a> ), FALSE );               
<a name="l02765"></a>02765           <span class="keywordflow">break</span>;
<a name="l02766"></a>02766 
<a name="l02767"></a>02767         <span class="keywordflow">case</span> 784:
<a name="l02768"></a>02768 
<a name="l02769"></a>02769                               <a class="code" href="Sound_01Control_8cpp.html#fde31c808018dd666dbd51cd26c6eb6e">PlaySoldierJA2Sample</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#18aef170576da81b10d00e7b6cd3627b">ubID</a>, <a class="code" href="Sound_01Control_8h.html#946995a6d03371486c23b23d9ca362b529ff1bf102eb05a09274d0fa09ddf4fc">CREATURE_FALL</a>, RATE_11025, <a class="code" href="Sound_01Control_8cpp.html#f62b2a668c2e25997578956c425723c4">SoundVolume</a>( HIGHVOLUME, <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#2ab66ee0f37902cd448f4a738df4f2bf">sGridNo</a> ), 1, <a class="code" href="Sound_01Control_8cpp.html#a258fd693b7e800828705055bf357c8d">SoundDir</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#2ab66ee0f37902cd448f4a738df4f2bf">sGridNo</a> ), FALSE );               
<a name="l02770"></a>02770           <span class="keywordflow">break</span>;
<a name="l02771"></a>02771 
<a name="l02772"></a>02772         <span class="keywordflow">case</span> 785:
<a name="l02773"></a>02773 
<a name="l02774"></a>02774           <span class="keywordflow">if</span> ( <a class="code" href="Random_8cpp.html#49f938d1313ab6ef09ac6223a16ac334">Random</a>( 5 ) == 0 )
<a name="l02775"></a>02775           {
<a name="l02776"></a>02776                                 <a class="code" href="Sound_01Control_8cpp.html#fde31c808018dd666dbd51cd26c6eb6e">PlaySoldierJA2Sample</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#18aef170576da81b10d00e7b6cd3627b">ubID</a>, <a class="code" href="Sound_01Control_8h.html#946995a6d03371486c23b23d9ca362b571e7ae4c99697a95815ebc20f5b00164">CROW_PECKING_AT_FLESH</a>, RATE_11025, <a class="code" href="Sound_01Control_8cpp.html#f62b2a668c2e25997578956c425723c4">SoundVolume</a>( MIDVOLUME, <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#2ab66ee0f37902cd448f4a738df4f2bf">sGridNo</a> ), 1, <a class="code" href="Sound_01Control_8cpp.html#a258fd693b7e800828705055bf357c8d">SoundDir</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#2ab66ee0f37902cd448f4a738df4f2bf">sGridNo</a> ), TRUE );             
<a name="l02777"></a>02777           }
<a name="l02778"></a>02778           <span class="keywordflow">break</span>;
<a name="l02779"></a>02779 
<a name="l02780"></a>02780         <span class="keywordflow">case</span> 786:
<a name="l02781"></a>02781 
<a name="l02782"></a>02782                               <a class="code" href="Sound_01Control_8cpp.html#fde31c808018dd666dbd51cd26c6eb6e">PlaySoldierJA2Sample</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#18aef170576da81b10d00e7b6cd3627b">ubID</a>, <a class="code" href="Sound_01Control_8h.html#946995a6d03371486c23b23d9ca362b5fe1359e6ac5f0a4d89076467ebc3e251">CROW_FLYING_AWAY</a>, RATE_11025, <a class="code" href="Sound_01Control_8cpp.html#f62b2a668c2e25997578956c425723c4">SoundVolume</a>( MIDVOLUME, <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#2ab66ee0f37902cd448f4a738df4f2bf">sGridNo</a> ), 1, <a class="code" href="Sound_01Control_8cpp.html#a258fd693b7e800828705055bf357c8d">SoundDir</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#2ab66ee0f37902cd448f4a738df4f2bf">sGridNo</a> ), TRUE );              
<a name="l02783"></a>02783           <span class="keywordflow">break</span>;
<a name="l02784"></a>02784 
<a name="l02785"></a>02785         <span class="keywordflow">case</span> 787:
<a name="l02786"></a>02786 
<a name="l02787"></a>02787                               <a class="code" href="Sound_01Control_8cpp.html#fde31c808018dd666dbd51cd26c6eb6e">PlaySoldierJA2Sample</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#18aef170576da81b10d00e7b6cd3627b">ubID</a>, <a class="code" href="Sound_01Control_8h.html#946995a6d03371486c23b23d9ca362b5bd34bdb94feb61e333e9ffe5b7196b53">SLAP_1</a>, RATE_11025, <a class="code" href="Sound_01Control_8cpp.html#f62b2a668c2e25997578956c425723c4">SoundVolume</a>( HIGHVOLUME, <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#2ab66ee0f37902cd448f4a738df4f2bf">sGridNo</a> ), 1, <a class="code" href="Sound_01Control_8cpp.html#a258fd693b7e800828705055bf357c8d">SoundDir</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#2ab66ee0f37902cd448f4a738df4f2bf">sGridNo</a> ), FALSE );                
<a name="l02788"></a>02788           <span class="keywordflow">break</span>;
<a name="l02789"></a>02789 
<a name="l02790"></a>02790         <span class="keywordflow">case</span> 788:
<a name="l02791"></a>02791 
<a name="l02792"></a>02792                               <a class="code" href="Sound_01Control_8cpp.html#fde31c808018dd666dbd51cd26c6eb6e">PlaySoldierJA2Sample</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#18aef170576da81b10d00e7b6cd3627b">ubID</a>, <a class="code" href="Sound_01Control_8h.html#946995a6d03371486c23b23d9ca362b54f79252d6ae0a1e862fb6483e4d240de">MORTAR_START</a>, RATE_11025, <a class="code" href="Sound_01Control_8cpp.html#f62b2a668c2e25997578956c425723c4">SoundVolume</a>( HIGHVOLUME, <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#2ab66ee0f37902cd448f4a738df4f2bf">sGridNo</a> ), 1, <a class="code" href="Sound_01Control_8cpp.html#a258fd693b7e800828705055bf357c8d">SoundDir</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#2ab66ee0f37902cd448f4a738df4f2bf">sGridNo</a> ), TRUE );                 
<a name="l02793"></a>02793           <span class="keywordflow">break</span>;
<a name="l02794"></a>02794 
<a name="l02795"></a>02795         <span class="keywordflow">case</span> 789:
<a name="l02796"></a>02796 
<a name="l02797"></a>02797                               <a class="code" href="Sound_01Control_8cpp.html#fde31c808018dd666dbd51cd26c6eb6e">PlaySoldierJA2Sample</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#18aef170576da81b10d00e7b6cd3627b">ubID</a>, <a class="code" href="Sound_01Control_8h.html#946995a6d03371486c23b23d9ca362b5c9df2f676e3ee3155d190993f493ab2a">MORTAR_LOAD</a>, RATE_11025, <a class="code" href="Sound_01Control_8cpp.html#f62b2a668c2e25997578956c425723c4">SoundVolume</a>( HIGHVOLUME, <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#2ab66ee0f37902cd448f4a738df4f2bf">sGridNo</a> ), 1, <a class="code" href="Sound_01Control_8cpp.html#a258fd693b7e800828705055bf357c8d">SoundDir</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#2ab66ee0f37902cd448f4a738df4f2bf">sGridNo</a> ), TRUE );                  
<a name="l02798"></a>02798           <span class="keywordflow">break</span>;
<a name="l02799"></a>02799 
<a name="l02800"></a>02800         <span class="keywordflow">case</span> 790:
<a name="l02801"></a>02801 
<a name="l02802"></a>02802                               <a class="code" href="Sound_01Control_8cpp.html#fde31c808018dd666dbd51cd26c6eb6e">PlaySoldierJA2Sample</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#18aef170576da81b10d00e7b6cd3627b">ubID</a>, <a class="code" href="Sound_01Control_8h.html#946995a6d03371486c23b23d9ca362b5fd91d1daf25d88c43971d740ac4652e2">COW_FALL_2</a>, RATE_11025, <a class="code" href="Sound_01Control_8cpp.html#f62b2a668c2e25997578956c425723c4">SoundVolume</a>( HIGHVOLUME, <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#2ab66ee0f37902cd448f4a738df4f2bf">sGridNo</a> ), 1, <a class="code" href="Sound_01Control_8cpp.html#a258fd693b7e800828705055bf357c8d">SoundDir</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#2ab66ee0f37902cd448f4a738df4f2bf">sGridNo</a> ), TRUE );             
<a name="l02803"></a>02803           <span class="keywordflow">break</span>;
<a name="l02804"></a>02804 
<a name="l02805"></a>02805         <span class="keywordflow">case</span> 791:
<a name="l02806"></a>02806 
<a name="l02807"></a>02807                               <a class="code" href="Sound_01Control_8cpp.html#fde31c808018dd666dbd51cd26c6eb6e">PlaySoldierJA2Sample</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#18aef170576da81b10d00e7b6cd3627b">ubID</a>, <a class="code" href="Sound_01Control_8h.html#946995a6d03371486c23b23d9ca362b5b494579454306865efef4d5ac9299844">FENCE_OPEN</a>, RATE_11025, <a class="code" href="Sound_01Control_8cpp.html#f62b2a668c2e25997578956c425723c4">SoundVolume</a>( HIGHVOLUME, <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#2ab66ee0f37902cd448f4a738df4f2bf">sGridNo</a> ), 1, <a class="code" href="Sound_01Control_8cpp.html#a258fd693b7e800828705055bf357c8d">SoundDir</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#2ab66ee0f37902cd448f4a738df4f2bf">sGridNo</a> ), TRUE );             
<a name="l02808"></a>02808           <span class="keywordflow">break</span>;
<a name="l02809"></a>02809 
<a name="l02810"></a>02810                   }
<a name="l02811"></a>02811                   <span class="comment">// Adjust frame control pos, and try again</span>
<a name="l02812"></a>02812                   <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#d1221226402ff4b54671e0142ec90cd6">usAniCode</a>++;
<a name="l02813"></a>02813             }
<a name="l02814"></a>02814             <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( sNewAniFrame == 999 )
<a name="l02815"></a>02815             {
<a name="l02816"></a>02816 
<a name="l02817"></a>02817                   <span class="comment">// Go to start, by default</span>
<a name="l02818"></a>02818                   <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#d1221226402ff4b54671e0142ec90cd6">usAniCode</a> = 0;      
<a name="l02819"></a>02819                   
<a name="l02820"></a>02820             }
<a name="l02821"></a>02821 
<a name="l02822"></a>02822  <span class="comment">// Loop here until we break on a real item!</span>
<a name="l02823"></a>02823  } <span class="keywordflow">while</span> ( TRUE );
<a name="l02824"></a>02824 
<a name="l02825"></a>02825  <span class="comment">// We're done</span>
<a name="l02826"></a>02826       <span class="keywordflow">return</span>( TRUE );
<a name="l02827"></a>02827 }
<a name="l02828"></a>02828 
<a name="l02829"></a>02829 <span class="preprocessor">#define MIN_DEADLINESS_FOR_LIKE_GUN_QUOTE             20</span>
<a name="l02830"></a>02830 <span class="preprocessor"></span>
<a name="l02831"></a><a class="code" href="Soldier_01Ani_8cpp.html#1f6f56dee95e1b131f39e45fce9f8732">02831</a> <a class="code" href="Types_8h.html#112e3146cb38b6ee95e64d85842e380a">BOOLEAN</a> <a class="code" href="Soldier_01Ani_8cpp.html#1f6f56dee95e1b131f39e45fce9f8732">ShouldMercSayHappyWithGunQuote</a>( <a class="code" href="structSOLDIERTYPE.html">SOLDIERTYPE</a> *<a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a> )
<a name="l02832"></a>02832 {
<a name="l02833"></a>02833       <span class="comment">// How do we do this....</span>
<a name="l02834"></a>02834 
<a name="l02835"></a>02835       <span class="keywordflow">if</span> ( <a class="code" href="QARRAY_8cpp.html#e93c954f0ec074dec2f9c4fc087ee1d2">QuoteExp_GotGunOrUsedGun</a>[ <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#5a5648a1bb3507cc41f6be199c51a3f8">ubProfile</a> ] == <a class="code" href="Dialogue_01Control_8h.html#db9a2c9e383607c8609a364ff1521a29a39ddad8ab502d2405cbd4d7b1b58c9d">QUOTE_SATISFACTION_WITH_GUN_AFTER_KILL</a> )
<a name="l02836"></a>02836       {     
<a name="l02837"></a>02837             <span class="comment">// For one, only once a day...</span>
<a name="l02838"></a>02838             <span class="keywordflow">if</span> ( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#460d1be0d96ad07ca098aaf7986bf0ec">usQuoteSaidFlags</a> &amp; SOLDIER_QUOTE_SAID_LIKESGUN ) 
<a name="l02839"></a>02839             {
<a name="l02840"></a>02840                   <span class="keywordflow">return</span>( FALSE );
<a name="l02841"></a>02841             }
<a name="l02842"></a>02842 
<a name="l02843"></a>02843     <span class="comment">// is it a gun?</span>
<a name="l02844"></a>02844     <span class="keywordflow">if</span> ( <a class="code" href="Item_01Types_8h.html#f9dc4cc7a3a99ad5944940cfb7c82237">Item</a>[ <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#549976333a3c89be2ca4a342235e1464">usAttackingWeapon</a> ].usItemClass &amp; IC_GUN )
<a name="l02845"></a>02845     {
<a name="l02846"></a>02846             <span class="comment">// Is our weapon powerfull enough?</span>
<a name="l02847"></a>02847               <span class="keywordflow">if</span> ( <a class="code" href="Weapons_8cpp.html#fac72e30bc7c36f55257eac0542ce51d">Weapon</a>[ <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#549976333a3c89be2ca4a342235e1464">usAttackingWeapon</a> ].ubDeadliness &gt; MIN_DEADLINESS_FOR_LIKE_GUN_QUOTE )
<a name="l02848"></a>02848               {
<a name="l02849"></a>02849                     <span class="comment">// 20 % chance?</span>
<a name="l02850"></a>02850                     <span class="keywordflow">if</span> ( <a class="code" href="Random_8cpp.html#49f938d1313ab6ef09ac6223a16ac334">Random</a>( 100 ) &lt; 20 )
<a name="l02851"></a>02851                     {
<a name="l02852"></a>02852                           <span class="keywordflow">return</span>( TRUE );
<a name="l02853"></a>02853                     }
<a name="l02854"></a>02854               }
<a name="l02855"></a>02855     }
<a name="l02856"></a>02856       }
<a name="l02857"></a>02857 
<a name="l02858"></a>02858       <span class="keywordflow">return</span>( FALSE );
<a name="l02859"></a>02859 }
<a name="l02860"></a>02860 
<a name="l02861"></a>02861 
<a name="l02862"></a><a class="code" href="Soldier_01Ani_8cpp.html#7d0fb8122f709ac54e829729c4f63b50">02862</a> <span class="keywordtype">void</span> <a class="code" href="Soldier_01Ani_8cpp.html#7d0fb8122f709ac54e829729c4f63b50">SayBuddyWitnessedQuoteFromKill</a>( <a class="code" href="structSOLDIERTYPE.html">SOLDIERTYPE</a> *pKillerSoldier, <a class="code" href="Types_8h.html#30f500129d8c688af07726d5d34ce52d">INT16</a> sGridNo, <a class="code" href="Types_8h.html#7ebe70ceca856797319175e30bcf003d">INT8</a> bLevel )
<a name="l02863"></a>02863 {
<a name="l02864"></a>02864       <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubMercsInSector[ 20 ] = { 0 };
<a name="l02865"></a>02865       <a class="code" href="Types_8h.html#7ebe70ceca856797319175e30bcf003d">INT8</a>  bBuddyIndex[ 20 ] = { -1 };
<a name="l02866"></a>02866   <a class="code" href="Types_8h.html#7ebe70ceca856797319175e30bcf003d">INT8</a>  bTempBuddyIndex;
<a name="l02867"></a>02867       <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubNumMercs = 0;
<a name="l02868"></a>02868       <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubChosenMerc;
<a name="l02869"></a>02869       <a class="code" href="structSOLDIERTYPE.html">SOLDIERTYPE</a> *pTeamSoldier;
<a name="l02870"></a>02870       <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a> cnt;
<a name="l02871"></a>02871       <a class="code" href="Types_8h.html#30f500129d8c688af07726d5d34ce52d">INT16</a>       sDistVisible = FALSE;
<a name="l02872"></a>02872   <a class="code" href="Types_8h.html#09f1a1fb2293e33483cc8d44aefb1eb1">UINT16</a>  usQuoteNum;
<a name="l02873"></a>02873 
<a name="l02874"></a>02874       <span class="comment">// Loop through all our guys and randomly say one from someone in our sector</span>
<a name="l02875"></a>02875 
<a name="l02876"></a>02876       <span class="comment">// set up soldier ptr as first element in mercptrs list</span>
<a name="l02877"></a>02877       cnt = <a class="code" href="Overhead_8cpp.html#46bd754f8875c305ab18731ed10e3364">gTacticalStatus</a>.<a class="code" href="structTacticalStatusType.html#2ecddfe580bb019bc92cc4859eaf3edc">Team</a>[ <a class="code" href="Campaign_8cpp.html#47b2067ff75193e24776eda5297400ff">gbPlayerNum</a> ].<a class="code" href="structTacticalTeamType.html#f8fe819ad07b242f5dbf97fd4c69b00d">bFirstID</a>;   
<a name="l02878"></a>02878 
<a name="l02879"></a>02879       <span class="comment">// run through list</span>
<a name="l02880"></a>02880       <span class="keywordflow">for</span> ( pTeamSoldier = <a class="code" href="Overhead_8cpp.html#2b9a828d7d92ec404b2f9a39fc001177">MercPtrs</a>[ cnt ]; cnt &lt;= <a class="code" href="Overhead_8cpp.html#46bd754f8875c305ab18731ed10e3364">gTacticalStatus</a>.<a class="code" href="structTacticalStatusType.html#2ecddfe580bb019bc92cc4859eaf3edc">Team</a>[ <a class="code" href="Campaign_8cpp.html#47b2067ff75193e24776eda5297400ff">gbPlayerNum</a> ].<a class="code" href="structTacticalTeamType.html#6a887279dad735dc302f21c1e559d5ce">bLastID</a>; cnt++,pTeamSoldier++ )
<a name="l02881"></a>02881       {
<a name="l02882"></a>02882             <span class="comment">// Add guy if he's a candidate...</span>
<a name="l02883"></a>02883             <span class="keywordflow">if</span> ( OK_INSECTOR_MERC( pTeamSoldier ) &amp;&amp; !AM_AN_EPC( pTeamSoldier ) &amp;&amp; !( pTeamSoldier-&gt;uiStatusFlags &amp; SOLDIER_GASSED ) &amp;&amp; !(AM_A_ROBOT( pTeamSoldier )) &amp;&amp; !pTeamSoldier-&gt;fMercAsleep &amp;&amp; pTeamSoldier-&gt;sGridNo != NOWHERE )
<a name="l02884"></a>02884             {
<a name="l02885"></a>02885       <span class="comment">// Are we a buddy of killer?</span>
<a name="l02886"></a>02886                   bTempBuddyIndex = <a class="code" href="Soldier_01Profile_8cpp.html#25cc33133d5278dbb214ddbb132322a7">WhichBuddy</a>( pTeamSoldier-&gt;ubProfile, pKillerSoldier-&gt;<a class="code" href="structSOLDIERTYPE.html#5a5648a1bb3507cc41f6be199c51a3f8">ubProfile</a> );
<a name="l02887"></a>02887 
<a name="l02888"></a>02888       <a class="code" href="Soldier_01Ani_8cpp.html#c294aa65f0375eb6343a2de2a25dafcc">if</a> ( bTempBuddyIndex != -1 )
<a name="l02889"></a>02889       {
<a name="l02890"></a>02890         <span class="keywordflow">switch</span>( bTempBuddyIndex )
<a name="l02891"></a>02891         {
<a name="l02892"></a>02892           <span class="keywordflow">case</span> 0:
<a name="l02893"></a>02893             <span class="keywordflow">if</span> ( pTeamSoldier-&gt;usQuoteSaidExtFlags &amp; SOLDIER_QUOTE_SAID_BUDDY_1_WITNESSED )
<a name="l02894"></a>02894             {
<a name="l02895"></a>02895               <span class="keywordflow">continue</span>;
<a name="l02896"></a>02896             }
<a name="l02897"></a>02897             <span class="keywordflow">break</span>;
<a name="l02898"></a>02898 
<a name="l02899"></a>02899           <span class="keywordflow">case</span> 1:
<a name="l02900"></a>02900             <span class="keywordflow">if</span> ( pTeamSoldier-&gt;usQuoteSaidExtFlags &amp; SOLDIER_QUOTE_SAID_BUDDY_2_WITNESSED )
<a name="l02901"></a>02901             {
<a name="l02902"></a>02902               <span class="keywordflow">continue</span>;
<a name="l02903"></a>02903             }
<a name="l02904"></a>02904             <span class="keywordflow">break</span>;
<a name="l02905"></a>02905 
<a name="l02906"></a>02906           <span class="keywordflow">case</span> 2:
<a name="l02907"></a>02907             <span class="keywordflow">if</span> ( pTeamSoldier-&gt;usQuoteSaidExtFlags &amp; SOLDIER_QUOTE_SAID_BUDDY_3_WITNESSED )
<a name="l02908"></a>02908             {
<a name="l02909"></a>02909               <span class="keywordflow">continue</span>;
<a name="l02910"></a>02910             }
<a name="l02911"></a>02911             <span class="keywordflow">break</span>;
<a name="l02912"></a>02912         }
<a name="l02913"></a>02913 
<a name="l02914"></a>02914         <span class="comment">// TO LOS check to killed</span>
<a name="l02915"></a>02915             <span class="comment">// Can we see location of killer?</span>
<a name="l02916"></a>02916             sDistVisible = <a class="code" href="opplist_8cpp.html#3024b66f9b450ab359bf03734c3aad9b">DistanceVisible</a>( pTeamSoldier, <a class="code" href="Overhead_01Types_8h.html#df5bf54a26a76adf253f57d88ade82b7680b9f541cb30851967400ce4b0f2807">DIRECTION_IRRELEVANT</a>, <a class="code" href="Overhead_01Types_8h.html#df5bf54a26a76adf253f57d88ade82b7680b9f541cb30851967400ce4b0f2807">DIRECTION_IRRELEVANT</a>, pKillerSoldier-&gt;sGridNo, pKillerSoldier-&gt;bLevel, pKillerSoldier );
<a name="l02917"></a>02917         <span class="keywordflow">if</span> ( <a class="code" href="LOS_8cpp.html#7ccd0f206cf1c499fcb25349e20fd106">SoldierTo3DLocationLineOfSightTest</a>( pTeamSoldier, pKillerSoldier-&gt;sGridNo,  pKillerSoldier-&gt;bLevel, (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)3, (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>) sDistVisible, TRUE ) == 0 )
<a name="l02918"></a>02918         {
<a name="l02919"></a>02919           <span class="keywordflow">continue</span>;
<a name="l02920"></a>02920         }
<a name="l02921"></a>02921 
<a name="l02922"></a>02922 
<a name="l02923"></a>02923             <span class="comment">// Can we see location of killed?</span>
<a name="l02924"></a>02924             sDistVisible = <a class="code" href="opplist_8cpp.html#3024b66f9b450ab359bf03734c3aad9b">DistanceVisible</a>( pTeamSoldier, <a class="code" href="Overhead_01Types_8h.html#df5bf54a26a76adf253f57d88ade82b7680b9f541cb30851967400ce4b0f2807">DIRECTION_IRRELEVANT</a>, <a class="code" href="Overhead_01Types_8h.html#df5bf54a26a76adf253f57d88ade82b7680b9f541cb30851967400ce4b0f2807">DIRECTION_IRRELEVANT</a>, sGridNo, bLevel, pTeamSoldier );
<a name="l02925"></a>02925         <span class="keywordflow">if</span> ( <a class="code" href="LOS_8cpp.html#7ccd0f206cf1c499fcb25349e20fd106">SoldierTo3DLocationLineOfSightTest</a>( pTeamSoldier, sGridNo,  bLevel, (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)3, (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>) sDistVisible, TRUE ) == 0 )
<a name="l02926"></a>02926         {
<a name="l02927"></a>02927           <span class="keywordflow">continue</span>;
<a name="l02928"></a>02928         }
<a name="l02929"></a>02929 
<a name="l02930"></a>02930         <span class="comment">// OK, a good candidate...</span>
<a name="l02931"></a>02931                     ubMercsInSector[ ubNumMercs ] = (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)cnt;
<a name="l02932"></a>02932                     bBuddyIndex[ ubNumMercs ]     = bTempBuddyIndex;
<a name="l02933"></a>02933                     ubNumMercs++;
<a name="l02934"></a>02934       }
<a name="l02935"></a>02935             }
<a name="l02936"></a>02936       }
<a name="l02937"></a>02937 
<a name="l02938"></a>02938       <span class="comment">// If we are &gt; 0</span>
<a name="l02939"></a>02939       <span class="keywordflow">if</span> ( ubNumMercs &gt; 0 )
<a name="l02940"></a>02940       {
<a name="l02941"></a>02941     <span class="comment">// Do random check here...</span>
<a name="l02942"></a>02942     <span class="keywordflow">if</span> ( <a class="code" href="Random_8cpp.html#49f938d1313ab6ef09ac6223a16ac334">Random</a>( 100 ) &lt; 20 )
<a name="l02943"></a>02943     {
<a name="l02944"></a>02944               ubChosenMerc = (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)<a class="code" href="Random_8cpp.html#49f938d1313ab6ef09ac6223a16ac334">Random</a>( ubNumMercs );
<a name="l02945"></a>02945 
<a name="l02946"></a>02946       <span class="keywordflow">switch</span>( bBuddyIndex[ ubChosenMerc ] )
<a name="l02947"></a>02947       {
<a name="l02948"></a>02948         <span class="keywordflow">case</span> 0:
<a name="l02949"></a>02949           usQuoteNum = <a class="code" href="Dialogue_01Control_8h.html#db9a2c9e383607c8609a364ff1521a290891c2affc1fd07a2a8fa55f9663aafd">QUOTE_BUDDY_1_GOOD</a>;
<a name="l02950"></a>02950           <a class="code" href="Overhead_8cpp.html#2b9a828d7d92ec404b2f9a39fc001177">MercPtrs</a>[ ubMercsInSector[ ubChosenMerc ] ]-&gt;<a class="code" href="structSOLDIERTYPE.html#7e63debe882783fb2cb8641f3b3e8214">usQuoteSaidExtFlags</a> |= SOLDIER_QUOTE_SAID_BUDDY_1_WITNESSED;
<a name="l02951"></a>02951           <span class="keywordflow">break</span>;
<a name="l02952"></a>02952 
<a name="l02953"></a>02953         <span class="keywordflow">case</span> 1:
<a name="l02954"></a>02954           usQuoteNum = <a class="code" href="Dialogue_01Control_8h.html#db9a2c9e383607c8609a364ff1521a29b12d62733df853952b866743ddcb612f">QUOTE_BUDDY_2_GOOD</a>;
<a name="l02955"></a>02955           <a class="code" href="Overhead_8cpp.html#2b9a828d7d92ec404b2f9a39fc001177">MercPtrs</a>[ ubMercsInSector[ ubChosenMerc ] ]-&gt;<a class="code" href="structSOLDIERTYPE.html#7e63debe882783fb2cb8641f3b3e8214">usQuoteSaidExtFlags</a> |= SOLDIER_QUOTE_SAID_BUDDY_2_WITNESSED;
<a name="l02956"></a>02956           <span class="keywordflow">break</span>;
<a name="l02957"></a>02957 
<a name="l02958"></a>02958         <span class="keywordflow">case</span> 2:
<a name="l02959"></a>02959           usQuoteNum = <a class="code" href="Dialogue_01Control_8h.html#db9a2c9e383607c8609a364ff1521a294c30d67f429223cad53af2d8572e05f7">QUOTE_LEARNED_TO_LIKE_WITNESSED</a>;
<a name="l02960"></a>02960           <a class="code" href="Overhead_8cpp.html#2b9a828d7d92ec404b2f9a39fc001177">MercPtrs</a>[ ubMercsInSector[ ubChosenMerc ] ]-&gt;<a class="code" href="structSOLDIERTYPE.html#7e63debe882783fb2cb8641f3b3e8214">usQuoteSaidExtFlags</a> |= SOLDIER_QUOTE_SAID_BUDDY_3_WITNESSED;
<a name="l02961"></a>02961           <span class="keywordflow">break</span>;
<a name="l02962"></a>02962       }
<a name="l02963"></a>02963             <a class="code" href="Dialogue_01Control_8cpp.html#78d57daff1e69f02d5d83bd74d30e520">TacticalCharacterDialogue</a>( <a class="code" href="Overhead_8cpp.html#2b9a828d7d92ec404b2f9a39fc001177">MercPtrs</a>[ ubMercsInSector[ ubChosenMerc ] ], usQuoteNum );
<a name="l02964"></a>02964     }
<a name="l02965"></a>02965       }
<a name="l02966"></a>02966 }
<a name="l02967"></a>02967 
<a name="l02968"></a>02968 
<a name="l02969"></a><a class="code" href="Soldier_01Ani_8cpp.html#ba488b698dfe615405e02e32dd8c5b57">02969</a> <span class="keywordtype">void</span> <a class="code" href="Overhead_8cpp.html#ba488b698dfe615405e02e32dd8c5b57">HandleKilledQuote</a>( <a class="code" href="structSOLDIERTYPE.html">SOLDIERTYPE</a> *pKilledSoldier, <a class="code" href="structSOLDIERTYPE.html">SOLDIERTYPE</a> *pKillerSoldier, <a class="code" href="Types_8h.html#30f500129d8c688af07726d5d34ce52d">INT16</a> sGridNo, <a class="code" href="Types_8h.html#7ebe70ceca856797319175e30bcf003d">INT8</a> bLevel )
<a name="l02970"></a>02970 {     
<a name="l02971"></a>02971       <a class="code" href="structSOLDIERTYPE.html">SOLDIERTYPE</a> *pTeamSoldier;
<a name="l02972"></a>02972       <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a> cnt;
<a name="l02973"></a>02973       <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubMercsInSector[ 20 ] = { 0 };
<a name="l02974"></a>02974       <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubNumMercs = 0;
<a name="l02975"></a>02975       <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubChosenMerc;
<a name="l02976"></a>02976       <a class="code" href="Types_8h.html#112e3146cb38b6ee95e64d85842e380a">BOOLEAN</a> fDoSomeoneElse = FALSE;
<a name="l02977"></a>02977       <a class="code" href="Types_8h.html#112e3146cb38b6ee95e64d85842e380a">BOOLEAN</a>     fCanWeSeeLocation = FALSE;
<a name="l02978"></a>02978       <a class="code" href="Types_8h.html#30f500129d8c688af07726d5d34ce52d">INT16</a>       sDistVisible = FALSE;
<a name="l02979"></a>02979 
<a name="l02980"></a>02980       <a class="code" href="Overhead_8cpp.html#361e9e051df8b5f3bb7916450ce169b3">gfLastMercTalkedAboutKillingID</a> = pKilledSoldier-&gt;<a class="code" href="structSOLDIERTYPE.html#18aef170576da81b10d00e7b6cd3627b">ubID</a>;
<a name="l02981"></a>02981 
<a name="l02982"></a>02982       <span class="comment">// Can we see location?</span>
<a name="l02983"></a>02983       sDistVisible = <a class="code" href="opplist_8cpp.html#3024b66f9b450ab359bf03734c3aad9b">DistanceVisible</a>( pKillerSoldier, <a class="code" href="Overhead_01Types_8h.html#df5bf54a26a76adf253f57d88ade82b7680b9f541cb30851967400ce4b0f2807">DIRECTION_IRRELEVANT</a>, <a class="code" href="Overhead_01Types_8h.html#df5bf54a26a76adf253f57d88ade82b7680b9f541cb30851967400ce4b0f2807">DIRECTION_IRRELEVANT</a>, sGridNo, bLevel, pKillerSoldier );
<a name="l02984"></a>02984 
<a name="l02985"></a>02985       fCanWeSeeLocation = ( <a class="code" href="LOS_8cpp.html#7ccd0f206cf1c499fcb25349e20fd106">SoldierTo3DLocationLineOfSightTest</a>( pKillerSoldier, sGridNo,  bLevel, (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)3, (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>) sDistVisible, TRUE ) != 0 );
<a name="l02986"></a>02986 
<a name="l02987"></a>02987 
<a name="l02988"></a>02988       <span class="comment">// Are we killing mike?</span>
<a name="l02989"></a>02989       <span class="keywordflow">if</span> ( pKilledSoldier-&gt;<a class="code" href="structSOLDIERTYPE.html#5a5648a1bb3507cc41f6be199c51a3f8">ubProfile</a> == 149 &amp;&amp; pKillerSoldier-&gt;<a class="code" href="structSOLDIERTYPE.html#ebe9c50f2c727b34d3495abdfb8d8da2">ubWhatKindOfMercAmI</a> == <a class="code" href="Soldier_01Control_8h.html#7c35be1de655e733eaac059ccd76f796d9c5ec3ae96bb846bc1f90586b7d6067">MERC_TYPE__AIM_MERC</a> )
<a name="l02990"></a>02990       {
<a name="l02991"></a>02991             <span class="comment">// Can we see?</span>
<a name="l02992"></a>02992             <span class="keywordflow">if</span> ( fCanWeSeeLocation )
<a name="l02993"></a>02993             {
<a name="l02994"></a>02994                   <a class="code" href="Dialogue_01Control_8cpp.html#78d57daff1e69f02d5d83bd74d30e520">TacticalCharacterDialogue</a>( pKillerSoldier, <a class="code" href="Dialogue_01Control_8h.html#db9a2c9e383607c8609a364ff1521a29716a984e62b2cf3bfc433d1c1114f9f0">QUOTE_AIM_KILLED_MIKE</a> );     
<a name="l02995"></a>02995             }
<a name="l02996"></a>02996       }
<a name="l02997"></a>02997       <span class="comment">// Are we killing factory mamager?</span>
<a name="l02998"></a>02998       <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( pKilledSoldier-&gt;<a class="code" href="structSOLDIERTYPE.html#5a5648a1bb3507cc41f6be199c51a3f8">ubProfile</a> == 139 )
<a name="l02999"></a>02999       {
<a name="l03000"></a>03000             <span class="comment">// Can we see?</span>
<a name="l03001"></a>03001             <span class="comment">//f ( fCanWeSeeLocation )</span>
<a name="l03002"></a>03002             {
<a name="l03003"></a>03003                   <a class="code" href="Dialogue_01Control_8cpp.html#78d57daff1e69f02d5d83bd74d30e520">TacticalCharacterDialogue</a>( pKillerSoldier, <a class="code" href="Dialogue_01Control_8h.html#db9a2c9e383607c8609a364ff1521a2902870323bad4733a4790908f5ea011a1">QUOTE_KILLED_FACTORY_MANAGER</a> );    
<a name="l03004"></a>03004             }
<a name="l03005"></a>03005       }
<a name="l03006"></a>03006       <span class="keywordflow">else</span>
<a name="l03007"></a>03007       {
<a name="l03008"></a>03008             <span class="comment">// Steps here...</span>
<a name="l03009"></a>03009 
<a name="l03010"></a>03010             <span class="comment">// If not head shot, just say killed quote</span>
<a name="l03011"></a>03011 
<a name="l03012"></a>03012             <span class="comment">// If head shot... </span>
<a name="l03013"></a>03013 
<a name="l03014"></a>03014             <span class="comment">// If we have a head shot saying,, randomly try that one</span>
<a name="l03015"></a>03015 
<a name="l03016"></a>03016             <span class="comment">// If not doing that one, search for anybody who can see person</span>
<a name="l03017"></a>03017 
<a name="l03018"></a>03018             <span class="comment">// If somebody did, play his quote plus attackers killed quote.</span>
<a name="l03019"></a>03019 
<a name="l03020"></a>03020             <span class="comment">// Checkf for headhot!</span>
<a name="l03021"></a>03021             <span class="keywordflow">if</span> ( pKilledSoldier-&gt;<a class="code" href="structSOLDIERTYPE.html#1f73b62a5ea0dd26fa1bec1d9f522b41">usAnimState</a> == <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2ebf519f2bb07cc5f8f605e3354e4e2e806">JFK_HITDEATH</a> )
<a name="l03022"></a>03022             {
<a name="l03023"></a>03023                   <span class="comment">//Randomliy say it!</span>
<a name="l03024"></a>03024                   <span class="keywordflow">if</span> ( <a class="code" href="Random_8cpp.html#49f938d1313ab6ef09ac6223a16ac334">Random</a>( 100 ) &lt; 40 )
<a name="l03025"></a>03025                   {
<a name="l03026"></a>03026                          <a class="code" href="Dialogue_01Control_8cpp.html#78d57daff1e69f02d5d83bd74d30e520">TacticalCharacterDialogue</a>( pKillerSoldier, <a class="code" href="Dialogue_01Control_8h.html#db9a2c9e383607c8609a364ff1521a29a3225f9d58a5f42e455ee8fdf27c45e1">QUOTE_HEADSHOT</a> );
<a name="l03027"></a>03027                   }
<a name="l03028"></a>03028                   <span class="keywordflow">else</span>
<a name="l03029"></a>03029                   {
<a name="l03030"></a>03030                         fDoSomeoneElse = TRUE;
<a name="l03031"></a>03031                   }
<a name="l03032"></a>03032 
<a name="l03033"></a>03033                   <span class="keywordflow">if</span> ( fDoSomeoneElse )
<a name="l03034"></a>03034                   {
<a name="l03035"></a>03035                         <span class="comment">// Check if a person is here that has this quote....</span>
<a name="l03036"></a>03036                         cnt = <a class="code" href="Overhead_8cpp.html#46bd754f8875c305ab18731ed10e3364">gTacticalStatus</a>.<a class="code" href="structTacticalStatusType.html#2ecddfe580bb019bc92cc4859eaf3edc">Team</a>[ <a class="code" href="Campaign_8cpp.html#47b2067ff75193e24776eda5297400ff">gbPlayerNum</a> ].<a class="code" href="structTacticalTeamType.html#f8fe819ad07b242f5dbf97fd4c69b00d">bFirstID</a>;   
<a name="l03037"></a>03037 
<a name="l03038"></a>03038                         <span class="comment">// run through list</span>
<a name="l03039"></a>03039                         <span class="keywordflow">for</span> ( pTeamSoldier = <a class="code" href="Overhead_8cpp.html#2b9a828d7d92ec404b2f9a39fc001177">MercPtrs</a>[ cnt ]; cnt &lt;= <a class="code" href="Overhead_8cpp.html#46bd754f8875c305ab18731ed10e3364">gTacticalStatus</a>.<a class="code" href="structTacticalStatusType.html#2ecddfe580bb019bc92cc4859eaf3edc">Team</a>[ <a class="code" href="Campaign_8cpp.html#47b2067ff75193e24776eda5297400ff">gbPlayerNum</a> ].<a class="code" href="structTacticalTeamType.html#6a887279dad735dc302f21c1e559d5ce">bLastID</a>; cnt++,pTeamSoldier++ )
<a name="l03040"></a>03040                         {
<a name="l03041"></a>03041                               <span class="keywordflow">if</span> ( cnt != pKillerSoldier-&gt;<a class="code" href="structSOLDIERTYPE.html#18aef170576da81b10d00e7b6cd3627b">ubID</a> )
<a name="l03042"></a>03042                               {
<a name="l03043"></a>03043                                     <a class="code" href="Soldier_01Ani_8cpp.html#c294aa65f0375eb6343a2de2a25dafcc">if</a> ( OK_INSECTOR_MERC( pTeamSoldier ) &amp;&amp; !( pTeamSoldier-&gt;<a class="code" href="structSOLDIERTYPE.html#eb633099940bc20ff5a969bce84eab42">uiStatusFlags</a> &amp; SOLDIER_GASSED ) &amp;&amp; !AM_AN_EPC( pTeamSoldier ) )
<a name="l03044"></a>03044                                     {
<a name="l03045"></a>03045                                           <span class="comment">// Can we see location?</span>
<a name="l03046"></a>03046                                           sDistVisible = <a class="code" href="opplist_8cpp.html#3024b66f9b450ab359bf03734c3aad9b">DistanceVisible</a>( pTeamSoldier, <a class="code" href="Overhead_01Types_8h.html#df5bf54a26a76adf253f57d88ade82b7680b9f541cb30851967400ce4b0f2807">DIRECTION_IRRELEVANT</a>, <a class="code" href="Overhead_01Types_8h.html#df5bf54a26a76adf253f57d88ade82b7680b9f541cb30851967400ce4b0f2807">DIRECTION_IRRELEVANT</a>, sGridNo, bLevel, pTeamSoldier );
<a name="l03047"></a>03047 
<a name="l03048"></a>03048                                           <span class="keywordflow">if</span> ( <a class="code" href="LOS_8cpp.html#7ccd0f206cf1c499fcb25349e20fd106">SoldierTo3DLocationLineOfSightTest</a>( pTeamSoldier, sGridNo,  bLevel, 3, (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>) sDistVisible, TRUE ) )
<a name="l03049"></a>03049                                           {
<a name="l03050"></a>03050                                                 ubMercsInSector[ ubNumMercs ] = (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)cnt;
<a name="l03051"></a>03051                                                 ubNumMercs++;
<a name="l03052"></a>03052                                           }
<a name="l03053"></a>03053                                     }
<a name="l03054"></a>03054                               }
<a name="l03055"></a>03055                         }
<a name="l03056"></a>03056 
<a name="l03057"></a>03057                         <span class="comment">// Did we find anybody?</span>
<a name="l03058"></a>03058                         <span class="keywordflow">if</span> ( ubNumMercs &gt; 0 )
<a name="l03059"></a>03059                         {
<a name="l03060"></a>03060                               ubChosenMerc = (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)<a class="code" href="Random_8cpp.html#49f938d1313ab6ef09ac6223a16ac334">Random</a>( ubNumMercs );
<a name="l03061"></a>03061                               
<a name="l03062"></a>03062                               <span class="comment">// We have a random chance of not saying our we killed a guy quote</span>
<a name="l03063"></a>03063                               <span class="keywordflow">if</span> ( <a class="code" href="Random_8cpp.html#49f938d1313ab6ef09ac6223a16ac334">Random</a>( 100 ) &lt; 50 )
<a name="l03064"></a>03064                               {
<a name="l03065"></a>03065                                     <span class="comment">// Say this guys quote but the killer's quote as well....</span>
<a name="l03066"></a>03066                                     <span class="comment">// if killed was not a plain old civ, say quote</span>
<a name="l03067"></a>03067                                     <span class="keywordflow">if</span> (pKilledSoldier-&gt;<a class="code" href="structSOLDIERTYPE.html#74a40a8aaf3efe840cdaf6be62556d82">bTeam</a> != CIV_TEAM || pKilledSoldier-&gt;<a class="code" href="structSOLDIERTYPE.html#d250d43185690987945d6884efdf79fc">ubCivilianGroup</a> != 0)
<a name="l03068"></a>03068                                     {
<a name="l03069"></a>03069                                           <a class="code" href="Dialogue_01Control_8cpp.html#78d57daff1e69f02d5d83bd74d30e520">TacticalCharacterDialogue</a>( pKillerSoldier, <a class="code" href="Dialogue_01Control_8h.html#db9a2c9e383607c8609a364ff1521a293625f282d0231c61ad5e76ef15040f65">QUOTE_KILLED_AN_ENEMY</a> );
<a name="l03070"></a>03070                                     }
<a name="l03071"></a>03071                               }
<a name="l03072"></a>03072 
<a name="l03073"></a>03073                               <a class="code" href="Dialogue_01Control_8cpp.html#78d57daff1e69f02d5d83bd74d30e520">TacticalCharacterDialogue</a>( <a class="code" href="Overhead_8cpp.html#2b9a828d7d92ec404b2f9a39fc001177">MercPtrs</a>[ ubMercsInSector[ ubChosenMerc ] ], <a class="code" href="Dialogue_01Control_8h.html#db9a2c9e383607c8609a364ff1521a29a3225f9d58a5f42e455ee8fdf27c45e1">QUOTE_HEADSHOT</a> );
<a name="l03074"></a>03074                         }
<a name="l03075"></a>03075                         <span class="keywordflow">else</span>
<a name="l03076"></a>03076                         {
<a name="l03077"></a>03077                               <span class="comment">// Can we see?</span>
<a name="l03078"></a>03078                               <span class="keywordflow">if</span> ( fCanWeSeeLocation )
<a name="l03079"></a>03079                               {
<a name="l03080"></a>03080                                     <span class="comment">// Say this guys quote but the killer's quote as well....</span>
<a name="l03081"></a>03081                                     <span class="comment">// if killed was not a plain old civ, say quote</span>
<a name="l03082"></a>03082                                     <span class="keywordflow">if</span> (pKilledSoldier-&gt;<a class="code" href="structSOLDIERTYPE.html#74a40a8aaf3efe840cdaf6be62556d82">bTeam</a> != CIV_TEAM || pKilledSoldier-&gt;<a class="code" href="structSOLDIERTYPE.html#d250d43185690987945d6884efdf79fc">ubCivilianGroup</a> != 0)
<a name="l03083"></a>03083                                     {
<a name="l03084"></a>03084                                           <a class="code" href="Dialogue_01Control_8cpp.html#78d57daff1e69f02d5d83bd74d30e520">TacticalCharacterDialogue</a>( pKillerSoldier, <a class="code" href="Dialogue_01Control_8h.html#db9a2c9e383607c8609a364ff1521a293625f282d0231c61ad5e76ef15040f65">QUOTE_KILLED_AN_ENEMY</a> );
<a name="l03085"></a>03085                                     }
<a name="l03086"></a>03086                               }
<a name="l03087"></a>03087                         }
<a name="l03088"></a>03088                   }
<a name="l03089"></a>03089             }
<a name="l03090"></a>03090             <span class="keywordflow">else</span>
<a name="l03091"></a>03091             {
<a name="l03092"></a>03092                   <span class="comment">// Can we see?</span>
<a name="l03093"></a>03093                   <span class="keywordflow">if</span> ( fCanWeSeeLocation )
<a name="l03094"></a>03094                   {
<a name="l03095"></a>03095                         <span class="comment">// if killed was not a plain old civ, say quote</span>
<a name="l03096"></a>03096                         <span class="keywordflow">if</span> (pKilledSoldier-&gt;bTeam != CIV_TEAM || pKilledSoldier-&gt;ubCivilianGroup != 0)
<a name="l03097"></a>03097                         {
<a name="l03098"></a>03098                               <span class="comment">// Are we happy with our gun?</span>
<a name="l03099"></a>03099                               <span class="keywordflow">if</span> ( <a class="code" href="Soldier_01Ani_8cpp.html#1f6f56dee95e1b131f39e45fce9f8732">ShouldMercSayHappyWithGunQuote</a>( pKillerSoldier )  )
<a name="l03100"></a>03100                               {
<a name="l03101"></a>03101                                      <a class="code" href="Dialogue_01Control_8cpp.html#78d57daff1e69f02d5d83bd74d30e520">TacticalCharacterDialogue</a>( pKillerSoldier, <a class="code" href="Dialogue_01Control_8h.html#db9a2c9e383607c8609a364ff1521a29a39ddad8ab502d2405cbd4d7b1b58c9d">QUOTE_SATISFACTION_WITH_GUN_AFTER_KILL</a> );     
<a name="l03102"></a>03102                                      pKillerSoldier-&gt;usQuoteSaidFlags |= SOLDIER_QUOTE_SAID_LIKESGUN;
<a name="l03103"></a>03103                               }
<a name="l03104"></a>03104                               <span class="keywordflow">else</span>
<a name="l03105"></a>03105                               <span class="comment">// Randomize between laugh, quote...</span>
<a name="l03106"></a>03106                               {
<a name="l03107"></a>03107                                     <span class="keywordflow">if</span> ( <a class="code" href="Random_8cpp.html#49f938d1313ab6ef09ac6223a16ac334">Random</a>( 100 ) &lt; 33 &amp;&amp; pKilledSoldier-&gt;ubBodyType != <a class="code" href="Animation_01Data_8h.html#d295a916825180b548473dec560093a7fa470b7d78ba43f21bfd04c49f02a70b">BLOODCAT</a> )
<a name="l03108"></a>03108                                     {
<a name="l03109"></a>03109                   <span class="comment">// If it's a creature......</span>
<a name="l03110"></a>03110                   <span class="keywordflow">if</span> ( pKilledSoldier-&gt;uiStatusFlags &amp; SOLDIER_MONSTER )
<a name="l03111"></a>03111                   {
<a name="l03112"></a>03112                                <a class="code" href="Dialogue_01Control_8cpp.html#78d57daff1e69f02d5d83bd74d30e520">TacticalCharacterDialogue</a>( pKillerSoldier, <a class="code" href="Dialogue_01Control_8h.html#db9a2c9e383607c8609a364ff1521a2931457cdd587aa8a36ea318b931ebe7d9">QUOTE_KILLED_A_CREATURE</a> );  
<a name="l03113"></a>03113               }
<a name="l03114"></a>03114               <span class="keywordflow">else</span>
<a name="l03115"></a>03115               {
<a name="l03116"></a>03116                                             <a class="code" href="Dialogue_01Control_8cpp.html#78d57daff1e69f02d5d83bd74d30e520">TacticalCharacterDialogue</a>( pKillerSoldier, <a class="code" href="Dialogue_01Control_8h.html#db9a2c9e383607c8609a364ff1521a293625f282d0231c61ad5e76ef15040f65">QUOTE_KILLED_AN_ENEMY</a> );
<a name="l03117"></a>03117               }
<a name="l03118"></a>03118                                     }
<a name="l03119"></a>03119                                     <span class="keywordflow">else</span>
<a name="l03120"></a>03120                                     {
<a name="l03121"></a>03121                                           <span class="keywordflow">if</span> ( <a class="code" href="Random_8cpp.html#49f938d1313ab6ef09ac6223a16ac334">Random</a>( 50 ) == 25 )
<a name="l03122"></a>03122                                           {
<a name="l03123"></a>03123                                                 <a class="code" href="Soldier_01Control_8cpp.html#62effc98ffa51ddb2fc78301c82acdb8">DoMercBattleSound</a>( pKillerSoldier, (<a class="code" href="Types_8h.html#7ebe70ceca856797319175e30bcf003d">INT8</a>)( <a class="code" href="Soldier_01Control_8h.html#3ab071cf265666f49f6e3f6639d69f0a4a851f6cd9cfa3b2b9616270692f1340">BATTLE_SOUND_LAUGH1</a> ) );
<a name="l03124"></a>03124                                           }
<a name="l03125"></a>03125                                           <span class="keywordflow">else</span>
<a name="l03126"></a>03126                                           {
<a name="l03127"></a>03127                                                 <a class="code" href="Soldier_01Control_8cpp.html#62effc98ffa51ddb2fc78301c82acdb8">DoMercBattleSound</a>( pKillerSoldier, (<a class="code" href="Types_8h.html#7ebe70ceca856797319175e30bcf003d">INT8</a>)( <a class="code" href="Soldier_01Control_8h.html#3ab071cf265666f49f6e3f6639d69f0aeb62247b5212b82ddca160c00682284b">BATTLE_SOUND_COOL1</a> ) );
<a name="l03128"></a>03128                                           }
<a name="l03129"></a>03129                                     }
<a name="l03130"></a>03130                               }
<a name="l03131"></a>03131 
<a name="l03132"></a>03132           <span class="comment">// Buddy witnessed?</span>
<a name="l03133"></a>03133           <a class="code" href="Soldier_01Ani_8cpp.html#7d0fb8122f709ac54e829729c4f63b50">SayBuddyWitnessedQuoteFromKill</a>( pKillerSoldier, sGridNo, bLevel );
<a name="l03134"></a>03134           
<a name="l03135"></a>03135                         }
<a name="l03136"></a>03136                   }
<a name="l03137"></a>03137             }
<a name="l03138"></a>03138       }
<a name="l03139"></a>03139 }
<a name="l03140"></a>03140 
<a name="l03141"></a>03141 
<a name="l03142"></a>03142 
<a name="l03143"></a><a class="code" href="Soldier_01Ani_8cpp.html#3198c81214ade4869fe94476b233b7b0">03143</a> <a class="code" href="Types_8h.html#112e3146cb38b6ee95e64d85842e380a">BOOLEAN</a> <a class="code" href="Soldier_01Ani_8cpp.html#3198c81214ade4869fe94476b233b7b0">HandleSoldierDeath</a>( <a class="code" href="structSOLDIERTYPE.html">SOLDIERTYPE</a> *<a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a> , <a class="code" href="Types_8h.html#112e3146cb38b6ee95e64d85842e380a">BOOLEAN</a> *pfMadeCorpse )
<a name="l03144"></a>03144 {
<a name="l03145"></a>03145       <a class="code" href="Types_8h.html#112e3146cb38b6ee95e64d85842e380a">BOOLEAN</a> fBuddyJustDead = FALSE;
<a name="l03146"></a>03146 
<a name="l03147"></a>03147       *pfMadeCorpse = FALSE;
<a name="l03148"></a>03148 
<a name="l03149"></a>03149       <span class="keywordflow">if</span> ( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#e308dea18533bf5ab2bcee5bbe27391c">bLife</a> == 0 &amp;&amp; !( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#eb633099940bc20ff5a969bce84eab42">uiStatusFlags</a> &amp; SOLDIER_DEAD )  )
<a name="l03150"></a>03150       {
<a name="l03151"></a>03151             <span class="comment">// Cancel services here...</span>
<a name="l03152"></a>03152             <a class="code" href="Soldier_01Control_8cpp.html#309294153058aa257d8c6740127702a8">ReceivingSoldierCancelServices</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a> );
<a name="l03153"></a>03153             <a class="code" href="Soldier_01Control_8cpp.html#7781e64d8156c620efa893362bbdd469">GivingSoldierCancelServices</a>( pSoldier );
<a name="l03154"></a>03154 
<a name="l03155"></a>03155             <span class="keywordflow">if</span> ( pSoldier-&gt;iMuzFlash != -1 )
<a name="l03156"></a>03156             {
<a name="l03157"></a>03157                   <a class="code" href="lighting_8cpp.html#4222f2b7b0ba935a4fd7b3712ec28caf">LightSpriteDestroy</a>( pSoldier-&gt;iMuzFlash );
<a name="l03158"></a>03158       pSoldier-&gt;iMuzFlash = -1;
<a name="l03159"></a>03159             }
<a name="l03160"></a>03160             <span class="keywordflow">if</span> ( pSoldier-&gt;iLight != -1 )
<a name="l03161"></a>03161             {
<a name="l03162"></a>03162                   <a class="code" href="lighting_8cpp.html#4222f2b7b0ba935a4fd7b3712ec28caf">LightSpriteDestroy</a>( pSoldier-&gt;iLight );
<a name="l03163"></a>03163             }
<a name="l03164"></a>03164 
<a name="l03165"></a>03165             <span class="comment">//FREEUP GETTING HIT FLAG</span>
<a name="l03166"></a>03166             pSoldier-&gt;fGettingHit = FALSE;
<a name="l03167"></a>03167 
<a name="l03168"></a>03168             <span class="comment">// Find next closest team member!</span>
<a name="l03169"></a>03169             <span class="keywordflow">if</span> ( pSoldier-&gt;bTeam == <a class="code" href="Campaign_8cpp.html#47b2067ff75193e24776eda5297400ff">gbPlayerNum</a> )
<a name="l03170"></a>03170             {
<a name="l03171"></a>03171                   <span class="comment">// Set guy to close panel!</span>
<a name="l03172"></a>03172                   <span class="comment">// ONLY IF VISIBLE ON SCREEN</span>
<a name="l03173"></a>03173                   <span class="keywordflow">if</span> ( <a class="code" href="Interface_8cpp.html#1fefa3244fae46c36eb2858d556a031c">IsMercPortraitVisible</a>( pSoldier-&gt;ubID ) )
<a name="l03174"></a>03174                   {
<a name="l03175"></a>03175                         <a class="code" href="Interface_8cpp.html#310e02e85df33f7794f5c4c11ae1844d">fInterfacePanelDirty</a> = DIRTYLEVEL2;
<a name="l03176"></a>03176                   }
<a name="l03177"></a>03177                   pSoldier-&gt;fUIdeadMerc = TRUE;
<a name="l03178"></a>03178 
<a name="l03179"></a>03179                   <span class="keywordflow">if</span> ( !<a class="code" href="Overhead_8cpp.html#4058a40ecb7db0daccc2d09ed1ddcdc8">gfKillingGuysForLosingBattle</a> )
<a name="l03180"></a>03180                   {
<a name="l03181"></a>03181                         <span class="comment">// ATE: THIS IS S DUPLICATE SETTING OF SOLDIER_DEAD. Is set in StrategicHandlePlayerTeamMercDeath()</span>
<a name="l03182"></a>03182                         <span class="comment">// also, but here it's needed to tell tectical to ignore this dude...</span>
<a name="l03183"></a>03183                         <span class="comment">// until StrategicHandlePlayerTeamMercDeath() can get called after death skull interface is done</span>
<a name="l03184"></a>03184                         pSoldier-&gt;uiStatusFlags |= SOLDIER_DEAD;
<a name="l03185"></a>03185 
<a name="l03186"></a>03186                   }
<a name="l03187"></a>03187             }
<a name="l03188"></a>03188             <span class="keywordflow">else</span>
<a name="l03189"></a>03189             {
<a name="l03190"></a>03190                   <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubAssister;
<a name="l03191"></a>03191 
<a name="l03192"></a>03192                   <span class="comment">// IF this guy has an attacker and he's a good guy, play sound</span>
<a name="l03193"></a>03193                   <span class="keywordflow">if</span> ( pSoldier-&gt;ubAttackerID != NOBODY )
<a name="l03194"></a>03194                   {
<a name="l03195"></a>03195                         <span class="keywordflow">if</span> ( <a class="code" href="Overhead_8cpp.html#2b9a828d7d92ec404b2f9a39fc001177">MercPtrs</a>[ pSoldier-&gt;<a class="code" href="structSOLDIERTYPE.html#d9c0383469bf58f73ba6bea3e8ebf22b">ubAttackerID</a> ]-&gt;bTeam == <a class="code" href="Campaign_8cpp.html#47b2067ff75193e24776eda5297400ff">gbPlayerNum</a> &amp;&amp; <a class="code" href="Overhead_8cpp.html#46bd754f8875c305ab18731ed10e3364">gTacticalStatus</a>.<a class="code" href="structTacticalStatusType.html#b44a086b36d7dd7af18e11f8fdea4d05">ubAttackBusyCount</a> &gt; 0 )
<a name="l03196"></a>03196                         {
<a name="l03197"></a>03197                               <a class="code" href="Overhead_8cpp.html#46bd754f8875c305ab18731ed10e3364">gTacticalStatus</a>.<a class="code" href="structTacticalStatusType.html#485362dbba2ad4170def214e4249cd1c">fKilledEnemyOnAttack</a>      = TRUE;
<a name="l03198"></a>03198                               <a class="code" href="Overhead_8cpp.html#46bd754f8875c305ab18731ed10e3364">gTacticalStatus</a>.<a class="code" href="structTacticalStatusType.html#2e5542e2518aa6579a9e8ce1edb44217">ubEnemyKilledOnAttack</a> = pSoldier-&gt;ubID;
<a name="l03199"></a>03199                               <a class="code" href="Overhead_8cpp.html#46bd754f8875c305ab18731ed10e3364">gTacticalStatus</a>.<a class="code" href="structTacticalStatusType.html#788c1890a22b75142f12dbaa81cc594d">ubEnemyKilledOnAttackLocation</a> = pSoldier-&gt;sGridNo;
<a name="l03200"></a>03200                               <a class="code" href="Overhead_8cpp.html#46bd754f8875c305ab18731ed10e3364">gTacticalStatus</a>.<a class="code" href="structTacticalStatusType.html#d3afa0bbc99fea82f6a2efd1a274841c">bEnemyKilledOnAttackLevel</a> = pSoldier-&gt;bLevel;
<a name="l03201"></a>03201                               <a class="code" href="Overhead_8cpp.html#46bd754f8875c305ab18731ed10e3364">gTacticalStatus</a>.<a class="code" href="structTacticalStatusType.html#9575667cf639c6a1402f5f713151d6a9">ubEnemyKilledOnAttackKiller</a> = pSoldier-&gt;ubAttackerID;
<a name="l03202"></a>03202 
<a name="l03203"></a>03203                               <span class="comment">// also check if we are in mapscreen, if so update soldier's list</span>
<a name="l03204"></a>03204                               <span class="keywordflow">if</span>( <a class="code" href="gameloop_8cpp.html#8cd832c7f0ec6ab02ba9fddd4a2257aa">guiCurrentScreen</a> == <a class="code" href="screenids_8h.html#a4ee5dea8709d2b490486a62df77faf26f9c31d9e3c6ef2f0d8e4917d387b871">MAP_SCREEN</a> )
<a name="l03205"></a>03205                               {
<a name="l03206"></a>03206                                     <a class="code" href="mapscreen_8cpp.html#3858b01e4b3cf8bf6b64833921b801aa">ReBuildCharactersList</a>( );
<a name="l03207"></a>03207                               }
<a name="l03208"></a>03208                         }
<a name="l03209"></a>03209                         <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( pSoldier-&gt;bVisible == TRUE )
<a name="l03210"></a>03210                         {
<a name="l03211"></a>03211                               <span class="comment">// We were a visible enemy, say laugh!</span>
<a name="l03212"></a>03212                               <span class="keywordflow">if</span> ( <a class="code" href="Random_8cpp.html#49f938d1313ab6ef09ac6223a16ac334">Random</a>(3) == 0 &amp;&amp; !CREATURE_OR_BLOODCAT( <a class="code" href="Overhead_8cpp.html#2b9a828d7d92ec404b2f9a39fc001177">MercPtrs</a>[ pSoldier-&gt;<a class="code" href="structSOLDIERTYPE.html#d9c0383469bf58f73ba6bea3e8ebf22b">ubAttackerID</a> ] ) )
<a name="l03213"></a>03213                               {
<a name="l03214"></a>03214                                     <a class="code" href="Soldier_01Control_8cpp.html#62effc98ffa51ddb2fc78301c82acdb8">DoMercBattleSound</a>( <a class="code" href="Overhead_8cpp.html#2b9a828d7d92ec404b2f9a39fc001177">MercPtrs</a>[ pSoldier-&gt;<a class="code" href="structSOLDIERTYPE.html#d9c0383469bf58f73ba6bea3e8ebf22b">ubAttackerID</a> ], <a class="code" href="Soldier_01Control_8h.html#3ab071cf265666f49f6e3f6639d69f0a4a851f6cd9cfa3b2b9616270692f1340">BATTLE_SOUND_LAUGH1</a> );
<a name="l03215"></a>03215                               }
<a name="l03216"></a>03216                         }
<a name="l03217"></a>03217                   }
<a name="l03218"></a>03218 
<a name="l03219"></a>03219                   <span class="comment">// Handle NPC Dead</span>
<a name="l03220"></a>03220                   <a class="code" href="Overhead_8cpp.html#1014a3daa577752bff1c94d184a8010d">HandleNPCTeamMemberDeath</a>( pSoldier );
<a name="l03221"></a>03221 
<a name="l03222"></a>03222                   <span class="comment">// if a friendly with a profile, increment kills</span>
<a name="l03223"></a>03223                   <span class="comment">// militia also now track kills...</span>
<a name="l03224"></a>03224                   <span class="keywordflow">if</span> ( pSoldier-&gt;ubAttackerID != NOBODY ) 
<a name="l03225"></a>03225                   {
<a name="l03226"></a>03226                         <span class="keywordflow">if</span> ( <a class="code" href="Overhead_8cpp.html#2b9a828d7d92ec404b2f9a39fc001177">MercPtrs</a>[ pSoldier-&gt;<a class="code" href="structSOLDIERTYPE.html#d9c0383469bf58f73ba6bea3e8ebf22b">ubAttackerID</a> ]-&gt;bTeam == <a class="code" href="Campaign_8cpp.html#47b2067ff75193e24776eda5297400ff">gbPlayerNum</a> )
<a name="l03227"></a>03227                         {
<a name="l03228"></a>03228                               <span class="comment">// increment kills</span>
<a name="l03229"></a>03229                               <a class="code" href="Soldier_01Profile_8cpp.html#1bcff2c50b375b1eb32800aa12000289">gMercProfiles</a>[ <a class="code" href="Overhead_8cpp.html#2b9a828d7d92ec404b2f9a39fc001177">MercPtrs</a>[ pSoldier-&gt;ubAttackerID ]-&gt;<a class="code" href="structSOLDIERTYPE.html#5a5648a1bb3507cc41f6be199c51a3f8">ubProfile</a> ].<a class="code" href="structMERCPROFILESTRUCT.html#08cd6765b5a68f7300543d50aae78b1f">usKills</a>++;
<a name="l03230"></a>03230                               <a class="code" href="Strategic_01Status_8cpp.html#d72c00003b4e5d43338acc06d679a99f">gStrategicStatus</a>.<a class="code" href="structSTRATEGIC__STATUS.html#10cd589d53edf337c57d292ea415ac26">usPlayerKills</a>++;
<a name="l03231"></a>03231                         }
<a name="l03232"></a>03232                         <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( <a class="code" href="Overhead_8cpp.html#2b9a828d7d92ec404b2f9a39fc001177">MercPtrs</a>[ pSoldier-&gt;<a class="code" href="structSOLDIERTYPE.html#d9c0383469bf58f73ba6bea3e8ebf22b">ubAttackerID</a> ]-&gt;bTeam == MILITIA_TEAM )
<a name="l03233"></a>03233                         {
<a name="l03234"></a>03234                               <span class="comment">// get a kill! 2 points!</span>
<a name="l03235"></a>03235                               <a class="code" href="Overhead_8cpp.html#2b9a828d7d92ec404b2f9a39fc001177">MercPtrs</a>[ pSoldier-&gt;ubAttackerID ]-&gt;<a class="code" href="structSOLDIERTYPE.html#469053371ce74fb01faca0a4a738a317">ubMilitiaKills</a> += 2;
<a name="l03236"></a>03236                         }
<a name="l03237"></a>03237 
<a name="l03238"></a>03238                   }
<a name="l03239"></a>03239 
<a name="l03240"></a>03240                   <span class="comment">// JA2 Gold: if previous and current attackers are the same, the next-to-previous attacker gets the assist</span>
<a name="l03241"></a>03241                   <span class="keywordflow">if</span> (pSoldier-&gt;ubPreviousAttackerID == pSoldier-&gt;ubAttackerID)
<a name="l03242"></a>03242                   {
<a name="l03243"></a>03243                         ubAssister = pSoldier-&gt;ubNextToPreviousAttackerID;
<a name="l03244"></a>03244                   }
<a name="l03245"></a>03245                   <span class="keywordflow">else</span>
<a name="l03246"></a>03246                   {
<a name="l03247"></a>03247                         ubAssister = pSoldier-&gt;ubPreviousAttackerID;
<a name="l03248"></a>03248                   }
<a name="l03249"></a>03249 
<a name="l03250"></a>03250                   <span class="keywordflow">if</span> ( ubAssister != NOBODY &amp;&amp; ubAssister != pSoldier-&gt;ubAttackerID )
<a name="l03251"></a>03251                   {
<a name="l03252"></a>03252                         <span class="keywordflow">if</span> ( <a class="code" href="Overhead_8cpp.html#2b9a828d7d92ec404b2f9a39fc001177">MercPtrs</a>[ ubAssister ]-&gt;bTeam == <a class="code" href="Campaign_8cpp.html#47b2067ff75193e24776eda5297400ff">gbPlayerNum</a> )
<a name="l03253"></a>03253                         {           
<a name="l03254"></a>03254                               <a class="code" href="Soldier_01Profile_8cpp.html#1bcff2c50b375b1eb32800aa12000289">gMercProfiles</a>[ <a class="code" href="Overhead_8cpp.html#2b9a828d7d92ec404b2f9a39fc001177">MercPtrs</a>[ ubAssister ]-&gt;<a class="code" href="structSOLDIERTYPE.html#5a5648a1bb3507cc41f6be199c51a3f8">ubProfile</a> ].<a class="code" href="structMERCPROFILESTRUCT.html#56f7b546fb4e4c4f934faa4ff3a07c00">usAssists</a>++;
<a name="l03255"></a>03255                         }
<a name="l03256"></a>03256                         <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( <a class="code" href="Overhead_8cpp.html#2b9a828d7d92ec404b2f9a39fc001177">MercPtrs</a>[ ubAssister ]-&gt;bTeam == MILITIA_TEAM )
<a name="l03257"></a>03257                         {
<a name="l03258"></a>03258                               <span class="comment">// get an assist - 1 points</span>
<a name="l03259"></a>03259                               <a class="code" href="Overhead_8cpp.html#2b9a828d7d92ec404b2f9a39fc001177">MercPtrs</a>[ ubAssister ]-&gt;<a class="code" href="structSOLDIERTYPE.html#469053371ce74fb01faca0a4a738a317">ubMilitiaKills</a> += 1;
<a name="l03260"></a>03260                         }
<a name="l03261"></a>03261                   }
<a name="l03262"></a>03262                   <span class="comment">/*</span>
<a name="l03263"></a>03263 <span class="comment">                  // handle assist</span>
<a name="l03264"></a>03264 <span class="comment">                  // if killer is assister, don't increment</span>
<a name="l03265"></a>03265 <span class="comment">                  if ( pSoldier-&gt;ubPreviousAttackerID != NOBODY &amp;&amp; pSoldier-&gt;ubPreviousAttackerID != pSoldier-&gt;ubAttackerID )</span>
<a name="l03266"></a>03266 <span class="comment">                  {</span>
<a name="l03267"></a>03267 <span class="comment">                        if ( MercPtrs[ pSoldier-&gt;ubPreviousAttackerID ]-&gt;bTeam == gbPlayerNum )</span>
<a name="l03268"></a>03268 <span class="comment">                        {           </span>
<a name="l03269"></a>03269 <span class="comment">                              gMercProfiles[ MercPtrs[ pSoldier-&gt;ubPreviousAttackerID ]-&gt;ubProfile ].usAssists++;</span>
<a name="l03270"></a>03270 <span class="comment">                        }</span>
<a name="l03271"></a>03271 <span class="comment">                        else if ( MercPtrs[ pSoldier-&gt;ubPreviousAttackerID ]-&gt;bTeam == MILITIA_TEAM )</span>
<a name="l03272"></a>03272 <span class="comment">                        {</span>
<a name="l03273"></a>03273 <span class="comment">                              // get an assist - 1 points</span>
<a name="l03274"></a>03274 <span class="comment">                              MercPtrs[ pSoldier-&gt;ubPreviousAttackerID ]-&gt;ubMilitiaKills += 1;</span>
<a name="l03275"></a>03275 <span class="comment">                        }</span>
<a name="l03276"></a>03276 <span class="comment">                  }</span>
<a name="l03277"></a>03277 <span class="comment">                  */</span>
<a name="l03278"></a>03278             }
<a name="l03279"></a>03279 
<a name="l03280"></a>03280             <span class="keywordflow">if</span> ( <a class="code" href="Rotting_01Corpses_8cpp.html#6ab597235d31aa8ae4bbc6eb8baaed2f">TurnSoldierIntoCorpse</a>( pSoldier, TRUE, TRUE ) )
<a name="l03281"></a>03281             {
<a name="l03282"></a>03282                   *pfMadeCorpse = TRUE;
<a name="l03283"></a>03283             }
<a name="l03284"></a>03284 
<a name="l03285"></a>03285             <span class="comment">// Remove mad as target, one he has died!</span>
<a name="l03286"></a>03286             <a class="code" href="opplist_8cpp.html#e2c160d5301f86846dcf6242345152aa">RemoveManAsTarget</a>( pSoldier );
<a name="l03287"></a>03287 
<a name="l03288"></a>03288             <span class="comment">// Re-evaluate visiblitiy for the team!</span>
<a name="l03289"></a>03289             <a class="code" href="opplist_8cpp.html#b8a47d7b99b4b1bdfd3d2ab5a873d26e">BetweenTurnsVisibilityAdjustments</a>();
<a name="l03290"></a>03290 
<a name="l03291"></a>03291             <span class="keywordflow">if</span> ( pSoldier-&gt;bTeam != <a class="code" href="Campaign_8cpp.html#47b2067ff75193e24776eda5297400ff">gbPlayerNum</a> )
<a name="l03292"></a>03292             {
<a name="l03293"></a>03293       <span class="keywordflow">if</span> ( !pSoldier-&gt;fDoingExternalDeath )
<a name="l03294"></a>03294       {
<a name="l03295"></a>03295                     <span class="comment">// Release attacker</span>
<a name="l03296"></a>03296                     DebugMsg( TOPIC_JA2, DBG_LEVEL_3, <a class="code" href="DEBUG_8cpp.html#88565bf27eec0b2003eb5bc9426b8e4b">String</a>(<span class="stringliteral">"@@@@@@@ Releasesoldierattacker, code 497 = handle soldier death"</span>) );
<a name="l03297"></a>03297                     <a class="code" href="Soldier_01Control_8cpp.html#ffdbb2d52e0bf2a7f9fe3559bdcf0ffb">ReleaseSoldiersAttacker</a>( pSoldier );
<a name="l03298"></a>03298       }
<a name="l03299"></a>03299             }
<a name="l03300"></a>03300 
<a name="l03301"></a>03301             <span class="keywordflow">if</span> ( !( *pfMadeCorpse ) )
<a name="l03302"></a>03302             {
<a name="l03303"></a>03303                   fBuddyJustDead = TRUE;
<a name="l03304"></a>03304             }
<a name="l03305"></a>03305 
<a name="l03306"></a>03306       }
<a name="l03307"></a>03307 
<a name="l03308"></a>03308       <span class="keywordflow">if</span> ( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#e308dea18533bf5ab2bcee5bbe27391c">bLife</a> &gt; 0 )
<a name="l03309"></a>03309       {
<a name="l03310"></a>03310             <span class="comment">// If we are here - something funny has heppende</span>
<a name="l03311"></a>03311             <span class="comment">// We either have played a death animation when we are not dead, or we are calling</span>
<a name="l03312"></a>03312             <span class="comment">// this ani code in an animation which is not a death animation</span>
<a name="l03313"></a>03313             DebugMsg( TOPIC_JA2, DBG_LEVEL_3, <span class="stringliteral">"Soldier Ani: Death animation called when not dead..."</span> );
<a name="l03314"></a>03314       }
<a name="l03315"></a>03315 
<a name="l03316"></a>03316       <span class="keywordflow">return</span>( fBuddyJustDead );
<a name="l03317"></a>03317 }
<a name="l03318"></a>03318 
<a name="l03319"></a>03319 
<a name="l03320"></a><a class="code" href="Soldier_01Ani_8cpp.html#9773931379de4a63fce7323c3adfcf48">03320</a> <span class="keywordtype">void</span> <a class="code" href="Interface_01Panels_8cpp.html#9773931379de4a63fce7323c3adfcf48">HandlePlayerTeamMemberDeathAfterSkullAnimation</a>( <a class="code" href="structSOLDIERTYPE.html">SOLDIERTYPE</a> *<a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a> )
<a name="l03321"></a>03321 {
<a name="l03322"></a>03322       <span class="comment">// Release attacker</span>
<a name="l03323"></a>03323   <span class="keywordflow">if</span> ( !<a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#d0b7a7db86fae79d253f0d430ed552f6">fDoingExternalDeath</a> )
<a name="l03324"></a>03324   {
<a name="l03325"></a>03325         DebugMsg( TOPIC_JA2, DBG_LEVEL_3, <a class="code" href="DEBUG_8cpp.html#88565bf27eec0b2003eb5bc9426b8e4b">String</a>(<span class="stringliteral">"@@@@@@@ Releasesoldierattacker, code 497 = handle soldier death"</span>) );
<a name="l03326"></a>03326         <a class="code" href="Soldier_01Control_8cpp.html#ffdbb2d52e0bf2a7f9fe3559bdcf0ffb">ReleaseSoldiersAttacker</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a> );
<a name="l03327"></a>03327   }
<a name="l03328"></a>03328 
<a name="l03329"></a>03329       <a class="code" href="Overhead_8cpp.html#1932e8fe997d73bfbfc2c7502c03a711">HandlePlayerTeamMemberDeath</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a> );
<a name="l03330"></a>03330 
<a name="l03331"></a>03331       <span class="comment">// now remove character from a squad</span>
<a name="l03332"></a>03332       <a class="code" href="Squads_8cpp.html#2586d9acf930218a33a0d83ac760c240">RemoveCharacterFromSquads</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a> );    
<a name="l03333"></a>03333 }
<a name="l03334"></a>03334 
<a name="l03335"></a><a class="code" href="Soldier_01Ani_8h.html#c8dc487d70dc5109dd507c1dcf8efb45">03335</a> <a class="code" href="Types_8h.html#112e3146cb38b6ee95e64d85842e380a">BOOLEAN</a> <a class="code" href="Soldier_01Ani_8cpp.html#c8dc487d70dc5109dd507c1dcf8efb45">CheckForAndHandleSoldierDeath</a>( <a class="code" href="structSOLDIERTYPE.html">SOLDIERTYPE</a> *<a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>, <a class="code" href="Types_8h.html#112e3146cb38b6ee95e64d85842e380a">BOOLEAN</a> *pfMadeCorpse )
<a name="l03336"></a>03336 {
<a name="l03337"></a>03337 
<a name="l03338"></a>03338       <span class="keywordflow">if</span> ( <a class="code" href="Soldier_01Ani_8cpp.html#3198c81214ade4869fe94476b233b7b0">HandleSoldierDeath</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>, pfMadeCorpse ) )
<a name="l03339"></a>03339       {
<a name="l03340"></a>03340             <span class="comment">// Select approriate death</span>
<a name="l03341"></a>03341             <span class="keywordflow">switch</span>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#1f73b62a5ea0dd26fa1bec1d9f522b41">usAnimState</a> )
<a name="l03342"></a>03342             {
<a name="l03343"></a>03343                   <span class="keywordflow">case</span> <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2eb5bcd7c4372d4c29e14785d64946171a0">FLYBACK_HIT_DEATH</a>:
<a name="l03344"></a>03344                         <a class="code" href="Soldier_01Control_8cpp.html#6f191e00fb4f3c5e2cbe762aa402a420">ChangeSoldierState</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>, <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2ebbb5234e5a45920f29f0d88d4de306466">FLYBACK_HITDEATH_STOP</a>, 0, FALSE );
<a name="l03345"></a>03345                         <span class="keywordflow">break</span>;
<a name="l03346"></a>03346 
<a name="l03347"></a>03347                   <span class="keywordflow">case</span> <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2eb2e67b5b42c024d627d8887316ae3b01e">GENERIC_HIT_DEATH</a>:
<a name="l03348"></a>03348                         <a class="code" href="Soldier_01Control_8cpp.html#6f191e00fb4f3c5e2cbe762aa402a420">ChangeSoldierState</a>( pSoldier, <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2ebe2cf9cbcbd28b520fb1ac63924b8ab2c">FALLFORWARD_HITDEATH_STOP</a>, 0, FALSE );
<a name="l03349"></a>03349                         <span class="keywordflow">break</span>;
<a name="l03350"></a>03350 
<a name="l03351"></a>03351                   <span class="keywordflow">case</span> <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2ebd7cc0407572496e696f7ef6b1e2c97ca">FALLBACK_HIT_DEATH</a>:
<a name="l03352"></a>03352                         <a class="code" href="Soldier_01Control_8cpp.html#6f191e00fb4f3c5e2cbe762aa402a420">ChangeSoldierState</a>( pSoldier, <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2eb9a19aea70bc9ae5ddd2f9e92c5e698f3">FALLBACK_HITDEATH_STOP</a>, 0, FALSE );
<a name="l03353"></a>03353                         <span class="keywordflow">break</span>;
<a name="l03354"></a>03354 
<a name="l03355"></a>03355                   <span class="keywordflow">case</span> <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2eb635e5ea103631d96fda3a4042a659afc">PRONE_HIT_DEATH</a>:
<a name="l03356"></a>03356                         <a class="code" href="Soldier_01Control_8cpp.html#6f191e00fb4f3c5e2cbe762aa402a420">ChangeSoldierState</a>( pSoldier, <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2eb384e193eb6424d398a336ca9cc9490d1">PRONE_HITDEATH_STOP</a>, 0, FALSE );
<a name="l03357"></a>03357                         <span class="keywordflow">break</span>;
<a name="l03358"></a>03358 
<a name="l03359"></a>03359                   <span class="keywordflow">case</span> <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2ebf519f2bb07cc5f8f605e3354e4e2e806">JFK_HITDEATH</a>:
<a name="l03360"></a>03360                         <a class="code" href="Soldier_01Control_8cpp.html#6f191e00fb4f3c5e2cbe762aa402a420">ChangeSoldierState</a>( pSoldier, <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2ebb171de356e888b0b891cb1d50b539c59">JFK_HITDEATH_STOP</a>, 0, FALSE );
<a name="l03361"></a>03361                         <span class="keywordflow">break</span>;
<a name="l03362"></a>03362 
<a name="l03363"></a>03363                   <span class="keywordflow">case</span> <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2eb7490325e516e0cf31a0b03ec84df068f">FALLOFF_DEATH</a>:
<a name="l03364"></a>03364                         <a class="code" href="Soldier_01Control_8cpp.html#6f191e00fb4f3c5e2cbe762aa402a420">ChangeSoldierState</a>( pSoldier, <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2eb3377a938cca05c215780e13caa9002c5">FALLOFF_DEATH_STOP</a>, 0, FALSE );
<a name="l03365"></a>03365                         <span class="keywordflow">break</span>;
<a name="l03366"></a>03366 
<a name="l03367"></a>03367                   <span class="keywordflow">case</span> <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2eb1388740da829de4a2f7d782d24666b8f">FALLOFF_FORWARD_DEATH</a>:
<a name="l03368"></a>03368                         <a class="code" href="Soldier_01Control_8cpp.html#6f191e00fb4f3c5e2cbe762aa402a420">ChangeSoldierState</a>( pSoldier, <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2ebc2eb1503a071282742b086300bef218d">FALLOFF_FORWARD_DEATH_STOP</a>, 0, FALSE );
<a name="l03369"></a>03369                         <span class="keywordflow">break</span>;
<a name="l03370"></a>03370 
<a name="l03371"></a>03371                   <span class="keywordflow">case</span> <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2eb06ae7564e2a3a102dc4b34a57a212925">WATER_DIE</a>:
<a name="l03372"></a>03372                         <a class="code" href="Soldier_01Control_8cpp.html#6f191e00fb4f3c5e2cbe762aa402a420">ChangeSoldierState</a>( pSoldier, <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2ebb7b9c27b0b6e7a4ee8f94078eec4bc09">WATER_DIE_STOP</a>, 0, FALSE );
<a name="l03373"></a>03373                         <span class="keywordflow">break</span>;
<a name="l03374"></a>03374 
<a name="l03375"></a>03375                   <span class="keywordflow">case</span> <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2ebeddf4cc9108ff2aca04f50bf94316091">DEEP_WATER_DIE</a>:
<a name="l03376"></a>03376                         <a class="code" href="Soldier_01Control_8cpp.html#6f191e00fb4f3c5e2cbe762aa402a420">ChangeSoldierState</a>( pSoldier, <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2eb0d2f191e4a69046482585dab4595b84f">DEEP_WATER_DIE_STOPPING</a>, 0, FALSE );
<a name="l03377"></a>03377                         <span class="keywordflow">break</span>;
<a name="l03378"></a>03378 
<a name="l03379"></a>03379                   <span class="keywordflow">case</span> <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2eb5e6625bbcde24192102411607d29c19f">COW_DYING</a>:
<a name="l03380"></a>03380                         <a class="code" href="Soldier_01Control_8cpp.html#6f191e00fb4f3c5e2cbe762aa402a420">ChangeSoldierState</a>( pSoldier, <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2ebc0b8852e11df2725980c20d4cd386e5b">COW_DYING_STOP</a>, 0, FALSE);
<a name="l03381"></a>03381                         <span class="keywordflow">break</span>;
<a name="l03382"></a>03382 
<a name="l03383"></a>03383                   <span class="keywordflow">case</span> <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2eb9ce43f928ecadcf58f42ae6613318c0c">BLOODCAT_DYING</a>:
<a name="l03384"></a>03384                         <a class="code" href="Soldier_01Control_8cpp.html#6f191e00fb4f3c5e2cbe762aa402a420">ChangeSoldierState</a>( pSoldier, <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2ebe32bd7074406c2f64b123ce5846fef27">BLOODCAT_DYING_STOP</a>, 0, FALSE);
<a name="l03385"></a>03385                         <span class="keywordflow">break</span>;
<a name="l03386"></a>03386 
<a name="l03387"></a>03387                   <span class="keywordflow">default</span>:
<a name="l03388"></a>03388 
<a name="l03389"></a>03389                         <span class="comment">// IF we are here - something is wrong - we should have an animation stop here</span>
<a name="l03390"></a>03390                         DebugMsg( TOPIC_JA2, DBG_LEVEL_3, <span class="stringliteral">"Soldier Ani: CODE 440 Error, Death STOP not handled"</span> );
<a name="l03391"></a>03391             }
<a name="l03392"></a>03392 
<a name="l03393"></a>03393             <span class="keywordflow">return</span>( TRUE );
<a name="l03394"></a>03394       }
<a name="l03395"></a>03395 
<a name="l03396"></a>03396       <span class="keywordflow">return</span>( FALSE );
<a name="l03397"></a>03397 }
<a name="l03398"></a>03398 
<a name="l03399"></a>03399 
<a name="l03400"></a>03400 <span class="comment">//#define TESTFALLBACK</span>
<a name="l03401"></a>03401 <span class="comment">//#define TESTFALLFORWARD</span>
<a name="l03402"></a>03402 
<a name="l03403"></a><a class="code" href="Soldier_01Ani_8cpp.html#a9bf3ae72a0d41cf3cdcd31c8f3d01e9">03403</a> <span class="keywordtype">void</span> <a class="code" href="Soldier_01Ani_8cpp.html#a9bf3ae72a0d41cf3cdcd31c8f3d01e9">CheckForAndHandleSoldierIncompacitated</a>( <a class="code" href="structSOLDIERTYPE.html">SOLDIERTYPE</a> *<a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a> )
<a name="l03404"></a>03404 {
<a name="l03405"></a>03405       <a class="code" href="Types_8h.html#30f500129d8c688af07726d5d34ce52d">INT16</a>                         sNewGridNo;
<a name="l03406"></a>03406 
<a name="l03407"></a>03407       <span class="keywordflow">if</span> ( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#e308dea18533bf5ab2bcee5bbe27391c">bLife</a> &lt; OKLIFE )
<a name="l03408"></a>03408       {
<a name="l03409"></a>03409             <span class="comment">// Cancel services here...</span>
<a name="l03410"></a>03410             <a class="code" href="Soldier_01Control_8cpp.html#309294153058aa257d8c6740127702a8">ReceivingSoldierCancelServices</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a> );
<a name="l03411"></a>03411             <a class="code" href="Soldier_01Control_8cpp.html#7781e64d8156c620efa893362bbdd469">GivingSoldierCancelServices</a>( pSoldier );
<a name="l03412"></a>03412 
<a name="l03413"></a>03413 
<a name="l03414"></a>03414             <span class="comment">// If we are a monster, set life to zero ( no unconscious )</span>
<a name="l03415"></a>03415             <span class="keywordflow">switch</span>( pSoldier-&gt;ubBodyType )
<a name="l03416"></a>03416             {
<a name="l03417"></a>03417                   <span class="keywordflow">case</span> <a class="code" href="Animation_01Data_8h.html#d295a916825180b548473dec560093a78e8f2de8ab141e991ee2b34ebb1dfda1">ADULTFEMALEMONSTER</a>:
<a name="l03418"></a>03418                   <span class="keywordflow">case</span> <a class="code" href="Animation_01Data_8h.html#d295a916825180b548473dec560093a79dec21a470d88f8b8a8704cb9b5ac827">AM_MONSTER</a>:
<a name="l03419"></a>03419                   <span class="keywordflow">case</span> <a class="code" href="Animation_01Data_8h.html#d295a916825180b548473dec560093a75f60be3c60e156d8cec34802d7f3607b">YAF_MONSTER</a>:
<a name="l03420"></a>03420                   <span class="keywordflow">case</span> <a class="code" href="Animation_01Data_8h.html#d295a916825180b548473dec560093a725460f03079c143c4456f779763fa23b">YAM_MONSTER</a>:
<a name="l03421"></a>03421                   <span class="keywordflow">case</span> <a class="code" href="Animation_01Data_8h.html#d295a916825180b548473dec560093a7c6b7363ef12dbe5ad2377613a3d33db9">LARVAE_MONSTER</a>:
<a name="l03422"></a>03422                   <span class="keywordflow">case</span> <a class="code" href="Animation_01Data_8h.html#d295a916825180b548473dec560093a7e687bcc336b8be3ac4aac1346046d095">INFANT_MONSTER</a>:
<a name="l03423"></a>03423                   <span class="keywordflow">case</span> <a class="code" href="Animation_01Data_8h.html#d295a916825180b548473dec560093a75db4e8d299d195df30798a12cd332f5a">CRIPPLECIV</a>:
<a name="l03424"></a>03424                   <span class="keywordflow">case</span> <a class="code" href="Animation_01Data_8h.html#d295a916825180b548473dec560093a7ecd13f015271b5b87d3e53037a5011bb">ROBOTNOWEAPON</a>:
<a name="l03425"></a>03425                   <span class="keywordflow">case</span> <a class="code" href="Animation_01Data_8h.html#d295a916825180b548473dec560093a75f327a7c32f4f979f42e8d6f6adbf587">QUEENMONSTER</a>:
<a name="l03426"></a>03426                   <span class="keywordflow">case</span> <a class="code" href="Animation_01Data_8h.html#d295a916825180b548473dec560093a708ba6f8fd9cf7e71998af76cccab9209">TANK_NW</a>:
<a name="l03427"></a>03427                   <span class="keywordflow">case</span> <a class="code" href="Animation_01Data_8h.html#d295a916825180b548473dec560093a774887c6043843fcb84d7e6b341257354">TANK_NE</a>:
<a name="l03428"></a>03428 
<a name="l03429"></a>03429                         pSoldier-&gt;bLife = 0;
<a name="l03430"></a>03430                         <span class="keywordflow">break</span>;
<a name="l03431"></a>03431             }
<a name="l03432"></a>03432 
<a name="l03433"></a>03433             <span class="comment">// OK, if we are in a meanwhile and this is elliot...</span>
<a name="l03434"></a>03434             <span class="keywordflow">if</span> ( <a class="code" href="Meanwhile_8cpp.html#469f9fe7efd5677c25840cf980c1fb55">AreInMeanwhile</a>( ) )
<a name="l03435"></a>03435             {
<a name="l03436"></a>03436                   <a class="code" href="structSOLDIERTYPE.html">SOLDIERTYPE</a> *pQueen;
<a name="l03437"></a>03437                         
<a name="l03438"></a>03438                   pQueen = <a class="code" href="Soldier_01Profile_8cpp.html#2a54c4a06df8ed61529646f23682ef9d">FindSoldierByProfileID</a>( <a class="code" href="Soldier_01Profile_8h.html#acaa92dcb344e96138c964deae3e2fa158561257be7e2f96f82c0fdb51d7f964">QUEEN</a>, FALSE );
<a name="l03439"></a>03439 
<a name="l03440"></a>03440                   <span class="keywordflow">if</span> ( pQueen )
<a name="l03441"></a>03441                   {
<a name="l03442"></a>03442                         <a class="code" href="NPC_8cpp.html#d7f92a649ae364cf3c2b7b69c4806bd0">TriggerNPCWithGivenApproach</a>( <a class="code" href="Soldier_01Profile_8h.html#acaa92dcb344e96138c964deae3e2fa158561257be7e2f96f82c0fdb51d7f964">QUEEN</a>, <a class="code" href="NPC_8h.html#fe4ba80db4eca5533465fe913160a13ab03dc54bc62e0afa9aef7cd9256c263b">APPROACH_DONE_SLAPPED</a>, FALSE );
<a name="l03443"></a>03443                   }
<a name="l03444"></a>03444             }
<a name="l03445"></a>03445 
<a name="l03446"></a>03446             <span class="comment">// We are unconscious now, play randomly, this animation continued, or a new death</span>
<a name="l03447"></a>03447             <span class="keywordflow">if</span> ( <a class="code" href="Soldier_01Control_8cpp.html#8ce93e4f98669619b1460388def77d7f">CheckSoldierHitRoof</a>( pSoldier ) )
<a name="l03448"></a>03448             {
<a name="l03449"></a>03449                   <span class="keywordflow">return</span>;
<a name="l03450"></a>03450             }
<a name="l03451"></a>03451 
<a name="l03452"></a>03452             <span class="comment">// If guy is now dead, play sound!</span>
<a name="l03453"></a>03453             <span class="keywordflow">if</span> ( pSoldier-&gt;bLife == 0  )
<a name="l03454"></a>03454             {
<a name="l03455"></a>03455                   <span class="keywordflow">if</span> ( !<a class="code" href="Meanwhile_8cpp.html#469f9fe7efd5677c25840cf980c1fb55">AreInMeanwhile</a>() )
<a name="l03456"></a>03456                   {
<a name="l03457"></a>03457                         <a class="code" href="Soldier_01Control_8cpp.html#62effc98ffa51ddb2fc78301c82acdb8">DoMercBattleSound</a>( pSoldier, <a class="code" href="Soldier_01Control_8h.html#3ab071cf265666f49f6e3f6639d69f0abf28cedf54317c01049c44943809631d">BATTLE_SOUND_DIE1</a> );
<a name="l03458"></a>03458                   pSoldier-&gt;fDeadSoundPlayed = TRUE;
<a name="l03459"></a>03459                   }
<a name="l03460"></a>03460             }
<a name="l03461"></a>03461 
<a name="l03462"></a>03462             <span class="comment">// Randomly fall back or forward, if we are in the standing hit animation</span>
<a name="l03463"></a>03463             <span class="keywordflow">if</span> ( pSoldier-&gt;usAnimState == <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2eb1f83464b1bfc5eba459fbc0a35025ccb">GENERIC_HIT_STAND</a> || pSoldier-&gt;usAnimState == <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2ebd1347b5ba076b7536975eabc6b8e3575">STANDING_BURST_HIT</a> || pSoldier-&gt;usAnimState == <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2eb0e5a6f1a34ca54a677f4bff1c72fdcad">RIFLE_STAND_HIT</a> )
<a name="l03464"></a>03464             {
<a name="l03465"></a>03465                   <a class="code" href="Types_8h.html#7ebe70ceca856797319175e30bcf003d">INT8</a>        bTestDirection  = pSoldier-&gt;bDirection;
<a name="l03466"></a>03466                   <a class="code" href="Types_8h.html#112e3146cb38b6ee95e64d85842e380a">BOOLEAN</a>           fForceDirection = FALSE;
<a name="l03467"></a>03467                   <a class="code" href="Types_8h.html#112e3146cb38b6ee95e64d85842e380a">BOOLEAN</a>           fDoFallback       = FALSE;
<a name="l03468"></a>03468 
<a name="l03469"></a>03469 
<a name="l03470"></a>03470                   <span class="comment">// Lesh: lets fix dead humans fallback through obstacles</span>
<a name="l03471"></a>03471 
<a name="l03472"></a>03472                   <span class="comment">// TRY FALLING BACKWARDS, ( ONLY IF WE ARE A MERC! )</span>
<a name="l03473"></a>03473 <span class="preprocessor">#ifdef TESTFALLBACK</span>
<a name="l03474"></a>03474 <span class="preprocessor"></span>                  <span class="keywordflow">if</span> ( IS_MERC_BODY_TYPE( pSoldier ) )
<a name="l03475"></a>03475 <span class="preprocessor">#elif defined ( TESTFALLFORWARD )</span>
<a name="l03476"></a>03476 <span class="preprocessor"></span>                  <span class="keywordflow">if</span> ( 0 )
<a name="l03477"></a>03477 <span class="preprocessor">#else</span>
<a name="l03478"></a>03478 <span class="preprocessor"></span>                  <span class="keywordflow">if</span> ( <a class="code" href="Random_8cpp.html#49f938d1313ab6ef09ac6223a16ac334">Random</a>(100 ) &gt; 40 &amp;&amp; IS_MERC_BODY_TYPE( pSoldier ) &amp;&amp; !<a class="code" href="Soldier_01Profile_8cpp.html#3e2d7d97870b11cb46289e6b96317551">IsProfileATerrorist</a>( pSoldier-&gt;ubProfile ) )
<a name="l03479"></a>03479 <span class="preprocessor">#endif</span>
<a name="l03480"></a>03480 <span class="preprocessor"></span>                  {
<a name="l03481"></a>03481                         <span class="comment">// CHECK IF WE HAVE AN ATTACKER, TAKE OPPOSITE DIRECTION!</span>
<a name="l03482"></a>03482                         <span class="keywordflow">if</span> ( pSoldier-&gt;ubAttackerID != NOBODY )
<a name="l03483"></a>03483                         { 
<a name="l03484"></a>03484                               <span class="comment">// Find direction!</span>
<a name="l03485"></a>03485                               bTestDirection = (<a class="code" href="Types_8h.html#7ebe70ceca856797319175e30bcf003d">INT8</a>)<a class="code" href="Soldier_01Control_8cpp.html#1d7b6c103ede7e551e76eef2ef173f9b">GetDirectionFromGridNo</a>( <a class="code" href="Overhead_8cpp.html#2b9a828d7d92ec404b2f9a39fc001177">MercPtrs</a>[ pSoldier-&gt;<a class="code" href="structSOLDIERTYPE.html#d9c0383469bf58f73ba6bea3e8ebf22b">ubAttackerID</a> ]-&gt;sGridNo, pSoldier );
<a name="l03486"></a>03486                               fForceDirection = TRUE;
<a name="l03487"></a>03487                         }
<a name="l03488"></a>03488 
<a name="l03489"></a>03489                         sNewGridNo = <a class="code" href="Isometric_01Utils_8cpp.html#318d8410127e29bb232ab70363bc316e">NewGridNo</a>( (<a class="code" href="Types_8h.html#09f1a1fb2293e33483cc8d44aefb1eb1">UINT16</a>)pSoldier-&gt;sGridNo, <a class="code" href="Isometric_01Utils_8cpp.html#a4a3adf599f99864b1de33673888fd5e">DirectionInc</a>( <a class="code" href="Isometric_01Utils_8cpp.html#9591ab6c902758a420fd3d9f4e49ba2e">gOppositeDirection</a>[ bTestDirection ] ) );
<a name="l03490"></a>03490 
<a name="l03491"></a>03491                         <span class="keywordflow">if</span> ( <a class="code" href="Soldier_01Ani_8cpp.html#52dee080c40e99d978e145a7fd2f3a67">OKFallDirection</a>( pSoldier, sNewGridNo, pSoldier-&gt;bLevel, bTestDirection, <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2eb45acaaee9f8cf7570b7b840b8d20dbcc">FLYBACK_HIT</a> ) )
<a name="l03492"></a>03492                         {
<a name="l03493"></a>03493                               <span class="comment">// CHECKED BEHIND GRIDS - OK</span>
<a name="l03494"></a>03494                               fDoFallback = TRUE;
<a name="l03495"></a>03495                         }
<a name="l03496"></a>03496                         <span class="keywordflow">else</span>
<a name="l03497"></a>03497                         {
<a name="l03498"></a>03498                               fDoFallback = FALSE;
<a name="l03499"></a>03499                         }
<a name="l03500"></a>03500 
<a name="l03501"></a>03501                   }
<a name="l03502"></a>03502                   <span class="keywordflow">else</span>
<a name="l03503"></a>03503                   {
<a name="l03504"></a>03504                         fDoFallback = FALSE;
<a name="l03505"></a>03505                   }
<a name="l03506"></a>03506 
<a name="l03507"></a>03507                   <span class="keywordflow">if</span> ( !fDoFallback )
<a name="l03508"></a>03508                   {
<a name="l03509"></a>03509                         <span class="comment">// 1 ) REC DIRECTION</span>
<a name="l03510"></a>03510                         <span class="comment">// 2 ) SET FLAG FOR STARTING TO FALL</span>
<a name="l03511"></a>03511                         <a class="code" href="Soldier_01Control_8cpp.html#ecd2e45229713b3d8a04eefe3928df56">BeginTyingToFall</a>( pSoldier );
<a name="l03512"></a>03512                         <a class="code" href="Soldier_01Control_8cpp.html#6f191e00fb4f3c5e2cbe762aa402a420">ChangeSoldierState</a>( pSoldier, <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2eb5734c6c3b78cd8b8f5ed5d27b48b44d3">FALLFORWARD_FROMHIT_STAND</a>, 0, FALSE );
<a name="l03513"></a>03513                         <span class="keywordflow">return</span>;
<a name="l03514"></a>03514                   }
<a name="l03515"></a>03515                   <span class="keywordflow">else</span>
<a name="l03516"></a>03516                   {
<a name="l03517"></a>03517                         <span class="comment">// ALL'S OK HERE..... IF WE FORCED DIRECTION, SET!</span>
<a name="l03518"></a>03518                         <span class="keywordflow">if</span> ( fForceDirection )
<a name="l03519"></a>03519                         {
<a name="l03520"></a>03520                               <a class="code" href="Soldier_01Control_8cpp.html#019f893295bb96f48261ded184a17cab">EVENT_SetSoldierDesiredDirection</a>( pSoldier, bTestDirection );
<a name="l03521"></a>03521                               <a class="code" href="Soldier_01Control_8cpp.html#1117087649d17ca4dfc078c0947e7f09">EVENT_SetSoldierDirection</a>( pSoldier, bTestDirection );
<a name="l03522"></a>03522                         }
<a name="l03523"></a>03523                         <a class="code" href="Soldier_01Control_8cpp.html#26f1a6649181800fa7677b390f2f89a2">ChangeToFallbackAnimation</a>( pSoldier, pSoldier-&gt;bDirection );
<a name="l03524"></a>03524                         <span class="keywordflow">return</span>;
<a name="l03525"></a>03525                   }
<a name="l03526"></a>03526             }
<a name="l03527"></a>03527             <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( pSoldier-&gt;usAnimState == <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2eb8a30e1f33cc0d7dae50c4afbd5498fcd">GENERIC_HIT_CROUCH</a> )
<a name="l03528"></a>03528             {
<a name="l03529"></a>03529                   <a class="code" href="Soldier_01Control_8cpp.html#6f191e00fb4f3c5e2cbe762aa402a420">ChangeSoldierState</a>( pSoldier, <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2eb895efb01905b4bfc2f8d0ef505b7e9bd">FALLFORWARD_FROMHIT_CROUCH</a>, 0 , FALSE);
<a name="l03530"></a>03530       <a class="code" href="Soldier_01Control_8cpp.html#ecd2e45229713b3d8a04eefe3928df56">BeginTyingToFall</a>( pSoldier );
<a name="l03531"></a>03531                   <span class="keywordflow">return</span>;                                                                             
<a name="l03532"></a>03532             }
<a name="l03533"></a>03533             <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( pSoldier-&gt;usAnimState == <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2eb1b894c54bc4bb7c80616385a0f604fec">GENERIC_HIT_PRONE</a> )
<a name="l03534"></a>03534             {
<a name="l03535"></a>03535                   <a class="code" href="Soldier_01Control_8cpp.html#6f191e00fb4f3c5e2cbe762aa402a420">ChangeSoldierState</a>( pSoldier, <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2eb87791a2116a48401790a4477c19b1d4a">PRONE_LAY_FROMHIT</a>, 0 , FALSE );
<a name="l03536"></a>03536                   <span class="keywordflow">return</span>;                                                                             
<a name="l03537"></a>03537             }
<a name="l03538"></a>03538             <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( pSoldier-&gt;usAnimState == <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2eb56d2a325cc940cbd3c8ae8eaa23d1c82">ADULTMONSTER_HIT</a> )
<a name="l03539"></a>03539             {
<a name="l03540"></a>03540                   <a class="code" href="Soldier_01Control_8cpp.html#6f191e00fb4f3c5e2cbe762aa402a420">ChangeSoldierState</a>( pSoldier, <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2eb01019d6aa75615bb41df61b7f8286b40">ADULTMONSTER_DYING</a>, 0 , FALSE );
<a name="l03541"></a>03541                   <span class="keywordflow">return</span>;                                                                             
<a name="l03542"></a>03542             }
<a name="l03543"></a>03543             <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( pSoldier-&gt;usAnimState == <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2eb233d39773f18afc92be579b8627f8613">LARVAE_HIT</a> )
<a name="l03544"></a>03544             {
<a name="l03545"></a>03545                   <a class="code" href="Soldier_01Control_8cpp.html#6f191e00fb4f3c5e2cbe762aa402a420">ChangeSoldierState</a>( pSoldier, <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2ebca5a3f460b36b90e592cd7e4510d455d">LARVAE_DIE</a>, 0 , FALSE );
<a name="l03546"></a>03546                   <span class="keywordflow">return</span>;                                                                             
<a name="l03547"></a>03547             }
<a name="l03548"></a>03548             <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( pSoldier-&gt;usAnimState == <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2ebb8181cba1944f88ea7619785bfc6212e">QUEEN_HIT</a> )
<a name="l03549"></a>03549             {
<a name="l03550"></a>03550                   <a class="code" href="Soldier_01Control_8cpp.html#6f191e00fb4f3c5e2cbe762aa402a420">ChangeSoldierState</a>( pSoldier, <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2eb535558f831f451102af07555a0482fb2">QUEEN_DIE</a>, 0 , FALSE );
<a name="l03551"></a>03551                   <span class="keywordflow">return</span>;                                                                             
<a name="l03552"></a>03552             }
<a name="l03553"></a>03553             <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( pSoldier-&gt;usAnimState == <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2eb572c877623f8aba6193598ef5479dd03">CRIPPLE_HIT</a> )
<a name="l03554"></a>03554             {
<a name="l03555"></a>03555                   <a class="code" href="Soldier_01Control_8cpp.html#6f191e00fb4f3c5e2cbe762aa402a420">ChangeSoldierState</a>( pSoldier, <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2ebe90b85b9c611017966e7111e286d3d61">CRIPPLE_DIE</a>, 0 , FALSE );
<a name="l03556"></a>03556                   <span class="keywordflow">return</span>;                                                                             
<a name="l03557"></a>03557             }
<a name="l03558"></a>03558             <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( pSoldier-&gt;usAnimState == <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2ebf3f7a623a533f44139d6560ebb6dac41">ROBOTNW_HIT</a> )
<a name="l03559"></a>03559             {
<a name="l03560"></a>03560                   <a class="code" href="Soldier_01Control_8cpp.html#6f191e00fb4f3c5e2cbe762aa402a420">ChangeSoldierState</a>( pSoldier, <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2eb1b2e84cba4513e808905d9f00248ee80">ROBOTNW_DIE</a>, 0 , FALSE );
<a name="l03561"></a>03561                   <span class="keywordflow">return</span>;                                                                             
<a name="l03562"></a>03562             }
<a name="l03563"></a>03563             <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( pSoldier-&gt;usAnimState == <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2ebbfc329bed8f025621c6defbd3260f20d">INFANT_HIT</a> )
<a name="l03564"></a>03564             {
<a name="l03565"></a>03565                   <a class="code" href="Soldier_01Control_8cpp.html#6f191e00fb4f3c5e2cbe762aa402a420">ChangeSoldierState</a>( pSoldier, <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2ebeb4f625dede301568b1fb4cb9d379b23">INFANT_DIE</a>, 0 , FALSE );
<a name="l03566"></a>03566                   <span class="keywordflow">return</span>;                                                                             
<a name="l03567"></a>03567             }
<a name="l03568"></a>03568             <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( pSoldier-&gt;usAnimState == <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2eb03e1b8036d4d9fd190fbdda52132ad28">COW_HIT</a> )
<a name="l03569"></a>03569             {
<a name="l03570"></a>03570                   <a class="code" href="Soldier_01Control_8cpp.html#6f191e00fb4f3c5e2cbe762aa402a420">ChangeSoldierState</a>( pSoldier, <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2eb5e6625bbcde24192102411607d29c19f">COW_DYING</a>, 0 , FALSE );
<a name="l03571"></a>03571                   <span class="keywordflow">return</span>;                                                                             
<a name="l03572"></a>03572             }
<a name="l03573"></a>03573             <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( pSoldier-&gt;usAnimState == <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2ebfd9f5aaf73bc4821cd971cbea25ab44b">BLOODCAT_HIT</a> )
<a name="l03574"></a>03574             {
<a name="l03575"></a>03575                   <a class="code" href="Soldier_01Control_8cpp.html#6f191e00fb4f3c5e2cbe762aa402a420">ChangeSoldierState</a>( pSoldier, <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2eb9ce43f928ecadcf58f42ae6613318c0c">BLOODCAT_DYING</a>, 0 , FALSE );
<a name="l03576"></a>03576                   <span class="keywordflow">return</span>;                                                                             
<a name="l03577"></a>03577             }
<a name="l03578"></a>03578             <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( pSoldier-&gt;usAnimState == <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2eb85227d44ed8786e3312e991277c008bb">WATER_HIT</a> )
<a name="l03579"></a>03579             {
<a name="l03580"></a>03580                   <a class="code" href="Soldier_01Control_8cpp.html#6f191e00fb4f3c5e2cbe762aa402a420">ChangeSoldierState</a>( pSoldier, <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2eb06ae7564e2a3a102dc4b34a57a212925">WATER_DIE</a>, 0 , FALSE );
<a name="l03581"></a>03581                   <span class="keywordflow">return</span>;                                                                             
<a name="l03582"></a>03582             }
<a name="l03583"></a>03583             <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( pSoldier-&gt;usAnimState == <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2eb236e3b8b39b250c00834d0ed5b479d06">DEEP_WATER_HIT</a> )
<a name="l03584"></a>03584             {
<a name="l03585"></a>03585                   <a class="code" href="Soldier_01Control_8cpp.html#6f191e00fb4f3c5e2cbe762aa402a420">ChangeSoldierState</a>( pSoldier, <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2ebeddf4cc9108ff2aca04f50bf94316091">DEEP_WATER_DIE</a>, 0 , FALSE );
<a name="l03586"></a>03586                   <span class="keywordflow">return</span>;                                                                             
<a name="l03587"></a>03587             }
<a name="l03588"></a>03588             <span class="keywordflow">else</span>
<a name="l03589"></a>03589             {
<a name="l03590"></a>03590                   <span class="comment">// We have missed something here - send debug msg</span>
<a name="l03591"></a>03591                   DebugMsg( TOPIC_JA2, DBG_LEVEL_3, <span class="stringliteral">"Soldier Ani: Genmeric hit not chained"</span> );                                      
<a name="l03592"></a>03592             }
<a name="l03593"></a>03593       }
<a name="l03594"></a>03594 
<a name="l03595"></a>03595 }
<a name="l03596"></a>03596 
<a name="l03597"></a>03597 
<a name="l03598"></a><a class="code" href="Soldier_01Ani_8h.html#9012acc5561cf311371efbfeb7485840">03598</a> <a class="code" href="Types_8h.html#112e3146cb38b6ee95e64d85842e380a">BOOLEAN</a> <a class="code" href="Soldier_01Ani_8cpp.html#9012acc5561cf311371efbfeb7485840">CheckForAndHandleSoldierDyingNotFromHit</a>( <a class="code" href="structSOLDIERTYPE.html">SOLDIERTYPE</a> *<a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a> )
<a name="l03599"></a>03599 {
<a name="l03600"></a>03600       <span class="keywordflow">if</span> ( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#e308dea18533bf5ab2bcee5bbe27391c">bLife</a> == 0 )
<a name="l03601"></a>03601       {
<a name="l03602"></a>03602             <a class="code" href="Soldier_01Control_8cpp.html#62effc98ffa51ddb2fc78301c82acdb8">DoMercBattleSound</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>, <a class="code" href="Soldier_01Control_8h.html#3ab071cf265666f49f6e3f6639d69f0abf28cedf54317c01049c44943809631d">BATTLE_SOUND_DIE1</a> );
<a name="l03603"></a>03603             <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#8776fc5db81036f7b2c071457dd02eb4">fDeadSoundPlayed</a> = TRUE;
<a name="l03604"></a>03604 
<a name="l03605"></a>03605         <span class="comment">// Increment  being attacked count</span>
<a name="l03606"></a>03606         <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#29253c5ae4099335aaf0dd68af0c5c15">bBeingAttackedCount</a>++;
<a name="l03607"></a>03607 
<a name="l03608"></a>03608             <span class="keywordflow">if</span> ( <a class="code" href="GameSettings_8cpp.html#955420499d1cb3101625c85ea703b6bb">gGameSettings</a>.<a class="code" href="structGAME__SETTINGS.html#9d80dbd111727423b8924b5e72e3a0ed">fOptions</a>[ <a class="code" href="GameSettings_8h.html#394b3903fbf00ba2b6243f60689a5a5faee89e33212d20c92a526b40f5845345">TOPTION_BLOOD_N_GORE</a> ] )
<a name="l03609"></a>03609             {
<a name="l03610"></a>03610                   <span class="keywordflow">switch</span>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#1f73b62a5ea0dd26fa1bec1d9f522b41">usAnimState</a> )
<a name="l03611"></a>03611                   {
<a name="l03612"></a>03612                         <span class="keywordflow">case</span> <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2eba3478a6cca1c618d5d972556b16b6622">FLYBACKHIT_STOP</a>:
<a name="l03613"></a>03613                               <a class="code" href="Soldier_01Control_8cpp.html#6f191e00fb4f3c5e2cbe762aa402a420">ChangeSoldierState</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>, <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2eb5bcd7c4372d4c29e14785d64946171a0">FLYBACK_HIT_DEATH</a>, 0, FALSE );
<a name="l03614"></a>03614                               <span class="keywordflow">break</span>;
<a name="l03615"></a>03615 
<a name="l03616"></a>03616                         <span class="keywordflow">case</span> <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2eb5734c6c3b78cd8b8f5ed5d27b48b44d3">FALLFORWARD_FROMHIT_STAND</a>:
<a name="l03617"></a>03617                         <span class="keywordflow">case</span> <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2eb895efb01905b4bfc2f8d0ef505b7e9bd">FALLFORWARD_FROMHIT_CROUCH</a>:
<a name="l03618"></a>03618                         <span class="keywordflow">case</span> <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2eb50c9d7dac67ef2c9405a84fcd76e4833">STAND_FALLFORWARD_STOP</a>:
<a name="l03619"></a>03619                               <a class="code" href="Soldier_01Control_8cpp.html#6f191e00fb4f3c5e2cbe762aa402a420">ChangeSoldierState</a>( pSoldier, <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2eb2e67b5b42c024d627d8887316ae3b01e">GENERIC_HIT_DEATH</a>, 0, FALSE );
<a name="l03620"></a>03620                               <span class="keywordflow">break</span>;
<a name="l03621"></a>03621 
<a name="l03622"></a>03622                         <span class="keywordflow">case</span> <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2eb22609cecfc06000291ea1dcea22835b3">FALLBACKHIT_STOP</a>:
<a name="l03623"></a>03623                               <a class="code" href="Soldier_01Control_8cpp.html#6f191e00fb4f3c5e2cbe762aa402a420">ChangeSoldierState</a>( pSoldier, <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2ebd7cc0407572496e696f7ef6b1e2c97ca">FALLBACK_HIT_DEATH</a>, 0, FALSE );
<a name="l03624"></a>03624                               <span class="keywordflow">break</span>;
<a name="l03625"></a>03625 
<a name="l03626"></a>03626                         <span class="keywordflow">case</span> <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2eb1a03feeb407e3b1fd0d9fc6378b69d6b">PRONE_LAYFROMHIT_STOP</a>:
<a name="l03627"></a>03627         <span class="keywordflow">case</span> <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2eb87791a2116a48401790a4477c19b1d4a">PRONE_LAY_FROMHIT</a>:
<a name="l03628"></a>03628 
<a name="l03629"></a>03629                               <a class="code" href="Soldier_01Control_8cpp.html#6f191e00fb4f3c5e2cbe762aa402a420">ChangeSoldierState</a>( pSoldier, <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2eb635e5ea103631d96fda3a4042a659afc">PRONE_HIT_DEATH</a>, 0, FALSE );
<a name="l03630"></a>03630                               <span class="keywordflow">break</span>;
<a name="l03631"></a>03631 
<a name="l03632"></a>03632                         <span class="keywordflow">case</span> <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2ebffd54d5f50a94f74aba432de6f84a2e9">FALLOFF_STOP</a>:
<a name="l03633"></a>03633                               <a class="code" href="Soldier_01Control_8cpp.html#6f191e00fb4f3c5e2cbe762aa402a420">ChangeSoldierState</a>( pSoldier, <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2eb7490325e516e0cf31a0b03ec84df068f">FALLOFF_DEATH</a>, 0, FALSE );
<a name="l03634"></a>03634                               <span class="keywordflow">break</span>;
<a name="l03635"></a>03635 
<a name="l03636"></a>03636                         <span class="keywordflow">case</span> <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2eb2b379105dc05c51bde7ca16841b5c37c">FALLOFF_FORWARD_STOP</a>:
<a name="l03637"></a>03637                               <a class="code" href="Soldier_01Control_8cpp.html#6f191e00fb4f3c5e2cbe762aa402a420">ChangeSoldierState</a>( pSoldier, <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2eb1388740da829de4a2f7d782d24666b8f">FALLOFF_FORWARD_DEATH</a>, 0, FALSE);
<a name="l03638"></a>03638                               <span class="keywordflow">break</span>;
<a name="l03639"></a>03639 
<a name="l03640"></a>03640         <span class="keywordflow">case</span> <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2eb56d2a325cc940cbd3c8ae8eaa23d1c82">ADULTMONSTER_HIT</a>:
<a name="l03641"></a>03641                   <a class="code" href="Soldier_01Control_8cpp.html#6f191e00fb4f3c5e2cbe762aa402a420">ChangeSoldierState</a>( pSoldier, <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2eb01019d6aa75615bb41df61b7f8286b40">ADULTMONSTER_DYING</a>, 0 , FALSE );
<a name="l03642"></a>03642                   <span class="keywordflow">break</span>;                                                                              
<a name="l03643"></a>03643 
<a name="l03644"></a>03644         <span class="keywordflow">case</span> <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2eb233d39773f18afc92be579b8627f8613">LARVAE_HIT</a>:
<a name="l03645"></a>03645                   <a class="code" href="Soldier_01Control_8cpp.html#6f191e00fb4f3c5e2cbe762aa402a420">ChangeSoldierState</a>( pSoldier, <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2ebca5a3f460b36b90e592cd7e4510d455d">LARVAE_DIE</a>, 0 , FALSE );
<a name="l03646"></a>03646                       <span class="keywordflow">break</span>;                                                                          
<a name="l03647"></a>03647       
<a name="l03648"></a>03648         <span class="keywordflow">case</span> <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2ebb8181cba1944f88ea7619785bfc6212e">QUEEN_HIT</a>:
<a name="l03649"></a>03649                   <a class="code" href="Soldier_01Control_8cpp.html#6f191e00fb4f3c5e2cbe762aa402a420">ChangeSoldierState</a>( pSoldier, <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2eb535558f831f451102af07555a0482fb2">QUEEN_DIE</a>, 0 , FALSE );
<a name="l03650"></a>03650                   <span class="keywordflow">break</span>;                                                                              
<a name="l03651"></a>03651 
<a name="l03652"></a>03652         <span class="keywordflow">case</span> <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2eb572c877623f8aba6193598ef5479dd03">CRIPPLE_HIT</a>:
<a name="l03653"></a>03653                   <a class="code" href="Soldier_01Control_8cpp.html#6f191e00fb4f3c5e2cbe762aa402a420">ChangeSoldierState</a>( pSoldier, <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2ebe90b85b9c611017966e7111e286d3d61">CRIPPLE_DIE</a>, 0 , FALSE );
<a name="l03654"></a>03654                   <span class="keywordflow">break</span>;
<a name="l03655"></a>03655 
<a name="l03656"></a>03656         <span class="keywordflow">case</span> <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2ebf3f7a623a533f44139d6560ebb6dac41">ROBOTNW_HIT</a>:
<a name="l03657"></a>03657                   <a class="code" href="Soldier_01Control_8cpp.html#6f191e00fb4f3c5e2cbe762aa402a420">ChangeSoldierState</a>( pSoldier, <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2eb1b2e84cba4513e808905d9f00248ee80">ROBOTNW_DIE</a>, 0 , FALSE );
<a name="l03658"></a>03658                       <span class="keywordflow">break</span>;                                                              
<a name="l03659"></a>03659 
<a name="l03660"></a>03660         <span class="keywordflow">case</span> <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2ebbfc329bed8f025621c6defbd3260f20d">INFANT_HIT</a>:
<a name="l03661"></a>03661                   <a class="code" href="Soldier_01Control_8cpp.html#6f191e00fb4f3c5e2cbe762aa402a420">ChangeSoldierState</a>( pSoldier, <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2ebeb4f625dede301568b1fb4cb9d379b23">INFANT_DIE</a>, 0 , FALSE );
<a name="l03662"></a>03662                   <span class="keywordflow">break</span>;                  
<a name="l03663"></a>03663 
<a name="l03664"></a>03664         <span class="keywordflow">case</span> <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2eb03e1b8036d4d9fd190fbdda52132ad28">COW_HIT</a>:
<a name="l03665"></a>03665                   <a class="code" href="Soldier_01Control_8cpp.html#6f191e00fb4f3c5e2cbe762aa402a420">ChangeSoldierState</a>( pSoldier, <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2eb5e6625bbcde24192102411607d29c19f">COW_DYING</a>, 0 , FALSE );
<a name="l03666"></a>03666                   <span class="keywordflow">break</span>;                                                                              
<a name="l03667"></a>03667 
<a name="l03668"></a>03668         <span class="keywordflow">case</span> <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2ebfd9f5aaf73bc4821cd971cbea25ab44b">BLOODCAT_HIT</a>:
<a name="l03669"></a>03669                   <a class="code" href="Soldier_01Control_8cpp.html#6f191e00fb4f3c5e2cbe762aa402a420">ChangeSoldierState</a>( pSoldier, <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2eb9ce43f928ecadcf58f42ae6613318c0c">BLOODCAT_DYING</a>, 0 , FALSE );
<a name="l03670"></a>03670                   <span class="keywordflow">break</span>;            
<a name="l03671"></a>03671             
<a name="l03672"></a>03672                         <span class="keywordflow">default</span>:
<a name="l03673"></a>03673                               DebugMsg( TOPIC_JA2, DBG_LEVEL_3, <a class="code" href="DEBUG_8cpp.html#88565bf27eec0b2003eb5bc9426b8e4b">String</a>( <span class="stringliteral">"Soldier Control: Death state %d has no death hit"</span>, pSoldier-&gt;usAnimState ) );
<a name="l03674"></a>03674                               {
<a name="l03675"></a>03675                                     <a class="code" href="Types_8h.html#112e3146cb38b6ee95e64d85842e380a">BOOLEAN</a> fMadeCorpse;
<a name="l03676"></a>03676                                     <a class="code" href="Soldier_01Ani_8cpp.html#c8dc487d70dc5109dd507c1dcf8efb45">CheckForAndHandleSoldierDeath</a>( pSoldier, &amp;fMadeCorpse );
<a name="l03677"></a>03677                               }
<a name="l03678"></a>03678                               <span class="keywordflow">break</span>;
<a name="l03679"></a>03679 
<a name="l03680"></a>03680                   }
<a name="l03681"></a>03681             }
<a name="l03682"></a>03682             <span class="keywordflow">else</span>
<a name="l03683"></a>03683             {
<a name="l03684"></a>03684                   <a class="code" href="Types_8h.html#112e3146cb38b6ee95e64d85842e380a">BOOLEAN</a> fMadeCorpse;
<a name="l03685"></a>03685 
<a name="l03686"></a>03686                   <a class="code" href="Soldier_01Ani_8cpp.html#c8dc487d70dc5109dd507c1dcf8efb45">CheckForAndHandleSoldierDeath</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>, &amp;fMadeCorpse );
<a name="l03687"></a>03687             }
<a name="l03688"></a>03688             <span class="keywordflow">return</span>( TRUE );
<a name="l03689"></a>03689       }
<a name="l03690"></a>03690 
<a name="l03691"></a>03691       <span class="keywordflow">return</span>( FALSE );
<a name="l03692"></a>03692 }
<a name="l03693"></a>03693 
<a name="l03694"></a>03694 
<a name="l03695"></a><a class="code" href="Soldier_01Ani_8cpp.html#4a1f4a44abd2dd1e17348edff0830048">03695</a> <a class="code" href="Types_8h.html#112e3146cb38b6ee95e64d85842e380a">BOOLEAN</a> <a class="code" href="Soldier_01Ani_8cpp.html#4a1f4a44abd2dd1e17348edff0830048">CheckForImproperFireGunEnd</a>( <a class="code" href="structSOLDIERTYPE.html">SOLDIERTYPE</a> *<a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a> )
<a name="l03696"></a>03696 {
<a name="l03697"></a>03697 
<a name="l03698"></a>03698       <span class="keywordflow">if</span> ( AM_A_ROBOT( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a> ) )
<a name="l03699"></a>03699       {
<a name="l03700"></a>03700             <span class="keywordflow">return</span>( FALSE );
<a name="l03701"></a>03701       }
<a name="l03702"></a>03702 
<a name="l03703"></a>03703       <span class="comment">// Check single hand for jammed status, ( or ammo is out.. )</span>
<a name="l03704"></a>03704       <span class="keywordflow">if</span> ( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#13c875b952b6d634680165d127a9870b">inv</a>[ <a class="code" href="Soldier_01Control_8h.html#2a5937706f1724c8f06a0396bdc87855408e678e638d95e18d5e9a2a64a96e2e">HANDPOS</a> ].bGunAmmoStatus &lt; 0 || <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#13c875b952b6d634680165d127a9870b">inv</a>[ <a class="code" href="Soldier_01Control_8h.html#2a5937706f1724c8f06a0396bdc87855408e678e638d95e18d5e9a2a64a96e2e">HANDPOS</a> ].ubGunShotsLeft == 0 )
<a name="l03705"></a>03705       {
<a name="l03706"></a>03706             <span class="comment">// If we have 2 pistols, donot go back!</span>
<a name="l03707"></a>03707             <span class="keywordflow">if</span> ( <a class="code" href="Item_01Types_8h.html#f9dc4cc7a3a99ad5944940cfb7c82237">Item</a>[ <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#13c875b952b6d634680165d127a9870b">inv</a>[ <a class="code" href="Soldier_01Control_8h.html#2a5937706f1724c8f06a0396bdc87855009684dc553cebead620fa082b29cb86">SECONDHANDPOS</a> ].usItem ].usItemClass != IC_GUN )
<a name="l03708"></a>03708             {
<a name="l03709"></a>03709                   <span class="comment">// OK, put gun down....</span>
<a name="l03710"></a>03710                   <a class="code" href="Soldier_01Control_8cpp.html#a0bf5d6769a62a4eef60702c78d13915">InternalSoldierReadyWeapon</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>, pSoldier-&gt;<a class="code" href="structSOLDIERTYPE.html#8aa6174a253c3fa21a3ec41ce0174340">bDirection</a>, TRUE );
<a name="l03711"></a>03711                   <span class="keywordflow">return</span>( TRUE );
<a name="l03712"></a>03712             }
<a name="l03713"></a>03713       }
<a name="l03714"></a>03714 
<a name="l03715"></a>03715       <span class="keywordflow">return</span>( FALSE );
<a name="l03716"></a>03716 
<a name="l03717"></a>03717 }
<a name="l03718"></a>03718 
<a name="l03719"></a>03719 
<a name="l03720"></a><a class="code" href="Soldier_01Ani_8cpp.html#5cc4c38d561234656735136f4d3c28a4">03720</a> <a class="code" href="Types_8h.html#112e3146cb38b6ee95e64d85842e380a">BOOLEAN</a> <a class="code" href="Soldier_01Ani_8cpp.html#5cc4c38d561234656735136f4d3c28a4">OKHeightDest</a>( <a class="code" href="structSOLDIERTYPE.html">SOLDIERTYPE</a> *<a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>, <a class="code" href="Types_8h.html#30f500129d8c688af07726d5d34ce52d">INT16</a> sNewGridNo )
<a name="l03721"></a>03721 {
<a name="l03722"></a>03722       <span class="keywordflow">if</span> ( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#0d1f73c5d0ac839ec84a4792505949cb">bLevel</a> == 0 )
<a name="l03723"></a>03723       {
<a name="l03724"></a>03724             <span class="keywordflow">return</span>( TRUE );
<a name="l03725"></a>03725       }
<a name="l03726"></a>03726 
<a name="l03727"></a>03727       <span class="comment">// Check if there is a lower place here....</span>
<a name="l03728"></a>03728       <span class="keywordflow">if</span> ( <a class="code" href="worldman_8cpp.html#f18b71f6351a81f484bd09c35e7c928f">IsLowerLevel</a>( sNewGridNo ) )
<a name="l03729"></a>03729       {
<a name="l03730"></a>03730             <span class="keywordflow">return</span>( FALSE );
<a name="l03731"></a>03731       }
<a name="l03732"></a>03732 
<a name="l03733"></a>03733       <span class="keywordflow">return</span>( TRUE );
<a name="l03734"></a>03734 }
<a name="l03735"></a>03735 
<a name="l03736"></a>03736 
<a name="l03737"></a><a class="code" href="Soldier_01Ani_8cpp.html#b347fd92f91cd16381f0163a2da1e293">03737</a> <a class="code" href="Types_8h.html#112e3146cb38b6ee95e64d85842e380a">BOOLEAN</a> <a class="code" href="Soldier_01Ani_8cpp.html#b347fd92f91cd16381f0163a2da1e293">HandleUnjamAnimation</a>( <a class="code" href="structSOLDIERTYPE.html">SOLDIERTYPE</a> *<a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a> )
<a name="l03738"></a>03738 {
<a name="l03739"></a>03739       <span class="comment">// OK, play intermediate animation here..... save in pending animation data, the current</span>
<a name="l03740"></a>03740       <span class="comment">// code we are at!</span>
<a name="l03741"></a>03741       <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#a69215f405f59c8085b3bb27f76893c3">uiPendingActionData1</a> = <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#d1221226402ff4b54671e0142ec90cd6">usAniCode</a>;
<a name="l03742"></a>03742       <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#7bf70f6f1b637647860538cd60b5399c">sPendingActionData2</a>  = <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#1f73b62a5ea0dd26fa1bec1d9f522b41">usAnimState</a>;
<a name="l03743"></a>03743       <span class="comment">// Check what animatnion we should do..... </span>
<a name="l03744"></a>03744       <span class="keywordflow">switch</span>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#1f73b62a5ea0dd26fa1bec1d9f522b41">usAnimState</a> )
<a name="l03745"></a>03745       {
<a name="l03746"></a>03746             <span class="keywordflow">case</span> <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2eb4037501208ea9a46f8efa65d143ec623">SHOOT_RIFLE_STAND</a>:
<a name="l03747"></a>03747             <span class="keywordflow">case</span> <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2eb3b25b3d79279e78eeff9d51e23dc0201">STANDING_BURST</a>:
<a name="l03748"></a>03748             <span class="keywordflow">case</span> <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2eb2d5286901c72494b8fc589a7cabe4289">FIRE_STAND_BURST_SPREAD</a>:
<a name="l03749"></a>03749                   <span class="comment">// Normal shoot rifle.... play</span>
<a name="l03750"></a>03750                   <a class="code" href="Soldier_01Control_8cpp.html#6f191e00fb4f3c5e2cbe762aa402a420">ChangeSoldierState</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>, <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2ebcd820ddafc0be9b1d7c45887d963dad8">STANDING_SHOOT_UNJAM</a>, 0 , FALSE );
<a name="l03751"></a>03751                   <span class="keywordflow">return</span>( TRUE );
<a name="l03752"></a>03752 
<a name="l03753"></a>03753             <span class="keywordflow">case</span> <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2ebc87888224b87169c7429c4f496e5f2c7">PRONE_BURST</a>:
<a name="l03754"></a>03754             <span class="keywordflow">case</span> <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2ebe559c1a00fcd2419cb5e133135eb61f4">SHOOT_RIFLE_PRONE</a>:
<a name="l03755"></a>03755 
<a name="l03756"></a>03756                   <span class="comment">// Normal shoot rifle.... play</span>
<a name="l03757"></a>03757                   <a class="code" href="Soldier_01Control_8cpp.html#6f191e00fb4f3c5e2cbe762aa402a420">ChangeSoldierState</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>, <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2ebb060e97d08302ff90dc58172adac0bb6">PRONE_SHOOT_UNJAM</a>, 0 , FALSE );
<a name="l03758"></a>03758                   <span class="keywordflow">return</span>( TRUE );
<a name="l03759"></a>03759 
<a name="l03760"></a>03760             <span class="keywordflow">case</span> <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2eb8409923a9693bf9755c8edfe3ba5f78c">CROUCHED_BURST</a>:
<a name="l03761"></a>03761             <span class="keywordflow">case</span> <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2ebe8a00a8d770e814c8fe4714d959523ad">SHOOT_RIFLE_CROUCH</a>:
<a name="l03762"></a>03762 
<a name="l03763"></a>03763                   <span class="comment">// Normal shoot rifle.... play</span>
<a name="l03764"></a>03764                   <a class="code" href="Soldier_01Control_8cpp.html#6f191e00fb4f3c5e2cbe762aa402a420">ChangeSoldierState</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>, <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2eb02028d6043858d77506ad81374e9ea3a">CROUCH_SHOOT_UNJAM</a>, 0 , FALSE );
<a name="l03765"></a>03765                   <span class="keywordflow">return</span>( TRUE );
<a name="l03766"></a>03766 
<a name="l03767"></a>03767             <span class="keywordflow">case</span> <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2eb1ed717e73637ae5a37b479cd97f2db20">SHOOT_DUAL_STAND</a>:
<a name="l03768"></a>03768 
<a name="l03769"></a>03769                   <span class="comment">// Normal shoot rifle.... play</span>
<a name="l03770"></a>03770                   <a class="code" href="Soldier_01Control_8cpp.html#6f191e00fb4f3c5e2cbe762aa402a420">ChangeSoldierState</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>, <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2ebc53b41e76fa112bef8249692a18f91e3">STANDING_SHOOT_DWEL_UNJAM</a>, 0 , FALSE );
<a name="l03771"></a>03771                   <span class="keywordflow">return</span>( TRUE );
<a name="l03772"></a>03772 
<a name="l03773"></a>03773             <span class="keywordflow">case</span> <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2eba572f2f71aeda9df6445ea9ba00234f6">SHOOT_DUAL_PRONE</a>:
<a name="l03774"></a>03774 
<a name="l03775"></a>03775                   <span class="comment">// Normal shoot rifle.... play</span>
<a name="l03776"></a>03776                   <a class="code" href="Soldier_01Control_8cpp.html#6f191e00fb4f3c5e2cbe762aa402a420">ChangeSoldierState</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>, <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2eb480089ad5d0f8ba4c6df5b506dc87be3">PRONE_SHOOT_DWEL_UNJAM</a>, 0 , FALSE );
<a name="l03777"></a>03777                   <span class="keywordflow">return</span>( TRUE );
<a name="l03778"></a>03778 
<a name="l03779"></a>03779             <span class="keywordflow">case</span> <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2eb660c23fd9ad78148e5dfe92eeaa9fa0b">SHOOT_DUAL_CROUCH</a>:
<a name="l03780"></a>03780 
<a name="l03781"></a>03781                   <span class="comment">// Normal shoot rifle.... play</span>
<a name="l03782"></a>03782                   <a class="code" href="Soldier_01Control_8cpp.html#6f191e00fb4f3c5e2cbe762aa402a420">ChangeSoldierState</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>, <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2eb3cbe7dde1976422c90ff309821861c81">CROUCH_SHOOT_DWEL_UNJAM</a>, 0 , FALSE );
<a name="l03783"></a>03783                   <span class="keywordflow">return</span>( TRUE );
<a name="l03784"></a>03784 
<a name="l03785"></a>03785             <span class="keywordflow">case</span> <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2eb08881e0424f26c66c1bb2682385fa42e">FIRE_LOW_STAND</a>:
<a name="l03786"></a>03786             <span class="keywordflow">case</span> <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2eba4df071845efb0e5f6aac9585a2580fc">FIRE_BURST_LOW_STAND</a>:
<a name="l03787"></a>03787 
<a name="l03788"></a>03788                   <span class="comment">// Normal shoot rifle.... play</span>
<a name="l03789"></a>03789                   <a class="code" href="Soldier_01Control_8cpp.html#6f191e00fb4f3c5e2cbe762aa402a420">ChangeSoldierState</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>, <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2eb2a6b49b9767e5b62aa6acbe74b4f9b04">STANDING_SHOOT_LOW_UNJAM</a>, 0 , FALSE );
<a name="l03790"></a>03790                   <span class="keywordflow">return</span>( TRUE );
<a name="l03791"></a>03791 
<a name="l03792"></a>03792       }
<a name="l03793"></a>03793 
<a name="l03794"></a>03794       <span class="keywordflow">return</span>( FALSE );
<a name="l03795"></a>03795 }
<a name="l03796"></a>03796 
<a name="l03797"></a>03797 
<a name="l03798"></a>03798 
<a name="l03799"></a>03799 
<a name="l03800"></a>03800 <span class="preprocessor">#if 0</span>
<a name="l03801"></a>03801 <span class="preprocessor"></span>                        <span class="comment">//OK, if here, if our health is still good, but we took a lot of damage, try to fall down!</span>
<a name="l03802"></a><a class="code" href="Soldier_01Ani_8cpp.html#c294aa65f0375eb6343a2de2a25dafcc">03802</a>                               <span class="keywordflow">if</span> ( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#e308dea18533bf5ab2bcee5bbe27391c">bLife</a> &gt;= OKLIFE )
<a name="l03803"></a>03803                               {
<a name="l03804"></a>03804                                     <span class="comment">// Randomly fall back or forward, if we are in the standing hit animation</span>
<a name="l03805"></a>03805                                     <span class="keywordflow">if</span> ( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#1f73b62a5ea0dd26fa1bec1d9f522b41">usAnimState</a> == <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2eb1f83464b1bfc5eba459fbc0a35025ccb">GENERIC_HIT_STAND</a> || <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#1f73b62a5ea0dd26fa1bec1d9f522b41">usAnimState</a> == <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2eb0e5a6f1a34ca54a677f4bff1c72fdcad">RIFLE_STAND_HIT</a> )
<a name="l03806"></a>03806                                     {
<a name="l03807"></a>03807                                           <a class="code" href="Types_8h.html#7ebe70ceca856797319175e30bcf003d">INT8</a>              bTestDirection = <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#8aa6174a253c3fa21a3ec41ce0174340">bDirection</a>;
<a name="l03808"></a>03808                                           <a class="code" href="Types_8h.html#112e3146cb38b6ee95e64d85842e380a">BOOLEAN</a>           fForceDirection = FALSE;
<a name="l03809"></a>03809                                           <a class="code" href="Types_8h.html#112e3146cb38b6ee95e64d85842e380a">BOOLEAN</a>           fDoFallback             = FALSE;
<a name="l03810"></a>03810 
<a name="l03811"></a>03811                                           <span class="comment">// As the damage pretty brutal?</span>
<a name="l03812"></a>03812 
<a name="l03813"></a>03813                                           <span class="comment">// TRY FALLING BACKWARDS, ( ONLY IF WE ARE A MERC! )</span>
<a name="l03814"></a>03814                                           <span class="keywordflow">if</span> ( <a class="code" href="Random_8cpp.html#49f938d1313ab6ef09ac6223a16ac334">Random</a>( 1000 ) &gt; 40 &amp;&amp; IS_MERC_BODY_TYPE( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a> ) )
<a name="l03815"></a>03815                                           {
<a name="l03816"></a>03816                                                 <span class="comment">// CHECK IF WE HAVE AN ATTACKER, TAKE OPPOSITE DIRECTION!</span>
<a name="l03817"></a>03817                                                 <span class="keywordflow">if</span> ( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#d9c0383469bf58f73ba6bea3e8ebf22b">ubAttackerID</a> != NOBODY )
<a name="l03818"></a>03818                                                 { 
<a name="l03819"></a>03819                                                       <span class="comment">// Find direction!</span>
<a name="l03820"></a>03820                                                       bTestDirection = (<a class="code" href="Types_8h.html#7ebe70ceca856797319175e30bcf003d">INT8</a>)<a class="code" href="Soldier_01Control_8cpp.html#1d7b6c103ede7e551e76eef2ef173f9b">GetDirectionFromGridNo</a>( <a class="code" href="Overhead_8cpp.html#2b9a828d7d92ec404b2f9a39fc001177">MercPtrs</a>[ <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#d9c0383469bf58f73ba6bea3e8ebf22b">ubAttackerID</a> ]-&gt;sGridNo, <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a> );
<a name="l03821"></a>03821                                                       fForceDirection = TRUE;
<a name="l03822"></a>03822                                                 }
<a name="l03823"></a>03823 
<a name="l03824"></a>03824                                                 sNewGridNo = <a class="code" href="Isometric_01Utils_8cpp.html#318d8410127e29bb232ab70363bc316e">NewGridNo</a>( (<a class="code" href="Types_8h.html#09f1a1fb2293e33483cc8d44aefb1eb1">UINT16</a>)<a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#2ab66ee0f37902cd448f4a738df4f2bf">sGridNo</a>, (<a class="code" href="Types_8h.html#09f1a1fb2293e33483cc8d44aefb1eb1">UINT16</a>)(-1 * <a class="code" href="Isometric_01Utils_8cpp.html#a4a3adf599f99864b1de33673888fd5e">DirectionInc</a>( bTestDirection ) ) );
<a name="l03825"></a>03825 
<a name="l03826"></a>03826                                                 <span class="keywordflow">if</span> ( <a class="code" href="Overhead_8cpp.html#1b42cba58f5984a3d0b0d0ec0d3def8c">NewOKDestination</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>, sNewGridNo, TRUE, <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#0d1f73c5d0ac839ec84a4792505949cb">bLevel</a> ) &amp;&amp; <a class="code" href="Soldier_01Ani_8cpp.html#5cc4c38d561234656735136f4d3c28a4">OKHeightDest</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>, sNewGridNo ) )
<a name="l03827"></a>03827                                                 {
<a name="l03828"></a>03828                                                       <span class="comment">// ALL'S OK HERE..... IF WE FORCED DIRECTION, SET!</span>
<a name="l03829"></a>03829                                                       <span class="keywordflow">if</span> ( fForceDirection )
<a name="l03830"></a>03830                                                       {
<a name="l03831"></a>03831                                                             <a class="code" href="Soldier_01Control_8cpp.html#1117087649d17ca4dfc078c0947e7f09">EVENT_SetSoldierDirection</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>, bTestDirection );
<a name="l03832"></a>03832                                                             <a class="code" href="Soldier_01Control_8cpp.html#019f893295bb96f48261ded184a17cab">EVENT_SetSoldierDesiredDirection</a>( pSoldier, bTestDirection );
<a name="l03833"></a>03833                                                       }
<a name="l03834"></a>03834                                                       <a class="code" href="Soldier_01Control_8cpp.html#6f191e00fb4f3c5e2cbe762aa402a420">ChangeSoldierState</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>, <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2eb8b6ec73ff14590fbd84485acdb213d6b">FALLBACK_HIT_STAND</a>, 0, FALSE );
<a name="l03835"></a>03835                                                       <span class="keywordflow">return</span>;
<a name="l03836"></a>03836                                                 }
<a name="l03837"></a>03837                                           }
<a name="l03838"></a>03838                                     }
<a name="l03839"></a>03839                               }
<a name="l03840"></a>03840 
<a name="l03841"></a>03841 <span class="preprocessor">#endif</span>
<a name="l03842"></a>03842 <span class="preprocessor"></span>
<a name="l03843"></a><a class="code" href="Soldier_01Ani_8h.html#52dee080c40e99d978e145a7fd2f3a67">03843</a> <a class="code" href="Types_8h.html#112e3146cb38b6ee95e64d85842e380a">BOOLEAN</a> <a class="code" href="Soldier_01Ani_8cpp.html#52dee080c40e99d978e145a7fd2f3a67">OKFallDirection</a>( <a class="code" href="structSOLDIERTYPE.html">SOLDIERTYPE</a> *<a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>, <a class="code" href="Types_8h.html#30f500129d8c688af07726d5d34ce52d">INT16</a> sGridNo, <a class="code" href="Types_8h.html#7ebe70ceca856797319175e30bcf003d">INT8</a> bLevel, <a class="code" href="Types_8h.html#7ebe70ceca856797319175e30bcf003d">INT8</a> bTestDirection, <a class="code" href="Types_8h.html#09f1a1fb2293e33483cc8d44aefb1eb1">UINT16</a> usAnimState )
<a name="l03844"></a>03844 {
<a name="l03845"></a>03845       DebugMsg (TOPIC_JA2,DBG_LEVEL_3,<span class="stringliteral">"OKFallDirection"</span>);
<a name="l03846"></a>03846       <a class="code" href="structTAG__STRUCTURE__FILE__REF.html">STRUCTURE_FILE_REF</a> *    pStructureFileRef;
<a name="l03847"></a>03847       <a class="code" href="Types_8h.html#09f1a1fb2293e33483cc8d44aefb1eb1">UINT16</a>                                                usAnimSurface;
<a name="l03848"></a>03848 
<a name="l03849"></a>03849       <span class="comment">// How are the movement costs?</span>
<a name="l03850"></a>03850       <span class="keywordflow">if</span> ( <a class="code" href="worlddef_8cpp.html#4dc0cb4bdda24d948e2aa986389414aa">gubWorldMovementCosts</a>[ sGridNo ][ bTestDirection ][ bLevel ] &gt; TRAVELCOST_SHORE )
<a name="l03851"></a>03851       {
<a name="l03852"></a>03852             <span class="keywordflow">return</span>( FALSE );
<a name="l03853"></a>03853       }
<a name="l03854"></a>03854 
<a name="l03855"></a>03855   <span class="comment">//NOT ok if in water....</span>
<a name="l03856"></a>03856       <span class="keywordflow">if</span> ( <a class="code" href="worldman_8cpp.html#ff4861660a5bfb5f9810adfa9c547d04">GetTerrainType</a>( sGridNo ) == <a class="code" href="tiledef_8h.html#c670bc5d76bf3f6a2bdda553ba73177c8c5eadde6447854c388b3ed3bb03b05f">MED_WATER</a> || <a class="code" href="worldman_8cpp.html#ff4861660a5bfb5f9810adfa9c547d04">GetTerrainType</a>( sGridNo ) == <a class="code" href="tiledef_8h.html#c670bc5d76bf3f6a2bdda553ba73177c6d5b5dcfd05a52b309607f0047f1b5fd">DEEP_WATER</a> || <a class="code" href="worldman_8cpp.html#ff4861660a5bfb5f9810adfa9c547d04">GetTerrainType</a>( sGridNo ) == <a class="code" href="tiledef_8h.html#c670bc5d76bf3f6a2bdda553ba73177c991564694eec10f14cfdab99c29b5718">LOW_WATER</a> )
<a name="l03857"></a>03857   {
<a name="l03858"></a>03858     <span class="keywordflow">return</span>( FALSE );
<a name="l03859"></a>03859   }
<a name="l03860"></a>03860 
<a name="l03861"></a>03861       <span class="comment">// How are we for OK dest?</span>
<a name="l03862"></a>03862       <span class="keywordflow">if</span> (!<a class="code" href="Overhead_8cpp.html#1b42cba58f5984a3d0b0d0ec0d3def8c">NewOKDestination</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>, sGridNo, TRUE, bLevel ) )
<a name="l03863"></a>03863       {
<a name="l03864"></a>03864             <span class="keywordflow">return</span>( FALSE );
<a name="l03865"></a>03865       }
<a name="l03866"></a>03866 
<a name="l03867"></a>03867       usAnimSurface = <a class="code" href="Animation_01Control_8cpp.html#bff82d576655ab06ca2111a17a183971">DetermineSoldierAnimationSurface</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>, usAnimState );
<a name="l03868"></a>03868       pStructureFileRef = <a class="code" href="Animation_01Data_8cpp.html#fc458d3df95cc2ce9957ba2475bdcc09">GetAnimationStructureRef</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#18aef170576da81b10d00e7b6cd3627b">ubID</a>, usAnimSurface, usAnimState );
<a name="l03869"></a>03869 
<a name="l03870"></a>03870       <span class="keywordflow">if</span> ( pStructureFileRef )
<a name="l03871"></a>03871       {
<a name="l03872"></a>03872             <a class="code" href="Types_8h.html#09f1a1fb2293e33483cc8d44aefb1eb1">UINT16</a>            usStructureID;
<a name="l03873"></a>03873             <a class="code" href="Types_8h.html#30f500129d8c688af07726d5d34ce52d">INT16</a>             sTestGridNo;
<a name="l03874"></a>03874 
<a name="l03875"></a>03875             <span class="comment">// must make sure that structure data can be added in the direction of the target</span>
<a name="l03876"></a>03876 
<a name="l03877"></a>03877             usStructureID = <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#18aef170576da81b10d00e7b6cd3627b">ubID</a>;
<a name="l03878"></a>03878 
<a name="l03879"></a>03879             <span class="comment">// Okay this is really SCREWY but it's due to the way this function worked before and must</span>
<a name="l03880"></a>03880             <span class="comment">// work now.  The function is passing in an adjacent gridno but we need to place the structure</span>
<a name="l03881"></a>03881             <span class="comment">// data in the tile BEFORE.  So we take one step back in the direction opposite to bTestDirection</span>
<a name="l03882"></a>03882             <span class="comment">// and use that gridno</span>
<a name="l03883"></a>03883             sTestGridNo = <a class="code" href="Isometric_01Utils_8cpp.html#318d8410127e29bb232ab70363bc316e">NewGridNo</a>( sGridNo, (<a class="code" href="Types_8h.html#09f1a1fb2293e33483cc8d44aefb1eb1">UINT16</a>)( <a class="code" href="Isometric_01Utils_8cpp.html#a4a3adf599f99864b1de33673888fd5e">DirectionInc</a>( <a class="code" href="Isometric_01Utils_8cpp.html#9591ab6c902758a420fd3d9f4e49ba2e">gOppositeDirection</a>[ bTestDirection ] ) ) );
<a name="l03884"></a>03884 
<a name="l03885"></a>03885             <span class="keywordflow">if</span> ( ! <a class="code" href="structure_8cpp.html#6dbccc07aa13299894a0ab2aefe36282">OkayToAddStructureToWorld</a>( sTestGridNo, bLevel, &amp;(pStructureFileRef-&gt;<a class="code" href="structTAG__STRUCTURE__FILE__REF.html#fff59391102b0c44d6c95f7c89243e05">pDBStructureRef</a>[ <a class="code" href="Isometric_01Utils_8cpp.html#9eb8f6ae368802136cc76853785f4427">gOneCDirection</a>[ bTestDirection ] ]), usStructureID ) )
<a name="l03886"></a>03886             {
<a name="l03887"></a>03887                   <span class="comment">// can't go in that dir!</span>
<a name="l03888"></a>03888                   <span class="keywordflow">return</span>( FALSE );
<a name="l03889"></a>03889             }
<a name="l03890"></a>03890       }
<a name="l03891"></a>03891 
<a name="l03892"></a>03892       <span class="keywordflow">return</span>( TRUE );
<a name="l03893"></a>03893 }
<a name="l03894"></a>03894 
<a name="l03895"></a><a class="code" href="Soldier_01Ani_8h.html#9620717b03067fa2a2c58e119c103ab6">03895</a> <a class="code" href="Types_8h.html#112e3146cb38b6ee95e64d85842e380a">BOOLEAN</a> <a class="code" href="Soldier_01Ani_8cpp.html#9620717b03067fa2a2c58e119c103ab6">HandleCheckForDeathCommonCode</a>( <a class="code" href="structSOLDIERTYPE.html">SOLDIERTYPE</a> *<a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a> )
<a name="l03896"></a>03896 {
<a name="l03897"></a>03897       <span class="comment">// Do we have a primary pending animation?</span>
<a name="l03898"></a>03898       <span class="keywordflow">if</span> ( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#fbbac83b63f948835a517cb72fbfba71">usPendingAnimation2</a> != NO_PENDING_ANIMATION )
<a name="l03899"></a>03899       {
<a name="l03900"></a>03900             <a class="code" href="Soldier_01Control_8cpp.html#6f191e00fb4f3c5e2cbe762aa402a420">ChangeSoldierState</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>, pSoldier-&gt;<a class="code" href="structSOLDIERTYPE.html#fbbac83b63f948835a517cb72fbfba71">usPendingAnimation2</a>, 0, FALSE );
<a name="l03901"></a>03901             pSoldier-&gt;usPendingAnimation2 = NO_PENDING_ANIMATION;
<a name="l03902"></a>03902             <span class="keywordflow">return</span>( TRUE );
<a name="l03903"></a>03903       }
<a name="l03904"></a>03904 
<a name="l03905"></a>03905       <span class="comment">// CHECK IF WE HAVE A PENDING ANIMATION HERE</span>
<a name="l03906"></a>03906       <span class="keywordflow">if</span> ( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#10dcc042f40b20751530663b0bbbe289">usPendingAnimation</a> != NO_PENDING_ANIMATION )
<a name="l03907"></a>03907       {
<a name="l03908"></a>03908             <a class="code" href="Soldier_01Control_8cpp.html#6f191e00fb4f3c5e2cbe762aa402a420">ChangeSoldierState</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>, pSoldier-&gt;<a class="code" href="structSOLDIERTYPE.html#10dcc042f40b20751530663b0bbbe289">usPendingAnimation</a>, 0, FALSE );
<a name="l03909"></a>03909             pSoldier-&gt;usPendingAnimation = NO_PENDING_ANIMATION;
<a name="l03910"></a>03910             <span class="keywordflow">return</span>( TRUE );
<a name="l03911"></a>03911       }
<a name="l03912"></a>03912 
<a name="l03913"></a>03913       <span class="comment">// OTHERWISE, GOTO APPROPRIATE STOPANIMATION!</span>
<a name="l03914"></a>03914       <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#e7deba64e58676518e5d31bb7657da01">bCollapsed</a> = TRUE; 
<a name="l03915"></a>03915 
<a name="l03916"></a>03916   <span class="comment">// CC has requested - handle sight here...</span>
<a name="l03917"></a>03917       <a class="code" href="opplist_8cpp.html#84caab6b3c04128593b43316bfdfdf43">HandleSight</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>, SIGHT_LOOK );
<a name="l03918"></a>03918 
<a name="l03919"></a>03919       <span class="comment">// ATE: If it is our turn, make them try to getup...</span>
<a name="l03920"></a>03920       <span class="keywordflow">if</span> ( <a class="code" href="Overhead_8cpp.html#46bd754f8875c305ab18731ed10e3364">gTacticalStatus</a>.<a class="code" href="structTacticalStatusType.html#d4322ac2c70a18b5aa84c2041e08c9b1">ubCurrentTeam</a> == <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#74a40a8aaf3efe840cdaf6be62556d82">bTeam</a> )
<a name="l03921"></a>03921       {
<a name="l03922"></a>03922             <span class="comment">// Try to getup...</span>
<a name="l03923"></a>03923             <a class="code" href="Soldier_01Control_8cpp.html#adc8596f62b3c6e21b33cba7c7a250e6">BeginSoldierGetup</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a> );
<a name="l03924"></a>03924 
<a name="l03925"></a>03925             <span class="comment">// Check this to see if above worked</span>
<a name="l03926"></a>03926             <span class="keywordflow">if</span> ( !<a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#e7deba64e58676518e5d31bb7657da01">bCollapsed</a> )
<a name="l03927"></a>03927             {
<a name="l03928"></a>03928                   <span class="keywordflow">return</span>( TRUE );
<a name="l03929"></a>03929             }
<a name="l03930"></a>03930       }
<a name="l03931"></a>03931 
<a name="l03932"></a>03932       <span class="keywordflow">switch</span>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#1f73b62a5ea0dd26fa1bec1d9f522b41">usAnimState</a> )
<a name="l03933"></a>03933       {
<a name="l03934"></a>03934             <span class="keywordflow">case</span> <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2eb45acaaee9f8cf7570b7b840b8d20dbcc">FLYBACK_HIT</a>:
<a name="l03935"></a>03935                   <a class="code" href="Soldier_01Control_8cpp.html#6f191e00fb4f3c5e2cbe762aa402a420">ChangeSoldierState</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>, <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2eba3478a6cca1c618d5d972556b16b6622">FLYBACKHIT_STOP</a>, 0, FALSE );
<a name="l03936"></a>03936                   <span class="keywordflow">break</span>;
<a name="l03937"></a>03937 
<a name="l03938"></a>03938             <span class="keywordflow">case</span> <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2eb0c9fe0a8117aab849e61e9c42d219c63">GENERIC_HIT_DEATHTWITCHNB</a>:
<a name="l03939"></a>03939             <span class="keywordflow">case</span> <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2eb5734c6c3b78cd8b8f5ed5d27b48b44d3">FALLFORWARD_FROMHIT_STAND</a>:
<a name="l03940"></a>03940             <span class="keywordflow">case</span> <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2ebb0406929e67fde23b629e3f60baba8a8">ENDFALLFORWARD_FROMHIT_CROUCH</a>:
<a name="l03941"></a>03941 
<a name="l03942"></a>03942                   <a class="code" href="Soldier_01Control_8cpp.html#6f191e00fb4f3c5e2cbe762aa402a420">ChangeSoldierState</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>, <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2eb50c9d7dac67ef2c9405a84fcd76e4833">STAND_FALLFORWARD_STOP</a>, 0, FALSE );
<a name="l03943"></a>03943                   <span class="keywordflow">break</span>;
<a name="l03944"></a>03944 
<a name="l03945"></a>03945             <span class="keywordflow">case</span> <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2ebded57ded23f58a9903b60b9788790efe">FALLBACK_HIT_DEATHTWITCHNB</a>:
<a name="l03946"></a>03946             <span class="keywordflow">case</span> <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2eb8b6ec73ff14590fbd84485acdb213d6b">FALLBACK_HIT_STAND</a>:
<a name="l03947"></a>03947                   <a class="code" href="Soldier_01Control_8cpp.html#6f191e00fb4f3c5e2cbe762aa402a420">ChangeSoldierState</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>, <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2eb22609cecfc06000291ea1dcea22835b3">FALLBACKHIT_STOP</a>, 0, FALSE );
<a name="l03948"></a>03948                   <span class="keywordflow">break</span>;
<a name="l03949"></a>03949 
<a name="l03950"></a>03950             <span class="keywordflow">case</span> <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2eb08a34d55322f517abc7b038391f25f85">PRONE_HIT_DEATHTWITCHNB</a>:
<a name="l03951"></a>03951             <span class="keywordflow">case</span> <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2eb87791a2116a48401790a4477c19b1d4a">PRONE_LAY_FROMHIT</a>:
<a name="l03952"></a>03952 
<a name="l03953"></a>03953                   <a class="code" href="Soldier_01Control_8cpp.html#6f191e00fb4f3c5e2cbe762aa402a420">ChangeSoldierState</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>, <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2eb1a03feeb407e3b1fd0d9fc6378b69d6b">PRONE_LAYFROMHIT_STOP</a>, 0, FALSE );
<a name="l03954"></a>03954                   <span class="keywordflow">break</span>;
<a name="l03955"></a>03955 
<a name="l03956"></a>03956             <span class="keywordflow">case</span> <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2eb8f28eaaa17687dc192c1ffa03b34f840">FALLOFF</a>:
<a name="l03957"></a>03957                   <a class="code" href="Soldier_01Control_8cpp.html#6f191e00fb4f3c5e2cbe762aa402a420">ChangeSoldierState</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>, <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2ebffd54d5f50a94f74aba432de6f84a2e9">FALLOFF_STOP</a>, 0, FALSE );
<a name="l03958"></a>03958                   <span class="keywordflow">break</span>;
<a name="l03959"></a>03959 
<a name="l03960"></a>03960             <span class="keywordflow">case</span> <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2eb4e921a02222544c65473181fe2403dec">FALLFORWARD_ROOF</a>:
<a name="l03961"></a>03961                   <a class="code" href="Soldier_01Control_8cpp.html#6f191e00fb4f3c5e2cbe762aa402a420">ChangeSoldierState</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>, <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2eb2b379105dc05c51bde7ca16841b5c37c">FALLOFF_FORWARD_STOP</a>, 0, FALSE);
<a name="l03962"></a>03962                   <span class="keywordflow">break</span>;
<a name="l03963"></a>03963 
<a name="l03964"></a>03964             <span class="keywordflow">default</span>:
<a name="l03965"></a>03965                   <span class="comment">// IF we are here - something is wrong - we should have a death animation here</span>
<a name="l03966"></a>03966                   DebugMsg( TOPIC_JA2, DBG_LEVEL_3, <a class="code" href="DEBUG_8cpp.html#88565bf27eec0b2003eb5bc9426b8e4b">String</a>( <span class="stringliteral">"Soldier Ani: unconscious hit sequence needed for animation %d"</span>, <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#1f73b62a5ea0dd26fa1bec1d9f522b41">usAnimState</a> ) );
<a name="l03967"></a>03967 
<a name="l03968"></a>03968       }
<a name="l03969"></a>03969       <span class="comment">// OTHERWISE, GOTO APPROPRIATE STOPANIMATION!</span>
<a name="l03970"></a>03970       <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#e7deba64e58676518e5d31bb7657da01">bCollapsed</a> = TRUE; 
<a name="l03971"></a>03971 
<a name="l03972"></a>03972       <span class="comment">// ATE: If it is our turn, make them try to getup...</span>
<a name="l03973"></a>03973       <span class="keywordflow">if</span> ( <a class="code" href="Overhead_8cpp.html#46bd754f8875c305ab18731ed10e3364">gTacticalStatus</a>.<a class="code" href="structTacticalStatusType.html#d4322ac2c70a18b5aa84c2041e08c9b1">ubCurrentTeam</a> == <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#74a40a8aaf3efe840cdaf6be62556d82">bTeam</a> )
<a name="l03974"></a>03974       {
<a name="l03975"></a>03975             <span class="comment">// Try to getup...</span>
<a name="l03976"></a>03976             <a class="code" href="Soldier_01Control_8cpp.html#adc8596f62b3c6e21b33cba7c7a250e6">BeginSoldierGetup</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a> );
<a name="l03977"></a>03977 
<a name="l03978"></a>03978             <span class="comment">// Check this to see if above worked</span>
<a name="l03979"></a>03979             <span class="keywordflow">if</span> ( !<a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#e7deba64e58676518e5d31bb7657da01">bCollapsed</a> )
<a name="l03980"></a>03980             {
<a name="l03981"></a>03981                   <span class="keywordflow">return</span>( TRUE );
<a name="l03982"></a>03982             }
<a name="l03983"></a>03983       }
<a name="l03984"></a>03984 
<a name="l03985"></a>03985       <span class="keywordflow">switch</span>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#1f73b62a5ea0dd26fa1bec1d9f522b41">usAnimState</a> )
<a name="l03986"></a>03986       {
<a name="l03987"></a>03987             <span class="keywordflow">case</span> <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2eb45acaaee9f8cf7570b7b840b8d20dbcc">FLYBACK_HIT</a>:
<a name="l03988"></a>03988                   <a class="code" href="Soldier_01Control_8cpp.html#6f191e00fb4f3c5e2cbe762aa402a420">ChangeSoldierState</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>, <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2eba3478a6cca1c618d5d972556b16b6622">FLYBACKHIT_STOP</a>, 0, FALSE );
<a name="l03989"></a>03989                   <span class="keywordflow">break</span>;
<a name="l03990"></a>03990 
<a name="l03991"></a>03991             <span class="keywordflow">case</span> <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2eb0c9fe0a8117aab849e61e9c42d219c63">GENERIC_HIT_DEATHTWITCHNB</a>:
<a name="l03992"></a>03992             <span class="keywordflow">case</span> <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2eb5734c6c3b78cd8b8f5ed5d27b48b44d3">FALLFORWARD_FROMHIT_STAND</a>:
<a name="l03993"></a>03993             <span class="keywordflow">case</span> <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2ebb0406929e67fde23b629e3f60baba8a8">ENDFALLFORWARD_FROMHIT_CROUCH</a>:
<a name="l03994"></a>03994 
<a name="l03995"></a>03995                   <a class="code" href="Soldier_01Control_8cpp.html#6f191e00fb4f3c5e2cbe762aa402a420">ChangeSoldierState</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>, <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2eb50c9d7dac67ef2c9405a84fcd76e4833">STAND_FALLFORWARD_STOP</a>, 0, FALSE );
<a name="l03996"></a>03996                   <span class="keywordflow">break</span>;
<a name="l03997"></a>03997 
<a name="l03998"></a>03998             <span class="keywordflow">case</span> <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2ebded57ded23f58a9903b60b9788790efe">FALLBACK_HIT_DEATHTWITCHNB</a>:
<a name="l03999"></a>03999             <span class="keywordflow">case</span> <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2eb8b6ec73ff14590fbd84485acdb213d6b">FALLBACK_HIT_STAND</a>:
<a name="l04000"></a>04000                   <a class="code" href="Soldier_01Control_8cpp.html#6f191e00fb4f3c5e2cbe762aa402a420">ChangeSoldierState</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>, <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2eb22609cecfc06000291ea1dcea22835b3">FALLBACKHIT_STOP</a>, 0, FALSE );
<a name="l04001"></a>04001                   <span class="keywordflow">break</span>;
<a name="l04002"></a>04002 
<a name="l04003"></a>04003             <span class="keywordflow">case</span> <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2eb08a34d55322f517abc7b038391f25f85">PRONE_HIT_DEATHTWITCHNB</a>:
<a name="l04004"></a>04004             <span class="keywordflow">case</span> <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2eb87791a2116a48401790a4477c19b1d4a">PRONE_LAY_FROMHIT</a>:
<a name="l04005"></a>04005 
<a name="l04006"></a>04006                   <a class="code" href="Soldier_01Control_8cpp.html#6f191e00fb4f3c5e2cbe762aa402a420">ChangeSoldierState</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>, <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2eb1a03feeb407e3b1fd0d9fc6378b69d6b">PRONE_LAYFROMHIT_STOP</a>, 0, FALSE );
<a name="l04007"></a>04007                   <span class="keywordflow">break</span>;
<a name="l04008"></a>04008 
<a name="l04009"></a>04009             <span class="keywordflow">case</span> <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2eb8f28eaaa17687dc192c1ffa03b34f840">FALLOFF</a>:
<a name="l04010"></a>04010                   <a class="code" href="Soldier_01Control_8cpp.html#6f191e00fb4f3c5e2cbe762aa402a420">ChangeSoldierState</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>, <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2ebffd54d5f50a94f74aba432de6f84a2e9">FALLOFF_STOP</a>, 0, FALSE );
<a name="l04011"></a>04011                   <span class="keywordflow">break</span>;
<a name="l04012"></a>04012 
<a name="l04013"></a>04013             <span class="keywordflow">case</span> <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2eb4e921a02222544c65473181fe2403dec">FALLFORWARD_ROOF</a>:
<a name="l04014"></a>04014                   <a class="code" href="Soldier_01Control_8cpp.html#6f191e00fb4f3c5e2cbe762aa402a420">ChangeSoldierState</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>, <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2eb2b379105dc05c51bde7ca16841b5c37c">FALLOFF_FORWARD_STOP</a>, 0, FALSE);
<a name="l04015"></a>04015                   <span class="keywordflow">break</span>;
<a name="l04016"></a>04016 
<a name="l04017"></a>04017             <span class="keywordflow">default</span>:
<a name="l04018"></a>04018                   <span class="comment">// IF we are here - something is wrong - we should have a death animation here</span>
<a name="l04019"></a>04019                   DebugMsg( TOPIC_JA2, DBG_LEVEL_3, <a class="code" href="DEBUG_8cpp.html#88565bf27eec0b2003eb5bc9426b8e4b">String</a>( <span class="stringliteral">"Soldier Ani: unconscious hit sequence needed for animation %d"</span>, <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#1f73b62a5ea0dd26fa1bec1d9f522b41">usAnimState</a> ) );
<a name="l04020"></a>04020 
<a name="l04021"></a>04021       }
<a name="l04022"></a>04022 
<a name="l04023"></a>04023       <span class="keywordflow">return</span>( TRUE );
<a name="l04024"></a>04024 }
<a name="l04025"></a>04025 
<a name="l04026"></a>04026 
<a name="l04027"></a><a class="code" href="Soldier_01Ani_8h.html#e45c413ed609ec330c7ebfb712f9c6b0">04027</a> <span class="keywordtype">void</span> <a class="code" href="Soldier_01Ani_8cpp.html#e45c413ed609ec330c7ebfb712f9c6b0">KickOutWheelchair</a>( <a class="code" href="structSOLDIERTYPE.html">SOLDIERTYPE</a> *<a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a> )
<a name="l04028"></a>04028 {
<a name="l04029"></a>04029       <a class="code" href="Types_8h.html#30f500129d8c688af07726d5d34ce52d">INT16</a> sNewGridNo;
<a name="l04030"></a>04030 
<a name="l04031"></a>04031       <span class="comment">// Move forward one gridno....</span>
<a name="l04032"></a>04032       sNewGridNo = <a class="code" href="Isometric_01Utils_8cpp.html#318d8410127e29bb232ab70363bc316e">NewGridNo</a>( (<a class="code" href="Types_8h.html#09f1a1fb2293e33483cc8d44aefb1eb1">UINT16</a>)<a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#2ab66ee0f37902cd448f4a738df4f2bf">sGridNo</a>, (<a class="code" href="Types_8h.html#09f1a1fb2293e33483cc8d44aefb1eb1">UINT16</a>)( <a class="code" href="Isometric_01Utils_8cpp.html#a4a3adf599f99864b1de33673888fd5e">DirectionInc</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#8aa6174a253c3fa21a3ec41ce0174340">bDirection</a> ) ) );
<a name="l04033"></a>04033 
<a name="l04034"></a>04034       <span class="comment">// ATE: Make sure that the gridno is unoccupied!</span>
<a name="l04035"></a>04035       <span class="keywordflow">if</span> ( !<a class="code" href="Overhead_8cpp.html#1b42cba58f5984a3d0b0d0ec0d3def8c">NewOKDestination</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>, sNewGridNo, TRUE, <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#0d1f73c5d0ac839ec84a4792505949cb">bLevel</a> ) )
<a name="l04036"></a>04036       {
<a name="l04037"></a>04037             <span class="comment">// We should just stay put - will look kind of funny but nothing I can do!</span>
<a name="l04038"></a>04038             sNewGridNo = <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#2ab66ee0f37902cd448f4a738df4f2bf">sGridNo</a>;
<a name="l04039"></a>04039       }
<a name="l04040"></a>04040 
<a name="l04041"></a>04041       <a class="code" href="Soldier_01Control_8cpp.html#e90db6b8cf63e148848cf9fe9bbe56cf">EVENT_StopMerc</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>, sNewGridNo, <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#8aa6174a253c3fa21a3ec41ce0174340">bDirection</a> );
<a name="l04042"></a>04042       <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#b082364eed3d7883662f69e1fd96be1a">ubBodyType</a> = <a class="code" href="Animation_01Data_8h.html#d295a916825180b548473dec560093a788083a907978249a0160b5b1dd9ee4a4">REGMALE</a>;
<a name="l04043"></a>04043       <span class="keywordflow">if</span> ( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#5a5648a1bb3507cc41f6be199c51a3f8">ubProfile</a> == <a class="code" href="Soldier_01Profile_8h.html#acaa92dcb344e96138c964deae3e2fa16fdbd42950596fda948b4caabe34d053">SLAY</a> &amp;&amp; <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#74a40a8aaf3efe840cdaf6be62556d82">bTeam</a> == CIV_TEAM &amp;&amp; !<a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#165874ef5822faaf165da91996ad4a7b">bNeutral</a> )
<a name="l04044"></a>04044       {
<a name="l04045"></a>04045             <a class="code" href="Interface_01Dialogue_8cpp.html#584dff7dd6df4aa518083d0fe53a8bf5">HandleNPCDoAction</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#5a5648a1bb3507cc41f6be199c51a3f8">ubProfile</a>, <a class="code" href="interface_01Dialogue_8h.html#2ae95ea8e60178fe99580d5142f0ec7e0ae1a1b39f874a97419479a15f8ab006">NPC_ACTION_THREATENINGLY_RAISE_GUN</a>, 0 );
<a name="l04046"></a>04046       }
<a name="l04047"></a>04047       <span class="keywordflow">else</span>
<a name="l04048"></a>04048       {
<a name="l04049"></a>04049             <a class="code" href="Soldier_01Control_8cpp.html#2f98bd1e4ef2f55b4124a6cfa69a00e3">EVENT_InitNewSoldierAnim</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>, <a class="code" href="Animation_01Control_8h.html#9c02dc5e870a2c7d20bbaafb3e7be2eb61b6dd5eb66ef4c1c1c26ae5ed4cff43">STANDING</a>, 0 , TRUE );
<a name="l04050"></a>04050       }
<a name="l04051"></a>04051 
<a name="l04052"></a>04052       <span class="comment">// If this person has a profile ID, set body type to regmale</span>
<a name="l04053"></a>04053       <span class="keywordflow">if</span> ( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#5a5648a1bb3507cc41f6be199c51a3f8">ubProfile</a> != NO_PROFILE )
<a name="l04054"></a>04054       {
<a name="l04055"></a>04055             <a class="code" href="Soldier_01Profile_8cpp.html#1bcff2c50b375b1eb32800aa12000289">gMercProfiles</a>[ <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#5a5648a1bb3507cc41f6be199c51a3f8">ubProfile</a> ].<a class="code" href="structMERCPROFILESTRUCT.html#e193a429e867757861825f442953a0d2">ubBodyType</a> = <a class="code" href="Animation_01Data_8h.html#d295a916825180b548473dec560093a788083a907978249a0160b5b1dd9ee4a4">REGMALE</a>;
<a name="l04056"></a>04056       }
<a name="l04057"></a>04057 
<a name="l04058"></a>04058 }
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Sat Sep 9 13:48:58 2006 for Build by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.4.7 </small></address>
</body>
</html>
