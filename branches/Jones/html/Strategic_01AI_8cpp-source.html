<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>Build: Strategic AI.cpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.4.7 -->
<div class="tabs">
  <ul>
    <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="classes.html"><span>Classes</span></a></li>
    <li id="current"><a href="files.html"><span>Files</span></a></li>
    <li><a href="dirs.html"><span>Directories</span></a></li>
    <li>
      <form action="search.php" method="get">
        <table cellspacing="0" cellpadding="0" border="0">
          <tr>
            <td><label>&nbsp;<u>S</u>earch&nbsp;for&nbsp;</label></td>
            <td><input type="text" name="query" value="" size="20" accesskey="s"/></td>
          </tr>
        </table>
      </form>
    </li>
  </ul></div>
<div class="tabs">
  <ul>
    <li><a href="files.html"><span>File&nbsp;List</span></a></li>
    <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
  </ul></div>
<div class="nav">
<a class="el" href="dir_3179ea33d55a76dc38212d9eab798728.html">export</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_e5664b4b56927c8728eb3192fa60e338.html">hdc2</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_1eb12a41a47efb9efcd82fa98f4f4dbd.html">FTP</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_80cc1f21a78ab7941088ea567f236150.html">ja2src</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_994ab287602efefceafe55287a3657d6.html">Build</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_5aba590d477d4824a9090ab3f8850834.html">Strategic</a></div>
<h1>Strategic AI.cpp</h1><a href="Strategic_01AI_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">// WANNE 2 &lt;changed some lines&gt;</span>
<a name="l00002"></a>00002 <span class="preprocessor">#ifdef PRECOMPILEDHEADERS</span>
<a name="l00003"></a>00003 <span class="preprocessor"></span><span class="preprocessor">      #include "<a class="code" href="Strategic_01All_8h.html">Strategic All.h</a>"</span>
<a name="l00004"></a>00004 <span class="preprocessor">      #include "<a class="code" href="GameSettings_8h.html">GameSettings.h</a>"</span>
<a name="l00005"></a>00005 <span class="preprocessor">#else</span>
<a name="l00006"></a>00006 <span class="preprocessor"></span><span class="preprocessor">      #include &lt;stdio.h&gt;</span>
<a name="l00007"></a>00007 <span class="preprocessor">      #include "types.h"</span>
<a name="l00008"></a>00008 <span class="preprocessor">      #include "<a class="code" href="Strategic_01Movement_8h.html">Strategic Movement.h</a>"</span>
<a name="l00009"></a>00009 <span class="preprocessor">      #include "<a class="code" href="Queen_01Command_8h.html">Queen Command.h</a>"</span>
<a name="l00010"></a>00010 <span class="preprocessor">      #include "<a class="code" href="Strategic_01AI_8h.html">Strategic AI.h</a>"</span>
<a name="l00011"></a>00011 <span class="preprocessor">      #include "<a class="code" href="Game_01Event_01Hook_8h.html">Game Event Hook.h</a>"</span>
<a name="l00012"></a>00012 <span class="preprocessor">      #include "<a class="code" href="GameSettings_8h.html">GameSettings.h</a>"</span>
<a name="l00013"></a>00013 <span class="preprocessor">      #include "<a class="code" href="Campaign_01Types_8h.html">Campaign Types.h</a>"</span>
<a name="l00014"></a>00014 <span class="preprocessor">      #include "Random.h"</span>
<a name="l00015"></a>00015 <span class="preprocessor">      #include "<a class="code" href="Strategic_01Pathing_8h.html">Strategic Pathing.h</a>"</span>
<a name="l00016"></a>00016 <span class="preprocessor">      #include "<a class="code" href="message_8h.html">message.h</a>"</span>
<a name="l00017"></a>00017 <span class="preprocessor">      #include "<a class="code" href="Sound_01Control_8h.html">Sound Control.h</a>"</span>
<a name="l00018"></a>00018 <span class="preprocessor">      #include "<a class="code" href="strategicmap_8h.html">strategicmap.h</a>"</span>
<a name="l00019"></a>00019 <span class="preprocessor">      #include "<a class="code" href="Game_01Clock_8h.html">Game Clock.h</a>"</span>
<a name="l00020"></a>00020 <span class="preprocessor">      #include "<a class="code" href="strategic_8h.html">strategic.h</a>"</span>
<a name="l00021"></a>00021 <span class="preprocessor">      #include "<a class="code" href="Explosion_01Control_8h.html">Explosion Control.h</a>"</span>
<a name="l00022"></a>00022 <span class="preprocessor">      #include "<a class="code" href="Town_01Militia_8h.html">Town Militia.h</a>"</span>
<a name="l00023"></a>00023 <span class="preprocessor">#endif</span>
<a name="l00024"></a>00024 <span class="preprocessor"></span>
<a name="l00025"></a>00025 <span class="preprocessor">#define SAI_VERSION           29</span>
<a name="l00026"></a>00026 <span class="preprocessor"></span>
<a name="l00027"></a>00027 <span class="comment">/*</span>
<a name="l00028"></a>00028 <span class="comment">STRATEGIC AI -- UNDERLYING PHILOSOPHY</span>
<a name="l00029"></a>00029 <span class="comment">The most fundamental part of the strategic AI which takes from reality and gives to gameplay is the manner</span>
<a name="l00030"></a>00030 <span class="comment">the queen attempts to take her towns back.  Finances and owning mines are the most important way</span>
<a name="l00031"></a>00031 <span class="comment">to win the game.  As the player takes more mines over, the queen will focus more on quality and defense.  In</span>
<a name="l00032"></a>00032 <span class="comment">the beginning of the game, she will focus more on offense than mid-game or end-game.  </span>
<a name="l00033"></a>00033 <span class="comment"></span>
<a name="l00034"></a>00034 <span class="comment">REALITY</span>
<a name="l00035"></a>00035 <span class="comment">The queen owns the entire country, and the player starts the game with a small lump of cash, enough to hire</span>
<a name="l00036"></a>00036 <span class="comment">some mercenaries for about a week.  In that week, the queen may not notice what is going on, and the player</span>
<a name="l00037"></a>00037 <span class="comment">would believably take over one of the towns before she could feasibly react.  As soon as her military was</span>
<a name="l00038"></a>00038 <span class="comment">aware of the situation, she would likely proceed to send 300-400 troops to annihilate the opposition, and the </span>
<a name="l00039"></a>00039 <span class="comment">game would be over relatively quickly.  If the player was a prodigy, and managed to hold the town against such  </span>
<a name="l00040"></a>00040 <span class="comment">a major assault, he would probably lose in the long run being forced into a defensive position and running out </span>
<a name="l00041"></a>00041 <span class="comment">of money quickly while the queen could continue to pump out the troops.  On the other hand, if the player </span>
<a name="l00042"></a>00042 <span class="comment">somehow managed to take over most of the mines, he would be able to casually walk over the queen eventually </span>
<a name="l00043"></a>00043 <span class="comment">just from the sheer income allowing him to purchase several of the best mercs.  That would have the effect of</span>
<a name="l00044"></a>00044 <span class="comment">making the game impossibly difficult in the beginning of the game, and a joke at the end (this is very much</span>
<a name="l00045"></a>00045 <span class="comment">like Master Of Orion II on the more difficult settings )</span>
<a name="l00046"></a>00046 <span class="comment"></span>
<a name="l00047"></a>00047 <span class="comment">GAMEPLAY</span>
<a name="l00048"></a>00048 <span class="comment">Because we want the game to be like a normal game and make it fun, we need to make the game easy in the </span>
<a name="l00049"></a>00049 <span class="comment">beginning and harder at the end.  In order to accomplish this, I feel that pure income shouldn't be the factor </span>
<a name="l00050"></a>00050 <span class="comment">for the queen, because she would likely crucify a would-be leader in his early days.  So, in the beginning of</span>
<a name="l00051"></a>00051 <span class="comment">the game, the forces would already be situated with the majority of forces being the administrators in the towns, </span>
<a name="l00052"></a>00052 <span class="comment">and army troops and elites in the more important sectors.  Restricting the queen's offensive</span>
<a name="l00053"></a>00053 <span class="comment">abilities using a distance penalty would mean that the furthest sectors from the queen's palace would be</span>
<a name="l00054"></a>00054 <span class="comment">much easier to defend because she would only be allowed to send x number of troops.  As you get closer to the </span>
<a name="l00055"></a>00055 <span class="comment">queen, she would be allowed to send larger forces to attack those towns in question.  Also, to further </span>
<a name="l00056"></a>00056 <span class="comment">increase the games difficulty as the campaign progresses in the player's favor, we could also increase the</span>
<a name="l00057"></a>00057 <span class="comment">quality of the queen's troops based purely on the peek progress percentage.  This is calculated using a formula </span>
<a name="l00058"></a>00058 <span class="comment">that determines how well the player is doing by combining loyalty of towns owned, income generated, etc.  So, </span>
<a name="l00059"></a>00059 <span class="comment">in the beginning of the game, the quality is at the worst, but once you capture your first mines/towns, it </span>
<a name="l00060"></a>00060 <span class="comment">permanently  increase the queen's quality rating, effectively bumping up the stakes.  By the time you capture </span>
<a name="l00061"></a>00061 <span class="comment">four or five mines, the queen is going to focus more (but not completely) on quality defense as she prepares </span>
<a name="l00062"></a>00062 <span class="comment">for your final onslaught.  This quality rating will augment the experience level, equipment rating, and/or </span>
<a name="l00063"></a>00063 <span class="comment">attribute ratings of the queen's troops.  I would maintain a table of these enhancements based on the current </span>
<a name="l00064"></a>00064 <span class="comment">quality rating hooking into the difficulty all along.</span>
<a name="l00065"></a>00065 <span class="comment"></span>
<a name="l00066"></a>00066 <span class="comment">//EXPLANATION OF THE WEIGHT SYSTEM:</span>
<a name="l00067"></a>00067 <span class="comment">The strategic AI has two types of groups:  garrisons and patrol groups.  Each of these groups contain</span>
<a name="l00068"></a>00068 <span class="comment">information of it's needs, mainly desired population.  If the current population is greater than the</span>
<a name="l00069"></a>00069 <span class="comment">desired population, and the group will get a negative weight assigned to it, which means that it is willing</span>
<a name="l00070"></a>00070 <span class="comment">to give up troops to areas that need them more.  On the other hand, if a group has less than the desired population, </span>
<a name="l00071"></a>00071 <span class="comment">then the weight will be positive, meaning they are requesting reinforcements.</span>
<a name="l00072"></a>00072 <span class="comment"></span>
<a name="l00073"></a>00073 <span class="comment">The weight generated will range between -100 and +100.  The calculated weight is modified by the priority</span>
<a name="l00074"></a>00074 <span class="comment">of the group.  If the priority of the group is high, they </span>
<a name="l00075"></a>00075 <span class="comment">*/</span>
<a name="l00076"></a>00076 
<a name="l00077"></a>00077 
<a name="l00078"></a>00078 <span class="comment">//Kaiden: While the values below were Defines that we built off of, the actuall</span>
<a name="l00079"></a>00079 <span class="comment">// values have been externalized into an INI file. Not all of them at this point,</span>
<a name="l00080"></a>00080 <span class="comment">// but more will be externalized as time goes on.</span>
<a name="l00081"></a>00081 
<a name="l00082"></a>00082 <span class="comment">//#define BASIC_POOL_INCREMENT gGameExternalOptions.guiBaseQueenPoolIncrement</span>
<a name="l00083"></a>00083 
<a name="l00084"></a>00084 <span class="comment">//Modifies the number of troops the queen has at the beginning of the game on top</span>
<a name="l00085"></a>00085 <span class="comment">//of all of the garrison and patrol groups.  Additionally, there are a total of </span>
<a name="l00086"></a>00086 <span class="comment">//16 sectors that are LEVEL 1, 2, or 3 garrison groups.  The lower the level, the more</span>
<a name="l00087"></a>00087 <span class="comment">//troops stay in that sector, and the rest will also be used as a secondary pool when</span>
<a name="l00088"></a>00088 <span class="comment">//the primary pool runs dry.  So basically, this number is only part of the equation.</span>
<a name="l00089"></a>00089 <span class="comment">//#define EASY_QUEENS_POOL_OF_TROOPS                              150</span>
<a name="l00090"></a>00090 <span class="comment">//#define NORMAL_QUEENS_POOL_OF_TROOPS                      200</span>
<a name="l00091"></a>00091 <span class="comment">//#define HARD_QUEENS_POOL_OF_TROOPS                              400</span>
<a name="l00092"></a>00092 <span class="comment">//#define INSANE_QUEENS_POOL_OF_TROOPS                      8000</span>
<a name="l00093"></a>00093 
<a name="l00094"></a>00094 <span class="comment">//Modifies the starting values as well as the desired values for all of the garrisons.</span>
<a name="l00095"></a>00095 <span class="comment">//#define EASY_INITIAL_GARRISON_PERCENTAGES           70</span>
<a name="l00096"></a>00096 <span class="comment">//#define NORMAL_INITIAL_GARRISON_PERCENTAGES   100</span>
<a name="l00097"></a>00097 <span class="comment">//#define HARD_INITIAL_GARRISON_PERCENTAGES           150 //125</span>
<a name="l00098"></a>00098 <span class="comment">//#define INSANE_INITIAL_GARRISON_PERCENTAGES         200</span>
<a name="l00099"></a>00099 
<a name="l00100"></a>00100 <span class="comment">//Madd - sets % of extra elite troops in army compositions</span>
<a name="l00101"></a>00101 <span class="comment">//#define INSANE_ELITE_BONUS                          50//25</span>
<a name="l00102"></a>00102 <span class="comment">//#define EXPERT_ELITE_BONUS                          25//0</span>
<a name="l00103"></a>00103 
<a name="l00104"></a>00104 <span class="comment">//#define EASY_MIN_ENEMY_GROUP_SIZE                               3</span>
<a name="l00105"></a>00105 <span class="comment">//#define NORMAL_MIN_ENEMY_GROUP_SIZE                             4</span>
<a name="l00106"></a>00106 <span class="comment">//#define HARD_MIN_ENEMY_GROUP_SIZE                               6</span>
<a name="l00107"></a>00107 <span class="comment">//#define INSANE_MIN_ENEMY_GROUP_SIZE                                   8</span>
<a name="l00108"></a>00108 
<a name="l00109"></a>00109 <span class="comment">//Sets the starting alert chances.  Everytime an enemy arrives in a new sector, or the player,</span>
<a name="l00110"></a>00110 <span class="comment">//this is the chance the enemy will detect the player in adjacent sectors.  This chance is associated</span>
<a name="l00111"></a>00111 <span class="comment">//with each side checked.  Stationary groups do this check periodically.</span>
<a name="l00112"></a>00112 <span class="comment">//#define EASY_ENEMY_STARTING_ALERT_LEVEL             20</span>
<a name="l00113"></a>00113 <span class="comment">//#define   NORMAL_ENEMY_STARTING_ALERT_LEVEL         50</span>
<a name="l00114"></a>00114 <span class="comment">//#define HARD_ENEMY_STARTING_ALERT_LEVEL             70</span>
<a name="l00115"></a>00115 <span class="comment">//#define INSANE_ENEMY_STARTING_ALERT_LEVEL           90</span>
<a name="l00116"></a>00116 
<a name="l00117"></a>00117 <span class="comment">//When an enemy spots and chases a player group, the alertness value decrements by this value.  The</span>
<a name="l00118"></a>00118 <span class="comment">//higher the value, the less of a chance the enemy will spot and attack subsequent groups.  This </span>
<a name="l00119"></a>00119 <span class="comment">//minimizes the aggressiveness of the enemy.  Ranges from 1-100 (but recommend 20-60).</span>
<a name="l00120"></a>00120 <span class="comment">//#define EASY_ENEMY_STARTING_ALERT_DECAY             75</span>
<a name="l00121"></a>00121 <span class="comment">//#define   NORMAL_ENEMY_STARTING_ALERT_DECAY         50</span>
<a name="l00122"></a>00122 <span class="comment">//#define HARD_ENEMY_STARTING_ALERT_DECAY             25</span>
<a name="l00123"></a>00123 <span class="comment">//#define INSANE_ENEMY_STARTING_ALERT_DECAY           10</span>
<a name="l00124"></a>00124 
<a name="l00125"></a>00125 <span class="comment">//The base time that the queen can think about reinforcements for refilling lost patrol groups, </span>
<a name="l00126"></a>00126 <span class="comment">//town garrisons, etc. She only is allowed one action per 'turn'.</span>
<a name="l00127"></a>00127 <span class="comment">//#define EASY_TIME_EVALUATE_IN_MINUTES                     480</span>
<a name="l00128"></a>00128 <span class="comment">//#define NORMAL_TIME_EVALUATE_IN_MINUTES             360</span>
<a name="l00129"></a>00129 <span class="comment">//#define HARD_TIME_EVALUATE_IN_MINUTES                     180</span>
<a name="l00130"></a>00130 <span class="comment">//#define INSANE_TIME_EVALUATE_IN_MINUTES                   90</span>
<a name="l00131"></a>00131 
<a name="l00132"></a>00132 <span class="comment">//The variance added on.</span>
<a name="l00133"></a>00133 <span class="comment">//#define EASY_TIME_EVALUATE_VARIANCE                             240</span>
<a name="l00134"></a>00134 <span class="comment">//#define NORMAL_TIME_EVALUATE_VARIANCE                     180</span>
<a name="l00135"></a>00135 <span class="comment">//#define HARD_TIME_EVALUATE_VARIANCE                             120</span>
<a name="l00136"></a>00136 <span class="comment">//#define INSANE_TIME_EVALUATE_VARIANCE                     60</span>
<a name="l00137"></a>00137 
<a name="l00138"></a>00138 <span class="comment">//When a player takes control of a sector, don't allow any enemy reinforcements to enter the sector for a </span>
<a name="l00139"></a>00139 <span class="comment">//limited amount of time.  This essentially dumbs down the AI, making it less aggressive.</span>
<a name="l00140"></a>00140 <span class="comment">//#define EASY_GRACE_PERIOD_IN_HOURS                              144         // 6 days</span>
<a name="l00141"></a>00141 <span class="comment">//#define NORMAL_GRACE_PERIOD_IN_HOURS                      96          // 4 days</span>
<a name="l00142"></a>00142 <span class="comment">//#define HARD_GRACE_PERIOD_IN_HOURS                              48          // 2 days</span>
<a name="l00143"></a>00143 <span class="comment">//#define INSANE_GRACE_PERIOD_IN_HOURS                      6           // hours!</span>
<a name="l00144"></a>00144 
<a name="l00145"></a>00145 <span class="comment">//Defines how many days must pass before the queen is willing to refill a defeated patrol group.</span>
<a name="l00146"></a>00146 <span class="comment">//#define EASY_PATROL_GRACE_PERIOD_IN_DAYS            16</span>
<a name="l00147"></a>00147 <span class="comment">//#define NORMAL_PATROL_GRACE_PERIOD_IN_DAYS          12</span>
<a name="l00148"></a>00148 <span class="comment">//#define HARD_PATROL_GRACE_PERIOD_IN_DAYS            8</span>
<a name="l00149"></a>00149 <span class="comment">//#define INSANE_PATROL_GRACE_PERIOD_IN_DAYS          2</span>
<a name="l00150"></a>00150 
<a name="l00151"></a>00151 <span class="comment">//Certain conditions can cause the queen to go into a "full alert" mode.  This means that temporarily, the queen's </span>
<a name="l00152"></a>00152 <span class="comment">//forces will automatically succeed adjacent checks until x number of enemy initiated battles occur.  The same variable</span>
<a name="l00153"></a>00153 <span class="comment">//is what is used to determine the free checks.</span>
<a name="l00154"></a>00154 <span class="comment">//#define EASY_NUM_AWARE_BATTLES                                        1</span>
<a name="l00155"></a>00155 <span class="comment">//#define NORMAL_NUM_AWARE_BATTLES                                2</span>
<a name="l00156"></a>00156 <span class="comment">//#define HARD_NUM_AWARE_BATTLES                                        3</span>
<a name="l00157"></a>00157 <span class="comment">//#define INSANE_NUM_AWARE_BATTLES                                4</span>
<a name="l00158"></a>00158 
<a name="l00159"></a><a class="code" href="Strategic_01AI_8cpp.html#0b19bf9a0569a096cc99bf573da9e441">00159</a> <a class="code" href="Types_8h.html#112e3146cb38b6ee95e64d85842e380a">BOOLEAN</a> <a class="code" href="mapscreen_8cpp.html#0b19bf9a0569a096cc99bf573da9e441">gfAutoAIAware</a> = FALSE;
<a name="l00160"></a>00160 
<a name="l00161"></a>00161 <span class="comment">//Saved vars</span>
<a name="l00162"></a><a class="code" href="Strategic_01AI_8cpp.html#c689ec381215b910ba04d356fe3b96ed">00162</a> <a class="code" href="Types_8h.html#7ebe70ceca856797319175e30bcf003d">INT8</a>        <a class="code" href="Strategic_01AI_8cpp.html#c689ec381215b910ba04d356fe3b96ed">gbPadding2</a>[3]                                   = {0, 0, 0};      <span class="comment">//NOT USED</span>
<a name="l00163"></a><a class="code" href="Strategic_01AI_8cpp.html#da8cb507523142e34aa6a62793f76a88">00163</a> <a class="code" href="Types_8h.html#112e3146cb38b6ee95e64d85842e380a">BOOLEAN</a> <a class="code" href="Strategic_01AI_8cpp.html#da8cb507523142e34aa6a62793f76a88">gfExtraElites</a>                                 = 0;  <span class="comment">//Set when queen compositions are augmented with bonus elites.</span>
<a name="l00164"></a><a class="code" href="Strategic_01AI_8cpp.html#bc61e2ffd8a6355b543d582d17631f9f">00164</a> <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a>       <a class="code" href="AI_01Viewer_8cpp.html#bc61e2ffd8a6355b543d582d17631f9f">giGarrisonArraySize</a>                 = 0;
<a name="l00165"></a><a class="code" href="Strategic_01AI_8cpp.html#8c839f77f7a78de6ff920d5943d834d7">00165</a> <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a>       <a class="code" href="Strategic_01AI_8cpp.html#8c839f77f7a78de6ff920d5943d834d7">giPatrolArraySize</a>                   = 0;
<a name="l00166"></a><a class="code" href="Strategic_01AI_8cpp.html#dd33d20256198684ad819b0f877ba407">00166</a> <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a>       <a class="code" href="Strategic_01AI_8cpp.html#dd33d20256198684ad819b0f877ba407">giForcePercentage</a>                   = 0;  <span class="comment">//Modifies the starting group sizes relative by percentage</span>
<a name="l00167"></a><a class="code" href="Strategic_01AI_8cpp.html#5ca96833bf812b9e43da8510ca54f00a">00167</a> <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a>       <a class="code" href="Strategic_01AI_8cpp.html#5ca96833bf812b9e43da8510ca54f00a">giArmyAlertness</a>                           = 0;  <span class="comment">//The chance the group will spot an adjacent player/militia</span>
<a name="l00168"></a><a class="code" href="Strategic_01AI_8cpp.html#1bdeafde98c11d85ed1f79f8c793b1bc">00168</a> <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a>   <a class="code" href="Strategic_01AI_8cpp.html#1bdeafde98c11d85ed1f79f8c793b1bc">giArmyAlertnessDecay</a>        = 0;  <span class="comment">//How much the spotting chance decreases when spot check succeeds</span>
<a name="l00169"></a><a class="code" href="Strategic_01Movement_8cpp.html#51810f18d754360f44aa8ed343a2ae73">00169</a> <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>       <a class="code" href="Strategic_01AI_8cpp.html#ab475b2c021e0d3a27bc5f4c7bd22639">gubNumAwareBattles</a>                  = 0;  <span class="comment">//When non-zero, this means the queen is very aware and searching for players.  Every time</span>
<a name="l00170"></a>00170                                                                                                                   <span class="comment">//there is an enemy initiated battle, this counter decrements until zero.  Until that point,</span>
<a name="l00171"></a>00171                                                                                                                   <span class="comment">//all adjacent sector checks automatically succeed.</span>
<a name="l00172"></a><a class="code" href="Strategic_01AI_8cpp.html#38284bd39764812fb8a27fe4d3d2b0cd">00172</a> <a class="code" href="Types_8h.html#112e3146cb38b6ee95e64d85842e380a">BOOLEAN</a> <a class="code" href="AI_01Viewer_8cpp.html#38284bd39764812fb8a27fe4d3d2b0cd">gfQueenAIAwake</a>                          = FALSE;    <span class="comment">//This flag turns on/off the strategic decisions.  If it's off, no reinforcements </span>
<a name="l00173"></a>00173                                                                                                                               <span class="comment">//or assaults will happen.  </span>
<a name="l00174"></a>00174                                                                                                                               <span class="comment">//@@@Alex, this flag is ONLY set by the first meanwhile scene which calls an action.  If this</span>
<a name="l00175"></a>00175                                                                                                                               <span class="comment">//action isn't called, the AI will never turn on.  It is completely dependant on this action.  It can</span>
<a name="l00176"></a>00176                                                                                                                               <span class="comment">//be toggled at will in the AIViewer for testing purposes.</span>
<a name="l00177"></a><a class="code" href="Strategic_01AI_8cpp.html#c86cd58021961af10f1eb15108a79023">00177</a> <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a>       <a class="code" href="AI_01Viewer_8cpp.html#c86cd58021961af10f1eb15108a79023">giReinforcementPool</a>                 = 0;  <span class="comment">//How many troops the queen has in reserve in noman's land.  These guys are spawned as needed in P3.</span>
<a name="l00178"></a><a class="code" href="Strategic_01AI_8cpp.html#a54cf2087c7e1b790053295a6bf90592">00178</a> <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a>   <a class="code" href="AI_01Viewer_8cpp.html#a54cf2087c7e1b790053295a6bf90592">giReinforcementPoints</a>       = 0;  <span class="comment">//the entire army's capacity to provide reinforcements.</span>
<a name="l00179"></a><a class="code" href="Strategic_01AI_8cpp.html#c3390da297cb8068458f459fe9fc094f">00179</a> <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a>       <a class="code" href="AI_01Viewer_8cpp.html#c3390da297cb8068458f459fe9fc094f">giRequestPoints</a>                           = 0;  <span class="comment">//the entire army's need for reinforcements.</span>
<a name="l00180"></a><a class="code" href="Strategic_01AI_8h.html#4f25955839f4d03d6e72fcb14e00fc96">00180</a> <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>   <a class="code" href="Strategic_01AI_8cpp.html#4f25955839f4d03d6e72fcb14e00fc96">gubSAIVersion</a>                                 = SAI_VERSION;    <span class="comment">//Used for adding new features to be saved.</span>
<a name="l00181"></a><a class="code" href="Strategic_01AI_8cpp.html#b6506b3e47eb797cd604d652eb70cdc3">00181</a> <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>       <a class="code" href="Strategic_01AI_8cpp.html#b6506b3e47eb797cd604d652eb70cdc3">gubQueenPriorityPhase</a>         = 0;  <span class="comment">//Defines how far into defence the queen is -- abstractly related to defcon index ranging from 0-10.  </span>
<a name="l00182"></a>00182 
<a name="l00183"></a><a class="code" href="Strategic_01AI_8cpp.html#b0c12688f38630da4e064c85394ca570">00183</a> <a class="code" href="Types_8h.html#112e3146cb38b6ee95e64d85842e380a">BOOLEAN</a>           <a class="code" href="Strategic_01AI_8cpp.html#b0c12688f38630da4e064c85394ca570">gfUnlimitedTroops</a> = FALSE;
<a name="l00184"></a><a class="code" href="Strategic_01AI_8cpp.html#03888c7c25d0c7d4585ed03317d64c53">00184</a> <a class="code" href="Types_8h.html#112e3146cb38b6ee95e64d85842e380a">BOOLEAN</a>           <a class="code" href="Strategic_01AI_8cpp.html#03888c7c25d0c7d4585ed03317d64c53">gfAggressiveQueen</a> = FALSE;
<a name="l00185"></a>00185 
<a name="l00186"></a>00186 <span class="comment">//10 is the most defensive</span>
<a name="l00187"></a>00187 <span class="comment">//Used for authorizing the use of the first battle meanwhile scene AFTER the battle is complete.  This is the case used when</span>
<a name="l00188"></a>00188 <span class="comment">//the player attacks a town, and is set once militia are sent to investigate.</span>
<a name="l00189"></a><a class="code" href="Strategic_01AI_8h.html#25242025da42191e44f15d6f90efbaf7">00189</a> <a class="code" href="Types_8h.html#112e3146cb38b6ee95e64d85842e380a">BOOLEAN</a> <a class="code" href="Strategic_01AI_8cpp.html#25242025da42191e44f15d6f90efbaf7">gfFirstBattleMeanwhileScenePending</a> = FALSE;
<a name="l00190"></a>00190 
<a name="l00191"></a>00191 <span class="comment">//After the first battle meanwhile scene is finished, this flag is set, and the queen orders patrol groups to immediately fortify all towns.</span>
<a name="l00192"></a><a class="code" href="Strategic_01AI_8cpp.html#ace9c47ca01a402ca45743ff70c9d70c">00192</a> <a class="code" href="Types_8h.html#112e3146cb38b6ee95e64d85842e380a">BOOLEAN</a> <a class="code" href="Strategic_01AI_8cpp.html#ace9c47ca01a402ca45743ff70c9d70c">gfMassFortificationOrdered</a> = FALSE;
<a name="l00193"></a>00193 
<a name="l00194"></a><a class="code" href="Strategic_01AI_8cpp.html#12b5525b1f3dabeac40700eecd3219e7">00194</a> <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>       <a class="code" href="Strategic_01AI_8cpp.html#12b5525b1f3dabeac40700eecd3219e7">gubMinEnemyGroupSize</a>                = 0;
<a name="l00195"></a><a class="code" href="Strategic_01AI_8cpp.html#123935928b8e3146a1edda9d78cfea62">00195</a> <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>       <a class="code" href="Strategic_01AI_8cpp.html#123935928b8e3146a1edda9d78cfea62">gubHoursGracePeriod</a>      = 0;
<a name="l00196"></a><a class="code" href="Strategic_01AI_8cpp.html#711cdebe533db7c45a8e7e88c6f312d6">00196</a> <a class="code" href="Types_8h.html#09f1a1fb2293e33483cc8d44aefb1eb1">UINT16</a>      <a class="code" href="Strategic_01AI_8cpp.html#711cdebe533db7c45a8e7e88c6f312d6">gusPlayerBattleVictories</a> = 0;
<a name="l00197"></a><a class="code" href="DecideAction_8cpp.html#8029ae4e0579eaec31822e170536fe40">00197</a> <a class="code" href="Types_8h.html#112e3146cb38b6ee95e64d85842e380a">BOOLEAN</a> <a class="code" href="Strategic_01AI_8cpp.html#8029ae4e0579eaec31822e170536fe40">gfUseAlternateQueenPosition</a> = FALSE;
<a name="l00198"></a>00198 
<a name="l00199"></a>00199 <span class="comment">//padding for generic globals</span>
<a name="l00200"></a>00200 <span class="preprocessor">#define SAI_PADDING_BYTES                       97</span>
<a name="l00201"></a><a class="code" href="Strategic_01AI_8cpp.html#e123fe3aeaaec0cd4c30b4599e299f84">00201</a> <span class="preprocessor"></span><a class="code" href="Types_8h.html#7ebe70ceca856797319175e30bcf003d">INT8</a>        <a class="code" href="Strategic_01AI_8cpp.html#e123fe3aeaaec0cd4c30b4599e299f84">gbPadding</a>[SAI_PADDING_BYTES];
<a name="l00202"></a>00202 <span class="comment">//patrol group info plus padding</span>
<a name="l00203"></a>00203 <span class="preprocessor">#define SAVED_PATROL_GROUPS               50</span>
<a name="l00204"></a><a class="code" href="Strategic_01AI_8cpp.html#9e00ccb0e77cec57208c519e8f831f53">00204</a> <span class="preprocessor"></span><a class="code" href="structPATROL__GROUP.html">PATROL_GROUP</a> *<a class="code" href="Strategic_01AI_8cpp.html#9e00ccb0e77cec57208c519e8f831f53">gPatrolGroup</a>                = NULL;
<a name="l00205"></a>00205 <span class="comment">//army composition info plus padding</span>
<a name="l00206"></a>00206 <span class="preprocessor">#define SAVED_ARMY_COMPOSITIONS     60</span>
<a name="l00207"></a><a class="code" href="Strategic_01AI_8cpp.html#77e448d1f208bd120f861571e6d0098f">00207</a> <span class="preprocessor"></span><a class="code" href="structARMY__COMPOSITION.html">ARMY_COMPOSITION</a> <a class="code" href="AI_01Viewer_8cpp.html#77e448d1f208bd120f861571e6d0098f">gArmyComp</a>[ <a class="code" href="Strategic_01AI_8h.html#a9908284c0827729f14cf9b2489e1479d2a0278d1458eaa8c2bb99d2d4b55f00">NUM_ARMY_COMPOSITIONS</a> ];
<a name="l00208"></a>00208 <span class="comment">//garrison info plus padding</span>
<a name="l00209"></a>00209 <span class="preprocessor">#define SAVED_GARRISON_GROUPS       100</span>
<a name="l00210"></a><a class="code" href="Strategic_01AI_8cpp.html#a9f940d7f3a6d6698bfaeb7c747d74a9">00210</a> <span class="preprocessor"></span><a class="code" href="structGARRISON__GROUP.html">GARRISON_GROUP</a> *<a class="code" href="AI_01Viewer_8cpp.html#a9f940d7f3a6d6698bfaeb7c747d74a9">gGarrisonGroup</a>      = NULL;
<a name="l00211"></a>00211 
<a name="l00212"></a>00212 <span class="keyword">extern</span> <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> <a class="code" href="Strategic_01AI_8cpp.html#ab5d709f078af18573e35b5a6c215cdb">gubNumGroupsArrivedSimultaneously</a>;
<a name="l00213"></a>00213 
<a name="l00214"></a>00214 <span class="comment">//This refers to the number of force points that are *saved* for the AI to use.  This is basically an array of each</span>
<a name="l00215"></a>00215 <span class="comment">//group.  When the queen wants to send forces to attack a town that is defended, the initial number of forces that </span>
<a name="l00216"></a>00216 <span class="comment">//she would send would be considered too weak.  So, instead, she will send that force to the sector's adjacent sector,</span>
<a name="l00217"></a>00217 <span class="comment">//and stage, while </span>
<a name="l00218"></a><a class="code" href="Strategic_01AI_8cpp.html#9bc393a708632bfedc7ce82ab9268709">00218</a> <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> *<a class="code" href="Strategic_01AI_8cpp.html#9bc393a708632bfedc7ce82ab9268709">gubGarrisonReinforcementsDenied</a> = NULL; 
<a name="l00219"></a><a class="code" href="Strategic_01AI_8cpp.html#48e0403413b13dc086dc70c6921ee186">00219</a> <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> *<a class="code" href="Strategic_01AI_8cpp.html#48e0403413b13dc086dc70c6921ee186">gubPatrolReinforcementsDenied</a> = NULL; 
<a name="l00220"></a>00220 
<a name="l00221"></a>00221 <span class="comment">//Unsaved vars</span>
<a name="l00222"></a><a class="code" href="Strategic_01AI_8h.html#9b562b638dab71449e22ac59b9c090e0">00222</a> <a class="code" href="Types_8h.html#112e3146cb38b6ee95e64d85842e380a">BOOLEAN</a> <a class="code" href="Strategic_01AI_8cpp.html#9b562b638dab71449e22ac59b9c090e0">gfDisplayStrategicAILogs</a> = FALSE;
<a name="l00223"></a>00223 
<a name="l00224"></a>00224 <span class="keywordtype">void</span> <a class="code" href="Strategic_01AI_8cpp.html#6447b1863729a0af153094f1246a27e8">ValidatePendingGroups</a>();
<a name="l00225"></a>00225 <span class="keywordtype">void</span> <a class="code" href="Strategic_01AI_8cpp.html#75d774eb03c41b5fe422edfef6e445d4">ValidateWeights</a>( <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a> iID );
<a name="l00226"></a>00226 <span class="keywordtype">void</span> <a class="code" href="Strategic_01AI_8cpp.html#3c3091ef7361288e9f4f6a95cb067980">ValidateGroup</a>( <a class="code" href="structGROUP.html">GROUP</a> *pGroup );
<a name="l00227"></a>00227 <span class="keywordtype">void</span> <a class="code" href="Strategic_01AI_8cpp.html#cc36ad74d06a3b8b211a4e06c8528a43">ValidateLargeGroup</a>( <a class="code" href="structGROUP.html">GROUP</a> *pGroup );
<a name="l00228"></a>00228 
<a name="l00229"></a>00229 <span class="keyword">extern</span> <a class="code" href="Types_8h.html#112e3146cb38b6ee95e64d85842e380a">BOOLEAN</a> <a class="code" href="Strategic_01AI_8cpp.html#2884d9fa0a918d1311af93763422a36f">TeleportSoldier</a>( <a class="code" href="structSOLDIERTYPE.html">SOLDIERTYPE</a> *<a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>, <a class="code" href="Types_8h.html#30f500129d8c688af07726d5d34ce52d">INT16</a> sGridNo, <a class="code" href="Types_8h.html#112e3146cb38b6ee95e64d85842e380a">BOOLEAN</a> fForce );
<a name="l00230"></a>00230 
<a name="l00231"></a>00231 
<a name="l00232"></a>00232 <span class="comment">//The army composition defines attributes for the various garrisons.  The priority reflects how important the sector is</span>
<a name="l00233"></a>00233 <span class="comment">//to the queen, the elite/troop percentages refer to the desired composition of the group.  The admin percentage has recently been</span>
<a name="l00234"></a>00234 <span class="comment">//changed to reflect the starting percentage of the garrison that are administrators.  Note that elite% + troop% = 100, and the admin% is</span>
<a name="l00235"></a>00235 <span class="comment">//not related in this effect.  If the admin% is non-zero, then that garrison is assigned only x% of the force as admins, with NO troops or elites.</span>
<a name="l00236"></a>00236 <span class="comment">//All reinforcements use the composition of the troop/elite for refilling.</span>
<a name="l00237"></a>00237 <span class="comment">//@@@Alex, the send reinforcement composition isn't complete.  Either sends all troops or troops based off of the composition of the source garrison.</span>
<a name="l00238"></a>00238 <span class="comment">//  It is my intention to add this.</span>
<a name="l00239"></a>00239 
<a name="l00240"></a>00240 <span class="comment">//If you change the MAX_STRATEGIC_TEAM_SIZE, then all the garrison sizes (start, desired) will have to be changed accordingly.</span>
<a name="l00241"></a>00241 
<a name="l00242"></a><a class="code" href="Strategic_01AI_8cpp.html#ea7005fc7ef74a7dbbc1cb66d6520a89">00242</a> <a class="code" href="structARMY__COMPOSITION.html">ARMY_COMPOSITION</a> <a class="code" href="Strategic_01AI_8cpp.html#ea7005fc7ef74a7dbbc1cb66d6520a89">gOrigArmyComp</a>[ <a class="code" href="Strategic_01AI_8h.html#a9908284c0827729f14cf9b2489e1479d2a0278d1458eaa8c2bb99d2d4b55f00">NUM_ARMY_COMPOSITIONS</a> ] = 
<a name="l00243"></a>00243 {     <span class="comment">//COMPOSITION                       PRIORITY          ELITE%            TROOP%            ADMIN             DESIRED#          START#            PADDING</span>
<a name="l00244"></a>00244       <span class="comment">//                                                                                                                                              START%</span>
<a name="l00245"></a>00245       <a class="code" href="Strategic_01AI_8h.html#a9908284c0827729f14cf9b2489e147965167f5cd578be3792270cad11996571">QUEEN_DEFENCE</a>,                      100,              100,        0,                0,                32,                     32,                     {0,0,0,0,0,0,0,0,0,0},
<a name="l00246"></a>00246       <a class="code" href="Strategic_01AI_8h.html#a9908284c0827729f14cf9b2489e14793e66ffb942bed0fab28ff4d79f69e15e">MEDUNA_DEFENCE</a>,                     95,                     55,               45,               0,                16,                     20,                     {0,0,0,0,0,0,0,0,0,0},
<a name="l00247"></a>00247       <a class="code" href="Strategic_01AI_8h.html#a9908284c0827729f14cf9b2489e1479a91a1f25028af94853c7302608b93300">MEDUNA_SAMSITE</a>,                     96,                     65,               35,               0,                20,                     20,                     {0,0,0,0,0,0,0,0,0,0},
<a name="l00248"></a>00248       <a class="code" href="Strategic_01AI_8h.html#a9908284c0827729f14cf9b2489e14796cbe0f336c72d76846995060b0336228">LEVEL1_DEFENCE</a>,                     40,                     20,               80,               0,                12,                     20,                     {0,0,0,0,0,0,0,0,0,0},
<a name="l00249"></a>00249       <a class="code" href="Strategic_01AI_8h.html#a9908284c0827729f14cf9b2489e1479a20161605655b8a279cc33b5b05ef22e">LEVEL2_DEFENCE</a>,                     30,                     10,               90,               0,                10,                     20,                     {0,0,0,0,0,0,0,0,0,0},
<a name="l00250"></a>00250       <a class="code" href="Strategic_01AI_8h.html#a9908284c0827729f14cf9b2489e1479af824648f2c39e0defaa7dc6488a18b6">LEVEL3_DEFENCE</a>,                     20,                     5,                95,               0,                8,                      20,                     {0,0,0,0,0,0,0,0,0,0},
<a name="l00251"></a>00251       <a class="code" href="Strategic_01AI_8h.html#a9908284c0827729f14cf9b2489e14797b44688bfd8007385bae029d316559d0">ORTA_DEFENCE</a>,                       90,                     50,               50,               0,                18,                     19,                     {0,0,0,0,0,0,0,0,0,0},
<a name="l00252"></a>00252       <a class="code" href="Strategic_01AI_8h.html#a9908284c0827729f14cf9b2489e1479369481e662febe38487733abf7aef5b5">EAST_GRUMM_DEFENCE</a>,                 80,                     20,               80,               0,                15,                     15,                     {0,0,0,0,0,0,0,0,0,0},
<a name="l00253"></a>00253       <a class="code" href="Strategic_01AI_8h.html#a9908284c0827729f14cf9b2489e1479660c6c6169e3d36cbe913391fca4e965">WEST_GRUMM_DEFENCE</a>,                 70,                     0,                100,        40,               15,                     15,                     {0,0,0,0,0,0,0,0,0,0},
<a name="l00254"></a>00254       <a class="code" href="Strategic_01AI_8h.html#a9908284c0827729f14cf9b2489e1479b67ceeaf4ebbe68cb3f9fad537704930">GRUMM_MINE</a>,                         85,                     25,               75,               45,               15,                     15,                     {0,0,0,0,0,0,0,0,0,0},
<a name="l00255"></a>00255       <a class="code" href="Strategic_01AI_8h.html#a9908284c0827729f14cf9b2489e1479f2728e546e13a252b4ab14fb153f189f">OMERTA_WELCOME_WAGON</a>,         0,                      0,                100,        0,                0,                      3,                      {0,0,0,0,0,0,0,0,0,0},
<a name="l00256"></a>00256       <a class="code" href="Strategic_01AI_8h.html#a9908284c0827729f14cf9b2489e147928698705d2cc7976729cabbd3cfc0ad0">BALIME_DEFENCE</a>,                     60,                     45,               55,               20,               10,                     4,                      {0,0,0,0,0,0,0,0,0,0},
<a name="l00257"></a>00257       <a class="code" href="Strategic_01AI_8h.html#a9908284c0827729f14cf9b2489e1479bb06c2090b5694f6fdae00acf3a6e643">TIXA_PRISON</a>,                        80,                     10,               90,               15,               15,                     15,                     {0,0,0,0,0,0,0,0,0,0},
<a name="l00258"></a>00258       <a class="code" href="Strategic_01AI_8h.html#a9908284c0827729f14cf9b2489e14796da62c7e027b016b16c67e31301da26c">TIXA_SAMSITE</a>,                       85,                     10,               90,               0,                12,                     12,                     {0,0,0,0,0,0,0,0,0,0},
<a name="l00259"></a>00259       <a class="code" href="Strategic_01AI_8h.html#a9908284c0827729f14cf9b2489e1479f024876f6e0853a27e7bc9825c61e1d1">ALMA_DEFENCE</a>,                       74,                     15,               85,               0,                11,                     20,                     {0,0,0,0,0,0,0,0,0,0},
<a name="l00260"></a>00260       <a class="code" href="Strategic_01AI_8h.html#a9908284c0827729f14cf9b2489e1479b2e38a672cdd443d231dd0144a447675">ALMA_MINE</a>,                          80,                     20,               80,               45,               15,                     20,                     {0,0,0,0,0,0,0,0,0,0},
<a name="l00261"></a>00261       <a class="code" href="Strategic_01AI_8h.html#a9908284c0827729f14cf9b2489e1479534fe588a742ddb93c6491a1a05b8b19">CAMBRIA_DEFENCE</a>,              50,                     0,                100,        30,               10,                     6,                      {0,0,0,0,0,0,0,0,0,0},
<a name="l00262"></a>00262       <a class="code" href="Strategic_01AI_8h.html#a9908284c0827729f14cf9b2489e1479ca3d6330b3689d84e632e764cd954482">CAMBRIA_MINE</a>,                       60,                     15,               90,               40,               11,                     6,                      {0,0,0,0,0,0,0,0,0,0},
<a name="l00263"></a>00263       <a class="code" href="Strategic_01AI_8h.html#a9908284c0827729f14cf9b2489e1479d5eb51328841ae73e563e9cee8ec94bd">CHITZENA_DEFENCE</a>,             30,                     0,                100,        75,               12,                     10,                     {0,0,0,0,0,0,0,0,0,0},
<a name="l00264"></a>00264       <a class="code" href="Strategic_01AI_8h.html#a9908284c0827729f14cf9b2489e147996e43035ec922d2c443b88ebe507dfef">CHITZENA_MINE</a>,                      40,                     0,                100,        75,               10,                     10,                     {0,0,0,0,0,0,0,0,0,0},
<a name="l00265"></a>00265       <a class="code" href="Strategic_01AI_8h.html#a9908284c0827729f14cf9b2489e1479cfaa1db54ab034f17aaaa68916edfeda">CHITZENA_SAMSITE</a>,             75,                     10,               90,               0,                9,                      9,                      {0,0,0,0,0,0,0,0,0,0},
<a name="l00266"></a>00266       <a class="code" href="Strategic_01AI_8h.html#a9908284c0827729f14cf9b2489e147943b53436f5a6705040ef2a40564ea80a">DRASSEN_AIRPORT</a>,              30,                     0,                100,        85,               12,                     10,                     {0,0,0,0,0,0,0,0,0,0},
<a name="l00267"></a>00267       <a class="code" href="Strategic_01AI_8h.html#a9908284c0827729f14cf9b2489e1479b8914397662a6ea57af349646e3c9471">DRASSEN_DEFENCE</a>,              20,                     0,                100,        80,               10,                     8,                      {0,0,0,0,0,0,0,0,0,0},
<a name="l00268"></a>00268       <a class="code" href="Strategic_01AI_8h.html#a9908284c0827729f14cf9b2489e14799a73db68e32a680bed112c2b9f556bc4">DRASSEN_MINE</a>,                       35,                     0,                100,        75,               11,                     9,                      {0,0,0,0,0,0,0,0,0,0},
<a name="l00269"></a>00269       <a class="code" href="Strategic_01AI_8h.html#a9908284c0827729f14cf9b2489e1479baa42749b42d296bf85f135b5fbe8fd9">DRASSEN_SAMSITE</a>,              50,                     0,                100,        0,                10,                     10,                     {0,0,0,0,0,0,0,0,0,0},
<a name="l00270"></a>00270       <a class="code" href="Strategic_01AI_8h.html#a9908284c0827729f14cf9b2489e14791d6fc6dded07a09f3dddfd8789f69eb0">ROADBLOCK</a>,                          20,                     2,                98,               0,                8,                      0,                      {0,0,0,0,0,0,0,0,0,0},
<a name="l00271"></a>00271       <a class="code" href="Strategic_01AI_8h.html#a9908284c0827729f14cf9b2489e14795bc62874f1fa7cac6853f847b90333e4">SANMONA_SMALL</a>,                      0,                      0,                0,                0,                0,                      0,                      {0,0,0,0,0,0,0,0,0,0},              
<a name="l00272"></a>00272 };
<a name="l00273"></a>00273 
<a name="l00274"></a>00274 <span class="comment">//Patrol definitions</span>
<a name="l00275"></a>00275 <span class="comment">//NOTE:       A point containing 0 is actually the same as SEC_A1, but because nobody is using SEC_A1 in any </span>
<a name="l00276"></a>00276 <span class="comment">//                      of the patrol groups, I am coding 0 to be ignored.</span>
<a name="l00277"></a>00277 <span class="comment">//NOTE:           Must have at least two points.</span>
<a name="l00278"></a><a class="code" href="Strategic_01AI_8cpp.html#29576ac73bb4a2dfda85c992420d5b76">00278</a> <a class="code" href="structPATROL__GROUP.html">PATROL_GROUP</a> <a class="code" href="Strategic_01AI_8cpp.html#29576ac73bb4a2dfda85c992420d5b76">gOrigPatrolGroup</a>[] =   
<a name="l00279"></a>00279 { <span class="comment">//SIZE    PRIORITY    POINT1            POINT2            POINT3            POINT4            MOD         GROUPID     WEIGHT      PENDING           </span>
<a name="l00280"></a>00280       <span class="comment">//                                                                                                                                                                      DAY100                                                      GROUP ID</span>
<a name="l00281"></a>00281       8,                40,                     <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c66026438e92c65e29d791d0ad97939104092bd2">SEC_B1</a>,           <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643f20dd2b902d50da8611d3356839fea3e">SEC_C1</a>,           <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643a59e62f91488139db76dc41823e5c31b">SEC_C3</a>,           <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c66026430148bb2145c541f3f93aff046ac07b59">SEC_A3</a>,           -1,               0,                0,                0,                      {0,0,0,0,0,0,0,0,0,0},
<a name="l00282"></a>00282       6,                35,                     <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643c4b685e1b65a4050b8acb9f230f696ee">SEC_B4</a>,           <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c660264381acd51b281a7e63d1d422c2c205cea2">SEC_B7</a>,           <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c66026438db27870636f75a7ec9bcfbceb2639cc">SEC_C7</a>,           0,                      -1,               0,                0,                0,                      {0,0,0,0,0,0,0,0,0,0},
<a name="l00283"></a>00283       6,                25,                     <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643ebf1f72e009221220927c65462d87ef7">SEC_A8</a>,           <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c660264376ead424208b0f7b82789d2af4ea047f">SEC_B8</a>,           <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643ba395ded243f36de40e4bbc561c3f43c">SEC_B9</a>,           0,                      -1,               0,                0,                0,                      {0,0,0,0,0,0,0,0,0,0},
<a name="l00284"></a>00284       6,                30,                     <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c660264377b756653ad6ae10078f97c9154f2132">SEC_B10</a>,    <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c66026436813350ef098cbfd7142d60709e88f10">SEC_B12</a>,    0,                      0,                      -1,               0,                0,                0,                      {0,0,0,0,0,0,0,0,0,0},
<a name="l00285"></a>00285       7,                45,                     <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643098c6f1508e60bbcfa8e08649c465980">SEC_A11</a>,    <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c66026439a7b896d123699555bfbd5dce3f20f6c">SEC_A14</a>,    <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643b3710d366ebaae2239b96773f4a26e76">SEC_D14</a>,    0,                      -1,               0,                0,                0,                      {0,0,0,0,0,0,0,0,0,0},
<a name="l00286"></a>00286       <span class="comment">//5   </span>
<a name="l00287"></a>00287       6,                50,                     <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643365d66c741fcb9f42218a011aafca5cf">SEC_C8</a>,           <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c66026439380021ec608df0836887916a001cd9f">SEC_C9</a>,           <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643171e09c8391255f3cba54e8f8ff8e8b3">SEC_D9</a>,           0,                      -1,               0,                0,                0,                      {0,0,0,0,0,0,0,0,0,0},
<a name="l00288"></a>00288       12,               55,                     <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c66026434072aaa532924f839531d75b59c44f29">SEC_D3</a>,           <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c66026430784f8a93d9bfa6fbb81f99239d11cc2">SEC_G3</a>,           0,                      0,                      -1,               0,                0,                0,                      {0,0,0,0,0,0,0,0,0,0},
<a name="l00289"></a>00289       10,               50,                     <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c660264318515269a42122c79ba68bcd0b920cd0">SEC_D6</a>,           <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643dc0ea91a1c914af353cc64012963f2c9">SEC_D7</a>,           <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c66026435f8960e588bcb0917ab2a41ed39fb5d9">SEC_F7</a>,           0,                      -1,               0,                0,                0,                      {0,0,0,0,0,0,0,0,0,0},
<a name="l00290"></a>00290       10,               55,                     <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c660264327b845e42ba997dc52c141e56779478c">SEC_E8</a>,           <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643a2e1f5d6e7f190ec1490eb079ded311a">SEC_E11</a>,    <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c660264320162852300a320c09f81949d38a4217">SEC_F11</a>,    0,                      -1,               0,                0,                0,                      {0,0,0,0,0,0,0,0,0,0},
<a name="l00291"></a>00291       10,               60,                     <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643e2e97d2bf954c54737a4e5f15507d2ba">SEC_E12</a>,    <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c660264361ed58c75d583d3a489bcd979ea28bcb">SEC_E15</a>,    0,                      0,                      -1,               0,                0,                0,                      {0,0,0,0,0,0,0,0,0,0},
<a name="l00292"></a>00292       <span class="comment">//10</span>
<a name="l00293"></a>00293       12,               60,                     <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643c574685ddadb46cde3f6bc8bf340ab6f">SEC_G4</a>,           <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c660264353e9a360c4879de61480075d81dedbbb">SEC_G7</a>,           0,                      0,                      -1,               0,                0,                0,                      {0,0,0,0,0,0,0,0,0,0},
<a name="l00294"></a>00294       12,               65,                     <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643de0a0de008cc76832a39bd4388175a4b">SEC_G10</a>,    <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c66026431c12d1d8441e864cf41c8d3422760358">SEC_G12</a>,    <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643a2bf25590854d9290c135dcf1439663d">SEC_F12</a>,    0,                      -1,               0,                0,                0,                      {0,0,0,0,0,0,0,0,0,0},
<a name="l00295"></a>00295       12,               65,                     <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c66026435a1de6a2897ce565364c097c7170ada0">SEC_G13</a>,    <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643d3000efffbb7458befafbae9b5c927fd">SEC_G15</a>,    0,                      0,                      -1,               0,                0,                0,                      {0,0,0,0,0,0,0,0,0,0},
<a name="l00296"></a>00296       10,               65,                     <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c660264308e60fcd61ad5c6b7d38fe728125468e">SEC_H15</a>,    <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643165890b6bada7df5a3c7494144bf6b17">SEC_J15</a>,    0,                      0,                      -1,               0,                0,                0,                      {0,0,0,0,0,0,0,0,0,0},
<a name="l00297"></a>00297       14,               65,                     <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643265a89ed8f7a5967377e31922c7c91d1">SEC_H12</a>,    <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643a6c9941aad2fb7d8cda07b9272746306">SEC_J12</a>,    <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643521c52619249a7f28f637882cbffba2f">SEC_J13</a>,    0,                      -1,               0,                0,                0,                      {0,0,0,0,0,0,0,0,0,0},
<a name="l00298"></a>00298       <span class="comment">//15</span>
<a name="l00299"></a>00299       13,               70,                     <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c660264374355821705df24bff50e8d681dce273">SEC_H9</a>,           <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c66026435aa6b22ac6c8e555794af1e017436863">SEC_I9</a>,           <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643e2dc1a8e75fde206fbece390b8149eca">SEC_I10</a>,    <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c660264371a6a8775011460e084888d3a8081153">SEC_J10</a>,    -1,               0,                0,                0,                      {0,0,0,0,0,0,0,0,0,0},
<a name="l00300"></a>00300       11,               70,                     <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643afd97f92e51cfd354fa49474ce69d85f">SEC_K11</a>,    <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c66026430ffe84dc504c1fc21bcb7b2da4c60979">SEC_K14</a>,    <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643a05c7598f53eec8740a10141c850d547">SEC_J14</a>,    0,                      -1,               0,                0,                0,                      {0,0,0,0,0,0,0,0,0,0},
<a name="l00301"></a>00301       12,               75,                     <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643b10ba3f4d149fd22a1d7456cc458d009">SEC_J2</a>,           <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c660264328211c3d5895f6752c49afce7e2c3c19">SEC_K2</a>,           0,                      0,                      -1,               0,                0,                0,                      {0,0,0,0,0,0,0,0,0,0},
<a name="l00302"></a>00302       12,               80,                     <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c66026433c69f8fd7a337039e5b24166ee8ac210">SEC_I3</a>,           <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643dc69a2b0492544eae6b385d044c27ccc">SEC_J3</a>,           0,                      0,                      -1,               0,                0,                0,                      {0,0,0,0,0,0,0,0,0,0},
<a name="l00303"></a>00303       12,               80,                     <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c66026436099d941bce97706cf14aef8dec103f9">SEC_J6</a>,           <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c66026432807fd1cf7d70db2306f707626f09f39">SEC_K6</a>,           0,                      0,                      -1,               0,                0,                0,                      {0,0,0,0,0,0,0,0,0,0},
<a name="l00304"></a>00304       <span class="comment">//20</span>
<a name="l00305"></a>00305       13,               85,                     <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643ea1de1902b02be3d76804b5e2da74e91">SEC_K7</a>,           <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c660264351604b1e21db80042d746df80feec4d6">SEC_K10</a>,    0,                      0,                      -1,               0,                0,                0,                      {0,0,0,0,0,0,0,0,0,0},
<a name="l00306"></a>00306       12,               90,                     <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c66026433ed1cc422ab483fe45f31a1273974f5e">SEC_L10</a>,    <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c66026432f7759969cf7f3f38227ead8f818cccc">SEC_M10</a>,    0,                      0,                      -1,               0,                0,                0,                      {0,0,0,0,0,0,0,0,0,0},
<a name="l00307"></a>00307       12,               90,                     <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643037631c15cb648c8b359e7fddca8b699">SEC_N9</a>,           <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643f24df3c6839a41b088e77ba1882cf3d3">SEC_N10</a>,    0,                      0,                      -1,               0,                0,                0,                      {0,0,0,0,0,0,0,0,0,0},
<a name="l00308"></a>00308       12,               80,                     <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643b3b04c53e6e5eaf1bece2eb7d10ca255">SEC_L7</a>,           <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c66026435ed3c5fa2c80caf7d791173c2b9b0c9c">SEC_L8</a>,           <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c66026435c78034f69c3d29fdc651df8a1c484ae">SEC_M8</a>,           <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c66026432f979fa2b937dca97030338fb6e281bf">SEC_M9</a>,           -1,               0,                0,                0,                      {0,0,0,0,0,0,0,0,0,0},
<a name="l00309"></a>00309       14,               80,                     <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643ba99b9a0f226090c79368e6b45295d2d">SEC_H4</a>,           <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c66026430ad41d8758d8019a5a7cff75a1cec776">SEC_H5</a>,           <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643cbae04f3b5aaa3796dbb0fccd48324ab">SEC_I5</a>,           0,                      -1,               0,                0,                0,                      {0,0,0,0,0,0,0,0,0,0},
<a name="l00310"></a>00310       <span class="comment">//25</span>
<a name="l00311"></a>00311       7,                40,                     <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643736e2330a238108b0f2443457d4ee2c5">SEC_D4</a>,           <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643615f9a3473a84b3ecb53d4f114fe1ca0">SEC_E4</a>,           <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643fa49f64fb4f9e0ed1956445fd04be863">SEC_E5</a>,           0,                      -1,               0,                0,                0,                      {0,0,0,0,0,0,0,0,0,0},
<a name="l00312"></a>00312       7,                50,                     <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c66026431f4b5590738e34207f8594e1c2f6f444">SEC_C10</a>,    <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c660264383dcbf9d7d04b2bb0520a80743c1011c">SEC_C11</a>,    <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c66026438539a28e792b6bca2246a4a88699983a">SEC_D11</a>,    <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c660264330c1a637430db2a5433858b2f9cb2331">SEC_D12</a>,    -1,               0,                0,                0,                      {0,0,0,0,0,0,0,0,0,0},
<a name="l00313"></a>00313       8,                40,                     <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643ea63bd48829e842e33287974b24e2478">SEC_A15</a>,    <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643dc9b41420c0c79a5935a7170552a4375">SEC_C15</a>,    <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c66026435387a4dca1213ab7b7bbe9b7799048a1">SEC_C16</a>,    0,                      -1,               0,                0,                0,                      {0,0,0,0,0,0,0,0,0,0},
<a name="l00314"></a>00314       12,               30,                     <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c66026434ab4ec0c6f383b9e1246fb0ce421e503">SEC_L13</a>,    <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c66026436e44be7ade784d2137ae8efecad69485">SEC_M13</a>,    <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643eb68b9d52110e55dcfd32c8ce93c0889">SEC_M14</a>,    <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c660264377a5240b7bd3bfcb3f36d470f5dcd183">SEC_L14</a>,    -1,               0,                0,                0,                      {0,0,0,0,0,0,0,0,0,0},
<a name="l00315"></a>00315       <span class="comment">//29</span>
<a name="l00316"></a>00316 };
<a name="l00317"></a>00317 <span class="preprocessor">#define PATROL_GROUPS 29</span>
<a name="l00318"></a>00318 <span class="preprocessor"></span>
<a name="l00319"></a>00319 
<a name="l00320"></a>00320 
<a name="l00321"></a><a class="code" href="Strategic_01AI_8cpp.html#1e061009151dfe20eccb5f27432fab59">00321</a> <a class="code" href="structGARRISON__GROUP.html">GARRISON_GROUP</a> <a class="code" href="Strategic_01AI_8cpp.html#1e061009151dfe20eccb5f27432fab59">gOrigGarrisonGroup</a>[] = 
<a name="l00322"></a>00322 { <span class="comment">//SECTOR  MILITARY                                              WEIGHT      UNUSED</span>
<a name="l00323"></a>00323       <span class="comment">//                      COMPOSITION                                                             GROUP ID</span>
<a name="l00324"></a>00324       <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c66026438a2eb9999a6ad7c69c9ddbe2d95696ca">SEC_P3</a>,           <a class="code" href="Strategic_01AI_8h.html#a9908284c0827729f14cf9b2489e147965167f5cd578be3792270cad11996571">QUEEN_DEFENCE</a>,                            0,                0,                {0,0,0,0,0,0,0,0,0,0},
<a name="l00325"></a>00325       <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643e6f2813ad83edbf7f6e4e9069e9b5af9">SEC_O3</a>,           <a class="code" href="Strategic_01AI_8h.html#a9908284c0827729f14cf9b2489e14793e66ffb942bed0fab28ff4d79f69e15e">MEDUNA_DEFENCE</a>,                           0,                0,                {0,0,0,0,0,0,0,0,0,0},
<a name="l00326"></a>00326       <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c66026430ee75d7f56db66473f34db57c8dbf564">SEC_O4</a>,           MEDUNA_DEFENCE,                           0,                0,                {0,0,0,0,0,0,0,0,0,0},
<a name="l00327"></a>00327       <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643a36f934059c25f9a7548ad011f65ec3b">SEC_N3</a>,           MEDUNA_DEFENCE,                           0,                0,                {0,0,0,0,0,0,0,0,0,0},
<a name="l00328"></a>00328       <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643a1f02b8d49f15ade9e5c53145d967651">SEC_N4</a>,           <a class="code" href="Strategic_01AI_8h.html#a9908284c0827729f14cf9b2489e1479a91a1f25028af94853c7302608b93300">MEDUNA_SAMSITE</a>,                           0,                0,                {0,0,0,0,0,0,0,0,0,0},
<a name="l00329"></a>00329       <span class="comment">//5</span>
<a name="l00330"></a>00330       <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c66026436e2a46748c66280f0d844e72da8249da">SEC_N5</a>,           MEDUNA_DEFENCE,                           0,                0,                {0,0,0,0,0,0,0,0,0,0},
<a name="l00331"></a>00331       <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643dde62f9cfd7206a31e8b07ab87d3d30c">SEC_M3</a>,           <a class="code" href="Strategic_01AI_8h.html#a9908284c0827729f14cf9b2489e14796cbe0f336c72d76846995060b0336228">LEVEL1_DEFENCE</a>,                           0,                0,                {0,0,0,0,0,0,0,0,0,0},
<a name="l00332"></a>00332       <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c660264324a1050600dca849883f678c80642038">SEC_M4</a>,           LEVEL1_DEFENCE,                           0,                0,                {0,0,0,0,0,0,0,0,0,0},
<a name="l00333"></a>00333       <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643ca7cbcf345ac591537a9a821f5862745">SEC_M5</a>,           LEVEL1_DEFENCE,                           0,                0,                {0,0,0,0,0,0,0,0,0,0},
<a name="l00334"></a>00334       <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c66026434817f170f2f801a9ca29d6fe31666175">SEC_N6</a>,           LEVEL1_DEFENCE,                           0,                0,                {0,0,0,0,0,0,0,0,0,0},
<a name="l00335"></a>00335       <span class="comment">//10</span>
<a name="l00336"></a>00336       <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643fd92a0fa82d5afb66be6ec70e73fd568">SEC_M2</a>,           <a class="code" href="Strategic_01AI_8h.html#a9908284c0827729f14cf9b2489e1479a20161605655b8a279cc33b5b05ef22e">LEVEL2_DEFENCE</a>,                           0,                0,                {0,0,0,0,0,0,0,0,0,0},
<a name="l00337"></a>00337       <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c660264360af66f9f47d1c713b2f1af90bc85f9f">SEC_L3</a>,           LEVEL2_DEFENCE,                           0,                0,                {0,0,0,0,0,0,0,0,0,0},
<a name="l00338"></a>00338       <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c66026436475958bbc8ca27600e6d6740a268595">SEC_L4</a>,           LEVEL2_DEFENCE,                           0,                0,                {0,0,0,0,0,0,0,0,0,0},
<a name="l00339"></a>00339       <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643b634c92e51f409e639c3afd4b982207d">SEC_L5</a>,           LEVEL2_DEFENCE,                           0,                0,                {0,0,0,0,0,0,0,0,0,0},
<a name="l00340"></a>00340       <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643114f20f76469e4d457cc2f069da1888e">SEC_M6</a>,           LEVEL2_DEFENCE,                           0,                0,                {0,0,0,0,0,0,0,0,0,0},
<a name="l00341"></a>00341       <span class="comment">//15</span>
<a name="l00342"></a>00342       <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c660264395584191ad2ce3459b97befd503aeb7c">SEC_N7</a>,           LEVEL1_DEFENCE,                           0,                0,                {0,0,0,0,0,0,0,0,0,0},
<a name="l00343"></a>00343       <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643e5aae8939faf97f1d46b0ed545894946">SEC_L2</a>,           <a class="code" href="Strategic_01AI_8h.html#a9908284c0827729f14cf9b2489e1479af824648f2c39e0defaa7dc6488a18b6">LEVEL3_DEFENCE</a>,                           0,                0,                {0,0,0,0,0,0,0,0,0,0},
<a name="l00344"></a>00344       <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643f012db5755f2b173f4cf9d9a293b520c">SEC_K3</a>,           LEVEL3_DEFENCE,                           0,                0,                {0,0,0,0,0,0,0,0,0,0},
<a name="l00345"></a>00345       <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643de9412ae960676a2e02b994e8077c7c0">SEC_K5</a>,           LEVEL3_DEFENCE,                           0,                0,                {0,0,0,0,0,0,0,0,0,0},
<a name="l00346"></a>00346       <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643780ee35108a1a3ff3893168ca76893a4">SEC_L6</a>,           LEVEL3_DEFENCE,                           0,                0,                {0,0,0,0,0,0,0,0,0,0},
<a name="l00347"></a>00347       <span class="comment">//20</span>
<a name="l00348"></a>00348       <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643ecb78464771c29d5bcab53a0d86dc9c7">SEC_M7</a>,           LEVEL3_DEFENCE,                           0,                0,                {0,0,0,0,0,0,0,0,0,0},
<a name="l00349"></a>00349       <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c660264377c4307017fe35ee4d95b152f6f60223">SEC_N8</a>,           LEVEL3_DEFENCE,                           0,                0,                {0,0,0,0,0,0,0,0,0,0},
<a name="l00350"></a>00350       <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c660264373369bc7daa7c19d5ebbfa29cf5aff8e">SEC_K4</a>,           <a class="code" href="Strategic_01AI_8h.html#a9908284c0827729f14cf9b2489e14797b44688bfd8007385bae029d316559d0">ORTA_DEFENCE</a>,                                   0,                0,                {0,0,0,0,0,0,0,0,0,0},
<a name="l00351"></a>00351       <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643017ca621475f0a51e675ed5e1e87d3f6">SEC_G1</a>,           <a class="code" href="Strategic_01AI_8h.html#a9908284c0827729f14cf9b2489e1479660c6c6169e3d36cbe913391fca4e965">WEST_GRUMM_DEFENCE</a>,                 0,                0,                {0,0,0,0,0,0,0,0,0,0},
<a name="l00352"></a>00352       <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c660264309137054660d73ef1f5301d5ff96144b">SEC_G2</a>,           <a class="code" href="Strategic_01AI_8h.html#a9908284c0827729f14cf9b2489e1479369481e662febe38487733abf7aef5b5">EAST_GRUMM_DEFENCE</a>,                 0,                0,                {0,0,0,0,0,0,0,0,0,0},
<a name="l00353"></a>00353       <span class="comment">//25</span>
<a name="l00354"></a>00354       <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643a24273723441a8bfdfc7367e2d2a29b1">SEC_H1</a>,           WEST_GRUMM_DEFENCE,                 0,                0,                {0,0,0,0,0,0,0,0,0,0},
<a name="l00355"></a>00355       <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c660264379c7198e0d00238a4c3cfe6454fa6936">SEC_H2</a>,           EAST_GRUMM_DEFENCE,                 0,                0,                {0,0,0,0,0,0,0,0,0,0},
<a name="l00356"></a>00356       <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643c6ced202c824aa65d9d2f53922400fa1">SEC_H3</a>,           <a class="code" href="Strategic_01AI_8h.html#a9908284c0827729f14cf9b2489e1479b67ceeaf4ebbe68cb3f9fad537704930">GRUMM_MINE</a>,                                     0,                0,                {0,0,0,0,0,0,0,0,0,0},
<a name="l00357"></a>00357       <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c660264391d2dc0712c8c1f845d2997d13220831">SEC_A9</a>,           <a class="code" href="Strategic_01AI_8h.html#a9908284c0827729f14cf9b2489e1479f2728e546e13a252b4ab14fb153f189f">OMERTA_WELCOME_WAGON</a>,         0,                0,                {0,0,0,0,0,0,0,0,0,0},
<a name="l00358"></a>00358       <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c66026437f0f7646790ef9e89f4fae8f11c2f30a">SEC_L11</a>,    <a class="code" href="Strategic_01AI_8h.html#a9908284c0827729f14cf9b2489e147928698705d2cc7976729cabbd3cfc0ad0">BALIME_DEFENCE</a>,                           0,                0,                {0,0,0,0,0,0,0,0,0,0},
<a name="l00359"></a>00359       <span class="comment">//30</span>
<a name="l00360"></a>00360       <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c660264361fb89a0c647c8f639c74c64df117097">SEC_L12</a>,    BALIME_DEFENCE,                           0,                0,                {0,0,0,0,0,0,0,0,0,0},
<a name="l00361"></a>00361       <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643104ad166b8bc92969059dd62d784db11">SEC_J9</a>,           <a class="code" href="Strategic_01AI_8h.html#a9908284c0827729f14cf9b2489e1479bb06c2090b5694f6fdae00acf3a6e643">TIXA_PRISON</a>,                                    0,                0,                {0,0,0,0,0,0,0,0,0,0},
<a name="l00362"></a>00362       <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c660264303e0da7939fba7e3ffd739064bee4abd">SEC_I8</a>,           <a class="code" href="Strategic_01AI_8h.html#a9908284c0827729f14cf9b2489e14796da62c7e027b016b16c67e31301da26c">TIXA_SAMSITE</a>,                                   0,                0,                {0,0,0,0,0,0,0,0,0,0},
<a name="l00363"></a>00363       <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c66026438001804c2db19d8207f0a9c3831c1641">SEC_H13</a>,    <a class="code" href="Strategic_01AI_8h.html#a9908284c0827729f14cf9b2489e1479f024876f6e0853a27e7bc9825c61e1d1">ALMA_DEFENCE</a>,                                   0,                0,                {0,0,0,0,0,0,0,0,0,0},
<a name="l00364"></a>00364       <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c660264366323a5525ca3cd54932950695c8568f">SEC_H14</a>,    ALMA_DEFENCE,                                   0,                0,                {0,0,0,0,0,0,0,0,0,0},
<a name="l00365"></a>00365       <span class="comment">//35</span>
<a name="l00366"></a>00366       <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c66026434c49cae4ea3baeedd77443968a3166c0">SEC_I13</a>,    ALMA_DEFENCE,                                   0,                0,                {0,0,0,0,0,0,0,0,0,0},
<a name="l00367"></a>00367       <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643c236a562a9b38d2ee3c7d7ed06e88faf">SEC_I14</a>,    <a class="code" href="Strategic_01AI_8h.html#a9908284c0827729f14cf9b2489e1479b2e38a672cdd443d231dd0144a447675">ALMA_MINE</a>,                                      0,                0,                {0,0,0,0,0,0,0,0,0,0},
<a name="l00368"></a>00368       <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643e0a7185e05270b8ffacff9816031ae8e">SEC_F8</a>,           <a class="code" href="Strategic_01AI_8h.html#a9908284c0827729f14cf9b2489e1479534fe588a742ddb93c6491a1a05b8b19">CAMBRIA_DEFENCE</a>,                    0,                0,                {0,0,0,0,0,0,0,0,0,0},
<a name="l00369"></a>00369       <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643a20fa3a3e3da7996c9d5fab6d2fb6e84">SEC_F9</a>,           CAMBRIA_DEFENCE,                    0,                0,                {0,0,0,0,0,0,0,0,0,0},
<a name="l00370"></a>00370       <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643d037ec147301d1498cd5ea0307da2d34">SEC_G8</a>,           CAMBRIA_DEFENCE,                    0,                0,                {0,0,0,0,0,0,0,0,0,0},
<a name="l00371"></a>00371       <span class="comment">//40</span>
<a name="l00372"></a>00372       <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643fa4b17f23c10d54767184540803edce8">SEC_G9</a>,           CAMBRIA_DEFENCE,                    0,                0,                {0,0,0,0,0,0,0,0,0,0},
<a name="l00373"></a>00373       <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643897f1cfaae4b38d8022feec3521887df">SEC_H8</a>,           <a class="code" href="Strategic_01AI_8h.html#a9908284c0827729f14cf9b2489e1479ca3d6330b3689d84e632e764cd954482">CAMBRIA_MINE</a>,                                   0,                0,                {0,0,0,0,0,0,0,0,0,0},
<a name="l00374"></a>00374       <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643ddb3565a81ff778bd1d7d0720e7beb1f">SEC_A2</a>,           <a class="code" href="Strategic_01AI_8h.html#a9908284c0827729f14cf9b2489e1479d5eb51328841ae73e563e9cee8ec94bd">CHITZENA_DEFENCE</a>,                   0,                0,                {0,0,0,0,0,0,0,0,0,0},
<a name="l00375"></a>00375       <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643a9584a4fb3b1d601490ee1f4703cdab2">SEC_B2</a>,           <a class="code" href="Strategic_01AI_8h.html#a9908284c0827729f14cf9b2489e147996e43035ec922d2c443b88ebe507dfef">CHITZENA_MINE</a>,                            0,                0,                {0,0,0,0,0,0,0,0,0,0},
<a name="l00376"></a>00376       <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c66026434ecb02d9115f4d616bfb077c756523a9">SEC_D2</a>,           <a class="code" href="Strategic_01AI_8h.html#a9908284c0827729f14cf9b2489e1479cfaa1db54ab034f17aaaa68916edfeda">CHITZENA_SAMSITE</a>,                   0,                0,                {0,0,0,0,0,0,0,0,0,0},
<a name="l00377"></a>00377       <span class="comment">//45</span>
<a name="l00378"></a>00378       <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c66026436d911e0461303edb9fe227735f787c22">SEC_B13</a>,    <a class="code" href="Strategic_01AI_8h.html#a9908284c0827729f14cf9b2489e147943b53436f5a6705040ef2a40564ea80a">DRASSEN_AIRPORT</a>,                    0,                0,                {0,0,0,0,0,0,0,0,0,0},
<a name="l00379"></a>00379       <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643e84863fb1442cf38c7311021990a9bc3">SEC_C13</a>,    <a class="code" href="Strategic_01AI_8h.html#a9908284c0827729f14cf9b2489e1479b8914397662a6ea57af349646e3c9471">DRASSEN_DEFENCE</a>,                    0,                0,                {0,0,0,0,0,0,0,0,0,0},
<a name="l00380"></a>00380       <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c66026435b0fbd8598540769dcf8f24e3134f48c">SEC_D13</a>,    <a class="code" href="Strategic_01AI_8h.html#a9908284c0827729f14cf9b2489e14799a73db68e32a680bed112c2b9f556bc4">DRASSEN_MINE</a>,                                   0,                0,                {0,0,0,0,0,0,0,0,0,0},
<a name="l00381"></a>00381       <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643a6b93766e638fc1877d78e6209cfb7dc">SEC_D15</a>,    <a class="code" href="Strategic_01AI_8h.html#a9908284c0827729f14cf9b2489e1479baa42749b42d296bf85f135b5fbe8fd9">DRASSEN_SAMSITE</a>,                    0,                0,                {0,0,0,0,0,0,0,0,0,0},
<a name="l00382"></a>00382       <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c66026431c12d1d8441e864cf41c8d3422760358">SEC_G12</a>,    <a class="code" href="Strategic_01AI_8h.html#a9908284c0827729f14cf9b2489e14791d6fc6dded07a09f3dddfd8789f69eb0">ROADBLOCK</a>,                                      0,                0,                {0,0,0,0,0,0,0,0,0,0},
<a name="l00383"></a>00383       <span class="comment">//50</span>
<a name="l00384"></a>00384       <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c66026432f7759969cf7f3f38227ead8f818cccc">SEC_M10</a>,    ROADBLOCK,                                      0,                0,                {0,0,0,0,0,0,0,0,0,0},
<a name="l00385"></a>00385       <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c660264348b3e3b5494c68e9cde06c99b88fe5fb">SEC_G6</a>,           ROADBLOCK,                                      0,                0,                {0,0,0,0,0,0,0,0,0,0},
<a name="l00386"></a>00386       <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c66026439380021ec608df0836887916a001cd9f">SEC_C9</a>,           ROADBLOCK,                                      0,                0,                {0,0,0,0,0,0,0,0,0,0},
<a name="l00387"></a>00387       <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c660264351604b1e21db80042d746df80feec4d6">SEC_K10</a>,    ROADBLOCK,                                      0,                0,                {0,0,0,0,0,0,0,0,0,0},
<a name="l00388"></a>00388       <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c660264353e9a360c4879de61480075d81dedbbb">SEC_G7</a>,           ROADBLOCK,                                      0,                0,                {0,0,0,0,0,0,0,0,0,0},
<a name="l00389"></a>00389       <span class="comment">//55</span>
<a name="l00390"></a>00390       <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c66026430784f8a93d9bfa6fbb81f99239d11cc2">SEC_G3</a>,           ROADBLOCK,                                      0,                0,                {0,0,0,0,0,0,0,0,0,0},
<a name="l00391"></a>00391       <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643b4a9c6bd17076909f1625214f756c093">SEC_C5</a>,           <a class="code" href="Strategic_01AI_8h.html#a9908284c0827729f14cf9b2489e14795bc62874f1fa7cac6853f847b90333e4">SANMONA_SMALL</a>,                            0,                0,                {0,0,0,0,0,0,0,0,0,0},
<a name="l00392"></a>00392       <span class="comment">//57</span>
<a name="l00393"></a>00393 };
<a name="l00394"></a>00394 
<a name="l00395"></a>00395 <span class="comment">//Various decision functions and utils to help make those decisions.</span>
<a name="l00396"></a>00396 <a class="code" href="Types_8h.html#112e3146cb38b6ee95e64d85842e380a">BOOLEAN</a> <a class="code" href="Strategic_01AI_8cpp.html#73501d5da96c2872b48fa331b1585ff2">AdjacentSectorIsImportantAndUndefended</a>( <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubSectorID );
<a name="l00397"></a>00397 <a class="code" href="Types_8h.html#112e3146cb38b6ee95e64d85842e380a">BOOLEAN</a> <a class="code" href="Strategic_01AI_8cpp.html#b9410f4eb7a3b3f3274ecb37bdd3bdd1">HandleEmptySectorNoticedByPatrolGroup</a>( <a class="code" href="structGROUP.html">GROUP</a> *pGroup, <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubEmptySectorID );
<a name="l00398"></a>00398 <span class="keywordtype">void</span> <a class="code" href="Strategic_01AI_8cpp.html#32c627631f162fa5a39aaedb01970a42">HandleEmptySectorNoticedByGarrison</a>( <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubGarrisonSectorID, <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubEmptySectorID );
<a name="l00399"></a>00399 
<a name="l00400"></a>00400 <a class="code" href="Types_8h.html#112e3146cb38b6ee95e64d85842e380a">BOOLEAN</a> <a class="code" href="Strategic_01AI_8cpp.html#8d10ec503f28c85754a6f32bd3cde826">PlayerForceTooStrong</a>( <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubSectorID, <a class="code" href="Types_8h.html#09f1a1fb2293e33483cc8d44aefb1eb1">UINT16</a> usOffensePoints, <a class="code" href="Types_8h.html#09f1a1fb2293e33483cc8d44aefb1eb1">UINT16</a> *pusDefencePoints );
<a name="l00401"></a>00401 <span class="keywordtype">void</span> <a class="code" href="Strategic_01AI_8cpp.html#e521ef3ef604f1b3f3af7308b87a5e68">RequestAttackOnSector</a>( <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubSectorID, <a class="code" href="Types_8h.html#09f1a1fb2293e33483cc8d44aefb1eb1">UINT16</a> usDefencePoints );
<a name="l00402"></a>00402 <span class="keywordtype">void</span> <a class="code" href="Strategic_01AI_8cpp.html#5742912187ab0b5495a1cc8894341057">RequestHighPriorityStagingGroupReinforcements</a>( <a class="code" href="structGROUP.html">GROUP</a> *pGroup );
<a name="l00403"></a>00403 <span class="keywordtype">void</span> <a class="code" href="Strategic_01AI_8cpp.html#2fa0b96eae51a7e2732753424608b833">RequestHighPriorityGarrisonReinforcements</a>( <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a> iGarrisonID, <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubSoldiersRequested );
<a name="l00404"></a>00404 
<a name="l00405"></a>00405 <a class="code" href="Types_8h.html#112e3146cb38b6ee95e64d85842e380a">BOOLEAN</a> <a class="code" href="Strategic_01AI_8cpp.html#54faeb29802e301239709cc407576cd1">GarrisonCanProvideMinimumReinforcements</a>( <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a> iGarrisonID );
<a name="l00406"></a>00406 <a class="code" href="Types_8h.html#112e3146cb38b6ee95e64d85842e380a">BOOLEAN</a> <a class="code" href="Strategic_01AI_8cpp.html#acc69c670c9bac13b5e41484b4648552">GarrisonRequestingMinimumReinforcements</a>( <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a> iGarrisonID );
<a name="l00407"></a>00407 <a class="code" href="Types_8h.html#112e3146cb38b6ee95e64d85842e380a">BOOLEAN</a> <a class="code" href="Strategic_01AI_8cpp.html#6e02787740c45d04fbbd7ca50ca23064">PatrolRequestingMinimumReinforcements</a>( <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a> iPatrolID );
<a name="l00408"></a>00408 
<a name="l00409"></a>00409 <span class="comment">//These are the chance functions that the AI uses to see player's/militia in adjacent sectors.</span>
<a name="l00410"></a>00410 <a class="code" href="Types_8h.html#112e3146cb38b6ee95e64d85842e380a">BOOLEAN</a> <a class="code" href="Strategic_01AI_8cpp.html#cfe2abd9df33e8d3ae8f0bf9a6f82c93">AttemptToNoticeAdjacentGroupSucceeds</a>();
<a name="l00411"></a>00411 <a class="code" href="Types_8h.html#112e3146cb38b6ee95e64d85842e380a">BOOLEAN</a> <a class="code" href="Strategic_01AI_8cpp.html#f56d1e63c211df4c0082157c73603a78">AttemptToNoticeEmptySectorSucceeds</a>();
<a name="l00412"></a>00412 
<a name="l00413"></a>00413 <span class="keywordtype">void</span> <a class="code" href="Strategic_01AI_8cpp.html#989554da82194ffa19f0648cb09a26c4">EliminateSurplusTroopsForGarrison</a>( <a class="code" href="structGROUP.html">GROUP</a> *pGroup, <a class="code" href="structSECTORINFO.html">SECTORINFO</a> *pSector );
<a name="l00414"></a>00414 <span class="keywordtype">void</span> <a class="code" href="Strategic_01AI_8cpp.html#02069a813bd2498057799d302da2c08f">ReinitializeUnvisitedGarrisons</a>();
<a name="l00415"></a>00415 
<a name="l00416"></a>00416 <span class="comment">//Records any decisions that I deem important enough into an automatically appending AI log file called</span>
<a name="l00417"></a>00417 <span class="comment">//"Strategic Decisions.txt" in the JA2\Data directory.  This also records the time that each log entry </span>
<a name="l00418"></a>00418 <span class="comment">//was made.</span>
<a name="l00419"></a>00419 <span class="preprocessor">#ifdef JA2BETAVERSION</span>
<a name="l00420"></a>00420 <span class="preprocessor"></span>
<a name="l00421"></a>00421 <span class="keywordtype">void</span> <a class="code" href="Strategic_01AI_8cpp.html#984e97af1f29d3b417cc5bdcd126cfca">LogStrategicEvent</a>( <span class="keywordtype">char</span> * <a class="code" href="Button_01System_8cpp.html#ac22642f3052cc77a6991a262ce4ad23">str</a>, ... ); <span class="comment">//adds a timestamp.</span>
<a name="l00422"></a>00422 <span class="keywordtype">void</span> <a class="code" href="Strategic_01AI_8cpp.html#d90b3ef039d953753e7b2637c16229cf">LogStrategicMsg</a>( <span class="keywordtype">char</span> * <a class="code" href="Button_01System_8cpp.html#ac22642f3052cc77a6991a262ce4ad23">str</a>, ... ); <span class="comment">//doesn't use the time stamp</span>
<a name="l00423"></a>00423 
<a name="l00424"></a>00424 <span class="keywordtype">void</span> <a class="code" href="Strategic_01AI_8cpp.html#2b956b276d118fb0236c612ff42925ab">ClearStrategicLog</a>();
<a name="l00425"></a>00425 <span class="preprocessor">#endif</span>
<a name="l00426"></a>00426 <span class="preprocessor"></span>
<a name="l00427"></a>00427 <span class="comment">//Recalculates a group's weight based on any changes.  </span>
<a name="l00428"></a>00428 <span class="comment">//@@@Alex, this is possibly missing in some areas.  It is hard to ensure it is </span>
<a name="l00429"></a>00429 <span class="comment">//everywhere with all the changes I've made.  I'm sure you could probably find some missing calls.</span>
<a name="l00430"></a>00430 <span class="keywordtype">void</span> <a class="code" href="Strategic_01AI_8cpp.html#d11803600200a4f8e0f5d842132fc140">RecalculatePatrolWeight</a>( <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a> iPatrolID );
<a name="l00431"></a>00431 <span class="keywordtype">void</span> <a class="code" href="Strategic_01AI_8cpp.html#c9af29ba59f70cabda683c1d3e7de1d0">RecalculateGarrisonWeight</a>( <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a> iGarrisonID );
<a name="l00432"></a>00432 
<a name="l00433"></a>00433 
<a name="l00434"></a>00434 <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a> <a class="code" href="Strategic_01AI_8cpp.html#9ea9c2599dfa6834825e1e022d3be6c1">GarrisonReinforcementsRequested</a>( <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a> iGarrisonID, <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> *pubExtraReinforcements );
<a name="l00435"></a>00435 <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a> <a class="code" href="Strategic_01AI_8cpp.html#cf54de770d965746c7db52bde17db11b">PatrolReinforcementsRequested</a>( <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a> iPatrolID );
<a name="l00436"></a>00436 <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a> <a class="code" href="Strategic_01AI_8cpp.html#935cd00b37d3ecb937347a7d5ed379d0">ReinforcementsAvailable</a>( <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a> iGarrisonID );
<a name="l00437"></a>00437 <a class="code" href="Types_8h.html#112e3146cb38b6ee95e64d85842e380a">BOOLEAN</a> <a class="code" href="Strategic_01AI_8cpp.html#0cccefb435b3d940d9bf817c88224d6f">ReinforcementsApproved</a>( <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a> iGarrisonID, <a class="code" href="Types_8h.html#09f1a1fb2293e33483cc8d44aefb1eb1">UINT16</a> *pusDefencePoints );
<a name="l00438"></a>00438 <span class="keywordtype">void</span> <a class="code" href="Strategic_01AI_8cpp.html#a5149c8e5d77cd98583fe9f8abf93657">SendReinforcementsForGarrison</a>( <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a> iDstGarrisonID, <a class="code" href="Types_8h.html#09f1a1fb2293e33483cc8d44aefb1eb1">UINT16</a> usDefencePoints, <a class="code" href="structGROUP.html">GROUP</a> **pOptionalGroup );
<a name="l00439"></a>00439 <span class="keywordtype">void</span> <a class="code" href="Strategic_01AI_8cpp.html#8b154858f03533e0134728bee6602276">SendReinforcementsForPatrol</a>( <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a> iPatrolID, <a class="code" href="structGROUP.html">GROUP</a> **pOptionalGroup );
<a name="l00440"></a>00440 
<a name="l00441"></a>00441 <span class="keywordtype">void</span> <a class="code" href="Auto_01Resolve_8cpp.html#bf99843dcb604b6d631665205f1a3d42">ClearPreviousAIGroupAssignment</a>( <a class="code" href="structGROUP.html">GROUP</a> *pGroup );
<a name="l00442"></a>00442 
<a name="l00443"></a>00443 <span class="keywordtype">void</span> <a class="code" href="Strategic_01AI_8cpp.html#c348102993f2e72a7b73cc2f93cf7ac3">CalcNumTroopsBasedOnComposition</a>( <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> *pubNumTroops, <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> *pubNumElites, <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubTotal, <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a> iCompositionID );
<a name="l00444"></a>00444 <span class="keywordtype">void</span> <a class="code" href="Strategic_01AI_8cpp.html#d4c479be89206291565d9795d7515967">ConvertGroupTroopsToComposition</a>( <a class="code" href="structGROUP.html">GROUP</a> *pGroup, <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a> iCompositionID );
<a name="l00445"></a>00445 <span class="keywordtype">void</span> <a class="code" href="Strategic_01AI_8cpp.html#b07cff54af372d6ec184957cb7b51266">RemoveSoldiersFromGarrisonBasedOnComposition</a>( <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a> iGarrisonID, <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubSize );
<a name="l00446"></a>00446 
<a name="l00447"></a>00447 <span class="comment">//If there are any enemy groups that will be moving through this sector due, they will have to repath which</span>
<a name="l00448"></a>00448 <span class="comment">//will cause them to avoid the sector.  Returns the number of redirected groups.</span>
<a name="l00449"></a>00449 <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> <a class="code" href="Strategic_01AI_8cpp.html#a59392985568cf90cc017a406b3b6e0f">RedirectEnemyGroupsMovingThroughSector</a>( <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubSectorX, <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubSectorY );
<a name="l00450"></a>00450 
<a name="l00451"></a>00451 
<a name="l00452"></a>00452 
<a name="l00453"></a>00453 <span class="comment">//As the player's progress changes in the game, the queen will adjust her priorities accordingly.  </span>
<a name="l00454"></a>00454 <span class="comment">//Basically, increasing priorities and numbers for sectors she owns, and lowering them.</span>
<a name="l00455"></a>00455 <span class="comment">//@@@Alex, this is tweakable.  My philosophies could be incorrect.  It might be better if instead of lowering </span>
<a name="l00456"></a>00456 <span class="comment">//priorities and numbers for towns the queen has lost, to instead lower the priority but increase the numbers so </span>
<a name="l00457"></a>00457 <span class="comment">//she would send larger attack forces.  This is questionable.</span>
<a name="l00458"></a>00458 <span class="keywordtype">void</span> <a class="code" href="Strategic_01AI_8cpp.html#d07e8dc3510ffd7b3bf0713c0a152ae2">EvolveQueenPriorityPhase</a>( <a class="code" href="Types_8h.html#112e3146cb38b6ee95e64d85842e380a">BOOLEAN</a> fForceChange );
<a name="l00459"></a>00459 
<a name="l00460"></a>00460 <span class="keyword">extern</span> <a class="code" href="Types_8h.html#30f500129d8c688af07726d5d34ce52d">INT16</a> <a class="code" href="SaveLoadGame_8cpp.html#b14c016f3d2b7115306c10ecd23f9d68">sWorldSectorLocationOfFirstBattle</a>;
<a name="l00461"></a>00461 
<a name="l00462"></a>00462 <span class="keywordtype">void</span> <a class="code" href="Strategic_01AI_8cpp.html#0ecd8a8d61c81aa34eeec15760348ffe">ReassignAIGroup</a>( <a class="code" href="structGROUP.html">GROUP</a> **pGroup );
<a name="l00463"></a>00463 <span class="keywordtype">void</span> <a class="code" href="Strategic_01AI_8cpp.html#aedf834c1be3774f0024f959b4847210">TransferGroupToPool</a>( <a class="code" href="structGROUP.html">GROUP</a> **pGroup );
<a name="l00464"></a>00464 <span class="keywordtype">void</span> <a class="code" href="Strategic_01AI_8cpp.html#3af587307171a6bbdd4a76889ae15a3a">SendGroupToPool</a>( <a class="code" href="structGROUP.html">GROUP</a> **pGroup );
<a name="l00465"></a>00465 
<a name="l00466"></a>00466 <span class="comment">//Simply orders all garrisons to take troops from the patrol groups and send the closest troops from them.  Any garrison,</span>
<a name="l00467"></a>00467 <span class="comment">//whom there request isn't fulfilled (due to lack of troops), will recieve their reinforcements from the queen (P3).</span>
<a name="l00468"></a>00468 <span class="keywordtype">void</span> <a class="code" href="Strategic_01AI_8cpp.html#1da08834def823266558f351d9cbeb45">MassFortifyTowns</a>();
<a name="l00469"></a>00469 
<a name="l00470"></a>00470 <span class="keywordtype">void</span> <a class="code" href="Strategic_01AI_8cpp.html#5ce042820a296b25287965de76aa9e9b">UpgradeAdminsToTroops</a>();
<a name="l00471"></a>00471 
<a name="l00472"></a>00472 
<a name="l00473"></a>00473 <span class="preprocessor">#ifdef JA2BETAVERSION</span>
<a name="l00474"></a>00474 <span class="preprocessor"></span><span class="keywordtype">void</span> <a class="code" href="Strategic_01AI_8cpp.html#8690badaeb456b31a18dda93bcc1d8df">SAIReportError</a>( <a class="code" href="Types_8h.html#94ebfccc6e846c28751f8d616371f1e5">STR16</a> wErrorString );
<a name="l00475"></a>00475 <span class="preprocessor">#else</span>
<a name="l00476"></a>00476 <span class="preprocessor"></span><span class="preprocessor">#define SAIReportError( a ) //define it out</span>
<a name="l00477"></a>00477 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
<a name="l00478"></a>00478 <span class="preprocessor"></span>
<a name="l00479"></a><a class="code" href="Strategic_01AI_8cpp.html#2282261c2887b2d4d1183cf5249e1529">00479</a> <span class="keyword">enum</span> <a class="code" href="Strategic_01AI_8cpp.html#2282261c2887b2d4d1183cf5249e1529">SAIMOVECODE</a>
<a name="l00480"></a>00480 {
<a name="l00481"></a>00481       <a class="code" href="Strategic_01AI_8cpp.html#2282261c2887b2d4d1183cf5249e15291ea328a644e627283a35716a54108248">DIRECT</a>,
<a name="l00482"></a>00482       <a class="code" href="Strategic_01AI_8cpp.html#2282261c2887b2d4d1183cf5249e1529a4d4adb90ccd2b0775d4429cac476900">EVASIVE</a>,
<a name="l00483"></a>00483       <a class="code" href="Strategic_01AI_8cpp.html#2282261c2887b2d4d1183cf5249e1529abdf346cfc40be1a014cf4295888c888">STAGE</a>,
<a name="l00484"></a>00484 };
<a name="l00485"></a>00485 <span class="keywordtype">void</span> <a class="code" href="Strategic_01AI_8cpp.html#3865b55f00d5df7710bd4325ddf83bfc">MoveSAIGroupToSector</a>( <a class="code" href="structGROUP.html">GROUP</a> **pGroup, <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubSectorID, <a class="code" href="Types_8h.html#e1e6edbbc26d6fbc71a90190d0266018">UINT32</a> uiMoveCode, <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubIntention );
<a name="l00486"></a>00486 
<a name="l00487"></a>00487 <span class="comment">//returns the number of reinforcements permitted to be sent.  Will increased if the denied counter is non-zero.</span>
<a name="l00488"></a><a class="code" href="Strategic_01AI_8cpp.html#9ea9c2599dfa6834825e1e022d3be6c1">00488</a> <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a> <a class="code" href="Strategic_01AI_8cpp.html#9ea9c2599dfa6834825e1e022d3be6c1">GarrisonReinforcementsRequested</a>( <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a> iGarrisonID, <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> *pubExtraReinforcements )
<a name="l00489"></a>00489 {
<a name="l00490"></a>00490       <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a> iReinforcementsRequested;
<a name="l00491"></a>00491       <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a> iExistingForces;
<a name="l00492"></a>00492       <a class="code" href="structSECTORINFO.html">SECTORINFO</a> *pSector;
<a name="l00493"></a>00493       <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a> iMaxEnemyGroupSize = <a class="code" href="GameSettings_8cpp.html#5c32f930e2fef384505c4b91803a92c2">gGameExternalOptions</a>.<a class="code" href="structGAME__EXTERNAL__OPTIONS.html#e0dd958b9c8219730a767a875dda20d5">iMaxEnemyGroupSize</a>;
<a name="l00494"></a>00494 DebugMsg (<a class="code" href="DEBUG_8cpp.html#a7985c2fd033797fc67a03b2c26e07c6">TOPIC_JA2</a>,DBG_LEVEL_3,<span class="stringliteral">"Strategic1"</span>);
<a name="l00495"></a>00495 
<a name="l00496"></a>00496       pSector = &amp;<a class="code" href="Campaign_01Types_8h.html#d83c6f699f17a47cf6a662c91d959126">SectorInfo</a>[ <a class="code" href="AI_01Viewer_8cpp.html#a9f940d7f3a6d6698bfaeb7c747d74a9">gGarrisonGroup</a>[ iGarrisonID ].<a class="code" href="structGARRISON__GROUP.html#fb130d3c9211374d87a85cca787fe0dd">ubSectorID</a> ];
<a name="l00497"></a>00497       iExistingForces = pSector-&gt;<a class="code" href="structSECTORINFO.html#d7d5ee63c0dc2ad3164c83541bd80906">ubNumAdmins</a> + pSector-&gt;<a class="code" href="structSECTORINFO.html#e36540b93256cfa71e45382f133d3696">ubNumTroops</a> + pSector-&gt;<a class="code" href="structSECTORINFO.html#3c5312672399c40ec5a395e8bcfb0104">ubNumElites</a>;
<a name="l00498"></a>00498       iReinforcementsRequested = <a class="code" href="AI_01Viewer_8cpp.html#77e448d1f208bd120f861571e6d0098f">gArmyComp</a>[ gGarrisonGroup[ iGarrisonID ].ubComposition ].<a class="code" href="structARMY__COMPOSITION.html#164db6c6c30629f43d42469671367c86">bDesiredPopulation</a> - iExistingForces;
<a name="l00499"></a>00499 
<a name="l00500"></a>00500       <span class="comment">//Record how many of the reinforcements are additionally provided due to being denied in the past.  This will grow</span>
<a name="l00501"></a>00501       <span class="comment">//until it is finally excepted or an absolute max is made.</span>
<a name="l00502"></a>00502       *pubExtraReinforcements = (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)(<a class="code" href="Strategic_01AI_8cpp.html#9bc393a708632bfedc7ce82ab9268709">gubGarrisonReinforcementsDenied</a>[ iGarrisonID ] / (6 - <a class="code" href="GameSettings_8cpp.html#f9f2d5fd368ccadcc26bebc202d52ae7">gGameOptions</a>.<a class="code" href="structGAME__OPTIONS.html#4fb44167906152722f6af5cc9f7c1a99">ubDifficultyLevel</a>));
<a name="l00503"></a>00503       <span class="comment">//Make sure the number of extra reinforcements don't bump the force size past the max of MAX_STRATEGIC_TEAM_SIZE.</span>
<a name="l00504"></a>00504       *pubExtraReinforcements = (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)min( (<a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a>)*pubExtraReinforcements, min( (<a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a>)(*pubExtraReinforcements), iMaxEnemyGroupSize - iReinforcementsRequested ) );
<a name="l00505"></a>00505 
<a name="l00506"></a>00506       iReinforcementsRequested = min( iMaxEnemyGroupSize, iReinforcementsRequested );
<a name="l00507"></a>00507 
<a name="l00508"></a>00508       <span class="keywordflow">if</span>( iReinforcementsRequested + *pubExtraReinforcements + iExistingForces &gt; iMaxEnemyGroupSize )
<a name="l00509"></a>00509       {
<a name="l00510"></a>00510             iExistingForces = iExistingForces;
<a name="l00511"></a>00511       }
<a name="l00512"></a>00512 
<a name="l00513"></a>00513       <span class="keywordflow">return</span> iReinforcementsRequested;
<a name="l00514"></a>00514 }
<a name="l00515"></a>00515 
<a name="l00516"></a><a class="code" href="Strategic_01AI_8cpp.html#cf54de770d965746c7db52bde17db11b">00516</a> <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a> <a class="code" href="Strategic_01AI_8cpp.html#cf54de770d965746c7db52bde17db11b">PatrolReinforcementsRequested</a>( <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a> iPatrolID )
<a name="l00517"></a>00517 {
<a name="l00518"></a>00518       <a class="code" href="structGROUP.html">GROUP</a> *pGroup;
<a name="l00519"></a>00519       pGroup = <a class="code" href="Strategic_01Movement_8cpp.html#33138746a238bdc5c684e9aa2c86691c">GetGroup</a>( <a class="code" href="Strategic_01AI_8cpp.html#9e00ccb0e77cec57208c519e8f831f53">gPatrolGroup</a>[ iPatrolID ].ubGroupID );
<a name="l00520"></a>00520       <span class="keywordflow">if</span>( !pGroup )
<a name="l00521"></a>00521       {
<a name="l00522"></a>00522             <span class="keywordflow">return</span> <a class="code" href="Strategic_01AI_8cpp.html#9e00ccb0e77cec57208c519e8f831f53">gPatrolGroup</a>[ iPatrolID ].<a class="code" href="structPATROL__GROUP.html#762c71bc2c1ac677b145a43cad0f6d22">bSize</a>;
<a name="l00523"></a>00523       }
<a name="l00524"></a>00524       <span class="keywordflow">else</span>
<a name="l00525"></a>00525       {
<a name="l00526"></a>00526             <span class="keywordflow">return</span> <a class="code" href="Strategic_01AI_8cpp.html#9e00ccb0e77cec57208c519e8f831f53">gPatrolGroup</a>[ iPatrolID ].<a class="code" href="structPATROL__GROUP.html#762c71bc2c1ac677b145a43cad0f6d22">bSize</a> - pGroup-&gt;<a class="code" href="structGROUP.html#2a98517c894019ee794e04ea05d1aeaf">ubGroupSize</a>;
<a name="l00527"></a>00527       }
<a name="l00528"></a>00528 }
<a name="l00529"></a>00529 
<a name="l00530"></a><a class="code" href="Strategic_01AI_8cpp.html#935cd00b37d3ecb937347a7d5ed379d0">00530</a> <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a> <a class="code" href="Strategic_01AI_8cpp.html#935cd00b37d3ecb937347a7d5ed379d0">ReinforcementsAvailable</a>( <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a> iGarrisonID )
<a name="l00531"></a>00531 {
<a name="l00532"></a>00532       <a class="code" href="structSECTORINFO.html">SECTORINFO</a> *pSector;
<a name="l00533"></a>00533       <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a> iReinforcementsAvailable;
<a name="l00534"></a>00534 
<a name="l00535"></a>00535       pSector = &amp;<a class="code" href="Campaign_01Types_8h.html#d83c6f699f17a47cf6a662c91d959126">SectorInfo</a>[ <a class="code" href="AI_01Viewer_8cpp.html#a9f940d7f3a6d6698bfaeb7c747d74a9">gGarrisonGroup</a>[ iGarrisonID ].<a class="code" href="structGARRISON__GROUP.html#fb130d3c9211374d87a85cca787fe0dd">ubSectorID</a> ];
<a name="l00536"></a>00536       iReinforcementsAvailable = pSector-&gt;<a class="code" href="structSECTORINFO.html#e36540b93256cfa71e45382f133d3696">ubNumTroops</a> + pSector-&gt;<a class="code" href="structSECTORINFO.html#3c5312672399c40ec5a395e8bcfb0104">ubNumElites</a> + pSector-&gt;<a class="code" href="structSECTORINFO.html#d7d5ee63c0dc2ad3164c83541bd80906">ubNumAdmins</a>;
<a name="l00537"></a>00537       iReinforcementsAvailable -= <a class="code" href="AI_01Viewer_8cpp.html#77e448d1f208bd120f861571e6d0098f">gArmyComp</a>[ gGarrisonGroup[ iGarrisonID ].ubComposition ].<a class="code" href="structARMY__COMPOSITION.html#164db6c6c30629f43d42469671367c86">bDesiredPopulation</a>;
<a name="l00538"></a>00538 
<a name="l00539"></a>00539       <span class="keywordflow">switch</span>( gGarrisonGroup[ iGarrisonID ].ubComposition )
<a name="l00540"></a>00540       {
<a name="l00541"></a>00541             <span class="keywordflow">case</span> <a class="code" href="Strategic_01AI_8h.html#a9908284c0827729f14cf9b2489e14796cbe0f336c72d76846995060b0336228">LEVEL1_DEFENCE</a>:
<a name="l00542"></a>00542             <span class="keywordflow">case</span> <a class="code" href="Strategic_01AI_8h.html#a9908284c0827729f14cf9b2489e1479a20161605655b8a279cc33b5b05ef22e">LEVEL2_DEFENCE</a>:
<a name="l00543"></a>00543             <span class="keywordflow">case</span> <a class="code" href="Strategic_01AI_8h.html#a9908284c0827729f14cf9b2489e1479af824648f2c39e0defaa7dc6488a18b6">LEVEL3_DEFENCE</a>:
<a name="l00544"></a>00544             <span class="keywordflow">case</span> <a class="code" href="Strategic_01AI_8h.html#a9908284c0827729f14cf9b2489e1479f024876f6e0853a27e7bc9825c61e1d1">ALMA_DEFENCE</a>:
<a name="l00545"></a>00545             <span class="keywordflow">case</span> <a class="code" href="Strategic_01AI_8h.html#a9908284c0827729f14cf9b2489e1479b2e38a672cdd443d231dd0144a447675">ALMA_MINE</a>:
<a name="l00546"></a>00546                   <span class="comment">//Legal spawning locations</span>
<a name="l00547"></a>00547                   <span class="keywordflow">break</span>;
<a name="l00548"></a>00548             <span class="keywordflow">default</span>:
<a name="l00549"></a>00549                   <span class="comment">//No other sector permitted to send surplus troops</span>
<a name="l00550"></a>00550                   <span class="keywordflow">return</span> 0;
<a name="l00551"></a>00551       }
<a name="l00552"></a>00552 
<a name="l00553"></a>00553       <span class="keywordflow">return</span> iReinforcementsAvailable;
<a name="l00554"></a>00554 }
<a name="l00555"></a>00555 
<a name="l00556"></a>00556 <span class="comment">//</span>
<a name="l00557"></a><a class="code" href="Strategic_01AI_8cpp.html#8d10ec503f28c85754a6f32bd3cde826">00557</a> <a class="code" href="Types_8h.html#112e3146cb38b6ee95e64d85842e380a">BOOLEAN</a> <a class="code" href="Strategic_01AI_8cpp.html#8d10ec503f28c85754a6f32bd3cde826">PlayerForceTooStrong</a>( <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubSectorID, <a class="code" href="Types_8h.html#09f1a1fb2293e33483cc8d44aefb1eb1">UINT16</a> usOffensePoints, <a class="code" href="Types_8h.html#09f1a1fb2293e33483cc8d44aefb1eb1">UINT16</a> *pusDefencePoints )
<a name="l00558"></a>00558 {
<a name="l00559"></a>00559       <a class="code" href="structSECTORINFO.html">SECTORINFO</a> *pSector;
<a name="l00560"></a>00560       <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubSectorX, ubSectorY;
<a name="l00561"></a>00561 
<a name="l00562"></a>00562       ubSectorX = (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)SECTORX( ubSectorID );
<a name="l00563"></a>00563       ubSectorY = (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)SECTORY( ubSectorID );
<a name="l00564"></a>00564       pSector = &amp;<a class="code" href="Campaign_01Types_8h.html#d83c6f699f17a47cf6a662c91d959126">SectorInfo</a>[ ubSectorID ];
<a name="l00565"></a>00565 
<a name="l00566"></a>00566       *pusDefencePoints = pSector-&gt;<a class="code" href="structSECTORINFO.html#71d253db041a4884b9ae6335f52fb082">ubNumberOfCivsAtLevel</a>[ <a class="code" href="Campaign_01Types_8h.html#6fde86696b9fb4575b16ddc150ff0a840b225c8d872b15875355f348d6e3335b">GREEN_MILITIA</a> ]           * 1 + 
<a name="l00567"></a>00567                                                                   pSector-&gt;<a class="code" href="structSECTORINFO.html#71d253db041a4884b9ae6335f52fb082">ubNumberOfCivsAtLevel</a>[ <a class="code" href="Campaign_01Types_8h.html#6fde86696b9fb4575b16ddc150ff0a845612214b681e2988ea93890806802cc9">REGULAR_MILITIA</a> ] * 2 +
<a name="l00568"></a>00568                                                                   pSector-&gt;<a class="code" href="structSECTORINFO.html#71d253db041a4884b9ae6335f52fb082">ubNumberOfCivsAtLevel</a>[ <a class="code" href="Campaign_01Types_8h.html#6fde86696b9fb4575b16ddc150ff0a840fcf7fc556b8af2f6d3ec39652d3a927">ELITE_MILITIA</a> ]       * 3 + 
<a name="l00569"></a>00569                                                                   <a class="code" href="Strategic_01Movement_8cpp.html#39531a1493c62a63a373c7e8125ca7f7">PlayerMercsInSector</a>( ubSectorX, ubSectorY, 0 )        * 5;
<a name="l00570"></a>00570       <span class="keywordflow">if</span>( *pusDefencePoints &gt; usOffensePoints )
<a name="l00571"></a>00571       {
<a name="l00572"></a>00572             <span class="keywordflow">return</span> TRUE;
<a name="l00573"></a>00573       }
<a name="l00574"></a>00574       <span class="keywordflow">return</span> FALSE;
<a name="l00575"></a>00575 }
<a name="l00576"></a>00576 
<a name="l00577"></a><a class="code" href="Strategic_01AI_8cpp.html#e521ef3ef604f1b3f3af7308b87a5e68">00577</a> <span class="keywordtype">void</span> <a class="code" href="Strategic_01AI_8cpp.html#e521ef3ef604f1b3f3af7308b87a5e68">RequestAttackOnSector</a>( <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubSectorID, <a class="code" href="Types_8h.html#09f1a1fb2293e33483cc8d44aefb1eb1">UINT16</a> usDefencePoints )
<a name="l00578"></a>00578 {
<a name="l00579"></a>00579       <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a> i;
<a name="l00580"></a>00580       <span class="keywordflow">for</span>( i = 0; i &lt; <a class="code" href="AI_01Viewer_8cpp.html#bc61e2ffd8a6355b543d582d17631f9f">giGarrisonArraySize</a>; i++ )
<a name="l00581"></a>00581       {
<a name="l00582"></a>00582             <span class="keywordflow">if</span>( <a class="code" href="AI_01Viewer_8cpp.html#a9f940d7f3a6d6698bfaeb7c747d74a9">gGarrisonGroup</a>[ i ].ubSectorID == ubSectorID &amp;&amp; !<a class="code" href="AI_01Viewer_8cpp.html#a9f940d7f3a6d6698bfaeb7c747d74a9">gGarrisonGroup</a>[ i ].ubPendingGroupID )
<a name="l00583"></a>00583             {
<a name="l00584"></a>00584                   #ifdef JA2BETAVERSION
<a name="l00585"></a>00585                         <a class="code" href="Strategic_01AI_8cpp.html#984e97af1f29d3b417cc5bdcd126cfca">LogStrategicEvent</a>( <span class="stringliteral">"An attack has been requested in sector %c%d."</span>, 
<a name="l00586"></a>00586                               SECTORY( ubSectorID ) + <span class="charliteral">'A'</span> - 1, SECTORX( ubSectorID ) );
<a name="l00587"></a>00587 <span class="preprocessor">                  #endif</span>
<a name="l00588"></a>00588 <span class="preprocessor"></span>                  <a class="code" href="Strategic_01AI_8cpp.html#a5149c8e5d77cd98583fe9f8abf93657">SendReinforcementsForGarrison</a>( i, usDefencePoints, NULL );
<a name="l00589"></a>00589                   <span class="keywordflow">return</span>;
<a name="l00590"></a>00590             }
<a name="l00591"></a>00591       }
<a name="l00592"></a>00592 }
<a name="l00593"></a>00593 
<a name="l00594"></a>00594 
<a name="l00595"></a>00595 
<a name="l00596"></a><a class="code" href="Strategic_01AI_8cpp.html#73501d5da96c2872b48fa331b1585ff2">00596</a> <a class="code" href="Types_8h.html#112e3146cb38b6ee95e64d85842e380a">BOOLEAN</a> <a class="code" href="Strategic_01AI_8cpp.html#73501d5da96c2872b48fa331b1585ff2">AdjacentSectorIsImportantAndUndefended</a>( <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubSectorID )
<a name="l00597"></a>00597 {
<a name="l00598"></a>00598       <a class="code" href="structSECTORINFO.html">SECTORINFO</a> *pSector;
<a name="l00599"></a>00599       <span class="keywordflow">switch</span>( ubSectorID )
<a name="l00600"></a>00600       {
<a name="l00601"></a>00601             <span class="keywordflow">case</span> <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c660264391d2dc0712c8c1f845d2997d13220831">SEC_A9</a>:      <span class="keywordflow">case</span> <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c660264397a66a28fcba55b268aca2df88ae2ad0">SEC_A10</a>:                                               <span class="comment">//Omerta</span>
<a name="l00602"></a>00602             <span class="keywordflow">case</span> <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643b4a9c6bd17076909f1625214f756c093">SEC_C5</a>:      <span class="keywordflow">case</span> <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c66026431d24119bc57aec5046051cd0814a73bb">SEC_C6</a>:      <span class="keywordflow">case</span> <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c66026439e7934b21095550280fd71e1148a208e">SEC_D5</a>:      <span class="comment">//San Mona</span>
<a name="l00603"></a>00603             <span class="keywordflow">case</span> <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c660264385f4a65655b21173eecbd9bd8dd4b018">SEC_I6</a>:                                                                                          <span class="comment">//Estoni</span>
<a name="l00604"></a>00604                   <span class="comment">//These sectors aren't important.</span>
<a name="l00605"></a>00605                   <span class="keywordflow">return</span> FALSE;
<a name="l00606"></a>00606       }
<a name="l00607"></a>00607       pSector = &amp;<a class="code" href="Campaign_01Types_8h.html#d83c6f699f17a47cf6a662c91d959126">SectorInfo</a>[ ubSectorID ];
<a name="l00608"></a>00608       <span class="keywordflow">if</span>( pSector-&gt;<a class="code" href="structSECTORINFO.html#e36540b93256cfa71e45382f133d3696">ubNumTroops</a> || pSector-&gt;<a class="code" href="structSECTORINFO.html#3c5312672399c40ec5a395e8bcfb0104">ubNumElites</a> || pSector-&gt;<a class="code" href="structSECTORINFO.html#d7d5ee63c0dc2ad3164c83541bd80906">ubNumAdmins</a> )
<a name="l00609"></a>00609       {
<a name="l00610"></a>00610             <span class="keywordflow">return</span> FALSE;
<a name="l00611"></a>00611       }
<a name="l00612"></a>00612       <span class="keywordflow">if</span>( pSector-&gt;<a class="code" href="structSECTORINFO.html#4cb1e631cfc9b634968a2a6a6aa197a2">ubTraversability</a>[ 4 ] == <a class="code" href="Campaign_01Types_8h.html#65a8130020b0f5722cda500f2e67acc25bd0672d1e2b187c399da01113c567fa">TOWN</a> )
<a name="l00613"></a>00613       {
<a name="l00614"></a>00614             <span class="keywordflow">if</span>( !<a class="code" href="Queen_01Command_8cpp.html#5c06f4877b66b5a2c4467747f3c4f13e">PlayerSectorDefended</a>( ubSectorID ) )
<a name="l00615"></a>00615             {
<a name="l00616"></a>00616                   <span class="keywordflow">return</span> TRUE;
<a name="l00617"></a>00617             }
<a name="l00618"></a>00618       }
<a name="l00619"></a>00619       <span class="keywordflow">return</span> FALSE;
<a name="l00620"></a>00620 }
<a name="l00621"></a>00621 
<a name="l00622"></a><a class="code" href="Strategic_01AI_8cpp.html#6447b1863729a0af153094f1246a27e8">00622</a> <span class="keywordtype">void</span> <a class="code" href="Strategic_01AI_8cpp.html#6447b1863729a0af153094f1246a27e8">ValidatePendingGroups</a>()
<a name="l00623"></a>00623 {
<a name="l00624"></a>00624 <span class="preprocessor">      #ifdef JA2BETAVERSION</span>
<a name="l00625"></a>00625 <span class="preprocessor"></span>            <a class="code" href="structGROUP.html">GROUP</a> *pGroup;
<a name="l00626"></a>00626             <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a> i, iErrorsForInvalidPendingGroup = 0;
<a name="l00627"></a>00627             <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubGroupID;
<a name="l00628"></a>00628             <span class="keywordflow">for</span>( i = 0; i &lt; <a class="code" href="Strategic_01AI_8cpp.html#8c839f77f7a78de6ff920d5943d834d7">giPatrolArraySize</a>; i++ )
<a name="l00629"></a>00629             {
<a name="l00630"></a>00630                   ubGroupID = <a class="code" href="Strategic_01AI_8cpp.html#9e00ccb0e77cec57208c519e8f831f53">gPatrolGroup</a>[ i ].ubPendingGroupID;
<a name="l00631"></a>00631                   <span class="keywordflow">if</span>( ubGroupID )
<a name="l00632"></a>00632                   {
<a name="l00633"></a>00633                         pGroup = <a class="code" href="Strategic_01Movement_8cpp.html#33138746a238bdc5c684e9aa2c86691c">GetGroup</a>( ubGroupID );
<a name="l00634"></a>00634                         <span class="keywordflow">if</span>( !pGroup || pGroup-&gt;<a class="code" href="structGROUP.html#1420d1afb0a1876a85b6b93308fbaf68">fPlayer</a> )
<a name="l00635"></a>00635                         {
<a name="l00636"></a>00636                               iErrorsForInvalidPendingGroup++;
<a name="l00637"></a>00637                               <a class="code" href="Strategic_01AI_8cpp.html#9e00ccb0e77cec57208c519e8f831f53">gPatrolGroup</a>[ i ].<a class="code" href="structPATROL__GROUP.html#85b82707f42868bcdd678a1d7ba9c257">ubPendingGroupID</a> = 0;
<a name="l00638"></a>00638                         }
<a name="l00639"></a>00639                   }
<a name="l00640"></a>00640             }
<a name="l00641"></a>00641             <span class="keywordflow">for</span>( i = 0; i &lt; <a class="code" href="AI_01Viewer_8cpp.html#bc61e2ffd8a6355b543d582d17631f9f">giGarrisonArraySize</a>; i++ )
<a name="l00642"></a>00642             {
<a name="l00643"></a>00643                   ubGroupID = <a class="code" href="AI_01Viewer_8cpp.html#a9f940d7f3a6d6698bfaeb7c747d74a9">gGarrisonGroup</a>[ i ].ubPendingGroupID;
<a name="l00644"></a>00644                   <span class="keywordflow">if</span>( ubGroupID )
<a name="l00645"></a>00645                   {
<a name="l00646"></a>00646                         pGroup = <a class="code" href="Strategic_01Movement_8cpp.html#33138746a238bdc5c684e9aa2c86691c">GetGroup</a>( ubGroupID );
<a name="l00647"></a>00647                         <span class="keywordflow">if</span>( !pGroup || pGroup-&gt;fPlayer )
<a name="l00648"></a>00648                         {
<a name="l00649"></a>00649                               iErrorsForInvalidPendingGroup++;
<a name="l00650"></a>00650                               <a class="code" href="AI_01Viewer_8cpp.html#a9f940d7f3a6d6698bfaeb7c747d74a9">gGarrisonGroup</a>[ i ].<a class="code" href="structGARRISON__GROUP.html#ea8325bf63e1d81924fb5fab93b37d8e">ubPendingGroupID</a> = 0;
<a name="l00651"></a>00651                         }
<a name="l00652"></a>00652                   }
<a name="l00653"></a>00653             }
<a name="l00654"></a>00654             <span class="keywordflow">if</span>( iErrorsForInvalidPendingGroup )
<a name="l00655"></a>00655             {
<a name="l00656"></a>00656                   <a class="code" href="Types_8h.html#09f1a1fb2293e33483cc8d44aefb1eb1">UINT16</a> <a class="code" href="Button_01System_8cpp.html#ac22642f3052cc77a6991a262ce4ad23">str</a>[256];
<a name="l00657"></a>00657                   swprintf( <a class="code" href="Button_01System_8cpp.html#ac22642f3052cc77a6991a262ce4ad23">str</a>, L<span class="stringliteral">"Strategic AI:  Internal error -- %d pending groups were discovered to be invalid.  Please report error and send save."</span>
<a name="l00658"></a>00658                                                              L<span class="stringliteral">"You can continue playing, as this has been auto-corrected.  No need to send any debug files."</span>, iErrorsForInvalidPendingGroup );
<a name="l00659"></a>00659                   <a class="code" href="Strategic_01AI_8cpp.html#8690badaeb456b31a18dda93bcc1d8df">SAIReportError</a>( <a class="code" href="Button_01System_8cpp.html#ac22642f3052cc77a6991a262ce4ad23">str</a> );
<a name="l00660"></a>00660             }
<a name="l00661"></a>00661 <span class="preprocessor">      #endif</span>
<a name="l00662"></a>00662 <span class="preprocessor"></span>}
<a name="l00663"></a>00663 
<a name="l00664"></a><a class="code" href="Strategic_01AI_8cpp.html#75d774eb03c41b5fe422edfef6e445d4">00664</a> <span class="keywordtype">void</span> <a class="code" href="Strategic_01AI_8cpp.html#75d774eb03c41b5fe422edfef6e445d4">ValidateWeights</a>( <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a> iID )
<a name="l00665"></a>00665 {
<a name="l00666"></a>00666 <span class="preprocessor">      #ifdef JA2BETAVERSION</span>
<a name="l00667"></a>00667 <span class="preprocessor"></span>            <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a> i;
<a name="l00668"></a>00668             <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a> iSumRequestPoints = 0;
<a name="l00669"></a>00669             <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a> iSumReinforcementPoints = 0;
<a name="l00670"></a>00670             <span class="keywordflow">for</span>( i = 0; i &lt; <a class="code" href="Strategic_01AI_8cpp.html#8c839f77f7a78de6ff920d5943d834d7">giPatrolArraySize</a>; i++ )
<a name="l00671"></a>00671             {
<a name="l00672"></a>00672                   iSumRequestPoints += <a class="code" href="Strategic_01AI_8cpp.html#9e00ccb0e77cec57208c519e8f831f53">gPatrolGroup</a>[ i ].bWeight;
<a name="l00673"></a>00673             }
<a name="l00674"></a>00674             <span class="keywordflow">for</span>( i = 0; i &lt; giGarrisonArraySize; i++ )
<a name="l00675"></a>00675             {
<a name="l00676"></a>00676                   <span class="keywordflow">if</span>( <a class="code" href="AI_01Viewer_8cpp.html#a9f940d7f3a6d6698bfaeb7c747d74a9">gGarrisonGroup</a>[ i ].bWeight &gt; 0 )
<a name="l00677"></a>00677                   {
<a name="l00678"></a>00678                         iSumRequestPoints += <a class="code" href="AI_01Viewer_8cpp.html#a9f940d7f3a6d6698bfaeb7c747d74a9">gGarrisonGroup</a>[ i ].bWeight;
<a name="l00679"></a>00679                   }
<a name="l00680"></a>00680                   <span class="keywordflow">else</span> <span class="keywordflow">if</span>( <a class="code" href="AI_01Viewer_8cpp.html#a9f940d7f3a6d6698bfaeb7c747d74a9">gGarrisonGroup</a>[ i ].bWeight &lt; 0 )
<a name="l00681"></a>00681                   {
<a name="l00682"></a>00682                         iSumReinforcementPoints -= <a class="code" href="AI_01Viewer_8cpp.html#a9f940d7f3a6d6698bfaeb7c747d74a9">gGarrisonGroup</a>[ i ].bWeight; <span class="comment">//double negative is positive!</span>
<a name="l00683"></a>00683                   }
<a name="l00684"></a>00684             }
<a name="l00685"></a>00685             <span class="keywordflow">if</span>( <a class="code" href="AI_01Viewer_8cpp.html#a54cf2087c7e1b790053295a6bf90592">giReinforcementPoints</a> != iSumReinforcementPoints || <a class="code" href="AI_01Viewer_8cpp.html#c3390da297cb8068458f459fe9fc094f">giRequestPoints</a> != iSumRequestPoints )
<a name="l00686"></a>00686             {
<a name="l00687"></a>00687                   <a class="code" href="Types_8h.html#09f1a1fb2293e33483cc8d44aefb1eb1">UINT16</a> <a class="code" href="Button_01System_8cpp.html#ac22642f3052cc77a6991a262ce4ad23">str</a>[256];
<a name="l00688"></a>00688                   swprintf( <a class="code" href="Button_01System_8cpp.html#ac22642f3052cc77a6991a262ce4ad23">str</a>, L<span class="stringliteral">"Strategic AI:  Internal error #%02d (total request/reinforcement points).  Please report error including error#.  "</span>
<a name="l00689"></a>00689                                                              L<span class="stringliteral">"You can continue playing, as the points have been auto-corrected.  No need to send any save/debug files."</span>, iID );
<a name="l00690"></a>00690                   <span class="comment">//Correct the misalignment.</span>
<a name="l00691"></a>00691                   <a class="code" href="AI_01Viewer_8cpp.html#a54cf2087c7e1b790053295a6bf90592">giReinforcementPoints</a> = iSumReinforcementPoints;
<a name="l00692"></a>00692                   <a class="code" href="AI_01Viewer_8cpp.html#c3390da297cb8068458f459fe9fc094f">giRequestPoints</a> = iSumRequestPoints;
<a name="l00693"></a>00693                   <a class="code" href="Strategic_01AI_8cpp.html#8690badaeb456b31a18dda93bcc1d8df">SAIReportError</a>( str );
<a name="l00694"></a>00694             }
<a name="l00695"></a>00695 <span class="preprocessor">      #endif</span>
<a name="l00696"></a>00696 <span class="preprocessor"></span>}
<a name="l00697"></a>00697 
<a name="l00698"></a><a class="code" href="Strategic_01AI_8cpp.html#3c3091ef7361288e9f4f6a95cb067980">00698</a> <span class="keywordtype">void</span> <a class="code" href="Strategic_01AI_8cpp.html#3c3091ef7361288e9f4f6a95cb067980">ValidateGroup</a>( <a class="code" href="structGROUP.html">GROUP</a> *pGroup )
<a name="l00699"></a>00699 {
<a name="l00700"></a>00700       <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a> iMaxEnemyGroupSize = <a class="code" href="GameSettings_8cpp.html#5c32f930e2fef384505c4b91803a92c2">gGameExternalOptions</a>.<a class="code" href="structGAME__EXTERNAL__OPTIONS.html#e0dd958b9c8219730a767a875dda20d5">iMaxEnemyGroupSize</a>;
<a name="l00701"></a>00701 DebugMsg (<a class="code" href="DEBUG_8cpp.html#a7985c2fd033797fc67a03b2c26e07c6">TOPIC_JA2</a>,DBG_LEVEL_3,<span class="stringliteral">"Strategic2"</span>);
<a name="l00702"></a>00702 
<a name="l00703"></a>00703   <span class="comment">// WANNE 2</span>
<a name="l00704"></a>00704   <span class="keywordflow">if</span> (pGroup == NULL)
<a name="l00705"></a>00705       {
<a name="l00706"></a>00706             <span class="keywordflow">return</span>;
<a name="l00707"></a>00707       }
<a name="l00708"></a>00708 
<a name="l00709"></a>00709       <span class="keywordflow">if</span>( !pGroup-&gt;<a class="code" href="structGROUP.html#eee29372e834112984eab1dc714466c0">ubSectorX</a> || !pGroup-&gt;<a class="code" href="structGROUP.html#11cd63715d9daf1488cca330690db007">ubSectorY</a> || pGroup-&gt;<a class="code" href="structGROUP.html#eee29372e834112984eab1dc714466c0">ubSectorX</a> &gt; 16 || pGroup-&gt;<a class="code" href="structGROUP.html#11cd63715d9daf1488cca330690db007">ubSectorY</a> &gt; 16 )
<a name="l00710"></a>00710       {
<a name="l00711"></a>00711             <span class="keywordflow">if</span>( <a class="code" href="Overhead_8cpp.html#46bd754f8875c305ab18731ed10e3364">gTacticalStatus</a>.<a class="code" href="structTacticalStatusType.html#89eb954f99ad4f28b84d7cf675c8ed32">uiFlags</a> &amp; LOADING_SAVED_GAME )
<a name="l00712"></a>00712             {
<a name="l00713"></a>00713 <span class="preprocessor">                  #ifdef JA2BETAVERSION</span>
<a name="l00714"></a>00714 <span class="preprocessor"></span>                  {
<a name="l00715"></a>00715                         <a class="code" href="Types_8h.html#09f1a1fb2293e33483cc8d44aefb1eb1">UINT16</a> <a class="code" href="Button_01System_8cpp.html#ac22642f3052cc77a6991a262ce4ad23">str</a>[256];
<a name="l00716"></a>00716                         swprintf( str, L<span class="stringliteral">"Strategic AI:  Internal error (invalid enemy group #%d location at %c%d, destination %c%d).  Please send PRIOR save file and Strategic Decisions.txt."</span>,
<a name="l00717"></a>00717                                                                    pGroup-&gt;<a class="code" href="structGROUP.html#9149379b9355afda87a382af5a88d728">ubGroupID</a>, pGroup-&gt;<a class="code" href="structGROUP.html#11cd63715d9daf1488cca330690db007">ubSectorY</a> + <span class="charliteral">'A'</span> - 1, pGroup-&gt;<a class="code" href="structGROUP.html#eee29372e834112984eab1dc714466c0">ubSectorX</a>, pGroup-&gt;<a class="code" href="structGROUP.html#14c006998c5f9c324b609d459e02d342">ubNextY</a> + <span class="charliteral">'A'</span> - 1, pGroup-&gt;<a class="code" href="structGROUP.html#22d4cef8a4b5c35af9a8259b763c26f0">ubNextX</a> );
<a name="l00718"></a>00718                         <a class="code" href="Strategic_01AI_8cpp.html#8690badaeb456b31a18dda93bcc1d8df">SAIReportError</a>( str );
<a name="l00719"></a>00719                   }
<a name="l00720"></a>00720 <span class="preprocessor">                  #endif</span>
<a name="l00721"></a>00721 <span class="preprocessor"></span>                  <a class="code" href="Auto_01Resolve_8cpp.html#bf99843dcb604b6d631665205f1a3d42">ClearPreviousAIGroupAssignment</a>( pGroup );
<a name="l00722"></a>00722                   <a class="code" href="Strategic_01Movement_8cpp.html#4c74797932f53c0eeed849a864ba4522">RemovePGroup</a>( pGroup );
<a name="l00723"></a>00723                   <span class="keywordflow">return</span>;
<a name="l00724"></a>00724             }
<a name="l00725"></a>00725       }
<a name="l00726"></a>00726       <span class="keywordflow">if</span>( !pGroup-&gt;<a class="code" href="structGROUP.html#22d4cef8a4b5c35af9a8259b763c26f0">ubNextX</a> || !pGroup-&gt;<a class="code" href="structGROUP.html#14c006998c5f9c324b609d459e02d342">ubNextY</a> )
<a name="l00727"></a>00727       {
<a name="l00728"></a>00728             <span class="keywordflow">if</span>( !pGroup-&gt;<a class="code" href="structGROUP.html#1420d1afb0a1876a85b6b93308fbaf68">fPlayer</a> &amp;&amp; pGroup-&gt;<a class="code" href="structGROUP.html#f82ff4c3e504e4bb10feb65491f79471">pEnemyGroup</a>-&gt;<a class="code" href="structENEMYGROUP.html#6d1d418460b3704699f5e058925897e2">ubIntention</a> != <a class="code" href="Strategic_01Movement_8h.html#b59c1bec446b10af208f977a871d910bcbb2b107ee4dddeb7f82aa7b3058cf04">STAGING</a> 
<a name="l00729"></a>00729                                                                          &amp;&amp; pGroup-&gt;<a class="code" href="structGROUP.html#f82ff4c3e504e4bb10feb65491f79471">pEnemyGroup</a>-&gt;<a class="code" href="structENEMYGROUP.html#6d1d418460b3704699f5e058925897e2">ubIntention</a> != <a class="code" href="Strategic_01Movement_8h.html#b59c1bec446b10af208f977a871d910b095b1f433b659c686164f67bb7b89cb1">REINFORCEMENTS</a> )
<a name="l00730"></a>00730             {
<a name="l00731"></a>00731 <span class="preprocessor">                  #ifdef JA2BETAVERSION</span>
<a name="l00732"></a>00732 <span class="preprocessor"></span>                        <a class="code" href="Strategic_01AI_8cpp.html#8690badaeb456b31a18dda93bcc1d8df">SAIReportError</a>( L<span class="stringliteral">"Strategic AI:  Internal error (floating group).  Please send PRIOR save file and Strategic Decisions.txt."</span> );
<a name="l00733"></a>00733 <span class="preprocessor">                  #endif</span>
<a name="l00734"></a>00734 <span class="preprocessor"></span>                  <span class="keywordflow">if</span>( <a class="code" href="Overhead_8cpp.html#46bd754f8875c305ab18731ed10e3364">gTacticalStatus</a>.<a class="code" href="structTacticalStatusType.html#89eb954f99ad4f28b84d7cf675c8ed32">uiFlags</a> &amp; LOADING_SAVED_GAME )
<a name="l00735"></a>00735                   {
<a name="l00736"></a>00736                         <a class="code" href="Auto_01Resolve_8cpp.html#bf99843dcb604b6d631665205f1a3d42">ClearPreviousAIGroupAssignment</a>( pGroup );
<a name="l00737"></a>00737                         <a class="code" href="Strategic_01AI_8cpp.html#0ecd8a8d61c81aa34eeec15760348ffe">ReassignAIGroup</a>( &amp;pGroup );
<a name="l00738"></a>00738                         <span class="keywordflow">return</span>;
<a name="l00739"></a>00739                   }
<a name="l00740"></a>00740             }
<a name="l00741"></a>00741       }
<a name="l00742"></a>00742 <span class="preprocessor">      #ifdef JA2BETAVERSION</span>
<a name="l00743"></a>00743 <span class="preprocessor"></span>            <span class="keywordflow">if</span>( pGroup-&gt;<a class="code" href="structGROUP.html#f82ff4c3e504e4bb10feb65491f79471">pEnemyGroup</a>-&gt;<a class="code" href="structENEMYGROUP.html#61d6f824f39709580afa7a81317e241b">ubNumAdmins</a> + pGroup-&gt;<a class="code" href="structGROUP.html#f82ff4c3e504e4bb10feb65491f79471">pEnemyGroup</a>-&gt;<a class="code" href="structENEMYGROUP.html#27eaaea857408bc6c6358054c19f2d07">ubNumTroops</a> + pGroup-&gt;<a class="code" href="structGROUP.html#f82ff4c3e504e4bb10feb65491f79471">pEnemyGroup</a>-&gt;<a class="code" href="structENEMYGROUP.html#5f20a703a3c536505126979265b10558">ubNumElites</a> != pGroup-&gt;<a class="code" href="structGROUP.html#2a98517c894019ee794e04ea05d1aeaf">ubGroupSize</a> ||
<a name="l00744"></a>00744                         pGroup-&gt;<a class="code" href="structGROUP.html#2a98517c894019ee794e04ea05d1aeaf">ubGroupSize</a> &gt; iMaxEnemyGroupSize )
<a name="l00745"></a>00745             {
<a name="l00746"></a>00746                   <a class="code" href="Strategic_01AI_8cpp.html#8690badaeb456b31a18dda93bcc1d8df">SAIReportError</a>( L<span class="stringliteral">"Strategic AI:  Internal error (bad group populations).  Please send PRIOR save file and Strategic Decisions.txt."</span> );
<a name="l00747"></a>00747             }
<a name="l00748"></a>00748 <span class="preprocessor">      #endif</span>
<a name="l00749"></a>00749 <span class="preprocessor"></span>}
<a name="l00750"></a>00750 
<a name="l00751"></a><a class="code" href="Strategic_01AI_8cpp.html#cc36ad74d06a3b8b211a4e06c8528a43">00751</a> <span class="keywordtype">void</span> <a class="code" href="Strategic_01AI_8cpp.html#cc36ad74d06a3b8b211a4e06c8528a43">ValidateLargeGroup</a>( <a class="code" href="structGROUP.html">GROUP</a> *pGroup )
<a name="l00752"></a>00752 {
<a name="l00753"></a>00753 <span class="preprocessor">      #ifdef JA2BETAVERSION</span>
<a name="l00754"></a>00754 <span class="preprocessor"></span>            <span class="keywordflow">if</span>( pGroup-&gt;<a class="code" href="structGROUP.html#2a98517c894019ee794e04ea05d1aeaf">ubGroupSize</a> &gt; 25 )
<a name="l00755"></a>00755             {
<a name="l00756"></a>00756                   <a class="code" href="Types_8h.html#09f1a1fb2293e33483cc8d44aefb1eb1">UINT16</a> <a class="code" href="Button_01System_8cpp.html#ac22642f3052cc77a6991a262ce4ad23">str</a>[ 512 ];
<a name="l00757"></a>00757                   swprintf( str, L<span class="stringliteral">"Strategic AI warning:  Enemy group containing %d soldiers "</span>
<a name="l00758"></a>00758                                                        L<span class="stringliteral">"(%d admins, %d troops, %d elites) in sector %c%d.  This message is a temporary test message "</span>
<a name="l00759"></a>00759                                                        L<span class="stringliteral">"to evaluate a potential problems with very large enemy groups."</span>,
<a name="l00760"></a>00760                                                        pGroup-&gt;<a class="code" href="structGROUP.html#2a98517c894019ee794e04ea05d1aeaf">ubGroupSize</a>, pGroup-&gt;<a class="code" href="structGROUP.html#f82ff4c3e504e4bb10feb65491f79471">pEnemyGroup</a>-&gt;<a class="code" href="structENEMYGROUP.html#61d6f824f39709580afa7a81317e241b">ubNumAdmins</a>, pGroup-&gt;<a class="code" href="structGROUP.html#f82ff4c3e504e4bb10feb65491f79471">pEnemyGroup</a>-&gt;<a class="code" href="structENEMYGROUP.html#27eaaea857408bc6c6358054c19f2d07">ubNumTroops</a>, pGroup-&gt;<a class="code" href="structGROUP.html#f82ff4c3e504e4bb10feb65491f79471">pEnemyGroup</a>-&gt;<a class="code" href="structENEMYGROUP.html#5f20a703a3c536505126979265b10558">ubNumElites</a>,
<a name="l00761"></a>00761                                                        pGroup-&gt;<a class="code" href="structGROUP.html#11cd63715d9daf1488cca330690db007">ubSectorY</a> + <span class="charliteral">'A'</span> - 1, pGroup-&gt;<a class="code" href="structGROUP.html#eee29372e834112984eab1dc714466c0">ubSectorX</a> );
<a name="l00762"></a>00762                   <a class="code" href="Strategic_01AI_8cpp.html#8690badaeb456b31a18dda93bcc1d8df">SAIReportError</a>( str );
<a name="l00763"></a>00763             }
<a name="l00764"></a>00764 <span class="preprocessor">      #endif</span>
<a name="l00765"></a>00765 <span class="preprocessor"></span>}
<a name="l00766"></a>00766 
<a name="l00767"></a>00767 <span class="preprocessor">#ifdef JA2BETAVERSION</span>
<a name="l00768"></a><a class="code" href="Strategic_01AI_8cpp.html#889ec481bd5e637d390a5313d80ed3e5">00768</a> <span class="preprocessor"></span><span class="keywordtype">void</span> <a class="code" href="Strategic_01AI_8cpp.html#889ec481bd5e637d390a5313d80ed3e5">RemovePlayersFromAllMismatchGroups</a>( <a class="code" href="structSOLDIERTYPE.html">SOLDIERTYPE</a> *<a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a> )
<a name="l00769"></a>00769 {
<a name="l00770"></a>00770       <a class="code" href="structGROUP.html">GROUP</a> *pGroup, *pTempGroup = NULL;
<a name="l00771"></a>00771       <a class="code" href="structPLAYERGROUP.html">PLAYERGROUP</a> *pPlayer;
<a name="l00772"></a>00772       <a class="code" href="Types_8h.html#112e3146cb38b6ee95e64d85842e380a">BOOLEAN</a> fRemoveSoldierFromThisGroup = FALSE;
<a name="l00773"></a>00773       pGroup = <a class="code" href="Strategic_01Movement_8cpp.html#eb63397419934df48a7149753dff164e">gpGroupList</a>;
<a name="l00774"></a>00774       <span class="keywordflow">while</span>( pGroup )
<a name="l00775"></a>00775       {
<a name="l00776"></a>00776             <span class="keywordflow">if</span>( pGroup-&gt;<a class="code" href="structGROUP.html#1420d1afb0a1876a85b6b93308fbaf68">fPlayer</a> )
<a name="l00777"></a>00777             {
<a name="l00778"></a>00778                   pPlayer = pGroup-&gt;<a class="code" href="structGROUP.html#32b15cb224aa76e12ae34a04cb29aa7d">pPlayerList</a>;
<a name="l00779"></a>00779                   <span class="keywordflow">while</span>( pPlayer )
<a name="l00780"></a>00780                   {
<a name="l00781"></a>00781                         <span class="keywordflow">if</span>( pPlayer-&gt;<a class="code" href="structPLAYERGROUP.html#28c4e90a1214ef76a13dccf2280e12e3">pSoldier</a> == <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a> )
<a name="l00782"></a>00782                         {
<a name="l00783"></a>00783                               <span class="keywordflow">if</span>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#7f3c88742fc830ce555bb016e9e68fcd">ubGroupID</a> != pGroup-&gt;<a class="code" href="structGROUP.html#9149379b9355afda87a382af5a88d728">ubGroupID</a> )
<a name="l00784"></a>00784                               {
<a name="l00785"></a>00785                                     fRemoveSoldierFromThisGroup = TRUE;
<a name="l00786"></a>00786                                     pTempGroup = pGroup;
<a name="l00787"></a>00787                               }
<a name="l00788"></a>00788                               <span class="keywordflow">break</span>;
<a name="l00789"></a>00789                         }
<a name="l00790"></a>00790                         pPlayer = pPlayer-&gt;<a class="code" href="structPLAYERGROUP.html#68f18d51344658eca560ab28ecb36f1c">next</a>;
<a name="l00791"></a>00791                   }
<a name="l00792"></a>00792             }
<a name="l00793"></a>00793             pGroup = pGroup-&gt;<a class="code" href="structGROUP.html#6ebc46983b08a66450c23516af0a3f72">next</a>;
<a name="l00794"></a>00794             <span class="keywordflow">if</span>( fRemoveSoldierFromThisGroup )
<a name="l00795"></a>00795             {
<a name="l00796"></a>00796                   fRemoveSoldierFromThisGroup = FALSE;
<a name="l00797"></a>00797                   <a class="code" href="Strategic_01Movement_8cpp.html#800816298e4c34701c6de6b81d5aac67">RemovePlayerFromPGroup</a>( pTempGroup, <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a> );
<a name="l00798"></a>00798             }
<a name="l00799"></a>00799       }
<a name="l00800"></a>00800 }
<a name="l00801"></a>00801 <span class="preprocessor">#endif</span>
<a name="l00802"></a>00802 <span class="preprocessor"></span>
<a name="l00803"></a>00803 <span class="preprocessor">#ifdef JA2BETAVERSION</span>
<a name="l00804"></a><a class="code" href="Soldier_01Control_8cpp.html#6ad6e766f5a175739a5295f19d0f0bd0">00804</a> <span class="preprocessor"></span><span class="keywordtype">void</span> <a class="code" href="Strategic_01AI_8cpp.html#6ad6e766f5a175739a5295f19d0f0bd0">ValidatePlayersAreInOneGroupOnly</a>()
<a name="l00805"></a>00805 {
<a name="l00806"></a>00806       <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a> i;
<a name="l00807"></a>00807       <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a> iGroups;
<a name="l00808"></a>00808       <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a> iMismatches;
<a name="l00809"></a>00809       <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a> iNumErrors;
<a name="l00810"></a>00810       <a class="code" href="structGROUP.html">GROUP</a> *pGroup, *pOtherGroup;
<a name="l00811"></a>00811       <a class="code" href="structPLAYERGROUP.html">PLAYERGROUP</a> *pPlayer;
<a name="l00812"></a>00812       <a class="code" href="structSOLDIERTYPE.html">SOLDIERTYPE</a> *<a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>;
<a name="l00813"></a>00813       <a class="code" href="Types_8h.html#09f1a1fb2293e33483cc8d44aefb1eb1">UINT16</a> <a class="code" href="Button_01System_8cpp.html#ac22642f3052cc77a6991a262ce4ad23">str</a>[ 1024 ];
<a name="l00814"></a>00814       <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubGroupID;
<a name="l00815"></a>00815       <span class="comment">//Go through each merc slot in the player team</span>
<a name="l00816"></a>00816       iNumErrors = 0;
<a name="l00817"></a>00817       <span class="keywordflow">for</span>( i = <a class="code" href="Overhead_8cpp.html#46bd754f8875c305ab18731ed10e3364">gTacticalStatus</a>.<a class="code" href="structTacticalStatusType.html#2ecddfe580bb019bc92cc4859eaf3edc">Team</a>[ OUR_TEAM ].<a class="code" href="structTacticalTeamType.html#f8fe819ad07b242f5dbf97fd4c69b00d">bFirstID</a>; i &lt;= <a class="code" href="Overhead_8cpp.html#46bd754f8875c305ab18731ed10e3364">gTacticalStatus</a>.<a class="code" href="structTacticalStatusType.html#2ecddfe580bb019bc92cc4859eaf3edc">Team</a>[ OUR_TEAM ].<a class="code" href="structTacticalTeamType.html#6a887279dad735dc302f21c1e559d5ce">bLastID</a>; i++ )
<a name="l00818"></a>00818       { <span class="comment">//check to see if the merc has a group ID</span>
<a name="l00819"></a>00819 
<a name="l00820"></a>00820             <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a> = <a class="code" href="Overhead_8cpp.html#2b9a828d7d92ec404b2f9a39fc001177">MercPtrs</a>[ i ];
<a name="l00821"></a>00821 
<a name="l00822"></a>00822             <span class="keywordflow">if</span>( !<a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#653dad4e2520784e293eca9f948b8532">bActive</a> || !<a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#e308dea18533bf5ab2bcee5bbe27391c">bLife</a> || !<a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#7f3c88742fc830ce555bb016e9e68fcd">ubGroupID</a> )
<a name="l00823"></a>00823             { <span class="comment">//non-existant, dead, or in no group (don't care, skip to next merc)</span>
<a name="l00824"></a>00824                   <span class="keywordflow">continue</span>;
<a name="l00825"></a>00825             }
<a name="l00826"></a>00826 
<a name="l00827"></a>00827             <span class="comment">//Record the merc's group ID, as we may have to restore this later if the merc is found to exist</span>
<a name="l00828"></a>00828             <span class="comment">//in multiple groups.</span>
<a name="l00829"></a>00829             ubGroupID = <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#7f3c88742fc830ce555bb016e9e68fcd">ubGroupID</a>;
<a name="l00830"></a>00830 
<a name="l00831"></a>00831             iGroups = 0;
<a name="l00832"></a>00832             iMismatches = 0;
<a name="l00833"></a>00833             <span class="comment">//Go through each group and determine if the player exists in multiple groups</span>
<a name="l00834"></a>00834             <span class="comment">//iGroups ------ counts the number of groups the merc is in.</span>
<a name="l00835"></a>00835             <span class="comment">//iMismatches -- counts the cases where the merc's ubGroupID doesn't match the ubGroupID of the group</span>
<a name="l00836"></a>00836             <span class="comment">//               the merc exists in.</span>
<a name="l00837"></a>00837             pGroup = <a class="code" href="Strategic_01Movement_8cpp.html#eb63397419934df48a7149753dff164e">gpGroupList</a>;
<a name="l00838"></a>00838             <span class="keywordflow">while</span>( pGroup )
<a name="l00839"></a>00839             {
<a name="l00840"></a>00840                   <span class="keywordflow">if</span>( pGroup-&gt;<a class="code" href="structGROUP.html#1420d1afb0a1876a85b6b93308fbaf68">fPlayer</a> )
<a name="l00841"></a>00841                   {
<a name="l00842"></a>00842                         pPlayer = pGroup-&gt;<a class="code" href="structGROUP.html#32b15cb224aa76e12ae34a04cb29aa7d">pPlayerList</a>;
<a name="l00843"></a>00843                         <span class="keywordflow">while</span>( pPlayer )
<a name="l00844"></a>00844                         {
<a name="l00845"></a>00845                               <span class="keywordflow">if</span>( pPlayer-&gt;<a class="code" href="structPLAYERGROUP.html#28c4e90a1214ef76a13dccf2280e12e3">pSoldier</a> == <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a> )
<a name="l00846"></a>00846                               {
<a name="l00847"></a>00847                                     <span class="keywordflow">if</span>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#7f3c88742fc830ce555bb016e9e68fcd">ubGroupID</a> != pGroup-&gt;<a class="code" href="structGROUP.html#9149379b9355afda87a382af5a88d728">ubGroupID</a> )
<a name="l00848"></a>00848                                     {
<a name="l00849"></a>00849                                           iMismatches++;
<a name="l00850"></a>00850                                     }
<a name="l00851"></a>00851                                     iGroups++;
<a name="l00852"></a>00852                                     <span class="keywordflow">break</span>;
<a name="l00853"></a>00853                               }
<a name="l00854"></a>00854                               pPlayer = pPlayer-&gt;<a class="code" href="structPLAYERGROUP.html#68f18d51344658eca560ab28ecb36f1c">next</a>;
<a name="l00855"></a>00855                         }
<a name="l00856"></a>00856                   }
<a name="l00857"></a>00857                   pGroup = pGroup-&gt;<a class="code" href="structGROUP.html#6ebc46983b08a66450c23516af0a3f72">next</a>;
<a name="l00858"></a>00858             }
<a name="l00859"></a>00859 
<a name="l00860"></a>00860             <span class="keywordflow">if</span>( iMismatches || !iGroups )
<a name="l00861"></a>00861             { <span class="comment">//If we have any mismatches or a merc not in a group, then there is definately an error.</span>
<a name="l00862"></a>00862                   <span class="comment">//We need to record and report the "first" error in detail</span>
<a name="l00863"></a>00863                   iNumErrors++; <span class="comment">//keeps track of the total errors (this number will be reported)</span>
<a name="l00864"></a>00864 
<a name="l00865"></a>00865                   <span class="keywordflow">if</span>( iNumErrors == 1 )
<a name="l00866"></a>00866                   { <span class="comment">//This is the first error, so we will provide detailed debug information to help fix the bug(s).</span>
<a name="l00867"></a>00867                         <span class="keywordflow">if</span>( iGroups == 1 &amp;&amp; iMismatches == 1 )
<a name="l00868"></a>00868                         { <span class="comment">//We have a very serious problem, as we have no way to know which group this merc is supposed to be in. </span>
<a name="l00869"></a>00869                               <span class="comment">//This problem cannot be corrected (so we will assign the merc to his own unique squad) and definately report it.</span>
<a name="l00870"></a>00870 
<a name="l00871"></a>00871                               <span class="comment">//Get a pointer to the group that contains the merc</span>
<a name="l00872"></a>00872                               iMismatches = 0;
<a name="l00873"></a>00873                               iGroups = 0;
<a name="l00874"></a>00874                               pGroup = <a class="code" href="Strategic_01Movement_8cpp.html#eb63397419934df48a7149753dff164e">gpGroupList</a>;
<a name="l00875"></a>00875                               pOtherGroup = NULL;
<a name="l00876"></a>00876                               <span class="keywordflow">while</span>( pGroup )
<a name="l00877"></a>00877                               {
<a name="l00878"></a>00878                                     <span class="keywordflow">if</span>( pGroup-&gt;<a class="code" href="structGROUP.html#1420d1afb0a1876a85b6b93308fbaf68">fPlayer</a> )
<a name="l00879"></a>00879                                     {
<a name="l00880"></a>00880                                           pPlayer = pGroup-&gt;<a class="code" href="structGROUP.html#32b15cb224aa76e12ae34a04cb29aa7d">pPlayerList</a>;
<a name="l00881"></a>00881                                           <span class="keywordflow">while</span>( pPlayer )
<a name="l00882"></a>00882                                           {
<a name="l00883"></a>00883                                                 <span class="keywordflow">if</span>( pPlayer-&gt;<a class="code" href="structPLAYERGROUP.html#28c4e90a1214ef76a13dccf2280e12e3">pSoldier</a> == <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a> )
<a name="l00884"></a>00884                                                 {
<a name="l00885"></a>00885                                                       <span class="keywordflow">if</span>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#7f3c88742fc830ce555bb016e9e68fcd">ubGroupID</a> != pGroup-&gt;<a class="code" href="structGROUP.html#9149379b9355afda87a382af5a88d728">ubGroupID</a> )
<a name="l00886"></a>00886                                                       {
<a name="l00887"></a>00887                                                             pOtherGroup = pGroup;
<a name="l00888"></a>00888                                                             iMismatches++;
<a name="l00889"></a>00889                                                       }
<a name="l00890"></a>00890                                                       iGroups++;
<a name="l00891"></a>00891                                                       <span class="keywordflow">break</span>;
<a name="l00892"></a>00892                                                 }
<a name="l00893"></a>00893                                                 pPlayer = pPlayer-&gt;<a class="code" href="structPLAYERGROUP.html#68f18d51344658eca560ab28ecb36f1c">next</a>;
<a name="l00894"></a>00894                                           }
<a name="l00895"></a>00895                                     }
<a name="l00896"></a>00896                                     <span class="keywordflow">if</span>( iMismatches == 1 )
<a name="l00897"></a>00897                                     {
<a name="l00898"></a>00898                                           <span class="keywordflow">break</span>;
<a name="l00899"></a>00899                                     }
<a name="l00900"></a>00900                                     pGroup = pGroup-&gt;<a class="code" href="structGROUP.html#6ebc46983b08a66450c23516af0a3f72">next</a>;
<a name="l00901"></a>00901                               }
<a name="l00902"></a>00902                               pGroup = <a class="code" href="Strategic_01Movement_8cpp.html#33138746a238bdc5c684e9aa2c86691c">GetGroup</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#7f3c88742fc830ce555bb016e9e68fcd">ubGroupID</a> );
<a name="l00903"></a>00903                               Assert( pGroup );
<a name="l00904"></a>00904                               Assert( pOtherGroup );
<a name="l00905"></a>00905                               swprintf( str, L<span class="stringliteral">"%s in %c%d thinks he/she is in group %d in %c%d but isn't.  "</span>
<a name="l00906"></a>00906                                                                          L<span class="stringliteral">"Group %d in %c%d thinks %s is in the group but isn't.  %s will be assigned to a unique squad.  "</span>
<a name="l00907"></a>00907                                                                          L<span class="stringliteral">"Please send screenshot, PRIOR save (corrected by time you read this), and any theories."</span>,
<a name="l00908"></a>00908                                                                          <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#7bf7231f416aa66f38010b7a7e8f2341">name</a>, <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#6dd68e70c3000beb79e4ac45d28a0cbf">sSectorY</a> + <span class="charliteral">'A'</span> - 1, <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#6784346500db10daed06c2db02b855c0">sSectorX</a>, 
<a name="l00909"></a>00909                                                                          <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#7f3c88742fc830ce555bb016e9e68fcd">ubGroupID</a>, pGroup-&gt;<a class="code" href="structGROUP.html#11cd63715d9daf1488cca330690db007">ubSectorY</a> + <span class="charliteral">'A'</span> - 1, pGroup-&gt;<a class="code" href="structGROUP.html#eee29372e834112984eab1dc714466c0">ubSectorX</a>,
<a name="l00910"></a>00910                                                                          pOtherGroup-&gt;<a class="code" href="structGROUP.html#9149379b9355afda87a382af5a88d728">ubGroupID</a>, pOtherGroup-&gt;<a class="code" href="structGROUP.html#11cd63715d9daf1488cca330690db007">ubSectorY</a> + <span class="charliteral">'A'</span> - 1, pOtherGroup-&gt;<a class="code" href="structGROUP.html#eee29372e834112984eab1dc714466c0">ubSectorX</a>, <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#7bf7231f416aa66f38010b7a7e8f2341">name</a>,
<a name="l00911"></a>00911                                                                          <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#7bf7231f416aa66f38010b7a7e8f2341">name</a> );
<a name="l00912"></a>00912                         }
<a name="l00913"></a>00913                         <span class="keywordflow">else</span> <span class="keywordflow">if</span>( iGroups &gt; 1 &amp;&amp; iMismatches == iGroups - 1 )
<a name="l00914"></a>00914                         { <span class="comment">//This is the error that is being targetted.  This means that the merc exists in multiple groups though the merc</span>
<a name="l00915"></a>00915                               <span class="comment">//knows what group he is supposed to be in.  This error can be corrected, by manually removing the merc from all</span>
<a name="l00916"></a>00916                               <span class="comment">//mismatch groups.  This is indicative of a merc being reassigned to another group without removing him first.</span>
<a name="l00917"></a>00917 
<a name="l00918"></a>00918                               <span class="comment">//Get a pointer to the first mismatch group that contains the merc</span>
<a name="l00919"></a>00919                               iMismatches = 0;
<a name="l00920"></a>00920                               iGroups = 0;
<a name="l00921"></a>00921                               pGroup = <a class="code" href="Strategic_01Movement_8cpp.html#eb63397419934df48a7149753dff164e">gpGroupList</a>;
<a name="l00922"></a>00922                               pOtherGroup = NULL;
<a name="l00923"></a>00923                               <span class="keywordflow">while</span>( pGroup )
<a name="l00924"></a>00924                               {
<a name="l00925"></a>00925                                     <span class="keywordflow">if</span>( pGroup-&gt;<a class="code" href="structGROUP.html#1420d1afb0a1876a85b6b93308fbaf68">fPlayer</a> )
<a name="l00926"></a>00926                                     {
<a name="l00927"></a>00927                                           pPlayer = pGroup-&gt;<a class="code" href="structGROUP.html#32b15cb224aa76e12ae34a04cb29aa7d">pPlayerList</a>;
<a name="l00928"></a>00928                                           <span class="keywordflow">while</span>( pPlayer )
<a name="l00929"></a>00929                                           {
<a name="l00930"></a>00930                                                 <span class="keywordflow">if</span>( pPlayer-&gt;<a class="code" href="structPLAYERGROUP.html#28c4e90a1214ef76a13dccf2280e12e3">pSoldier</a> == <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a> )
<a name="l00931"></a>00931                                                 {
<a name="l00932"></a>00932                                                       <span class="keywordflow">if</span>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#7f3c88742fc830ce555bb016e9e68fcd">ubGroupID</a> != pGroup-&gt;<a class="code" href="structGROUP.html#9149379b9355afda87a382af5a88d728">ubGroupID</a> )
<a name="l00933"></a>00933                                                       {
<a name="l00934"></a>00934                                                             pOtherGroup = pGroup;
<a name="l00935"></a>00935                                                             iMismatches++;
<a name="l00936"></a>00936                                                       }
<a name="l00937"></a>00937                                                       iGroups++;
<a name="l00938"></a>00938                                                       <span class="keywordflow">break</span>;
<a name="l00939"></a>00939                                                 }
<a name="l00940"></a>00940                                                 pPlayer = pPlayer-&gt;<a class="code" href="structPLAYERGROUP.html#68f18d51344658eca560ab28ecb36f1c">next</a>;
<a name="l00941"></a>00941                                           }
<a name="l00942"></a>00942                                     }
<a name="l00943"></a>00943                                     pGroup = pGroup-&gt;<a class="code" href="structGROUP.html#6ebc46983b08a66450c23516af0a3f72">next</a>;
<a name="l00944"></a>00944                               }
<a name="l00945"></a>00945                               pGroup = <a class="code" href="Strategic_01Movement_8cpp.html#33138746a238bdc5c684e9aa2c86691c">GetGroup</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#7f3c88742fc830ce555bb016e9e68fcd">ubGroupID</a> );
<a name="l00946"></a>00946                               Assert( pGroup );
<a name="l00947"></a>00947                               Assert( pOtherGroup );
<a name="l00948"></a>00948                               
<a name="l00949"></a>00949                               swprintf( str, L<span class="stringliteral">"%s in %c%d has been found in multiple groups.  The group he/she is supposed "</span>
<a name="l00950"></a>00950                                                                          L<span class="stringliteral">"to be in is group %d in %c%d, but %s was also found to be in group %d in %c%d.  %s was found in %d groups "</span>
<a name="l00951"></a>00951                                                                          L<span class="stringliteral">"total.  Please send screenshot, PRIOR save (corrected by time you read this), and any theories."</span>,
<a name="l00952"></a>00952                                                                          <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#7bf7231f416aa66f38010b7a7e8f2341">name</a>, <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#6dd68e70c3000beb79e4ac45d28a0cbf">sSectorY</a> + <span class="charliteral">'A'</span> - 1, <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#6784346500db10daed06c2db02b855c0">sSectorX</a>, 
<a name="l00953"></a>00953                                                                          pGroup-&gt;<a class="code" href="structGROUP.html#9149379b9355afda87a382af5a88d728">ubGroupID</a>, pGroup-&gt;<a class="code" href="structGROUP.html#11cd63715d9daf1488cca330690db007">ubSectorY</a> + <span class="charliteral">'A'</span> - 1, pGroup-&gt;<a class="code" href="structGROUP.html#eee29372e834112984eab1dc714466c0">ubSectorX</a>,
<a name="l00954"></a>00954                                                                          <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#7bf7231f416aa66f38010b7a7e8f2341">name</a>, pOtherGroup-&gt;<a class="code" href="structGROUP.html#9149379b9355afda87a382af5a88d728">ubGroupID</a>, pOtherGroup-&gt;<a class="code" href="structGROUP.html#11cd63715d9daf1488cca330690db007">ubSectorY</a> + <span class="charliteral">'A'</span> - 1, pOtherGroup-&gt;<a class="code" href="structGROUP.html#eee29372e834112984eab1dc714466c0">ubSectorX</a>,
<a name="l00955"></a>00955                                                                          <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#7bf7231f416aa66f38010b7a7e8f2341">name</a>, iGroups );
<a name="l00956"></a>00956                         }
<a name="l00957"></a>00957                         <span class="keywordflow">else</span> <span class="keywordflow">if</span>( !iGroups )
<a name="l00958"></a>00958                         { <span class="comment">//The merc cannot be found in any group!  This should never happen!  We will assign the merc into his </span>
<a name="l00959"></a>00959                               <span class="comment">//own unique squad as a correction.</span>
<a name="l00960"></a>00960                               swprintf( str, L<span class="stringliteral">"%s in %c%d cannot be found in any group.  %s will be assigned to a unique group/squad.  "</span>
<a name="l00961"></a>00961                                                                          L<span class="stringliteral">"Please provide details on how you think this may have happened.  Send screenshot and PRIOR save.  Do not send a save "</span>
<a name="l00962"></a>00962                                                                          L<span class="stringliteral">"you create after this point as the info will have been corrected by then."</span>,
<a name="l00963"></a>00963                                                                          <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#7bf7231f416aa66f38010b7a7e8f2341">name</a>, <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#6dd68e70c3000beb79e4ac45d28a0cbf">sSectorY</a> + <span class="charliteral">'A'</span> - 1, <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#6784346500db10daed06c2db02b855c0">sSectorX</a>, <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#7bf7231f416aa66f38010b7a7e8f2341">name</a> );
<a name="l00964"></a>00964                         }
<a name="l00965"></a>00965                   }
<a name="l00966"></a>00966 
<a name="l00967"></a>00967                   <span class="comment">//CORRECT THE ERRORS NOW</span>
<a name="l00968"></a>00968                   <span class="keywordflow">if</span>( iGroups == 1 &amp;&amp; iMismatches == 1 )
<a name="l00969"></a>00969                   { <span class="comment">//We have a very serious problem, as we have no way to know which group this merc is supposed to be in. </span>
<a name="l00970"></a>00970                         <span class="comment">//This problem cannot be corrected (so we will assign the merc to his own unique squad).</span>
<a name="l00971"></a>00971                         <a class="code" href="Strategic_01AI_8cpp.html#889ec481bd5e637d390a5313d80ed3e5">RemovePlayersFromAllMismatchGroups</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a> );
<a name="l00972"></a>00972                         <a class="code" href="Squads_8cpp.html#2a90c3d03327432d57b1707a23d0e2dd">AddCharacterToUniqueSquad</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a> );
<a name="l00973"></a>00973                   }
<a name="l00974"></a>00974                   <span class="keywordflow">else</span> <span class="keywordflow">if</span>( iGroups &gt; 1 &amp;&amp; iMismatches == iGroups - 1 )
<a name="l00975"></a>00975                   { <span class="comment">//This is the error that is being targetted.  This means that the merc exists in multiple groups though the merc</span>
<a name="l00976"></a>00976                         <span class="comment">//knows what group he is supposed to be in.  This error can be corrected, by manually removing the merc from all</span>
<a name="l00977"></a>00977                         <span class="comment">//mismatch groups.  This is indicative of a merc being reassigned to another group without removing him first.</span>
<a name="l00978"></a>00978                         <a class="code" href="Strategic_01AI_8cpp.html#889ec481bd5e637d390a5313d80ed3e5">RemovePlayersFromAllMismatchGroups</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a> );
<a name="l00979"></a>00979                         <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a>-&gt;<a class="code" href="structSOLDIERTYPE.html#7f3c88742fc830ce555bb016e9e68fcd">ubGroupID</a> = ubGroupID;
<a name="l00980"></a>00980                   }
<a name="l00981"></a>00981                   <span class="keywordflow">else</span> <span class="keywordflow">if</span>( !iGroups )
<a name="l00982"></a>00982                   { <span class="comment">//The merc cannot be found in any group!  This should never happen!  We will assign the merc into his </span>
<a name="l00983"></a>00983                         <span class="comment">//own unique squad as a correction.</span>
<a name="l00984"></a>00984                         <a class="code" href="Squads_8cpp.html#2a90c3d03327432d57b1707a23d0e2dd">AddCharacterToUniqueSquad</a>( <a class="code" href="aniviewscreen_8cpp.html#629cf92081f22af2ea4014413ff37801">pSoldier</a> );
<a name="l00985"></a>00985                   }
<a name="l00986"></a>00986             }
<a name="l00987"></a>00987       }
<a name="l00988"></a>00988       <span class="keywordflow">if</span>( iNumErrors )
<a name="l00989"></a>00989       { <span class="comment">//The first error to be detected is the one responsible for building the strings.  We will simply append another string containing</span>
<a name="l00990"></a>00990             <span class="comment">//the total number of detected errors.</span>
<a name="l00991"></a>00991             <a class="code" href="Types_8h.html#09f1a1fb2293e33483cc8d44aefb1eb1">UINT16</a> tempstr[ 128 ];
<a name="l00992"></a>00992             swprintf( tempstr, L<span class="stringliteral">"  A total of %d related errors have been detected."</span>, iNumErrors );
<a name="l00993"></a>00993             <a class="code" href="Sys_01Globals_8h.html#92a23b0a8bea9679b6f78aa26b1715e7">wcscat</a>( str, tempstr );
<a name="l00994"></a>00994             <a class="code" href="Strategic_01AI_8cpp.html#8690badaeb456b31a18dda93bcc1d8df">SAIReportError</a>( str );
<a name="l00995"></a>00995       }
<a name="l00996"></a>00996 }
<a name="l00997"></a>00997 <span class="preprocessor">#endif</span>
<a name="l00998"></a>00998 <span class="preprocessor"></span>
<a name="l00999"></a>00999 <span class="preprocessor">#ifdef JA2BETAVERSION</span>
<a name="l01000"></a><a class="code" href="Strategic_01AI_8cpp.html#8690badaeb456b31a18dda93bcc1d8df">01000</a> <span class="preprocessor"></span><span class="keywordtype">void</span> <a class="code" href="Strategic_01AI_8cpp.html#8690badaeb456b31a18dda93bcc1d8df">SAIReportError</a>( <a class="code" href="Types_8h.html#94ebfccc6e846c28751f8d616371f1e5">STR16</a> wErrorString )
<a name="l01001"></a>01001 {
<a name="l01002"></a>01002       <span class="comment">// runtime static only, don't save</span>
<a name="l01003"></a>01003 <span class="preprocessor">      #ifdef JA2TESTVERSION</span>
<a name="l01004"></a>01004 <span class="preprocessor"></span>            <span class="keyword">static</span> <a class="code" href="Types_8h.html#112e3146cb38b6ee95e64d85842e380a">BOOLEAN</a> fReportedAlready = FALSE;
<a name="l01005"></a>01005 <span class="preprocessor">      #else</span>
<a name="l01006"></a>01006 <span class="preprocessor"></span>            <a class="code" href="Types_8h.html#112e3146cb38b6ee95e64d85842e380a">BOOLEAN</a> fReportedAlready = FALSE; <span class="comment">//so it can loop</span>
<a name="l01007"></a>01007 <span class="preprocessor">      #endif</span>
<a name="l01008"></a>01008 <span class="preprocessor"></span>
<a name="l01009"></a>01009       <span class="keywordflow">if</span> ( !fReportedAlready )
<a name="l01010"></a>01010       {
<a name="l01011"></a>01011             <a class="code" href="Game_01Clock_8cpp.html#571d623de0660dfd350dbbc43ac0cd90">StopTimeCompression</a>();
<a name="l01012"></a>01012 
<a name="l01013"></a>01013             <span class="comment">// report the error</span>
<a name="l01014"></a>01014             <span class="keywordflow">if</span>( <a class="code" href="gameloop_8cpp.html#8cd832c7f0ec6ab02ba9fddd4a2257aa">guiCurrentScreen</a> != <a class="code" href="screenids_8h.html#a4ee5dea8709d2b490486a62df77faf2d2351f300ff0344d4ba3a17acbbe98dd">SAVE_LOAD_SCREEN</a> )
<a name="l01015"></a>01015             {
<a name="l01016"></a>01016                   <a class="code" href="MessageBoxScreen_8cpp.html#f480404e936544ddb29a371b785dc2f3">DoScreenIndependantMessageBox</a>( wErrorString, MSG_BOX_FLAG_OK, NULL );
<a name="l01017"></a>01017             }
<a name="l01018"></a>01018             <span class="keywordflow">else</span>
<a name="l01019"></a>01019             {
<a name="l01020"></a>01020                   <a class="code" href="message_8cpp.html#818e47bc59bd5a5755f06ec51cd74928">ScreenMsg</a>( FONT_LTBLUE, MSG_BETAVERSION, wErrorString );
<a name="l01021"></a>01021             }
<a name="l01022"></a>01022             <span class="keywordflow">if</span>( <a class="code" href="gameloop_8cpp.html#8cd832c7f0ec6ab02ba9fddd4a2257aa">guiCurrentScreen</a> == <a class="code" href="screenids_8h.html#a4ee5dea8709d2b490486a62df77faf2eddea7bb8551411e5bfb6f052177bc01">AIVIEWER_SCREEN</a> )
<a name="l01023"></a>01023             {
<a name="l01024"></a>01024                   <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> <a class="code" href="Button_01System_8cpp.html#ac22642f3052cc77a6991a262ce4ad23">str</a>[ 512 ];
<a name="l01025"></a>01025                   sprintf( (<span class="keywordtype">char</span> *)str, <span class="stringliteral">"%S\n"</span>, wErrorString );
<a name="l01026"></a>01026                   OutputDebugString( (LPCSTR) str );
<a name="l01027"></a>01027             }
<a name="l01028"></a>01028 
<a name="l01029"></a>01029             <span class="comment">// this should keep it from repeating endlessly and allow player to save/bail</span>
<a name="l01030"></a>01030             fReportedAlready = TRUE;
<a name="l01031"></a>01031       }
<a name="l01032"></a>01032 }
<a name="l01033"></a>01033 <span class="preprocessor">#endif</span>
<a name="l01034"></a>01034 <span class="preprocessor"></span>
<a name="l01035"></a>01035 
<a name="l01036"></a>01036 
<a name="l01037"></a><a class="code" href="Strategic_01AI_8h.html#ffa8e1f75698880a9755eb966648bb6e">01037</a> <span class="keywordtype">void</span> <a class="code" href="Strategic_01AI_8cpp.html#ffa8e1f75698880a9755eb966648bb6e">InitStrategicAI</a>()
<a name="l01038"></a>01038 {
<a name="l01039"></a>01039       <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a> i, cnt, iRandom;
<a name="l01040"></a>01040       <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a> iEliteChance, iTroopChance, iAdminChance;
<a name="l01041"></a>01041       <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a> iWeight;
<a name="l01042"></a>01042       <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a> iStartPop, iDesiredPop, iPriority;
<a name="l01043"></a>01043       <a class="code" href="structSECTORINFO.html">SECTORINFO</a> *pSector = NULL;
<a name="l01044"></a>01044       <a class="code" href="structGROUP.html">GROUP</a> *pGroup;
<a name="l01045"></a>01045       <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubNumTroops;
<a name="l01046"></a>01046       <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a> iPercentElitesBonus;
<a name="l01047"></a>01047 
<a name="l01048"></a>01048       <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a> iMaxEnemyGroupSize = <a class="code" href="GameSettings_8cpp.html#5c32f930e2fef384505c4b91803a92c2">gGameExternalOptions</a>.<a class="code" href="structGAME__EXTERNAL__OPTIONS.html#e0dd958b9c8219730a767a875dda20d5">iMaxEnemyGroupSize</a>;
<a name="l01049"></a>01049 DebugMsg (<a class="code" href="DEBUG_8cpp.html#a7985c2fd033797fc67a03b2c26e07c6">TOPIC_JA2</a>,DBG_LEVEL_3,<span class="stringliteral">"Strategic3"</span>);
<a name="l01050"></a>01050 
<a name="l01051"></a>01051       <span class="comment">//Initialize the basic variables.</span>
<a name="l01052"></a>01052 
<a name="l01053"></a>01053       <a class="code" href="Strategic_01AI_8cpp.html#c689ec381215b910ba04d356fe3b96ed">gbPadding2</a>[0]                                   = 0;
<a name="l01054"></a>01054       <a class="code" href="Strategic_01AI_8cpp.html#c689ec381215b910ba04d356fe3b96ed">gbPadding2</a>[1]                                   = 0;
<a name="l01055"></a>01055       <a class="code" href="Strategic_01AI_8cpp.html#c689ec381215b910ba04d356fe3b96ed">gbPadding2</a>[2]                                   = 0;
<a name="l01056"></a>01056       <a class="code" href="Strategic_01AI_8cpp.html#da8cb507523142e34aa6a62793f76a88">gfExtraElites</a>                                   = FALSE;    
<a name="l01057"></a>01057       giGarrisonArraySize                 = 0;
<a name="l01058"></a>01058       <a class="code" href="Strategic_01AI_8cpp.html#8c839f77f7a78de6ff920d5943d834d7">giPatrolArraySize</a>                   = 0;
<a name="l01059"></a>01059       <a class="code" href="Strategic_01AI_8cpp.html#dd33d20256198684ad819b0f877ba407">giForcePercentage</a>                   = 0;  
<a name="l01060"></a>01060       <a class="code" href="Strategic_01AI_8cpp.html#5ca96833bf812b9e43da8510ca54f00a">giArmyAlertness</a>                           = 0;  
<a name="l01061"></a>01061       <a class="code" href="Strategic_01AI_8cpp.html#1bdeafde98c11d85ed1f79f8c793b1bc">giArmyAlertnessDecay</a>          = 0;  
<a name="l01062"></a>01062       <a class="code" href="Strategic_01AI_8cpp.html#ab475b2c021e0d3a27bc5f4c7bd22639">gubNumAwareBattles</a>                  = 0;  
<a name="l01063"></a>01063       <a class="code" href="AI_01Viewer_8cpp.html#38284bd39764812fb8a27fe4d3d2b0cd">gfQueenAIAwake</a>                            = FALSE;    
<a name="l01064"></a>01064       <a class="code" href="AI_01Viewer_8cpp.html#c86cd58021961af10f1eb15108a79023">giReinforcementPool</a>                 = 0;  
<a name="l01065"></a>01065       <a class="code" href="AI_01Viewer_8cpp.html#a54cf2087c7e1b790053295a6bf90592">giReinforcementPoints</a>         = 0;  
<a name="l01066"></a>01066       <a class="code" href="AI_01Viewer_8cpp.html#c3390da297cb8068458f459fe9fc094f">giRequestPoints</a>                           = 0;  
<a name="l01067"></a>01067       <a class="code" href="Strategic_01AI_8cpp.html#4f25955839f4d03d6e72fcb14e00fc96">gubSAIVersion</a>                                   = SAI_VERSION;    
<a name="l01068"></a>01068       <a class="code" href="Strategic_01AI_8cpp.html#b6506b3e47eb797cd604d652eb70cdc3">gubQueenPriorityPhase</a>         = 0;  
<a name="l01069"></a>01069       <a class="code" href="Strategic_01AI_8cpp.html#25242025da42191e44f15d6f90efbaf7">gfFirstBattleMeanwhileScenePending</a> = FALSE;
<a name="l01070"></a>01070       <a class="code" href="Strategic_01AI_8cpp.html#ace9c47ca01a402ca45743ff70c9d70c">gfMassFortificationOrdered</a> = FALSE;
<a name="l01071"></a>01071       <a class="code" href="Strategic_01AI_8cpp.html#12b5525b1f3dabeac40700eecd3219e7">gubMinEnemyGroupSize</a>          = 0;
<a name="l01072"></a>01072       <a class="code" href="Strategic_01AI_8cpp.html#123935928b8e3146a1edda9d78cfea62">gubHoursGracePeriod</a>                 = 0;
<a name="l01073"></a>01073       <a class="code" href="Strategic_01AI_8cpp.html#711cdebe533db7c45a8e7e88c6f312d6">gusPlayerBattleVictories</a> = 0;
<a name="l01074"></a>01074       <a class="code" href="Strategic_01AI_8cpp.html#8029ae4e0579eaec31822e170536fe40">gfUseAlternateQueenPosition</a> = FALSE;
<a name="l01075"></a>01075 
<a name="l01076"></a>01076       <a class="code" href="Strategic_01AI_8cpp.html#03888c7c25d0c7d4585ed03317d64c53">gfAggressiveQueen</a> = FALSE;
<a name="l01077"></a>01077       <a class="code" href="Strategic_01AI_8cpp.html#b0c12688f38630da4e064c85394ca570">gfUnlimitedTroops</a> = FALSE;
<a name="l01078"></a>01078 
<a name="l01079"></a>01079 <span class="preprocessor">      #ifdef JA2BETAVERSION</span>
<a name="l01080"></a>01080 <span class="preprocessor"></span>            <a class="code" href="Strategic_01AI_8cpp.html#2b956b276d118fb0236c612ff42925ab">ClearStrategicLog</a>();
<a name="l01081"></a>01081 <span class="preprocessor">      #endif</span>
<a name="l01082"></a>01082 <span class="preprocessor"></span>      <span class="keywordflow">switch</span>( <a class="code" href="GameSettings_8cpp.html#f9f2d5fd368ccadcc26bebc202d52ae7">gGameOptions</a>.<a class="code" href="structGAME__OPTIONS.html#4fb44167906152722f6af5cc9f7c1a99">ubDifficultyLevel</a> )
<a name="l01083"></a>01083       {
<a name="l01084"></a>01084             <span class="keywordflow">case</span> <a class="code" href="GameSettings_8h.html#c205be2172292384dd687b5471a87eddbd3b0d23f4dc30ef17b50a14c3f54589">DIF_LEVEL_EASY</a>:
<a name="l01085"></a>01085                   <a class="code" href="AI_01Viewer_8cpp.html#c86cd58021961af10f1eb15108a79023">giReinforcementPool</a>           = <a class="code" href="GameSettings_8cpp.html#5c32f930e2fef384505c4b91803a92c2">gGameExternalOptions</a>.<a class="code" href="structGAME__EXTERNAL__OPTIONS.html#fb8050129f86701e4bdde92b14c10e6d">iReinforcementPoolNovice</a>;
<a name="l01086"></a>01086                   <a class="code" href="Strategic_01AI_8cpp.html#dd33d20256198684ad819b0f877ba407">giForcePercentage</a>       = <a class="code" href="GameSettings_8cpp.html#5c32f930e2fef384505c4b91803a92c2">gGameExternalOptions</a>.<a class="code" href="structGAME__EXTERNAL__OPTIONS.html#53ecd5f58dacf5f3a5986c12addce3ea">iForcePercentageNovice</a>;
<a name="l01087"></a>01087                   <a class="code" href="Strategic_01AI_8cpp.html#5ca96833bf812b9e43da8510ca54f00a">giArmyAlertness</a>               = <a class="code" href="GameSettings_8cpp.html#5c32f930e2fef384505c4b91803a92c2">gGameExternalOptions</a>.<a class="code" href="structGAME__EXTERNAL__OPTIONS.html#4c92acfdb5a027576a6f513c8e7d45b7">ubEasyEnemyStartingAlertLevel</a>;
<a name="l01088"></a>01088                   <a class="code" href="Strategic_01AI_8cpp.html#1bdeafde98c11d85ed1f79f8c793b1bc">giArmyAlertnessDecay</a>    = <a class="code" href="GameSettings_8cpp.html#5c32f930e2fef384505c4b91803a92c2">gGameExternalOptions</a>.<a class="code" href="structGAME__EXTERNAL__OPTIONS.html#bd01dbf15d45ed63441a5f9edc1d2068">ubEasyEnemyStartingAlertDecay</a>;
<a name="l01089"></a>01089                   <a class="code" href="Strategic_01AI_8cpp.html#12b5525b1f3dabeac40700eecd3219e7">gubMinEnemyGroupSize</a>    = <a class="code" href="GameSettings_8cpp.html#5c32f930e2fef384505c4b91803a92c2">gGameExternalOptions</a>.<a class="code" href="structGAME__EXTERNAL__OPTIONS.html#6feb6ffdabc0fc98760923f573d7bda0">ubMinEnemyGroupSizeNovice</a>;
<a name="l01090"></a>01090                   <a class="code" href="Strategic_01AI_8cpp.html#123935928b8e3146a1edda9d78cfea62">gubHoursGracePeriod</a>           = <a class="code" href="GameSettings_8cpp.html#5c32f930e2fef384505c4b91803a92c2">gGameExternalOptions</a>.<a class="code" href="structGAME__EXTERNAL__OPTIONS.html#b34f21676f59bf273de46131ecca4903">ubEasyGracePeriodInHours</a>;
<a name="l01091"></a>01091                   <a class="code" href="Strategic_01AI_8cpp.html#b0c12688f38630da4e064c85394ca570">gfUnlimitedTroops</a>       = <a class="code" href="GameSettings_8cpp.html#5c32f930e2fef384505c4b91803a92c2">gGameExternalOptions</a>.<a class="code" href="structGAME__EXTERNAL__OPTIONS.html#ce0b1841e73147375eef112a7fc789a7">gfEasyUnlimitedTroops</a>;
<a name="l01092"></a>01092                   <a class="code" href="Strategic_01AI_8cpp.html#03888c7c25d0c7d4585ed03317d64c53">gfAggressiveQueen</a>       = <a class="code" href="GameSettings_8cpp.html#5c32f930e2fef384505c4b91803a92c2">gGameExternalOptions</a>.<a class="code" href="structGAME__EXTERNAL__OPTIONS.html#5b64ee658277f3e3949d63ede9a142c9">gfEasyAggressiveQueen</a>;
<a name="l01093"></a>01093                   <span class="comment">// 475 is 7:55am in minutes since midnight, the time the game starts on day 1</span>
<a name="l01094"></a>01094                   <a class="code" href="Game_01Event_01Hook_8h.html#d0da2cc582f16f4f54f328db96d7ca56">AddStrategicEvent</a>( <a class="code" href="Game_01Event_01Hook_8h.html#08f51f22ad2ed13a25181c26045731106d744aac1461129e69ce5d43d26e5e38">EVENT_EVALUATE_QUEEN_SITUATION</a>, 475 + <a class="code" href="GameSettings_8cpp.html#5c32f930e2fef384505c4b91803a92c2">gGameExternalOptions</a>.<a class="code" href="structGAME__EXTERNAL__OPTIONS.html#ea56eea3a991ec99ea634c9262c77d22">ubEasyTimeEvaluateInMinutes</a> + <a class="code" href="Random_8cpp.html#49f938d1313ab6ef09ac6223a16ac334">Random</a>( <a class="code" href="GameSettings_8cpp.html#5c32f930e2fef384505c4b91803a92c2">gGameExternalOptions</a>.<a class="code" href="structGAME__EXTERNAL__OPTIONS.html#49bcd3e2249d457209a27d78ae551a38">ubEasyTimeEvaluateVariance</a> ), 0 );
<a name="l01095"></a>01095                   <span class="keywordflow">break</span>;
<a name="l01096"></a>01096             <span class="keywordflow">case</span> <a class="code" href="GameSettings_8h.html#c205be2172292384dd687b5471a87edddd0259b09fef163c6aa62268574191cb">DIF_LEVEL_MEDIUM</a>:
<a name="l01097"></a>01097                   <a class="code" href="AI_01Viewer_8cpp.html#c86cd58021961af10f1eb15108a79023">giReinforcementPool</a>           = <a class="code" href="GameSettings_8cpp.html#5c32f930e2fef384505c4b91803a92c2">gGameExternalOptions</a>.<a class="code" href="structGAME__EXTERNAL__OPTIONS.html#7c46a27c13d10ddb67f0038d949a129a">iReinforcementPoolExperienced</a>;
<a name="l01098"></a>01098                   <a class="code" href="Strategic_01AI_8cpp.html#dd33d20256198684ad819b0f877ba407">giForcePercentage</a>       = <a class="code" href="GameSettings_8cpp.html#5c32f930e2fef384505c4b91803a92c2">gGameExternalOptions</a>.<a class="code" href="structGAME__EXTERNAL__OPTIONS.html#a5ba6f10d5e11194b09b95b94f41e544">iForcePercentageExperienced</a>;
<a name="l01099"></a>01099                   <a class="code" href="Strategic_01AI_8cpp.html#5ca96833bf812b9e43da8510ca54f00a">giArmyAlertness</a>               = <a class="code" href="GameSettings_8cpp.html#5c32f930e2fef384505c4b91803a92c2">gGameExternalOptions</a>.<a class="code" href="structGAME__EXTERNAL__OPTIONS.html#03f86b5e03613ce49df099ddbee49657">ubNormalEnemyStartingAlertLevel</a>;
<a name="l01100"></a>01100                   <a class="code" href="Strategic_01AI_8cpp.html#1bdeafde98c11d85ed1f79f8c793b1bc">giArmyAlertnessDecay</a>    = <a class="code" href="GameSettings_8cpp.html#5c32f930e2fef384505c4b91803a92c2">gGameExternalOptions</a>.<a class="code" href="structGAME__EXTERNAL__OPTIONS.html#b841801153b50695e54aa98b8e0457db">ubNormalEnemyStartingAlertDecay</a>;
<a name="l01101"></a>01101                   <a class="code" href="Strategic_01AI_8cpp.html#12b5525b1f3dabeac40700eecd3219e7">gubMinEnemyGroupSize</a>    = <a class="code" href="GameSettings_8cpp.html#5c32f930e2fef384505c4b91803a92c2">gGameExternalOptions</a>.<a class="code" href="structGAME__EXTERNAL__OPTIONS.html#6448720253bb2c9c1c604265d68174d1">ubMinEnemyGroupSizeExperienced</a>;
<a name="l01102"></a>01102                   <a class="code" href="Strategic_01AI_8cpp.html#123935928b8e3146a1edda9d78cfea62">gubHoursGracePeriod</a>           = <a class="code" href="GameSettings_8cpp.html#5c32f930e2fef384505c4b91803a92c2">gGameExternalOptions</a>.<a class="code" href="structGAME__EXTERNAL__OPTIONS.html#f311913ac75af0ea6823b58edb26246d">ubNormalGracePeriodInHours</a>;
<a name="l01103"></a>01103                   <a class="code" href="Strategic_01AI_8cpp.html#b0c12688f38630da4e064c85394ca570">gfUnlimitedTroops</a>       = <a class="code" href="GameSettings_8cpp.html#5c32f930e2fef384505c4b91803a92c2">gGameExternalOptions</a>.<a class="code" href="structGAME__EXTERNAL__OPTIONS.html#a015dbdb4e0859bc29d210f209e64759">gfNormalUnlimitedTroops</a>;
<a name="l01104"></a>01104                   <a class="code" href="Strategic_01AI_8cpp.html#03888c7c25d0c7d4585ed03317d64c53">gfAggressiveQueen</a>       = <a class="code" href="GameSettings_8cpp.html#5c32f930e2fef384505c4b91803a92c2">gGameExternalOptions</a>.<a class="code" href="structGAME__EXTERNAL__OPTIONS.html#5560e0e72a4b803607cba627293af00a">gfNormalAggressiveQueen</a>;
<a name="l01105"></a>01105                   <a class="code" href="Game_01Event_01Hook_8h.html#d0da2cc582f16f4f54f328db96d7ca56">AddStrategicEvent</a>( <a class="code" href="Game_01Event_01Hook_8h.html#08f51f22ad2ed13a25181c26045731106d744aac1461129e69ce5d43d26e5e38">EVENT_EVALUATE_QUEEN_SITUATION</a>, 475 + <a class="code" href="GameSettings_8cpp.html#5c32f930e2fef384505c4b91803a92c2">gGameExternalOptions</a>.<a class="code" href="structGAME__EXTERNAL__OPTIONS.html#d49134f2a25ff2407c8862336bd28aa7">ubNormalTimeEvaluateInMinutes</a> + <a class="code" href="Random_8cpp.html#49f938d1313ab6ef09ac6223a16ac334">Random</a>( <a class="code" href="GameSettings_8cpp.html#5c32f930e2fef384505c4b91803a92c2">gGameExternalOptions</a>.<a class="code" href="structGAME__EXTERNAL__OPTIONS.html#4ae4f161c6f4c5ab91ba9162f3580b3f">ubNormalTimeEvaluateVariance</a> ), 0 );
<a name="l01106"></a>01106                   <span class="keywordflow">break</span>;
<a name="l01107"></a>01107             <span class="keywordflow">case</span> <a class="code" href="GameSettings_8h.html#c205be2172292384dd687b5471a87edd3d0b73026f1c7122798d578613aa4575">DIF_LEVEL_HARD</a>:
<a name="l01108"></a>01108                   <a class="code" href="AI_01Viewer_8cpp.html#c86cd58021961af10f1eb15108a79023">giReinforcementPool</a>           = <a class="code" href="GameSettings_8cpp.html#5c32f930e2fef384505c4b91803a92c2">gGameExternalOptions</a>.<a class="code" href="structGAME__EXTERNAL__OPTIONS.html#9fff267a198d9e7a4d80d14059a43132">iReinforcementPoolExpert</a>;
<a name="l01109"></a>01109                   <a class="code" href="Strategic_01AI_8cpp.html#dd33d20256198684ad819b0f877ba407">giForcePercentage</a>       = <a class="code" href="GameSettings_8cpp.html#5c32f930e2fef384505c4b91803a92c2">gGameExternalOptions</a>.<a class="code" href="structGAME__EXTERNAL__OPTIONS.html#e6154fdb8a2b6aa92a9513d84b03481f">iForcePercentageExpert</a>;
<a name="l01110"></a>01110                   <a class="code" href="Strategic_01AI_8cpp.html#5ca96833bf812b9e43da8510ca54f00a">giArmyAlertness</a>               = <a class="code" href="GameSettings_8cpp.html#5c32f930e2fef384505c4b91803a92c2">gGameExternalOptions</a>.<a class="code" href="structGAME__EXTERNAL__OPTIONS.html#17219c0ec7012f727c35196dc791af3f">ubHardEnemyStartingAlertLevel</a>;
<a name="l01111"></a>01111                   <a class="code" href="Strategic_01AI_8cpp.html#1bdeafde98c11d85ed1f79f8c793b1bc">giArmyAlertnessDecay</a>    = <a class="code" href="GameSettings_8cpp.html#5c32f930e2fef384505c4b91803a92c2">gGameExternalOptions</a>.<a class="code" href="structGAME__EXTERNAL__OPTIONS.html#f111e645302a15d1f5529336f84e4f23">ubHardEnemyStartingAlertDecay</a>;
<a name="l01112"></a>01112                   <a class="code" href="Strategic_01AI_8cpp.html#12b5525b1f3dabeac40700eecd3219e7">gubMinEnemyGroupSize</a>    = <a class="code" href="GameSettings_8cpp.html#5c32f930e2fef384505c4b91803a92c2">gGameExternalOptions</a>.<a class="code" href="structGAME__EXTERNAL__OPTIONS.html#efa2a6b11c8b3eda330a508dd2ced711">ubMinEnemyGroupSizeExpert</a>;
<a name="l01113"></a>01113                   <a class="code" href="Strategic_01AI_8cpp.html#123935928b8e3146a1edda9d78cfea62">gubHoursGracePeriod</a>           = <a class="code" href="GameSettings_8cpp.html#5c32f930e2fef384505c4b91803a92c2">gGameExternalOptions</a>.<a class="code" href="structGAME__EXTERNAL__OPTIONS.html#9fe0d79eb894a6ad84e7b8564f564397">ubHardGracePeriodInHours</a>;
<a name="l01114"></a>01114                   <a class="code" href="Strategic_01AI_8cpp.html#b0c12688f38630da4e064c85394ca570">gfUnlimitedTroops</a>       = <a class="code" href="GameSettings_8cpp.html#5c32f930e2fef384505c4b91803a92c2">gGameExternalOptions</a>.<a class="code" href="structGAME__EXTERNAL__OPTIONS.html#381f7d196f5798b965377b9ba625e4c3">gfHardUnlimitedTroops</a>;
<a name="l01115"></a>01115                   <a class="code" href="Strategic_01AI_8cpp.html#03888c7c25d0c7d4585ed03317d64c53">gfAggressiveQueen</a>       = <a class="code" href="GameSettings_8cpp.html#5c32f930e2fef384505c4b91803a92c2">gGameExternalOptions</a>.<a class="code" href="structGAME__EXTERNAL__OPTIONS.html#e50e2b0a6bdad88843de4764ef837b7f">gfHardAggressiveQueen</a>;
<a name="l01116"></a>01116                   <a class="code" href="Game_01Event_01Hook_8h.html#d0da2cc582f16f4f54f328db96d7ca56">AddStrategicEvent</a>( <a class="code" href="Game_01Event_01Hook_8h.html#08f51f22ad2ed13a25181c26045731106d744aac1461129e69ce5d43d26e5e38">EVENT_EVALUATE_QUEEN_SITUATION</a>, 475 + <a class="code" href="GameSettings_8cpp.html#5c32f930e2fef384505c4b91803a92c2">gGameExternalOptions</a>.<a class="code" href="structGAME__EXTERNAL__OPTIONS.html#a2bc7bf5bbc738000128198bf5f2e3ef">ubHardTimeEvaluateInMinutes</a> + <a class="code" href="Random_8cpp.html#49f938d1313ab6ef09ac6223a16ac334">Random</a>( <a class="code" href="GameSettings_8cpp.html#5c32f930e2fef384505c4b91803a92c2">gGameExternalOptions</a>.<a class="code" href="structGAME__EXTERNAL__OPTIONS.html#d616bea88239bb4a6269680261501ffd">ubHardTimeEvaluateVariance</a> ), 0 );
<a name="l01117"></a>01117                   <span class="keywordflow">break</span>;
<a name="l01118"></a>01118             <span class="keywordflow">case</span> <a class="code" href="GameSettings_8h.html#c205be2172292384dd687b5471a87eddc657c89fd754a6f20b3869250288a702">DIF_LEVEL_INSANE</a>:
<a name="l01119"></a>01119                   <a class="code" href="AI_01Viewer_8cpp.html#c86cd58021961af10f1eb15108a79023">giReinforcementPool</a>           = <a class="code" href="GameSettings_8cpp.html#5c32f930e2fef384505c4b91803a92c2">gGameExternalOptions</a>.<a class="code" href="structGAME__EXTERNAL__OPTIONS.html#2241d4cd9499dcad07964d01b16b8b3d">iReinforcementPoolInsane</a>;
<a name="l01120"></a>01120                   <a class="code" href="Strategic_01AI_8cpp.html#dd33d20256198684ad819b0f877ba407">giForcePercentage</a>       = <a class="code" href="GameSettings_8cpp.html#5c32f930e2fef384505c4b91803a92c2">gGameExternalOptions</a>.<a class="code" href="structGAME__EXTERNAL__OPTIONS.html#644996d7fdcbb7336ff30e3f4b5735a5">iForcePercentageInsane</a>;
<a name="l01121"></a>01121                   <a class="code" href="Strategic_01AI_8cpp.html#5ca96833bf812b9e43da8510ca54f00a">giArmyAlertness</a>               = <a class="code" href="GameSettings_8cpp.html#5c32f930e2fef384505c4b91803a92c2">gGameExternalOptions</a>.<a class="code" href="structGAME__EXTERNAL__OPTIONS.html#09033303474bffd588e7e4881c554787">ubInsaneEnemyStartingAlertLevel</a>;
<a name="l01122"></a>01122                   <a class="code" href="Strategic_01AI_8cpp.html#1bdeafde98c11d85ed1f79f8c793b1bc">giArmyAlertnessDecay</a>    = <a class="code" href="GameSettings_8cpp.html#5c32f930e2fef384505c4b91803a92c2">gGameExternalOptions</a>.<a class="code" href="structGAME__EXTERNAL__OPTIONS.html#2c26c9ee732874072e0b89a7f9e2800d">ubInsaneEnemyStartingAlertDecay</a>;
<a name="l01123"></a>01123                   <a class="code" href="Strategic_01AI_8cpp.html#12b5525b1f3dabeac40700eecd3219e7">gubMinEnemyGroupSize</a>    = <a class="code" href="GameSettings_8cpp.html#5c32f930e2fef384505c4b91803a92c2">gGameExternalOptions</a>.<a class="code" href="structGAME__EXTERNAL__OPTIONS.html#ea306f5856e2c032d7fc5e4fe5cfe2a9">ubMinEnemyGroupSizeInsane</a>;
<a name="l01124"></a>01124                   <a class="code" href="Strategic_01AI_8cpp.html#123935928b8e3146a1edda9d78cfea62">gubHoursGracePeriod</a>           = <a class="code" href="GameSettings_8cpp.html#5c32f930e2fef384505c4b91803a92c2">gGameExternalOptions</a>.<a class="code" href="structGAME__EXTERNAL__OPTIONS.html#433a24a600f13933dbedcd7263f5ceb9">ubInsaneGracePeriodInHours</a>;
<a name="l01125"></a>01125                   <a class="code" href="Strategic_01AI_8cpp.html#b0c12688f38630da4e064c85394ca570">gfUnlimitedTroops</a>       = <a class="code" href="GameSettings_8cpp.html#5c32f930e2fef384505c4b91803a92c2">gGameExternalOptions</a>.<a class="code" href="structGAME__EXTERNAL__OPTIONS.html#2e45c38dbae63f7ea59a8731fec8b2a7">gfInsaneUnlimitedTroops</a>;
<a name="l01126"></a>01126                   <a class="code" href="Strategic_01AI_8cpp.html#03888c7c25d0c7d4585ed03317d64c53">gfAggressiveQueen</a>       = <a class="code" href="GameSettings_8cpp.html#5c32f930e2fef384505c4b91803a92c2">gGameExternalOptions</a>.<a class="code" href="structGAME__EXTERNAL__OPTIONS.html#8c6aa4c5c98627e10cba4fcad4fffead">gfInsaneAggressiveQueen</a>;
<a name="l01127"></a>01127                   <a class="code" href="Game_01Event_01Hook_8h.html#d0da2cc582f16f4f54f328db96d7ca56">AddStrategicEvent</a>( <a class="code" href="Game_01Event_01Hook_8h.html#08f51f22ad2ed13a25181c26045731106d744aac1461129e69ce5d43d26e5e38">EVENT_EVALUATE_QUEEN_SITUATION</a>, 475 + <a class="code" href="GameSettings_8cpp.html#5c32f930e2fef384505c4b91803a92c2">gGameExternalOptions</a>.<a class="code" href="structGAME__EXTERNAL__OPTIONS.html#63664e4c9238b259b953b245a4a65401">ubInsaneTimeEvaluateInMinutes</a> + <a class="code" href="Random_8cpp.html#49f938d1313ab6ef09ac6223a16ac334">Random</a>( <a class="code" href="GameSettings_8cpp.html#5c32f930e2fef384505c4b91803a92c2">gGameExternalOptions</a>.<a class="code" href="structGAME__EXTERNAL__OPTIONS.html#a0a8f2b23df1c6be8651cb209d5788a2">ubInsaneTimeEvaluateVariance</a> ), 0 );
<a name="l01128"></a>01128                   <span class="keywordflow">break</span>;
<a name="l01129"></a>01129       }
<a name="l01130"></a>01130 
<a name="l01131"></a>01131       <span class="comment">//Initialize the sectorinfo structure so all sectors don't point to a garrisonID.</span>
<a name="l01132"></a>01132       <span class="keywordflow">for</span>( i = 0; i &lt;= 255; i++ )
<a name="l01133"></a>01133       {
<a name="l01134"></a>01134             <a class="code" href="Campaign_01Types_8h.html#d83c6f699f17a47cf6a662c91d959126">SectorInfo</a>[ i ].ubGarrisonID = NO_GARRISON;
<a name="l01135"></a>01135       }
<a name="l01136"></a>01136 
<a name="l01137"></a>01137       <span class="comment">//copy over the original army composition as it does get modified during the campaign.  This</span>
<a name="l01138"></a>01138       <span class="comment">//bulletproofs starting the game over again.</span>
<a name="l01139"></a>01139       memcpy( <a class="code" href="AI_01Viewer_8cpp.html#77e448d1f208bd120f861571e6d0098f">gArmyComp</a>, <a class="code" href="Strategic_01AI_8cpp.html#ea7005fc7ef74a7dbbc1cb66d6520a89">gOrigArmyComp</a>, <span class="keyword">sizeof</span>( gArmyComp ) );
<a name="l01140"></a>01140 
<a name="l01141"></a>01141       <span class="comment">//Eliminate more perimeter defenses on the easier levels.</span>
<a name="l01142"></a>01142       <span class="keywordflow">switch</span>( <a class="code" href="GameSettings_8cpp.html#f9f2d5fd368ccadcc26bebc202d52ae7">gGameOptions</a>.<a class="code" href="structGAME__OPTIONS.html#4fb44167906152722f6af5cc9f7c1a99">ubDifficultyLevel</a> )
<a name="l01143"></a>01143       {
<a name="l01144"></a>01144             <span class="keywordflow">case</span> <a class="code" href="GameSettings_8h.html#c205be2172292384dd687b5471a87eddbd3b0d23f4dc30ef17b50a14c3f54589">DIF_LEVEL_EASY</a>:
<a name="l01145"></a>01145                   gArmyComp[ <a class="code" href="Strategic_01AI_8h.html#a9908284c0827729f14cf9b2489e1479a20161605655b8a279cc33b5b05ef22e">LEVEL2_DEFENCE</a> ].bDesiredPopulation = 0;
<a name="l01146"></a>01146                   gArmyComp[ <a class="code" href="Strategic_01AI_8h.html#a9908284c0827729f14cf9b2489e1479a20161605655b8a279cc33b5b05ef22e">LEVEL2_DEFENCE</a> ].bStartPopulation = 0;
<a name="l01147"></a>01147                   gArmyComp[ <a class="code" href="Strategic_01AI_8h.html#a9908284c0827729f14cf9b2489e1479af824648f2c39e0defaa7dc6488a18b6">LEVEL3_DEFENCE</a> ].bDesiredPopulation = 0;
<a name="l01148"></a>01148                   gArmyComp[ <a class="code" href="Strategic_01AI_8h.html#a9908284c0827729f14cf9b2489e1479af824648f2c39e0defaa7dc6488a18b6">LEVEL3_DEFENCE</a> ].bStartPopulation = 0;
<a name="l01149"></a>01149                   <span class="keywordflow">break</span>;
<a name="l01150"></a>01150                   <span class="comment">// Kaiden: original Experienced troop compositions:</span>
<a name="l01151"></a>01151               <span class="comment">//case DIF_LEVEL_MEDIUM:</span>
<a name="l01152"></a>01152                   <span class="comment">//gArmyComp[ LEVEL3_DEFENCE ].bDesiredPopulation = 0;</span>
<a name="l01153"></a>01153                   <span class="comment">//gArmyComp[ LEVEL3_DEFENCE ].bStartPopulation = 0;</span>
<a name="l01154"></a>01154                   <span class="comment">//break;</span>
<a name="l01155"></a>01155 
<a name="l01156"></a>01156             <span class="comment">//Kaiden: Added to allow an elite bonus for experienced.</span>
<a name="l01157"></a>01157             <span class="keywordflow">case</span> <a class="code" href="GameSettings_8h.html#c205be2172292384dd687b5471a87edddd0259b09fef163c6aa62268574191cb">DIF_LEVEL_MEDIUM</a>:
<a name="l01158"></a>01158                   <span class="keywordflow">for</span>( i = 0; i &lt;= <a class="code" href="Strategic_01AI_8h.html#a9908284c0827729f14cf9b2489e1479d2a0278d1458eaa8c2bb99d2d4b55f00">NUM_ARMY_COMPOSITIONS</a>; i++ )
<a name="l01159"></a>01159                   {
<a name="l01160"></a>01160                         <span class="keywordflow">if</span> ( i != <a class="code" href="Strategic_01AI_8h.html#a9908284c0827729f14cf9b2489e1479f2728e546e13a252b4ab14fb153f189f">OMERTA_WELCOME_WAGON</a> )
<a name="l01161"></a>01161                         {
<a name="l01162"></a>01162                               iPercentElitesBonus = <a class="code" href="GameSettings_8cpp.html#5c32f930e2fef384505c4b91803a92c2">gGameExternalOptions</a>.<a class="code" href="structGAME__EXTERNAL__OPTIONS.html#64761ef275fd913bab36f7138d0b40ac">iPercentElitesBonusExperienced</a>;
<a name="l01163"></a>01163                               gArmyComp[ i ].bElitePercentage = min(100,gArmyComp[ i ].bElitePercentage + iPercentElitesBonus);
<a name="l01164"></a>01164                               gArmyComp[ i ].bTroopPercentage = max(0,gArmyComp[ i ].bTroopPercentage - iPercentElitesBonus);
<a name="l01165"></a>01165                               gArmyComp[ i ].bAdminPercentage = 0;
<a name="l01166"></a>01166                         }
<a name="l01167"></a>01167                   }
<a name="l01168"></a>01168                   <span class="keywordflow">break</span>;
<a name="l01169"></a>01169             <span class="keywordflow">case</span> <a class="code" href="GameSettings_8h.html#c205be2172292384dd687b5471a87edd3d0b73026f1c7122798d578613aa4575">DIF_LEVEL_HARD</a>:
<a name="l01170"></a>01170                   <span class="keywordflow">for</span>( i = 0; i &lt;= <a class="code" href="Strategic_01AI_8h.html#a9908284c0827729f14cf9b2489e1479d2a0278d1458eaa8c2bb99d2d4b55f00">NUM_ARMY_COMPOSITIONS</a>; i++ )
<a name="l01171"></a>01171                   {
<a name="l01172"></a>01172                         <span class="keywordflow">if</span> ( i != <a class="code" href="Strategic_01AI_8h.html#a9908284c0827729f14cf9b2489e1479f2728e546e13a252b4ab14fb153f189f">OMERTA_WELCOME_WAGON</a> )
<a name="l01173"></a>01173                         {
<a name="l01174"></a>01174                               iPercentElitesBonus = <a class="code" href="GameSettings_8cpp.html#5c32f930e2fef384505c4b91803a92c2">gGameExternalOptions</a>.<a class="code" href="structGAME__EXTERNAL__OPTIONS.html#a52fc254310a3593dd97101e475200d4">iPercentElitesBonusExpert</a>;
<a name="l01175"></a>01175                               gArmyComp[ i ].bElitePercentage = min(100,gArmyComp[ i ].bElitePercentage + iPercentElitesBonus);
<a name="l01176"></a>01176                               gArmyComp[ i ].bTroopPercentage = max(0,gArmyComp[ i ].bTroopPercentage - iPercentElitesBonus);
<a name="l01177"></a>01177                               gArmyComp[ i ].bAdminPercentage = 0;
<a name="l01178"></a>01178                         }
<a name="l01179"></a>01179                   }
<a name="l01180"></a>01180             <span class="keywordflow">case</span> <a class="code" href="GameSettings_8h.html#c205be2172292384dd687b5471a87eddc657c89fd754a6f20b3869250288a702">DIF_LEVEL_INSANE</a>:
<a name="l01181"></a>01181                   <span class="keywordflow">for</span>( i = 0; i &lt;= <a class="code" href="Strategic_01AI_8h.html#a9908284c0827729f14cf9b2489e1479d2a0278d1458eaa8c2bb99d2d4b55f00">NUM_ARMY_COMPOSITIONS</a>; i++ )
<a name="l01182"></a>01182                   {
<a name="l01183"></a>01183                         <span class="keywordflow">if</span> ( i != <a class="code" href="Strategic_01AI_8h.html#a9908284c0827729f14cf9b2489e1479f2728e546e13a252b4ab14fb153f189f">OMERTA_WELCOME_WAGON</a> )
<a name="l01184"></a>01184                         {
<a name="l01185"></a>01185                               iPercentElitesBonus = <a class="code" href="GameSettings_8cpp.html#5c32f930e2fef384505c4b91803a92c2">gGameExternalOptions</a>.<a class="code" href="structGAME__EXTERNAL__OPTIONS.html#fcf890784f2378136d5e453151a6eb7d">iPercentElitesBonusInsane</a>;
<a name="l01186"></a>01186                               gArmyComp[ i ].bElitePercentage = min(100,gArmyComp[ i ].bElitePercentage + iPercentElitesBonus);
<a name="l01187"></a>01187                               gArmyComp[ i ].bTroopPercentage = max(0,gArmyComp[ i ].bTroopPercentage - iPercentElitesBonus);
<a name="l01188"></a>01188                               gArmyComp[ i ].bAdminPercentage = 0;
<a name="l01189"></a>01189                         }
<a name="l01190"></a>01190                   }
<a name="l01191"></a>01191                   <span class="keywordflow">break</span>;
<a name="l01192"></a>01192       }
<a name="l01193"></a>01193       <span class="comment">//initialize the patrol group definitions</span>
<a name="l01194"></a>01194       <a class="code" href="Strategic_01AI_8cpp.html#8c839f77f7a78de6ff920d5943d834d7">giPatrolArraySize</a> = <span class="keyword">sizeof</span>( <a class="code" href="Strategic_01AI_8cpp.html#29576ac73bb4a2dfda85c992420d5b76">gOrigPatrolGroup</a> ) / <span class="keyword">sizeof</span>( <a class="code" href="structPATROL__GROUP.html">PATROL_GROUP</a> );
<a name="l01195"></a>01195       <span class="keywordflow">if</span>( !<a class="code" href="Strategic_01AI_8cpp.html#9e00ccb0e77cec57208c519e8f831f53">gPatrolGroup</a> )
<a name="l01196"></a>01196       { <span class="comment">//Allocate it (otherwise, we just overwrite it because the size never changes)</span>
<a name="l01197"></a>01197             <a class="code" href="Strategic_01AI_8cpp.html#9e00ccb0e77cec57208c519e8f831f53">gPatrolGroup</a> = (PATROL_GROUP*)MemAlloc( <span class="keyword">sizeof</span>( <a class="code" href="Strategic_01AI_8cpp.html#29576ac73bb4a2dfda85c992420d5b76">gOrigPatrolGroup</a> ) );
<a name="l01198"></a>01198             Assert( <a class="code" href="Strategic_01AI_8cpp.html#9e00ccb0e77cec57208c519e8f831f53">gPatrolGroup</a> );
<a name="l01199"></a>01199       }
<a name="l01200"></a>01200       memcpy( <a class="code" href="Strategic_01AI_8cpp.html#9e00ccb0e77cec57208c519e8f831f53">gPatrolGroup</a>, <a class="code" href="Strategic_01AI_8cpp.html#29576ac73bb4a2dfda85c992420d5b76">gOrigPatrolGroup</a>, <span class="keyword">sizeof</span>( <a class="code" href="Strategic_01AI_8cpp.html#29576ac73bb4a2dfda85c992420d5b76">gOrigPatrolGroup</a> ) );
<a name="l01201"></a>01201 
<a name="l01202"></a>01202       <a class="code" href="Strategic_01AI_8cpp.html#48e0403413b13dc086dc70c6921ee186">gubPatrolReinforcementsDenied</a> = (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>*)MemAlloc( <a class="code" href="Strategic_01AI_8cpp.html#8c839f77f7a78de6ff920d5943d834d7">giPatrolArraySize</a> );
<a name="l01203"></a>01203       memset( <a class="code" href="Strategic_01AI_8cpp.html#48e0403413b13dc086dc70c6921ee186">gubPatrolReinforcementsDenied</a>, 0, <a class="code" href="Strategic_01AI_8cpp.html#8c839f77f7a78de6ff920d5943d834d7">giPatrolArraySize</a> );
<a name="l01204"></a>01204 
<a name="l01205"></a>01205       <span class="comment">//initialize the garrison group definitions</span>
<a name="l01206"></a>01206       giGarrisonArraySize = <span class="keyword">sizeof</span>( <a class="code" href="Strategic_01AI_8cpp.html#1e061009151dfe20eccb5f27432fab59">gOrigGarrisonGroup</a> ) / <span class="keyword">sizeof</span>( <a class="code" href="structGARRISON__GROUP.html">GARRISON_GROUP</a> );
<a name="l01207"></a>01207       <span class="keywordflow">if</span>( !<a class="code" href="AI_01Viewer_8cpp.html#a9f940d7f3a6d6698bfaeb7c747d74a9">gGarrisonGroup</a> )
<a name="l01208"></a>01208       {
<a name="l01209"></a>01209             <a class="code" href="AI_01Viewer_8cpp.html#a9f940d7f3a6d6698bfaeb7c747d74a9">gGarrisonGroup</a> = (GARRISON_GROUP*)MemAlloc( <span class="keyword">sizeof</span>( <a class="code" href="Strategic_01AI_8cpp.html#1e061009151dfe20eccb5f27432fab59">gOrigGarrisonGroup</a> ) );
<a name="l01210"></a>01210             Assert( <a class="code" href="AI_01Viewer_8cpp.html#a9f940d7f3a6d6698bfaeb7c747d74a9">gGarrisonGroup</a> );
<a name="l01211"></a>01211       }
<a name="l01212"></a>01212       memcpy( <a class="code" href="AI_01Viewer_8cpp.html#a9f940d7f3a6d6698bfaeb7c747d74a9">gGarrisonGroup</a>, <a class="code" href="Strategic_01AI_8cpp.html#1e061009151dfe20eccb5f27432fab59">gOrigGarrisonGroup</a>, <span class="keyword">sizeof</span>( <a class="code" href="Strategic_01AI_8cpp.html#1e061009151dfe20eccb5f27432fab59">gOrigGarrisonGroup</a> ) );
<a name="l01213"></a>01213       
<a name="l01214"></a>01214       <a class="code" href="Strategic_01AI_8cpp.html#9bc393a708632bfedc7ce82ab9268709">gubGarrisonReinforcementsDenied</a> = (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>*)MemAlloc( giGarrisonArraySize );
<a name="l01215"></a>01215       memset( <a class="code" href="Strategic_01AI_8cpp.html#9bc393a708632bfedc7ce82ab9268709">gubGarrisonReinforcementsDenied</a>, 0, giGarrisonArraySize );
<a name="l01216"></a>01216 
<a name="l01217"></a>01217       <span class="comment">//Modify initial force sizes?</span>
<a name="l01218"></a>01218       <span class="keywordflow">if</span>( <a class="code" href="Strategic_01AI_8cpp.html#dd33d20256198684ad819b0f877ba407">giForcePercentage</a> != 100 )
<a name="l01219"></a>01219       { <span class="comment">//The initial force sizes are being modified, so go through each of the army compositions</span>
<a name="l01220"></a>01220             <span class="comment">//and adjust them accordingly.</span>
<a name="l01221"></a>01221             <span class="keywordflow">for</span>( i = 0; i &lt; <a class="code" href="Strategic_01AI_8h.html#a9908284c0827729f14cf9b2489e1479d2a0278d1458eaa8c2bb99d2d4b55f00">NUM_ARMY_COMPOSITIONS</a>; i++ )
<a name="l01222"></a>01222             {
<a name="l01223"></a>01223                   <span class="keywordflow">if</span>( i != <a class="code" href="Strategic_01AI_8h.html#a9908284c0827729f14cf9b2489e147965167f5cd578be3792270cad11996571">QUEEN_DEFENCE</a> )
<a name="l01224"></a>01224                   {
<a name="l01225"></a>01225                         gArmyComp[ i ].bDesiredPopulation = (<a class="code" href="Types_8h.html#7ebe70ceca856797319175e30bcf003d">INT8</a>)min( iMaxEnemyGroupSize, (gArmyComp[ i ].bDesiredPopulation * <a class="code" href="Strategic_01AI_8cpp.html#dd33d20256198684ad819b0f877ba407">giForcePercentage</a> / 100) );
<a name="l01226"></a>01226                         <span class="keywordflow">if</span>( gArmyComp[ i ].bStartPopulation != iMaxEnemyGroupSize )
<a name="l01227"></a>01227                         { <span class="comment">//if the value is MAX_STRATEGIC_TEAM_SIZE, then that means the particular sector is a spawning location.  </span>
<a name="l01228"></a>01228                               <span class="comment">//Don't modify the value if it is MAX_STRATEGIC_TEAM_SIZE.  Everything else is game.</span>
<a name="l01229"></a>01229                               gArmyComp[ i ].bStartPopulation = (<a class="code" href="Types_8h.html#7ebe70ceca856797319175e30bcf003d">INT8</a>)min( iMaxEnemyGroupSize, (gArmyComp[ i ].bStartPopulation * <a class="code" href="Strategic_01AI_8cpp.html#dd33d20256198684ad819b0f877ba407">giForcePercentage</a> / 100) );
<a name="l01230"></a>01230                         }
<a name="l01231"></a>01231                   }
<a name="l01232"></a>01232                   <span class="keywordflow">else</span>
<a name="l01233"></a>01233                   {
<a name="l01234"></a>01234                         gArmyComp[ i ].bDesiredPopulation = (<a class="code" href="Types_8h.html#7ebe70ceca856797319175e30bcf003d">INT8</a>)min( 32, (gArmyComp[ i ].bDesiredPopulation * <a class="code" href="Strategic_01AI_8cpp.html#dd33d20256198684ad819b0f877ba407">giForcePercentage</a> / 100) );
<a name="l01235"></a>01235                         gArmyComp[ i ].bStartPopulation = gArmyComp[ i ].bDesiredPopulation;
<a name="l01236"></a>01236                   }
<a name="l01237"></a>01237             }
<a name="l01238"></a>01238             <span class="keywordflow">for</span>( i = 0; i &lt; <a class="code" href="Strategic_01AI_8cpp.html#8c839f77f7a78de6ff920d5943d834d7">giPatrolArraySize</a>; i++ )
<a name="l01239"></a>01239             { <span class="comment">//force modified range within 1-MAX_STRATEGIC_TEAM_SIZE.</span>
<a name="l01240"></a>01240                   <a class="code" href="Strategic_01AI_8cpp.html#9e00ccb0e77cec57208c519e8f831f53">gPatrolGroup</a>[ i ].bSize = (<a class="code" href="Types_8h.html#7ebe70ceca856797319175e30bcf003d">INT8</a>)max( <a class="code" href="Strategic_01AI_8cpp.html#12b5525b1f3dabeac40700eecd3219e7">gubMinEnemyGroupSize</a>, min( iMaxEnemyGroupSize, (<a class="code" href="Strategic_01AI_8cpp.html#9e00ccb0e77cec57208c519e8f831f53">gPatrolGroup</a>[ i ].bSize * <a class="code" href="Strategic_01AI_8cpp.html#dd33d20256198684ad819b0f877ba407">giForcePercentage</a> / 100 ) ) );
<a name="l01241"></a>01241             }
<a name="l01242"></a>01242       }
<a name="l01243"></a>01243 
<a name="l01244"></a>01244       <span class="comment">//Now, initialize the garrisons based on the initial sizes (all variances are plus or minus 1).</span>
<a name="l01245"></a>01245       <span class="keywordflow">for</span>( i = 0; i &lt; giGarrisonArraySize; i++ )
<a name="l01246"></a>01246       {
<a name="l01247"></a>01247             pSector = &amp;<a class="code" href="Campaign_01Types_8h.html#d83c6f699f17a47cf6a662c91d959126">SectorInfo</a>[ <a class="code" href="AI_01Viewer_8cpp.html#a9f940d7f3a6d6698bfaeb7c747d74a9">gGarrisonGroup</a>[ i ].ubSectorID ];
<a name="l01248"></a>01248             pSector-&gt;<a class="code" href="structSECTORINFO.html#9465931dad0e164d7d47814b66e454f0">ubGarrisonID</a> = (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)i;
<a name="l01249"></a>01249             iStartPop = gArmyComp[ <a class="code" href="AI_01Viewer_8cpp.html#a9f940d7f3a6d6698bfaeb7c747d74a9">gGarrisonGroup</a>[ i ].<a class="code" href="structGARRISON__GROUP.html#a8feee88c982ca594b5bb1fcd2971ea5">ubComposition</a> ].bStartPopulation;
<a name="l01250"></a>01250             iDesiredPop = gArmyComp[ <a class="code" href="AI_01Viewer_8cpp.html#a9f940d7f3a6d6698bfaeb7c747d74a9">gGarrisonGroup</a>[ i ].<a class="code" href="structGARRISON__GROUP.html#a8feee88c982ca594b5bb1fcd2971ea5">ubComposition</a> ].bDesiredPopulation;
<a name="l01251"></a>01251             iPriority = gArmyComp[ <a class="code" href="AI_01Viewer_8cpp.html#a9f940d7f3a6d6698bfaeb7c747d74a9">gGarrisonGroup</a>[ i ].<a class="code" href="structGARRISON__GROUP.html#a8feee88c982ca594b5bb1fcd2971ea5">ubComposition</a> ].bPriority;
<a name="l01252"></a>01252             iEliteChance = gArmyComp[ <a class="code" href="AI_01Viewer_8cpp.html#a9f940d7f3a6d6698bfaeb7c747d74a9">gGarrisonGroup</a>[ i ].<a class="code" href="structGARRISON__GROUP.html#a8feee88c982ca594b5bb1fcd2971ea5">ubComposition</a> ].bElitePercentage;
<a name="l01253"></a>01253             iTroopChance = gArmyComp[ <a class="code" href="AI_01Viewer_8cpp.html#a9f940d7f3a6d6698bfaeb7c747d74a9">gGarrisonGroup</a>[ i ].<a class="code" href="structGARRISON__GROUP.html#a8feee88c982ca594b5bb1fcd2971ea5">ubComposition</a> ].bTroopPercentage + iEliteChance;
<a name="l01254"></a>01254             iAdminChance = gArmyComp[ <a class="code" href="AI_01Viewer_8cpp.html#a9f940d7f3a6d6698bfaeb7c747d74a9">gGarrisonGroup</a>[ i ].<a class="code" href="structGARRISON__GROUP.html#a8feee88c982ca594b5bb1fcd2971ea5">ubComposition</a> ].bAdminPercentage;
<a name="l01255"></a>01255 
<a name="l01256"></a>01256             <span class="keywordflow">switch</span>( <a class="code" href="AI_01Viewer_8cpp.html#a9f940d7f3a6d6698bfaeb7c747d74a9">gGarrisonGroup</a>[ i ].ubComposition )
<a name="l01257"></a>01257             {
<a name="l01258"></a>01258                   <span class="keywordflow">case</span> <a class="code" href="Strategic_01AI_8h.html#a9908284c0827729f14cf9b2489e14791d6fc6dded07a09f3dddfd8789f69eb0">ROADBLOCK</a>:
<a name="l01259"></a>01259                         pSector-&gt;<a class="code" href="structSECTORINFO.html#ee318422648cb0f466777759ced21e13">uiFlags</a> |= SF_ENEMY_AMBUSH_LOCATION;
<a name="l01260"></a>01260                         <span class="keywordflow">if</span>( <a class="code" href="Random_8cpp.html#742221657b584d8416ada22fa8ff23dd">Chance</a>( 20 ) )
<a name="l01261"></a>01261                               iStartPop = gArmyComp[ <a class="code" href="AI_01Viewer_8cpp.html#a9f940d7f3a6d6698bfaeb7c747d74a9">gGarrisonGroup</a>[ i ].ubComposition ].bDesiredPopulation;
<a name="l01262"></a>01262                         <span class="keywordflow">else</span>
<a name="l01263"></a>01263                               iStartPop = 0;
<a name="l01264"></a>01264                         <span class="keywordflow">break</span>;
<a name="l01265"></a>01265                   <span class="keywordflow">case</span> <a class="code" href="Strategic_01AI_8h.html#a9908284c0827729f14cf9b2489e14795bc62874f1fa7cac6853f847b90333e4">SANMONA_SMALL</a>:
<a name="l01266"></a>01266                         iStartPop = 0; <span class="comment">//not appropriate until Kingpin is killed.</span>
<a name="l01267"></a>01267                         <span class="keywordflow">break</span>;
<a name="l01268"></a>01268             }
<a name="l01269"></a>01269 
<a name="l01270"></a>01270             <span class="keywordflow">if</span>( iStartPop )
<a name="l01271"></a>01271             {
<a name="l01272"></a>01272                   <span class="keywordflow">if</span>( <a class="code" href="AI_01Viewer_8cpp.html#a9f940d7f3a6d6698bfaeb7c747d74a9">gGarrisonGroup</a>[ i ].ubSectorID != <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c66026438a2eb9999a6ad7c69c9ddbe2d95696ca">SEC_P3</a> )
<a name="l01273"></a>01273                   {
<a name="l01274"></a>01274                         <span class="comment">// if population is less than maximum</span>
<a name="l01275"></a>01275                         <span class="keywordflow">if</span>( iStartPop != iMaxEnemyGroupSize )
<a name="l01276"></a>01276                         {
<a name="l01277"></a>01277                               <span class="comment">// then vary it a bit (+/- 25%)</span>
<a name="l01278"></a>01278                               iStartPop = iStartPop * ( 100 + ( <a class="code" href="Random_8cpp.html#49f938d1313ab6ef09ac6223a16ac334">Random</a> ( 51 ) - 25 ) ) / 100;
<a name="l01279"></a>01279                         }
<a name="l01280"></a>01280 
<a name="l01281"></a>01281                         iStartPop = max( <a class="code" href="Strategic_01AI_8cpp.html#12b5525b1f3dabeac40700eecd3219e7">gubMinEnemyGroupSize</a>, min( iMaxEnemyGroupSize, iStartPop ) );
<a name="l01282"></a>01282                   }
<a name="l01283"></a>01283                   cnt = iStartPop;
<a name="l01284"></a>01284 
<a name="l01285"></a>01285                   <span class="keywordflow">if</span>( iAdminChance )
<a name="l01286"></a>01286                   {
<a name="l01287"></a>01287                         pSector-&gt;<a class="code" href="structSECTORINFO.html#d7d5ee63c0dc2ad3164c83541bd80906">ubNumAdmins</a> = iAdminChance * iStartPop / 100;
<a name="l01288"></a>01288                   }
<a name="l01289"></a>01289                   <span class="keywordflow">else</span> <span class="keywordflow">while</span>( cnt-- )
<a name="l01290"></a>01290                   { <span class="comment">//for each person, randomly determine the types of each soldier.</span>
<a name="l01291"></a>01291                         {
<a name="l01292"></a>01292                               iRandom = <a class="code" href="Random_8cpp.html#49f938d1313ab6ef09ac6223a16ac334">Random</a>( 100 );
<a name="l01293"></a>01293                               <span class="keywordflow">if</span>( iRandom &lt; iEliteChance )
<a name="l01294"></a>01294                               {
<a name="l01295"></a>01295                                     pSector-&gt;<a class="code" href="structSECTORINFO.html#3c5312672399c40ec5a395e8bcfb0104">ubNumElites</a>++;
<a name="l01296"></a>01296                               }
<a name="l01297"></a>01297                               <span class="keywordflow">else</span> <span class="keywordflow">if</span>( iRandom &lt; iTroopChance )
<a name="l01298"></a>01298                               {
<a name="l01299"></a>01299                                     pSector-&gt;<a class="code" href="structSECTORINFO.html#e36540b93256cfa71e45382f133d3696">ubNumTroops</a>++;
<a name="l01300"></a>01300                               }
<a name="l01301"></a>01301                         }
<a name="l01302"></a>01302                   }
<a name="l01303"></a>01303                   <span class="keywordflow">switch</span>( <a class="code" href="AI_01Viewer_8cpp.html#a9f940d7f3a6d6698bfaeb7c747d74a9">gGarrisonGroup</a>[ i ].ubComposition )
<a name="l01304"></a>01304                   {
<a name="l01305"></a>01305                         <span class="keywordflow">case</span> <a class="code" href="Strategic_01AI_8h.html#a9908284c0827729f14cf9b2489e1479534fe588a742ddb93c6491a1a05b8b19">CAMBRIA_DEFENCE</a>:
<a name="l01306"></a>01306                         <span class="keywordflow">case</span> <a class="code" href="Strategic_01AI_8h.html#a9908284c0827729f14cf9b2489e1479ca3d6330b3689d84e632e764cd954482">CAMBRIA_MINE</a>:
<a name="l01307"></a>01307                         <span class="keywordflow">case</span> <a class="code" href="Strategic_01AI_8h.html#a9908284c0827729f14cf9b2489e1479b2e38a672cdd443d231dd0144a447675">ALMA_MINE</a>:
<a name="l01308"></a>01308                         <span class="keywordflow">case</span> <a class="code" href="Strategic_01AI_8h.html#a9908284c0827729f14cf9b2489e1479b67ceeaf4ebbe68cb3f9fad537704930">GRUMM_MINE</a>:
<a name="l01309"></a>01309                               <span class="comment">//Fill up extra start slots with troops</span>
<a name="l01310"></a>01310                               pSector-&gt;<a class="code" href="structSECTORINFO.html#e36540b93256cfa71e45382f133d3696">ubNumTroops</a> = (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)(iStartPop -= pSector-&gt;<a class="code" href="structSECTORINFO.html#d7d5ee63c0dc2ad3164c83541bd80906">ubNumAdmins</a>);
<a name="l01311"></a>01311                               <span class="keywordflow">break</span>;
<a name="l01312"></a>01312                         <span class="keywordflow">case</span> <a class="code" href="Strategic_01AI_8h.html#a9908284c0827729f14cf9b2489e147943b53436f5a6705040ef2a40564ea80a">DRASSEN_AIRPORT</a>:
<a name="l01313"></a>01313                         <span class="keywordflow">case</span> <a class="code" href="Strategic_01AI_8h.html#a9908284c0827729f14cf9b2489e1479b8914397662a6ea57af349646e3c9471">DRASSEN_DEFENCE</a>:
<a name="l01314"></a>01314                         <span class="keywordflow">case</span> <a class="code" href="Strategic_01AI_8h.html#a9908284c0827729f14cf9b2489e14799a73db68e32a680bed112c2b9f556bc4">DRASSEN_MINE</a>:
<a name="l01315"></a>01315                               pSector-&gt;<a class="code" href="structSECTORINFO.html#d7d5ee63c0dc2ad3164c83541bd80906">ubNumAdmins</a> = (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)max( 5, pSector-&gt;<a class="code" href="structSECTORINFO.html#d7d5ee63c0dc2ad3164c83541bd80906">ubNumAdmins</a> );
<a name="l01316"></a>01316                               <span class="keywordflow">break</span>;
<a name="l01317"></a>01317                         <span class="keywordflow">case</span> <a class="code" href="Strategic_01AI_8h.html#a9908284c0827729f14cf9b2489e1479bb06c2090b5694f6fdae00acf3a6e643">TIXA_PRISON</a>:
<a name="l01318"></a>01318                               pSector-&gt;<a class="code" href="structSECTORINFO.html#d7d5ee63c0dc2ad3164c83541bd80906">ubNumAdmins</a> = (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)max( 8, pSector-&gt;<a class="code" href="structSECTORINFO.html#d7d5ee63c0dc2ad3164c83541bd80906">ubNumAdmins</a> );
<a name="l01319"></a>01319                               <span class="keywordflow">break</span>;
<a name="l01320"></a>01320 
<a name="l01321"></a>01321                   }
<a name="l01322"></a>01322             }
<a name="l01323"></a>01323             <span class="keywordflow">if</span>( iAdminChance &amp;&amp; pSector-&gt;<a class="code" href="structSECTORINFO.html#d7d5ee63c0dc2ad3164c83541bd80906">ubNumAdmins</a> &lt; <a class="code" href="Strategic_01AI_8cpp.html#12b5525b1f3dabeac40700eecd3219e7">gubMinEnemyGroupSize</a> )
<a name="l01324"></a>01324             {
<a name="l01325"></a>01325                   pSector-&gt;<a class="code" href="structSECTORINFO.html#d7d5ee63c0dc2ad3164c83541bd80906">ubNumAdmins</a> = <a class="code" href="Strategic_01AI_8cpp.html#12b5525b1f3dabeac40700eecd3219e7">gubMinEnemyGroupSize</a>;
<a name="l01326"></a>01326             }
<a name="l01327"></a>01327             <span class="comment">//Calculate weight (range is -20 to +20 before multiplier).</span>
<a name="l01328"></a>01328             <span class="comment">//The multiplier of 3 brings it to a range of -96 to +96 which is</span>
<a name="l01329"></a>01329             <span class="comment">//close enough to a plus/minus 100%.  The resultant percentage is then</span>
<a name="l01330"></a>01330             <span class="comment">//converted based on the priority.</span>
<a name="l01331"></a>01331             iWeight = (iDesiredPop - iStartPop) * 3;
<a name="l01332"></a>01332             <span class="keywordflow">if</span>( iWeight &gt; 0 )
<a name="l01333"></a>01333             { <span class="comment">//modify it by it's priority.</span>
<a name="l01334"></a>01334                   <span class="comment">//generates a value between 2 and 100</span>
<a name="l01335"></a>01335                   iWeight = iWeight * iPriority / 96;
<a name="l01336"></a>01336                   iWeight = max( iWeight, 2 );
<a name="l01337"></a>01337                   <a class="code" href="AI_01Viewer_8cpp.html#c3390da297cb8068458f459fe9fc094f">giRequestPoints</a> += iWeight;
<a name="l01338"></a>01338             }
<a name="l01339"></a>01339             <span class="keywordflow">else</span> <span class="keywordflow">if</span>( iWeight &lt; 0 ) 
<a name="l01340"></a>01340             { <span class="comment">//modify it by it's reverse priority </span>
<a name="l01341"></a>01341                   <span class="comment">//generates a value between -2 and -100</span>
<a name="l01342"></a>01342                   iWeight = iWeight * (100-iPriority) / 96;
<a name="l01343"></a>01343                   iWeight = min( iWeight, -2 );
<a name="l01344"></a>01344                   <a class="code" href="AI_01Viewer_8cpp.html#a54cf2087c7e1b790053295a6bf90592">giReinforcementPoints</a> -= iWeight;
<a name="l01345"></a>01345             }
<a name="l01346"></a>01346             <a class="code" href="AI_01Viewer_8cpp.html#a9f940d7f3a6d6698bfaeb7c747d74a9">gGarrisonGroup</a>[ i ].<a class="code" href="structGARRISON__GROUP.html#54fcf91b97b56e3cc75ef302b34ecf48">bWeight</a> = (<a class="code" href="Types_8h.html#7ebe70ceca856797319175e30bcf003d">INT8</a>)iWeight;
<a name="l01347"></a>01347 
<a name="l01348"></a>01348             <span class="comment">//Now post an event which allows them to check adjacent sectors periodically.</span>
<a name="l01349"></a>01349             <span class="comment">//Spread them out so that they process at different times.</span>
<a name="l01350"></a>01350             <a class="code" href="Game_01Event_01Hook_8h.html#7636eec5abf6ada3ad215f1a2491c322">AddPeriodStrategicEventWithOffset</a>( <a class="code" href="Game_01Event_01Hook_8h.html#08f51f22ad2ed13a25181c260457311084391578ce79172a0826afc1bba2a312">EVENT_CHECK_ENEMY_CONTROLLED_SECTOR</a>, 140 - 20 * <a class="code" href="GameSettings_8cpp.html#f9f2d5fd368ccadcc26bebc202d52ae7">gGameOptions</a>.<a class="code" href="structGAME__OPTIONS.html#4fb44167906152722f6af5cc9f7c1a99">ubDifficultyLevel</a> + <a class="code" href="Random_8cpp.html#49f938d1313ab6ef09ac6223a16ac334">Random</a>( 4 ), 475 + i, <a class="code" href="AI_01Viewer_8cpp.html#a9f940d7f3a6d6698bfaeb7c747d74a9">gGarrisonGroup</a>[ i ].ubSectorID );
<a name="l01351"></a>01351       }
<a name="l01352"></a>01352       <span class="comment">//Now, initialize each of the patrol groups</span>
<a name="l01353"></a>01353       <span class="keywordflow">for</span>( i = 0; i &lt; <a class="code" href="Strategic_01AI_8cpp.html#8c839f77f7a78de6ff920d5943d834d7">giPatrolArraySize</a>; i++ )
<a name="l01354"></a>01354       {     <span class="comment">// IGNORE COMMENT, FEATURE REMOVED!</span>
<a name="l01355"></a>01355             <span class="comment">//Some of the patrol groups aren't there at the beginning of the game.  This is </span>
<a name="l01356"></a>01356             <span class="comment">//based on the difficulty settings in the above patrol table.</span>
<a name="l01357"></a>01357             <span class="comment">//if( gPatrolGroup[ i ].ubUNUSEDStartIfDifficulty &lt;= gGameOptions.ubDifficultyLevel )</span>
<a name="l01358"></a>01358             { <span class="comment">//Add this patrol group now.</span>
<a name="l01359"></a>01359                   ubNumTroops = (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)(<a class="code" href="Strategic_01AI_8cpp.html#9e00ccb0e77cec57208c519e8f831f53">gPatrolGroup</a>[ i ].bSize + <a class="code" href="Random_8cpp.html#49f938d1313ab6ef09ac6223a16ac334">Random</a>( 3 ) - 1);
<a name="l01360"></a>01360                   ubNumTroops = (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)max( <a class="code" href="Strategic_01AI_8cpp.html#12b5525b1f3dabeac40700eecd3219e7">gubMinEnemyGroupSize</a>, min( iMaxEnemyGroupSize, ubNumTroops ) );
<a name="l01361"></a>01361                   <span class="comment">//ubNumTroops = (UINT8)max( gubMinEnemyGroupSize, min( MAX_STRATEGIC_TEAM_SIZE, gPatrolGroup[ i ].bSize + Random( 3 ) - 1 ) );</span>
<a name="l01362"></a>01362                   <span class="comment">//Note on adding patrol groups...</span>
<a name="l01363"></a>01363                   <span class="comment">//The patrol group can't actually start on the first waypoint, so we set it to the second way</span>
<a name="l01364"></a>01364                   <span class="comment">//point for initialization, and then add the waypoints from 0 up</span>
<a name="l01365"></a>01365                   pGroup = <a class="code" href="Strategic_01Movement_8cpp.html#a6ac42d3d57b37a44bc39b3cd55ec008">CreateNewEnemyGroupDepartingFromSector</a>( <a class="code" href="Strategic_01AI_8cpp.html#9e00ccb0e77cec57208c519e8f831f53">gPatrolGroup</a>[ i ].ubSectorID[ 1 ], 0, ubNumTroops, 0 );
<a name="l01366"></a>01366                   Assert( pGroup );
<a name="l01367"></a>01367 
<a name="l01368"></a>01368                   <span class="keywordflow">if</span>( i == 3 || i == 4 )
<a name="l01369"></a>01369                   { <span class="comment">//Special case:  Two patrol groups are administrator groups -- rest are troops</span>
<a name="l01370"></a>01370                         pGroup-&gt;<a class="code" href="structGROUP.html#f82ff4c3e504e4bb10feb65491f79471">pEnemyGroup</a>-&gt;<a class="code" href="structENEMYGROUP.html#61d6f824f39709580afa7a81317e241b">ubNumAdmins</a> = pGroup-&gt;<a class="code" href="structGROUP.html#f82ff4c3e504e4bb10feb65491f79471">pEnemyGroup</a>-&gt;<a class="code" href="structENEMYGROUP.html#27eaaea857408bc6c6358054c19f2d07">ubNumTroops</a>;
<a name="l01371"></a>01371                         pGroup-&gt;<a class="code" href="structGROUP.html#f82ff4c3e504e4bb10feb65491f79471">pEnemyGroup</a>-&gt;<a class="code" href="structENEMYGROUP.html#27eaaea857408bc6c6358054c19f2d07">ubNumTroops</a> = 0;
<a name="l01372"></a>01372                   }
<a name="l01373"></a>01373                   <a class="code" href="Strategic_01AI_8cpp.html#9e00ccb0e77cec57208c519e8f831f53">gPatrolGroup</a>[ i ].<a class="code" href="structPATROL__GROUP.html#a94d3c610977f7a6fab94b302493d084">ubGroupID</a> = pGroup-&gt;<a class="code" href="structGROUP.html#9149379b9355afda87a382af5a88d728">ubGroupID</a>;
<a name="l01374"></a>01374                   pGroup-&gt;<a class="code" href="structGROUP.html#f82ff4c3e504e4bb10feb65491f79471">pEnemyGroup</a>-&gt;<a class="code" href="structENEMYGROUP.html#6d1d418460b3704699f5e058925897e2">ubIntention</a> = <a class="code" href="Strategic_01Movement_8h.html#b59c1bec446b10af208f977a871d910b132923eff5652e6e103b2734f1160e0a">PATROL</a>;
<a name="l01375"></a>01375                   pGroup-&gt;<a class="code" href="structGROUP.html#d11970aeea229972cf65f9f169e90451">ubMoveType</a> = <a class="code" href="Strategic_01Movement_8h.html#456ac33d49271d3e2c371351cd1d637164845912e4baf844d9a73da607ab3cea">ENDTOEND_FORWARDS</a>;
<a name="l01376"></a>01376                   <a class="code" href="Strategic_01Movement_8cpp.html#5247ab3cb65ed1b2fb9d44ac2f70ea41">AddWaypointIDToPGroup</a>( pGroup, <a class="code" href="Strategic_01AI_8cpp.html#9e00ccb0e77cec57208c519e8f831f53">gPatrolGroup</a>[ i ].ubSectorID[ 0 ] ); 
<a name="l01377"></a>01377                   <a class="code" href="Strategic_01Movement_8cpp.html#5247ab3cb65ed1b2fb9d44ac2f70ea41">AddWaypointIDToPGroup</a>( pGroup, <a class="code" href="Strategic_01AI_8cpp.html#9e00ccb0e77cec57208c519e8f831f53">gPatrolGroup</a>[ i ].ubSectorID[ 1 ] ); 
<a name="l01378"></a>01378                   <span class="keywordflow">if</span>( <a class="code" href="Strategic_01AI_8cpp.html#9e00ccb0e77cec57208c519e8f831f53">gPatrolGroup</a>[ i ].ubSectorID[ 2 ] )
<a name="l01379"></a>01379                   { <span class="comment">//Add optional waypoints if included.</span>
<a name="l01380"></a>01380                         <a class="code" href="Strategic_01Movement_8cpp.html#5247ab3cb65ed1b2fb9d44ac2f70ea41">AddWaypointIDToPGroup</a>( pGroup, <a class="code" href="Strategic_01AI_8cpp.html#9e00ccb0e77cec57208c519e8f831f53">gPatrolGroup</a>[ i ].ubSectorID[ 2 ] ); 
<a name="l01381"></a>01381                         <span class="keywordflow">if</span>( <a class="code" href="Strategic_01AI_8cpp.html#9e00ccb0e77cec57208c519e8f831f53">gPatrolGroup</a>[ i ].ubSectorID[ 3 ] )
<a name="l01382"></a>01382                               <a class="code" href="Strategic_01Movement_8cpp.html#5247ab3cb65ed1b2fb9d44ac2f70ea41">AddWaypointIDToPGroup</a>( pGroup, <a class="code" href="Strategic_01AI_8cpp.html#9e00ccb0e77cec57208c519e8f831f53">gPatrolGroup</a>[ i ].ubSectorID[ 3 ] ); 
<a name="l01383"></a>01383                   }
<a name="l01384"></a>01384                   <a class="code" href="Strategic_01Movement_8cpp.html#cf7a99efbbd51d825d6b33a7981391bb">RandomizePatrolGroupLocation</a>( pGroup );
<a name="l01385"></a>01385                   <a class="code" href="Strategic_01AI_8cpp.html#3c3091ef7361288e9f4f6a95cb067980">ValidateGroup</a>( pGroup );
<a name="l01386"></a>01386             }
<a name="l01387"></a>01387             <span class="comment">//else</span>
<a name="l01388"></a>01388             <span class="comment">//{ //we aren't creating this patrol group at the beginning of the game, so we</span>
<a name="l01389"></a>01389                   <span class="comment">//need to set up the weighting values to prioritize it's reinforcement request so that</span>
<a name="l01390"></a>01390                   <span class="comment">//it gets filled up later in the game.</span>
<a name="l01391"></a>01391             <span class="comment">//    iWeight = gPatrolGroup[ i ].bSize * 3 * gPatrolGroup[ i ].bPriority / 96;</span>
<a name="l01392"></a>01392             <span class="comment">//    gPatrolGroup[ i ].bWeight = (INT8)iWeight;</span>
<a name="l01393"></a>01393             <span class="comment">//    giRequestPoints += iWeight;</span>
<a name="l01394"></a>01394             <span class="comment">//}</span>
<a name="l01395"></a>01395       }
<a name="l01396"></a>01396 
<a name="l01397"></a>01397       <span class="comment">//Setup the flags for the four sam sites.</span>
<a name="l01398"></a>01398       <a class="code" href="Campaign_01Types_8h.html#d83c6f699f17a47cf6a662c91d959126">SectorInfo</a>[<a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c66026434ecb02d9115f4d616bfb077c756523a9">SEC_D2</a>].<a class="code" href="structSECTORINFO.html#ee318422648cb0f466777759ced21e13">uiFlags</a> |= SF_SAM_SITE;
<a name="l01399"></a>01399       <a class="code" href="Campaign_01Types_8h.html#d83c6f699f17a47cf6a662c91d959126">SectorInfo</a>[<a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643a6b93766e638fc1877d78e6209cfb7dc">SEC_D15</a>].<a class="code" href="structSECTORINFO.html#ee318422648cb0f466777759ced21e13">uiFlags</a> |= SF_SAM_SITE;
<a name="l01400"></a>01400       <a class="code" href="Campaign_01Types_8h.html#d83c6f699f17a47cf6a662c91d959126">SectorInfo</a>[<a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c660264303e0da7939fba7e3ffd739064bee4abd">SEC_I8</a>].<a class="code" href="structSECTORINFO.html#ee318422648cb0f466777759ced21e13">uiFlags</a> |= SF_SAM_SITE;
<a name="l01401"></a>01401       <a class="code" href="Campaign_01Types_8h.html#d83c6f699f17a47cf6a662c91d959126">SectorInfo</a>[<a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643a1f02b8d49f15ade9e5c53145d967651">SEC_N4</a>].<a class="code" href="structSECTORINFO.html#ee318422648cb0f466777759ced21e13">uiFlags</a> |= SF_SAM_SITE;
<a name="l01402"></a>01402 
<a name="l01403"></a>01403       <span class="comment">//final thing to do is choose 1 cache map out of 5 possible maps.  Simply select the sector randomly,</span>
<a name="l01404"></a>01404       <span class="comment">//set up the flags to use the alternate map, then place 8-12 regular troops there (no ai though).</span>
<a name="l01405"></a>01405       <span class="comment">//changing MAX_STRATEGIC_TEAM_SIZE may require changes to to the defending force here.</span>
<a name="l01406"></a>01406       <span class="keywordflow">if</span> ( !<a class="code" href="GameSettings_8cpp.html#5c32f930e2fef384505c4b91803a92c2">gGameExternalOptions</a>.<a class="code" href="structGAME__EXTERNAL__OPTIONS.html#83467b65fc5179bd419f8326f7a33b4c">fEnableAllWeaponCaches</a> )
<a name="l01407"></a>01407       {
<a name="l01408"></a>01408             <span class="keywordflow">switch</span>( <a class="code" href="Random_8cpp.html#49f938d1313ab6ef09ac6223a16ac334">Random</a>( 5 ) )
<a name="l01409"></a>01409             {
<a name="l01410"></a>01410                   <span class="keywordflow">case</span> 0:     pSector = &amp;<a class="code" href="Campaign_01Types_8h.html#d83c6f699f17a47cf6a662c91d959126">SectorInfo</a>[ <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643a2e1f5d6e7f190ec1490eb079ded311a">SEC_E11</a> ]; <span class="keywordflow">break</span>;
<a name="l01411"></a>01411                   <span class="keywordflow">case</span> 1:     pSector = &amp;<a class="code" href="Campaign_01Types_8h.html#d83c6f699f17a47cf6a662c91d959126">SectorInfo</a>[ <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c66026430ad41d8758d8019a5a7cff75a1cec776">SEC_H5</a> ]; <span class="keywordflow">break</span>;
<a name="l01412"></a>01412                   <span class="keywordflow">case</span> 2:     pSector = &amp;<a class="code" href="Campaign_01Types_8h.html#d83c6f699f17a47cf6a662c91d959126">SectorInfo</a>[ <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c660264325e217b472b13302187b52e2a8f41201">SEC_H10</a> ]; <span class="keywordflow">break</span>;
<a name="l01413"></a>01413                   <span class="keywordflow">case</span> 3:     pSector = &amp;<a class="code" href="Campaign_01Types_8h.html#d83c6f699f17a47cf6a662c91d959126">SectorInfo</a>[ <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643a6c9941aad2fb7d8cda07b9272746306">SEC_J12</a> ]; <span class="keywordflow">break</span>;
<a name="l01414"></a>01414                   <span class="keywordflow">case</span> 4:     pSector = &amp;<a class="code" href="Campaign_01Types_8h.html#d83c6f699f17a47cf6a662c91d959126">SectorInfo</a>[ <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c66026432f979fa2b937dca97030338fb6e281bf">SEC_M9</a> ]; <span class="keywordflow">break</span>;
<a name="l01415"></a>01415             }
<a name="l01416"></a>01416             pSector-&gt;<a class="code" href="structSECTORINFO.html#ee318422648cb0f466777759ced21e13">uiFlags</a> |= SF_USE_ALTERNATE_MAP;
<a name="l01417"></a>01417             pSector-&gt;<a class="code" href="structSECTORINFO.html#e36540b93256cfa71e45382f133d3696">ubNumTroops</a> = (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)(6 + <a class="code" href="GameSettings_8cpp.html#f9f2d5fd368ccadcc26bebc202d52ae7">gGameOptions</a>.<a class="code" href="structGAME__OPTIONS.html#4fb44167906152722f6af5cc9f7c1a99">ubDifficultyLevel</a> * 2);
<a name="l01418"></a>01418       }
<a name="l01419"></a>01419       <span class="keywordflow">else</span>
<a name="l01420"></a>01420       {
<a name="l01421"></a>01421             pSector = &amp;<a class="code" href="Campaign_01Types_8h.html#d83c6f699f17a47cf6a662c91d959126">SectorInfo</a>[ <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643a2e1f5d6e7f190ec1490eb079ded311a">SEC_E11</a> ];
<a name="l01422"></a>01422             pSector-&gt;<a class="code" href="structSECTORINFO.html#ee318422648cb0f466777759ced21e13">uiFlags</a> |= SF_USE_ALTERNATE_MAP;
<a name="l01423"></a>01423             pSector-&gt;<a class="code" href="structSECTORINFO.html#e36540b93256cfa71e45382f133d3696">ubNumTroops</a> = (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)(6 + <a class="code" href="GameSettings_8cpp.html#f9f2d5fd368ccadcc26bebc202d52ae7">gGameOptions</a>.<a class="code" href="structGAME__OPTIONS.html#4fb44167906152722f6af5cc9f7c1a99">ubDifficultyLevel</a> * 2);
<a name="l01424"></a>01424 
<a name="l01425"></a>01425             pSector = &amp;<a class="code" href="Campaign_01Types_8h.html#d83c6f699f17a47cf6a662c91d959126">SectorInfo</a>[ <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c66026430ad41d8758d8019a5a7cff75a1cec776">SEC_H5</a> ];
<a name="l01426"></a>01426             pSector-&gt;<a class="code" href="structSECTORINFO.html#ee318422648cb0f466777759ced21e13">uiFlags</a> |= SF_USE_ALTERNATE_MAP;
<a name="l01427"></a>01427             pSector-&gt;<a class="code" href="structSECTORINFO.html#e36540b93256cfa71e45382f133d3696">ubNumTroops</a> = (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)(6 + <a class="code" href="GameSettings_8cpp.html#f9f2d5fd368ccadcc26bebc202d52ae7">gGameOptions</a>.<a class="code" href="structGAME__OPTIONS.html#4fb44167906152722f6af5cc9f7c1a99">ubDifficultyLevel</a> * 2);
<a name="l01428"></a>01428 
<a name="l01429"></a>01429             pSector = &amp;<a class="code" href="Campaign_01Types_8h.html#d83c6f699f17a47cf6a662c91d959126">SectorInfo</a>[ <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c660264325e217b472b13302187b52e2a8f41201">SEC_H10</a> ];
<a name="l01430"></a>01430             pSector-&gt;<a class="code" href="structSECTORINFO.html#ee318422648cb0f466777759ced21e13">uiFlags</a> |= SF_USE_ALTERNATE_MAP;
<a name="l01431"></a>01431             pSector-&gt;<a class="code" href="structSECTORINFO.html#e36540b93256cfa71e45382f133d3696">ubNumTroops</a> = (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)(6 + <a class="code" href="GameSettings_8cpp.html#f9f2d5fd368ccadcc26bebc202d52ae7">gGameOptions</a>.<a class="code" href="structGAME__OPTIONS.html#4fb44167906152722f6af5cc9f7c1a99">ubDifficultyLevel</a> * 2);
<a name="l01432"></a>01432 
<a name="l01433"></a>01433             pSector = &amp;<a class="code" href="Campaign_01Types_8h.html#d83c6f699f17a47cf6a662c91d959126">SectorInfo</a>[ <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643a6c9941aad2fb7d8cda07b9272746306">SEC_J12</a> ];
<a name="l01434"></a>01434             pSector-&gt;<a class="code" href="structSECTORINFO.html#ee318422648cb0f466777759ced21e13">uiFlags</a> |= SF_USE_ALTERNATE_MAP;
<a name="l01435"></a>01435             pSector-&gt;<a class="code" href="structSECTORINFO.html#e36540b93256cfa71e45382f133d3696">ubNumTroops</a> = (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)(6 + <a class="code" href="GameSettings_8cpp.html#f9f2d5fd368ccadcc26bebc202d52ae7">gGameOptions</a>.<a class="code" href="structGAME__OPTIONS.html#4fb44167906152722f6af5cc9f7c1a99">ubDifficultyLevel</a> * 2);
<a name="l01436"></a>01436 
<a name="l01437"></a>01437             pSector = &amp;<a class="code" href="Campaign_01Types_8h.html#d83c6f699f17a47cf6a662c91d959126">SectorInfo</a>[ <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c66026432f979fa2b937dca97030338fb6e281bf">SEC_M9</a> ];
<a name="l01438"></a>01438             pSector-&gt;<a class="code" href="structSECTORINFO.html#ee318422648cb0f466777759ced21e13">uiFlags</a> |= SF_USE_ALTERNATE_MAP;
<a name="l01439"></a>01439             pSector-&gt;<a class="code" href="structSECTORINFO.html#e36540b93256cfa71e45382f133d3696">ubNumTroops</a> = (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)(6 + <a class="code" href="GameSettings_8cpp.html#f9f2d5fd368ccadcc26bebc202d52ae7">gGameOptions</a>.<a class="code" href="structGAME__OPTIONS.html#4fb44167906152722f6af5cc9f7c1a99">ubDifficultyLevel</a> * 2);
<a name="l01440"></a>01440       }
<a name="l01441"></a>01441 
<a name="l01442"></a>01442       <a class="code" href="Strategic_01AI_8cpp.html#75d774eb03c41b5fe422edfef6e445d4">ValidateWeights</a>( 1 );
<a name="l01443"></a>01443 }
<a name="l01444"></a>01444 
<a name="l01445"></a><a class="code" href="Strategic_01AI_8h.html#12cf636c41376b2737efb94c89f0275c">01445</a> <span class="keywordtype">void</span> <a class="code" href="Strategic_01AI_8cpp.html#12cf636c41376b2737efb94c89f0275c">KillStrategicAI</a>()
<a name="l01446"></a>01446 {
<a name="l01447"></a>01447       <span class="keywordflow">if</span>( <a class="code" href="Strategic_01AI_8cpp.html#9e00ccb0e77cec57208c519e8f831f53">gPatrolGroup</a> )
<a name="l01448"></a>01448       {
<a name="l01449"></a>01449             MemFree( <a class="code" href="Strategic_01AI_8cpp.html#9e00ccb0e77cec57208c519e8f831f53">gPatrolGroup</a> );
<a name="l01450"></a>01450             gPatrolGroup = NULL;
<a name="l01451"></a>01451       }
<a name="l01452"></a>01452       <span class="keywordflow">if</span>( <a class="code" href="AI_01Viewer_8cpp.html#a9f940d7f3a6d6698bfaeb7c747d74a9">gGarrisonGroup</a> )
<a name="l01453"></a>01453       {
<a name="l01454"></a>01454             MemFree( <a class="code" href="AI_01Viewer_8cpp.html#a9f940d7f3a6d6698bfaeb7c747d74a9">gGarrisonGroup</a> );
<a name="l01455"></a>01455             gGarrisonGroup = NULL;
<a name="l01456"></a>01456       }
<a name="l01457"></a>01457       <span class="keywordflow">if</span>( <a class="code" href="Strategic_01AI_8cpp.html#48e0403413b13dc086dc70c6921ee186">gubPatrolReinforcementsDenied</a> )
<a name="l01458"></a>01458       {
<a name="l01459"></a>01459             MemFree( <a class="code" href="Strategic_01AI_8cpp.html#48e0403413b13dc086dc70c6921ee186">gubPatrolReinforcementsDenied</a> );
<a name="l01460"></a>01460             gubPatrolReinforcementsDenied = NULL;
<a name="l01461"></a>01461       }
<a name="l01462"></a>01462       <span class="keywordflow">if</span>( <a class="code" href="Strategic_01AI_8cpp.html#9bc393a708632bfedc7ce82ab9268709">gubGarrisonReinforcementsDenied</a> )
<a name="l01463"></a>01463       {
<a name="l01464"></a>01464             MemFree( <a class="code" href="Strategic_01AI_8cpp.html#9bc393a708632bfedc7ce82ab9268709">gubGarrisonReinforcementsDenied</a> );
<a name="l01465"></a>01465             gubGarrisonReinforcementsDenied = NULL;
<a name="l01466"></a>01466       }
<a name="l01467"></a>01467       <a class="code" href="Game_01Event_01Hook_8h.html#0f4bec2a78f8f741c550be068eed3941">DeleteAllStrategicEventsOfType</a>( <a class="code" href="Game_01Event_01Hook_8h.html#08f51f22ad2ed13a25181c26045731106d744aac1461129e69ce5d43d26e5e38">EVENT_EVALUATE_QUEEN_SITUATION</a> );
<a name="l01468"></a>01468 }
<a name="l01469"></a>01469 
<a name="l01470"></a><a class="code" href="Strategic_01AI_8h.html#4beac2a162afcbc2b95b437a60278e67">01470</a> <a class="code" href="Types_8h.html#112e3146cb38b6ee95e64d85842e380a">BOOLEAN</a> <a class="code" href="Strategic_01AI_8cpp.html#4beac2a162afcbc2b95b437a60278e67">OkayForEnemyToMoveThroughSector</a>( <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubSectorID )
<a name="l01471"></a>01471 {
<a name="l01472"></a>01472       <a class="code" href="structSECTORINFO.html">SECTORINFO</a> *pSector;
<a name="l01473"></a>01473       pSector = &amp;<a class="code" href="Campaign_01Types_8h.html#d83c6f699f17a47cf6a662c91d959126">SectorInfo</a>[ ubSectorID ];
<a name="l01474"></a>01474       <span class="keywordflow">if</span>( pSector-&gt;<a class="code" href="structSECTORINFO.html#128d73ad43a437241fd20e5a93923db9">uiTimeLastPlayerLiberated</a> &amp;&amp; pSector-&gt;<a class="code" href="structSECTORINFO.html#128d73ad43a437241fd20e5a93923db9">uiTimeLastPlayerLiberated</a> + (<a class="code" href="Strategic_01AI_8cpp.html#123935928b8e3146a1edda9d78cfea62">gubHoursGracePeriod</a> * 3600) &gt; <a class="code" href="Game_01Clock_8cpp.html#44b17d324c70be123694dba2deca1b89">GetWorldTotalSeconds</a>() )
<a name="l01475"></a>01475       {
<a name="l01476"></a>01476             <span class="keywordflow">return</span> FALSE;
<a name="l01477"></a>01477       }
<a name="l01478"></a>01478       <span class="keywordflow">return</span> TRUE;
<a name="l01479"></a>01479 }
<a name="l01480"></a>01480 
<a name="l01481"></a><a class="code" href="Strategic_01AI_8h.html#f8f6673c3fc186e8d92341498a455679">01481</a> <a class="code" href="Types_8h.html#112e3146cb38b6ee95e64d85842e380a">BOOLEAN</a> <a class="code" href="Strategic_01AI_8cpp.html#f8f6673c3fc186e8d92341498a455679">EnemyPermittedToAttackSector</a>( <a class="code" href="structGROUP.html">GROUP</a> **pGroup, <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubSectorID )
<a name="l01482"></a>01482 {
<a name="l01483"></a>01483       <a class="code" href="structSECTORINFO.html">SECTORINFO</a> *pSector;
<a name="l01484"></a>01484       <a class="code" href="Types_8h.html#112e3146cb38b6ee95e64d85842e380a">BOOLEAN</a> fPermittedToAttack = TRUE;
<a name="l01485"></a>01485 
<a name="l01486"></a>01486       pSector = &amp;<a class="code" href="Campaign_01Types_8h.html#d83c6f699f17a47cf6a662c91d959126">SectorInfo</a>[ ubSectorID ];
<a name="l01487"></a>01487       fPermittedToAttack = <a class="code" href="Strategic_01AI_8cpp.html#4beac2a162afcbc2b95b437a60278e67">OkayForEnemyToMoveThroughSector</a>( ubSectorID );
<a name="l01488"></a>01488       <span class="keywordflow">if</span>( pGroup &amp;&amp; *pGroup &amp;&amp; pSector-&gt;<a class="code" href="structSECTORINFO.html#9465931dad0e164d7d47814b66e454f0">ubGarrisonID</a> != NO_GARRISON )
<a name="l01489"></a>01489       {
<a name="l01490"></a>01490             <span class="keywordflow">if</span>( <a class="code" href="AI_01Viewer_8cpp.html#a9f940d7f3a6d6698bfaeb7c747d74a9">gGarrisonGroup</a>[ pSector-&gt;<a class="code" href="structSECTORINFO.html#9465931dad0e164d7d47814b66e454f0">ubGarrisonID</a> ].ubPendingGroupID )
<a name="l01491"></a>01491             {
<a name="l01492"></a>01492                   <a class="code" href="structGROUP.html">GROUP</a> *pPendingGroup;
<a name="l01493"></a>01493                   pPendingGroup = <a class="code" href="Strategic_01Movement_8cpp.html#33138746a238bdc5c684e9aa2c86691c">GetGroup</a>( gGarrisonGroup[ pSector-&gt;<a class="code" href="structSECTORINFO.html#9465931dad0e164d7d47814b66e454f0">ubGarrisonID</a> ].ubPendingGroupID ); 
<a name="l01494"></a>01494                   <span class="keywordflow">if</span>( pPendingGroup == *pGroup )
<a name="l01495"></a>01495                   {
<a name="l01496"></a>01496                         <span class="keywordflow">if</span>( fPermittedToAttack )
<a name="l01497"></a>01497                         {
<a name="l01498"></a>01498                               <span class="keywordflow">if</span>( <a class="code" href="Strategic_01Movement_8cpp.html#5bffbc0549f4fb0c8829436f9ee6e907">GroupAtFinalDestination</a>( *pGroup ) )
<a name="l01499"></a>01499                               { <span class="comment">//High priority reinforcements have arrived.  This overrides most other situations.</span>
<a name="l01500"></a>01500                                     <span class="keywordflow">return</span> TRUE;
<a name="l01501"></a>01501                               }
<a name="l01502"></a>01502                         }
<a name="l01503"></a>01503                         <span class="keywordflow">else</span>
<a name="l01504"></a>01504                         { <span class="comment">//Reassign the group</span>
<a name="l01505"></a>01505                               <a class="code" href="Strategic_01AI_8cpp.html#0ecd8a8d61c81aa34eeec15760348ffe">ReassignAIGroup</a>( pGroup );
<a name="l01506"></a>01506                         }
<a name="l01507"></a>01507                   }
<a name="l01508"></a>01508             }
<a name="l01509"></a>01509       }
<a name="l01510"></a>01510       <span class="keywordflow">if</span>( !fPermittedToAttack )
<a name="l01511"></a>01511       {
<a name="l01512"></a>01512             <span class="keywordflow">return</span> FALSE;
<a name="l01513"></a>01513       }
<a name="l01514"></a>01514       <span class="comment">//If Hill-billies are alive, then enemy won't attack the sector.</span>
<a name="l01515"></a>01515       <span class="keywordflow">switch</span>( ubSectorID )
<a name="l01516"></a>01516       {
<a name="l01517"></a>01517             <span class="keywordflow">case</span> <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c660264345e840d6147113607f06ff598925bdbe">SEC_F10</a>:
<a name="l01518"></a>01518                   <span class="comment">//Hill-billy farm -- not until hill billies are dead.</span>
<a name="l01519"></a>01519                   <span class="keywordflow">if</span>( <a class="code" href="Quests_8cpp.html#6744b59d27bf2791d0c2fefe18e548d3">CheckFact</a>( 273, FALSE ) )
<a name="l01520"></a>01520                         <span class="keywordflow">return</span> FALSE;
<a name="l01521"></a>01521                   <span class="keywordflow">break</span>;
<a name="l01522"></a>01522             <span class="keywordflow">case</span> <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c660264391d2dc0712c8c1f845d2997d13220831">SEC_A9</a>:
<a name="l01523"></a>01523             <span class="keywordflow">case</span> <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c660264397a66a28fcba55b268aca2df88ae2ad0">SEC_A10</a>:
<a name="l01524"></a>01524                   <span class="comment">//Omerta -- not until Day 2 at 7:45AM.    </span>
<a name="l01525"></a>01525                   <span class="keywordflow">if</span>( <a class="code" href="Game_01Clock_8cpp.html#4d255e800fba4d64144a7639d5f3421d">GetWorldTotalMin</a>() &lt; 3345 )
<a name="l01526"></a>01526                         <span class="keywordflow">return</span> FALSE;
<a name="l01527"></a>01527                   <span class="keywordflow">break</span>;
<a name="l01528"></a>01528             <span class="keywordflow">case</span> <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c66026436d911e0461303edb9fe227735f787c22">SEC_B13</a>:
<a name="l01529"></a>01529             <span class="keywordflow">case</span> <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643e84863fb1442cf38c7311021990a9bc3">SEC_C13</a>:
<a name="l01530"></a>01530             <span class="keywordflow">case</span> <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c66026435b0fbd8598540769dcf8f24e3134f48c">SEC_D13</a>:
<a name="l01531"></a>01531                   <span class="comment">//Drassen -- not until Day 3 at 6:30AM.</span>
<a name="l01532"></a>01532                   <span class="keywordflow">if</span>( <a class="code" href="Game_01Clock_8cpp.html#4d255e800fba4d64144a7639d5f3421d">GetWorldTotalMin</a>() &lt; 4710 )
<a name="l01533"></a>01533                         <span class="keywordflow">return</span> FALSE;
<a name="l01534"></a>01534                   <span class="keywordflow">break</span>;
<a name="l01535"></a>01535             <span class="keywordflow">case</span> <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643b4a9c6bd17076909f1625214f756c093">SEC_C5</a>:
<a name="l01536"></a>01536             <span class="keywordflow">case</span> <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c66026431d24119bc57aec5046051cd0814a73bb">SEC_C6</a>:
<a name="l01537"></a>01537             <span class="keywordflow">case</span> <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c66026439e7934b21095550280fd71e1148a208e">SEC_D5</a>:
<a name="l01538"></a>01538                   <span class="comment">//San Mona -- not until Kingpin is dead.</span>
<a name="l01539"></a>01539                   <span class="keywordflow">if</span> ( <a class="code" href="Quests_8cpp.html#6744b59d27bf2791d0c2fefe18e548d3">CheckFact</a>( <a class="code" href="Quests_8h.html#aead3e57f613f07868a1b2afb6b943f113228fb280e0247224b96156f3bcbbde">FACT_KINGPIN_DEAD</a>, 0 ) == FALSE )
<a name="l01540"></a>01540                         <span class="keywordflow">return</span> FALSE;
<a name="l01541"></a>01541             <span class="keywordflow">case</span> <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643017ca621475f0a51e675ed5e1e87d3f6">SEC_G1</a>:
<a name="l01542"></a>01542                   <span class="keywordflow">if</span>( <a class="code" href="Queen_01Command_8cpp.html#5c06f4877b66b5a2c4467747f3c4f13e">PlayerSectorDefended</a>( <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c660264309137054660d73ef1f5301d5ff96144b">SEC_G2</a> ) &amp;&amp; (<a class="code" href="Queen_01Command_8cpp.html#5c06f4877b66b5a2c4467747f3c4f13e">PlayerSectorDefended</a>( <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643a24273723441a8bfdfc7367e2d2a29b1">SEC_H1</a> ) || <a class="code" href="Queen_01Command_8cpp.html#5c06f4877b66b5a2c4467747f3c4f13e">PlayerSectorDefended</a>( <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c660264379c7198e0d00238a4c3cfe6454fa6936">SEC_H2</a> )) )
<a name="l01543"></a>01543                   {
<a name="l01544"></a>01544                         <span class="keywordflow">return</span> FALSE;
<a name="l01545"></a>01545                   }
<a name="l01546"></a>01546                   <span class="keywordflow">break</span>;
<a name="l01547"></a>01547             <span class="keywordflow">case</span> <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c660264379c7198e0d00238a4c3cfe6454fa6936">SEC_H2</a>:
<a name="l01548"></a>01548                   <span class="keywordflow">if</span>( <a class="code" href="Queen_01Command_8cpp.html#5c06f4877b66b5a2c4467747f3c4f13e">PlayerSectorDefended</a>( <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c660264379c7198e0d00238a4c3cfe6454fa6936">SEC_H2</a> ) &amp;&amp; (<a class="code" href="Queen_01Command_8cpp.html#5c06f4877b66b5a2c4467747f3c4f13e">PlayerSectorDefended</a>( <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643017ca621475f0a51e675ed5e1e87d3f6">SEC_G1</a> ) || <a class="code" href="Queen_01Command_8cpp.html#5c06f4877b66b5a2c4467747f3c4f13e">PlayerSectorDefended</a>( <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c660264309137054660d73ef1f5301d5ff96144b">SEC_G2</a> )) )
<a name="l01549"></a>01549                   {
<a name="l01550"></a>01550                         <span class="keywordflow">return</span> FALSE;
<a name="l01551"></a>01551                   }
<a name="l01552"></a>01552                   <span class="keywordflow">break</span>;
<a name="l01553"></a>01553       }
<a name="l01554"></a>01554       <span class="keywordflow">return</span> TRUE;
<a name="l01555"></a>01555 }
<a name="l01556"></a>01556 
<a name="l01557"></a><a class="code" href="Strategic_01AI_8cpp.html#af84c5cbdf76a83cd0eda1a9e6e65e05">01557</a> <a class="code" href="Types_8h.html#112e3146cb38b6ee95e64d85842e380a">BOOLEAN</a> <a class="code" href="Strategic_01AI_8cpp.html#af84c5cbdf76a83cd0eda1a9e6e65e05">HandlePlayerGroupNoticedByPatrolGroup</a>( <a class="code" href="structGROUP.html">GROUP</a> *pPlayerGroup, <a class="code" href="structGROUP.html">GROUP</a> *pEnemyGroup )
<a name="l01558"></a>01558 {
<a name="l01559"></a>01559       <a class="code" href="Types_8h.html#09f1a1fb2293e33483cc8d44aefb1eb1">UINT16</a> usDefencePoints;
<a name="l01560"></a>01560       <a class="code" href="Types_8h.html#09f1a1fb2293e33483cc8d44aefb1eb1">UINT16</a> usOffensePoints;
<a name="l01561"></a>01561       <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubSectorID;
<a name="l01562"></a>01562 
<a name="l01563"></a>01563       ubSectorID = (<a class="code" href="Types_8h.html#112e3146cb38b6ee95e64d85842e380a">BOOLEAN</a>)SECTOR( pPlayerGroup-&gt;<a class="code" href="structGROUP.html#eee29372e834112984eab1dc714466c0">ubSectorX</a>, pPlayerGroup-&gt;<a class="code" href="structGROUP.html#11cd63715d9daf1488cca330690db007">ubSectorY</a> );
<a name="l01564"></a>01564       usOffensePoints = pEnemyGroup-&gt;<a class="code" href="structGROUP.html#f82ff4c3e504e4bb10feb65491f79471">pEnemyGroup</a>-&gt;<a class="code" href="structENEMYGROUP.html#61d6f824f39709580afa7a81317e241b">ubNumAdmins</a> * 2 +
<a name="l01565"></a>01565                                                             pEnemyGroup-&gt;<a class="code" href="structGROUP.html#f82ff4c3e504e4bb10feb65491f79471">pEnemyGroup</a>-&gt;<a class="code" href="structENEMYGROUP.html#27eaaea857408bc6c6358054c19f2d07">ubNumTroops</a> * 4 +
<a name="l01566"></a>01566                                                             pEnemyGroup-&gt;<a class="code" href="structGROUP.html#f82ff4c3e504e4bb10feb65491f79471">pEnemyGroup</a>-&gt;<a class="code" href="structENEMYGROUP.html#5f20a703a3c536505126979265b10558">ubNumElites</a> * 6;
<a name="l01567"></a>01567       <span class="keywordflow">if</span>( <a class="code" href="Strategic_01AI_8cpp.html#8d10ec503f28c85754a6f32bd3cde826">PlayerForceTooStrong</a>( ubSectorID, usOffensePoints, &amp;usDefencePoints ) )
<a name="l01568"></a>01568       {
<a name="l01569"></a>01569             <a class="code" href="Strategic_01AI_8cpp.html#e521ef3ef604f1b3f3af7308b87a5e68">RequestAttackOnSector</a>( ubSectorID, usDefencePoints );
<a name="l01570"></a>01570             <span class="keywordflow">return</span> FALSE;
<a name="l01571"></a>01571       }
<a name="l01572"></a>01572       <span class="comment">//For now, automatically attack.</span>
<a name="l01573"></a>01573       <span class="keywordflow">if</span>( pPlayerGroup-&gt;<a class="code" href="structGROUP.html#22d4cef8a4b5c35af9a8259b763c26f0">ubNextX</a> )
<a name="l01574"></a>01574       {
<a name="l01575"></a>01575             <a class="code" href="Strategic_01AI_8cpp.html#3865b55f00d5df7710bd4325ddf83bfc">MoveSAIGroupToSector</a>( &amp;pEnemyGroup, (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)SECTOR( pPlayerGroup-&gt;<a class="code" href="structGROUP.html#22d4cef8a4b5c35af9a8259b763c26f0">ubNextX</a>, pPlayerGroup-&gt;<a class="code" href="structGROUP.html#14c006998c5f9c324b609d459e02d342">ubNextY</a> ), <a class="code" href="Strategic_01AI_8cpp.html#2282261c2887b2d4d1183cf5249e15291ea328a644e627283a35716a54108248">DIRECT</a>, <a class="code" href="Strategic_01Movement_8h.html#b59c1bec446b10af208f977a871d910bede7846a7ab284d348a227dc5858530f">PURSUIT</a> );
<a name="l01576"></a>01576       
<a name="l01577"></a>01577 <span class="preprocessor">            #ifdef JA2BETAVERSION</span>
<a name="l01578"></a>01578 <span class="preprocessor"></span>                  <a class="code" href="Strategic_01AI_8cpp.html#984e97af1f29d3b417cc5bdcd126cfca">LogStrategicEvent</a>( <span class="stringliteral">"Enemy group at %c%d detected player group at %c%d and is moving to intercept them at %c%d."</span>, 
<a name="l01579"></a>01579                         pEnemyGroup-&gt;<a class="code" href="structGROUP.html#11cd63715d9daf1488cca330690db007">ubSectorY</a> + <span class="charliteral">'A'</span> - 1, pEnemyGroup-&gt;<a class="code" href="structGROUP.html#eee29372e834112984eab1dc714466c0">ubSectorX</a>,
<a name="l01580"></a>01580                         pPlayerGroup-&gt;<a class="code" href="structGROUP.html#11cd63715d9daf1488cca330690db007">ubSectorY</a> + <span class="charliteral">'A'</span> - 1, pPlayerGroup-&gt;<a class="code" href="structGROUP.html#eee29372e834112984eab1dc714466c0">ubSectorX</a>, 
<a name="l01581"></a>01581                         pPlayerGroup-&gt;<a class="code" href="structGROUP.html#14c006998c5f9c324b609d459e02d342">ubNextY</a> + <span class="charliteral">'A'</span> - 1, pPlayerGroup-&gt;<a class="code" href="structGROUP.html#22d4cef8a4b5c35af9a8259b763c26f0">ubNextX</a> );
<a name="l01582"></a>01582 <span class="preprocessor">            #endif</span>
<a name="l01583"></a>01583 <span class="preprocessor"></span>      }
<a name="l01584"></a>01584       <span class="keywordflow">else</span>
<a name="l01585"></a>01585       {
<a name="l01586"></a>01586             <a class="code" href="Strategic_01AI_8cpp.html#3865b55f00d5df7710bd4325ddf83bfc">MoveSAIGroupToSector</a>( &amp;pEnemyGroup, (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)SECTOR( pPlayerGroup-&gt;<a class="code" href="structGROUP.html#eee29372e834112984eab1dc714466c0">ubSectorX</a>, pPlayerGroup-&gt;<a class="code" href="structGROUP.html#11cd63715d9daf1488cca330690db007">ubSectorY</a> ), <a class="code" href="Strategic_01AI_8cpp.html#2282261c2887b2d4d1183cf5249e15291ea328a644e627283a35716a54108248">DIRECT</a>, <a class="code" href="Strategic_01Movement_8h.html#b59c1bec446b10af208f977a871d910bede7846a7ab284d348a227dc5858530f">PURSUIT</a> );
<a name="l01587"></a>01587       
<a name="l01588"></a>01588 <span class="preprocessor">            #ifdef JA2BETAVERSION</span>
<a name="l01589"></a>01589 <span class="preprocessor"></span>                  <a class="code" href="Strategic_01AI_8cpp.html#984e97af1f29d3b417cc5bdcd126cfca">LogStrategicEvent</a>( <span class="stringliteral">"Enemy group at %c%d detected player group at %c%d and is moving to intercept them at %c%d."</span>, 
<a name="l01590"></a>01590                         pEnemyGroup-&gt;<a class="code" href="structGROUP.html#11cd63715d9daf1488cca330690db007">ubSectorY</a> + <span class="charliteral">'A'</span> - 1, pEnemyGroup-&gt;<a class="code" href="structGROUP.html#eee29372e834112984eab1dc714466c0">ubSectorX</a>,
<a name="l01591"></a>01591                         pPlayerGroup-&gt;<a class="code" href="structGROUP.html#11cd63715d9daf1488cca330690db007">ubSectorY</a> + <span class="charliteral">'A'</span> - 1, pPlayerGroup-&gt;<a class="code" href="structGROUP.html#eee29372e834112984eab1dc714466c0">ubSectorX</a>, 
<a name="l01592"></a>01592                         pPlayerGroup-&gt;<a class="code" href="structGROUP.html#11cd63715d9daf1488cca330690db007">ubSectorY</a> + <span class="charliteral">'A'</span> - 1, pPlayerGroup-&gt;<a class="code" href="structGROUP.html#eee29372e834112984eab1dc714466c0">ubSectorX</a> );
<a name="l01593"></a>01593 <span class="preprocessor">            #endif</span>
<a name="l01594"></a>01594 <span class="preprocessor"></span>      }
<a name="l01595"></a>01595       <span class="keywordflow">return</span> TRUE;
<a name="l01596"></a>01596 }
<a name="l01597"></a>01597 
<a name="l01598"></a><a class="code" href="Strategic_01AI_8cpp.html#37d5de1723e5e64fd91aef9ec3018f14">01598</a> <span class="keywordtype">void</span> <a class="code" href="Strategic_01AI_8cpp.html#37d5de1723e5e64fd91aef9ec3018f14">HandlePlayerGroupNoticedByGarrison</a>( <a class="code" href="structGROUP.html">GROUP</a> *pPlayerGroup, <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubSectorID )
<a name="l01599"></a>01599 {
<a name="l01600"></a>01600       <a class="code" href="structSECTORINFO.html">SECTORINFO</a> *pSector;
<a name="l01601"></a>01601       <a class="code" href="structGROUP.html">GROUP</a> *pGroup;
<a name="l01602"></a>01602       <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a> iReinforcementsApproved;
<a name="l01603"></a>01603       <a class="code" href="Types_8h.html#09f1a1fb2293e33483cc8d44aefb1eb1">UINT16</a> usOffensePoints, usDefencePoints;
<a name="l01604"></a>01604       <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubEnemies;
<a name="l01605"></a>01605       pSector = &amp;<a class="code" href="Campaign_01Types_8h.html#d83c6f699f17a47cf6a662c91d959126">SectorInfo</a>[ ubSectorID ];
<a name="l01606"></a>01606       <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a> iMaxEnemyGroupSize = <a class="code" href="GameSettings_8cpp.html#5c32f930e2fef384505c4b91803a92c2">gGameExternalOptions</a>.<a class="code" href="structGAME__EXTERNAL__OPTIONS.html#e0dd958b9c8219730a767a875dda20d5">iMaxEnemyGroupSize</a>;
<a name="l01607"></a>01607 DebugMsg (<a class="code" href="DEBUG_8cpp.html#a7985c2fd033797fc67a03b2c26e07c6">TOPIC_JA2</a>,DBG_LEVEL_3,<span class="stringliteral">"Strategic4"</span>);
<a name="l01608"></a>01608 
<a name="l01609"></a>01609       <span class="comment">//First check to see if the player is at his final destination.</span>
<a name="l01610"></a>01610       <span class="keywordflow">if</span>( !<a class="code" href="Strategic_01Movement_8cpp.html#5bffbc0549f4fb0c8829436f9ee6e907">GroupAtFinalDestination</a>( pPlayerGroup ) )
<a name="l01611"></a>01611       {
<a name="l01612"></a>01612             <span class="keywordflow">return</span>;
<a name="l01613"></a>01613       }
<a name="l01614"></a>01614       usOffensePoints = pSector-&gt;<a class="code" href="structSECTORINFO.html#d7d5ee63c0dc2ad3164c83541bd80906">ubNumAdmins</a> * 2 +
<a name="l01615"></a>01615                                                             pSector-&gt;<a class="code" href="structSECTORINFO.html#e36540b93256cfa71e45382f133d3696">ubNumTroops</a> * 4 +
<a name="l01616"></a>01616                                                             pSector-&gt;<a class="code" href="structSECTORINFO.html#3c5312672399c40ec5a395e8bcfb0104">ubNumElites</a> * 6;
<a name="l01617"></a>01617       <span class="keywordflow">if</span>( <a class="code" href="Strategic_01AI_8cpp.html#8d10ec503f28c85754a6f32bd3cde826">PlayerForceTooStrong</a>( ubSectorID, usOffensePoints, &amp;usDefencePoints ) )
<a name="l01618"></a>01618       {
<a name="l01619"></a>01619             <a class="code" href="Strategic_01AI_8cpp.html#e521ef3ef604f1b3f3af7308b87a5e68">RequestAttackOnSector</a>( ubSectorID, usDefencePoints );
<a name="l01620"></a>01620             <span class="keywordflow">return</span>;
<a name="l01621"></a>01621       }
<a name="l01622"></a>01622 
<a name="l01623"></a>01623       <span class="keywordflow">if</span>( pSector-&gt;<a class="code" href="structSECTORINFO.html#9465931dad0e164d7d47814b66e454f0">ubGarrisonID</a> != NO_GARRISON )
<a name="l01624"></a>01624       {
<a name="l01625"></a>01625             <span class="comment">//Decide whether or not they will attack them with some of the troops.</span>
<a name="l01626"></a>01626             ubEnemies = (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)(pSector-&gt;<a class="code" href="structSECTORINFO.html#d7d5ee63c0dc2ad3164c83541bd80906">ubNumAdmins</a> + pSector-&gt;<a class="code" href="structSECTORINFO.html#e36540b93256cfa71e45382f133d3696">ubNumTroops</a> + pSector-&gt;<a class="code" href="structSECTORINFO.html#3c5312672399c40ec5a395e8bcfb0104">ubNumElites</a>);
<a name="l01627"></a>01627             <span class="keywordflow">if</span> ( <a class="code" href="GameSettings_8cpp.html#f9f2d5fd368ccadcc26bebc202d52ae7">gGameOptions</a>.<a class="code" href="structGAME__OPTIONS.html#4fb44167906152722f6af5cc9f7c1a99">ubDifficultyLevel</a> == <a class="code" href="GameSettings_8h.html#c205be2172292384dd687b5471a87eddc657c89fd754a6f20b3869250288a702">DIF_LEVEL_INSANE</a> )
<a name="l01628"></a>01628                   iReinforcementsApproved = (ubEnemies - <a class="code" href="AI_01Viewer_8cpp.html#77e448d1f208bd120f861571e6d0098f">gArmyComp</a>[ <a class="code" href="AI_01Viewer_8cpp.html#a9f940d7f3a6d6698bfaeb7c747d74a9">gGarrisonGroup</a>[ pSector-&gt;<a class="code" href="structSECTORINFO.html#9465931dad0e164d7d47814b66e454f0">ubGarrisonID</a> ].<a class="code" href="structGARRISON__GROUP.html#a8feee88c982ca594b5bb1fcd2971ea5">ubComposition</a> ].<a class="code" href="structARMY__COMPOSITION.html#164db6c6c30629f43d42469671367c86">bDesiredPopulation</a> );
<a name="l01629"></a>01629             <span class="keywordflow">else</span>  
<a name="l01630"></a>01630                   iReinforcementsApproved = (ubEnemies - <a class="code" href="AI_01Viewer_8cpp.html#77e448d1f208bd120f861571e6d0098f">gArmyComp</a>[ <a class="code" href="AI_01Viewer_8cpp.html#a9f940d7f3a6d6698bfaeb7c747d74a9">gGarrisonGroup</a>[ pSector-&gt;<a class="code" href="structSECTORINFO.html#9465931dad0e164d7d47814b66e454f0">ubGarrisonID</a> ].<a class="code" href="structGARRISON__GROUP.html#a8feee88c982ca594b5bb1fcd2971ea5">ubComposition</a> ].<a class="code" href="structARMY__COMPOSITION.html#164db6c6c30629f43d42469671367c86">bDesiredPopulation</a> / 2);
<a name="l01631"></a>01631             
<a name="l01632"></a>01632             <span class="keywordflow">if</span>( iReinforcementsApproved*2 &gt; pPlayerGroup-&gt;<a class="code" href="structGROUP.html#2a98517c894019ee794e04ea05d1aeaf">ubGroupSize</a>*3 &amp;&amp; iReinforcementsApproved &gt; <a class="code" href="Strategic_01AI_8cpp.html#12b5525b1f3dabeac40700eecd3219e7">gubMinEnemyGroupSize</a> )
<a name="l01633"></a>01633             { <span class="comment">//Then enemy's available outnumber the player by at least 3:2, so attack them.</span>
<a name="l01634"></a>01634                   pGroup = <a class="code" href="Strategic_01Movement_8cpp.html#a6ac42d3d57b37a44bc39b3cd55ec008">CreateNewEnemyGroupDepartingFromSector</a>( ubSectorID, 0, (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)iReinforcementsApproved, 0 );
<a name="l01635"></a>01635 
<a name="l01636"></a>01636                   <a class="code" href="Strategic_01AI_8cpp.html#d4c479be89206291565d9795d7515967">ConvertGroupTroopsToComposition</a>( pGroup, <a class="code" href="AI_01Viewer_8cpp.html#a9f940d7f3a6d6698bfaeb7c747d74a9">gGarrisonGroup</a>[ pSector-&gt;<a class="code" href="structSECTORINFO.html#9465931dad0e164d7d47814b66e454f0">ubGarrisonID</a> ].ubComposition );
<a name="l01637"></a>01637 
<a name="l01638"></a>01638                   <a class="code" href="Strategic_01AI_8cpp.html#3865b55f00d5df7710bd4325ddf83bfc">MoveSAIGroupToSector</a>( &amp;pGroup, (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)SECTOR( pPlayerGroup-&gt;<a class="code" href="structGROUP.html#eee29372e834112984eab1dc714466c0">ubSectorX</a>, pPlayerGroup-&gt;<a class="code" href="structGROUP.html#11cd63715d9daf1488cca330690db007">ubSectorY</a> ), <a class="code" href="Strategic_01AI_8cpp.html#2282261c2887b2d4d1183cf5249e15291ea328a644e627283a35716a54108248">DIRECT</a>, <a class="code" href="Strategic_01Movement_8h.html#b59c1bec446b10af208f977a871d910b095b1f433b659c686164f67bb7b89cb1">REINFORCEMENTS</a> );
<a name="l01639"></a>01639 
<a name="l01640"></a>01640                   <a class="code" href="Strategic_01AI_8cpp.html#b07cff54af372d6ec184957cb7b51266">RemoveSoldiersFromGarrisonBasedOnComposition</a>( pSector-&gt;<a class="code" href="structSECTORINFO.html#9465931dad0e164d7d47814b66e454f0">ubGarrisonID</a>, pGroup-&gt;<a class="code" href="structGROUP.html#2a98517c894019ee794e04ea05d1aeaf">ubGroupSize</a> );
<a name="l01641"></a>01641 
<a name="l01642"></a>01642                   <span class="keywordflow">if</span>( pSector-&gt;<a class="code" href="structSECTORINFO.html#e36540b93256cfa71e45382f133d3696">ubNumTroops</a> + pSector-&gt;<a class="code" href="structSECTORINFO.html#3c5312672399c40ec5a395e8bcfb0104">ubNumElites</a> + pSector-&gt;<a class="code" href="structSECTORINFO.html#d7d5ee63c0dc2ad3164c83541bd80906">ubNumAdmins</a> &gt; iMaxEnemyGroupSize )
<a name="l01643"></a>01643                   {
<a name="l01644"></a>01644 <span class="preprocessor">                        #ifdef JA2BETAVERSION</span>
<a name="l01645"></a>01645 <span class="preprocessor"></span>                              <a class="code" href="Strategic_01AI_8cpp.html#984e97af1f29d3b417cc5bdcd126cfca">LogStrategicEvent</a>( <span class="stringliteral">"ERROR:  Sector %c%d now has %d enemies (max %d)."</span>, 
<a name="l01646"></a>01646                                     <a class="code" href="AI_01Viewer_8cpp.html#a9f940d7f3a6d6698bfaeb7c747d74a9">gGarrisonGroup</a>[ pSector-&gt;<a class="code" href="structSECTORINFO.html#9465931dad0e164d7d47814b66e454f0">ubGarrisonID</a> ].ubSectorID / 16 + <span class="charliteral">'A'</span> , <a class="code" href="AI_01Viewer_8cpp.html#a9f940d7f3a6d6698bfaeb7c747d74a9">gGarrisonGroup</a>[ pSector-&gt;<a class="code" href="structSECTORINFO.html#9465931dad0e164d7d47814b66e454f0">ubGarrisonID</a> ].ubSectorID % 16,
<a name="l01647"></a>01647                                     pSector-&gt;<a class="code" href="structSECTORINFO.html#e36540b93256cfa71e45382f133d3696">ubNumTroops</a> + pSector-&gt;<a class="code" href="structSECTORINFO.html#3c5312672399c40ec5a395e8bcfb0104">ubNumElites</a> + pSector-&gt;<a class="code" href="structSECTORINFO.html#d7d5ee63c0dc2ad3164c83541bd80906">ubNumAdmins</a>, iMaxEnemyGroupSize );
<a name="l01648"></a>01648 <span class="preprocessor">                        #endif</span>
<a name="l01649"></a>01649 <span class="preprocessor"></span>                  }
<a name="l01650"></a>01650                   
<a name="l01651"></a>01651 <span class="preprocessor">                  #ifdef JA2BETAVERSION</span>
<a name="l01652"></a>01652 <span class="preprocessor"></span>                        <a class="code" href="Strategic_01AI_8cpp.html#984e97af1f29d3b417cc5bdcd126cfca">LogStrategicEvent</a>( <span class="stringliteral">"Enemy garrison at %c%d detected stopped player group at %c%d and is sending %d troops to attack."</span>, 
<a name="l01653"></a>01653                               <a class="code" href="AI_01Viewer_8cpp.html#a9f940d7f3a6d6698bfaeb7c747d74a9">gGarrisonGroup</a>[ pSector-&gt;<a class="code" href="structSECTORINFO.html#9465931dad0e164d7d47814b66e454f0">ubGarrisonID</a> ].ubSectorID / 16 + <span class="charliteral">'A'</span> , <a class="code" href="AI_01Viewer_8cpp.html#a9f940d7f3a6d6698bfaeb7c747d74a9">gGarrisonGroup</a>[ pSector-&gt;<a class="code" href="structSECTORINFO.html#9465931dad0e164d7d47814b66e454f0">ubGarrisonID</a> ].ubSectorID % 16,
<a name="l01654"></a>01654                               pPlayerGroup-&gt;<a class="code" href="structGROUP.html#11cd63715d9daf1488cca330690db007">ubSectorY</a> + <span class="charliteral">'A'</span> - 1, pPlayerGroup-&gt;<a class="code" href="structGROUP.html#eee29372e834112984eab1dc714466c0">ubSectorX</a>, 
<a name="l01655"></a>01655                               pGroup-&gt;<a class="code" href="structGROUP.html#f82ff4c3e504e4bb10feb65491f79471">pEnemyGroup</a>-&gt;<a class="code" href="structENEMYGROUP.html#5f20a703a3c536505126979265b10558">ubNumElites</a> + pGroup-&gt;<a class="code" href="structGROUP.html#f82ff4c3e504e4bb10feb65491f79471">pEnemyGroup</a>-&gt;<a class="code" href="structENEMYGROUP.html#27eaaea857408bc6c6358054c19f2d07">ubNumTroops</a> );
<a name="l01656"></a>01656 <span class="preprocessor">                  #endif</span>
<a name="l01657"></a>01657 <span class="preprocessor"></span>            }
<a name="l01658"></a>01658       }
<a name="l01659"></a>01659 }
<a name="l01660"></a>01660 
<a name="l01661"></a><a class="code" href="Strategic_01AI_8cpp.html#5851146c1a45469119bacdfda4fd1bf1">01661</a> <a class="code" href="Types_8h.html#112e3146cb38b6ee95e64d85842e380a">BOOLEAN</a> <a class="code" href="Strategic_01AI_8cpp.html#5851146c1a45469119bacdfda4fd1bf1">HandleMilitiaNoticedByPatrolGroup</a>( <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubSectorID, <a class="code" href="structGROUP.html">GROUP</a> *pEnemyGroup )
<a name="l01662"></a>01662 {
<a name="l01663"></a>01663       <span class="comment">//For now, automatically attack.</span>
<a name="l01664"></a>01664       <a class="code" href="Types_8h.html#09f1a1fb2293e33483cc8d44aefb1eb1">UINT16</a> usOffensePoints, usDefencePoints;
<a name="l01665"></a>01665       <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubSectorX = (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)(ubSectorID % 16) + 1;
<a name="l01666"></a>01666       <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubSectorY = (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)(ubSectorID / 16) + 1;
<a name="l01667"></a>01667       usOffensePoints = pEnemyGroup-&gt;<a class="code" href="structGROUP.html#f82ff4c3e504e4bb10feb65491f79471">pEnemyGroup</a>-&gt;<a class="code" href="structENEMYGROUP.html#61d6f824f39709580afa7a81317e241b">ubNumAdmins</a> * 2 +
<a name="l01668"></a>01668                                                             pEnemyGroup-&gt;<a class="code" href="structGROUP.html#f82ff4c3e504e4bb10feb65491f79471">pEnemyGroup</a>-&gt;<a class="code" href="structENEMYGROUP.html#27eaaea857408bc6c6358054c19f2d07">ubNumTroops</a> * 4 +
<a name="l01669"></a>01669                                                             pEnemyGroup-&gt;<a class="code" href="structGROUP.html#f82ff4c3e504e4bb10feb65491f79471">pEnemyGroup</a>-&gt;<a class="code" href="structENEMYGROUP.html#5f20a703a3c536505126979265b10558">ubNumElites</a> * 6;
<a name="l01670"></a>01670       <span class="keywordflow">if</span>( <a class="code" href="Strategic_01AI_8cpp.html#8d10ec503f28c85754a6f32bd3cde826">PlayerForceTooStrong</a>( ubSectorID, usOffensePoints, &amp;usDefencePoints ) )
<a name="l01671"></a>01671       {
<a name="l01672"></a>01672             <a class="code" href="Strategic_01AI_8cpp.html#e521ef3ef604f1b3f3af7308b87a5e68">RequestAttackOnSector</a>( ubSectorID, usDefencePoints );
<a name="l01673"></a>01673             <span class="keywordflow">return</span> FALSE;
<a name="l01674"></a>01674       }
<a name="l01675"></a>01675 
<a name="l01676"></a>01676       <a class="code" href="Strategic_01AI_8cpp.html#3865b55f00d5df7710bd4325ddf83bfc">MoveSAIGroupToSector</a>( &amp;pEnemyGroup, (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)SECTOR( ubSectorX, ubSectorY ), <a class="code" href="Strategic_01AI_8cpp.html#2282261c2887b2d4d1183cf5249e15291ea328a644e627283a35716a54108248">DIRECT</a>, <a class="code" href="Strategic_01Movement_8h.html#b59c1bec446b10af208f977a871d910b095b1f433b659c686164f67bb7b89cb1">REINFORCEMENTS</a> );
<a name="l01677"></a>01677       
<a name="l01678"></a>01678 <span class="preprocessor">      #ifdef JA2BETAVERSION</span>
<a name="l01679"></a>01679 <span class="preprocessor"></span>            <a class="code" href="Strategic_01AI_8cpp.html#984e97af1f29d3b417cc5bdcd126cfca">LogStrategicEvent</a>( <span class="stringliteral">"Enemy group at %c%d detected militia at %c%d and is moving to attack them."</span>, 
<a name="l01680"></a>01680                   pEnemyGroup-&gt;<a class="code" href="structGROUP.html#11cd63715d9daf1488cca330690db007">ubSectorY</a> + <span class="charliteral">'A'</span> - 1, pEnemyGroup-&gt;<a class="code" href="structGROUP.html#eee29372e834112984eab1dc714466c0">ubSectorX</a>,
<a name="l01681"></a>01681                   ubSectorY + <span class="charliteral">'A'</span> - 1, ubSectorX );
<a name="l01682"></a>01682 <span class="preprocessor">      #endif</span>
<a name="l01683"></a>01683 <span class="preprocessor"></span>      <span class="keywordflow">return</span> FALSE;
<a name="l01684"></a>01684 }
<a name="l01685"></a>01685 
<a name="l01686"></a><a class="code" href="Strategic_01AI_8cpp.html#f56d1e63c211df4c0082157c73603a78">01686</a> <a class="code" href="Types_8h.html#112e3146cb38b6ee95e64d85842e380a">BOOLEAN</a> <a class="code" href="Strategic_01AI_8cpp.html#f56d1e63c211df4c0082157c73603a78">AttemptToNoticeEmptySectorSucceeds</a>()
<a name="l01687"></a>01687 {
<a name="l01688"></a>01688       <span class="keywordflow">if</span>( <a class="code" href="Strategic_01AI_8cpp.html#ab475b2c021e0d3a27bc5f4c7bd22639">gubNumAwareBattles</a> || <a class="code" href="mapscreen_8cpp.html#0b19bf9a0569a096cc99bf573da9e441">gfAutoAIAware</a> )
<a name="l01689"></a>01689       { <span class="comment">//The queen is in high-alert and is searching for players.  All adjacent checks will automatically succeed.</span>
<a name="l01690"></a>01690             <span class="keywordflow">return</span> TRUE;
<a name="l01691"></a>01691       }
<a name="l01692"></a>01692       <span class="keywordflow">if</span>( <a class="code" href="Game_01Clock_8cpp.html#5880271c0d898c339f6f8269cd22cf54">DayTime</a>() )
<a name="l01693"></a>01693       { <span class="comment">//Day time chances are normal</span>
<a name="l01694"></a>01694             <span class="keywordflow">if</span>( <a class="code" href="Random_8cpp.html#742221657b584d8416ada22fa8ff23dd">Chance</a>( <a class="code" href="Strategic_01AI_8cpp.html#5ca96833bf812b9e43da8510ca54f00a">giArmyAlertness</a> ) )
<a name="l01695"></a>01695             {
<a name="l01696"></a>01696                   <a class="code" href="Strategic_01AI_8cpp.html#5ca96833bf812b9e43da8510ca54f00a">giArmyAlertness</a> -= <a class="code" href="Strategic_01AI_8cpp.html#1bdeafde98c11d85ed1f79f8c793b1bc">giArmyAlertnessDecay</a>;
<a name="l01697"></a>01697                   <span class="comment">//Minimum alertness should always be at least 0.</span>
<a name="l01698"></a>01698                   <a class="code" href="Strategic_01AI_8cpp.html#5ca96833bf812b9e43da8510ca54f00a">giArmyAlertness</a> = max( 0, <a class="code" href="Strategic_01AI_8cpp.html#5ca96833bf812b9e43da8510ca54f00a">giArmyAlertness</a> );
<a name="l01699"></a>01699                   <span class="keywordflow">return</span> TRUE;
<a name="l01700"></a>01700             }
<a name="l01701"></a>01701             <a class="code" href="Strategic_01AI_8cpp.html#5ca96833bf812b9e43da8510ca54f00a">giArmyAlertness</a>++;
<a name="l01702"></a>01702             <span class="keywordflow">return</span> FALSE;
<a name="l01703"></a>01703       }
<a name="l01704"></a>01704       <span class="comment">//Night time chances are one third of normal.</span>
<a name="l01705"></a>01705       <span class="keywordflow">if</span>( <a class="code" href="Random_8cpp.html#742221657b584d8416ada22fa8ff23dd">Chance</a>( <a class="code" href="Strategic_01AI_8cpp.html#5ca96833bf812b9e43da8510ca54f00a">giArmyAlertness</a>/3 ) )
<a name="l01706"></a>01706       {
<a name="l01707"></a>01707             <a class="code" href="Strategic_01AI_8cpp.html#5ca96833bf812b9e43da8510ca54f00a">giArmyAlertness</a> -= <a class="code" href="Strategic_01AI_8cpp.html#1bdeafde98c11d85ed1f79f8c793b1bc">giArmyAlertnessDecay</a>;
<a name="l01708"></a>01708             <span class="comment">//Minimum alertness should always be at least 0.</span>
<a name="l01709"></a>01709             <a class="code" href="Strategic_01AI_8cpp.html#5ca96833bf812b9e43da8510ca54f00a">giArmyAlertness</a> = max( 0, <a class="code" href="Strategic_01AI_8cpp.html#5ca96833bf812b9e43da8510ca54f00a">giArmyAlertness</a> );
<a name="l01710"></a>01710             <span class="keywordflow">return</span> TRUE;
<a name="l01711"></a>01711       }
<a name="l01712"></a>01712       <span class="keywordflow">if</span>( <a class="code" href="Random_8cpp.html#742221657b584d8416ada22fa8ff23dd">Chance</a>( 33 ) )
<a name="l01713"></a>01713       {
<a name="l01714"></a>01714             <a class="code" href="Strategic_01AI_8cpp.html#5ca96833bf812b9e43da8510ca54f00a">giArmyAlertness</a>++;
<a name="l01715"></a>01715       }
<a name="l01716"></a>01716       <span class="keywordflow">return</span> FALSE;
<a name="l01717"></a>01717 }
<a name="l01718"></a>01718 
<a name="l01719"></a>01719 <span class="comment">//Calling the function assumes that a player group is found to be adjacent to an enemy group.</span>
<a name="l01720"></a>01720 <span class="comment">//This uses the alertness rating to emulate the chance that the group will notice.  If it does </span>
<a name="l01721"></a>01721 <span class="comment">//notice, then the alertness drops accordingly to simulate a period of time where the enemy would</span>
<a name="l01722"></a>01722 <span class="comment">//not notice as much.  If it fails, the alertness gradually increases until it succeeds.</span>
<a name="l01723"></a><a class="code" href="Strategic_01AI_8cpp.html#cfe2abd9df33e8d3ae8f0bf9a6f82c93">01723</a> <a class="code" href="Types_8h.html#112e3146cb38b6ee95e64d85842e380a">BOOLEAN</a> <a class="code" href="Strategic_01AI_8cpp.html#cfe2abd9df33e8d3ae8f0bf9a6f82c93">AttemptToNoticeAdjacentGroupSucceeds</a>()
<a name="l01724"></a>01724 {
<a name="l01725"></a>01725       <span class="keywordflow">if</span>( <a class="code" href="Strategic_01AI_8cpp.html#ab475b2c021e0d3a27bc5f4c7bd22639">gubNumAwareBattles</a> || <a class="code" href="mapscreen_8cpp.html#0b19bf9a0569a096cc99bf573da9e441">gfAutoAIAware</a> )
<a name="l01726"></a>01726       { <span class="comment">//The queen is in high-alert and is searching for players.  All adjacent checks will automatically succeed.</span>
<a name="l01727"></a>01727             <span class="keywordflow">return</span> TRUE;
<a name="l01728"></a>01728       }
<a name="l01729"></a>01729       <span class="keywordflow">if</span>( <a class="code" href="Game_01Clock_8cpp.html#5880271c0d898c339f6f8269cd22cf54">DayTime</a>() )
<a name="l01730"></a>01730       { <span class="comment">//Day time chances are normal</span>
<a name="l01731"></a>01731             <span class="keywordflow">if</span>( <a class="code" href="Random_8cpp.html#742221657b584d8416ada22fa8ff23dd">Chance</a>( <a class="code" href="Strategic_01AI_8cpp.html#5ca96833bf812b9e43da8510ca54f00a">giArmyAlertness</a> ) )
<a name="l01732"></a>01732             {
<a name="l01733"></a>01733                   <a class="code" href="Strategic_01AI_8cpp.html#5ca96833bf812b9e43da8510ca54f00a">giArmyAlertness</a> -= <a class="code" href="Strategic_01AI_8cpp.html#1bdeafde98c11d85ed1f79f8c793b1bc">giArmyAlertnessDecay</a>;
<a name="l01734"></a>01734                   <span class="comment">//Minimum alertness should always be at least 0.</span>
<a name="l01735"></a>01735                   <a class="code" href="Strategic_01AI_8cpp.html#5ca96833bf812b9e43da8510ca54f00a">giArmyAlertness</a> = max( 0, <a class="code" href="Strategic_01AI_8cpp.html#5ca96833bf812b9e43da8510ca54f00a">giArmyAlertness</a> );
<a name="l01736"></a>01736                   <span class="keywordflow">return</span> TRUE;
<a name="l01737"></a>01737             }
<a name="l01738"></a>01738             <a class="code" href="Strategic_01AI_8cpp.html#5ca96833bf812b9e43da8510ca54f00a">giArmyAlertness</a>++;
<a name="l01739"></a>01739             <span class="keywordflow">return</span> FALSE;
<a name="l01740"></a>01740       }
<a name="l01741"></a>01741       <span class="comment">//Night time chances are one third of normal.</span>
<a name="l01742"></a>01742       <span class="keywordflow">if</span>( <a class="code" href="Random_8cpp.html#742221657b584d8416ada22fa8ff23dd">Chance</a>( <a class="code" href="Strategic_01AI_8cpp.html#5ca96833bf812b9e43da8510ca54f00a">giArmyAlertness</a>/3 ) )
<a name="l01743"></a>01743       {
<a name="l01744"></a>01744             <a class="code" href="Strategic_01AI_8cpp.html#5ca96833bf812b9e43da8510ca54f00a">giArmyAlertness</a> -= <a class="code" href="Strategic_01AI_8cpp.html#1bdeafde98c11d85ed1f79f8c793b1bc">giArmyAlertnessDecay</a>;
<a name="l01745"></a>01745             <span class="comment">//Minimum alertness should always be at least 0.</span>
<a name="l01746"></a>01746             <a class="code" href="Strategic_01AI_8cpp.html#5ca96833bf812b9e43da8510ca54f00a">giArmyAlertness</a> = max( 0, <a class="code" href="Strategic_01AI_8cpp.html#5ca96833bf812b9e43da8510ca54f00a">giArmyAlertness</a> );
<a name="l01747"></a>01747             <span class="keywordflow">return</span> TRUE;
<a name="l01748"></a>01748       }
<a name="l01749"></a>01749       <span class="keywordflow">if</span>( <a class="code" href="Random_8cpp.html#742221657b584d8416ada22fa8ff23dd">Chance</a>( 33 ) )
<a name="l01750"></a>01750       {
<a name="l01751"></a>01751             <a class="code" href="Strategic_01AI_8cpp.html#5ca96833bf812b9e43da8510ca54f00a">giArmyAlertness</a>++;
<a name="l01752"></a>01752       }
<a name="l01753"></a>01753       <span class="keywordflow">return</span> FALSE;
<a name="l01754"></a>01754 }
<a name="l01755"></a>01755 
<a name="l01756"></a><a class="code" href="Strategic_01AI_8cpp.html#b9410f4eb7a3b3f3274ecb37bdd3bdd1">01756</a> <a class="code" href="Types_8h.html#112e3146cb38b6ee95e64d85842e380a">BOOLEAN</a> <a class="code" href="Strategic_01AI_8cpp.html#b9410f4eb7a3b3f3274ecb37bdd3bdd1">HandleEmptySectorNoticedByPatrolGroup</a>( <a class="code" href="structGROUP.html">GROUP</a> *pGroup, <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubEmptySectorID )
<a name="l01757"></a>01757 {
<a name="l01758"></a>01758       <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubGarrisonID;
<a name="l01759"></a>01759       <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubSectorX = (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)(ubEmptySectorID % 16) + 1;
<a name="l01760"></a>01760       <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubSectorY = (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)(ubEmptySectorID / 16) + 1;
<a name="l01761"></a>01761 
<a name="l01762"></a>01762       ubGarrisonID = <a class="code" href="Campaign_01Types_8h.html#d83c6f699f17a47cf6a662c91d959126">SectorInfo</a>[ ubEmptySectorID ].<a class="code" href="structSECTORINFO.html#9465931dad0e164d7d47814b66e454f0">ubGarrisonID</a>;
<a name="l01763"></a>01763       <span class="keywordflow">if</span>( ubGarrisonID != NO_GARRISON )
<a name="l01764"></a>01764       {
<a name="l01765"></a>01765             <span class="keywordflow">if</span>( <a class="code" href="AI_01Viewer_8cpp.html#a9f940d7f3a6d6698bfaeb7c747d74a9">gGarrisonGroup</a>[ ubGarrisonID ].ubPendingGroupID )
<a name="l01766"></a>01766             { 
<a name="l01767"></a>01767                   <span class="keywordflow">return</span> FALSE;
<a name="l01768"></a>01768             }
<a name="l01769"></a>01769       }
<a name="l01770"></a>01770       <span class="keywordflow">else</span>
<a name="l01771"></a>01771       {
<a name="l01772"></a>01772             <span class="keywordflow">return</span> FALSE;
<a name="l01773"></a>01773       }
<a name="l01774"></a>01774 
<a name="l01775"></a>01775       <span class="comment">//Clear the patrol group's previous orders.</span>
<a name="l01776"></a>01776       <a class="code" href="Auto_01Resolve_8cpp.html#bf99843dcb604b6d631665205f1a3d42">ClearPreviousAIGroupAssignment</a>( pGroup );
<a name="l01777"></a>01777 
<a name="l01778"></a>01778       <a class="code" href="AI_01Viewer_8cpp.html#a9f940d7f3a6d6698bfaeb7c747d74a9">gGarrisonGroup</a>[ ubGarrisonID ].<a class="code" href="structGARRISON__GROUP.html#ea8325bf63e1d81924fb5fab93b37d8e">ubPendingGroupID</a> = pGroup-&gt;<a class="code" href="structGROUP.html#9149379b9355afda87a382af5a88d728">ubGroupID</a>;
<a name="l01779"></a>01779       <a class="code" href="Strategic_01AI_8cpp.html#3865b55f00d5df7710bd4325ddf83bfc">MoveSAIGroupToSector</a>( &amp;pGroup, (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)SECTOR( ubSectorX, ubSectorY ), <a class="code" href="Strategic_01AI_8cpp.html#2282261c2887b2d4d1183cf5249e15291ea328a644e627283a35716a54108248">DIRECT</a>, <a class="code" href="Strategic_01Movement_8h.html#b59c1bec446b10af208f977a871d910b095b1f433b659c686164f67bb7b89cb1">REINFORCEMENTS</a> );
<a name="l01780"></a>01780       
<a name="l01781"></a>01781 <span class="preprocessor">      #ifdef JA2BETAVERSION</span>
<a name="l01782"></a>01782 <span class="preprocessor"></span>            <a class="code" href="Strategic_01AI_8cpp.html#984e97af1f29d3b417cc5bdcd126cfca">LogStrategicEvent</a>( <span class="stringliteral">"Enemy group at %c%d detected undefended sector at %c%d and is moving to retake it."</span>, 
<a name="l01783"></a>01783                   pGroup-&gt;<a class="code" href="structGROUP.html#11cd63715d9daf1488cca330690db007">ubSectorY</a> + <span class="charliteral">'A'</span> - 1, pGroup-&gt;<a class="code" href="structGROUP.html#eee29372e834112984eab1dc714466c0">ubSectorX</a>,
<a name="l01784"></a>01784                   ubSectorY + <span class="charliteral">'A'</span> - 1, ubSectorX );
<a name="l01785"></a>01785 <span class="preprocessor">      #endif</span>
<a name="l01786"></a>01786 <span class="preprocessor"></span>
<a name="l01787"></a>01787       <span class="keywordflow">return</span> TRUE;
<a name="l01788"></a>01788 }
<a name="l01789"></a>01789 
<a name="l01790"></a><a class="code" href="Strategic_01AI_8cpp.html#32c627631f162fa5a39aaedb01970a42">01790</a> <span class="keywordtype">void</span> <a class="code" href="Strategic_01AI_8cpp.html#32c627631f162fa5a39aaedb01970a42">HandleEmptySectorNoticedByGarrison</a>( <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubGarrisonSectorID, <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubEmptySectorID )
<a name="l01791"></a>01791 {
<a name="l01792"></a>01792       <a class="code" href="structSECTORINFO.html">SECTORINFO</a> *pSector;
<a name="l01793"></a>01793       <a class="code" href="structGROUP.html">GROUP</a> *pGroup;
<a name="l01794"></a>01794       <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubAvailableTroops;
<a name="l01795"></a>01795       <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubSrcGarrisonID = 255, ubDstGarrisonID = 255;
<a name="l01796"></a>01796 
<a name="l01797"></a>01797       <span class="comment">//Make sure that the destination sector doesn't already have a pending group.</span>
<a name="l01798"></a>01798       pSector = &amp;<a class="code" href="Campaign_01Types_8h.html#d83c6f699f17a47cf6a662c91d959126">SectorInfo</a>[ ubEmptySectorID ];
<a name="l01799"></a>01799 
<a name="l01800"></a>01800       ubSrcGarrisonID = <a class="code" href="Campaign_01Types_8h.html#d83c6f699f17a47cf6a662c91d959126">SectorInfo</a>[ ubGarrisonSectorID ].<a class="code" href="structSECTORINFO.html#9465931dad0e164d7d47814b66e454f0">ubGarrisonID</a>;
<a name="l01801"></a>01801       ubDstGarrisonID = <a class="code" href="Campaign_01Types_8h.html#d83c6f699f17a47cf6a662c91d959126">SectorInfo</a>[ ubEmptySectorID ].<a class="code" href="structSECTORINFO.html#9465931dad0e164d7d47814b66e454f0">ubGarrisonID</a>;
<a name="l01802"></a>01802 
<a name="l01803"></a>01803       <span class="keywordflow">if</span>( ubSrcGarrisonID == NO_GARRISON || ubDstGarrisonID == NO_GARRISON )
<a name="l01804"></a>01804       { <span class="comment">//Bad logic</span>
<a name="l01805"></a>01805             <span class="keywordflow">return</span>;
<a name="l01806"></a>01806       }
<a name="l01807"></a>01807 
<a name="l01808"></a>01808       <span class="keywordflow">if</span>( <a class="code" href="AI_01Viewer_8cpp.html#a9f940d7f3a6d6698bfaeb7c747d74a9">gGarrisonGroup</a>[ ubDstGarrisonID ].ubPendingGroupID )
<a name="l01809"></a>01809       { <span class="comment">//A group is already on-route, so don't send anybody from here.</span>
<a name="l01810"></a>01810             <span class="keywordflow">return</span>;
<a name="l01811"></a>01811       }
<a name="l01812"></a>01812 
<a name="l01813"></a>01813       <span class="comment">//An opportunity has arisen, where the enemy has noticed an important sector that is undefended.</span>
<a name="l01814"></a>01814       pSector = &amp;<a class="code" href="Campaign_01Types_8h.html#d83c6f699f17a47cf6a662c91d959126">SectorInfo</a>[ ubGarrisonSectorID ];
<a name="l01815"></a>01815       ubAvailableTroops = pSector-&gt;<a class="code" href="structSECTORINFO.html#e36540b93256cfa71e45382f133d3696">ubNumTroops</a> + pSector-&gt;<a class="code" href="structSECTORINFO.html#3c5312672399c40ec5a395e8bcfb0104">ubNumElites</a> + pSector-&gt;<a class="code" href="structSECTORINFO.html#d7d5ee63c0dc2ad3164c83541bd80906">ubNumAdmins</a>;
<a name="l01816"></a>01816 
<a name="l01817"></a>01817       <span class="keywordflow">if</span>( ubAvailableTroops &gt;= <a class="code" href="Strategic_01AI_8cpp.html#12b5525b1f3dabeac40700eecd3219e7">gubMinEnemyGroupSize</a> * 2 )
<a name="l01818"></a>01818       { <span class="comment">//split group into two groups, and move one of the groups to the next sector.</span>
<a name="l01819"></a>01819             pGroup = <a class="code" href="Strategic_01Movement_8cpp.html#a6ac42d3d57b37a44bc39b3cd55ec008">CreateNewEnemyGroupDepartingFromSector</a>( ubGarrisonSectorID, 0, (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)(ubAvailableTroops / 2), 0 );
<a name="l01820"></a>01820             <a class="code" href="Strategic_01AI_8cpp.html#d4c479be89206291565d9795d7515967">ConvertGroupTroopsToComposition</a>( pGroup, <a class="code" href="AI_01Viewer_8cpp.html#a9f940d7f3a6d6698bfaeb7c747d74a9">gGarrisonGroup</a>[ ubDstGarrisonID ].ubComposition );
<a name="l01821"></a>01821             <a class="code" href="Strategic_01AI_8cpp.html#b07cff54af372d6ec184957cb7b51266">RemoveSoldiersFromGarrisonBasedOnComposition</a>( ubSrcGarrisonID, pGroup-&gt;<a class="code" href="structGROUP.html#2a98517c894019ee794e04ea05d1aeaf">ubGroupSize</a> );
<a name="l01822"></a>01822             <a class="code" href="AI_01Viewer_8cpp.html#a9f940d7f3a6d6698bfaeb7c747d74a9">gGarrisonGroup</a>[ ubDstGarrisonID ].<a class="code" href="structGARRISON__GROUP.html#ea8325bf63e1d81924fb5fab93b37d8e">ubPendingGroupID</a> = pGroup-&gt;<a class="code" href="structGROUP.html#9149379b9355afda87a382af5a88d728">ubGroupID</a>;
<a name="l01823"></a>01823             <a class="code" href="Strategic_01AI_8cpp.html#3865b55f00d5df7710bd4325ddf83bfc">MoveSAIGroupToSector</a>( &amp;pGroup, ubEmptySectorID, <a class="code" href="Strategic_01AI_8cpp.html#2282261c2887b2d4d1183cf5249e15291ea328a644e627283a35716a54108248">DIRECT</a>, <a class="code" href="Strategic_01Movement_8h.html#b59c1bec446b10af208f977a871d910b095b1f433b659c686164f67bb7b89cb1">REINFORCEMENTS</a> );
<a name="l01824"></a>01824       }
<a name="l01825"></a>01825 }
<a name="l01826"></a>01826 
<a name="l01827"></a><a class="code" href="Strategic_01AI_8cpp.html#0cccefb435b3d940d9bf817c88224d6f">01827</a> <a class="code" href="Types_8h.html#112e3146cb38b6ee95e64d85842e380a">BOOLEAN</a> <a class="code" href="Strategic_01AI_8cpp.html#0cccefb435b3d940d9bf817c88224d6f">ReinforcementsApproved</a>( <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a> iGarrisonID, <a class="code" href="Types_8h.html#09f1a1fb2293e33483cc8d44aefb1eb1">UINT16</a> *pusDefencePoints )
<a name="l01828"></a>01828 {
<a name="l01829"></a>01829       <a class="code" href="structSECTORINFO.html">SECTORINFO</a> *pSector;
<a name="l01830"></a>01830       <a class="code" href="Types_8h.html#09f1a1fb2293e33483cc8d44aefb1eb1">UINT16</a> usOffensePoints;
<a name="l01831"></a>01831       <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubSectorX, ubSectorY;
<a name="l01832"></a>01832 
<a name="l01833"></a>01833       pSector = &amp;<a class="code" href="Campaign_01Types_8h.html#d83c6f699f17a47cf6a662c91d959126">SectorInfo</a>[ <a class="code" href="AI_01Viewer_8cpp.html#a9f940d7f3a6d6698bfaeb7c747d74a9">gGarrisonGroup</a>[ iGarrisonID ].<a class="code" href="structGARRISON__GROUP.html#fb130d3c9211374d87a85cca787fe0dd">ubSectorID</a> ];
<a name="l01834"></a>01834       ubSectorX = (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)SECTORX( gGarrisonGroup[ iGarrisonID ].ubSectorID );
<a name="l01835"></a>01835       ubSectorY = (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)SECTORY( gGarrisonGroup[ iGarrisonID ].ubSectorID );
<a name="l01836"></a>01836 
<a name="l01837"></a>01837       *pusDefencePoints = pSector-&gt;<a class="code" href="structSECTORINFO.html#71d253db041a4884b9ae6335f52fb082">ubNumberOfCivsAtLevel</a>[ <a class="code" href="Campaign_01Types_8h.html#6fde86696b9fb4575b16ddc150ff0a840b225c8d872b15875355f348d6e3335b">GREEN_MILITIA</a> ]           * 1 + 
<a name="l01838"></a>01838                                                             pSector-&gt;<a class="code" href="structSECTORINFO.html#71d253db041a4884b9ae6335f52fb082">ubNumberOfCivsAtLevel</a>[ <a class="code" href="Campaign_01Types_8h.html#6fde86696b9fb4575b16ddc150ff0a845612214b681e2988ea93890806802cc9">REGULAR_MILITIA</a> ] * 2 +
<a name="l01839"></a>01839                                                             pSector-&gt;<a class="code" href="structSECTORINFO.html#71d253db041a4884b9ae6335f52fb082">ubNumberOfCivsAtLevel</a>[ <a class="code" href="Campaign_01Types_8h.html#6fde86696b9fb4575b16ddc150ff0a840fcf7fc556b8af2f6d3ec39652d3a927">ELITE_MILITIA</a> ]       * 3 + 
<a name="l01840"></a>01840                                                             <a class="code" href="Strategic_01Movement_8cpp.html#39531a1493c62a63a373c7e8125ca7f7">PlayerMercsInSector</a>( ubSectorX, ubSectorY, 0 )        * 4;
<a name="l01841"></a>01841       usOffensePoints = <a class="code" href="AI_01Viewer_8cpp.html#77e448d1f208bd120f861571e6d0098f">gArmyComp</a>[ gGarrisonGroup[ iGarrisonID ].ubComposition ].<a class="code" href="structARMY__COMPOSITION.html#0ea39c434cb665d1e66172eba1d3c256">bAdminPercentage</a> * 2 + 
<a name="l01842"></a>01842                                                             <a class="code" href="AI_01Viewer_8cpp.html#77e448d1f208bd120f861571e6d0098f">gArmyComp</a>[ gGarrisonGroup[ iGarrisonID ].ubComposition ].<a class="code" href="structARMY__COMPOSITION.html#dcd9feb9bbaf14485e7151ae0c0652d2">bTroopPercentage</a> * 3 + 
<a name="l01843"></a>01843                                                             <a class="code" href="AI_01Viewer_8cpp.html#77e448d1f208bd120f861571e6d0098f">gArmyComp</a>[ gGarrisonGroup[ iGarrisonID ].ubComposition ].<a class="code" href="structARMY__COMPOSITION.html#2b7c33a62b43654cd8f66ebe2e7afaa0">bElitePercentage</a> * 4 +
<a name="l01844"></a>01844                                                             <a class="code" href="Strategic_01AI_8cpp.html#9bc393a708632bfedc7ce82ab9268709">gubGarrisonReinforcementsDenied</a>[ iGarrisonID ]; 
<a name="l01845"></a>01845       usOffensePoints = usOffensePoints * <a class="code" href="AI_01Viewer_8cpp.html#77e448d1f208bd120f861571e6d0098f">gArmyComp</a>[ gGarrisonGroup[ iGarrisonID ].ubComposition ].<a class="code" href="structARMY__COMPOSITION.html#164db6c6c30629f43d42469671367c86">bDesiredPopulation</a> / 100;
<a name="l01846"></a>01846 
<a name="l01847"></a>01847       <span class="keywordflow">if</span>( usOffensePoints &gt; *pusDefencePoints )
<a name="l01848"></a>01848       {
<a name="l01849"></a>01849             <span class="keywordflow">return</span> TRUE;
<a name="l01850"></a>01850       }
<a name="l01851"></a>01851       <span class="comment">//Before returning false, determine if reinforcements have been denied repeatedly.  If so, then</span>
<a name="l01852"></a>01852       <span class="comment">//we might send an augmented force to take it back.</span>
<a name="l01853"></a>01853       <span class="keywordflow">if</span>( <a class="code" href="Strategic_01AI_8cpp.html#9bc393a708632bfedc7ce82ab9268709">gubGarrisonReinforcementsDenied</a>[ iGarrisonID ] + usOffensePoints &gt; *pusDefencePoints )
<a name="l01854"></a>01854       {
<a name="l01855"></a>01855 <span class="preprocessor">            #ifdef JA2BETAVERSION</span>
<a name="l01856"></a>01856 <span class="preprocessor"></span>                  <a class="code" href="Strategic_01AI_8cpp.html#984e97af1f29d3b417cc5bdcd126cfca">LogStrategicEvent</a>( <span class="stringliteral">"Sector %c%d will now recieve an %d extra troops due to multiple denials for reinforcements in the past for strong player presence."</span>,
<a name="l01857"></a>01857                         ubSectorY + <span class="charliteral">'A'</span> - 1, ubSectorX, <a class="code" href="Strategic_01AI_8cpp.html#9bc393a708632bfedc7ce82ab9268709">gubGarrisonReinforcementsDenied</a>[ iGarrisonID ] / 3 );
<a name="l01858"></a>01858 <span class="preprocessor">            #endif</span>
<a name="l01859"></a>01859 <span class="preprocessor"></span>            <span class="keywordflow">return</span> TRUE;
<a name="l01860"></a>01860       }
<a name="l01861"></a>01861       <span class="comment">//Reinforcements will have to wait.  For now, increase the reinforcements denied.  The amount increase is 20 percent</span>
<a name="l01862"></a>01862       <span class="comment">//of the garrison's priority.</span>
<a name="l01863"></a>01863       <a class="code" href="Strategic_01AI_8cpp.html#9bc393a708632bfedc7ce82ab9268709">gubGarrisonReinforcementsDenied</a>[ iGarrisonID ] += (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)(<a class="code" href="AI_01Viewer_8cpp.html#77e448d1f208bd120f861571e6d0098f">gArmyComp</a>[ gGarrisonGroup[ iGarrisonID ].ubComposition ].bPriority / 2);
<a name="l01864"></a>01864 
<a name="l01865"></a>01865       <span class="keywordflow">return</span> FALSE;
<a name="l01866"></a>01866 }
<a name="l01867"></a>01867 
<a name="l01868"></a>01868 <span class="comment">//if the group has arrived in a sector, and doesn't have any particular orders, then</span>
<a name="l01869"></a>01869 <span class="comment">//send him back where they came from.</span>
<a name="l01870"></a>01870 <span class="comment">//RETURNS TRUE if the group is deleted or told to move somewhere else.  </span>
<a name="l01871"></a>01871 <span class="comment">//This is important as the calling function will need</span>
<a name="l01872"></a>01872 <span class="comment">//to abort processing of the group for obvious reasons.</span>
<a name="l01873"></a><a class="code" href="Strategic_01AI_8cpp.html#42d5667c02da82d67a9a81191ca32064">01873</a> <a class="code" href="Types_8h.html#112e3146cb38b6ee95e64d85842e380a">BOOLEAN</a> <a class="code" href="Strategic_01AI_8cpp.html#42d5667c02da82d67a9a81191ca32064">EvaluateGroupSituation</a>( <a class="code" href="structGROUP.html">GROUP</a> *pGroup )
<a name="l01874"></a>01874 {
<a name="l01875"></a>01875       <a class="code" href="structSECTORINFO.html">SECTORINFO</a> *pSector;
<a name="l01876"></a>01876       <a class="code" href="structGROUP.html">GROUP</a> *pPatrolGroup;
<a name="l01877"></a>01877       <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a> i;
<a name="l01878"></a>01878 DebugMsg (<a class="code" href="DEBUG_8cpp.html#a7985c2fd033797fc67a03b2c26e07c6">TOPIC_JA2</a>,DBG_LEVEL_3,<span class="stringliteral">"Strategic5"</span>);
<a name="l01879"></a>01879 
<a name="l01880"></a>01880       <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a> iMaxEnemyGroupSize = <a class="code" href="GameSettings_8cpp.html#5c32f930e2fef384505c4b91803a92c2">gGameExternalOptions</a>.<a class="code" href="structGAME__EXTERNAL__OPTIONS.html#e0dd958b9c8219730a767a875dda20d5">iMaxEnemyGroupSize</a>;
<a name="l01881"></a>01881 DebugMsg (<a class="code" href="DEBUG_8cpp.html#a7985c2fd033797fc67a03b2c26e07c6">TOPIC_JA2</a>,DBG_LEVEL_3,<span class="stringliteral">"Strategic5"</span>);
<a name="l01882"></a>01882       <a class="code" href="Strategic_01AI_8cpp.html#75d774eb03c41b5fe422edfef6e445d4">ValidateWeights</a>( 2 );
<a name="l01883"></a>01883       
<a name="l01884"></a>01884       <span class="keywordflow">if</span>( !<a class="code" href="AI_01Viewer_8cpp.html#38284bd39764812fb8a27fe4d3d2b0cd">gfQueenAIAwake</a> )
<a name="l01885"></a>01885       {
<a name="l01886"></a>01886             <span class="keywordflow">return</span> FALSE;
<a name="l01887"></a>01887       }
<a name="l01888"></a>01888       Assert( !pGroup-&gt;<a class="code" href="structGROUP.html#1420d1afb0a1876a85b6b93308fbaf68">fPlayer</a> );
<a name="l01889"></a>01889       <span class="keywordflow">if</span>( pGroup-&gt;<a class="code" href="structGROUP.html#f82ff4c3e504e4bb10feb65491f79471">pEnemyGroup</a>-&gt;<a class="code" href="structENEMYGROUP.html#6d1d418460b3704699f5e058925897e2">ubIntention</a> == <a class="code" href="Strategic_01Movement_8h.html#b59c1bec446b10af208f977a871d910bede7846a7ab284d348a227dc5858530f">PURSUIT</a> )
<a name="l01890"></a>01890       { <span class="comment">//Lost the player group that he was going to attack.  Return to original position.</span>
<a name="l01891"></a>01891             <a class="code" href="Strategic_01AI_8cpp.html#0ecd8a8d61c81aa34eeec15760348ffe">ReassignAIGroup</a>( &amp;pGroup );
<a name="l01892"></a>01892             <span class="keywordflow">return</span> TRUE;
<a name="l01893"></a>01893       }
<a name="l01894"></a>01894       <span class="keywordflow">else</span> <span class="keywordflow">if</span>( pGroup-&gt;<a class="code" href="structGROUP.html#f82ff4c3e504e4bb10feb65491f79471">pEnemyGroup</a>-&gt;<a class="code" href="structENEMYGROUP.html#6d1d418460b3704699f5e058925897e2">ubIntention</a> == <a class="code" href="Strategic_01Movement_8h.html#b59c1bec446b10af208f977a871d910b095b1f433b659c686164f67bb7b89cb1">REINFORCEMENTS</a> )
<a name="l01895"></a>01895       { <span class="comment">//The group has arrived at the location where he is supposed to reinforce.</span>
<a name="l01896"></a>01896             <span class="comment">//Step 1 -- Check for matching garrison location</span>
<a name="l01897"></a>01897             <span class="keywordflow">for</span>( i = 0; i &lt; giGarrisonArraySize; i++ )
<a name="l01898"></a>01898             {
<a name="l01899"></a>01899                   <span class="keywordflow">if</span>( <a class="code" href="AI_01Viewer_8cpp.html#a9f940d7f3a6d6698bfaeb7c747d74a9">gGarrisonGroup</a>[ i ].ubSectorID == SECTOR( pGroup-&gt;<a class="code" href="structGROUP.html#eee29372e834112984eab1dc714466c0">ubSectorX</a>, pGroup-&gt;<a class="code" href="structGROUP.html#11cd63715d9daf1488cca330690db007">ubSectorY</a> ) &amp;&amp;
<a name="l01900"></a>01900                               <a class="code" href="AI_01Viewer_8cpp.html#a9f940d7f3a6d6698bfaeb7c747d74a9">gGarrisonGroup</a>[ i ].<a class="code" href="structGARRISON__GROUP.html#ea8325bf63e1d81924fb5fab93b37d8e">ubPendingGroupID</a> == pGroup-&gt;<a class="code" href="structGROUP.html#9149379b9355afda87a382af5a88d728">ubGroupID</a> )
<a name="l01901"></a>01901                   {
<a name="l01902"></a>01902                         pSector = &amp;<a class="code" href="Campaign_01Types_8h.html#d83c6f699f17a47cf6a662c91d959126">SectorInfo</a>[ SECTOR( pGroup-&gt;<a class="code" href="structGROUP.html#eee29372e834112984eab1dc714466c0">ubSectorX</a>, pGroup-&gt;<a class="code" href="structGROUP.html#11cd63715d9daf1488cca330690db007">ubSectorY</a> ) ];
<a name="l01903"></a>01903 
<a name="l01904"></a>01904                         <span class="keywordflow">if</span>( <a class="code" href="AI_01Viewer_8cpp.html#a9f940d7f3a6d6698bfaeb7c747d74a9">gGarrisonGroup</a>[ i ].<a class="code" href="structGARRISON__GROUP.html#fb130d3c9211374d87a85cca787fe0dd">ubSectorID</a> != <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c66026438a2eb9999a6ad7c69c9ddbe2d95696ca">SEC_P3</a> )
<a name="l01905"></a>01905                         {
<a name="l01906"></a>01906                               <a class="code" href="Strategic_01AI_8cpp.html#989554da82194ffa19f0648cb09a26c4">EliminateSurplusTroopsForGarrison</a>( pGroup, pSector );
<a name="l01907"></a>01907                               pSector-&gt;<a class="code" href="structSECTORINFO.html#d7d5ee63c0dc2ad3164c83541bd80906">ubNumAdmins</a> = (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)(pSector-&gt;<a class="code" href="structSECTORINFO.html#d7d5ee63c0dc2ad3164c83541bd80906">ubNumAdmins</a> + pGroup-&gt;pEnemyGroup-&gt;ubNumAdmins);
<a name="l01908"></a>01908                               pSector-&gt;<a class="code" href="structSECTORINFO.html#e36540b93256cfa71e45382f133d3696">ubNumTroops</a> = (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)(pSector-&gt;<a class="code" href="structSECTORINFO.html#e36540b93256cfa71e45382f133d3696">ubNumTroops</a> + pGroup-&gt;pEnemyGroup-&gt;ubNumTroops);
<a name="l01909"></a>01909                               pSector-&gt;<a class="code" href="structSECTORINFO.html#3c5312672399c40ec5a395e8bcfb0104">ubNumElites</a> = (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)(pSector-&gt;<a class="code" href="structSECTORINFO.html#3c5312672399c40ec5a395e8bcfb0104">ubNumElites</a> + pGroup-&gt;pEnemyGroup-&gt;ubNumElites);
<a name="l01910"></a>01910 
<a name="l01911"></a>01911                               #ifdef JA2BETAVERSION
<a name="l01912"></a>01912                                     <a class="code" href="Strategic_01AI_8cpp.html#984e97af1f29d3b417cc5bdcd126cfca">LogStrategicEvent</a>( <span class="stringliteral">"%d reinforcements have arrived to garrison sector %c%d"</span>, 
<a name="l01913"></a>01913                                           pGroup-&gt;pEnemyGroup-&gt;ubNumAdmins + pGroup-&gt;pEnemyGroup-&gt;ubNumTroops + 
<a name="l01914"></a>01914                                           pGroup-&gt;pEnemyGroup-&gt;ubNumElites, pGroup-&gt;ubSectorY + <span class="charliteral">'A'</span> - 1, pGroup-&gt;ubSectorX );
<a name="l01915"></a>01915                               #<a class="code" href="mapscreen_8cpp.html#3e279efabf854742684341c3e4f50d31f763cd940df26ca8a9043b3c89ad0bcb">endif</a>
<a name="l01916"></a>01916                               <span class="keywordflow">if</span>( <a class="code" href="strategicmap_8cpp.html#aad459c13b87dd12c43c473c71641070">IsThisSectorASAMSector</a>( pGroup-&gt;ubSectorX, pGroup-&gt;ubSectorY, 0 ) )
<a name="l01917"></a>01917                               {
<a name="l01918"></a>01918                                     <a class="code" href="strategic_8cpp.html#6f48fb0ea28e3d4889423290f1a6ede8">StrategicMap</a>[ pGroup-&gt;ubSectorX + pGroup-&gt;ubSectorY * MAP_WORLD_X ].<a class="code" href="structstrategicmapelement.html#92155b98cf33fb3da4b40680cc0b58b4">bSAMCondition</a> = 100;
<a name="l01919"></a>01919                                     <a class="code" href="Explosion_01Control_8cpp.html#aae451ea8f744a7bb24dad80cf8352d5">UpdateSAMDoneRepair</a>( pGroup-&gt;ubSectorX, pGroup-&gt;ubSectorY, 0 );
<a name="l01920"></a>01920                               }
<a name="l01921"></a>01921                         }
<a name="l01922"></a>01922                         <span class="keywordflow">else</span>
<a name="l01923"></a>01923                         { <span class="comment">//The group was sent back to the queen's palace (probably because they couldn't be reassigned </span>
<a name="l01924"></a>01924                               <span class="comment">//anywhere else, but it is possible that the queen's sector is requesting the reinforcements.  In</span>
<a name="l01925"></a>01925                               <span class="comment">//any case, if the queen's sector is less than full strength, fill it up first, then</span>
<a name="l01926"></a>01926                               <span class="comment">//simply add the rest to the global pool.</span>
<a name="l01927"></a>01927                               <span class="keywordflow">if</span>( pSector-&gt;<a class="code" href="structSECTORINFO.html#3c5312672399c40ec5a395e8bcfb0104">ubNumElites</a> &lt; iMaxEnemyGroupSize )
<a name="l01928"></a>01928                               {
<a name="l01929"></a>01929                                     <span class="keywordflow">if</span>( pSector-&gt;<a class="code" href="structSECTORINFO.html#3c5312672399c40ec5a395e8bcfb0104">ubNumElites</a> + pGroup-&gt;<a class="code" href="structGROUP.html#2a98517c894019ee794e04ea05d1aeaf">ubGroupSize</a> &gt;= iMaxEnemyGroupSize )
<a name="l01930"></a>01930                                     { <span class="comment">//Fill up the queen's guards, then apply the rest to the reinforcement pool</span>
<a name="l01931"></a>01931 
<a name="l01932"></a>01932                                           <span class="comment">//Madd: unlimited reinforcements?, if so never increase/decrease it</span>
<a name="l01933"></a>01933                                           <a class="code" href="Soldier_01Ani_8cpp.html#c294aa65f0375eb6343a2de2a25dafcc">if</a> ( !<a class="code" href="Strategic_01AI_8cpp.html#b0c12688f38630da4e064c85394ca570">gfUnlimitedTroops</a> )
<a name="l01934"></a>01934                                                 <a class="code" href="AI_01Viewer_8cpp.html#c86cd58021961af10f1eb15108a79023">giReinforcementPool</a> += iMaxEnemyGroupSize - pSector-&gt;<a class="code" href="structSECTORINFO.html#3c5312672399c40ec5a395e8bcfb0104">ubNumElites</a>;
<a name="l01935"></a>01935       
<a name="l01936"></a>01936                                           pSector-&gt;<a class="code" href="structSECTORINFO.html#3c5312672399c40ec5a395e8bcfb0104">ubNumElites</a> = iMaxEnemyGroupSize;
<a name="l01937"></a>01937                                           #ifdef JA2BETAVERSION
<a name="l01938"></a>01938                                                 <a class="code" href="Strategic_01AI_8cpp.html#984e97af1f29d3b417cc5bdcd126cfca">LogStrategicEvent</a>( <span class="stringliteral">"%d reinforcements have arrived to garrison queen's sector.  The excess troops will be relocated to the reinforcement pool."</span>, 
<a name="l01939"></a>01939                                                       pGroup-&gt;<a class="code" href="structGROUP.html#2a98517c894019ee794e04ea05d1aeaf">ubGroupSize</a> );
<a name="l01940"></a>01940                                           #<a class="code" href="mapscreen_8cpp.html#3e279efabf854742684341c3e4f50d31f763cd940df26ca8a9043b3c89ad0bcb">endif</a>
<a name="l01941"></a>01941                                     }
<a name="l01942"></a>01942                                     <span class="keywordflow">else</span>
<a name="l01943"></a>01943                                     { <span class="comment">//Add all the troops to the queen's guard.</span>
<a name="l01944"></a>01944                                           pSector-&gt;<a class="code" href="structSECTORINFO.html#3c5312672399c40ec5a395e8bcfb0104">ubNumElites</a> += pGroup-&gt;<a class="code" href="structGROUP.html#2a98517c894019ee794e04ea05d1aeaf">ubGroupSize</a>;
<a name="l01945"></a>01945 <span class="preprocessor">                                          #ifdef JA2BETAVERSION</span>
<a name="l01946"></a>01946 <span class="preprocessor"></span>                                                <a class="code" href="Strategic_01AI_8cpp.html#984e97af1f29d3b417cc5bdcd126cfca">LogStrategicEvent</a>( <span class="stringliteral">"%d reinforcements have arrived to garrison queen's sector."</span>, 
<a name="l01947"></a>01947                                                       pGroup-&gt;<a class="code" href="structGROUP.html#2a98517c894019ee794e04ea05d1aeaf">ubGroupSize</a>, pGroup-&gt;<a class="code" href="structGROUP.html#11cd63715d9daf1488cca330690db007">ubSectorY</a> + <span class="charliteral">'A'</span> - 1, pGroup-&gt;<a class="code" href="structGROUP.html#eee29372e834112984eab1dc714466c0">ubSectorX</a> );
<a name="l01948"></a>01948 <span class="preprocessor">                                          #endif</span>
<a name="l01949"></a>01949 <span class="preprocessor"></span>                                    }
<a name="l01950"></a>01950                               }
<a name="l01951"></a>01951                               <span class="keywordflow">else</span>
<a name="l01952"></a>01952                               { <span class="comment">//Add all the troops to the reinforcement pool as the queen's guard is at full strength.</span>
<a name="l01953"></a>01953                                     <span class="comment">//Madd: unlimited reinforcements?, if so never increase/decrease it</span>
<a name="l01954"></a>01954                                     <span class="keywordflow">if</span> ( !<a class="code" href="Strategic_01AI_8cpp.html#b0c12688f38630da4e064c85394ca570">gfUnlimitedTroops</a> )
<a name="l01955"></a>01955                                           <a class="code" href="AI_01Viewer_8cpp.html#c86cd58021961af10f1eb15108a79023">giReinforcementPool</a> += pGroup-&gt;ubGroupSize;
<a name="l01956"></a>01956 <span class="preprocessor">                                    #ifdef JA2BETAVERSION</span>
<a name="l01957"></a>01957 <span class="preprocessor"></span>                                          <a class="code" href="Strategic_01AI_8cpp.html#984e97af1f29d3b417cc5bdcd126cfca">LogStrategicEvent</a>( <span class="stringliteral">"%d reinforcements have arrived at queen's sector and have been added to the reinforcement pool."</span>, 
<a name="l01958"></a>01958                                                 pGroup-&gt;ubGroupSize, pGroup-&gt;ubSectorY + <span class="charliteral">'A'</span> - 1, pGroup-&gt;ubSectorX );
<a name="l01959"></a>01959 <span class="preprocessor">                                    #endif</span>
<a name="l01960"></a>01960 <span class="preprocessor"></span>                              }
<a name="l01961"></a>01961                         }
<a name="l01962"></a>01962 
<a name="l01963"></a>01963                         <a class="code" href="Player_01Command_8cpp.html#f802e6f5d904e9fdff459d496e6f4e41">SetThisSectorAsEnemyControlled</a>( pGroup-&gt;ubSectorX, pGroup-&gt;ubSectorY, 0, TRUE );
<a name="l01964"></a>01964                         <a class="code" href="Strategic_01Movement_8cpp.html#4c74797932f53c0eeed849a864ba4522">RemovePGroup</a>( pGroup );
<a name="l01965"></a>01965                         <a class="code" href="Strategic_01AI_8cpp.html#c9af29ba59f70cabda683c1d3e7de1d0">RecalculateGarrisonWeight</a>( i );
<a name="l01966"></a>01966 
<a name="l01967"></a>01967                         <span class="keywordflow">return</span> TRUE;
<a name="l01968"></a>01968                   }
<a name="l01969"></a>01969             }
<a name="l01970"></a>01970             <span class="comment">//Step 2 -- Check for Patrol groups matching waypoint index.</span>
<a name="l01971"></a>01971             <span class="keywordflow">for</span>( i = 0; i &lt; <a class="code" href="Strategic_01AI_8cpp.html#8c839f77f7a78de6ff920d5943d834d7">giPatrolArraySize</a>; i++ )
<a name="l01972"></a>01972             {
<a name="l01973"></a>01973                   <span class="keywordflow">if</span>( <a class="code" href="Strategic_01AI_8cpp.html#9e00ccb0e77cec57208c519e8f831f53">gPatrolGroup</a>[ i ].ubSectorID[ 1 ] == SECTOR( pGroup-&gt;ubSectorX, pGroup-&gt;ubSectorY ) &amp;&amp;
<a name="l01974"></a>01974                               <a class="code" href="Strategic_01AI_8cpp.html#9e00ccb0e77cec57208c519e8f831f53">gPatrolGroup</a>[ i ].<a class="code" href="structPATROL__GROUP.html#85b82707f42868bcdd678a1d7ba9c257">ubPendingGroupID</a> == pGroup-&gt;ubGroupID )
<a name="l01975"></a>01975                   {
<a name="l01976"></a>01976                         <a class="code" href="Strategic_01AI_8cpp.html#9e00ccb0e77cec57208c519e8f831f53">gPatrolGroup</a>[ i ].<a class="code" href="structPATROL__GROUP.html#85b82707f42868bcdd678a1d7ba9c257">ubPendingGroupID</a> = 0;
<a name="l01977"></a>01977                         <span class="keywordflow">if</span>( <a class="code" href="Strategic_01AI_8cpp.html#9e00ccb0e77cec57208c519e8f831f53">gPatrolGroup</a>[ i ].<a class="code" href="structPATROL__GROUP.html#a94d3c610977f7a6fab94b302493d084">ubGroupID</a> &amp;&amp; <a class="code" href="Strategic_01AI_8cpp.html#9e00ccb0e77cec57208c519e8f831f53">gPatrolGroup</a>[ i ].<a class="code" href="structPATROL__GROUP.html#a94d3c610977f7a6fab94b302493d084">ubGroupID</a> != pGroup-&gt;ubGroupID )
<a name="l01978"></a>01978                         { <span class="comment">//cheat, and warp our reinforcements to them!</span>
<a name="l01979"></a>01979                               pPatrolGroup = <a class="code" href="Strategic_01Movement_8cpp.html#33138746a238bdc5c684e9aa2c86691c">GetGroup</a>( <a class="code" href="Strategic_01AI_8cpp.html#9e00ccb0e77cec57208c519e8f831f53">gPatrolGroup</a>[ i ].ubGroupID );
<a name="l01980"></a>01980                               pPatrolGroup-&gt;<a class="code" href="structGROUP.html#f82ff4c3e504e4bb10feb65491f79471">pEnemyGroup</a>-&gt;<a class="code" href="structENEMYGROUP.html#27eaaea857408bc6c6358054c19f2d07">ubNumTroops</a> += pGroup-&gt;pEnemyGroup-&gt;ubNumTroops;
<a name="l01981"></a>01981                               pPatrolGroup-&gt;pEnemyGroup-&gt;ubNumElites += pGroup-&gt;pEnemyGroup-&gt;ubNumElites;
<a name="l01982"></a>01982                               pPatrolGroup-&gt;pEnemyGroup-&gt;ubNumAdmins += pGroup-&gt;pEnemyGroup-&gt;ubNumAdmins;
<a name="l01983"></a>01983                               pPatrolGroup-&gt;ubGroupSize += (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)(pGroup-&gt;pEnemyGroup-&gt;ubNumTroops + pGroup-&gt;pEnemyGroup-&gt;ubNumElites + pGroup-&gt;pEnemyGroup-&gt;ubNumAdmins );
<a name="l01984"></a>01984                               #ifdef JA2BETAVERSION
<a name="l01985"></a>01985                                     <a class="code" href="Strategic_01AI_8cpp.html#984e97af1f29d3b417cc5bdcd126cfca">LogStrategicEvent</a>( <span class="stringliteral">"%d reinforcements have joined patrol group at sector %c%d (new size: %d)"</span>, 
<a name="l01986"></a>01986                                           pGroup-&gt;pEnemyGroup-&gt;ubNumTroops + pGroup-&gt;pEnemyGroup-&gt;ubNumElites + pGroup-&gt;pEnemyGroup-&gt;ubNumAdmins, 
<a name="l01987"></a>01987                                           pPatrolGroup-&gt;ubSectorY + <span class="charliteral">'A'</span> - 1, pPatrolGroup-&gt;ubSectorX, pPatrolGroup-&gt;ubGroupSize );
<a name="l01988"></a>01988                               #<a class="code" href="mapscreen_8cpp.html#3e279efabf854742684341c3e4f50d31f763cd940df26ca8a9043b3c89ad0bcb">endif</a>
<a name="l01989"></a>01989                               <span class="keywordflow">if</span>( pPatrolGroup-&gt;ubGroupSize &gt; iMaxEnemyGroupSize )
<a name="l01990"></a>01990                               {
<a name="l01991"></a>01991                                     <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubCut;
<a name="l01992"></a>01992                                     #ifdef JA2BETAVERSION
<a name="l01993"></a>01993                                     <a class="code" href="Types_8h.html#09f1a1fb2293e33483cc8d44aefb1eb1">UINT16</a> <a class="code" href="Button_01System_8cpp.html#ac22642f3052cc77a6991a262ce4ad23">str</a>[512];
<a name="l01994"></a>01994                                     swprintf( <a class="code" href="Button_01System_8cpp.html#ac22642f3052cc77a6991a262ce4ad23">str</a>, L<span class="stringliteral">"Patrol group #%d in %c%d received too many reinforcements from group #%d that was created in %c%d.  Size truncated from %d to %d."</span>
<a name="l01995"></a>01995                                                                                L<span class="stringliteral">"Please send Strategic Decisions.txt and PRIOR save."</span>, 
<a name="l01996"></a>01996                                                                                pPatrolGroup-&gt;ubGroupID, pPatrolGroup-&gt;ubSectorY + <span class="charliteral">'A'</span> - 1, pPatrolGroup-&gt;ubSectorX,
<a name="l01997"></a>01997                                                                                pGroup-&gt;ubGroupID, SECTORY( pGroup-&gt;ubCreatedSectorID ) + <span class="charliteral">'A'</span> - 1, SECTORX( pGroup-&gt;ubCreatedSectorID ),
<a name="l01998"></a>01998                                                                                pPatrolGroup-&gt;ubGroupSize, iMaxEnemyGroupSize );
<a name="l01999"></a>01999                                     <a class="code" href="Strategic_01AI_8cpp.html#8690badaeb456b31a18dda93bcc1d8df">SAIReportError</a>( str );
<a name="l02000"></a>02000 <span class="preprocessor">                                    #endif</span>
<a name="l02001"></a>02001 <span class="preprocessor"></span>                                    <span class="comment">//truncate the group size.</span>
<a name="l02002"></a>02002                                     ubCut = pPatrolGroup-&gt;ubGroupSize - iMaxEnemyGroupSize;
<a name="l02003"></a>02003                                     <span class="keywordflow">while</span>( ubCut-- )
<a name="l02004"></a>02004                                     {
<a name="l02005"></a>02005                                           <span class="keywordflow">if</span>( pGroup-&gt;pEnemyGroup-&gt;ubNumAdmins )
<a name="l02006"></a>02006                                           {
<a name="l02007"></a>02007                                                 pGroup-&gt;pEnemyGroup-&gt;ubNumAdmins--;
<a name="l02008"></a>02008                                                 pPatrolGroup-&gt;pEnemyGroup-&gt;ubNumAdmins--;
<a name="l02009"></a>02009                                           }
<a name="l02010"></a>02010                                           <span class="keywordflow">else</span> <span class="keywordflow">if</span>( pGroup-&gt;pEnemyGroup-&gt;ubNumTroops )
<a name="l02011"></a>02011                                           {
<a name="l02012"></a>02012                                                 pGroup-&gt;pEnemyGroup-&gt;ubNumTroops--;
<a name="l02013"></a>02013                                                 pPatrolGroup-&gt;pEnemyGroup-&gt;ubNumTroops--;
<a name="l02014"></a>02014                                           }
<a name="l02015"></a>02015                                           <span class="keywordflow">else</span> <span class="keywordflow">if</span>( pGroup-&gt;pEnemyGroup-&gt;ubNumElites )
<a name="l02016"></a>02016                                           {
<a name="l02017"></a>02017                                                 pGroup-&gt;pEnemyGroup-&gt;ubNumElites--;
<a name="l02018"></a>02018                                                 pPatrolGroup-&gt;pEnemyGroup-&gt;ubNumElites--;
<a name="l02019"></a>02019                                           }
<a name="l02020"></a>02020                                     }
<a name="l02021"></a>02021                                     pPatrolGroup-&gt;ubGroupSize = iMaxEnemyGroupSize;
<a name="l02022"></a>02022                                     Assert( pPatrolGroup-&gt;pEnemyGroup-&gt;ubNumAdmins + 
<a name="l02023"></a>02023                                                             pPatrolGroup-&gt;pEnemyGroup-&gt;ubNumTroops + 
<a name="l02024"></a>02024                                                             pPatrolGroup-&gt;pEnemyGroup-&gt;ubNumElites == iMaxEnemyGroupSize );
<a name="l02025"></a>02025                               }
<a name="l02026"></a>02026                               <a class="code" href="Strategic_01Movement_8cpp.html#4c74797932f53c0eeed849a864ba4522">RemovePGroup</a>( pGroup );
<a name="l02027"></a>02027                               <a class="code" href="Strategic_01AI_8cpp.html#d11803600200a4f8e0f5d842132fc140">RecalculatePatrolWeight</a>( i );
<a name="l02028"></a>02028                               <a class="code" href="Strategic_01AI_8cpp.html#cc36ad74d06a3b8b211a4e06c8528a43">ValidateLargeGroup</a>( pPatrolGroup );
<a name="l02029"></a>02029                         }
<a name="l02030"></a>02030                         <span class="keywordflow">else</span>
<a name="l02031"></a>02031                         { <span class="comment">//the reinforcements have become the new patrol group (even if same group)</span>
<a name="l02032"></a>02032                               <a class="code" href="Strategic_01AI_8cpp.html#9e00ccb0e77cec57208c519e8f831f53">gPatrolGroup</a>[ i ].<a class="code" href="structPATROL__GROUP.html#a94d3c610977f7a6fab94b302493d084">ubGroupID</a> = pGroup-&gt;ubGroupID;
<a name="l02033"></a>02033                               pGroup-&gt;pEnemyGroup-&gt;ubIntention = <a class="code" href="Strategic_01Movement_8h.html#b59c1bec446b10af208f977a871d910b132923eff5652e6e103b2734f1160e0a">PATROL</a>;
<a name="l02034"></a>02034                               pGroup-&gt;ubMoveType = <a class="code" href="Strategic_01Movement_8h.html#456ac33d49271d3e2c371351cd1d637164845912e4baf844d9a73da607ab3cea">ENDTOEND_FORWARDS</a>;
<a name="l02035"></a>02035                               <a class="code" href="Strategic_01Movement_8cpp.html#3e343ba8709f95c9b3b3ae3375df27a5">RemovePGroupWaypoints</a>( pGroup );
<a name="l02036"></a>02036                               <a class="code" href="Strategic_01Movement_8cpp.html#5247ab3cb65ed1b2fb9d44ac2f70ea41">AddWaypointIDToPGroup</a>( pGroup, <a class="code" href="Strategic_01AI_8cpp.html#9e00ccb0e77cec57208c519e8f831f53">gPatrolGroup</a>[ i ].ubSectorID[ 0 ] ); 
<a name="l02037"></a>02037                               <a class="code" href="Strategic_01Movement_8cpp.html#5247ab3cb65ed1b2fb9d44ac2f70ea41">AddWaypointIDToPGroup</a>( pGroup, <a class="code" href="Strategic_01AI_8cpp.html#9e00ccb0e77cec57208c519e8f831f53">gPatrolGroup</a>[ i ].ubSectorID[ 1 ] ); 
<a name="l02038"></a>02038                               <span class="keywordflow">if</span>( <a class="code" href="Strategic_01AI_8cpp.html#9e00ccb0e77cec57208c519e8f831f53">gPatrolGroup</a>[ i ].ubSectorID[ 2 ] )
<a name="l02039"></a>02039                               { <span class="comment">//Add optional waypoints if included.</span>
<a name="l02040"></a>02040                                     <a class="code" href="Strategic_01Movement_8cpp.html#5247ab3cb65ed1b2fb9d44ac2f70ea41">AddWaypointIDToPGroup</a>( pGroup, <a class="code" href="Strategic_01AI_8cpp.html#9e00ccb0e77cec57208c519e8f831f53">gPatrolGroup</a>[ i ].ubSectorID[ 2 ] ); 
<a name="l02041"></a>02041                                     <span class="keywordflow">if</span>( <a class="code" href="Strategic_01AI_8cpp.html#9e00ccb0e77cec57208c519e8f831f53">gPatrolGroup</a>[ i ].ubSectorID[ 3 ] )
<a name="l02042"></a>02042                                           <a class="code" href="Strategic_01Movement_8cpp.html#5247ab3cb65ed1b2fb9d44ac2f70ea41">AddWaypointIDToPGroup</a>( pGroup, <a class="code" href="Strategic_01AI_8cpp.html#9e00ccb0e77cec57208c519e8f831f53">gPatrolGroup</a>[ i ].ubSectorID[ 3 ] ); 
<a name="l02043"></a>02043                               }
<a name="l02044"></a>02044                               
<a name="l02045"></a>02045                               <span class="comment">//Otherwise, the engine assumes they are being deployed.</span>
<a name="l02046"></a>02046                               <span class="comment">//pGroup-&gt;fWaypointsCancelled = FALSE;</span>
<a name="l02047"></a>02047 
<a name="l02048"></a>02048 <span class="preprocessor">                              #ifdef JA2BETAVERSION</span>
<a name="l02049"></a>02049 <span class="preprocessor"></span>                                    <a class="code" href="Strategic_01AI_8cpp.html#984e97af1f29d3b417cc5bdcd126cfca">LogStrategicEvent</a>( <span class="stringliteral">"%d soldiers have arrived to patrol area near sector %c%d"</span>, 
<a name="l02050"></a>02050                                           pGroup-&gt;pEnemyGroup-&gt;ubNumTroops + pGroup-&gt;pEnemyGroup-&gt;ubNumElites + pGroup-&gt;pEnemyGroup-&gt;ubNumAdmins, 
<a name="l02051"></a>02051                                           pGroup-&gt;ubSectorY + <span class="charliteral">'A'</span> - 1, pGroup-&gt;ubSectorX );
<a name="l02052"></a>02052 <span class="preprocessor">                              #endif</span>
<a name="l02053"></a>02053 <span class="preprocessor"></span>                              <a class="code" href="Strategic_01AI_8cpp.html#d11803600200a4f8e0f5d842132fc140">RecalculatePatrolWeight</a>( i );
<a name="l02054"></a>02054                         }
<a name="l02055"></a>02055                         <span class="keywordflow">return</span> TRUE;
<a name="l02056"></a>02056                   }
<a name="l02057"></a>02057             }
<a name="l02058"></a>02058       }
<a name="l02059"></a>02059       <span class="keywordflow">else</span>
<a name="l02060"></a>02060       {     <span class="comment">//This is a floating group at his final destination...</span>
<a name="l02061"></a>02061             <span class="keywordflow">if</span>( pGroup-&gt;pEnemyGroup-&gt;ubIntention != <a class="code" href="Strategic_01Movement_8h.html#b59c1bec446b10af208f977a871d910bcbb2b107ee4dddeb7f82aa7b3058cf04">STAGING</a> &amp;&amp; pGroup-&gt;pEnemyGroup-&gt;ubIntention != <a class="code" href="Strategic_01Movement_8h.html#b59c1bec446b10af208f977a871d910b095b1f433b659c686164f67bb7b89cb1">REINFORCEMENTS</a> )
<a name="l02062"></a>02062             {
<a name="l02063"></a>02063                   <a class="code" href="Strategic_01AI_8cpp.html#0ecd8a8d61c81aa34eeec15760348ffe">ReassignAIGroup</a>( &amp;pGroup );
<a name="l02064"></a>02064                   <span class="keywordflow">return</span> TRUE;
<a name="l02065"></a>02065             }
<a name="l02066"></a>02066       }
<a name="l02067"></a>02067       <a class="code" href="Strategic_01AI_8cpp.html#75d774eb03c41b5fe422edfef6e445d4">ValidateWeights</a>( 3 );
<a name="l02068"></a>02068       <span class="keywordflow">return</span> FALSE;
<a name="l02069"></a>02069 }
<a name="l02070"></a>02070 
<a name="l02071"></a>02071 <span class="comment">//returns TRUE if the group was deleted.</span>
<a name="l02072"></a><a class="code" href="Strategic_01AI_8h.html#fd05b745164fcf6a420beb6fcfa56a9a">02072</a> <a class="code" href="Types_8h.html#112e3146cb38b6ee95e64d85842e380a">BOOLEAN</a> <a class="code" href="Strategic_01AI_8cpp.html#fd05b745164fcf6a420beb6fcfa56a9a">StrategicAILookForAdjacentGroups</a>( <a class="code" href="structGROUP.html">GROUP</a> *pGroup )
<a name="l02073"></a>02073 {
<a name="l02074"></a>02074       <a class="code" href="structSECTORINFO.html">SECTORINFO</a> *pSector;
<a name="l02075"></a>02075       <a class="code" href="structGROUP.html">GROUP</a> *pEnemyGroup, *pPlayerGroup;
<a name="l02076"></a>02076       <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubNumEnemies;
<a name="l02077"></a>02077       <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubSectorID;
<a name="l02078"></a>02078       <span class="keywordflow">if</span>( !<a class="code" href="AI_01Viewer_8cpp.html#38284bd39764812fb8a27fe4d3d2b0cd">gfQueenAIAwake</a> )
<a name="l02079"></a>02079       { <span class="comment">//The queen isn't aware the player's presence yet, so she is oblivious to any situations.</span>
<a name="l02080"></a>02080 
<a name="l02081"></a>02081             <span class="keywordflow">if</span>( !pGroup-&gt;<a class="code" href="structGROUP.html#1420d1afb0a1876a85b6b93308fbaf68">fPlayer</a> )
<a name="l02082"></a>02082             {
<a name="l02083"></a>02083                   <span class="comment">//Exception case!</span>
<a name="l02084"></a>02084                   <span class="comment">//In the beginning of the game, a group is sent to A9 after the first battle.  If you leave A9, when they arrive,</span>
<a name="l02085"></a>02085                   <span class="comment">//they will stay there indefinately because the AI isn't awake.  What we do, is if this is a group in A9, then</span>
<a name="l02086"></a>02086                   <span class="comment">//send them home.</span>
<a name="l02087"></a>02087                   <span class="keywordflow">if</span>( <a class="code" href="Strategic_01Movement_8cpp.html#5bffbc0549f4fb0c8829436f9ee6e907">GroupAtFinalDestination</a>( pGroup ) )
<a name="l02088"></a>02088                   {
<a name="l02089"></a>02089                         <span class="comment">//Wake up the queen now, if she hasn't woken up already.</span>
<a name="l02090"></a>02090                         <a class="code" href="Strategic_01AI_8cpp.html#079d19a6a3eb516e60dc98132a6cc5f8">WakeUpQueen</a>();
<a name="l02091"></a>02091                         <span class="keywordflow">if</span>( pGroup-&gt;<a class="code" href="structGROUP.html#eee29372e834112984eab1dc714466c0">ubSectorX</a> == 9 &amp;&amp; pGroup-&gt;<a class="code" href="structGROUP.html#11cd63715d9daf1488cca330690db007">ubSectorY</a> == 1 || 
<a name="l02092"></a>02092                                     pGroup-&gt;<a class="code" href="structGROUP.html#eee29372e834112984eab1dc714466c0">ubSectorX</a> == 3 &amp;&amp; pGroup-&gt;<a class="code" href="structGROUP.html#11cd63715d9daf1488cca330690db007">ubSectorY</a> == 16 )
<a name="l02093"></a>02093                         {
<a name="l02094"></a>02094                               <a class="code" href="Strategic_01AI_8cpp.html#3af587307171a6bbdd4a76889ae15a3a">SendGroupToPool</a>( &amp;pGroup );
<a name="l02095"></a>02095                               <span class="keywordflow">if</span>( !pGroup )
<a name="l02096"></a>02096                               { <span class="comment">//Group was transferred to the pool</span>
<a name="l02097"></a>02097                                     <span class="keywordflow">return</span> TRUE;
<a name="l02098"></a>02098                               }
<a name="l02099"></a>02099                         }
<a name="l02100"></a>02100                   }
<a name="l02101"></a>02101             }
<a name="l02102"></a>02102                         
<a name="l02103"></a>02103             <span class="keywordflow">if</span>( !<a class="code" href="AI_01Viewer_8cpp.html#38284bd39764812fb8a27fe4d3d2b0cd">gfQueenAIAwake</a> )
<a name="l02104"></a>02104             {
<a name="l02105"></a>02105                   <span class="keywordflow">return</span> FALSE;
<a name="l02106"></a>02106             }
<a name="l02107"></a>02107       }
<a name="l02108"></a>02108       <span class="keywordflow">if</span>( !pGroup-&gt;<a class="code" href="structGROUP.html#1420d1afb0a1876a85b6b93308fbaf68">fPlayer</a> )
<a name="l02109"></a>02109       {     <span class="comment">//The enemy group has arrived at a new sector and now controls it.  </span>
<a name="l02110"></a>02110             <span class="comment">//Look in each of the four directions, and the alertness rating will</span>
<a name="l02111"></a>02111             <span class="comment">//determine the chance to detect any players that may exist in that sector.</span>
<a name="l02112"></a>02112             pEnemyGroup = pGroup;
<a name="l02113"></a>02113             <span class="keywordflow">if</span>( <a class="code" href="Strategic_01Movement_8cpp.html#5bffbc0549f4fb0c8829436f9ee6e907">GroupAtFinalDestination</a>( pEnemyGroup ) )
<a name="l02114"></a>02114             {
<a name="l02115"></a>02115                   <span class="keywordflow">return</span> <a class="code" href="Strategic_01AI_8cpp.html#42d5667c02da82d67a9a81191ca32064">EvaluateGroupSituation</a>( pEnemyGroup );
<a name="l02116"></a>02116             }
<a name="l02117"></a>02117             ubSectorID = (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)SECTOR( pEnemyGroup-&gt;<a class="code" href="structGROUP.html#eee29372e834112984eab1dc714466c0">ubSectorX</a>, pEnemyGroup-&gt;<a class="code" href="structGROUP.html#11cd63715d9daf1488cca330690db007">ubSectorY</a> );
<a name="l02118"></a>02118             <span class="keywordflow">if</span>( pEnemyGroup &amp;&amp; pEnemyGroup-&gt;<a class="code" href="structGROUP.html#11cd63715d9daf1488cca330690db007">ubSectorY</a> &gt; 1 &amp;&amp; <a class="code" href="Strategic_01AI_8cpp.html#f8f6673c3fc186e8d92341498a455679">EnemyPermittedToAttackSector</a>( &amp;pEnemyGroup, (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)(ubSectorID - 16) ) )
<a name="l02119"></a>02119             {
<a name="l02120"></a>02120                   pPlayerGroup = <a class="code" href="Strategic_01Movement_8cpp.html#8fbed89c2ec9babd0f0fc9dcfc366f29">FindMovementGroupInSector</a>( pEnemyGroup-&gt;<a class="code" href="structGROUP.html#eee29372e834112984eab1dc714466c0">ubSectorX</a>, (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)(pEnemyGroup-&gt;<a class="code" href="structGROUP.html#11cd63715d9daf1488cca330690db007">ubSectorY</a>-1), TRUE );
<a name="l02121"></a>02121                   <span class="keywordflow">if</span>( pPlayerGroup &amp;&amp; <a class="code" href="Strategic_01AI_8cpp.html#cfe2abd9df33e8d3ae8f0bf9a6f82c93">AttemptToNoticeAdjacentGroupSucceeds</a>() )
<a name="l02122"></a>02122                   {
<a name="l02123"></a>02123                         <span class="keywordflow">return</span> <a class="code" href="Strategic_01AI_8cpp.html#af84c5cbdf76a83cd0eda1a9e6e65e05">HandlePlayerGroupNoticedByPatrolGroup</a>( pPlayerGroup, pEnemyGroup );
<a name="l02124"></a>02124                   }
<a name="l02125"></a>02125                   <span class="keywordflow">else</span> <span class="keywordflow">if</span>( <a class="code" href="Town_01Militia_8cpp.html#d5f4d1a7e2d1489b786239270acbdda1">CountAllMilitiaInSector</a>( pEnemyGroup-&gt;<a class="code" href="structGROUP.html#eee29372e834112984eab1dc714466c0">ubSectorX</a>, (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)(pEnemyGroup-&gt;<a class="code" href="structGROUP.html#11cd63715d9daf1488cca330690db007">ubSectorY</a>-1) ) &amp;&amp; 
<a name="l02126"></a>02126                                           <a class="code" href="Strategic_01AI_8cpp.html#cfe2abd9df33e8d3ae8f0bf9a6f82c93">AttemptToNoticeAdjacentGroupSucceeds</a>() )
<a name="l02127"></a>02127                   {
<a name="l02128"></a>02128                         <span class="keywordflow">return</span> <a class="code" href="Strategic_01AI_8cpp.html#5851146c1a45469119bacdfda4fd1bf1">HandleMilitiaNoticedByPatrolGroup</a>( (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)SECTOR( pEnemyGroup-&gt;<a class="code" href="structGROUP.html#eee29372e834112984eab1dc714466c0">ubSectorX</a>, pEnemyGroup-&gt;<a class="code" href="structGROUP.html#11cd63715d9daf1488cca330690db007">ubSectorY</a>-1 ), pEnemyGroup );
<a name="l02129"></a>02129                   }
<a name="l02130"></a>02130                   <span class="keywordflow">else</span> <span class="keywordflow">if</span>( <a class="code" href="Strategic_01AI_8cpp.html#73501d5da96c2872b48fa331b1585ff2">AdjacentSectorIsImportantAndUndefended</a>( (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)(ubSectorID-16) ) &amp;&amp; <a class="code" href="Strategic_01AI_8cpp.html#f56d1e63c211df4c0082157c73603a78">AttemptToNoticeEmptySectorSucceeds</a>() )
<a name="l02131"></a>02131                   {
<a name="l02132"></a>02132                         <span class="keywordflow">return</span> <a class="code" href="Strategic_01AI_8cpp.html#b9410f4eb7a3b3f3274ecb37bdd3bdd1">HandleEmptySectorNoticedByPatrolGroup</a>( pEnemyGroup, (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)(ubSectorID-16) );
<a name="l02133"></a>02133                   }
<a name="l02134"></a>02134             }
<a name="l02135"></a>02135             <span class="keywordflow">if</span>( pEnemyGroup &amp;&amp; pEnemyGroup-&gt;<a class="code" href="structGROUP.html#eee29372e834112984eab1dc714466c0">ubSectorX</a> &gt; 1 &amp;&amp; <a class="code" href="Strategic_01AI_8cpp.html#f8f6673c3fc186e8d92341498a455679">EnemyPermittedToAttackSector</a>( &amp;pEnemyGroup, (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)(ubSectorID - 1) ) )
<a name="l02136"></a>02136             {
<a name="l02137"></a>02137                   pPlayerGroup = <a class="code" href="Strategic_01Movement_8cpp.html#8fbed89c2ec9babd0f0fc9dcfc366f29">FindMovementGroupInSector</a>( (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)(pEnemyGroup-&gt;<a class="code" href="structGROUP.html#eee29372e834112984eab1dc714466c0">ubSectorX</a>-1), pEnemyGroup-&gt;<a class="code" href="structGROUP.html#11cd63715d9daf1488cca330690db007">ubSectorY</a>, TRUE );
<a name="l02138"></a>02138                   <span class="keywordflow">if</span>( pPlayerGroup &amp;&amp; <a class="code" href="Strategic_01AI_8cpp.html#cfe2abd9df33e8d3ae8f0bf9a6f82c93">AttemptToNoticeAdjacentGroupSucceeds</a>() )
<a name="l02139"></a>02139                   {
<a name="l02140"></a>02140                         <span class="keywordflow">return</span> <a class="code" href="Strategic_01AI_8cpp.html#af84c5cbdf76a83cd0eda1a9e6e65e05">HandlePlayerGroupNoticedByPatrolGroup</a>( pPlayerGroup, pEnemyGroup );
<a name="l02141"></a>02141                   }
<a name="l02142"></a>02142                   <span class="keywordflow">else</span> <span class="keywordflow">if</span>( <a class="code" href="Town_01Militia_8cpp.html#d5f4d1a7e2d1489b786239270acbdda1">CountAllMilitiaInSector</a>( (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)(pEnemyGroup-&gt;<a class="code" href="structGROUP.html#eee29372e834112984eab1dc714466c0">ubSectorX</a>-1), pEnemyGroup-&gt;<a class="code" href="structGROUP.html#11cd63715d9daf1488cca330690db007">ubSectorY</a> ) &amp;&amp; 
<a name="l02143"></a>02143                                           <a class="code" href="Strategic_01AI_8cpp.html#cfe2abd9df33e8d3ae8f0bf9a6f82c93">AttemptToNoticeAdjacentGroupSucceeds</a>() )
<a name="l02144"></a>02144                   {
<a name="l02145"></a>02145                         <span class="keywordflow">return</span> <a class="code" href="Strategic_01AI_8cpp.html#5851146c1a45469119bacdfda4fd1bf1">HandleMilitiaNoticedByPatrolGroup</a>( (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)SECTOR( pEnemyGroup-&gt;<a class="code" href="structGROUP.html#eee29372e834112984eab1dc714466c0">ubSectorX</a>-1, pEnemyGroup-&gt;<a class="code" href="structGROUP.html#11cd63715d9daf1488cca330690db007">ubSectorY</a> ), pEnemyGroup );
<a name="l02146"></a>02146                   }
<a name="l02147"></a>02147                   <span class="keywordflow">else</span> <span class="keywordflow">if</span>( <a class="code" href="Strategic_01AI_8cpp.html#73501d5da96c2872b48fa331b1585ff2">AdjacentSectorIsImportantAndUndefended</a>( (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)(ubSectorID-1) ) &amp;&amp; <a class="code" href="Strategic_01AI_8cpp.html#f56d1e63c211df4c0082157c73603a78">AttemptToNoticeEmptySectorSucceeds</a>() )
<a name="l02148"></a>02148                   {
<a name="l02149"></a>02149                         <span class="keywordflow">return</span> <a class="code" href="Strategic_01AI_8cpp.html#b9410f4eb7a3b3f3274ecb37bdd3bdd1">HandleEmptySectorNoticedByPatrolGroup</a>( pEnemyGroup, (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)(ubSectorID-1) );
<a name="l02150"></a>02150                   }
<a name="l02151"></a>02151             }
<a name="l02152"></a>02152             <span class="keywordflow">if</span>( pEnemyGroup &amp;&amp; pEnemyGroup-&gt;<a class="code" href="structGROUP.html#11cd63715d9daf1488cca330690db007">ubSectorY</a> &lt; 16 &amp;&amp; <a class="code" href="Strategic_01AI_8cpp.html#f8f6673c3fc186e8d92341498a455679">EnemyPermittedToAttackSector</a>( &amp;pEnemyGroup, (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)(ubSectorID + 16) ) )
<a name="l02153"></a>02153             {
<a name="l02154"></a>02154                   pPlayerGroup = <a class="code" href="Strategic_01Movement_8cpp.html#8fbed89c2ec9babd0f0fc9dcfc366f29">FindMovementGroupInSector</a>( pEnemyGroup-&gt;<a class="code" href="structGROUP.html#eee29372e834112984eab1dc714466c0">ubSectorX</a>, (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)(pEnemyGroup-&gt;<a class="code" href="structGROUP.html#11cd63715d9daf1488cca330690db007">ubSectorY</a>+1), TRUE );
<a name="l02155"></a>02155                   <span class="keywordflow">if</span>( pPlayerGroup &amp;&amp; <a class="code" href="Strategic_01AI_8cpp.html#cfe2abd9df33e8d3ae8f0bf9a6f82c93">AttemptToNoticeAdjacentGroupSucceeds</a>() )
<a name="l02156"></a>02156                   {
<a name="l02157"></a>02157                         <span class="keywordflow">return</span> <a class="code" href="Strategic_01AI_8cpp.html#af84c5cbdf76a83cd0eda1a9e6e65e05">HandlePlayerGroupNoticedByPatrolGroup</a>( pPlayerGroup, pEnemyGroup );
<a name="l02158"></a>02158                   }
<a name="l02159"></a>02159                   <span class="keywordflow">else</span> <span class="keywordflow">if</span>( <a class="code" href="Town_01Militia_8cpp.html#d5f4d1a7e2d1489b786239270acbdda1">CountAllMilitiaInSector</a>( pEnemyGroup-&gt;<a class="code" href="structGROUP.html#eee29372e834112984eab1dc714466c0">ubSectorX</a>, (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)(pEnemyGroup-&gt;<a class="code" href="structGROUP.html#11cd63715d9daf1488cca330690db007">ubSectorY</a>+1) ) &amp;&amp; 
<a name="l02160"></a>02160                                           <a class="code" href="Strategic_01AI_8cpp.html#cfe2abd9df33e8d3ae8f0bf9a6f82c93">AttemptToNoticeAdjacentGroupSucceeds</a>() )
<a name="l02161"></a>02161                   {
<a name="l02162"></a>02162                         <span class="keywordflow">return</span> <a class="code" href="Strategic_01AI_8cpp.html#5851146c1a45469119bacdfda4fd1bf1">HandleMilitiaNoticedByPatrolGroup</a>( (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)SECTOR( pEnemyGroup-&gt;<a class="code" href="structGROUP.html#eee29372e834112984eab1dc714466c0">ubSectorX</a>, pEnemyGroup-&gt;<a class="code" href="structGROUP.html#11cd63715d9daf1488cca330690db007">ubSectorY</a>+1 ), pEnemyGroup );
<a name="l02163"></a>02163                   }
<a name="l02164"></a>02164                   <span class="keywordflow">else</span> <span class="keywordflow">if</span>( <a class="code" href="Strategic_01AI_8cpp.html#73501d5da96c2872b48fa331b1585ff2">AdjacentSectorIsImportantAndUndefended</a>( (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)(ubSectorID+16) ) &amp;&amp; <a class="code" href="Strategic_01AI_8cpp.html#f56d1e63c211df4c0082157c73603a78">AttemptToNoticeEmptySectorSucceeds</a>() )
<a name="l02165"></a>02165                   {
<a name="l02166"></a>02166                         <span class="keywordflow">return</span> <a class="code" href="Strategic_01AI_8cpp.html#b9410f4eb7a3b3f3274ecb37bdd3bdd1">HandleEmptySectorNoticedByPatrolGroup</a>( pEnemyGroup, (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)(ubSectorID+16) );
<a name="l02167"></a>02167                   }
<a name="l02168"></a>02168             }
<a name="l02169"></a>02169             <span class="keywordflow">if</span>( pEnemyGroup &amp;&amp; pEnemyGroup-&gt;<a class="code" href="structGROUP.html#eee29372e834112984eab1dc714466c0">ubSectorX</a> &lt; 16 &amp;&amp; <a class="code" href="Strategic_01AI_8cpp.html#f8f6673c3fc186e8d92341498a455679">EnemyPermittedToAttackSector</a>( &amp;pEnemyGroup, (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)(ubSectorID + 1) ) )
<a name="l02170"></a>02170             {
<a name="l02171"></a>02171                   pPlayerGroup = <a class="code" href="Strategic_01Movement_8cpp.html#8fbed89c2ec9babd0f0fc9dcfc366f29">FindMovementGroupInSector</a>( (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)(pEnemyGroup-&gt;<a class="code" href="structGROUP.html#eee29372e834112984eab1dc714466c0">ubSectorX</a>+1), pEnemyGroup-&gt;<a class="code" href="structGROUP.html#11cd63715d9daf1488cca330690db007">ubSectorY</a>, TRUE );
<a name="l02172"></a>02172                   <span class="keywordflow">if</span>( pPlayerGroup &amp;&amp; <a class="code" href="Strategic_01AI_8cpp.html#cfe2abd9df33e8d3ae8f0bf9a6f82c93">AttemptToNoticeAdjacentGroupSucceeds</a>() )
<a name="l02173"></a>02173                   {
<a name="l02174"></a>02174                         <span class="keywordflow">return</span> <a class="code" href="Strategic_01AI_8cpp.html#af84c5cbdf76a83cd0eda1a9e6e65e05">HandlePlayerGroupNoticedByPatrolGroup</a>( pPlayerGroup, pEnemyGroup );
<a name="l02175"></a>02175                   }
<a name="l02176"></a>02176                   <span class="keywordflow">else</span> <span class="keywordflow">if</span>( <a class="code" href="Town_01Militia_8cpp.html#d5f4d1a7e2d1489b786239270acbdda1">CountAllMilitiaInSector</a>( (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)(pEnemyGroup-&gt;<a class="code" href="structGROUP.html#eee29372e834112984eab1dc714466c0">ubSectorX</a>+1), pEnemyGroup-&gt;<a class="code" href="structGROUP.html#11cd63715d9daf1488cca330690db007">ubSectorY</a> ) &amp;&amp; 
<a name="l02177"></a>02177                                           <a class="code" href="Strategic_01AI_8cpp.html#cfe2abd9df33e8d3ae8f0bf9a6f82c93">AttemptToNoticeAdjacentGroupSucceeds</a>() )
<a name="l02178"></a>02178                   {
<a name="l02179"></a>02179                         <span class="keywordflow">return</span> <a class="code" href="Strategic_01AI_8cpp.html#5851146c1a45469119bacdfda4fd1bf1">HandleMilitiaNoticedByPatrolGroup</a>( (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)SECTOR( pEnemyGroup-&gt;<a class="code" href="structGROUP.html#eee29372e834112984eab1dc714466c0">ubSectorX</a>+1, pEnemyGroup-&gt;<a class="code" href="structGROUP.html#11cd63715d9daf1488cca330690db007">ubSectorY</a> ), pEnemyGroup );
<a name="l02180"></a>02180                   }
<a name="l02181"></a>02181                   <span class="keywordflow">else</span> <span class="keywordflow">if</span>( <a class="code" href="Strategic_01AI_8cpp.html#73501d5da96c2872b48fa331b1585ff2">AdjacentSectorIsImportantAndUndefended</a>( (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)(ubSectorID+1) ) &amp;&amp; <a class="code" href="Strategic_01AI_8cpp.html#f56d1e63c211df4c0082157c73603a78">AttemptToNoticeEmptySectorSucceeds</a>() )
<a name="l02182"></a>02182                   {
<a name="l02183"></a>02183                         <span class="keywordflow">return</span> <a class="code" href="Strategic_01AI_8cpp.html#b9410f4eb7a3b3f3274ecb37bdd3bdd1">HandleEmptySectorNoticedByPatrolGroup</a>( pEnemyGroup, (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)(ubSectorID+1) );
<a name="l02184"></a>02184                   }
<a name="l02185"></a>02185             }
<a name="l02186"></a>02186             <span class="keywordflow">if</span>( !pEnemyGroup )
<a name="l02187"></a>02187             { <span class="comment">//group deleted.</span>
<a name="l02188"></a>02188                   <span class="keywordflow">return</span> TRUE;
<a name="l02189"></a>02189             }
<a name="l02190"></a>02190       }
<a name="l02191"></a>02191       <span class="keywordflow">else</span> 
<a name="l02192"></a>02192       { <span class="comment">//The player group has arrived at a new sector and now controls it.  </span>
<a name="l02193"></a>02193             <span class="comment">//Look in each of the four directions, and the enemy alertness rating will</span>
<a name="l02194"></a>02194             <span class="comment">//determine if the enemy notices that the player is here.</span>
<a name="l02195"></a>02195             <span class="comment">//Additionally, there are also stationary enemy groups that may also notice the</span>
<a name="l02196"></a>02196             <span class="comment">//player's new presence.</span>
<a name="l02197"></a>02197             <span class="comment">//NOTE:  Always returns false because it is the player group that we are handling.  We</span>
<a name="l02198"></a>02198             <span class="comment">//       don't mess with the player group here!</span>
<a name="l02199"></a>02199             pPlayerGroup = pGroup;
<a name="l02200"></a>02200             <span class="keywordflow">if</span>( pPlayerGroup-&gt;<a class="code" href="structGROUP.html#39ccaa3ccd1f083150ac132fbcb1ce1f">ubSectorZ</a> )
<a name="l02201"></a>02201                   <span class="keywordflow">return</span> FALSE;
<a name="l02202"></a>02202             <span class="keywordflow">if</span>( !<a class="code" href="Strategic_01AI_8cpp.html#f8f6673c3fc186e8d92341498a455679">EnemyPermittedToAttackSector</a>( NULL, (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)SECTOR( pPlayerGroup-&gt;<a class="code" href="structGROUP.html#eee29372e834112984eab1dc714466c0">ubSectorX</a>, pPlayerGroup-&gt;<a class="code" href="structGROUP.html#11cd63715d9daf1488cca330690db007">ubSectorY</a> ) ) )
<a name="l02203"></a>02203                   <span class="keywordflow">return</span> FALSE;
<a name="l02204"></a>02204             <span class="keywordflow">if</span>( pPlayerGroup-&gt;<a class="code" href="structGROUP.html#11cd63715d9daf1488cca330690db007">ubSectorY</a> &gt; 1 )
<a name="l02205"></a>02205             {
<a name="l02206"></a>02206                   pEnemyGroup = <a class="code" href="Strategic_01Movement_8cpp.html#8fbed89c2ec9babd0f0fc9dcfc366f29">FindMovementGroupInSector</a>( pPlayerGroup-&gt;<a class="code" href="structGROUP.html#eee29372e834112984eab1dc714466c0">ubSectorX</a>, (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)(pPlayerGroup-&gt;<a class="code" href="structGROUP.html#11cd63715d9daf1488cca330690db007">ubSectorY</a>-1), FALSE );
<a name="l02207"></a>02207                   <span class="keywordflow">if</span>( pEnemyGroup &amp;&amp; <a class="code" href="Strategic_01AI_8cpp.html#cfe2abd9df33e8d3ae8f0bf9a6f82c93">AttemptToNoticeAdjacentGroupSucceeds</a>() )
<a name="l02208"></a>02208                   {
<a name="l02209"></a>02209                         <a class="code" href="Strategic_01AI_8cpp.html#af84c5cbdf76a83cd0eda1a9e6e65e05">HandlePlayerGroupNoticedByPatrolGroup</a>( pPlayerGroup, pEnemyGroup );
<a name="l02210"></a>02210                         <span class="keywordflow">return</span> FALSE;
<a name="l02211"></a>02211                   }
<a name="l02212"></a>02212                   pSector = &amp;<a class="code" href="Campaign_01Types_8h.html#d83c6f699f17a47cf6a662c91d959126">SectorInfo</a>[ SECTOR( pPlayerGroup-&gt;<a class="code" href="structGROUP.html#eee29372e834112984eab1dc714466c0">ubSectorX</a>, pPlayerGroup-&gt;<a class="code" href="structGROUP.html#11cd63715d9daf1488cca330690db007">ubSectorY</a>-1 ) ];
<a name="l02213"></a>02213                   ubNumEnemies = pSector-&gt;<a class="code" href="structSECTORINFO.html#d7d5ee63c0dc2ad3164c83541bd80906">ubNumAdmins</a> + pSector-&gt;<a class="code" href="structSECTORINFO.html#e36540b93256cfa71e45382f133d3696">ubNumTroops</a> + pSector-&gt;<a class="code" href="structSECTORINFO.html#3c5312672399c40ec5a395e8bcfb0104">ubNumElites</a>;
<a name="l02214"></a>02214                   <span class="keywordflow">if</span>( ubNumEnemies &amp;&amp; pSector-&gt;<a class="code" href="structSECTORINFO.html#9465931dad0e164d7d47814b66e454f0">ubGarrisonID</a> != NO_GARRISON &amp;&amp; <a class="code" href="Strategic_01AI_8cpp.html#cfe2abd9df33e8d3ae8f0bf9a6f82c93">AttemptToNoticeAdjacentGroupSucceeds</a>() )
<a name="l02215"></a>02215                   {
<a name="l02216"></a>02216                         <a class="code" href="Strategic_01AI_8cpp.html#37d5de1723e5e64fd91aef9ec3018f14">HandlePlayerGroupNoticedByGarrison</a>( pPlayerGroup, (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)SECTOR( pPlayerGroup-&gt;<a class="code" href="structGROUP.html#eee29372e834112984eab1dc714466c0">ubSectorX</a>, pPlayerGroup-&gt;<a class="code" href="structGROUP.html#11cd63715d9daf1488cca330690db007">ubSectorY</a>-1 ) );
<a name="l02217"></a>02217                         <span class="keywordflow">return</span> FALSE;
<a name="l02218"></a>02218                   }
<a name="l02219"></a>02219             }
<a name="l02220"></a>02220             <span class="keywordflow">if</span>( pPlayerGroup-&gt;<a class="code" href="structGROUP.html#eee29372e834112984eab1dc714466c0">ubSectorX</a> &lt; 16 )
<a name="l02221"></a>02221             {
<a name="l02222"></a>02222                   pEnemyGroup = <a class="code" href="Strategic_01Movement_8cpp.html#8fbed89c2ec9babd0f0fc9dcfc366f29">FindMovementGroupInSector</a>( (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)(pPlayerGroup-&gt;<a class="code" href="structGROUP.html#eee29372e834112984eab1dc714466c0">ubSectorX</a>+1), pPlayerGroup-&gt;<a class="code" href="structGROUP.html#11cd63715d9daf1488cca330690db007">ubSectorY</a>, FALSE );
<a name="l02223"></a>02223                   <span class="keywordflow">if</span>( pEnemyGroup &amp;&amp; <a class="code" href="Strategic_01AI_8cpp.html#cfe2abd9df33e8d3ae8f0bf9a6f82c93">AttemptToNoticeAdjacentGroupSucceeds</a>() )
<a name="l02224"></a>02224                   {
<a name="l02225"></a>02225                         <a class="code" href="Strategic_01AI_8cpp.html#af84c5cbdf76a83cd0eda1a9e6e65e05">HandlePlayerGroupNoticedByPatrolGroup</a>( pPlayerGroup, pEnemyGroup );
<a name="l02226"></a>02226                         <span class="keywordflow">return</span> FALSE;
<a name="l02227"></a>02227                   }
<a name="l02228"></a>02228                   pSector = &amp;<a class="code" href="Campaign_01Types_8h.html#d83c6f699f17a47cf6a662c91d959126">SectorInfo</a>[ SECTOR( pPlayerGroup-&gt;<a class="code" href="structGROUP.html#eee29372e834112984eab1dc714466c0">ubSectorX</a>-1, pPlayerGroup-&gt;<a class="code" href="structGROUP.html#11cd63715d9daf1488cca330690db007">ubSectorY</a> ) ];
<a name="l02229"></a>02229                   ubNumEnemies = pSector-&gt;<a class="code" href="structSECTORINFO.html#d7d5ee63c0dc2ad3164c83541bd80906">ubNumAdmins</a> + pSector-&gt;<a class="code" href="structSECTORINFO.html#e36540b93256cfa71e45382f133d3696">ubNumTroops</a> + pSector-&gt;<a class="code" href="structSECTORINFO.html#3c5312672399c40ec5a395e8bcfb0104">ubNumElites</a>;
<a name="l02230"></a>02230                   <span class="keywordflow">if</span>( ubNumEnemies &amp;&amp; pSector-&gt;<a class="code" href="structSECTORINFO.html#9465931dad0e164d7d47814b66e454f0">ubGarrisonID</a> != NO_GARRISON &amp;&amp; <a class="code" href="Strategic_01AI_8cpp.html#cfe2abd9df33e8d3ae8f0bf9a6f82c93">AttemptToNoticeAdjacentGroupSucceeds</a>() )
<a name="l02231"></a>02231                   {
<a name="l02232"></a>02232                         <a class="code" href="Strategic_01AI_8cpp.html#37d5de1723e5e64fd91aef9ec3018f14">HandlePlayerGroupNoticedByGarrison</a>( pPlayerGroup, (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)SECTOR( pPlayerGroup-&gt;<a class="code" href="structGROUP.html#eee29372e834112984eab1dc714466c0">ubSectorX</a>-1, pPlayerGroup-&gt;<a class="code" href="structGROUP.html#11cd63715d9daf1488cca330690db007">ubSectorY</a> ) );
<a name="l02233"></a>02233                         <span class="keywordflow">return</span> FALSE;
<a name="l02234"></a>02234                   }
<a name="l02235"></a>02235             }
<a name="l02236"></a>02236             <span class="keywordflow">if</span>( pPlayerGroup-&gt;<a class="code" href="structGROUP.html#11cd63715d9daf1488cca330690db007">ubSectorY</a> &lt; 16 )
<a name="l02237"></a>02237             {
<a name="l02238"></a>02238                   pEnemyGroup = <a class="code" href="Strategic_01Movement_8cpp.html#8fbed89c2ec9babd0f0fc9dcfc366f29">FindMovementGroupInSector</a>( pPlayerGroup-&gt;<a class="code" href="structGROUP.html#eee29372e834112984eab1dc714466c0">ubSectorX</a>, (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)(pPlayerGroup-&gt;<a class="code" href="structGROUP.html#11cd63715d9daf1488cca330690db007">ubSectorY</a>+1), FALSE );
<a name="l02239"></a>02239                   <span class="keywordflow">if</span>( pEnemyGroup &amp;&amp; <a class="code" href="Strategic_01AI_8cpp.html#cfe2abd9df33e8d3ae8f0bf9a6f82c93">AttemptToNoticeAdjacentGroupSucceeds</a>() )
<a name="l02240"></a>02240                   {
<a name="l02241"></a>02241                         <a class="code" href="Strategic_01AI_8cpp.html#af84c5cbdf76a83cd0eda1a9e6e65e05">HandlePlayerGroupNoticedByPatrolGroup</a>( pPlayerGroup, pEnemyGroup );
<a name="l02242"></a>02242                         <span class="keywordflow">return</span> FALSE;
<a name="l02243"></a>02243                   }
<a name="l02244"></a>02244                   pSector = &amp;<a class="code" href="Campaign_01Types_8h.html#d83c6f699f17a47cf6a662c91d959126">SectorInfo</a>[ SECTOR( pPlayerGroup-&gt;<a class="code" href="structGROUP.html#eee29372e834112984eab1dc714466c0">ubSectorX</a>, pPlayerGroup-&gt;<a class="code" href="structGROUP.html#11cd63715d9daf1488cca330690db007">ubSectorY</a>+1 ) ];
<a name="l02245"></a>02245                   ubNumEnemies = pSector-&gt;<a class="code" href="structSECTORINFO.html#d7d5ee63c0dc2ad3164c83541bd80906">ubNumAdmins</a> + pSector-&gt;<a class="code" href="structSECTORINFO.html#e36540b93256cfa71e45382f133d3696">ubNumTroops</a> + pSector-&gt;<a class="code" href="structSECTORINFO.html#3c5312672399c40ec5a395e8bcfb0104">ubNumElites</a>;
<a name="l02246"></a>02246                   <span class="keywordflow">if</span>( ubNumEnemies &amp;&amp; pSector-&gt;<a class="code" href="structSECTORINFO.html#9465931dad0e164d7d47814b66e454f0">ubGarrisonID</a> != NO_GARRISON &amp;&amp; <a class="code" href="Strategic_01AI_8cpp.html#cfe2abd9df33e8d3ae8f0bf9a6f82c93">AttemptToNoticeAdjacentGroupSucceeds</a>() )
<a name="l02247"></a>02247                   {
<a name="l02248"></a>02248                         <a class="code" href="Strategic_01AI_8cpp.html#37d5de1723e5e64fd91aef9ec3018f14">HandlePlayerGroupNoticedByGarrison</a>( pPlayerGroup, (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)SECTOR( pPlayerGroup-&gt;<a class="code" href="structGROUP.html#eee29372e834112984eab1dc714466c0">ubSectorX</a>, pPlayerGroup-&gt;<a class="code" href="structGROUP.html#11cd63715d9daf1488cca330690db007">ubSectorY</a>+1 ) );
<a name="l02249"></a>02249                         <span class="keywordflow">return</span> FALSE;
<a name="l02250"></a>02250                   }
<a name="l02251"></a>02251             }
<a name="l02252"></a>02252             <span class="keywordflow">if</span>( pPlayerGroup-&gt;<a class="code" href="structGROUP.html#eee29372e834112984eab1dc714466c0">ubSectorX</a> &gt; 1 )
<a name="l02253"></a>02253             {
<a name="l02254"></a>02254                   pEnemyGroup = <a class="code" href="Strategic_01Movement_8cpp.html#8fbed89c2ec9babd0f0fc9dcfc366f29">FindMovementGroupInSector</a>( (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)(pPlayerGroup-&gt;<a class="code" href="structGROUP.html#eee29372e834112984eab1dc714466c0">ubSectorX</a>-1), pPlayerGroup-&gt;<a class="code" href="structGROUP.html#11cd63715d9daf1488cca330690db007">ubSectorY</a>, FALSE );
<a name="l02255"></a>02255                   <span class="keywordflow">if</span>( pEnemyGroup &amp;&amp; <a class="code" href="Strategic_01AI_8cpp.html#cfe2abd9df33e8d3ae8f0bf9a6f82c93">AttemptToNoticeAdjacentGroupSucceeds</a>() )
<a name="l02256"></a>02256                   {
<a name="l02257"></a>02257                         <a class="code" href="Strategic_01AI_8cpp.html#af84c5cbdf76a83cd0eda1a9e6e65e05">HandlePlayerGroupNoticedByPatrolGroup</a>( pPlayerGroup, pEnemyGroup );
<a name="l02258"></a>02258                         <span class="keywordflow">return</span> FALSE;
<a name="l02259"></a>02259                   }
<a name="l02260"></a>02260                   pSector = &amp;<a class="code" href="Campaign_01Types_8h.html#d83c6f699f17a47cf6a662c91d959126">SectorInfo</a>[ SECTOR( pPlayerGroup-&gt;<a class="code" href="structGROUP.html#eee29372e834112984eab1dc714466c0">ubSectorX</a>+1, pPlayerGroup-&gt;<a class="code" href="structGROUP.html#11cd63715d9daf1488cca330690db007">ubSectorY</a> ) ];
<a name="l02261"></a>02261                   ubNumEnemies = pSector-&gt;<a class="code" href="structSECTORINFO.html#d7d5ee63c0dc2ad3164c83541bd80906">ubNumAdmins</a> + pSector-&gt;<a class="code" href="structSECTORINFO.html#e36540b93256cfa71e45382f133d3696">ubNumTroops</a> + pSector-&gt;<a class="code" href="structSECTORINFO.html#3c5312672399c40ec5a395e8bcfb0104">ubNumElites</a>;
<a name="l02262"></a>02262                   <span class="keywordflow">if</span>( ubNumEnemies &amp;&amp; pSector-&gt;<a class="code" href="structSECTORINFO.html#9465931dad0e164d7d47814b66e454f0">ubGarrisonID</a> != NO_GARRISON &amp;&amp; <a class="code" href="Strategic_01AI_8cpp.html#cfe2abd9df33e8d3ae8f0bf9a6f82c93">AttemptToNoticeAdjacentGroupSucceeds</a>() )
<a name="l02263"></a>02263                   {
<a name="l02264"></a>02264                         <a class="code" href="Strategic_01AI_8cpp.html#37d5de1723e5e64fd91aef9ec3018f14">HandlePlayerGroupNoticedByGarrison</a>( pPlayerGroup, (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)SECTOR( pPlayerGroup-&gt;<a class="code" href="structGROUP.html#eee29372e834112984eab1dc714466c0">ubSectorX</a>+1, pPlayerGroup-&gt;<a class="code" href="structGROUP.html#11cd63715d9daf1488cca330690db007">ubSectorY</a> ) );
<a name="l02265"></a>02265                         <span class="keywordflow">return</span> FALSE;
<a name="l02266"></a>02266                   }
<a name="l02267"></a>02267             }
<a name="l02268"></a>02268       }
<a name="l02269"></a>02269       <span class="keywordflow">return</span> FALSE;
<a name="l02270"></a>02270 }
<a name="l02271"></a>02271 
<a name="l02272"></a>02272 <span class="comment">//This is called periodically for each enemy occupied sector containing garrisons.</span>
<a name="l02273"></a><a class="code" href="Strategic_01AI_8h.html#9fa93d3880aca30b127b57c117394c7d">02273</a> <span class="keywordtype">void</span> <a class="code" href="Strategic_01AI_8cpp.html#9fa93d3880aca30b127b57c117394c7d">CheckEnemyControlledSector</a>( <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubSectorID )
<a name="l02274"></a>02274 {
<a name="l02275"></a>02275       <a class="code" href="structSECTORINFO.html">SECTORINFO</a> *pSector;
<a name="l02276"></a>02276       <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubSectorX, ubSectorY;
<a name="l02277"></a>02277       <span class="keywordflow">if</span>( !<a class="code" href="AI_01Viewer_8cpp.html#38284bd39764812fb8a27fe4d3d2b0cd">gfQueenAIAwake</a> )
<a name="l02278"></a>02278       {
<a name="l02279"></a>02279             <span class="keywordflow">return</span>;
<a name="l02280"></a>02280       }
<a name="l02281"></a>02281       <span class="comment">//First, determine if the sector is still owned by the enemy.  </span>
<a name="l02282"></a>02282       pSector = &amp;<a class="code" href="Campaign_01Types_8h.html#d83c6f699f17a47cf6a662c91d959126">SectorInfo</a>[ ubSectorID ];
<a name="l02283"></a>02283       <span class="keywordflow">if</span>( pSector-&gt;<a class="code" href="structSECTORINFO.html#9465931dad0e164d7d47814b66e454f0">ubGarrisonID</a> != NO_GARRISON )
<a name="l02284"></a>02284       {
<a name="l02285"></a>02285             <span class="keywordflow">if</span>( <a class="code" href="AI_01Viewer_8cpp.html#a9f940d7f3a6d6698bfaeb7c747d74a9">gGarrisonGroup</a>[ pSector-&gt;<a class="code" href="structSECTORINFO.html#9465931dad0e164d7d47814b66e454f0">ubGarrisonID</a> ].ubPendingGroupID )
<a name="l02286"></a>02286             { <span class="comment">//Look for a staging group.</span>
<a name="l02287"></a>02287                   <a class="code" href="structGROUP.html">GROUP</a> *pGroup;
<a name="l02288"></a>02288                   pGroup = <a class="code" href="Strategic_01Movement_8cpp.html#33138746a238bdc5c684e9aa2c86691c">GetGroup</a>( gGarrisonGroup[ pSector-&gt;<a class="code" href="structSECTORINFO.html#9465931dad0e164d7d47814b66e454f0">ubGarrisonID</a> ].ubPendingGroupID );
<a name="l02289"></a>02289                   <span class="keywordflow">if</span>( pGroup )
<a name="l02290"></a>02290                   { <span class="comment">//We have a staging group</span>
<a name="l02291"></a>02291                         <span class="keywordflow">if</span>( <a class="code" href="Strategic_01Movement_8cpp.html#5bffbc0549f4fb0c8829436f9ee6e907">GroupAtFinalDestination</a>( pGroup ) )
<a name="l02292"></a>02292                         {
<a name="l02293"></a>02293                               <span class="keywordflow">if</span>( pGroup-&gt;pEnemyGroup-&gt;ubPendingReinforcements )
<a name="l02294"></a>02294                               {
<a name="l02295"></a>02295                                     <span class="keywordflow">if</span>( pGroup-&gt;pEnemyGroup-&gt;ubPendingReinforcements &gt; 4 )
<a name="l02296"></a>02296                                     {
<a name="l02297"></a>02297                                           <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubNum = (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)(3 + <a class="code" href="Random_8cpp.html#49f938d1313ab6ef09ac6223a16ac334">Random</a>( 3 ));
<a name="l02298"></a>02298                                           pGroup-&gt;pEnemyGroup-&gt;ubNumTroops += ubNum;
<a name="l02299"></a>02299                                           pGroup-&gt;ubGroupSize += ubNum;
<a name="l02300"></a>02300                                           pGroup-&gt;pEnemyGroup-&gt;ubPendingReinforcements -= ubNum;
<a name="l02301"></a>02301                                           <a class="code" href="Strategic_01AI_8cpp.html#ef19940cb88bb587c8b2617054ad742d">RecalculateGroupWeight</a>( pGroup );
<a name="l02302"></a>02302                                           <a class="code" href="Strategic_01AI_8cpp.html#cc36ad74d06a3b8b211a4e06c8528a43">ValidateLargeGroup</a>( pGroup );
<a name="l02303"></a>02303                                     }
<a name="l02304"></a>02304                                     <span class="keywordflow">else</span>
<a name="l02305"></a>02305                                     {
<a name="l02306"></a>02306                                           pGroup-&gt;pEnemyGroup-&gt;ubNumTroops += pGroup-&gt;pEnemyGroup-&gt;ubPendingReinforcements;
<a name="l02307"></a>02307                                           pGroup-&gt;ubGroupSize += pGroup-&gt;pEnemyGroup-&gt;ubPendingReinforcements;
<a name="l02308"></a>02308                                           pGroup-&gt;pEnemyGroup-&gt;ubPendingReinforcements = 0;
<a name="l02309"></a>02309                                           <a class="code" href="Strategic_01AI_8cpp.html#cc36ad74d06a3b8b211a4e06c8528a43">ValidateLargeGroup</a>( pGroup );
<a name="l02310"></a>02310                                     }
<a name="l02311"></a>02311                                     <span class="comment">//RequestHighPriorityStagingGroupReinforcements( pGroup );</span>
<a name="l02312"></a>02312                               }
<a name="l02313"></a>02313                               <span class="keywordflow">else</span> <span class="keywordflow">if</span>( SECTOR( pGroup-&gt;ubSectorX, pGroup-&gt;ubSectorY ) != gGarrisonGroup[ pSector-&gt;<a class="code" href="structSECTORINFO.html#9465931dad0e164d7d47814b66e454f0">ubGarrisonID</a> ].ubSectorID ) 
<a name="l02314"></a>02314                               {
<a name="l02315"></a>02315                                     <a class="code" href="Strategic_01AI_8cpp.html#3865b55f00d5df7710bd4325ddf83bfc">MoveSAIGroupToSector</a>( &amp;pGroup, gGarrisonGroup[ pSector-&gt;<a class="code" href="structSECTORINFO.html#9465931dad0e164d7d47814b66e454f0">ubGarrisonID</a> ].ubSectorID, <a class="code" href="Strategic_01AI_8cpp.html#2282261c2887b2d4d1183cf5249e15291ea328a644e627283a35716a54108248">DIRECT</a>, pGroup-&gt;pEnemyGroup-&gt;ubIntention );
<a name="l02316"></a>02316                               }
<a name="l02317"></a>02317                         }
<a name="l02318"></a>02318                         <span class="comment">//else the group is on route to stage hopefully...</span>
<a name="l02319"></a>02319                   }
<a name="l02320"></a>02320             }
<a name="l02321"></a>02321       }
<a name="l02322"></a>02322       <span class="keywordflow">if</span>( pSector-&gt;<a class="code" href="structSECTORINFO.html#d7d5ee63c0dc2ad3164c83541bd80906">ubNumAdmins</a> + pSector-&gt;<a class="code" href="structSECTORINFO.html#e36540b93256cfa71e45382f133d3696">ubNumTroops</a> + pSector-&gt;<a class="code" href="structSECTORINFO.html#3c5312672399c40ec5a395e8bcfb0104">ubNumElites</a> )
<a name="l02323"></a>02323       {
<a name="l02324"></a>02324 
<a name="l02325"></a>02325             <span class="comment">//The sector is still controlled, so look around to see if there are any players nearby.</span>
<a name="l02326"></a>02326             ubSectorX = (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)SECTORX( ubSectorID );
<a name="l02327"></a>02327             ubSectorY = (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)SECTORY( ubSectorID );
<a name="l02328"></a>02328             <span class="keywordflow">if</span>( ubSectorY &gt; 1 &amp;&amp; <a class="code" href="Strategic_01AI_8cpp.html#f8f6673c3fc186e8d92341498a455679">EnemyPermittedToAttackSector</a>( NULL, (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)(ubSectorID - 16) ) )
<a name="l02329"></a>02329             {
<a name="l02330"></a>02330                   <span class="comment">/*</span>
<a name="l02331"></a>02331 <span class="comment">                  pPlayerGroup = FindMovementGroupInSector( ubSectorX, (UINT8)(ubSectorY-1), TRUE );</span>
<a name="l02332"></a>02332 <span class="comment">                  if( pPlayerGroup &amp;&amp; AttemptToNoticeAdjacentGroupSucceeds() )</span>
<a name="l02333"></a>02333 <span class="comment">                  {</span>
<a name="l02334"></a>02334 <span class="comment">                        HandlePlayerGroupNoticedByGarrison( pPlayerGroup, ubSectorID );</span>
<a name="l02335"></a>02335 <span class="comment">                        return;</span>
<a name="l02336"></a>02336 <span class="comment">                  }</span>
<a name="l02337"></a>02337 <span class="comment">                  else</span>
<a name="l02338"></a>02338 <span class="comment">                  */</span>
<a name="l02339"></a>02339                   <span class="keywordflow">if</span>( <a class="code" href="Strategic_01AI_8cpp.html#73501d5da96c2872b48fa331b1585ff2">AdjacentSectorIsImportantAndUndefended</a>( (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)(ubSectorID-16) ) &amp;&amp; <a class="code" href="Strategic_01AI_8cpp.html#f56d1e63c211df4c0082157c73603a78">AttemptToNoticeEmptySectorSucceeds</a>() )
<a name="l02340"></a>02340                   {
<a name="l02341"></a>02341                         <a class="code" href="Strategic_01AI_8cpp.html#32c627631f162fa5a39aaedb01970a42">HandleEmptySectorNoticedByGarrison</a>( ubSectorID, (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)(ubSectorID-16) );
<a name="l02342"></a>02342                         <span class="keywordflow">return</span>;
<a name="l02343"></a>02343                   }
<a name="l02344"></a>02344             }
<a name="l02345"></a>02345             <span class="keywordflow">if</span>( ubSectorX &lt; 16 &amp;&amp; <a class="code" href="Strategic_01AI_8cpp.html#f8f6673c3fc186e8d92341498a455679">EnemyPermittedToAttackSector</a>( NULL, (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)(ubSectorID + 1) ) )
<a name="l02346"></a>02346             {
<a name="l02347"></a>02347                   <span class="comment">/*</span>
<a name="l02348"></a>02348 <span class="comment">                  pPlayerGroup = FindMovementGroupInSector( (UINT8)(ubSectorX+1), ubSectorY, TRUE );</span>
<a name="l02349"></a>02349 <span class="comment">                  if( pPlayerGroup &amp;&amp; AttemptToNoticeAdjacentGroupSucceeds() )</span>
<a name="l02350"></a>02350 <span class="comment">                  {</span>
<a name="l02351"></a>02351 <span class="comment">                        HandlePlayerGroupNoticedByGarrison( pPlayerGroup, ubSectorID );</span>
<a name="l02352"></a>02352 <span class="comment">                        return;</span>
<a name="l02353"></a>02353 <span class="comment">                  }</span>
<a name="l02354"></a>02354 <span class="comment">                  else </span>
<a name="l02355"></a>02355 <span class="comment">                  */</span>
<a name="l02356"></a>02356                   <span class="keywordflow">if</span>( <a class="code" href="Strategic_01AI_8cpp.html#73501d5da96c2872b48fa331b1585ff2">AdjacentSectorIsImportantAndUndefended</a>( (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)(ubSectorID+1) ) &amp;&amp; <a class="code" href="Strategic_01AI_8cpp.html#f56d1e63c211df4c0082157c73603a78">AttemptToNoticeEmptySectorSucceeds</a>() )
<a name="l02357"></a>02357                   {
<a name="l02358"></a>02358                         <a class="code" href="Strategic_01AI_8cpp.html#32c627631f162fa5a39aaedb01970a42">HandleEmptySectorNoticedByGarrison</a>( ubSectorID, (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)(ubSectorID+1) );
<a name="l02359"></a>02359                         <span class="keywordflow">return</span>;
<a name="l02360"></a>02360                   }
<a name="l02361"></a>02361             }
<a name="l02362"></a>02362             <span class="keywordflow">if</span>( ubSectorY &lt; 16 &amp;&amp; <a class="code" href="Strategic_01AI_8cpp.html#f8f6673c3fc186e8d92341498a455679">EnemyPermittedToAttackSector</a>( NULL, (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)(ubSectorID + 16) ) )
<a name="l02363"></a>02363             {
<a name="l02364"></a>02364                   <span class="comment">/*</span>
<a name="l02365"></a>02365 <span class="comment">                  pPlayerGroup = FindMovementGroupInSector( ubSectorX, (UINT8)(ubSectorY+1), TRUE );</span>
<a name="l02366"></a>02366 <span class="comment">                  if( pPlayerGroup &amp;&amp; AttemptToNoticeAdjacentGroupSucceeds() )</span>
<a name="l02367"></a>02367 <span class="comment">                  {</span>
<a name="l02368"></a>02368 <span class="comment">                        HandlePlayerGroupNoticedByGarrison( pPlayerGroup, ubSectorID );</span>
<a name="l02369"></a>02369 <span class="comment">                        return;</span>
<a name="l02370"></a>02370 <span class="comment">                  }</span>
<a name="l02371"></a>02371 <span class="comment">                  else </span>
<a name="l02372"></a>02372 <span class="comment">                  */</span>
<a name="l02373"></a>02373                   <span class="keywordflow">if</span>( <a class="code" href="Strategic_01AI_8cpp.html#73501d5da96c2872b48fa331b1585ff2">AdjacentSectorIsImportantAndUndefended</a>( (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)(ubSectorID+16) ) &amp;&amp; <a class="code" href="Strategic_01AI_8cpp.html#f56d1e63c211df4c0082157c73603a78">AttemptToNoticeEmptySectorSucceeds</a>() )
<a name="l02374"></a>02374                   {
<a name="l02375"></a>02375                         <a class="code" href="Strategic_01AI_8cpp.html#32c627631f162fa5a39aaedb01970a42">HandleEmptySectorNoticedByGarrison</a>( ubSectorID, (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)(ubSectorID+16) );
<a name="l02376"></a>02376                         <span class="keywordflow">return</span>;
<a name="l02377"></a>02377                   }
<a name="l02378"></a>02378             }
<a name="l02379"></a>02379             <span class="keywordflow">if</span>( ubSectorX &gt; 1 &amp;&amp; <a class="code" href="Strategic_01AI_8cpp.html#f8f6673c3fc186e8d92341498a455679">EnemyPermittedToAttackSector</a>( NULL, (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)(ubSectorID - 1) ) )
<a name="l02380"></a>02380             {
<a name="l02381"></a>02381                   <span class="comment">/*</span>
<a name="l02382"></a>02382 <span class="comment">                  pPlayerGroup = FindMovementGroupInSector( (UINT8)(ubSectorX-1), ubSectorY, TRUE );</span>
<a name="l02383"></a>02383 <span class="comment">                  if( pPlayerGroup &amp;&amp; AttemptToNoticeAdjacentGroupSucceeds() )</span>
<a name="l02384"></a>02384 <span class="comment">                  {</span>
<a name="l02385"></a>02385 <span class="comment">                        HandlePlayerGroupNoticedByGarrison( pPlayerGroup, ubSectorID );</span>
<a name="l02386"></a>02386 <span class="comment">                        return;</span>
<a name="l02387"></a>02387 <span class="comment">                  }</span>
<a name="l02388"></a>02388 <span class="comment">                  else </span>
<a name="l02389"></a>02389 <span class="comment">                  */</span>
<a name="l02390"></a>02390                   <span class="keywordflow">if</span>( <a class="code" href="Strategic_01AI_8cpp.html#73501d5da96c2872b48fa331b1585ff2">AdjacentSectorIsImportantAndUndefended</a>( (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)(ubSectorID-1) ) &amp;&amp; <a class="code" href="Strategic_01AI_8cpp.html#f56d1e63c211df4c0082157c73603a78">AttemptToNoticeEmptySectorSucceeds</a>() )
<a name="l02391"></a>02391                   {
<a name="l02392"></a>02392                         <a class="code" href="Strategic_01AI_8cpp.html#32c627631f162fa5a39aaedb01970a42">HandleEmptySectorNoticedByGarrison</a>( ubSectorID, (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)(ubSectorID-1) );
<a name="l02393"></a>02393                         <span class="keywordflow">return</span>;
<a name="l02394"></a>02394                   }
<a name="l02395"></a>02395             }
<a name="l02396"></a>02396       }
<a name="l02397"></a>02397 }
<a name="l02398"></a>02398 
<a name="l02399"></a>02399 
<a name="l02400"></a><a class="code" href="Strategic_01AI_8h.html#58fa31606cbdfecd5f767f474a63aa87">02400</a> <span class="keywordtype">void</span> <a class="code" href="Strategic_01AI_8cpp.html#58fa31606cbdfecd5f767f474a63aa87">RemoveGroupFromStrategicAILists</a>( <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubGroupID )
<a name="l02401"></a>02401 {
<a name="l02402"></a>02402       <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a> i;
<a name="l02403"></a>02403       <span class="keywordflow">for</span>( i = 0; i &lt; giPatrolArraySize; i++ )
<a name="l02404"></a>02404       {
<a name="l02405"></a>02405             <span class="keywordflow">if</span>( <a class="code" href="Strategic_01AI_8cpp.html#9e00ccb0e77cec57208c519e8f831f53">gPatrolGroup</a>[ i ].ubGroupID == ubGroupID )
<a name="l02406"></a>02406             { <span class="comment">//Patrol group was destroyed.</span>
<a name="l02407"></a>02407                   <a class="code" href="Strategic_01AI_8cpp.html#9e00ccb0e77cec57208c519e8f831f53">gPatrolGroup</a>[ i ].ubGroupID = 0;
<a name="l02408"></a>02408                   <a class="code" href="Strategic_01AI_8cpp.html#d11803600200a4f8e0f5d842132fc140">RecalculatePatrolWeight</a>( i );             
<a name="l02409"></a>02409                   <span class="keywordflow">return</span>;
<a name="l02410"></a>02410             }
<a name="l02411"></a>02411             <span class="keywordflow">if</span>( <a class="code" href="Strategic_01AI_8cpp.html#9e00ccb0e77cec57208c519e8f831f53">gPatrolGroup</a>[ i ].ubPendingGroupID == ubGroupID )
<a name="l02412"></a>02412             { <span class="comment">//Group never arrived to reinforce.</span>
<a name="l02413"></a>02413                   <a class="code" href="Strategic_01AI_8cpp.html#9e00ccb0e77cec57208c519e8f831f53">gPatrolGroup</a>[ i ].<a class="code" href="structPATROL__GROUP.html#85b82707f42868bcdd678a1d7ba9c257">ubPendingGroupID</a> = 0;
<a name="l02414"></a>02414                   <span class="keywordflow">return</span>;
<a name="l02415"></a>02415             }
<a name="l02416"></a>02416       }
<a name="l02417"></a>02417       <span class="keywordflow">for</span>( i = 0; i &lt; giGarrisonArraySize; i++ )
<a name="l02418"></a>02418       {
<a name="l02419"></a>02419             <span class="keywordflow">if</span>( <a class="code" href="AI_01Viewer_8cpp.html#a9f940d7f3a6d6698bfaeb7c747d74a9">gGarrisonGroup</a>[ i ].ubPendingGroupID == ubGroupID )
<a name="l02420"></a>02420             { <span class="comment">//Group never arrived to reinforce.</span>
<a name="l02421"></a>02421                   <a class="code" href="AI_01Viewer_8cpp.html#a9f940d7f3a6d6698bfaeb7c747d74a9">gGarrisonGroup</a>[ i ].ubPendingGroupID = 0;
<a name="l02422"></a>02422                   <span class="keywordflow">return</span>;
<a name="l02423"></a>02423             }
<a name="l02424"></a>02424       }
<a name="l02425"></a>02425 }
<a name="l02426"></a>02426 
<a name="l02427"></a><a class="code" href="Strategic_01AI_8cpp.html#d11803600200a4f8e0f5d842132fc140">02427</a> <span class="keywordtype">void</span> <a class="code" href="Strategic_01AI_8cpp.html#d11803600200a4f8e0f5d842132fc140">RecalculatePatrolWeight</a>( <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a> iPatrolID )
<a name="l02428"></a>02428 {
<a name="l02429"></a>02429       <a class="code" href="structGROUP.html">GROUP</a> *pGroup;
<a name="l02430"></a>02430       <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a> iWeight, iPrevWeight;
<a name="l02431"></a>02431       <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a> iNeedPopulation;
<a name="l02432"></a>02432 
<a name="l02433"></a>02433       <a class="code" href="Strategic_01AI_8cpp.html#75d774eb03c41b5fe422edfef6e445d4">ValidateWeights</a>( 4 );
<a name="l02434"></a>02434 
<a name="l02435"></a>02435       <span class="comment">//First, remove the previous weight from the applicable field.</span>
<a name="l02436"></a>02436       iPrevWeight = <a class="code" href="Strategic_01AI_8cpp.html#9e00ccb0e77cec57208c519e8f831f53">gPatrolGroup</a>[ iPatrolID ].<a class="code" href="structPATROL__GROUP.html#dd4d329226457571a40c1855943ef39b">bWeight</a>;
<a name="l02437"></a>02437       <span class="keywordflow">if</span>( iPrevWeight &gt; 0 )
<a name="l02438"></a>02438             <a class="code" href="AI_01Viewer_8cpp.html#c3390da297cb8068458f459fe9fc094f">giRequestPoints</a> -= iPrevWeight;
<a name="l02439"></a>02439 
<a name="l02440"></a>02440       <span class="keywordflow">if</span>( <a class="code" href="Strategic_01AI_8cpp.html#9e00ccb0e77cec57208c519e8f831f53">gPatrolGroup</a>[ iPatrolID ].ubGroupID )
<a name="l02441"></a>02441       {
<a name="l02442"></a>02442             pGroup = <a class="code" href="Strategic_01Movement_8cpp.html#33138746a238bdc5c684e9aa2c86691c">GetGroup</a>( <a class="code" href="Strategic_01AI_8cpp.html#9e00ccb0e77cec57208c519e8f831f53">gPatrolGroup</a>[ iPatrolID ].ubGroupID );
<a name="l02443"></a>02443             iNeedPopulation = <a class="code" href="Strategic_01AI_8cpp.html#9e00ccb0e77cec57208c519e8f831f53">gPatrolGroup</a>[ iPatrolID ].<a class="code" href="structPATROL__GROUP.html#762c71bc2c1ac677b145a43cad0f6d22">bSize</a> - pGroup-&gt;<a class="code" href="structGROUP.html#2a98517c894019ee794e04ea05d1aeaf">ubGroupSize</a>;
<a name="l02444"></a>02444             <span class="keywordflow">if</span>( iNeedPopulation &lt; 0 )
<a name="l02445"></a>02445             {
<a name="l02446"></a>02446                   <a class="code" href="Strategic_01AI_8cpp.html#9e00ccb0e77cec57208c519e8f831f53">gPatrolGroup</a>[ iPatrolID ].<a class="code" href="structPATROL__GROUP.html#dd4d329226457571a40c1855943ef39b">bWeight</a> = 0;
<a name="l02447"></a>02447                   <a class="code" href="Strategic_01AI_8cpp.html#75d774eb03c41b5fe422edfef6e445d4">ValidateWeights</a>( 27 );
<a name="l02448"></a>02448                   <span class="keywordflow">return</span>;
<a name="l02449"></a>02449             }
<a name="l02450"></a>02450       }     
<a name="l02451"></a>02451       <span class="keywordflow">else</span>
<a name="l02452"></a>02452       {
<a name="l02453"></a>02453             iNeedPopulation = <a class="code" href="Strategic_01AI_8cpp.html#9e00ccb0e77cec57208c519e8f831f53">gPatrolGroup</a>[ iPatrolID ].<a class="code" href="structPATROL__GROUP.html#762c71bc2c1ac677b145a43cad0f6d22">bSize</a>;
<a name="l02454"></a>02454       }
<a name="l02455"></a>02455       iWeight = iNeedPopulation * 3 * <a class="code" href="Strategic_01AI_8cpp.html#9e00ccb0e77cec57208c519e8f831f53">gPatrolGroup</a>[ iPatrolID ].<a class="code" href="structPATROL__GROUP.html#93640ff8c9775890352727ed0053b6bd">bPriority</a> / 96;
<a name="l02456"></a>02456       iWeight = min( 2, iWeight );
<a name="l02457"></a>02457       <a class="code" href="Strategic_01AI_8cpp.html#9e00ccb0e77cec57208c519e8f831f53">gPatrolGroup</a>[ iPatrolID ].<a class="code" href="structPATROL__GROUP.html#dd4d329226457571a40c1855943ef39b">bWeight</a> = (<a class="code" href="Types_8h.html#7ebe70ceca856797319175e30bcf003d">INT8</a>)iWeight;
<a name="l02458"></a>02458       <a class="code" href="AI_01Viewer_8cpp.html#c3390da297cb8068458f459fe9fc094f">giRequestPoints</a> += iWeight;
<a name="l02459"></a>02459 
<a name="l02460"></a>02460       <a class="code" href="Strategic_01AI_8cpp.html#75d774eb03c41b5fe422edfef6e445d4">ValidateWeights</a>( 5 );
<a name="l02461"></a>02461 }
<a name="l02462"></a>02462 
<a name="l02463"></a><a class="code" href="Strategic_01AI_8cpp.html#c9af29ba59f70cabda683c1d3e7de1d0">02463</a> <span class="keywordtype">void</span> <a class="code" href="Strategic_01AI_8cpp.html#c9af29ba59f70cabda683c1d3e7de1d0">RecalculateGarrisonWeight</a>( <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a> iGarrisonID )
<a name="l02464"></a>02464 {
<a name="l02465"></a>02465       <a class="code" href="structSECTORINFO.html">SECTORINFO</a> *pSector;
<a name="l02466"></a>02466       <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a> iWeight, iPrevWeight;
<a name="l02467"></a>02467       <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a> iDesiredPop, iCurrentPop, iPriority;
<a name="l02468"></a>02468 
<a name="l02469"></a>02469       <a class="code" href="Strategic_01AI_8cpp.html#75d774eb03c41b5fe422edfef6e445d4">ValidateWeights</a>( 6 );
<a name="l02470"></a>02470 
<a name="l02471"></a>02471       pSector = &amp;<a class="code" href="Campaign_01Types_8h.html#d83c6f699f17a47cf6a662c91d959126">SectorInfo</a>[ <a class="code" href="AI_01Viewer_8cpp.html#a9f940d7f3a6d6698bfaeb7c747d74a9">gGarrisonGroup</a>[ iGarrisonID ].<a class="code" href="structGARRISON__GROUP.html#fb130d3c9211374d87a85cca787fe0dd">ubSectorID</a> ];
<a name="l02472"></a>02472       iDesiredPop = <a class="code" href="AI_01Viewer_8cpp.html#77e448d1f208bd120f861571e6d0098f">gArmyComp</a>[ gGarrisonGroup[ iGarrisonID ].ubComposition ].<a class="code" href="structARMY__COMPOSITION.html#164db6c6c30629f43d42469671367c86">bDesiredPopulation</a>;
<a name="l02473"></a>02473       iCurrentPop = pSector-&gt;<a class="code" href="structSECTORINFO.html#d7d5ee63c0dc2ad3164c83541bd80906">ubNumAdmins</a> + pSector-&gt;<a class="code" href="structSECTORINFO.html#e36540b93256cfa71e45382f133d3696">ubNumTroops</a> + pSector-&gt;<a class="code" href="structSECTORINFO.html#3c5312672399c40ec5a395e8bcfb0104">ubNumElites</a>;
<a name="l02474"></a>02474       iPriority = <a class="code" href="AI_01Viewer_8cpp.html#77e448d1f208bd120f861571e6d0098f">gArmyComp</a>[ gGarrisonGroup[ iGarrisonID ].ubComposition ].<a class="code" href="structARMY__COMPOSITION.html#ae9820933dc13e0351dbd9fe1daf8ab4">bPriority</a>;
<a name="l02475"></a>02475 
<a name="l02476"></a>02476       <span class="comment">//First, remove the previous weight from the applicable field.</span>
<a name="l02477"></a>02477       iPrevWeight = gGarrisonGroup[ iGarrisonID ].bWeight;
<a name="l02478"></a>02478       <span class="keywordflow">if</span>( iPrevWeight &gt; 0 )
<a name="l02479"></a>02479             <a class="code" href="AI_01Viewer_8cpp.html#c3390da297cb8068458f459fe9fc094f">giRequestPoints</a> -= iPrevWeight;
<a name="l02480"></a>02480       <span class="keywordflow">else</span> <span class="keywordflow">if</span>( iPrevWeight &lt; 0 )
<a name="l02481"></a>02481             <a class="code" href="AI_01Viewer_8cpp.html#a54cf2087c7e1b790053295a6bf90592">giReinforcementPoints</a> += iPrevWeight;
<a name="l02482"></a>02482 
<a name="l02483"></a>02483       <span class="comment">//Calculate weight (range is -20 to +20 before multiplier).</span>
<a name="l02484"></a>02484       <span class="comment">//The multiplier of 3 brings it to a range of -96 to +96 which is</span>
<a name="l02485"></a>02485       <span class="comment">//close enough to a plus/minus 100%.  The resultant percentage is then</span>
<a name="l02486"></a>02486       <span class="comment">//converted based on the priority.</span>
<a name="l02487"></a>02487       iWeight = (iDesiredPop - iCurrentPop) * 3;
<a name="l02488"></a>02488       <span class="keywordflow">if</span>( iWeight &gt; 0 )
<a name="l02489"></a>02489       { <span class="comment">//modify it by it's priority.</span>
<a name="l02490"></a>02490             <span class="comment">//generates a value between 2 and 100</span>
<a name="l02491"></a>02491             iWeight = iWeight * iPriority / 96;
<a name="l02492"></a>02492             iWeight = max( iWeight, 2 );
<a name="l02493"></a>02493             <a class="code" href="AI_01Viewer_8cpp.html#c3390da297cb8068458f459fe9fc094f">giRequestPoints</a> += iWeight;
<a name="l02494"></a>02494       }
<a name="l02495"></a>02495       <span class="keywordflow">else</span> <span class="keywordflow">if</span>( iWeight &lt; 0 ) 
<a name="l02496"></a>02496       { <span class="comment">//modify it by it's reverse priority </span>
<a name="l02497"></a>02497             <span class="comment">//generates a value between -2 and -100</span>
<a name="l02498"></a>02498             iWeight = iWeight * (100-iPriority) / 96;
<a name="l02499"></a>02499             iWeight = min( iWeight, -2 );
<a name="l02500"></a>02500             <a class="code" href="AI_01Viewer_8cpp.html#a54cf2087c7e1b790053295a6bf90592">giReinforcementPoints</a> -= (<a class="code" href="Types_8h.html#7ebe70ceca856797319175e30bcf003d">INT8</a>)iWeight;
<a name="l02501"></a>02501       }
<a name="l02502"></a>02502 
<a name="l02503"></a>02503       gGarrisonGroup[ iGarrisonID ].bWeight = (<a class="code" href="Types_8h.html#7ebe70ceca856797319175e30bcf003d">INT8</a>)iWeight;
<a name="l02504"></a>02504 
<a name="l02505"></a>02505       <a class="code" href="Strategic_01AI_8cpp.html#75d774eb03c41b5fe422edfef6e445d4">ValidateWeights</a>( 7 );
<a name="l02506"></a>02506 }
<a name="l02507"></a>02507 
<a name="l02508"></a><a class="code" href="Strategic_01AI_8h.html#2ac233d8185907c372e75f5f48e56673">02508</a> <span class="keywordtype">void</span> <a class="code" href="Strategic_01AI_8cpp.html#2ac233d8185907c372e75f5f48e56673">RecalculateSectorWeight</a>( <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubSectorID )
<a name="l02509"></a>02509 {
<a name="l02510"></a>02510       <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a> i;
<a name="l02511"></a>02511       <span class="keywordflow">for</span>( i = 0; i &lt; giGarrisonArraySize; i++ )
<a name="l02512"></a>02512       {
<a name="l02513"></a>02513             <span class="keywordflow">if</span>( <a class="code" href="AI_01Viewer_8cpp.html#a9f940d7f3a6d6698bfaeb7c747d74a9">gGarrisonGroup</a>[ i ].ubSectorID == ubSectorID )
<a name="l02514"></a>02514             {
<a name="l02515"></a>02515                   <a class="code" href="Strategic_01AI_8cpp.html#c9af29ba59f70cabda683c1d3e7de1d0">RecalculateGarrisonWeight</a>( i );
<a name="l02516"></a>02516                   <span class="keywordflow">return</span>;
<a name="l02517"></a>02517             }
<a name="l02518"></a>02518       }
<a name="l02519"></a>02519 }
<a name="l02520"></a>02520 
<a name="l02521"></a><a class="code" href="Strategic_01AI_8h.html#ef19940cb88bb587c8b2617054ad742d">02521</a> <span class="keywordtype">void</span> <a class="code" href="Strategic_01AI_8cpp.html#ef19940cb88bb587c8b2617054ad742d">RecalculateGroupWeight</a>( <a class="code" href="structGROUP.html">GROUP</a> *pGroup )
<a name="l02522"></a>02522 {
<a name="l02523"></a>02523       <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a> i;
<a name="l02524"></a>02524       <span class="keywordflow">for</span>( i = 0; i &lt; giPatrolArraySize; i++ )
<a name="l02525"></a>02525       {
<a name="l02526"></a>02526             <span class="keywordflow">if</span>( <a class="code" href="Strategic_01AI_8cpp.html#9e00ccb0e77cec57208c519e8f831f53">gPatrolGroup</a>[ i ].ubGroupID == pGroup-&gt;<a class="code" href="structGROUP.html#9149379b9355afda87a382af5a88d728">ubGroupID</a> )
<a name="l02527"></a>02527             {
<a name="l02528"></a>02528                   <span class="keywordflow">if</span>( !pGroup-&gt;<a class="code" href="structGROUP.html#2a98517c894019ee794e04ea05d1aeaf">ubGroupSize</a> )
<a name="l02529"></a>02529                   {
<a name="l02530"></a>02530                         <a class="code" href="Strategic_01AI_8cpp.html#626dbbe3f6ab416e4ca04ee09063042f">TagSAIGroupWithGracePeriod</a>( pGroup );
<a name="l02531"></a>02531                         <a class="code" href="Strategic_01AI_8cpp.html#9e00ccb0e77cec57208c519e8f831f53">gPatrolGroup</a>[ i ].<a class="code" href="structPATROL__GROUP.html#a94d3c610977f7a6fab94b302493d084">ubGroupID</a> = 0;
<a name="l02532"></a>02532                   }
<a name="l02533"></a>02533                   <a class="code" href="Strategic_01AI_8cpp.html#d11803600200a4f8e0f5d842132fc140">RecalculatePatrolWeight</a>( i );
<a name="l02534"></a>02534                   <span class="keywordflow">return</span>;
<a name="l02535"></a>02535             }
<a name="l02536"></a>02536       }
<a name="l02537"></a>02537 
<a name="l02538"></a>02538 }
<a name="l02539"></a>02539 
<a name="l02540"></a><a class="code" href="Strategic_01AI_8cpp.html#4c4e87c375eba1c81104c0d50d41e902">02540</a> <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a> <a class="code" href="Strategic_01AI_8cpp.html#4c4e87c375eba1c81104c0d50d41e902">ChooseSuitableGarrisonToProvideReinforcements</a>( <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a> iDstGarrisonID, <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a> iReinforcementsRequested )
<a name="l02541"></a>02541 {
<a name="l02542"></a>02542       <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a> iSrcGarrisonID, iBestGarrisonID = NO_GARRISON;
<a name="l02543"></a>02543       <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a> iReinforcementsAvailable;
<a name="l02544"></a>02544       <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a> i, iRandom, iWeight;
<a name="l02545"></a>02545       <a class="code" href="Types_8h.html#7ebe70ceca856797319175e30bcf003d">INT8</a> bBestWeight;
<a name="l02546"></a>02546       <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubSectorID;
<a name="l02547"></a>02547 
<a name="l02548"></a>02548       <span class="comment">//Check to see if we could send reinforcements from Alma.  Only Drassen/Cambria get preferred</span>
<a name="l02549"></a>02549       <span class="comment">//service from Alma, due to it's proximity and Alma's purpose as a forward military base.</span>
<a name="l02550"></a>02550       ubSectorID = <a class="code" href="AI_01Viewer_8cpp.html#a9f940d7f3a6d6698bfaeb7c747d74a9">gGarrisonGroup</a>[ iDstGarrisonID ].<a class="code" href="structGARRISON__GROUP.html#fb130d3c9211374d87a85cca787fe0dd">ubSectorID</a>;
<a name="l02551"></a>02551       <span class="keywordflow">switch</span>( ubSectorID )
<a name="l02552"></a>02552       {
<a name="l02553"></a>02553             <span class="keywordflow">case</span> <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c66026436d911e0461303edb9fe227735f787c22">SEC_B13</a>: <span class="keywordflow">case</span> <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643e84863fb1442cf38c7311021990a9bc3">SEC_C13</a>: <span class="keywordflow">case</span> <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c66026435b0fbd8598540769dcf8f24e3134f48c">SEC_D13</a>: <span class="keywordflow">case</span> <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643a6b93766e638fc1877d78e6209cfb7dc">SEC_D15</a>:                                               <span class="comment">//Drassen + nearby SAM site</span>
<a name="l02554"></a>02554             <span class="keywordflow">case</span> <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643e0a7185e05270b8ffacff9816031ae8e">SEC_F8</a>:  <span class="keywordflow">case</span> <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643a20fa3a3e3da7996c9d5fab6d2fb6e84">SEC_F9</a>:  <span class="keywordflow">case</span> <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643d037ec147301d1498cd5ea0307da2d34">SEC_G8</a>:  <span class="keywordflow">case</span> <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643fa4b17f23c10d54767184540803edce8">SEC_G9</a>:  <span class="keywordflow">case</span> <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643897f1cfaae4b38d8022feec3521887df">SEC_H8</a>:    <span class="comment">//Cambria</span>
<a name="l02555"></a>02555                   <span class="comment">//reinforcements will be primarily sent from Alma whenever possible.</span>
<a name="l02556"></a>02556 
<a name="l02557"></a>02557                   <span class="comment">//find which the first sector that contains Alma soldiers.</span>
<a name="l02558"></a>02558                   <span class="keywordflow">for</span>( i = 0; i &lt; giGarrisonArraySize; i++ )
<a name="l02559"></a>02559                   {
<a name="l02560"></a>02560                         <span class="keywordflow">if</span>( <a class="code" href="AI_01Viewer_8cpp.html#a9f940d7f3a6d6698bfaeb7c747d74a9">gGarrisonGroup</a>[ i ].ubComposition == <a class="code" href="Strategic_01AI_8h.html#a9908284c0827729f14cf9b2489e1479f024876f6e0853a27e7bc9825c61e1d1">ALMA_DEFENCE</a> )
<a name="l02561"></a>02561                               <span class="keywordflow">break</span>;
<a name="l02562"></a>02562                   }
<a name="l02563"></a>02563                   iSrcGarrisonID = i;
<a name="l02564"></a>02564                   <span class="comment">//which of these 4 Alma garrisons have the most reinforcements available?  It is</span>
<a name="l02565"></a>02565                   <span class="comment">//possible that none of these garrisons can provide any reinforcements.</span>
<a name="l02566"></a>02566                   bBestWeight = 0;
<a name="l02567"></a>02567                   <span class="keywordflow">for</span>( i = iSrcGarrisonID; i &lt; iSrcGarrisonID + 4; i++ )
<a name="l02568"></a>02568                   {
<a name="l02569"></a>02569                         <a class="code" href="Strategic_01AI_8cpp.html#c9af29ba59f70cabda683c1d3e7de1d0">RecalculateGarrisonWeight</a>( i );
<a name="l02570"></a>02570                         <span class="keywordflow">if</span>( bBestWeight &gt; <a class="code" href="AI_01Viewer_8cpp.html#a9f940d7f3a6d6698bfaeb7c747d74a9">gGarrisonGroup</a>[ i ].bWeight &amp;&amp; <a class="code" href="Strategic_01AI_8cpp.html#54faeb29802e301239709cc407576cd1">GarrisonCanProvideMinimumReinforcements</a>( i ) )
<a name="l02571"></a>02571                         {
<a name="l02572"></a>02572                               bBestWeight = <a class="code" href="AI_01Viewer_8cpp.html#a9f940d7f3a6d6698bfaeb7c747d74a9">gGarrisonGroup</a>[ i ].bWeight;
<a name="l02573"></a>02573                               iBestGarrisonID = i;
<a name="l02574"></a>02574                         }
<a name="l02575"></a>02575                   }
<a name="l02576"></a>02576                   <span class="comment">//If we can provide reinforcements from Alma, then make sure that it can provide at least 67% of</span>
<a name="l02577"></a>02577                   <span class="comment">//the requested reinforcements.</span>
<a name="l02578"></a>02578                   <span class="keywordflow">if</span>( bBestWeight &lt; 0 )
<a name="l02579"></a>02579                   {
<a name="l02580"></a>02580                         iReinforcementsAvailable = <a class="code" href="Strategic_01AI_8cpp.html#935cd00b37d3ecb937347a7d5ed379d0">ReinforcementsAvailable</a>( iBestGarrisonID );
<a name="l02581"></a>02581                         <span class="keywordflow">if</span>( iReinforcementsAvailable * 100 &gt;= iReinforcementsRequested * 67 )
<a name="l02582"></a>02582                         { <span class="comment">//This is the approved group to provide the reinforcements.</span>
<a name="l02583"></a>02583                               <span class="keywordflow">return</span> iBestGarrisonID;
<a name="l02584"></a>02584                         }
<a name="l02585"></a>02585                   }
<a name="l02586"></a>02586                   <span class="keywordflow">break</span>;
<a name="l02587"></a>02587       }
<a name="l02588"></a>02588 
<a name="l02589"></a>02589       <span class="comment">//The Alma case either wasn't applicable or failed to have the right reinforcements.  Do a general weighted search.</span>
<a name="l02590"></a>02590       iRandom = <a class="code" href="Random_8cpp.html#49f938d1313ab6ef09ac6223a16ac334">Random</a>( <a class="code" href="AI_01Viewer_8cpp.html#a54cf2087c7e1b790053295a6bf90592">giReinforcementPoints</a> );
<a name="l02591"></a>02591       <span class="keywordflow">for</span>( iSrcGarrisonID = 0; iSrcGarrisonID &lt; giGarrisonArraySize; iSrcGarrisonID++ )
<a name="l02592"></a>02592       { <span class="comment">//go through the garrisons</span>
<a name="l02593"></a>02593             <a class="code" href="Strategic_01AI_8cpp.html#c9af29ba59f70cabda683c1d3e7de1d0">RecalculateGarrisonWeight</a>( iSrcGarrisonID );
<a name="l02594"></a>02594             iWeight = -<a class="code" href="AI_01Viewer_8cpp.html#a9f940d7f3a6d6698bfaeb7c747d74a9">gGarrisonGroup</a>[ iSrcGarrisonID ].<a class="code" href="structGARRISON__GROUP.html#54fcf91b97b56e3cc75ef302b34ecf48">bWeight</a>;
<a name="l02595"></a>02595             <span class="keywordflow">if</span>( iWeight &gt; 0 )
<a name="l02596"></a>02596             { <span class="comment">//if group is able to provide reinforcements.</span>
<a name="l02597"></a>02597                   <span class="keywordflow">if</span>( iRandom &lt; iWeight &amp;&amp; <a class="code" href="Strategic_01AI_8cpp.html#54faeb29802e301239709cc407576cd1">GarrisonCanProvideMinimumReinforcements</a>( iSrcGarrisonID ) )
<a name="l02598"></a>02598                   {
<a name="l02599"></a>02599                         iReinforcementsAvailable = <a class="code" href="Strategic_01AI_8cpp.html#935cd00b37d3ecb937347a7d5ed379d0">ReinforcementsAvailable</a>( iSrcGarrisonID );
<a name="l02600"></a>02600                         <span class="keywordflow">if</span>( iReinforcementsAvailable * 100 &gt;= iReinforcementsRequested * 67 )
<a name="l02601"></a>02601                         { <span class="comment">//This is the approved group to provide the reinforcements.</span>
<a name="l02602"></a>02602                               <span class="keywordflow">return</span> iSrcGarrisonID;
<a name="l02603"></a>02603                         }
<a name="l02604"></a>02604                   }
<a name="l02605"></a>02605                   iRandom -= iWeight;
<a name="l02606"></a>02606             }
<a name="l02607"></a>02607       }
<a name="l02608"></a>02608 
<a name="l02609"></a>02609       <span class="comment">//So far we have failed on all accounts.  Now, simply process all the garrisons, and return the first garrison that can </span>
<a name="l02610"></a>02610       <span class="comment">//provide the reinforcements.</span>
<a name="l02611"></a>02611       <span class="keywordflow">for</span>( iSrcGarrisonID = 0; iSrcGarrisonID &lt; giGarrisonArraySize; iSrcGarrisonID++ )
<a name="l02612"></a>02612       { <span class="comment">//go through the garrisons</span>
<a name="l02613"></a>02613             <a class="code" href="Strategic_01AI_8cpp.html#c9af29ba59f70cabda683c1d3e7de1d0">RecalculateGarrisonWeight</a>( iSrcGarrisonID );
<a name="l02614"></a>02614             iWeight = -<a class="code" href="AI_01Viewer_8cpp.html#a9f940d7f3a6d6698bfaeb7c747d74a9">gGarrisonGroup</a>[ iSrcGarrisonID ].<a class="code" href="structGARRISON__GROUP.html#54fcf91b97b56e3cc75ef302b34ecf48">bWeight</a>;
<a name="l02615"></a>02615             <span class="keywordflow">if</span>( iWeight &gt; 0 &amp;&amp; <a class="code" href="Strategic_01AI_8cpp.html#54faeb29802e301239709cc407576cd1">GarrisonCanProvideMinimumReinforcements</a>( iSrcGarrisonID ) )
<a name="l02616"></a>02616             { <span class="comment">//if group is able to provide reinforcements.</span>
<a name="l02617"></a>02617                   iReinforcementsAvailable = <a class="code" href="Strategic_01AI_8cpp.html#935cd00b37d3ecb937347a7d5ed379d0">ReinforcementsAvailable</a>( iSrcGarrisonID );
<a name="l02618"></a>02618                   <span class="keywordflow">if</span>( iReinforcementsAvailable * 100 &gt;= iReinforcementsRequested * 67 )
<a name="l02619"></a>02619                   { <span class="comment">//This is the approved group to provide the reinforcements.</span>
<a name="l02620"></a>02620                         <span class="keywordflow">return</span> iSrcGarrisonID;
<a name="l02621"></a>02621                   }
<a name="l02622"></a>02622             }
<a name="l02623"></a>02623       }
<a name="l02624"></a>02624 
<a name="l02625"></a>02625       <span class="comment">//Well, if we get this far, the queen must be low on troops.  Send whatever we can.</span>
<a name="l02626"></a>02626       iRandom = <a class="code" href="Random_8cpp.html#49f938d1313ab6ef09ac6223a16ac334">Random</a>( <a class="code" href="AI_01Viewer_8cpp.html#a54cf2087c7e1b790053295a6bf90592">giReinforcementPoints</a> );
<a name="l02627"></a>02627       <span class="keywordflow">for</span>( iSrcGarrisonID = 0; iSrcGarrisonID &lt; giGarrisonArraySize; iSrcGarrisonID++ )
<a name="l02628"></a>02628       { <span class="comment">//go through the garrisons</span>
<a name="l02629"></a>02629             <a class="code" href="Strategic_01AI_8cpp.html#c9af29ba59f70cabda683c1d3e7de1d0">RecalculateGarrisonWeight</a>( iSrcGarrisonID );
<a name="l02630"></a>02630             iWeight = -<a class="code" href="AI_01Viewer_8cpp.html#a9f940d7f3a6d6698bfaeb7c747d74a9">gGarrisonGroup</a>[ iSrcGarrisonID ].<a class="code" href="structGARRISON__GROUP.html#54fcf91b97b56e3cc75ef302b34ecf48">bWeight</a>;
<a name="l02631"></a>02631             <span class="keywordflow">if</span>( iWeight &gt; 0 &amp;&amp; <a class="code" href="Strategic_01AI_8cpp.html#54faeb29802e301239709cc407576cd1">GarrisonCanProvideMinimumReinforcements</a>( iSrcGarrisonID ) )
<a name="l02632"></a>02632             { <span class="comment">//if group is able to provide reinforcements.</span>
<a name="l02633"></a>02633                   <span class="keywordflow">if</span>( iRandom &lt; iWeight )
<a name="l02634"></a>02634                   {
<a name="l02635"></a>02635                         iReinforcementsAvailable = <a class="code" href="Strategic_01AI_8cpp.html#935cd00b37d3ecb937347a7d5ed379d0">ReinforcementsAvailable</a>( iSrcGarrisonID );
<a name="l02636"></a>02636                         <span class="keywordflow">return</span> iSrcGarrisonID;
<a name="l02637"></a>02637                   }
<a name="l02638"></a>02638                   iRandom -= iWeight;
<a name="l02639"></a>02639             }
<a name="l02640"></a>02640       }
<a name="l02641"></a>02641 
<a name="l02642"></a>02642       <span class="comment">//Failed completely.</span>
<a name="l02643"></a>02643       <span class="keywordflow">return</span> -1;
<a name="l02644"></a>02644 }
<a name="l02645"></a>02645 
<a name="l02646"></a><a class="code" href="Strategic_01AI_8cpp.html#a5149c8e5d77cd98583fe9f8abf93657">02646</a> <span class="keywordtype">void</span> <a class="code" href="Strategic_01AI_8cpp.html#a5149c8e5d77cd98583fe9f8abf93657">SendReinforcementsForGarrison</a>( <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a> iDstGarrisonID, <a class="code" href="Types_8h.html#09f1a1fb2293e33483cc8d44aefb1eb1">UINT16</a> usDefencePoints, <a class="code" href="structGROUP.html">GROUP</a> **pOptionalGroup )
<a name="l02647"></a>02647 {
<a name="l02648"></a>02648       <a class="code" href="structSECTORINFO.html">SECTORINFO</a> *pSector;
<a name="l02649"></a>02649       <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a> iChance, iRandom, iSrcGarrisonID;
<a name="l02650"></a>02650       <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a> iMaxReinforcementsAllowed, iReinforcementsAvailable, iReinforcementsRequested, iReinforcementsApproved;
<a name="l02651"></a>02651       <a class="code" href="structGROUP.html">GROUP</a> *pGroup;
<a name="l02652"></a>02652       <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubSrcSectorX, ubSrcSectorY, ubDstSectorX, ubDstSectorY;
<a name="l02653"></a>02653       <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubNumExtraReinforcements;
<a name="l02654"></a>02654       <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubGroupSize;
<a name="l02655"></a>02655       <a class="code" href="Types_8h.html#112e3146cb38b6ee95e64d85842e380a">BOOLEAN</a> fLimitMaxTroopsAllowable = FALSE;
<a name="l02656"></a>02656 
<a name="l02657"></a>02657       <a class="code" href="Strategic_01AI_8cpp.html#75d774eb03c41b5fe422edfef6e445d4">ValidateWeights</a>( 8 );
<a name="l02658"></a>02658 
<a name="l02659"></a>02659       <span class="keywordflow">if</span>( <a class="code" href="AI_01Viewer_8cpp.html#a9f940d7f3a6d6698bfaeb7c747d74a9">gGarrisonGroup</a>[ iDstGarrisonID ].ubSectorID == <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c66026436d911e0461303edb9fe227735f787c22">SEC_B13</a> ||
<a name="l02660"></a>02660               <a class="code" href="AI_01Viewer_8cpp.html#a9f940d7f3a6d6698bfaeb7c747d74a9">gGarrisonGroup</a>[ iDstGarrisonID ].ubSectorID == <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643e84863fb1442cf38c7311021990a9bc3">SEC_C13</a> ||
<a name="l02661"></a>02661               <a class="code" href="AI_01Viewer_8cpp.html#a9f940d7f3a6d6698bfaeb7c747d74a9">gGarrisonGroup</a>[ iDstGarrisonID ].ubSectorID == <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c66026435b0fbd8598540769dcf8f24e3134f48c">SEC_D13</a> )
<a name="l02662"></a>02662       {
<a name="l02663"></a>02663             pSector = NULL;
<a name="l02664"></a>02664       }
<a name="l02665"></a>02665       pSector = &amp;<a class="code" href="Campaign_01Types_8h.html#d83c6f699f17a47cf6a662c91d959126">SectorInfo</a>[ <a class="code" href="AI_01Viewer_8cpp.html#a9f940d7f3a6d6698bfaeb7c747d74a9">gGarrisonGroup</a>[ iDstGarrisonID ].<a class="code" href="structGARRISON__GROUP.html#fb130d3c9211374d87a85cca787fe0dd">ubSectorID</a> ];
<a name="l02666"></a>02666       <span class="comment">//Determine how many units the garrison needs.</span>
<a name="l02667"></a>02667       iReinforcementsRequested = <a class="code" href="Strategic_01AI_8cpp.html#9ea9c2599dfa6834825e1e022d3be6c1">GarrisonReinforcementsRequested</a>( iDstGarrisonID, &amp;ubNumExtraReinforcements );
<a name="l02668"></a>02668 
<a name="l02669"></a>02669       <span class="comment">//The maximum number of reinforcements can't be offsetted past a certain point based on the </span>
<a name="l02670"></a>02670       <span class="comment">//priority of the garrison.</span>
<a name="l02671"></a>02671       iMaxReinforcementsAllowed = <span class="comment">//from 1 to 3 times the desired size of the normal force.</span>
<a name="l02672"></a>02672             <a class="code" href="AI_01Viewer_8cpp.html#77e448d1f208bd120f861571e6d0098f">gArmyComp</a>[ gGarrisonGroup[ iDstGarrisonID ].ubComposition ].<a class="code" href="structARMY__COMPOSITION.html#164db6c6c30629f43d42469671367c86">bDesiredPopulation</a> + 
<a name="l02673"></a>02673             <a class="code" href="AI_01Viewer_8cpp.html#77e448d1f208bd120f861571e6d0098f">gArmyComp</a>[ gGarrisonGroup[ iDstGarrisonID ].ubComposition ].<a class="code" href="structARMY__COMPOSITION.html#164db6c6c30629f43d42469671367c86">bDesiredPopulation</a> * 
<a name="l02674"></a>02674             <a class="code" href="AI_01Viewer_8cpp.html#77e448d1f208bd120f861571e6d0098f">gArmyComp</a>[ gGarrisonGroup[ iDstGarrisonID ].ubComposition ].<a class="code" href="structARMY__COMPOSITION.html#ae9820933dc13e0351dbd9fe1daf8ab4">bPriority</a> / 50;
<a name="l02675"></a>02675 
<a name="l02676"></a>02676       <span class="keywordflow">if</span>( iReinforcementsRequested + ubNumExtraReinforcements &gt; iMaxReinforcementsAllowed )
<a name="l02677"></a>02677       { <span class="comment">//adjust the extra reinforcements so that it doesn't exceed the maximum allowed.</span>
<a name="l02678"></a>02678             fLimitMaxTroopsAllowable = TRUE;
<a name="l02679"></a>02679             ubNumExtraReinforcements = (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)(iMaxReinforcementsAllowed - iReinforcementsRequested);
<a name="l02680"></a>02680       }
<a name="l02681"></a>02681 
<a name="l02682"></a>02682       iReinforcementsRequested += ubNumExtraReinforcements;
<a name="l02683"></a>02683 
<a name="l02684"></a>02684       <span class="keywordflow">if</span>( iReinforcementsRequested &lt;= 0 )
<a name="l02685"></a>02685       {
<a name="l02686"></a>02686             <a class="code" href="Strategic_01AI_8cpp.html#75d774eb03c41b5fe422edfef6e445d4">ValidateWeights</a>( 9 );
<a name="l02687"></a>02687             <span class="keywordflow">return</span>;
<a name="l02688"></a>02688       }
<a name="l02689"></a>02689 
<a name="l02690"></a>02690       ubDstSectorX = (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)SECTORX( gGarrisonGroup[ iDstGarrisonID ].ubSectorID );
<a name="l02691"></a>02691       ubDstSectorY = (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)SECTORY( gGarrisonGroup[ iDstGarrisonID ].ubSectorID );
<a name="l02692"></a>02692 
<a name="l02693"></a>02693       <span class="keywordflow">if</span>( pOptionalGroup &amp;&amp; *pOptionalGroup )
<a name="l02694"></a>02694       { <span class="comment">//This group will provide the reinforcements</span>
<a name="l02695"></a>02695             pGroup = *pOptionalGroup;
<a name="l02696"></a>02696 
<a name="l02697"></a>02697 <span class="preprocessor">            #ifdef JA2BETAVERSION</span>
<a name="l02698"></a>02698 <span class="preprocessor"></span>                  <a class="code" href="Strategic_01AI_8cpp.html#984e97af1f29d3b417cc5bdcd126cfca">LogStrategicEvent</a>( <span class="stringliteral">"%d troops have been reassigned from %c%d to garrison sector %c%d"</span>, 
<a name="l02699"></a>02699                         pGroup-&gt;<a class="code" href="structGROUP.html#f82ff4c3e504e4bb10feb65491f79471">pEnemyGroup</a>-&gt;<a class="code" href="structENEMYGROUP.html#27eaaea857408bc6c6358054c19f2d07">ubNumTroops</a> + pGroup-&gt;<a class="code" href="structGROUP.html#f82ff4c3e504e4bb10feb65491f79471">pEnemyGroup</a>-&gt;<a class="code" href="structENEMYGROUP.html#5f20a703a3c536505126979265b10558">ubNumElites</a> + pGroup-&gt;<a class="code" href="structGROUP.html#f82ff4c3e504e4bb10feb65491f79471">pEnemyGroup</a>-&gt;<a class="code" href="structENEMYGROUP.html#61d6f824f39709580afa7a81317e241b">ubNumAdmins</a>, 
<a name="l02700"></a>02700                         pGroup-&gt;<a class="code" href="structGROUP.html#11cd63715d9daf1488cca330690db007">ubSectorY</a> + <span class="charliteral">'A'</span> - 1, pGroup-&gt;<a class="code" href="structGROUP.html#eee29372e834112984eab1dc714466c0">ubSectorX</a>, 
<a name="l02701"></a>02701                         ubDstSectorY + <span class="charliteral">'A'</span> - 1, ubDstSectorX );
<a name="l02702"></a>02702 <span class="preprocessor">            #endif</span>
<a name="l02703"></a>02703 <span class="preprocessor"></span>
<a name="l02704"></a>02704             gGarrisonGroup[ iDstGarrisonID ].ubPendingGroupID = pGroup-&gt;<a class="code" href="structGROUP.html#9149379b9355afda87a382af5a88d728">ubGroupID</a>;
<a name="l02705"></a>02705             <a class="code" href="Strategic_01AI_8cpp.html#d4c479be89206291565d9795d7515967">ConvertGroupTroopsToComposition</a>( pGroup, gGarrisonGroup[ iDstGarrisonID ].ubComposition );
<a name="l02706"></a>02706             <a class="code" href="Strategic_01AI_8cpp.html#3865b55f00d5df7710bd4325ddf83bfc">MoveSAIGroupToSector</a>( pOptionalGroup, gGarrisonGroup[ iDstGarrisonID ].ubSectorID, <a class="code" href="Strategic_01AI_8cpp.html#2282261c2887b2d4d1183cf5249e1529abdf346cfc40be1a014cf4295888c888">STAGE</a>, <a class="code" href="Strategic_01Movement_8h.html#b59c1bec446b10af208f977a871d910b095b1f433b659c686164f67bb7b89cb1">REINFORCEMENTS</a> );
<a name="l02707"></a>02707 
<a name="l02708"></a>02708             <a class="code" href="Strategic_01AI_8cpp.html#75d774eb03c41b5fe422edfef6e445d4">ValidateWeights</a>( 10 );
<a name="l02709"></a>02709 
<a name="l02710"></a>02710             <span class="keywordflow">return</span>;
<a name="l02711"></a>02711       }
<a name="l02712"></a>02712       iRandom = <a class="code" href="Random_8cpp.html#49f938d1313ab6ef09ac6223a16ac334">Random</a>( <a class="code" href="AI_01Viewer_8cpp.html#a54cf2087c7e1b790053295a6bf90592">giReinforcementPoints</a> + <a class="code" href="AI_01Viewer_8cpp.html#c86cd58021961af10f1eb15108a79023">giReinforcementPool</a> );
<a name="l02713"></a>02713       <span class="keywordflow">if</span>( iRandom &lt; <a class="code" href="AI_01Viewer_8cpp.html#c86cd58021961af10f1eb15108a79023">giReinforcementPool</a> )
<a name="l02714"></a>02714       { <span class="comment">//use the pool and send the requested amount from SECTOR P3 (queen's palace)</span>
<a name="l02715"></a>02715             QUEEN_POOL:
<a name="l02716"></a>02716 
<a name="l02717"></a>02717             <span class="comment">//KM : Sep 9, 1999</span>
<a name="l02718"></a>02718             <span class="comment">//If the player owns sector P3, any troops that spawned there were causing serious problems, seeing battle checks</span>
<a name="l02719"></a>02719             <span class="comment">//were not performed!</span>
<a name="l02720"></a>02720             <span class="keywordflow">if</span>( !<a class="code" href="strategic_8cpp.html#6f48fb0ea28e3d4889423290f1a6ede8">StrategicMap</a>[ CALCULATE_STRATEGIC_INDEX( 3, 16 ) ].fEnemyControlled )
<a name="l02721"></a>02721             { <span class="comment">//Queen can no longer send reinforcements from the palace if she doesn't control it!</span>
<a name="l02722"></a>02722                   <span class="keywordflow">return</span>;
<a name="l02723"></a>02723             }
<a name="l02724"></a>02724 
<a name="l02725"></a>02725 
<a name="l02726"></a>02726             <span class="keywordflow">if</span>( !<a class="code" href="AI_01Viewer_8cpp.html#c86cd58021961af10f1eb15108a79023">giReinforcementPool</a> )
<a name="l02727"></a>02727             {
<a name="l02728"></a>02728                   <a class="code" href="Strategic_01AI_8cpp.html#75d774eb03c41b5fe422edfef6e445d4">ValidateWeights</a>( 11 );
<a name="l02729"></a>02729                   <span class="keywordflow">return</span>;
<a name="l02730"></a>02730             }
<a name="l02731"></a>02731             iReinforcementsApproved = min( iReinforcementsRequested, <a class="code" href="AI_01Viewer_8cpp.html#c86cd58021961af10f1eb15108a79023">giReinforcementPool</a> );
<a name="l02732"></a>02732 
<a name="l02733"></a>02733             <span class="keywordflow">if</span>( iReinforcementsApproved * 3 &lt; usDefencePoints )
<a name="l02734"></a>02734             { <span class="comment">//The enemy force that would be sent would likely be decimated by the player forces.</span>
<a name="l02735"></a>02735                   <a class="code" href="Strategic_01AI_8cpp.html#9bc393a708632bfedc7ce82ab9268709">gubGarrisonReinforcementsDenied</a>[ iDstGarrisonID ] += (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)(<a class="code" href="AI_01Viewer_8cpp.html#77e448d1f208bd120f861571e6d0098f">gArmyComp</a>[ gGarrisonGroup[ iDstGarrisonID ].ubComposition ].bPriority / 2);
<a name="l02736"></a>02736                   <a class="code" href="Strategic_01AI_8cpp.html#75d774eb03c41b5fe422edfef6e445d4">ValidateWeights</a>( 12 );
<a name="l02737"></a>02737                   <span class="keywordflow">return</span>;
<a name="l02738"></a>02738             }
<a name="l02739"></a>02739             <span class="keywordflow">else</span>
<a name="l02740"></a>02740             { 
<a name="l02741"></a>02741                   <span class="comment">//The force is strong enough to be able to take the sector.</span>
<a name="l02742"></a>02742                   <a class="code" href="Strategic_01AI_8cpp.html#9bc393a708632bfedc7ce82ab9268709">gubGarrisonReinforcementsDenied</a>[ iDstGarrisonID ] = 0;
<a name="l02743"></a>02743             }
<a name="l02744"></a>02744             
<a name="l02745"></a>02745             <span class="comment">//The chance she will send them is related with the strength difference between the</span>
<a name="l02746"></a>02746             <span class="comment">//player's force and the queen's.</span>
<a name="l02747"></a>02747             <span class="keywordflow">if</span>( ubNumExtraReinforcements &amp;&amp; fLimitMaxTroopsAllowable &amp;&amp; iReinforcementsApproved == iMaxReinforcementsAllowed )
<a name="l02748"></a>02748             {                 
<a name="l02749"></a>02749                   iChance = (iReinforcementsApproved + ubNumExtraReinforcements) * 100 / max(usDefencePoints, 1); <span class="comment">// lal bugfix: max 1 added to prevent division by 0</span>
<a name="l02750"></a>02750                   <span class="keywordflow">if</span>( !<a class="code" href="Random_8cpp.html#742221657b584d8416ada22fa8ff23dd">Chance</a>( iChance ) )
<a name="l02751"></a>02751                   {
<a name="l02752"></a>02752                         <a class="code" href="Strategic_01AI_8cpp.html#75d774eb03c41b5fe422edfef6e445d4">ValidateWeights</a>( 13 );
<a name="l02753"></a>02753                         <span class="keywordflow">return</span>;
<a name="l02754"></a>02754                   }
<a name="l02755"></a>02755             }
<a name="l02756"></a>02756 
<a name="l02757"></a>02757 
<a name="l02758"></a>02758             pGroup = <a class="code" href="Strategic_01Movement_8cpp.html#a6ac42d3d57b37a44bc39b3cd55ec008">CreateNewEnemyGroupDepartingFromSector</a>( <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c66026438a2eb9999a6ad7c69c9ddbe2d95696ca">SEC_P3</a>, 0, (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)iReinforcementsApproved, 0 );
<a name="l02759"></a>02759             <a class="code" href="Strategic_01AI_8cpp.html#d4c479be89206291565d9795d7515967">ConvertGroupTroopsToComposition</a>( pGroup, gGarrisonGroup[ iDstGarrisonID ].ubComposition );
<a name="l02760"></a>02760             pGroup-&gt;<a class="code" href="structGROUP.html#40901f132b0b6aeedeb9ad99cceb0d38">ubOriginalSector</a> = (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)SECTOR( ubDstSectorX, ubDstSectorY );
<a name="l02761"></a>02761             <span class="comment">//Madd: unlimited reinforcements?</span>
<a name="l02762"></a>02762             <span class="keywordflow">if</span> ( !<a class="code" href="Strategic_01AI_8cpp.html#b0c12688f38630da4e064c85394ca570">gfUnlimitedTroops</a> )
<a name="l02763"></a>02763                   <a class="code" href="AI_01Viewer_8cpp.html#c86cd58021961af10f1eb15108a79023">giReinforcementPool</a> -= iReinforcementsApproved;
<a name="l02764"></a>02764       
<a name="l02765"></a>02765             pGroup-&gt;<a class="code" href="structGROUP.html#d11970aeea229972cf65f9f169e90451">ubMoveType</a> = <a class="code" href="Strategic_01Movement_8h.html#456ac33d49271d3e2c371351cd1d637147c377372bfc5fcfc2f8a70afb906a04">ONE_WAY</a>;
<a name="l02766"></a>02766             gGarrisonGroup[ iDstGarrisonID ].ubPendingGroupID = pGroup-&gt;<a class="code" href="structGROUP.html#9149379b9355afda87a382af5a88d728">ubGroupID</a>;
<a name="l02767"></a>02767 
<a name="l02768"></a>02768             ubGroupSize = (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)(pGroup-&gt;<a class="code" href="structGROUP.html#f82ff4c3e504e4bb10feb65491f79471">pEnemyGroup</a>-&gt;<a class="code" href="structENEMYGROUP.html#27eaaea857408bc6c6358054c19f2d07">ubNumTroops</a> + pGroup-&gt;<a class="code" href="structGROUP.html#f82ff4c3e504e4bb10feb65491f79471">pEnemyGroup</a>-&gt;<a class="code" href="structENEMYGROUP.html#5f20a703a3c536505126979265b10558">ubNumElites</a> + pGroup-&gt;<a class="code" href="structGROUP.html#f82ff4c3e504e4bb10feb65491f79471">pEnemyGroup</a>-&gt;<a class="code" href="structENEMYGROUP.html#61d6f824f39709580afa7a81317e241b">ubNumAdmins</a>);
<a name="l02769"></a>02769                         
<a name="l02770"></a>02770             <span class="keywordflow">if</span>( ubNumExtraReinforcements )
<a name="l02771"></a>02771             {
<a name="l02772"></a>02772 <span class="preprocessor">                  #ifdef JA2BETAVERSION</span>
<a name="l02773"></a>02773 <span class="preprocessor"></span>                        <a class="code" href="Strategic_01AI_8cpp.html#984e97af1f29d3b417cc5bdcd126cfca">LogStrategicEvent</a>( <span class="stringliteral">"%d troops have been sent from palace to stage assault near sector %c%d"</span>, 
<a name="l02774"></a>02774                               ubGroupSize, ubDstSectorY + <span class="charliteral">'A'</span> - 1, ubDstSectorX );
<a name="l02775"></a>02775 <span class="preprocessor">                  #endif</span>
<a name="l02776"></a>02776 <span class="preprocessor"></span>                  
<a name="l02777"></a>02777                   <a class="code" href="Strategic_01AI_8cpp.html#3865b55f00d5df7710bd4325ddf83bfc">MoveSAIGroupToSector</a>( &amp;pGroup, gGarrisonGroup[ iDstGarrisonID ].ubSectorID, <a class="code" href="Strategic_01AI_8cpp.html#2282261c2887b2d4d1183cf5249e1529abdf346cfc40be1a014cf4295888c888">STAGE</a>, <a class="code" href="Strategic_01Movement_8h.html#b59c1bec446b10af208f977a871d910bcbb2b107ee4dddeb7f82aa7b3058cf04">STAGING</a> );
<a name="l02778"></a>02778             }
<a name="l02779"></a>02779             <span class="keywordflow">else</span>
<a name="l02780"></a>02780             {
<a name="l02781"></a>02781 <span class="preprocessor">                  #ifdef JA2BETAVERSION</span>
<a name="l02782"></a>02782 <span class="preprocessor"></span>                        <a class="code" href="Strategic_01AI_8cpp.html#984e97af1f29d3b417cc5bdcd126cfca">LogStrategicEvent</a>( <span class="stringliteral">"%d troops have been sent from palace to garrison sector %c%d"</span>, 
<a name="l02783"></a>02783                               ubGroupSize, ubDstSectorY + <span class="charliteral">'A'</span> - 1, ubDstSectorX );
<a name="l02784"></a>02784 <span class="preprocessor">                  #endif</span>
<a name="l02785"></a>02785 <span class="preprocessor"></span>
<a name="l02786"></a>02786                   <a class="code" href="Strategic_01AI_8cpp.html#3865b55f00d5df7710bd4325ddf83bfc">MoveSAIGroupToSector</a>( &amp;pGroup, gGarrisonGroup[ iDstGarrisonID ].ubSectorID, <a class="code" href="Strategic_01AI_8cpp.html#2282261c2887b2d4d1183cf5249e1529abdf346cfc40be1a014cf4295888c888">STAGE</a>, <a class="code" href="Strategic_01Movement_8h.html#b59c1bec446b10af208f977a871d910b095b1f433b659c686164f67bb7b89cb1">REINFORCEMENTS</a> );
<a name="l02787"></a>02787             }
<a name="l02788"></a>02788             <a class="code" href="Strategic_01AI_8cpp.html#75d774eb03c41b5fe422edfef6e445d4">ValidateWeights</a>( 14 );
<a name="l02789"></a>02789             <span class="keywordflow">return</span>;
<a name="l02790"></a>02790       }
<a name="l02791"></a>02791       <span class="keywordflow">else</span> 
<a name="l02792"></a>02792       {
<a name="l02793"></a>02793             iSrcGarrisonID = <a class="code" href="Strategic_01AI_8cpp.html#4c4e87c375eba1c81104c0d50d41e902">ChooseSuitableGarrisonToProvideReinforcements</a>( iDstGarrisonID, iReinforcementsRequested );
<a name="l02794"></a>02794             <span class="keywordflow">if</span>( iSrcGarrisonID == -1 )
<a name="l02795"></a>02795             {
<a name="l02796"></a>02796                   <a class="code" href="Strategic_01AI_8cpp.html#75d774eb03c41b5fe422edfef6e445d4">ValidateWeights</a>( 15 );
<a name="l02797"></a>02797                   <span class="keywordflow">goto</span> QUEEN_POOL;
<a name="l02798"></a>02798             }
<a name="l02799"></a>02799 
<a name="l02800"></a>02800             ubSrcSectorX = (gGarrisonGroup[ iSrcGarrisonID ].ubSectorID % 16) + 1;
<a name="l02801"></a>02801             ubSrcSectorY = (gGarrisonGroup[ iSrcGarrisonID ].ubSectorID / 16) + 1;
<a name="l02802"></a>02802             <span class="keywordflow">if</span>( ubSrcSectorX != <a class="code" href="strategicmap_8cpp.html#49d9aed144a633fda4ba1990f002d703">gWorldSectorX</a> || ubSrcSectorY != <a class="code" href="strategicmap_8cpp.html#ea322310ced0e35ee18a2ee7b32aac5b">gWorldSectorY</a> || <a class="code" href="strategicmap_8cpp.html#da715721a8ceedd42acf6ddb33e63ce0">gbWorldSectorZ</a> &gt; 0 )
<a name="l02803"></a>02803             { <span class="comment">//The reinforcements aren't coming from the currently loaded sector!</span>
<a name="l02804"></a>02804                   iReinforcementsAvailable = <a class="code" href="Strategic_01AI_8cpp.html#935cd00b37d3ecb937347a7d5ed379d0">ReinforcementsAvailable</a>( iSrcGarrisonID );
<a name="l02805"></a>02805                   <span class="keywordflow">if</span>( iReinforcementsAvailable &lt;= 0)
<a name="l02806"></a>02806                   {
<a name="l02807"></a>02807                         <a class="code" href="Strategic_01AI_8cpp.html#8690badaeb456b31a18dda93bcc1d8df">SAIReportError</a>( L<span class="stringliteral">"Attempting to send reinforcements from a garrison that doesn't have any! -- KM:0 (with prior saved game and strategic decisions.txt)"</span> );
<a name="l02808"></a>02808                         <span class="keywordflow">return</span>;
<a name="l02809"></a>02809                   }
<a name="l02810"></a>02810                   <span class="comment">//Send the lowest of the two:  number requested or number available</span>
<a name="l02811"></a>02811 
<a name="l02812"></a>02812                   iReinforcementsApproved = min( iReinforcementsRequested, iReinforcementsAvailable );
<a name="l02813"></a>02813                   <span class="keywordflow">if</span>( iReinforcementsApproved &gt; iMaxReinforcementsAllowed - ubNumExtraReinforcements )
<a name="l02814"></a>02814                   { <span class="comment">//The force isn't strong enough, but the queen isn't willing to apply extra resources</span>
<a name="l02815"></a>02815                         iReinforcementsApproved = iMaxReinforcementsAllowed - ubNumExtraReinforcements;
<a name="l02816"></a>02816                   }
<a name="l02817"></a>02817                   <span class="keywordflow">else</span> <span class="keywordflow">if</span>( (iReinforcementsApproved + ubNumExtraReinforcements) * 3 &lt; usDefencePoints )
<a name="l02818"></a>02818                   { <span class="comment">//The enemy force that would be sent would likely be decimated by the player forces.</span>
<a name="l02819"></a>02819                         <a class="code" href="Strategic_01AI_8cpp.html#9bc393a708632bfedc7ce82ab9268709">gubGarrisonReinforcementsDenied</a>[ iDstGarrisonID ] += (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)(<a class="code" href="AI_01Viewer_8cpp.html#77e448d1f208bd120f861571e6d0098f">gArmyComp</a>[ gGarrisonGroup[ iDstGarrisonID ].ubComposition ].bPriority / 2);
<a name="l02820"></a>02820                         <a class="code" href="Strategic_01AI_8cpp.html#75d774eb03c41b5fe422edfef6e445d4">ValidateWeights</a>( 17 );
<a name="l02821"></a>02821                         <span class="keywordflow">return</span>;
<a name="l02822"></a>02822                   }
<a name="l02823"></a>02823                   <span class="keywordflow">else</span>
<a name="l02824"></a>02824                   { 
<a name="l02825"></a>02825                         <span class="comment">//The force is strong enough to be able to take the sector.</span>
<a name="l02826"></a>02826                         <a class="code" href="Strategic_01AI_8cpp.html#9bc393a708632bfedc7ce82ab9268709">gubGarrisonReinforcementsDenied</a>[ iDstGarrisonID ] = 0;
<a name="l02827"></a>02827                   }
<a name="l02828"></a>02828 
<a name="l02829"></a>02829                   <span class="comment">//The chance she will send them is related with the strength difference between the</span>
<a name="l02830"></a>02830                   <span class="comment">//player's force and the queen's.</span>
<a name="l02831"></a>02831                   <span class="keywordflow">if</span>( iReinforcementsApproved + ubNumExtraReinforcements == iMaxReinforcementsAllowed &amp;&amp; usDefencePoints )
<a name="l02832"></a>02832                   {                       
<a name="l02833"></a>02833                         iChance = (iReinforcementsApproved + ubNumExtraReinforcements) * 100 / max(usDefencePoints, 1); <span class="comment">// lal bugfix: max 1 added to prevent division by 0</span>
<a name="l02834"></a>02834                         <span class="keywordflow">if</span>( !<a class="code" href="Random_8cpp.html#742221657b584d8416ada22fa8ff23dd">Chance</a>( iChance ) )
<a name="l02835"></a>02835                         {
<a name="l02836"></a>02836                               <a class="code" href="Strategic_01AI_8cpp.html#75d774eb03c41b5fe422edfef6e445d4">ValidateWeights</a>( 18 );
<a name="l02837"></a>02837                               <span class="keywordflow">return</span>;
<a name="l02838"></a>02838                         }
<a name="l02839"></a>02839                   }
<a name="l02840"></a>02840 
<a name="l02841"></a>02841                   pGroup = <a class="code" href="Strategic_01Movement_8cpp.html#a6ac42d3d57b37a44bc39b3cd55ec008">CreateNewEnemyGroupDepartingFromSector</a>( gGarrisonGroup[ iSrcGarrisonID ].ubSectorID, 0, (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)iReinforcementsApproved, 0 );
<a name="l02842"></a>02842                   <a class="code" href="Strategic_01AI_8cpp.html#d4c479be89206291565d9795d7515967">ConvertGroupTroopsToComposition</a>( pGroup, gGarrisonGroup[ iDstGarrisonID ].ubComposition );
<a name="l02843"></a>02843                   <a class="code" href="Strategic_01AI_8cpp.html#b07cff54af372d6ec184957cb7b51266">RemoveSoldiersFromGarrisonBasedOnComposition</a>( iSrcGarrisonID, pGroup-&gt;<a class="code" href="structGROUP.html#2a98517c894019ee794e04ea05d1aeaf">ubGroupSize</a> );
<a name="l02844"></a>02844                   pGroup-&gt;<a class="code" href="structGROUP.html#40901f132b0b6aeedeb9ad99cceb0d38">ubOriginalSector</a> = (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)SECTOR( ubDstSectorX, ubDstSectorY );
<a name="l02845"></a>02845                   pGroup-&gt;<a class="code" href="structGROUP.html#d11970aeea229972cf65f9f169e90451">ubMoveType</a> = <a class="code" href="Strategic_01Movement_8h.html#456ac33d49271d3e2c371351cd1d637147c377372bfc5fcfc2f8a70afb906a04">ONE_WAY</a>;
<a name="l02846"></a>02846                   gGarrisonGroup[ iDstGarrisonID ].ubPendingGroupID = pGroup-&gt;<a class="code" href="structGROUP.html#9149379b9355afda87a382af5a88d728">ubGroupID</a>;
<a name="l02847"></a>02847                   ubGroupSize = (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)( pGroup-&gt;<a class="code" href="structGROUP.html#f82ff4c3e504e4bb10feb65491f79471">pEnemyGroup</a>-&gt;<a class="code" href="structENEMYGROUP.html#27eaaea857408bc6c6358054c19f2d07">ubNumTroops</a> + pGroup-&gt;<a class="code" href="structGROUP.html#f82ff4c3e504e4bb10feb65491f79471">pEnemyGroup</a>-&gt;<a class="code" href="structENEMYGROUP.html#5f20a703a3c536505126979265b10558">ubNumElites</a> + pGroup-&gt;<a class="code" href="structGROUP.html#f82ff4c3e504e4bb10feb65491f79471">pEnemyGroup</a>-&gt;<a class="code" href="structENEMYGROUP.html#61d6f824f39709580afa7a81317e241b">ubNumAdmins</a> );
<a name="l02848"></a>02848 
<a name="l02849"></a>02849                   <span class="keywordflow">if</span>( ubNumExtraReinforcements )
<a name="l02850"></a>02850                   {
<a name="l02851"></a>02851                         pGroup-&gt;<a class="code" href="structGROUP.html#f82ff4c3e504e4bb10feb65491f79471">pEnemyGroup</a>-&gt;<a class="code" href="structENEMYGROUP.html#a447d1ef7bb91286580af1f04bb4f4c2">ubPendingReinforcements</a> = ubNumExtraReinforcements;
<a name="l02852"></a>02852                         
<a name="l02853"></a>02853 <span class="preprocessor">                        #ifdef JA2BETAVERSION</span>
<a name="l02854"></a>02854 <span class="preprocessor"></span>                              <a class="code" href="Strategic_01AI_8cpp.html#984e97af1f29d3b417cc5bdcd126cfca">LogStrategicEvent</a>( <span class="stringliteral">"%d troops have been sent from sector %c%d to stage assault near sector %c%d"</span>, 
<a name="l02855"></a>02855                                     ubGroupSize, pGroup-&gt;<a class="code" href="structGROUP.html#11cd63715d9daf1488cca330690db007">ubSectorY</a> + <span class="charliteral">'A'</span> - 1, pGroup-&gt;<a class="code" href="structGROUP.html#eee29372e834112984eab1dc714466c0">ubSectorX</a>, ubDstSectorY + <span class="charliteral">'A'</span> - 1, ubDstSectorX );
<a name="l02856"></a>02856 <span class="preprocessor">                        #endif</span>
<a name="l02857"></a>02857 <span class="preprocessor"></span>
<a name="l02858"></a>02858                         <a class="code" href="Strategic_01AI_8cpp.html#3865b55f00d5df7710bd4325ddf83bfc">MoveSAIGroupToSector</a>( &amp;pGroup, gGarrisonGroup[ iDstGarrisonID ].ubSectorID, <a class="code" href="Strategic_01AI_8cpp.html#2282261c2887b2d4d1183cf5249e1529abdf346cfc40be1a014cf4295888c888">STAGE</a>, <a class="code" href="Strategic_01Movement_8h.html#b59c1bec446b10af208f977a871d910bcbb2b107ee4dddeb7f82aa7b3058cf04">STAGING</a> );
<a name="l02859"></a>02859                   }
<a name="l02860"></a>02860                   <span class="keywordflow">else</span>
<a name="l02861"></a>02861                   {
<a name="l02862"></a>02862 <span class="preprocessor">                        #ifdef JA2BETAVERSION</span>
<a name="l02863"></a>02863 <span class="preprocessor"></span>                              <a class="code" href="Strategic_01AI_8cpp.html#984e97af1f29d3b417cc5bdcd126cfca">LogStrategicEvent</a>( <span class="stringliteral">"%d troops have been sent from sector %c%d to garrison sector %c%d"</span>, 
<a name="l02864"></a>02864                                     ubGroupSize, pGroup-&gt;<a class="code" href="structGROUP.html#11cd63715d9daf1488cca330690db007">ubSectorY</a> + <span class="charliteral">'A'</span> - 1, pGroup-&gt;<a class="code" href="structGROUP.html#eee29372e834112984eab1dc714466c0">ubSectorX</a>, ubDstSectorY + <span class="charliteral">'A'</span> - 1, ubDstSectorX );
<a name="l02865"></a>02865 <span class="preprocessor">                        #endif</span>
<a name="l02866"></a>02866 <span class="preprocessor"></span>
<a name="l02867"></a>02867                         <a class="code" href="Strategic_01AI_8cpp.html#3865b55f00d5df7710bd4325ddf83bfc">MoveSAIGroupToSector</a>( &amp;pGroup, gGarrisonGroup[ iDstGarrisonID ].ubSectorID, <a class="code" href="Strategic_01AI_8cpp.html#2282261c2887b2d4d1183cf5249e1529abdf346cfc40be1a014cf4295888c888">STAGE</a>, <a class="code" href="Strategic_01Movement_8h.html#b59c1bec446b10af208f977a871d910b095b1f433b659c686164f67bb7b89cb1">REINFORCEMENTS</a> );
<a name="l02868"></a>02868                   }
<a name="l02869"></a>02869                   
<a name="l02870"></a>02870 <span class="preprocessor">                  #ifdef JA2BETAVERSION</span>
<a name="l02871"></a>02871 <span class="preprocessor"></span>                        <a class="code" href="Strategic_01AI_8cpp.html#984e97af1f29d3b417cc5bdcd126cfca">LogStrategicEvent</a>( <span class="stringliteral">"%d troops have been sent from garrison sector %c%d to patrol area near sector %c%d"</span>, 
<a name="l02872"></a>02872                               ubGroupSize, ubSrcSectorY + <span class="charliteral">'A'</span> - 1, ubSrcSectorX, ubDstSectorY + <span class="charliteral">'A'</span> - 1, ubDstSectorX );
<a name="l02873"></a>02873 <span class="preprocessor">                  #endif</span>
<a name="l02874"></a>02874 <span class="preprocessor"></span>      
<a name="l02875"></a>02875                   <a class="code" href="Strategic_01AI_8cpp.html#75d774eb03c41b5fe422edfef6e445d4">ValidateWeights</a>( 19 );
<a name="l02876"></a>02876                   <span class="keywordflow">return</span>;
<a name="l02877"></a>02877             }
<a name="l02878"></a>02878       }
<a name="l02879"></a>02879       <a class="code" href="Strategic_01AI_8cpp.html#75d774eb03c41b5fe422edfef6e445d4">ValidateWeights</a>( 20 );
<a name="l02880"></a>02880 }
<a name="l02881"></a>02881 
<a name="l02882"></a><a class="code" href="Strategic_01AI_8cpp.html#8b154858f03533e0134728bee6602276">02882</a> <span class="keywordtype">void</span> <a class="code" href="Strategic_01AI_8cpp.html#8b154858f03533e0134728bee6602276">SendReinforcementsForPatrol</a>( <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a> iPatrolID, <a class="code" href="structGROUP.html">GROUP</a> **pOptionalGroup )
<a name="l02883"></a>02883 {
<a name="l02884"></a>02884       <a class="code" href="structGROUP.html">GROUP</a> *pGroup;
<a name="l02885"></a>02885       <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a> iRandom, iSrcGarrisonID, iWeight;
<a name="l02886"></a>02886       <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a> iReinforcementsAvailable, iReinforcementsRequested, iReinforcementsApproved;
<a name="l02887"></a>02887       <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubSrcSectorX, ubSrcSectorY, ubDstSectorX, ubDstSectorY;
<a name="l02888"></a>02888 
<a name="l02889"></a>02889       <a class="code" href="Strategic_01AI_8cpp.html#75d774eb03c41b5fe422edfef6e445d4">ValidateWeights</a>( 21 );
<a name="l02890"></a>02890 
<a name="l02891"></a>02891       <span class="comment">//Determine how many units the patrol group needs.</span>
<a name="l02892"></a>02892       iReinforcementsRequested = <a class="code" href="Strategic_01AI_8cpp.html#cf54de770d965746c7db52bde17db11b">PatrolReinforcementsRequested</a>( iPatrolID );
<a name="l02893"></a>02893 
<a name="l02894"></a>02894       <span class="keywordflow">if</span>( iReinforcementsRequested &lt;= 0)
<a name="l02895"></a>02895             <span class="keywordflow">return</span>;
<a name="l02896"></a>02896       
<a name="l02897"></a>02897       ubDstSectorX = (<a class="code" href="Strategic_01AI_8cpp.html#9e00ccb0e77cec57208c519e8f831f53">gPatrolGroup</a>[ iPatrolID ].<a class="code" href="structPATROL__GROUP.html#aa87a39181c87771957f49a4a34709a2">ubSectorID</a>[1] % 16) + 1;
<a name="l02898"></a>02898       ubDstSectorY = (<a class="code" href="Strategic_01AI_8cpp.html#9e00ccb0e77cec57208c519e8f831f53">gPatrolGroup</a>[ iPatrolID ].<a class="code" href="structPATROL__GROUP.html#aa87a39181c87771957f49a4a34709a2">ubSectorID</a>[1] / 16) + 1;
<a name="l02899"></a>02899 
<a name="l02900"></a>02900       <span class="keywordflow">if</span>( pOptionalGroup &amp;&amp; *pOptionalGroup )
<a name="l02901"></a>02901       { <span class="comment">//This group will provide the reinforcements</span>
<a name="l02902"></a>02902             pGroup = *pOptionalGroup;
<a name="l02903"></a>02903 
<a name="l02904"></a>02904             <a class="code" href="Strategic_01AI_8cpp.html#9e00ccb0e77cec57208c519e8f831f53">gPatrolGroup</a>[ iPatrolID ].<a class="code" href="structPATROL__GROUP.html#85b82707f42868bcdd678a1d7ba9c257">ubPendingGroupID</a> = pGroup-&gt;<a class="code" href="structGROUP.html#9149379b9355afda87a382af5a88d728">ubGroupID</a>;
<a name="l02905"></a>02905 
<a name="l02906"></a>02906 <span class="preprocessor">            #ifdef JA2BETAVERSION</span>
<a name="l02907"></a>02907 <span class="preprocessor"></span>                  <a class="code" href="Strategic_01AI_8cpp.html#984e97af1f29d3b417cc5bdcd126cfca">LogStrategicEvent</a>( <span class="stringliteral">"%d troops have been reassigned from %c%d to reinforce patrol group covering sector %c%d"</span>, 
<a name="l02908"></a>02908                         pGroup-&gt;<a class="code" href="structGROUP.html#f82ff4c3e504e4bb10feb65491f79471">pEnemyGroup</a>-&gt;<a class="code" href="structENEMYGROUP.html#27eaaea857408bc6c6358054c19f2d07">ubNumTroops</a> + pGroup-&gt;<a class="code" href="structGROUP.html#f82ff4c3e504e4bb10feb65491f79471">pEnemyGroup</a>-&gt;<a class="code" href="structENEMYGROUP.html#5f20a703a3c536505126979265b10558">ubNumElites</a> + pGroup-&gt;<a class="code" href="structGROUP.html#f82ff4c3e504e4bb10feb65491f79471">pEnemyGroup</a>-&gt;<a class="code" href="structENEMYGROUP.html#61d6f824f39709580afa7a81317e241b">ubNumAdmins</a>, 
<a name="l02909"></a>02909                         pGroup-&gt;<a class="code" href="structGROUP.html#11cd63715d9daf1488cca330690db007">ubSectorY</a> + <span class="charliteral">'A'</span> - 1, pGroup-&gt;<a class="code" href="structGROUP.html#eee29372e834112984eab1dc714466c0">ubSectorX</a>, 
<a name="l02910"></a>02910                         ubDstSectorY + <span class="charliteral">'A'</span> - 1, ubDstSectorX );
<a name="l02911"></a>02911 <span class="preprocessor">            #endif</span>
<a name="l02912"></a>02912 <span class="preprocessor"></span>            
<a name="l02913"></a>02913             <a class="code" href="Strategic_01AI_8cpp.html#3865b55f00d5df7710bd4325ddf83bfc">MoveSAIGroupToSector</a>( pOptionalGroup, <a class="code" href="Strategic_01AI_8cpp.html#9e00ccb0e77cec57208c519e8f831f53">gPatrolGroup</a>[ iPatrolID ].ubSectorID[1], <a class="code" href="Strategic_01AI_8cpp.html#2282261c2887b2d4d1183cf5249e1529a4d4adb90ccd2b0775d4429cac476900">EVASIVE</a>, <a class="code" href="Strategic_01Movement_8h.html#b59c1bec446b10af208f977a871d910b095b1f433b659c686164f67bb7b89cb1">REINFORCEMENTS</a> );
<a name="l02914"></a>02914 
<a name="l02915"></a>02915             <a class="code" href="Strategic_01AI_8cpp.html#75d774eb03c41b5fe422edfef6e445d4">ValidateWeights</a>( 22 );
<a name="l02916"></a>02916             <span class="keywordflow">return</span>;
<a name="l02917"></a>02917       }
<a name="l02918"></a>02918       iRandom = <a class="code" href="Random_8cpp.html#49f938d1313ab6ef09ac6223a16ac334">Random</a>( <a class="code" href="AI_01Viewer_8cpp.html#a54cf2087c7e1b790053295a6bf90592">giReinforcementPoints</a> + <a class="code" href="AI_01Viewer_8cpp.html#c86cd58021961af10f1eb15108a79023">giReinforcementPool</a> );
<a name="l02919"></a>02919       <span class="keywordflow">if</span>( iRandom &lt; <a class="code" href="AI_01Viewer_8cpp.html#c86cd58021961af10f1eb15108a79023">giReinforcementPool</a> )
<a name="l02920"></a>02920       { <span class="comment">//use the pool and send the requested amount from SECTOR P3 (queen's palace)</span>
<a name="l02921"></a>02921             iReinforcementsApproved = min( iReinforcementsRequested, <a class="code" href="AI_01Viewer_8cpp.html#c86cd58021961af10f1eb15108a79023">giReinforcementPool</a> );
<a name="l02922"></a>02922             <span class="keywordflow">if</span>( !iReinforcementsApproved )
<a name="l02923"></a>02923             {
<a name="l02924"></a>02924                   iReinforcementsApproved = iReinforcementsApproved;
<a name="l02925"></a>02925             }
<a name="l02926"></a>02926             pGroup = <a class="code" href="Strategic_01Movement_8cpp.html#a6ac42d3d57b37a44bc39b3cd55ec008">CreateNewEnemyGroupDepartingFromSector</a>( <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c66026438a2eb9999a6ad7c69c9ddbe2d95696ca">SEC_P3</a>, 0, (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)iReinforcementsApproved, 0 );
<a name="l02927"></a>02927             pGroup-&gt;<a class="code" href="structGROUP.html#40901f132b0b6aeedeb9ad99cceb0d38">ubOriginalSector</a> = (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)SECTOR( ubDstSectorX, ubDstSectorY );
<a name="l02928"></a>02928 
<a name="l02929"></a>02929             <span class="comment">//Madd: unlimited reinforcements?</span>
<a name="l02930"></a>02930             <span class="keywordflow">if</span> ( !<a class="code" href="Strategic_01AI_8cpp.html#b0c12688f38630da4e064c85394ca570">gfUnlimitedTroops</a> )
<a name="l02931"></a>02931                   <a class="code" href="AI_01Viewer_8cpp.html#c86cd58021961af10f1eb15108a79023">giReinforcementPool</a> -= iReinforcementsApproved;
<a name="l02932"></a>02932 
<a name="l02933"></a>02933             <a class="code" href="Strategic_01AI_8cpp.html#9e00ccb0e77cec57208c519e8f831f53">gPatrolGroup</a>[ iPatrolID ].<a class="code" href="structPATROL__GROUP.html#85b82707f42868bcdd678a1d7ba9c257">ubPendingGroupID</a> = pGroup-&gt;<a class="code" href="structGROUP.html#9149379b9355afda87a382af5a88d728">ubGroupID</a>;
<a name="l02934"></a>02934 
<a name="l02935"></a>02935 <span class="preprocessor">            #ifdef JA2BETAVERSION</span>
<a name="l02936"></a>02936 <span class="preprocessor"></span>                  <a class="code" href="Strategic_01AI_8cpp.html#984e97af1f29d3b417cc5bdcd126cfca">LogStrategicEvent</a>( <span class="stringliteral">"%d troops have been sent from palace to patrol area near sector %c%d"</span>, 
<a name="l02937"></a>02937                         pGroup-&gt;<a class="code" href="structGROUP.html#f82ff4c3e504e4bb10feb65491f79471">pEnemyGroup</a>-&gt;<a class="code" href="structENEMYGROUP.html#27eaaea857408bc6c6358054c19f2d07">ubNumTroops</a> + pGroup-&gt;<a class="code" href="structGROUP.html#f82ff4c3e504e4bb10feb65491f79471">pEnemyGroup</a>-&gt;<a class="code" href="structENEMYGROUP.html#5f20a703a3c536505126979265b10558">ubNumElites</a> + pGroup-&gt;<a class="code" href="structGROUP.html#f82ff4c3e504e4bb10feb65491f79471">pEnemyGroup</a>-&gt;<a class="code" href="structENEMYGROUP.html#61d6f824f39709580afa7a81317e241b">ubNumAdmins</a>, 
<a name="l02938"></a>02938                         ubDstSectorY + <span class="charliteral">'A'</span> - 1, ubDstSectorX );
<a name="l02939"></a>02939 <span class="preprocessor">            #endif</span>
<a name="l02940"></a>02940 <span class="preprocessor"></span>            
<a name="l02941"></a>02941             <a class="code" href="Strategic_01AI_8cpp.html#3865b55f00d5df7710bd4325ddf83bfc">MoveSAIGroupToSector</a>( &amp;pGroup, <a class="code" href="Strategic_01AI_8cpp.html#9e00ccb0e77cec57208c519e8f831f53">gPatrolGroup</a>[ iPatrolID ].ubSectorID[1], <a class="code" href="Strategic_01AI_8cpp.html#2282261c2887b2d4d1183cf5249e1529a4d4adb90ccd2b0775d4429cac476900">EVASIVE</a>, <a class="code" href="Strategic_01Movement_8h.html#b59c1bec446b10af208f977a871d910b095b1f433b659c686164f67bb7b89cb1">REINFORCEMENTS</a> );
<a name="l02942"></a>02942 
<a name="l02943"></a>02943             <a class="code" href="Strategic_01AI_8cpp.html#75d774eb03c41b5fe422edfef6e445d4">ValidateWeights</a>( 23 );
<a name="l02944"></a>02944             <span class="keywordflow">return</span>;
<a name="l02945"></a>02945       }
<a name="l02946"></a>02946       <span class="keywordflow">else</span> 
<a name="l02947"></a>02947       {
<a name="l02948"></a>02948             iRandom -= <a class="code" href="AI_01Viewer_8cpp.html#c86cd58021961af10f1eb15108a79023">giReinforcementPool</a>;
<a name="l02949"></a>02949             <span class="keywordflow">for</span>( iSrcGarrisonID = 0; iSrcGarrisonID &lt; giGarrisonArraySize; iSrcGarrisonID++ )
<a name="l02950"></a>02950             { <span class="comment">//go through the garrisons</span>
<a name="l02951"></a>02951                   <a class="code" href="Strategic_01AI_8cpp.html#c9af29ba59f70cabda683c1d3e7de1d0">RecalculateGarrisonWeight</a>( iSrcGarrisonID );
<a name="l02952"></a>02952                   iWeight = -<a class="code" href="AI_01Viewer_8cpp.html#a9f940d7f3a6d6698bfaeb7c747d74a9">gGarrisonGroup</a>[ iSrcGarrisonID ].<a class="code" href="structGARRISON__GROUP.html#54fcf91b97b56e3cc75ef302b34ecf48">bWeight</a>;
<a name="l02953"></a>02953                   <span class="keywordflow">if</span>( iWeight &gt; 0 )
<a name="l02954"></a>02954                   { <span class="comment">//if group is able to provide reinforcements.</span>
<a name="l02955"></a>02955                         <span class="keywordflow">if</span>( iRandom &lt; iWeight )
<a name="l02956"></a>02956                         { <span class="comment">//This is the group that gets the reinforcements!</span>
<a name="l02957"></a>02957                               ubSrcSectorX = (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)SECTORX(<a class="code" href="AI_01Viewer_8cpp.html#a9f940d7f3a6d6698bfaeb7c747d74a9">gGarrisonGroup</a>[ iSrcGarrisonID ].ubSectorID );
<a name="l02958"></a>02958                               ubSrcSectorY = (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)SECTORY(<a class="code" href="AI_01Viewer_8cpp.html#a9f940d7f3a6d6698bfaeb7c747d74a9">gGarrisonGroup</a>[ iSrcGarrisonID ].ubSectorID );
<a name="l02959"></a>02959                               <span class="keywordflow">if</span>( ubSrcSectorX != <a class="code" href="strategicmap_8cpp.html#49d9aed144a633fda4ba1990f002d703">gWorldSectorX</a> || ubSrcSectorY != <a class="code" href="strategicmap_8cpp.html#ea322310ced0e35ee18a2ee7b32aac5b">gWorldSectorY</a> || <a class="code" href="strategicmap_8cpp.html#da715721a8ceedd42acf6ddb33e63ce0">gbWorldSectorZ</a> &gt; 0 )
<a name="l02960"></a>02960                               { <span class="comment">//The reinforcements aren't coming from the currently loaded sector!</span>
<a name="l02961"></a>02961                                     iReinforcementsAvailable = <a class="code" href="Strategic_01AI_8cpp.html#935cd00b37d3ecb937347a7d5ed379d0">ReinforcementsAvailable</a>( iSrcGarrisonID );
<a name="l02962"></a>02962                                     <span class="comment">//Send the lowest of the two:  number requested or number available</span>
<a name="l02963"></a>02963                                     iReinforcementsApproved = min( iReinforcementsRequested, iReinforcementsAvailable );
<a name="l02964"></a>02964                                     pGroup = <a class="code" href="Strategic_01Movement_8cpp.html#a6ac42d3d57b37a44bc39b3cd55ec008">CreateNewEnemyGroupDepartingFromSector</a>( <a class="code" href="AI_01Viewer_8cpp.html#a9f940d7f3a6d6698bfaeb7c747d74a9">gGarrisonGroup</a>[ iSrcGarrisonID ].ubSectorID, 0, (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)iReinforcementsApproved, 0 );
<a name="l02965"></a>02965                                     pGroup-&gt;<a class="code" href="structGROUP.html#40901f132b0b6aeedeb9ad99cceb0d38">ubOriginalSector</a> = (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)SECTOR( ubDstSectorX, ubDstSectorY );
<a name="l02966"></a>02966                                     <a class="code" href="Strategic_01AI_8cpp.html#9e00ccb0e77cec57208c519e8f831f53">gPatrolGroup</a>[ iPatrolID ].<a class="code" href="structPATROL__GROUP.html#85b82707f42868bcdd678a1d7ba9c257">ubPendingGroupID</a> = pGroup-&gt;<a class="code" href="structGROUP.html#9149379b9355afda87a382af5a88d728">ubGroupID</a>;
<a name="l02967"></a>02967 
<a name="l02968"></a>02968                                     <a class="code" href="Strategic_01AI_8cpp.html#b07cff54af372d6ec184957cb7b51266">RemoveSoldiersFromGarrisonBasedOnComposition</a>( iSrcGarrisonID, pGroup-&gt;<a class="code" href="structGROUP.html#2a98517c894019ee794e04ea05d1aeaf">ubGroupSize</a> );
<a name="l02969"></a>02969 
<a name="l02970"></a>02970 <span class="preprocessor">                                    #ifdef JA2BETAVERSION</span>
<a name="l02971"></a>02971 <span class="preprocessor"></span>                                          <a class="code" href="Strategic_01AI_8cpp.html#984e97af1f29d3b417cc5bdcd126cfca">LogStrategicEvent</a>( <span class="stringliteral">"%d troops have been sent from garrison sector %c%d to patrol area near sector %c%d"</span>, 
<a name="l02972"></a>02972                                                 pGroup-&gt;<a class="code" href="structGROUP.html#f82ff4c3e504e4bb10feb65491f79471">pEnemyGroup</a>-&gt;<a class="code" href="structENEMYGROUP.html#27eaaea857408bc6c6358054c19f2d07">ubNumTroops</a> + pGroup-&gt;<a class="code" href="structGROUP.html#f82ff4c3e504e4bb10feb65491f79471">pEnemyGroup</a>-&gt;<a class="code" href="structENEMYGROUP.html#5f20a703a3c536505126979265b10558">ubNumElites</a> + pGroup-&gt;<a class="code" href="structGROUP.html#f82ff4c3e504e4bb10feb65491f79471">pEnemyGroup</a>-&gt;<a class="code" href="structENEMYGROUP.html#61d6f824f39709580afa7a81317e241b">ubNumAdmins</a>, 
<a name="l02973"></a>02973                                                 ubSrcSectorY + <span class="charliteral">'A'</span> - 1, ubSrcSectorX, 
<a name="l02974"></a>02974                                                 ubDstSectorY + <span class="charliteral">'A'</span> - 1, ubDstSectorX );
<a name="l02975"></a>02975 <span class="preprocessor">                                    #endif</span>
<a name="l02976"></a>02976 <span class="preprocessor"></span>
<a name="l02977"></a>02977                                     <a class="code" href="Strategic_01AI_8cpp.html#3865b55f00d5df7710bd4325ddf83bfc">MoveSAIGroupToSector</a>( &amp;pGroup, <a class="code" href="Strategic_01AI_8cpp.html#9e00ccb0e77cec57208c519e8f831f53">gPatrolGroup</a>[ iPatrolID ].ubSectorID[1], <a class="code" href="Strategic_01AI_8cpp.html#2282261c2887b2d4d1183cf5249e1529a4d4adb90ccd2b0775d4429cac476900">EVASIVE</a>, <a class="code" href="Strategic_01Movement_8h.html#b59c1bec446b10af208f977a871d910b095b1f433b659c686164f67bb7b89cb1">REINFORCEMENTS</a> );
<a name="l02978"></a>02978                                     
<a name="l02979"></a>02979                                     <a class="code" href="Strategic_01AI_8cpp.html#75d774eb03c41b5fe422edfef6e445d4">ValidateWeights</a>( 24 );
<a name="l02980"></a>02980 
<a name="l02981"></a>02981                                     <span class="keywordflow">return</span>;
<a name="l02982"></a>02982                               }
<a name="l02983"></a>02983                         }
<a name="l02984"></a>02984                         iRandom -= iWeight;
<a name="l02985"></a>02985                   }
<a name="l02986"></a>02986             }
<a name="l02987"></a>02987       }
<a name="l02988"></a>02988       <a class="code" href="Strategic_01AI_8cpp.html#75d774eb03c41b5fe422edfef6e445d4">ValidateWeights</a>( 25 );
<a name="l02989"></a>02989 }
<a name="l02990"></a>02990 
<a name="l02991"></a>02991 <span class="comment">//Periodically does a general poll and check on each of the groups and garrisons, determines</span>
<a name="l02992"></a>02992 <span class="comment">//reinforcements, new patrol groups, planned assaults, etc.</span>
<a name="l02993"></a><a class="code" href="Strategic_01AI_8h.html#4b42938a3b27cbabac4f91e2c3a447e0">02993</a> <span class="keywordtype">void</span> <a class="code" href="Strategic_01AI_8cpp.html#4b42938a3b27cbabac4f91e2c3a447e0">EvaluateQueenSituation</a>()
<a name="l02994"></a>02994 {
<a name="l02995"></a>02995       <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a> i, iRandom;
<a name="l02996"></a>02996       <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a> iWeight;
<a name="l02997"></a>02997       <a class="code" href="Types_8h.html#e1e6edbbc26d6fbc71a90190d0266018">UINT32</a> uiOffset;
<a name="l02998"></a>02998       <a class="code" href="Types_8h.html#09f1a1fb2293e33483cc8d44aefb1eb1">UINT16</a> usDefencePoints;
<a name="l02999"></a>02999       <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a> iOrigRequestPoints;
<a name="l03000"></a>03000       <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a> iSumOfAllWeights = 0;
<a name="l03001"></a>03001 
<a name="l03002"></a>03002       <a class="code" href="Strategic_01AI_8cpp.html#75d774eb03c41b5fe422edfef6e445d4">ValidateWeights</a>( 26 );
<a name="l03003"></a>03003 
<a name="l03004"></a>03004       <span class="comment">// figure out how long it shall be before we call this again</span>
<a name="l03005"></a>03005 
<a name="l03006"></a>03006       <span class="comment">// The more work to do there is (request points the queen's army is asking for), the more often she will make decisions</span>
<a name="l03007"></a>03007       <span class="comment">// This can increase the decision intervals by up to 500 extra minutes (&gt; 8 hrs)</span>
<a name="l03008"></a>03008       uiOffset = max( 100 - <a class="code" href="AI_01Viewer_8cpp.html#c3390da297cb8068458f459fe9fc094f">giRequestPoints</a>, 0);
<a name="l03009"></a>03009       uiOffset = uiOffset + <a class="code" href="Random_8cpp.html#49f938d1313ab6ef09ac6223a16ac334">Random</a>( uiOffset * 4 );
<a name="l03010"></a>03010       <span class="keywordflow">switch</span>( <a class="code" href="GameSettings_8cpp.html#f9f2d5fd368ccadcc26bebc202d52ae7">gGameOptions</a>.<a class="code" href="structGAME__OPTIONS.html#4fb44167906152722f6af5cc9f7c1a99">ubDifficultyLevel</a> )
<a name="l03011"></a>03011       {
<a name="l03012"></a>03012             <span class="keywordflow">case</span> <a class="code" href="GameSettings_8h.html#c205be2172292384dd687b5471a87eddbd3b0d23f4dc30ef17b50a14c3f54589">DIF_LEVEL_EASY</a>:
<a name="l03013"></a>03013                   uiOffset += <a class="code" href="GameSettings_8cpp.html#5c32f930e2fef384505c4b91803a92c2">gGameExternalOptions</a>.<a class="code" href="structGAME__EXTERNAL__OPTIONS.html#ea56eea3a991ec99ea634c9262c77d22">ubEasyTimeEvaluateInMinutes</a> + <a class="code" href="Random_8cpp.html#49f938d1313ab6ef09ac6223a16ac334">Random</a>( <a class="code" href="GameSettings_8cpp.html#5c32f930e2fef384505c4b91803a92c2">gGameExternalOptions</a>.<a class="code" href="structGAME__EXTERNAL__OPTIONS.html#49bcd3e2249d457209a27d78ae551a38">ubEasyTimeEvaluateVariance</a> );
<a name="l03014"></a>03014                   <span class="keywordflow">break</span>;
<a name="l03015"></a>03015             <span class="keywordflow">case</span> <a class="code" href="GameSettings_8h.html#c205be2172292384dd687b5471a87edddd0259b09fef163c6aa62268574191cb">DIF_LEVEL_MEDIUM</a>:
<a name="l03016"></a>03016                   uiOffset += <a class="code" href="GameSettings_8cpp.html#5c32f930e2fef384505c4b91803a92c2">gGameExternalOptions</a>.<a class="code" href="structGAME__EXTERNAL__OPTIONS.html#d49134f2a25ff2407c8862336bd28aa7">ubNormalTimeEvaluateInMinutes</a> + <a class="code" href="Random_8cpp.html#49f938d1313ab6ef09ac6223a16ac334">Random</a>( <a class="code" href="GameSettings_8cpp.html#5c32f930e2fef384505c4b91803a92c2">gGameExternalOptions</a>.<a class="code" href="structGAME__EXTERNAL__OPTIONS.html#4ae4f161c6f4c5ab91ba9162f3580b3f">ubNormalTimeEvaluateVariance</a> );
<a name="l03017"></a>03017                   <span class="keywordflow">break</span>;
<a name="l03018"></a>03018             <span class="keywordflow">case</span> <a class="code" href="GameSettings_8h.html#c205be2172292384dd687b5471a87edd3d0b73026f1c7122798d578613aa4575">DIF_LEVEL_HARD</a>:
<a name="l03019"></a>03019                   uiOffset += <a class="code" href="GameSettings_8cpp.html#5c32f930e2fef384505c4b91803a92c2">gGameExternalOptions</a>.<a class="code" href="structGAME__EXTERNAL__OPTIONS.html#a2bc7bf5bbc738000128198bf5f2e3ef">ubHardTimeEvaluateInMinutes</a> + <a class="code" href="Random_8cpp.html#49f938d1313ab6ef09ac6223a16ac334">Random</a>( <a class="code" href="GameSettings_8cpp.html#5c32f930e2fef384505c4b91803a92c2">gGameExternalOptions</a>.<a class="code" href="structGAME__EXTERNAL__OPTIONS.html#d616bea88239bb4a6269680261501ffd">ubHardTimeEvaluateVariance</a> );
<a name="l03020"></a>03020                   <span class="keywordflow">break</span>;
<a name="l03021"></a>03021             <span class="keywordflow">case</span> <a class="code" href="GameSettings_8h.html#c205be2172292384dd687b5471a87eddc657c89fd754a6f20b3869250288a702">DIF_LEVEL_INSANE</a>:
<a name="l03022"></a>03022                   uiOffset += <a class="code" href="GameSettings_8cpp.html#5c32f930e2fef384505c4b91803a92c2">gGameExternalOptions</a>.<a class="code" href="structGAME__EXTERNAL__OPTIONS.html#63664e4c9238b259b953b245a4a65401">ubInsaneTimeEvaluateInMinutes</a> + <a class="code" href="Random_8cpp.html#49f938d1313ab6ef09ac6223a16ac334">Random</a>( <a class="code" href="GameSettings_8cpp.html#5c32f930e2fef384505c4b91803a92c2">gGameExternalOptions</a>.<a class="code" href="structGAME__EXTERNAL__OPTIONS.html#a0a8f2b23df1c6be8651cb209d5788a2">ubInsaneTimeEvaluateVariance</a> );
<a name="l03023"></a>03023                   <span class="keywordflow">break</span>;
<a name="l03024"></a>03024       }
<a name="l03025"></a>03025 
<a name="l03026"></a>03026       <span class="keywordflow">if</span>( !<a class="code" href="AI_01Viewer_8cpp.html#c86cd58021961af10f1eb15108a79023">giReinforcementPool</a> )
<a name="l03027"></a>03027       { <span class="comment">//Queen has run out of reinforcements.  Simulate recruiting and training new troops</span>
<a name="l03028"></a>03028             uiOffset *= 10;
<a name="l03029"></a>03029             <span class="comment">//Madd: don't need an unlimited troops check here, since they can never run out like this </span>
<a name="l03030"></a>03030             <a class="code" href="AI_01Viewer_8cpp.html#c86cd58021961af10f1eb15108a79023">giReinforcementPool</a> += ( <a class="code" href="GameSettings_8cpp.html#5c32f930e2fef384505c4b91803a92c2">gGameExternalOptions</a>.<a class="code" href="structGAME__EXTERNAL__OPTIONS.html#f0c8687668e402ccb1e22f2767ce2a58">guiBaseQueenPoolIncrement</a> * <a class="code" href="GameSettings_8cpp.html#f9f2d5fd368ccadcc26bebc202d52ae7">gGameOptions</a>.<a class="code" href="structGAME__OPTIONS.html#4fb44167906152722f6af5cc9f7c1a99">ubDifficultyLevel</a> ) * ( 100 + <a class="code" href="Campaign_8cpp.html#96236f8fe1389ac2394c491ab8dd6924">CurrentPlayerProgressPercentage</a>() ) / 100 ;
<a name="l03031"></a>03031             <a class="code" href="Game_01Event_01Hook_8h.html#d0da2cc582f16f4f54f328db96d7ca56">AddStrategicEvent</a>( <a class="code" href="Game_01Event_01Hook_8h.html#08f51f22ad2ed13a25181c26045731106d744aac1461129e69ce5d43d26e5e38">EVENT_EVALUATE_QUEEN_SITUATION</a>, <a class="code" href="Game_01Clock_8cpp.html#4d255e800fba4d64144a7639d5f3421d">GetWorldTotalMin</a>() + uiOffset, 0 );
<a name="l03032"></a>03032             <span class="keywordflow">return</span>;
<a name="l03033"></a>03033       }
<a name="l03034"></a>03034 
<a name="l03035"></a>03035       <span class="comment">//Re-post the event</span>
<a name="l03036"></a>03036       <a class="code" href="Game_01Event_01Hook_8h.html#d0da2cc582f16f4f54f328db96d7ca56">AddStrategicEvent</a>( <a class="code" href="Game_01Event_01Hook_8h.html#08f51f22ad2ed13a25181c26045731106d744aac1461129e69ce5d43d26e5e38">EVENT_EVALUATE_QUEEN_SITUATION</a>, <a class="code" href="Game_01Clock_8cpp.html#4d255e800fba4d64144a7639d5f3421d">GetWorldTotalMin</a>() + uiOffset, 0 );
<a name="l03037"></a>03037 
<a name="l03038"></a>03038       <span class="comment">// if the queen hasn't been alerted to player's presence yet</span>
<a name="l03039"></a>03039       <span class="keywordflow">if</span>( !<a class="code" href="AI_01Viewer_8cpp.html#38284bd39764812fb8a27fe4d3d2b0cd">gfQueenAIAwake</a> )
<a name="l03040"></a>03040       { <span class="comment">//no decisions can be made yet.</span>
<a name="l03041"></a>03041             <span class="keywordflow">return</span>;
<a name="l03042"></a>03042       }
<a name="l03043"></a>03043 
<a name="l03044"></a>03044       <span class="comment">// Adjust queen's disposition based on player's progress</span>
<a name="l03045"></a>03045       <a class="code" href="Strategic_01AI_8cpp.html#d07e8dc3510ffd7b3bf0713c0a152ae2">EvolveQueenPriorityPhase</a>( FALSE );
<a name="l03046"></a>03046 
<a name="l03047"></a>03047       <span class="comment">// Gradually promote any remaining admins into troops </span>
<a name="l03048"></a>03048       <a class="code" href="Strategic_01AI_8cpp.html#5ce042820a296b25287965de76aa9e9b">UpgradeAdminsToTroops</a>();
<a name="l03049"></a>03049 
<a name="l03050"></a>03050       <span class="keywordflow">if</span>( ( <a class="code" href="AI_01Viewer_8cpp.html#c3390da297cb8068458f459fe9fc094f">giRequestPoints</a> &lt;= 0 ) || ( ( <a class="code" href="AI_01Viewer_8cpp.html#a54cf2087c7e1b790053295a6bf90592">giReinforcementPoints</a> &lt;= 0 ) &amp;&amp; ( <a class="code" href="AI_01Viewer_8cpp.html#c86cd58021961af10f1eb15108a79023">giReinforcementPool</a> &lt;= 0 ) ) )
<a name="l03051"></a>03051       { <span class="comment">//we either have no reinforcements or request for reinforcements.</span>
<a name="l03052"></a>03052             <span class="keywordflow">return</span>;
<a name="l03053"></a>03053       }
<a name="l03054"></a>03054 
<a name="l03055"></a>03055       <span class="comment">//now randomly choose who gets the reinforcements.</span>
<a name="l03056"></a>03056       <span class="comment">// giRequestPoints is the combined sum of all the individual weights of all garrisons and patrols requesting reinforcements</span>
<a name="l03057"></a>03057       iRandom = <a class="code" href="Random_8cpp.html#49f938d1313ab6ef09ac6223a16ac334">Random</a>( <a class="code" href="AI_01Viewer_8cpp.html#c3390da297cb8068458f459fe9fc094f">giRequestPoints</a> );
<a name="l03058"></a>03058 
<a name="l03059"></a>03059       iOrigRequestPoints = <a class="code" href="AI_01Viewer_8cpp.html#c3390da297cb8068458f459fe9fc094f">giRequestPoints</a>;     <span class="comment">// debug only!</span>
<a name="l03060"></a>03060 
<a name="l03061"></a>03061       <span class="comment">//go through garrisons first</span>
<a name="l03062"></a>03062       <span class="keywordflow">for</span>( i = 0; i &lt; giGarrisonArraySize; i++ )
<a name="l03063"></a>03063       {
<a name="l03064"></a>03064             <a class="code" href="Strategic_01AI_8cpp.html#c9af29ba59f70cabda683c1d3e7de1d0">RecalculateGarrisonWeight</a>( i );
<a name="l03065"></a>03065             iWeight = <a class="code" href="AI_01Viewer_8cpp.html#a9f940d7f3a6d6698bfaeb7c747d74a9">gGarrisonGroup</a>[ i ].<a class="code" href="structGARRISON__GROUP.html#54fcf91b97b56e3cc75ef302b34ecf48">bWeight</a>;
<a name="l03066"></a>03066             <span class="keywordflow">if</span>( iWeight &gt; 0 )
<a name="l03067"></a>03067             {     <span class="comment">//if group is requesting reinforcements.</span>
<a name="l03068"></a>03068 
<a name="l03069"></a>03069                   iSumOfAllWeights += iWeight;  <span class="comment">// debug only!</span>
<a name="l03070"></a>03070 
<a name="l03071"></a>03071                   <span class="keywordflow">if</span>( iRandom &lt; iWeight &amp;&amp; !<a class="code" href="AI_01Viewer_8cpp.html#a9f940d7f3a6d6698bfaeb7c747d74a9">gGarrisonGroup</a>[ i ].ubPendingGroupID &amp;&amp; 
<a name="l03072"></a>03072                               <a class="code" href="Strategic_01AI_8cpp.html#f8f6673c3fc186e8d92341498a455679">EnemyPermittedToAttackSector</a>( NULL, <a class="code" href="AI_01Viewer_8cpp.html#a9f940d7f3a6d6698bfaeb7c747d74a9">gGarrisonGroup</a>[ i ].ubSectorID ) &amp;&amp;
<a name="l03073"></a>03073                               <a class="code" href="Strategic_01AI_8cpp.html#acc69c670c9bac13b5e41484b4648552">GarrisonRequestingMinimumReinforcements</a>( i ) )
<a name="l03074"></a>03074                   { <span class="comment">//This is the group that gets the reinforcements!</span>
<a name="l03075"></a>03075                         <span class="keywordflow">if</span>( <a class="code" href="Strategic_01AI_8cpp.html#0cccefb435b3d940d9bf817c88224d6f">ReinforcementsApproved</a>( i, &amp;usDefencePoints ) )
<a name="l03076"></a>03076                         {
<a name="l03077"></a>03077                               <a class="code" href="Strategic_01AI_8cpp.html#a5149c8e5d77cd98583fe9f8abf93657">SendReinforcementsForGarrison</a>( i, usDefencePoints, NULL );
<a name="l03078"></a>03078                         }
<a name="l03079"></a>03079                         <span class="keywordflow">else</span>
<a name="l03080"></a>03080                         {
<a name="l03081"></a>03081 <span class="preprocessor">                              #ifdef JA2BETAVERSION</span>
<a name="l03082"></a>03082 <span class="preprocessor"></span>                                    <a class="code" href="Strategic_01AI_8cpp.html#984e97af1f29d3b417cc5bdcd126cfca">LogStrategicEvent</a>( <span class="stringliteral">"Reinforcements were denied to go to %c%d because player forces too strong."</span>,
<a name="l03083"></a>03083                                           SECTORY( <a class="code" href="AI_01Viewer_8cpp.html#a9f940d7f3a6d6698bfaeb7c747d74a9">gGarrisonGroup</a>[ i ].ubSectorID ) + <span class="charliteral">'A'</span> - 1, SECTORX( <a class="code" href="AI_01Viewer_8cpp.html#a9f940d7f3a6d6698bfaeb7c747d74a9">gGarrisonGroup</a>[ i ].ubSectorID ) );
<a name="l03084"></a>03084 <span class="preprocessor">                              #endif</span>
<a name="l03085"></a>03085 <span class="preprocessor"></span>                        }
<a name="l03086"></a>03086                         <span class="keywordflow">return</span>;
<a name="l03087"></a>03087                   }
<a name="l03088"></a>03088                   iRandom -= iWeight;
<a name="l03089"></a>03089             }
<a name="l03090"></a>03090       }
<a name="l03091"></a>03091 
<a name="l03092"></a>03092       <span class="comment">//go through the patrol groups</span>
<a name="l03093"></a>03093       <span class="keywordflow">for</span>( i = 0; i &lt; giPatrolArraySize; i++ )
<a name="l03094"></a>03094       {
<a name="l03095"></a>03095             <a class="code" href="Strategic_01AI_8cpp.html#d11803600200a4f8e0f5d842132fc140">RecalculatePatrolWeight</a>( i );
<a name="l03096"></a>03096             iWeight = <a class="code" href="Strategic_01AI_8cpp.html#9e00ccb0e77cec57208c519e8f831f53">gPatrolGroup</a>[ i ].<a class="code" href="structPATROL__GROUP.html#dd4d329226457571a40c1855943ef39b">bWeight</a>;
<a name="l03097"></a>03097             <span class="keywordflow">if</span>( iWeight &gt; 0 )
<a name="l03098"></a>03098             {
<a name="l03099"></a>03099                   iSumOfAllWeights += iWeight;  <span class="comment">// debug only!</span>
<a name="l03100"></a>03100 
<a name="l03101"></a>03101                   <span class="keywordflow">if</span>( iRandom &lt; iWeight &amp;&amp; !<a class="code" href="Strategic_01AI_8cpp.html#9e00ccb0e77cec57208c519e8f831f53">gPatrolGroup</a>[ i ].ubPendingGroupID &amp;&amp; <a class="code" href="Strategic_01AI_8cpp.html#6e02787740c45d04fbbd7ca50ca23064">PatrolRequestingMinimumReinforcements</a>( i ) ) 
<a name="l03102"></a>03102                   { <span class="comment">//This is the group that gets the reinforcements!</span>
<a name="l03103"></a>03103                         <a class="code" href="Strategic_01AI_8cpp.html#8b154858f03533e0134728bee6602276">SendReinforcementsForPatrol</a>( i, NULL );
<a name="l03104"></a>03104                         <span class="keywordflow">return</span>;
<a name="l03105"></a>03105                   }
<a name="l03106"></a>03106                   iRandom -= iWeight;
<a name="l03107"></a>03107             }
<a name="l03108"></a>03108       }
<a name="l03109"></a>03109 
<a name="l03110"></a>03110       <a class="code" href="Strategic_01AI_8cpp.html#75d774eb03c41b5fe422edfef6e445d4">ValidateWeights</a>( 27 );
<a name="l03111"></a>03111 }
<a name="l03112"></a>03112 
<a name="l03113"></a>03113 
<a name="l03114"></a><a class="code" href="Strategic_01AI_8h.html#0bbbed8161c3eea31a131accfc62ebc1">03114</a> <a class="code" href="Types_8h.html#112e3146cb38b6ee95e64d85842e380a">BOOLEAN</a> <a class="code" href="Strategic_01AI_8cpp.html#0bbbed8161c3eea31a131accfc62ebc1">SaveStrategicAI</a>( <a class="code" href="LibraryDataBase_8h.html#210e2fc1c18208cbf159ef9c087d6721">HWFILE</a> hFile )
<a name="l03115"></a>03115 {
<a name="l03116"></a>03116       <a class="code" href="structGARRISON__GROUP.html">GARRISON_GROUP</a> gTempGarrisonGroup;
<a name="l03117"></a>03117       <a class="code" href="structPATROL__GROUP.html">PATROL_GROUP</a> gTempPatrolGroup;
<a name="l03118"></a>03118       <a class="code" href="structARMY__COMPOSITION.html">ARMY_COMPOSITION</a> gTempArmyComp;
<a name="l03119"></a>03119       <a class="code" href="Types_8h.html#e1e6edbbc26d6fbc71a90190d0266018">UINT32</a> uiNumBytesWritten;
<a name="l03120"></a>03120       <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a> i;
<a name="l03121"></a>03121 
<a name="l03122"></a>03122       memset( &amp;gTempPatrolGroup, 0, <span class="keyword">sizeof</span>( <a class="code" href="structPATROL__GROUP.html">PATROL_GROUP</a> ) );
<a name="l03123"></a>03123       memset( &amp;gTempArmyComp, 0, <span class="keyword">sizeof</span>( <a class="code" href="structARMY__COMPOSITION.html">ARMY_COMPOSITION</a> ) );
<a name="l03124"></a>03124 
<a name="l03125"></a>03125       <a class="code" href="FileMan_8cpp.html#09ed41c07d607c8c64a7e2b9fb25660c">FileWrite</a>( hFile, <a class="code" href="Strategic_01AI_8cpp.html#c689ec381215b910ba04d356fe3b96ed">gbPadding2</a>,                                     3, &amp;uiNumBytesWritten );
<a name="l03126"></a>03126       <span class="keywordflow">if</span>( uiNumBytesWritten != 3 )
<a name="l03127"></a>03127             <span class="keywordflow">return</span> FALSE;
<a name="l03128"></a>03128       <a class="code" href="FileMan_8cpp.html#09ed41c07d607c8c64a7e2b9fb25660c">FileWrite</a>( hFile, &amp;<a class="code" href="Strategic_01AI_8cpp.html#da8cb507523142e34aa6a62793f76a88">gfExtraElites</a>,                           1, &amp;uiNumBytesWritten );
<a name="l03129"></a>03129       <span class="keywordflow">if</span>( uiNumBytesWritten != 1 )
<a name="l03130"></a>03130             <span class="keywordflow">return</span> FALSE;
<a name="l03131"></a>03131       <a class="code" href="FileMan_8cpp.html#09ed41c07d607c8c64a7e2b9fb25660c">FileWrite</a>( hFile, &amp;giGarrisonArraySize,         4, &amp;uiNumBytesWritten );
<a name="l03132"></a>03132       <span class="keywordflow">if</span>( uiNumBytesWritten != 4 )
<a name="l03133"></a>03133             <span class="keywordflow">return</span> FALSE;
<a name="l03134"></a>03134       <a class="code" href="FileMan_8cpp.html#09ed41c07d607c8c64a7e2b9fb25660c">FileWrite</a>( hFile, &amp;giPatrolArraySize,                 4, &amp;uiNumBytesWritten );
<a name="l03135"></a>03135       <span class="keywordflow">if</span>( uiNumBytesWritten != 4 )
<a name="l03136"></a>03136             <span class="keywordflow">return</span> FALSE;
<a name="l03137"></a>03137       <a class="code" href="FileMan_8cpp.html#09ed41c07d607c8c64a7e2b9fb25660c">FileWrite</a>( hFile, &amp;<a class="code" href="AI_01Viewer_8cpp.html#c86cd58021961af10f1eb15108a79023">giReinforcementPool</a>,         4, &amp;uiNumBytesWritten );
<a name="l03138"></a>03138       <span class="keywordflow">if</span>( uiNumBytesWritten != 4 )
<a name="l03139"></a>03139             <span class="keywordflow">return</span> FALSE;
<a name="l03140"></a>03140       <a class="code" href="FileMan_8cpp.html#09ed41c07d607c8c64a7e2b9fb25660c">FileWrite</a>( hFile, &amp;<a class="code" href="Strategic_01AI_8cpp.html#dd33d20256198684ad819b0f877ba407">giForcePercentage</a>,                 4, &amp;uiNumBytesWritten );
<a name="l03141"></a>03141       <span class="keywordflow">if</span>( uiNumBytesWritten != 4 )
<a name="l03142"></a>03142             <span class="keywordflow">return</span> FALSE;
<a name="l03143"></a>03143       <a class="code" href="FileMan_8cpp.html#09ed41c07d607c8c64a7e2b9fb25660c">FileWrite</a>( hFile, &amp;<a class="code" href="Strategic_01AI_8cpp.html#5ca96833bf812b9e43da8510ca54f00a">giArmyAlertness</a>,                   4, &amp;uiNumBytesWritten );
<a name="l03144"></a>03144       <span class="keywordflow">if</span>( uiNumBytesWritten != 4 )
<a name="l03145"></a>03145             <span class="keywordflow">return</span> FALSE;
<a name="l03146"></a>03146       <a class="code" href="FileMan_8cpp.html#09ed41c07d607c8c64a7e2b9fb25660c">FileWrite</a>( hFile, &amp;<a class="code" href="Strategic_01AI_8cpp.html#1bdeafde98c11d85ed1f79f8c793b1bc">giArmyAlertnessDecay</a>,  4, &amp;uiNumBytesWritten );
<a name="l03147"></a>03147       <span class="keywordflow">if</span>( uiNumBytesWritten != 4 )
<a name="l03148"></a>03148             <span class="keywordflow">return</span> FALSE;
<a name="l03149"></a>03149       <a class="code" href="FileMan_8cpp.html#09ed41c07d607c8c64a7e2b9fb25660c">FileWrite</a>( hFile, &amp;<a class="code" href="AI_01Viewer_8cpp.html#38284bd39764812fb8a27fe4d3d2b0cd">gfQueenAIAwake</a>,                    1, &amp;uiNumBytesWritten );
<a name="l03150"></a>03150       <span class="keywordflow">if</span>( uiNumBytesWritten != 1 )
<a name="l03151"></a>03151             <span class="keywordflow">return</span> FALSE;
<a name="l03152"></a>03152       <a class="code" href="FileMan_8cpp.html#09ed41c07d607c8c64a7e2b9fb25660c">FileWrite</a>( hFile, &amp;<a class="code" href="AI_01Viewer_8cpp.html#a54cf2087c7e1b790053295a6bf90592">giReinforcementPoints</a>, 4, &amp;uiNumBytesWritten );
<a name="l03153"></a>03153       <span class="keywordflow">if</span>( uiNumBytesWritten != 4 )
<a name="l03154"></a>03154             <span class="keywordflow">return</span> FALSE;
<a name="l03155"></a>03155       <a class="code" href="FileMan_8cpp.html#09ed41c07d607c8c64a7e2b9fb25660c">FileWrite</a>( hFile, &amp;<a class="code" href="AI_01Viewer_8cpp.html#c3390da297cb8068458f459fe9fc094f">giRequestPoints</a>,                   4, &amp;uiNumBytesWritten );
<a name="l03156"></a>03156       <span class="keywordflow">if</span>( uiNumBytesWritten != 4 )
<a name="l03157"></a>03157             <span class="keywordflow">return</span> FALSE;
<a name="l03158"></a>03158       <a class="code" href="FileMan_8cpp.html#09ed41c07d607c8c64a7e2b9fb25660c">FileWrite</a>( hFile, &amp;<a class="code" href="Strategic_01AI_8cpp.html#ab475b2c021e0d3a27bc5f4c7bd22639">gubNumAwareBattles</a>,          1, &amp;uiNumBytesWritten );
<a name="l03159"></a>03159       <span class="keywordflow">if</span>( uiNumBytesWritten != 1 )
<a name="l03160"></a>03160             <span class="keywordflow">return</span> FALSE;
<a name="l03161"></a>03161       <a class="code" href="FileMan_8cpp.html#09ed41c07d607c8c64a7e2b9fb25660c">FileWrite</a>( hFile, &amp;<a class="code" href="Strategic_01AI_8cpp.html#4f25955839f4d03d6e72fcb14e00fc96">gubSAIVersion</a>,                           1, &amp;uiNumBytesWritten );
<a name="l03162"></a>03162       <span class="keywordflow">if</span>( uiNumBytesWritten != 1 )
<a name="l03163"></a>03163             <span class="keywordflow">return</span> FALSE;
<a name="l03164"></a>03164       <a class="code" href="FileMan_8cpp.html#09ed41c07d607c8c64a7e2b9fb25660c">FileWrite</a>( hFile, &amp;<a class="code" href="Strategic_01AI_8cpp.html#b6506b3e47eb797cd604d652eb70cdc3">gubQueenPriorityPhase</a>, 1, &amp;uiNumBytesWritten );
<a name="l03165"></a>03165       <span class="keywordflow">if</span>( uiNumBytesWritten != 1 )
<a name="l03166"></a>03166             <span class="keywordflow">return</span> FALSE;
<a name="l03167"></a>03167       <a class="code" href="FileMan_8cpp.html#09ed41c07d607c8c64a7e2b9fb25660c">FileWrite</a>( hFile, &amp;<a class="code" href="Strategic_01AI_8cpp.html#25242025da42191e44f15d6f90efbaf7">gfFirstBattleMeanwhileScenePending</a>,      1, &amp;uiNumBytesWritten );
<a name="l03168"></a>03168       <span class="keywordflow">if</span>( uiNumBytesWritten != 1 )
<a name="l03169"></a>03169             <span class="keywordflow">return</span> FALSE;
<a name="l03170"></a>03170       <a class="code" href="FileMan_8cpp.html#09ed41c07d607c8c64a7e2b9fb25660c">FileWrite</a>( hFile, &amp;<a class="code" href="Strategic_01AI_8cpp.html#ace9c47ca01a402ca45743ff70c9d70c">gfMassFortificationOrdered</a>,  1, &amp;uiNumBytesWritten );
<a name="l03171"></a>03171       <span class="keywordflow">if</span>( uiNumBytesWritten != 1 )
<a name="l03172"></a>03172             <span class="keywordflow">return</span> FALSE;
<a name="l03173"></a>03173       <a class="code" href="FileMan_8cpp.html#09ed41c07d607c8c64a7e2b9fb25660c">FileWrite</a>( hFile, &amp;<a class="code" href="Strategic_01AI_8cpp.html#12b5525b1f3dabeac40700eecd3219e7">gubMinEnemyGroupSize</a>,  1, &amp;uiNumBytesWritten );
<a name="l03174"></a>03174       <span class="keywordflow">if</span>( uiNumBytesWritten != 1 )
<a name="l03175"></a>03175             <span class="keywordflow">return</span> FALSE;
<a name="l03176"></a>03176       <a class="code" href="FileMan_8cpp.html#09ed41c07d607c8c64a7e2b9fb25660c">FileWrite</a>( hFile, &amp;<a class="code" href="Strategic_01AI_8cpp.html#123935928b8e3146a1edda9d78cfea62">gubHoursGracePeriod</a>, 1, &amp;uiNumBytesWritten );
<a name="l03177"></a>03177       <span class="keywordflow">if</span>( uiNumBytesWritten != 1 )
<a name="l03178"></a>03178             <span class="keywordflow">return</span> FALSE;
<a name="l03179"></a>03179       <a class="code" href="FileMan_8cpp.html#09ed41c07d607c8c64a7e2b9fb25660c">FileWrite</a>( hFile, &amp;<a class="code" href="Strategic_01AI_8cpp.html#711cdebe533db7c45a8e7e88c6f312d6">gusPlayerBattleVictories</a>, 2, &amp;uiNumBytesWritten );
<a name="l03180"></a>03180       <span class="keywordflow">if</span>( uiNumBytesWritten != 2 )
<a name="l03181"></a>03181             <span class="keywordflow">return</span> FALSE;
<a name="l03182"></a>03182       <a class="code" href="FileMan_8cpp.html#09ed41c07d607c8c64a7e2b9fb25660c">FileWrite</a>( hFile, &amp;<a class="code" href="Strategic_01AI_8cpp.html#8029ae4e0579eaec31822e170536fe40">gfUseAlternateQueenPosition</a>, 1, &amp;uiNumBytesWritten );
<a name="l03183"></a>03183       <span class="keywordflow">if</span>( uiNumBytesWritten != 1 )
<a name="l03184"></a>03184             <span class="keywordflow">return</span> FALSE;
<a name="l03185"></a>03185       <a class="code" href="FileMan_8cpp.html#09ed41c07d607c8c64a7e2b9fb25660c">FileWrite</a>( hFile, <a class="code" href="Strategic_01AI_8cpp.html#e123fe3aeaaec0cd4c30b4599e299f84">gbPadding</a>, SAI_PADDING_BYTES, &amp;uiNumBytesWritten );
<a name="l03186"></a>03186       <span class="keywordflow">if</span>( uiNumBytesWritten != SAI_PADDING_BYTES )
<a name="l03187"></a>03187             <span class="keywordflow">return</span> FALSE;
<a name="l03188"></a>03188       <span class="comment">//Save the army composition (which does get modified)</span>
<a name="l03189"></a>03189       <a class="code" href="FileMan_8cpp.html#09ed41c07d607c8c64a7e2b9fb25660c">FileWrite</a>( hFile, <a class="code" href="AI_01Viewer_8cpp.html#77e448d1f208bd120f861571e6d0098f">gArmyComp</a>, <a class="code" href="Strategic_01AI_8h.html#a9908284c0827729f14cf9b2489e1479d2a0278d1458eaa8c2bb99d2d4b55f00">NUM_ARMY_COMPOSITIONS</a> * <span class="keyword">sizeof</span>( ARMY_COMPOSITION ), &amp;uiNumBytesWritten );
<a name="l03190"></a>03190       <span class="keywordflow">if</span>( uiNumBytesWritten != <a class="code" href="Strategic_01AI_8h.html#a9908284c0827729f14cf9b2489e1479d2a0278d1458eaa8c2bb99d2d4b55f00">NUM_ARMY_COMPOSITIONS</a> * <span class="keyword">sizeof</span>( ARMY_COMPOSITION ) )
<a name="l03191"></a>03191             <span class="keywordflow">return</span> FALSE;
<a name="l03192"></a>03192       i = SAVED_ARMY_COMPOSITIONS - <a class="code" href="Strategic_01AI_8h.html#a9908284c0827729f14cf9b2489e1479d2a0278d1458eaa8c2bb99d2d4b55f00">NUM_ARMY_COMPOSITIONS</a>;
<a name="l03193"></a>03193       <span class="keywordflow">while</span>( i-- )
<a name="l03194"></a>03194       {
<a name="l03195"></a>03195             <a class="code" href="FileMan_8cpp.html#09ed41c07d607c8c64a7e2b9fb25660c">FileWrite</a>( hFile, &amp;gTempArmyComp, <span class="keyword">sizeof</span>( ARMY_COMPOSITION ), &amp;uiNumBytesWritten );
<a name="l03196"></a>03196             <span class="keywordflow">if</span>( uiNumBytesWritten != <span class="keyword">sizeof</span>( ARMY_COMPOSITION ) )
<a name="l03197"></a>03197                   <span class="keywordflow">return</span> FALSE;
<a name="l03198"></a>03198       }
<a name="l03199"></a>03199       <span class="comment">//Save the patrol group definitions</span>
<a name="l03200"></a>03200       <a class="code" href="FileMan_8cpp.html#09ed41c07d607c8c64a7e2b9fb25660c">FileWrite</a>( hFile, <a class="code" href="Strategic_01AI_8cpp.html#9e00ccb0e77cec57208c519e8f831f53">gPatrolGroup</a>, giPatrolArraySize * <span class="keyword">sizeof</span>( PATROL_GROUP ), &amp;uiNumBytesWritten );
<a name="l03201"></a>03201       <span class="keywordflow">if</span>( uiNumBytesWritten != giPatrolArraySize * <span class="keyword">sizeof</span>( PATROL_GROUP ) )
<a name="l03202"></a>03202             <span class="keywordflow">return</span> FALSE;
<a name="l03203"></a>03203       i = SAVED_PATROL_GROUPS - giPatrolArraySize;
<a name="l03204"></a>03204       <span class="keywordflow">while</span>( i-- )
<a name="l03205"></a>03205       {
<a name="l03206"></a>03206             <a class="code" href="FileMan_8cpp.html#09ed41c07d607c8c64a7e2b9fb25660c">FileWrite</a>( hFile, &amp;gTempPatrolGroup, <span class="keyword">sizeof</span>( PATROL_GROUP ), &amp;uiNumBytesWritten );
<a name="l03207"></a>03207             <span class="keywordflow">if</span>( uiNumBytesWritten != <span class="keyword">sizeof</span>( PATROL_GROUP ) )
<a name="l03208"></a>03208                   <span class="keywordflow">return</span> FALSE;
<a name="l03209"></a>03209       }
<a name="l03210"></a>03210       <span class="comment">//Save the garrison information!</span>
<a name="l03211"></a>03211       memset( &amp;gTempGarrisonGroup, 0, <span class="keyword">sizeof</span>( <a class="code" href="structGARRISON__GROUP.html">GARRISON_GROUP</a> ) );
<a name="l03212"></a>03212       <a class="code" href="FileMan_8cpp.html#09ed41c07d607c8c64a7e2b9fb25660c">FileWrite</a>( hFile, <a class="code" href="AI_01Viewer_8cpp.html#a9f940d7f3a6d6698bfaeb7c747d74a9">gGarrisonGroup</a>, giGarrisonArraySize * <span class="keyword">sizeof</span>( GARRISON_GROUP ), &amp;uiNumBytesWritten );
<a name="l03213"></a>03213       <span class="keywordflow">if</span>( uiNumBytesWritten != giGarrisonArraySize * <span class="keyword">sizeof</span>( GARRISON_GROUP ) )
<a name="l03214"></a>03214             <span class="keywordflow">return</span> FALSE;
<a name="l03215"></a>03215       i = SAVED_GARRISON_GROUPS - giGarrisonArraySize;
<a name="l03216"></a>03216       <span class="keywordflow">while</span>( i-- )
<a name="l03217"></a>03217       {
<a name="l03218"></a>03218             <a class="code" href="FileMan_8cpp.html#09ed41c07d607c8c64a7e2b9fb25660c">FileWrite</a>( hFile, &amp;gTempGarrisonGroup, <span class="keyword">sizeof</span>( GARRISON_GROUP ), &amp;uiNumBytesWritten );
<a name="l03219"></a>03219             <span class="keywordflow">if</span>( uiNumBytesWritten != <span class="keyword">sizeof</span>( GARRISON_GROUP ) )
<a name="l03220"></a>03220                   <span class="keywordflow">return</span> FALSE;
<a name="l03221"></a>03221       }
<a name="l03222"></a>03222 
<a name="l03223"></a>03223       <a class="code" href="FileMan_8cpp.html#09ed41c07d607c8c64a7e2b9fb25660c">FileWrite</a>( hFile, <a class="code" href="Strategic_01AI_8cpp.html#48e0403413b13dc086dc70c6921ee186">gubPatrolReinforcementsDenied</a>, giPatrolArraySize, &amp;uiNumBytesWritten );
<a name="l03224"></a>03224       <span class="keywordflow">if</span>( uiNumBytesWritten != (<a class="code" href="Types_8h.html#e1e6edbbc26d6fbc71a90190d0266018">UINT32</a>)giPatrolArraySize )
<a name="l03225"></a>03225       {     
<a name="l03226"></a>03226             <span class="keywordflow">return</span> FALSE;
<a name="l03227"></a>03227       }     
<a name="l03228"></a>03228 
<a name="l03229"></a>03229       <a class="code" href="FileMan_8cpp.html#09ed41c07d607c8c64a7e2b9fb25660c">FileWrite</a>( hFile, <a class="code" href="Strategic_01AI_8cpp.html#9bc393a708632bfedc7ce82ab9268709">gubGarrisonReinforcementsDenied</a>, giGarrisonArraySize, &amp;uiNumBytesWritten );
<a name="l03230"></a>03230       <span class="keywordflow">if</span>( uiNumBytesWritten != (<a class="code" href="Types_8h.html#e1e6edbbc26d6fbc71a90190d0266018">UINT32</a>)giGarrisonArraySize )
<a name="l03231"></a>03231       {     
<a name="l03232"></a>03232             <span class="keywordflow">return</span> FALSE;
<a name="l03233"></a>03233       }     
<a name="l03234"></a>03234       
<a name="l03235"></a>03235 <span class="preprocessor">      #ifdef JA2BETAVERSION</span>
<a name="l03236"></a>03236 <span class="preprocessor"></span>            <a class="code" href="Strategic_01AI_8cpp.html#6ad6e766f5a175739a5295f19d0f0bd0">ValidatePlayersAreInOneGroupOnly</a>();
<a name="l03237"></a>03237 <span class="preprocessor">      #endif</span>
<a name="l03238"></a>03238 <span class="preprocessor"></span>      
<a name="l03239"></a>03239       <span class="keywordflow">return</span> TRUE;
<a name="l03240"></a>03240 }
<a name="l03241"></a>03241 
<a name="l03242"></a><a class="code" href="Strategic_01AI_8h.html#6a04c4890dbda50c09b3dfd77e883c5e">03242</a> <a class="code" href="Types_8h.html#112e3146cb38b6ee95e64d85842e380a">BOOLEAN</a> <a class="code" href="Strategic_01AI_8cpp.html#6a04c4890dbda50c09b3dfd77e883c5e">LoadStrategicAI</a>( <a class="code" href="LibraryDataBase_8h.html#210e2fc1c18208cbf159ef9c087d6721">HWFILE</a> hFile )
<a name="l03243"></a>03243 {
<a name="l03244"></a>03244       <a class="code" href="structGROUP.html">GROUP</a> *pGroup, *next;
<a name="l03245"></a>03245       <a class="code" href="structGARRISON__GROUP.html">GARRISON_GROUP</a> gTempGarrisonGroup;
<a name="l03246"></a>03246       <a class="code" href="structPATROL__GROUP.html">PATROL_GROUP</a> gTempPatrolGroup;
<a name="l03247"></a>03247       <a class="code" href="structARMY__COMPOSITION.html">ARMY_COMPOSITION</a> gTempArmyComp;
<a name="l03248"></a>03248       <a class="code" href="Types_8h.html#e1e6edbbc26d6fbc71a90190d0266018">UINT32</a> uiNumBytesRead;
<a name="l03249"></a>03249       <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a> i;
<a name="l03250"></a>03250       <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubSAIVersion;
<a name="l03251"></a>03251       <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a> iMaxEnemyGroupSize = <a class="code" href="GameSettings_8cpp.html#5c32f930e2fef384505c4b91803a92c2">gGameExternalOptions</a>.<a class="code" href="structGAME__EXTERNAL__OPTIONS.html#e0dd958b9c8219730a767a875dda20d5">iMaxEnemyGroupSize</a>;
<a name="l03252"></a>03252 
<a name="l03253"></a>03253       <span class="keywordflow">switch</span>( <a class="code" href="GameSettings_8cpp.html#f9f2d5fd368ccadcc26bebc202d52ae7">gGameOptions</a>.<a class="code" href="structGAME__OPTIONS.html#4fb44167906152722f6af5cc9f7c1a99">ubDifficultyLevel</a> )
<a name="l03254"></a>03254       {
<a name="l03255"></a>03255             <span class="keywordflow">case</span> <a class="code" href="GameSettings_8h.html#c205be2172292384dd687b5471a87eddbd3b0d23f4dc30ef17b50a14c3f54589">DIF_LEVEL_EASY</a>:
<a name="l03256"></a>03256                   <a class="code" href="Strategic_01AI_8cpp.html#b0c12688f38630da4e064c85394ca570">gfUnlimitedTroops</a>       = <a class="code" href="GameSettings_8cpp.html#5c32f930e2fef384505c4b91803a92c2">gGameExternalOptions</a>.<a class="code" href="structGAME__EXTERNAL__OPTIONS.html#ce0b1841e73147375eef112a7fc789a7">gfEasyUnlimitedTroops</a>;
<a name="l03257"></a>03257                   <a class="code" href="Strategic_01AI_8cpp.html#03888c7c25d0c7d4585ed03317d64c53">gfAggressiveQueen</a>       = <a class="code" href="GameSettings_8cpp.html#5c32f930e2fef384505c4b91803a92c2">gGameExternalOptions</a>.<a class="code" href="structGAME__EXTERNAL__OPTIONS.html#5b64ee658277f3e3949d63ede9a142c9">gfEasyAggressiveQueen</a>;
<a name="l03258"></a>03258                   <span class="keywordflow">break</span>;
<a name="l03259"></a>03259             <span class="keywordflow">case</span> <a class="code" href="GameSettings_8h.html#c205be2172292384dd687b5471a87edddd0259b09fef163c6aa62268574191cb">DIF_LEVEL_MEDIUM</a>:
<a name="l03260"></a>03260                   <a class="code" href="Strategic_01AI_8cpp.html#b0c12688f38630da4e064c85394ca570">gfUnlimitedTroops</a>       = <a class="code" href="GameSettings_8cpp.html#5c32f930e2fef384505c4b91803a92c2">gGameExternalOptions</a>.<a class="code" href="structGAME__EXTERNAL__OPTIONS.html#a015dbdb4e0859bc29d210f209e64759">gfNormalUnlimitedTroops</a>;
<a name="l03261"></a>03261                   <a class="code" href="Strategic_01AI_8cpp.html#03888c7c25d0c7d4585ed03317d64c53">gfAggressiveQueen</a>       = <a class="code" href="GameSettings_8cpp.html#5c32f930e2fef384505c4b91803a92c2">gGameExternalOptions</a>.<a class="code" href="structGAME__EXTERNAL__OPTIONS.html#5560e0e72a4b803607cba627293af00a">gfNormalAggressiveQueen</a>;
<a name="l03262"></a>03262                   <span class="keywordflow">break</span>;
<a name="l03263"></a>03263             <span class="keywordflow">case</span> <a class="code" href="GameSettings_8h.html#c205be2172292384dd687b5471a87edd3d0b73026f1c7122798d578613aa4575">DIF_LEVEL_HARD</a>:
<a name="l03264"></a>03264                   <a class="code" href="Strategic_01AI_8cpp.html#b0c12688f38630da4e064c85394ca570">gfUnlimitedTroops</a>       = <a class="code" href="GameSettings_8cpp.html#5c32f930e2fef384505c4b91803a92c2">gGameExternalOptions</a>.<a class="code" href="structGAME__EXTERNAL__OPTIONS.html#381f7d196f5798b965377b9ba625e4c3">gfHardUnlimitedTroops</a>;
<a name="l03265"></a>03265                   <a class="code" href="Strategic_01AI_8cpp.html#03888c7c25d0c7d4585ed03317d64c53">gfAggressiveQueen</a>       = <a class="code" href="GameSettings_8cpp.html#5c32f930e2fef384505c4b91803a92c2">gGameExternalOptions</a>.<a class="code" href="structGAME__EXTERNAL__OPTIONS.html#e50e2b0a6bdad88843de4764ef837b7f">gfHardAggressiveQueen</a>;
<a name="l03266"></a>03266                   <span class="keywordflow">break</span>;
<a name="l03267"></a>03267             <span class="keywordflow">case</span> <a class="code" href="GameSettings_8h.html#c205be2172292384dd687b5471a87eddc657c89fd754a6f20b3869250288a702">DIF_LEVEL_INSANE</a>:
<a name="l03268"></a>03268                   <a class="code" href="Strategic_01AI_8cpp.html#b0c12688f38630da4e064c85394ca570">gfUnlimitedTroops</a>       = <a class="code" href="GameSettings_8cpp.html#5c32f930e2fef384505c4b91803a92c2">gGameExternalOptions</a>.<a class="code" href="structGAME__EXTERNAL__OPTIONS.html#2e45c38dbae63f7ea59a8731fec8b2a7">gfInsaneUnlimitedTroops</a>;
<a name="l03269"></a>03269                   <a class="code" href="Strategic_01AI_8cpp.html#03888c7c25d0c7d4585ed03317d64c53">gfAggressiveQueen</a>       = <a class="code" href="GameSettings_8cpp.html#5c32f930e2fef384505c4b91803a92c2">gGameExternalOptions</a>.<a class="code" href="structGAME__EXTERNAL__OPTIONS.html#8c6aa4c5c98627e10cba4fcad4fffead">gfInsaneAggressiveQueen</a>;
<a name="l03270"></a>03270                   <span class="keywordflow">break</span>;
<a name="l03271"></a>03271       }
<a name="l03272"></a>03272 
<a name="l03273"></a>03273       DebugMsg (<a class="code" href="DEBUG_8cpp.html#a7985c2fd033797fc67a03b2c26e07c6">TOPIC_JA2</a>,DBG_LEVEL_3,<span class="stringliteral">"Strategic6"</span>);
<a name="l03274"></a>03274       <a class="code" href="FileMan_8cpp.html#1b213074411fd4c1dc8fd345e787b17e">FileRead</a>( hFile, <a class="code" href="Strategic_01AI_8cpp.html#c689ec381215b910ba04d356fe3b96ed">gbPadding2</a>,                                      3, &amp;uiNumBytesRead );
<a name="l03275"></a>03275       <span class="keywordflow">if</span>( uiNumBytesRead != 3 )
<a name="l03276"></a>03276             <span class="keywordflow">return</span> FALSE;
<a name="l03277"></a>03277       <a class="code" href="FileMan_8cpp.html#1b213074411fd4c1dc8fd345e787b17e">FileRead</a>( hFile, &amp;<a class="code" href="Strategic_01AI_8cpp.html#da8cb507523142e34aa6a62793f76a88">gfExtraElites</a>,                            1, &amp;uiNumBytesRead );
<a name="l03278"></a>03278       <span class="keywordflow">if</span>( uiNumBytesRead != 1 )
<a name="l03279"></a>03279             <span class="keywordflow">return</span> FALSE;
<a name="l03280"></a>03280       <a class="code" href="FileMan_8cpp.html#1b213074411fd4c1dc8fd345e787b17e">FileRead</a>( hFile, &amp;giGarrisonArraySize,          4, &amp;uiNumBytesRead );
<a name="l03281"></a>03281       <span class="keywordflow">if</span>( uiNumBytesRead != 4 )
<a name="l03282"></a>03282             <span class="keywordflow">return</span> FALSE;
<a name="l03283"></a>03283       <a class="code" href="FileMan_8cpp.html#1b213074411fd4c1dc8fd345e787b17e">FileRead</a>( hFile, &amp;giPatrolArraySize,                  4, &amp;uiNumBytesRead );
<a name="l03284"></a>03284       <span class="keywordflow">if</span>( uiNumBytesRead != 4 )
<a name="l03285"></a>03285             <span class="keywordflow">return</span> FALSE;
<a name="l03286"></a>03286       <a class="code" href="FileMan_8cpp.html#1b213074411fd4c1dc8fd345e787b17e">FileRead</a>( hFile, &amp;<a class="code" href="AI_01Viewer_8cpp.html#c86cd58021961af10f1eb15108a79023">giReinforcementPool</a>,          4, &amp;uiNumBytesRead );
<a name="l03287"></a>03287       <span class="keywordflow">if</span>( uiNumBytesRead != 4 )
<a name="l03288"></a>03288             <span class="keywordflow">return</span> FALSE;
<a name="l03289"></a>03289       <a class="code" href="FileMan_8cpp.html#1b213074411fd4c1dc8fd345e787b17e">FileRead</a>( hFile, &amp;<a class="code" href="Strategic_01AI_8cpp.html#dd33d20256198684ad819b0f877ba407">giForcePercentage</a>,                  4, &amp;uiNumBytesRead );
<a name="l03290"></a>03290       <span class="keywordflow">if</span>( uiNumBytesRead != 4 )
<a name="l03291"></a>03291             <span class="keywordflow">return</span> FALSE;
<a name="l03292"></a>03292       <a class="code" href="FileMan_8cpp.html#1b213074411fd4c1dc8fd345e787b17e">FileRead</a>( hFile, &amp;<a class="code" href="Strategic_01AI_8cpp.html#5ca96833bf812b9e43da8510ca54f00a">giArmyAlertness</a>,                    4, &amp;uiNumBytesRead );
<a name="l03293"></a>03293       <span class="keywordflow">if</span>( uiNumBytesRead != 4 )
<a name="l03294"></a>03294             <span class="keywordflow">return</span> FALSE;
<a name="l03295"></a>03295       <a class="code" href="FileMan_8cpp.html#1b213074411fd4c1dc8fd345e787b17e">FileRead</a>( hFile, &amp;<a class="code" href="Strategic_01AI_8cpp.html#1bdeafde98c11d85ed1f79f8c793b1bc">giArmyAlertnessDecay</a>,         4, &amp;uiNumBytesRead );
<a name="l03296"></a>03296       <span class="keywordflow">if</span>( uiNumBytesRead != 4 )
<a name="l03297"></a>03297             <span class="keywordflow">return</span> FALSE;
<a name="l03298"></a>03298       <a class="code" href="FileMan_8cpp.html#1b213074411fd4c1dc8fd345e787b17e">FileRead</a>( hFile, &amp;<a class="code" href="AI_01Viewer_8cpp.html#38284bd39764812fb8a27fe4d3d2b0cd">gfQueenAIAwake</a>,                           1, &amp;uiNumBytesRead );
<a name="l03299"></a>03299       <span class="keywordflow">if</span>( uiNumBytesRead != 1 )
<a name="l03300"></a>03300             <span class="keywordflow">return</span> FALSE;
<a name="l03301"></a>03301       <a class="code" href="FileMan_8cpp.html#1b213074411fd4c1dc8fd345e787b17e">FileRead</a>( hFile, &amp;<a class="code" href="AI_01Viewer_8cpp.html#a54cf2087c7e1b790053295a6bf90592">giReinforcementPoints</a>,  4, &amp;uiNumBytesRead );
<a name="l03302"></a>03302       <span class="keywordflow">if</span>( uiNumBytesRead != 4 )
<a name="l03303"></a>03303             <span class="keywordflow">return</span> FALSE;
<a name="l03304"></a>03304       <a class="code" href="FileMan_8cpp.html#1b213074411fd4c1dc8fd345e787b17e">FileRead</a>( hFile, &amp;<a class="code" href="AI_01Viewer_8cpp.html#c3390da297cb8068458f459fe9fc094f">giRequestPoints</a>,                    4, &amp;uiNumBytesRead );
<a name="l03305"></a>03305       <span class="keywordflow">if</span>( uiNumBytesRead != 4 )
<a name="l03306"></a>03306             <span class="keywordflow">return</span> FALSE;
<a name="l03307"></a>03307       <a class="code" href="FileMan_8cpp.html#1b213074411fd4c1dc8fd345e787b17e">FileRead</a>( hFile, &amp;<a class="code" href="Strategic_01AI_8cpp.html#ab475b2c021e0d3a27bc5f4c7bd22639">gubNumAwareBattles</a>,                 1, &amp;uiNumBytesRead );
<a name="l03308"></a>03308       <span class="keywordflow">if</span>( uiNumBytesRead != 1 )
<a name="l03309"></a>03309             <span class="keywordflow">return</span> FALSE;
<a name="l03310"></a>03310       <a class="code" href="FileMan_8cpp.html#1b213074411fd4c1dc8fd345e787b17e">FileRead</a>( hFile, &amp;ubSAIVersion,                                   1, &amp;uiNumBytesRead );
<a name="l03311"></a>03311       <span class="keywordflow">if</span>( uiNumBytesRead != 1 )
<a name="l03312"></a>03312             <span class="keywordflow">return</span> FALSE;
<a name="l03313"></a>03313       <a class="code" href="FileMan_8cpp.html#1b213074411fd4c1dc8fd345e787b17e">FileRead</a>( hFile, &amp;<a class="code" href="Strategic_01AI_8cpp.html#b6506b3e47eb797cd604d652eb70cdc3">gubQueenPriorityPhase</a>,  1, &amp;uiNumBytesRead );
<a name="l03314"></a>03314       <span class="keywordflow">if</span>( uiNumBytesRead != 1 )
<a name="l03315"></a>03315             <span class="keywordflow">return</span> FALSE;
<a name="l03316"></a>03316       <a class="code" href="FileMan_8cpp.html#1b213074411fd4c1dc8fd345e787b17e">FileRead</a>( hFile, &amp;<a class="code" href="Strategic_01AI_8cpp.html#25242025da42191e44f15d6f90efbaf7">gfFirstBattleMeanwhileScenePending</a>, 1, &amp;uiNumBytesRead );
<a name="l03317"></a>03317       <span class="keywordflow">if</span>( uiNumBytesRead != 1 )
<a name="l03318"></a>03318             <span class="keywordflow">return</span> FALSE;
<a name="l03319"></a>03319       <a class="code" href="FileMan_8cpp.html#1b213074411fd4c1dc8fd345e787b17e">FileRead</a>( hFile, &amp;<a class="code" href="Strategic_01AI_8cpp.html#ace9c47ca01a402ca45743ff70c9d70c">gfMassFortificationOrdered</a>,   1, &amp;uiNumBytesRead );
<a name="l03320"></a>03320       <span class="keywordflow">if</span>( uiNumBytesRead != 1 )
<a name="l03321"></a>03321             <span class="keywordflow">return</span> FALSE;
<a name="l03322"></a>03322       <a class="code" href="FileMan_8cpp.html#1b213074411fd4c1dc8fd345e787b17e">FileRead</a>( hFile, &amp;<a class="code" href="Strategic_01AI_8cpp.html#12b5525b1f3dabeac40700eecd3219e7">gubMinEnemyGroupSize</a>,   1, &amp;uiNumBytesRead );
<a name="l03323"></a>03323       <span class="keywordflow">if</span>( uiNumBytesRead != 1 )
<a name="l03324"></a>03324             <span class="keywordflow">return</span> FALSE;
<a name="l03325"></a>03325       <a class="code" href="FileMan_8cpp.html#1b213074411fd4c1dc8fd345e787b17e">FileRead</a>( hFile, &amp;<a class="code" href="Strategic_01AI_8cpp.html#123935928b8e3146a1edda9d78cfea62">gubHoursGracePeriod</a>, 1, &amp;uiNumBytesRead );
<a name="l03326"></a>03326       <span class="keywordflow">if</span>( uiNumBytesRead != 1 )
<a name="l03327"></a>03327             <span class="keywordflow">return</span> FALSE;
<a name="l03328"></a>03328       <a class="code" href="FileMan_8cpp.html#1b213074411fd4c1dc8fd345e787b17e">FileRead</a>( hFile, &amp;<a class="code" href="Strategic_01AI_8cpp.html#711cdebe533db7c45a8e7e88c6f312d6">gusPlayerBattleVictories</a>, 2, &amp;uiNumBytesRead );
<a name="l03329"></a>03329       <span class="keywordflow">if</span>( uiNumBytesRead != 2 )
<a name="l03330"></a>03330             <span class="keywordflow">return</span> FALSE;
<a name="l03331"></a>03331       <a class="code" href="FileMan_8cpp.html#1b213074411fd4c1dc8fd345e787b17e">FileRead</a>( hFile, &amp;<a class="code" href="Strategic_01AI_8cpp.html#8029ae4e0579eaec31822e170536fe40">gfUseAlternateQueenPosition</a>, 1, &amp;uiNumBytesRead );
<a name="l03332"></a>03332       <span class="keywordflow">if</span>( uiNumBytesRead != 1 )
<a name="l03333"></a>03333             <span class="keywordflow">return</span> FALSE;
<a name="l03334"></a>03334       <a class="code" href="FileMan_8cpp.html#1b213074411fd4c1dc8fd345e787b17e">FileRead</a>( hFile, <a class="code" href="Strategic_01AI_8cpp.html#e123fe3aeaaec0cd4c30b4599e299f84">gbPadding</a>,                                             SAI_PADDING_BYTES, &amp;uiNumBytesRead );
<a name="l03335"></a>03335       <span class="keywordflow">if</span>( uiNumBytesRead != SAI_PADDING_BYTES )
<a name="l03336"></a>03336             <span class="keywordflow">return</span> FALSE;
<a name="l03337"></a>03337       <span class="comment">//Restore the army composition </span>
<a name="l03338"></a>03338       <a class="code" href="FileMan_8cpp.html#1b213074411fd4c1dc8fd345e787b17e">FileRead</a>( hFile, <a class="code" href="AI_01Viewer_8cpp.html#77e448d1f208bd120f861571e6d0098f">gArmyComp</a>,   <a class="code" href="Strategic_01AI_8h.html#a9908284c0827729f14cf9b2489e1479d2a0278d1458eaa8c2bb99d2d4b55f00">NUM_ARMY_COMPOSITIONS</a> * <span class="keyword">sizeof</span>( <a class="code" href="structARMY__COMPOSITION.html">ARMY_COMPOSITION</a> ), &amp;uiNumBytesRead );
<a name="l03339"></a>03339       <span class="keywordflow">if</span>( uiNumBytesRead != <a class="code" href="Strategic_01AI_8h.html#a9908284c0827729f14cf9b2489e1479d2a0278d1458eaa8c2bb99d2d4b55f00">NUM_ARMY_COMPOSITIONS</a> * <span class="keyword">sizeof</span>( ARMY_COMPOSITION ) )
<a name="l03340"></a>03340             <span class="keywordflow">return</span> FALSE;
<a name="l03341"></a>03341       i = SAVED_ARMY_COMPOSITIONS - <a class="code" href="Strategic_01AI_8h.html#a9908284c0827729f14cf9b2489e1479d2a0278d1458eaa8c2bb99d2d4b55f00">NUM_ARMY_COMPOSITIONS</a>;
<a name="l03342"></a>03342       <span class="keywordflow">while</span>( i-- )
<a name="l03343"></a>03343       {
<a name="l03344"></a>03344             <a class="code" href="FileMan_8cpp.html#1b213074411fd4c1dc8fd345e787b17e">FileRead</a>( hFile, &amp;gTempArmyComp, <span class="keyword">sizeof</span>( ARMY_COMPOSITION ), &amp;uiNumBytesRead );
<a name="l03345"></a>03345             <span class="keywordflow">if</span>( uiNumBytesRead != <span class="keyword">sizeof</span>( ARMY_COMPOSITION ) )
<a name="l03346"></a>03346                   <span class="keywordflow">return</span> FALSE;
<a name="l03347"></a>03347       }
<a name="l03348"></a>03348 
<a name="l03349"></a>03349       <span class="comment">//Restore the patrol group definitions</span>
<a name="l03350"></a>03350       <span class="keywordflow">if</span>( <a class="code" href="Strategic_01AI_8cpp.html#9e00ccb0e77cec57208c519e8f831f53">gPatrolGroup</a> )
<a name="l03351"></a>03351       {
<a name="l03352"></a>03352             MemFree( <a class="code" href="Strategic_01AI_8cpp.html#9e00ccb0e77cec57208c519e8f831f53">gPatrolGroup</a> );
<a name="l03353"></a>03353       }
<a name="l03354"></a>03354       <a class="code" href="Strategic_01AI_8cpp.html#9e00ccb0e77cec57208c519e8f831f53">gPatrolGroup</a> = (<a class="code" href="structPATROL__GROUP.html">PATROL_GROUP</a>*)MemAlloc( giPatrolArraySize * <span class="keyword">sizeof</span>( <a class="code" href="structPATROL__GROUP.html">PATROL_GROUP</a> ) );
<a name="l03355"></a>03355       <a class="code" href="FileMan_8cpp.html#1b213074411fd4c1dc8fd345e787b17e">FileRead</a>( hFile, <a class="code" href="Strategic_01AI_8cpp.html#9e00ccb0e77cec57208c519e8f831f53">gPatrolGroup</a>, giPatrolArraySize * <span class="keyword">sizeof</span>( PATROL_GROUP ), &amp;uiNumBytesRead );
<a name="l03356"></a>03356       <span class="keywordflow">if</span>( uiNumBytesRead != giPatrolArraySize * <span class="keyword">sizeof</span>( PATROL_GROUP ) )
<a name="l03357"></a>03357             <span class="keywordflow">return</span> FALSE;
<a name="l03358"></a>03358       i = SAVED_PATROL_GROUPS - giPatrolArraySize;
<a name="l03359"></a>03359       <span class="keywordflow">while</span>( i-- )
<a name="l03360"></a>03360       {
<a name="l03361"></a>03361             <a class="code" href="FileMan_8cpp.html#1b213074411fd4c1dc8fd345e787b17e">FileRead</a>( hFile, &amp;gTempPatrolGroup, <span class="keyword">sizeof</span>( PATROL_GROUP ), &amp;uiNumBytesRead );
<a name="l03362"></a>03362             <span class="keywordflow">if</span>( uiNumBytesRead != <span class="keyword">sizeof</span>( PATROL_GROUP ) )
<a name="l03363"></a>03363                   <span class="keywordflow">return</span> FALSE;
<a name="l03364"></a>03364       }
<a name="l03365"></a>03365 
<a name="l03366"></a>03366       <a class="code" href="Strategic_01AI_8cpp.html#4f25955839f4d03d6e72fcb14e00fc96">gubSAIVersion</a> = SAI_VERSION;
<a name="l03367"></a>03367       <span class="comment">//Load the garrison information!</span>
<a name="l03368"></a>03368       <span class="keywordflow">if</span>( <a class="code" href="AI_01Viewer_8cpp.html#a9f940d7f3a6d6698bfaeb7c747d74a9">gGarrisonGroup</a> )
<a name="l03369"></a>03369       {
<a name="l03370"></a>03370             MemFree( <a class="code" href="AI_01Viewer_8cpp.html#a9f940d7f3a6d6698bfaeb7c747d74a9">gGarrisonGroup</a> );
<a name="l03371"></a>03371       }
<a name="l03372"></a>03372       <a class="code" href="AI_01Viewer_8cpp.html#a9f940d7f3a6d6698bfaeb7c747d74a9">gGarrisonGroup</a> = (<a class="code" href="structGARRISON__GROUP.html">GARRISON_GROUP</a>*)MemAlloc( giGarrisonArraySize * <span class="keyword">sizeof</span>( <a class="code" href="structGARRISON__GROUP.html">GARRISON_GROUP</a> ) );
<a name="l03373"></a>03373       <a class="code" href="FileMan_8cpp.html#1b213074411fd4c1dc8fd345e787b17e">FileRead</a>( hFile, <a class="code" href="AI_01Viewer_8cpp.html#a9f940d7f3a6d6698bfaeb7c747d74a9">gGarrisonGroup</a>, giGarrisonArraySize * <span class="keyword">sizeof</span>( GARRISON_GROUP ), &amp;uiNumBytesRead );
<a name="l03374"></a>03374       <span class="keywordflow">if</span>( uiNumBytesRead != giGarrisonArraySize * <span class="keyword">sizeof</span>( GARRISON_GROUP ) )
<a name="l03375"></a>03375       {
<a name="l03376"></a>03376             <span class="keywordflow">return</span> FALSE;
<a name="l03377"></a>03377       }
<a name="l03378"></a>03378       i = SAVED_GARRISON_GROUPS - giGarrisonArraySize;
<a name="l03379"></a>03379       <span class="keywordflow">while</span>( i-- )
<a name="l03380"></a>03380       {
<a name="l03381"></a>03381             <a class="code" href="FileMan_8cpp.html#1b213074411fd4c1dc8fd345e787b17e">FileRead</a>( hFile, &amp;gTempGarrisonGroup, <span class="keyword">sizeof</span>( GARRISON_GROUP ), &amp;uiNumBytesRead );
<a name="l03382"></a>03382             <span class="keywordflow">if</span>( uiNumBytesRead != <span class="keyword">sizeof</span>( GARRISON_GROUP ) )
<a name="l03383"></a>03383             {
<a name="l03384"></a>03384                   <span class="keywordflow">return</span> FALSE;
<a name="l03385"></a>03385             }
<a name="l03386"></a>03386       }
<a name="l03387"></a>03387       
<a name="l03388"></a>03388       <span class="comment">//Load the list of reinforcement patrol points.</span>
<a name="l03389"></a>03389       <span class="keywordflow">if</span>( <a class="code" href="Strategic_01AI_8cpp.html#48e0403413b13dc086dc70c6921ee186">gubPatrolReinforcementsDenied</a> )
<a name="l03390"></a>03390       {
<a name="l03391"></a>03391             MemFree( <a class="code" href="Strategic_01AI_8cpp.html#48e0403413b13dc086dc70c6921ee186">gubPatrolReinforcementsDenied</a> );
<a name="l03392"></a>03392             gubPatrolReinforcementsDenied = NULL;
<a name="l03393"></a>03393       }
<a name="l03394"></a>03394       <a class="code" href="Strategic_01AI_8cpp.html#48e0403413b13dc086dc70c6921ee186">gubPatrolReinforcementsDenied</a> = (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>*)MemAlloc( giPatrolArraySize );
<a name="l03395"></a>03395       <a class="code" href="FileMan_8cpp.html#1b213074411fd4c1dc8fd345e787b17e">FileRead</a>( hFile, <a class="code" href="Strategic_01AI_8cpp.html#48e0403413b13dc086dc70c6921ee186">gubPatrolReinforcementsDenied</a>, giPatrolArraySize, &amp;uiNumBytesRead );
<a name="l03396"></a>03396       <span class="keywordflow">if</span>( uiNumBytesRead != (<a class="code" href="Types_8h.html#e1e6edbbc26d6fbc71a90190d0266018">UINT32</a>)giPatrolArraySize )
<a name="l03397"></a>03397       {     
<a name="l03398"></a>03398             <span class="keywordflow">return</span> FALSE;
<a name="l03399"></a>03399       }     
<a name="l03400"></a>03400 
<a name="l03401"></a>03401       <span class="comment">//Load the list of reinforcement garrison points.</span>
<a name="l03402"></a>03402       <span class="keywordflow">if</span>( <a class="code" href="Strategic_01AI_8cpp.html#9bc393a708632bfedc7ce82ab9268709">gubGarrisonReinforcementsDenied</a> )
<a name="l03403"></a>03403       {
<a name="l03404"></a>03404             MemFree( <a class="code" href="Strategic_01AI_8cpp.html#9bc393a708632bfedc7ce82ab9268709">gubGarrisonReinforcementsDenied</a> );
<a name="l03405"></a>03405             gubGarrisonReinforcementsDenied = NULL;
<a name="l03406"></a>03406       }
<a name="l03407"></a>03407       <a class="code" href="Strategic_01AI_8cpp.html#9bc393a708632bfedc7ce82ab9268709">gubGarrisonReinforcementsDenied</a> = (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>*)MemAlloc( giGarrisonArraySize );
<a name="l03408"></a>03408       <a class="code" href="FileMan_8cpp.html#1b213074411fd4c1dc8fd345e787b17e">FileRead</a>( hFile, <a class="code" href="Strategic_01AI_8cpp.html#9bc393a708632bfedc7ce82ab9268709">gubGarrisonReinforcementsDenied</a>, giGarrisonArraySize, &amp;uiNumBytesRead );
<a name="l03409"></a>03409       <span class="keywordflow">if</span>( uiNumBytesRead != (<a class="code" href="Types_8h.html#e1e6edbbc26d6fbc71a90190d0266018">UINT32</a>)giGarrisonArraySize )
<a name="l03410"></a>03410       {     
<a name="l03411"></a>03411             <span class="keywordflow">return</span> FALSE;
<a name="l03412"></a>03412       }
<a name="l03413"></a>03413 
<a name="l03414"></a>03414 <span class="preprocessor">      #ifdef JA2BETAVERSION</span>
<a name="l03415"></a>03415 <span class="preprocessor"></span>            <a class="code" href="Campaign_01Init_8cpp.html#526499b5451f84a74376a66b349e28be">InitStrategicMovementCosts</a>();
<a name="l03416"></a>03416 <span class="preprocessor">      #endif</span>
<a name="l03417"></a>03417 <span class="preprocessor"></span>
<a name="l03418"></a>03418       <span class="keywordflow">if</span>( ubSAIVersion &lt; 6 )
<a name="l03419"></a>03419       { <span class="comment">//Reinitialize the costs since they have changed.</span>
<a name="l03420"></a>03420 
<a name="l03421"></a>03421             <span class="comment">//Recreate the compositions</span>
<a name="l03422"></a>03422             memcpy( <a class="code" href="AI_01Viewer_8cpp.html#77e448d1f208bd120f861571e6d0098f">gArmyComp</a>, <a class="code" href="Strategic_01AI_8cpp.html#ea7005fc7ef74a7dbbc1cb66d6520a89">gOrigArmyComp</a>, NUM_ARMY_COMPOSITIONS * <span class="keyword">sizeof</span>( ARMY_COMPOSITION ) );
<a name="l03423"></a>03423             <a class="code" href="Strategic_01AI_8cpp.html#d07e8dc3510ffd7b3bf0713c0a152ae2">EvolveQueenPriorityPhase</a>( TRUE );
<a name="l03424"></a>03424             
<a name="l03425"></a>03425             <span class="comment">//Recreate the patrol desired sizes</span>
<a name="l03426"></a>03426             <span class="keywordflow">for</span>( i = 0; i &lt; giPatrolArraySize; i++ )
<a name="l03427"></a>03427             {
<a name="l03428"></a>03428                   <a class="code" href="Strategic_01AI_8cpp.html#9e00ccb0e77cec57208c519e8f831f53">gPatrolGroup</a>[ i ].bSize = <a class="code" href="Strategic_01AI_8cpp.html#29576ac73bb4a2dfda85c992420d5b76">gOrigPatrolGroup</a>[ i ].bSize;
<a name="l03429"></a>03429             }
<a name="l03430"></a>03430       }
<a name="l03431"></a>03431       <span class="keywordflow">if</span>( ubSAIVersion &lt; 7 )
<a name="l03432"></a>03432       {
<a name="l03433"></a>03433             <a class="code" href="Campaign_01Init_8cpp.html#a588f1fc8a8722334dfff2f624f1321d">BuildUndergroundSectorInfoList</a>();
<a name="l03434"></a>03434       }
<a name="l03435"></a>03435       <span class="keywordflow">if</span>( ubSAIVersion &lt; 8 )
<a name="l03436"></a>03436       {
<a name="l03437"></a>03437             <a class="code" href="Strategic_01AI_8cpp.html#02069a813bd2498057799d302da2c08f">ReinitializeUnvisitedGarrisons</a>();
<a name="l03438"></a>03438       }
<a name="l03439"></a>03439       <span class="keywordflow">if</span>( ubSAIVersion &lt; 10 )
<a name="l03440"></a>03440       {
<a name="l03441"></a>03441             <span class="keywordflow">for</span>( i = 0; i &lt; giPatrolArraySize; i++ )
<a name="l03442"></a>03442             {
<a name="l03443"></a>03443                   <span class="keywordflow">if</span>( <a class="code" href="Strategic_01AI_8cpp.html#9e00ccb0e77cec57208c519e8f831f53">gPatrolGroup</a>[ i ].bSize &gt;= 16 )
<a name="l03444"></a>03444                   {
<a name="l03445"></a>03445                         <a class="code" href="Strategic_01AI_8cpp.html#9e00ccb0e77cec57208c519e8f831f53">gPatrolGroup</a>[ i ].bSize = 10;
<a name="l03446"></a>03446                   }
<a name="l03447"></a>03447             }
<a name="l03448"></a>03448             pGroup = <a class="code" href="Strategic_01Movement_8cpp.html#eb63397419934df48a7149753dff164e">gpGroupList</a>;
<a name="l03449"></a>03449             <span class="keywordflow">while</span>( pGroup )
<a name="l03450"></a>03450             {
<a name="l03451"></a>03451                   <span class="keywordflow">if</span>( !pGroup-&gt;<a class="code" href="structGROUP.html#1420d1afb0a1876a85b6b93308fbaf68">fPlayer</a> &amp;&amp; pGroup-&gt;<a class="code" href="structGROUP.html#2a98517c894019ee794e04ea05d1aeaf">ubGroupSize</a> &gt;= 16 )
<a name="l03452"></a>03452                   { <span class="comment">//accident in patrol groups being too large</span>
<a name="l03453"></a>03453                         <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubGetRidOfXTroops = pGroup-&gt;<a class="code" href="structGROUP.html#2a98517c894019ee794e04ea05d1aeaf">ubGroupSize</a> - 10;
<a name="l03454"></a>03454                         <span class="keywordflow">if</span>( <a class="code" href="strategicmap_8cpp.html#da715721a8ceedd42acf6ddb33e63ce0">gbWorldSectorZ</a> || pGroup-&gt;<a class="code" href="structGROUP.html#eee29372e834112984eab1dc714466c0">ubSectorX</a> != <a class="code" href="strategicmap_8cpp.html#49d9aed144a633fda4ba1990f002d703">gWorldSectorX</a> || pGroup-&gt;<a class="code" href="structGROUP.html#11cd63715d9daf1488cca330690db007">ubSectorY</a> != <a class="code" href="strategicmap_8cpp.html#ea322310ced0e35ee18a2ee7b32aac5b">gWorldSectorY</a> )
<a name="l03455"></a>03455                         { <span class="comment">//don't modify groups in the currently loaded sector.</span>
<a name="l03456"></a>03456                               <span class="keywordflow">if</span>( pGroup-&gt;<a class="code" href="structGROUP.html#f82ff4c3e504e4bb10feb65491f79471">pEnemyGroup</a>-&gt;<a class="code" href="structENEMYGROUP.html#27eaaea857408bc6c6358054c19f2d07">ubNumTroops</a> &gt;= ubGetRidOfXTroops )
<a name="l03457"></a>03457                               {
<a name="l03458"></a>03458                                     pGroup-&gt;<a class="code" href="structGROUP.html#f82ff4c3e504e4bb10feb65491f79471">pEnemyGroup</a>-&gt;<a class="code" href="structENEMYGROUP.html#27eaaea857408bc6c6358054c19f2d07">ubNumTroops</a> -= ubGetRidOfXTroops;
<a name="l03459"></a>03459                                     pGroup-&gt;<a class="code" href="structGROUP.html#2a98517c894019ee794e04ea05d1aeaf">ubGroupSize</a> -= ubGetRidOfXTroops;
<a name="l03460"></a>03460                               }
<a name="l03461"></a>03461                         }
<a name="l03462"></a>03462                   }
<a name="l03463"></a>03463                   pGroup = pGroup-&gt;next;
<a name="l03464"></a>03464             }
<a name="l03465"></a>03465       }
<a name="l03466"></a>03466       <span class="keywordflow">if</span>( ubSAIVersion &lt; 13 )
<a name="l03467"></a>03467       {
<a name="l03468"></a>03468             <span class="keywordflow">for</span>( i = 0; i &lt; 255; i++ )
<a name="l03469"></a>03469             {
<a name="l03470"></a>03470                   <a class="code" href="Campaign_01Types_8h.html#d83c6f699f17a47cf6a662c91d959126">SectorInfo</a>[ i ].bBloodCatPlacements = 0;
<a name="l03471"></a>03471                   <a class="code" href="Campaign_01Types_8h.html#d83c6f699f17a47cf6a662c91d959126">SectorInfo</a>[ i ].<a class="code" href="structSECTORINFO.html#d6b562cd0aeb924bca4c0415cdacd3f1">bBloodCats</a> = -1;
<a name="l03472"></a>03472             }
<a name="l03473"></a>03473             <a class="code" href="Game_01Init_8cpp.html#cf8e6c4b9c398af142f8b41287cbdccc">InitBloodCatSectors</a>();
<a name="l03474"></a>03474             <span class="comment">//This info is used to clean up the two new codes inserted into the</span>
<a name="l03475"></a>03475             <span class="comment">//middle of the enumeration for battle codes.</span>
<a name="l03476"></a>03476             <span class="keywordflow">if</span>( <a class="code" href="PreBattle_01Interface_8cpp.html#4ae96b9450aa7ad5b95e307b4f87f10d">gubEnemyEncounterCode</a> &gt; <a class="code" href="PreBattle_01Interface_8h.html#15b8f0a0cc23d28aafa1b827c46a5305fce046883bf0259f0fda7daff95f58e1">CREATURE_ATTACK_CODE</a> )
<a name="l03477"></a>03477             {
<a name="l03478"></a>03478                   <a class="code" href="PreBattle_01Interface_8cpp.html#4ae96b9450aa7ad5b95e307b4f87f10d">gubEnemyEncounterCode</a> += 2;
<a name="l03479"></a>03479             }
<a name="l03480"></a>03480             <span class="keywordflow">if</span>( <a class="code" href="PreBattle_01Interface_8cpp.html#01573933aa35362264e700c4a49abb0a">gubExplicitEnemyEncounterCode</a> &gt; <a class="code" href="PreBattle_01Interface_8h.html#15b8f0a0cc23d28aafa1b827c46a5305fce046883bf0259f0fda7daff95f58e1">CREATURE_ATTACK_CODE</a> )
<a name="l03481"></a>03481             {
<a name="l03482"></a>03482                   <a class="code" href="PreBattle_01Interface_8cpp.html#01573933aa35362264e700c4a49abb0a">gubExplicitEnemyEncounterCode</a> += 2;
<a name="l03483"></a>03483             }
<a name="l03484"></a>03484 
<a name="l03485"></a>03485       }
<a name="l03486"></a>03486       <span class="keywordflow">if</span>( ubSAIVersion &lt; 14 )
<a name="l03487"></a>03487       {
<a name="l03488"></a>03488             <a class="code" href="structUNDERGROUND__SECTORINFO.html">UNDERGROUND_SECTORINFO</a> *pSector;
<a name="l03489"></a>03489             pSector = <a class="code" href="Creature_01Spreading_8cpp.html#8416712124d291c97f383014e261bb16">FindUnderGroundSector</a>( 4, 11, 1 );
<a name="l03490"></a>03490             <span class="keywordflow">if</span>( pSector-&gt;<a class="code" href="structUNDERGROUND__SECTORINFO.html#bc461084597b30a130197b28a4051ada">ubNumTroops</a> + pSector-&gt;<a class="code" href="structUNDERGROUND__SECTORINFO.html#d87e227edee7612bd3e96539eeb46d92">ubNumElites</a> &gt; 20 )
<a name="l03491"></a>03491             {
<a name="l03492"></a>03492                   pSector-&gt;<a class="code" href="structUNDERGROUND__SECTORINFO.html#bc461084597b30a130197b28a4051ada">ubNumTroops</a> -= 2;
<a name="l03493"></a>03493             }
<a name="l03494"></a>03494             pSector = <a class="code" href="Creature_01Spreading_8cpp.html#8416712124d291c97f383014e261bb16">FindUnderGroundSector</a>( 3, 15, 1 );
<a name="l03495"></a>03495             <span class="keywordflow">if</span>( pSector-&gt;<a class="code" href="structUNDERGROUND__SECTORINFO.html#bc461084597b30a130197b28a4051ada">ubNumTroops</a> + pSector-&gt;<a class="code" href="structUNDERGROUND__SECTORINFO.html#d87e227edee7612bd3e96539eeb46d92">ubNumElites</a> &gt; 20 )
<a name="l03496"></a>03496             {
<a name="l03497"></a>03497                   pSector-&gt;<a class="code" href="structUNDERGROUND__SECTORINFO.html#bc461084597b30a130197b28a4051ada">ubNumTroops</a> -= 2;
<a name="l03498"></a>03498             }
<a name="l03499"></a>03499       }
<a name="l03500"></a>03500       <span class="keywordflow">if</span>( ubSAIVersion &lt; 16 )
<a name="l03501"></a>03501       {
<a name="l03502"></a>03502             <a class="code" href="structUNDERGROUND__SECTORINFO.html">UNDERGROUND_SECTORINFO</a> *pSector;
<a name="l03503"></a>03503             pSector = <a class="code" href="Creature_01Spreading_8cpp.html#8416712124d291c97f383014e261bb16">FindUnderGroundSector</a>( 3, 15, 1 );
<a name="l03504"></a>03504             <span class="keywordflow">if</span>( pSector )
<a name="l03505"></a>03505             {
<a name="l03506"></a>03506                   pSector-&gt;<a class="code" href="structUNDERGROUND__SECTORINFO.html#e2f0c4424965e88522e21d2af320f570">ubAdjacentSectors</a> |= SOUTH_ADJACENT_SECTOR;
<a name="l03507"></a>03507             }
<a name="l03508"></a>03508             pSector = <a class="code" href="Creature_01Spreading_8cpp.html#8416712124d291c97f383014e261bb16">FindUnderGroundSector</a>( 3, 16, 1 );
<a name="l03509"></a>03509             <span class="keywordflow">if</span>( pSector )
<a name="l03510"></a>03510             {
<a name="l03511"></a>03511                   pSector-&gt;<a class="code" href="structUNDERGROUND__SECTORINFO.html#e2f0c4424965e88522e21d2af320f570">ubAdjacentSectors</a> |= NORTH_ADJACENT_SECTOR;
<a name="l03512"></a>03512             }
<a name="l03513"></a>03513       }
<a name="l03514"></a>03514       <span class="keywordflow">if</span>( ubSAIVersion &lt; 17 )
<a name="l03515"></a>03515       { <span class="comment">//Patch all groups that have this flag set</span>
<a name="l03516"></a>03516             <a class="code" href="Strategic_01AI_8cpp.html#ab5d709f078af18573e35b5a6c215cdb">gubNumGroupsArrivedSimultaneously</a> = 0;
<a name="l03517"></a>03517             { 
<a name="l03518"></a>03518                   pGroup = <a class="code" href="Strategic_01Movement_8cpp.html#eb63397419934df48a7149753dff164e">gpGroupList</a>;
<a name="l03519"></a>03519                   <span class="keywordflow">while</span>( pGroup )
<a name="l03520"></a>03520                   {
<a name="l03521"></a>03521                         <span class="keywordflow">if</span>( pGroup-&gt;uiFlags &amp; GROUPFLAG_GROUP_ARRIVED_SIMULTANEOUSLY )
<a name="l03522"></a>03522                         {
<a name="l03523"></a>03523                               pGroup-&gt;<a class="code" href="structGROUP.html#fd22d7c51878a9cac7391af817ffea8b">uiFlags</a> &amp;= ~GROUPFLAG_GROUP_ARRIVED_SIMULTANEOUSLY;
<a name="l03524"></a>03524                         }
<a name="l03525"></a>03525                         pGroup = pGroup-&gt;next;        
<a name="l03526"></a>03526                   }
<a name="l03527"></a>03527             }
<a name="l03528"></a>03528       }
<a name="l03529"></a>03529       <span class="keywordflow">if</span>( ubSAIVersion &lt; 18 )
<a name="l03530"></a>03530       { <span class="comment">//adjust down the number of bloodcats based on difficulty in the two special bloodcat levels</span>
<a name="l03531"></a>03531             <span class="keywordflow">switch</span>( <a class="code" href="GameSettings_8cpp.html#f9f2d5fd368ccadcc26bebc202d52ae7">gGameOptions</a>.<a class="code" href="structGAME__OPTIONS.html#4fb44167906152722f6af5cc9f7c1a99">ubDifficultyLevel</a> )
<a name="l03532"></a>03532             {
<a name="l03533"></a>03533                   <span class="keywordflow">case</span> <a class="code" href="GameSettings_8h.html#c205be2172292384dd687b5471a87eddbd3b0d23f4dc30ef17b50a14c3f54589">DIF_LEVEL_EASY</a>: <span class="comment">//50%</span>
<a name="l03534"></a>03534                         <a class="code" href="Campaign_01Types_8h.html#d83c6f699f17a47cf6a662c91d959126">SectorInfo</a>[ <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643c0d966776074215ffc8795d29fe04b68">SEC_I16</a>     ].<a class="code" href="structSECTORINFO.html#5fa45b7e4eeb939b443e237ddbd21fb0">bBloodCatPlacements</a> = 14;
<a name="l03535"></a>03535                         <a class="code" href="Campaign_01Types_8h.html#d83c6f699f17a47cf6a662c91d959126">SectorInfo</a>[ <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c66026436e2a46748c66280f0d844e72da8249da">SEC_N5</a>      ].<a class="code" href="structSECTORINFO.html#5fa45b7e4eeb939b443e237ddbd21fb0">bBloodCatPlacements</a> = 13;
<a name="l03536"></a>03536                         <a class="code" href="Campaign_01Types_8h.html#d83c6f699f17a47cf6a662c91d959126">SectorInfo</a>[ <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643c0d966776074215ffc8795d29fe04b68">SEC_I16</a>     ].<a class="code" href="structSECTORINFO.html#d6b562cd0aeb924bca4c0415cdacd3f1">bBloodCats</a> = 14;
<a name="l03537"></a>03537                         <a class="code" href="Campaign_01Types_8h.html#d83c6f699f17a47cf6a662c91d959126">SectorInfo</a>[ <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c66026436e2a46748c66280f0d844e72da8249da">SEC_N5</a>      ].<a class="code" href="structSECTORINFO.html#d6b562cd0aeb924bca4c0415cdacd3f1">bBloodCats</a> = 13;
<a name="l03538"></a>03538                         <span class="keywordflow">break</span>;
<a name="l03539"></a>03539                   <span class="keywordflow">case</span> <a class="code" href="GameSettings_8h.html#c205be2172292384dd687b5471a87edddd0259b09fef163c6aa62268574191cb">DIF_LEVEL_MEDIUM</a>: <span class="comment">//75%</span>
<a name="l03540"></a>03540                         <a class="code" href="Campaign_01Types_8h.html#d83c6f699f17a47cf6a662c91d959126">SectorInfo</a>[ <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643c0d966776074215ffc8795d29fe04b68">SEC_I16</a>     ].<a class="code" href="structSECTORINFO.html#5fa45b7e4eeb939b443e237ddbd21fb0">bBloodCatPlacements</a> = 19;
<a name="l03541"></a>03541                         <a class="code" href="Campaign_01Types_8h.html#d83c6f699f17a47cf6a662c91d959126">SectorInfo</a>[ <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c66026436e2a46748c66280f0d844e72da8249da">SEC_N5</a>      ].<a class="code" href="structSECTORINFO.html#5fa45b7e4eeb939b443e237ddbd21fb0">bBloodCatPlacements</a> = 18;
<a name="l03542"></a>03542                         <a class="code" href="Campaign_01Types_8h.html#d83c6f699f17a47cf6a662c91d959126">SectorInfo</a>[ <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643c0d966776074215ffc8795d29fe04b68">SEC_I16</a>     ].<a class="code" href="structSECTORINFO.html#d6b562cd0aeb924bca4c0415cdacd3f1">bBloodCats</a> = 19;
<a name="l03543"></a>03543                         <a class="code" href="Campaign_01Types_8h.html#d83c6f699f17a47cf6a662c91d959126">SectorInfo</a>[ <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c66026436e2a46748c66280f0d844e72da8249da">SEC_N5</a>      ].<a class="code" href="structSECTORINFO.html#d6b562cd0aeb924bca4c0415cdacd3f1">bBloodCats</a> = 18;
<a name="l03544"></a>03544                   <span class="keywordflow">case</span> <a class="code" href="GameSettings_8h.html#c205be2172292384dd687b5471a87edd3d0b73026f1c7122798d578613aa4575">DIF_LEVEL_HARD</a>: <span class="comment">//100%</span>
<a name="l03545"></a>03545                         <a class="code" href="Campaign_01Types_8h.html#d83c6f699f17a47cf6a662c91d959126">SectorInfo</a>[ <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643c0d966776074215ffc8795d29fe04b68">SEC_I16</a>     ].<a class="code" href="structSECTORINFO.html#5fa45b7e4eeb939b443e237ddbd21fb0">bBloodCatPlacements</a> = 26;
<a name="l03546"></a>03546                         <a class="code" href="Campaign_01Types_8h.html#d83c6f699f17a47cf6a662c91d959126">SectorInfo</a>[ <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c66026436e2a46748c66280f0d844e72da8249da">SEC_N5</a>      ].<a class="code" href="structSECTORINFO.html#5fa45b7e4eeb939b443e237ddbd21fb0">bBloodCatPlacements</a> = 25;
<a name="l03547"></a>03547                         <a class="code" href="Campaign_01Types_8h.html#d83c6f699f17a47cf6a662c91d959126">SectorInfo</a>[ <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643c0d966776074215ffc8795d29fe04b68">SEC_I16</a>     ].<a class="code" href="structSECTORINFO.html#d6b562cd0aeb924bca4c0415cdacd3f1">bBloodCats</a> = 26;
<a name="l03548"></a>03548                         <a class="code" href="Campaign_01Types_8h.html#d83c6f699f17a47cf6a662c91d959126">SectorInfo</a>[ <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c66026436e2a46748c66280f0d844e72da8249da">SEC_N5</a>      ].<a class="code" href="structSECTORINFO.html#d6b562cd0aeb924bca4c0415cdacd3f1">bBloodCats</a> = 25;
<a name="l03549"></a>03549                         <span class="keywordflow">break</span>;
<a name="l03550"></a>03550                   <span class="keywordflow">case</span> <a class="code" href="GameSettings_8h.html#c205be2172292384dd687b5471a87eddc657c89fd754a6f20b3869250288a702">DIF_LEVEL_INSANE</a>: <span class="comment">//150%</span>
<a name="l03551"></a>03551                         <a class="code" href="Campaign_01Types_8h.html#d83c6f699f17a47cf6a662c91d959126">SectorInfo</a>[ <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643c0d966776074215ffc8795d29fe04b68">SEC_I16</a>     ].<a class="code" href="structSECTORINFO.html#5fa45b7e4eeb939b443e237ddbd21fb0">bBloodCatPlacements</a> = 39;
<a name="l03552"></a>03552                         <a class="code" href="Campaign_01Types_8h.html#d83c6f699f17a47cf6a662c91d959126">SectorInfo</a>[ <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c66026436e2a46748c66280f0d844e72da8249da">SEC_N5</a>      ].<a class="code" href="structSECTORINFO.html#5fa45b7e4eeb939b443e237ddbd21fb0">bBloodCatPlacements</a> = 37;
<a name="l03553"></a>03553                         <a class="code" href="Campaign_01Types_8h.html#d83c6f699f17a47cf6a662c91d959126">SectorInfo</a>[ <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643c0d966776074215ffc8795d29fe04b68">SEC_I16</a>     ].<a class="code" href="structSECTORINFO.html#d6b562cd0aeb924bca4c0415cdacd3f1">bBloodCats</a> = 39;
<a name="l03554"></a>03554                         <a class="code" href="Campaign_01Types_8h.html#d83c6f699f17a47cf6a662c91d959126">SectorInfo</a>[ <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c66026436e2a46748c66280f0d844e72da8249da">SEC_N5</a>      ].<a class="code" href="structSECTORINFO.html#d6b562cd0aeb924bca4c0415cdacd3f1">bBloodCats</a> = 37;
<a name="l03555"></a>03555                         <span class="keywordflow">break</span>;
<a name="l03556"></a>03556             }
<a name="l03557"></a>03557       }
<a name="l03558"></a>03558       <span class="keywordflow">if</span>( ubSAIVersion &lt; 19 )
<a name="l03559"></a>03559       {
<a name="l03560"></a>03560             <span class="comment">//Clear the garrison in C5</span>
<a name="l03561"></a>03561             <a class="code" href="AI_01Viewer_8cpp.html#77e448d1f208bd120f861571e6d0098f">gArmyComp</a>[ <a class="code" href="AI_01Viewer_8cpp.html#a9f940d7f3a6d6698bfaeb7c747d74a9">gGarrisonGroup</a>[ <a class="code" href="Campaign_01Types_8h.html#d83c6f699f17a47cf6a662c91d959126">SectorInfo</a>[ <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643b4a9c6bd17076909f1625214f756c093">SEC_C5</a> ].<a class="code" href="structSECTORINFO.html#9465931dad0e164d7d47814b66e454f0">ubGarrisonID</a> ].<a class="code" href="structGARRISON__GROUP.html#a8feee88c982ca594b5bb1fcd2971ea5">ubComposition</a> ].<a class="code" href="structARMY__COMPOSITION.html#ae9820933dc13e0351dbd9fe1daf8ab4">bPriority</a> = 0;
<a name="l03562"></a>03562             <a class="code" href="AI_01Viewer_8cpp.html#77e448d1f208bd120f861571e6d0098f">gArmyComp</a>[ <a class="code" href="AI_01Viewer_8cpp.html#a9f940d7f3a6d6698bfaeb7c747d74a9">gGarrisonGroup</a>[ <a class="code" href="Campaign_01Types_8h.html#d83c6f699f17a47cf6a662c91d959126">SectorInfo</a>[ <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643b4a9c6bd17076909f1625214f756c093">SEC_C5</a> ].<a class="code" href="structSECTORINFO.html#9465931dad0e164d7d47814b66e454f0">ubGarrisonID</a> ].<a class="code" href="structGARRISON__GROUP.html#a8feee88c982ca594b5bb1fcd2971ea5">ubComposition</a> ].<a class="code" href="structARMY__COMPOSITION.html#164db6c6c30629f43d42469671367c86">bDesiredPopulation</a> = 0;
<a name="l03563"></a>03563       }
<a name="l03564"></a>03564       <span class="keywordflow">if</span>( ubSAIVersion &lt; 20 )
<a name="l03565"></a>03565       {
<a name="l03566"></a>03566             <a class="code" href="AI_01Viewer_8cpp.html#77e448d1f208bd120f861571e6d0098f">gArmyComp</a>[ <a class="code" href="Strategic_01AI_8h.html#a9908284c0827729f14cf9b2489e147965167f5cd578be3792270cad11996571">QUEEN_DEFENCE</a> ].<a class="code" href="structARMY__COMPOSITION.html#164db6c6c30629f43d42469671367c86">bDesiredPopulation</a> = 32;
<a name="l03567"></a>03567             <a class="code" href="Campaign_01Types_8h.html#d83c6f699f17a47cf6a662c91d959126">SectorInfo</a>[ <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c66026438a2eb9999a6ad7c69c9ddbe2d95696ca">SEC_P3</a> ].<a class="code" href="structSECTORINFO.html#3c5312672399c40ec5a395e8bcfb0104">ubNumElites</a> = 32;
<a name="l03568"></a>03568       }
<a name="l03569"></a>03569       <span class="keywordflow">if</span>( ubSAIVersion &lt; 21 )
<a name="l03570"></a>03570       {
<a name="l03571"></a>03571             pGroup = <a class="code" href="Strategic_01Movement_8cpp.html#eb63397419934df48a7149753dff164e">gpGroupList</a>;
<a name="l03572"></a>03572             <span class="keywordflow">while</span>( pGroup )
<a name="l03573"></a>03573             {
<a name="l03574"></a>03574                   pGroup-&gt;<a class="code" href="structGROUP.html#fd22d7c51878a9cac7391af817ffea8b">uiFlags</a> = 0;
<a name="l03575"></a>03575                   pGroup = pGroup-&gt;next;
<a name="l03576"></a>03576             }
<a name="l03577"></a>03577       }
<a name="l03578"></a>03578       <span class="keywordflow">if</span>( ubSAIVersion &lt; 22 )
<a name="l03579"></a>03579       { <span class="comment">//adjust down the number of bloodcats based on difficulty in the two special bloodcat levels</span>
<a name="l03580"></a>03580             <span class="keywordflow">switch</span>( <a class="code" href="GameSettings_8cpp.html#f9f2d5fd368ccadcc26bebc202d52ae7">gGameOptions</a>.<a class="code" href="structGAME__OPTIONS.html#4fb44167906152722f6af5cc9f7c1a99">ubDifficultyLevel</a> )
<a name="l03581"></a>03581             {
<a name="l03582"></a>03582                   <span class="keywordflow">case</span> <a class="code" href="GameSettings_8h.html#c205be2172292384dd687b5471a87eddbd3b0d23f4dc30ef17b50a14c3f54589">DIF_LEVEL_EASY</a>: <span class="comment">//50%</span>
<a name="l03583"></a>03583                         <a class="code" href="Campaign_01Types_8h.html#d83c6f699f17a47cf6a662c91d959126">SectorInfo</a>[ <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c66026436e2a46748c66280f0d844e72da8249da">SEC_N5</a>      ].<a class="code" href="structSECTORINFO.html#5fa45b7e4eeb939b443e237ddbd21fb0">bBloodCatPlacements</a> = 8;
<a name="l03584"></a>03584                         <a class="code" href="Campaign_01Types_8h.html#d83c6f699f17a47cf6a662c91d959126">SectorInfo</a>[ <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c66026436e2a46748c66280f0d844e72da8249da">SEC_N5</a>      ].<a class="code" href="structSECTORINFO.html#d6b562cd0aeb924bca4c0415cdacd3f1">bBloodCats</a> = 10;
<a name="l03585"></a>03585                         <span class="keywordflow">break</span>;
<a name="l03586"></a>03586                   <span class="keywordflow">case</span> <a class="code" href="GameSettings_8h.html#c205be2172292384dd687b5471a87edddd0259b09fef163c6aa62268574191cb">DIF_LEVEL_MEDIUM</a>: <span class="comment">//75%</span>
<a name="l03587"></a>03587                         <a class="code" href="Campaign_01Types_8h.html#d83c6f699f17a47cf6a662c91d959126">SectorInfo</a>[ <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c66026436e2a46748c66280f0d844e72da8249da">SEC_N5</a>      ].<a class="code" href="structSECTORINFO.html#5fa45b7e4eeb939b443e237ddbd21fb0">bBloodCatPlacements</a> = 8;
<a name="l03588"></a>03588                         <a class="code" href="Campaign_01Types_8h.html#d83c6f699f17a47cf6a662c91d959126">SectorInfo</a>[ <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c66026436e2a46748c66280f0d844e72da8249da">SEC_N5</a>      ].<a class="code" href="structSECTORINFO.html#d6b562cd0aeb924bca4c0415cdacd3f1">bBloodCats</a> = 10;
<a name="l03589"></a>03589                   <span class="keywordflow">case</span> <a class="code" href="GameSettings_8h.html#c205be2172292384dd687b5471a87edd3d0b73026f1c7122798d578613aa4575">DIF_LEVEL_HARD</a>: <span class="comment">//100%</span>
<a name="l03590"></a>03590                         <a class="code" href="Campaign_01Types_8h.html#d83c6f699f17a47cf6a662c91d959126">SectorInfo</a>[ <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c66026436e2a46748c66280f0d844e72da8249da">SEC_N5</a>      ].<a class="code" href="structSECTORINFO.html#5fa45b7e4eeb939b443e237ddbd21fb0">bBloodCatPlacements</a> = 8;
<a name="l03591"></a>03591                         <a class="code" href="Campaign_01Types_8h.html#d83c6f699f17a47cf6a662c91d959126">SectorInfo</a>[ <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c66026436e2a46748c66280f0d844e72da8249da">SEC_N5</a>      ].<a class="code" href="structSECTORINFO.html#d6b562cd0aeb924bca4c0415cdacd3f1">bBloodCats</a> = 10;
<a name="l03592"></a>03592                         <span class="keywordflow">break</span>;
<a name="l03593"></a>03593                   <span class="keywordflow">case</span> <a class="code" href="GameSettings_8h.html#c205be2172292384dd687b5471a87eddc657c89fd754a6f20b3869250288a702">DIF_LEVEL_INSANE</a>: <span class="comment">//150%</span>
<a name="l03594"></a>03594                         <a class="code" href="Campaign_01Types_8h.html#d83c6f699f17a47cf6a662c91d959126">SectorInfo</a>[ <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c66026436e2a46748c66280f0d844e72da8249da">SEC_N5</a>      ].<a class="code" href="structSECTORINFO.html#5fa45b7e4eeb939b443e237ddbd21fb0">bBloodCatPlacements</a> = 12;
<a name="l03595"></a>03595                         <a class="code" href="Campaign_01Types_8h.html#d83c6f699f17a47cf6a662c91d959126">SectorInfo</a>[ <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c66026436e2a46748c66280f0d844e72da8249da">SEC_N5</a>      ].<a class="code" href="structSECTORINFO.html#d6b562cd0aeb924bca4c0415cdacd3f1">bBloodCats</a> = 15;
<a name="l03596"></a>03596                         <span class="keywordflow">break</span>;
<a name="l03597"></a>03597             }
<a name="l03598"></a>03598       }
<a name="l03599"></a>03599       <span class="keywordflow">if</span>( ubSAIVersion &lt; 23 )
<a name="l03600"></a>03600       {
<a name="l03601"></a>03601             <span class="keywordflow">if</span>( <a class="code" href="strategicmap_8cpp.html#49d9aed144a633fda4ba1990f002d703">gWorldSectorX</a> != 3 || <a class="code" href="strategicmap_8cpp.html#ea322310ced0e35ee18a2ee7b32aac5b">gWorldSectorY</a> != 16 || !<a class="code" href="strategicmap_8cpp.html#da715721a8ceedd42acf6ddb33e63ce0">gbWorldSectorZ</a> )
<a name="l03602"></a>03602             {
<a name="l03603"></a>03603                   <a class="code" href="Campaign_01Types_8h.html#d83c6f699f17a47cf6a662c91d959126">SectorInfo</a>[ <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c66026438a2eb9999a6ad7c69c9ddbe2d95696ca">SEC_P3</a> ].<a class="code" href="structSECTORINFO.html#3c5312672399c40ec5a395e8bcfb0104">ubNumElites</a> = 32;
<a name="l03604"></a>03604             }
<a name="l03605"></a>03605       }
<a name="l03606"></a>03606       <span class="keywordflow">if</span>( ubSAIVersion &lt; 24 )
<a name="l03607"></a>03607       {
<a name="l03608"></a>03608             <span class="comment">//If the queen has escaped to the basement, do not use the profile insertion info</span>
<a name="l03609"></a>03609             <span class="comment">//when we finally go down there, otherwise she will end up in the wrong spot, possibly inside</span>
<a name="l03610"></a>03610             <span class="comment">//the walls.</span>
<a name="l03611"></a>03611             <span class="keywordflow">if</span>( !<a class="code" href="Quests_8cpp.html#c2813b14c5c981423bf788f8f84a193a">gubFact</a>[ <a class="code" href="Quests_8h.html#aead3e57f613f07868a1b2afb6b943f1c2c1fc03e7f5f0870adbf041d9a26c6a">FACT_QUEEN_DEAD</a> ] &amp;&amp; <a class="code" href="Soldier_01Profile_8cpp.html#1bcff2c50b375b1eb32800aa12000289">gMercProfiles</a>[ <a class="code" href="Soldier_01Profile_8h.html#acaa92dcb344e96138c964deae3e2fa158561257be7e2f96f82c0fdb51d7f964">QUEEN</a> ].bSectorZ == 1 )
<a name="l03612"></a>03612             <span class="keywordflow">if</span>( <a class="code" href="strategicmap_8cpp.html#da715721a8ceedd42acf6ddb33e63ce0">gbWorldSectorZ</a> != 1 || <a class="code" href="strategicmap_8cpp.html#49d9aed144a633fda4ba1990f002d703">gWorldSectorX</a> != 16 || <a class="code" href="strategicmap_8cpp.html#ea322310ced0e35ee18a2ee7b32aac5b">gWorldSectorY</a> != 3 )
<a name="l03613"></a>03613             { <span class="comment">//We aren't in the basement sector</span>
<a name="l03614"></a>03614                   <a class="code" href="Soldier_01Profile_8cpp.html#1bcff2c50b375b1eb32800aa12000289">gMercProfiles</a>[ <a class="code" href="Soldier_01Profile_8h.html#acaa92dcb344e96138c964deae3e2fa158561257be7e2f96f82c0fdb51d7f964">QUEEN</a> ].<a class="code" href="structMERCPROFILESTRUCT.html#125ec7e3aa89a6f65e8cdb438a917c78">fUseProfileInsertionInfo</a> = FALSE;
<a name="l03615"></a>03615             }
<a name="l03616"></a>03616             <span class="keywordflow">else</span>
<a name="l03617"></a>03617             { <span class="comment">//We are in the basement sector, relocate queen to proper position.</span>
<a name="l03618"></a>03618                   <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a> i;
<a name="l03619"></a>03619                   <span class="keywordflow">for</span>( i = <a class="code" href="Overhead_8cpp.html#46bd754f8875c305ab18731ed10e3364">gTacticalStatus</a>.<a class="code" href="structTacticalStatusType.html#2ecddfe580bb019bc92cc4859eaf3edc">Team</a>[ CIV_TEAM ].<a class="code" href="structTacticalTeamType.html#f8fe819ad07b242f5dbf97fd4c69b00d">bFirstID</a>; i &lt;= <a class="code" href="Overhead_8cpp.html#46bd754f8875c305ab18731ed10e3364">gTacticalStatus</a>.<a class="code" href="structTacticalStatusType.html#2ecddfe580bb019bc92cc4859eaf3edc">Team</a>[ CIV_TEAM ].<a class="code" href="structTacticalTeamType.html#6a887279dad735dc302f21c1e559d5ce">bLastID</a>; i++ )
<a name="l03620"></a>03620                   {
<a name="l03621"></a>03621                         <span class="keywordflow">if</span>( <a class="code" href="Overhead_8cpp.html#2b9a828d7d92ec404b2f9a39fc001177">MercPtrs</a>[ i ]-&gt;ubProfile == <a class="code" href="Soldier_01Profile_8h.html#acaa92dcb344e96138c964deae3e2fa158561257be7e2f96f82c0fdb51d7f964">QUEEN</a> )
<a name="l03622"></a>03622                         { <span class="comment">//Found queen, relocate her to 16866</span>
<a name="l03623"></a>03623                               <a class="code" href="Scheduling_8cpp.html#7a0c7f336307bebeb49777d33fd1c7bb">BumpAnyExistingMerc</a>( 16866 );
<a name="l03624"></a>03624                               <a class="code" href="Strategic_01AI_8cpp.html#2884d9fa0a918d1311af93763422a36f">TeleportSoldier</a>( <a class="code" href="Overhead_8cpp.html#2b9a828d7d92ec404b2f9a39fc001177">MercPtrs</a>[ i ], 16866, TRUE );
<a name="l03625"></a>03625                               <span class="keywordflow">break</span>;
<a name="l03626"></a>03626                         }
<a name="l03627"></a>03627                   }
<a name="l03628"></a>03628             }
<a name="l03629"></a>03629       }
<a name="l03630"></a>03630       <span class="keywordflow">if</span>( ubSAIVersion &lt; 25 )
<a name="l03631"></a>03631       {
<a name="l03632"></a>03632             <span class="keywordflow">if</span>( <a class="code" href="Quests_8cpp.html#c2813b14c5c981423bf788f8f84a193a">gubFact</a>[ <a class="code" href="Quests_8h.html#aead3e57f613f07868a1b2afb6b943f103b7eacc13493600df2bc8a0a9fe195a">FACT_SKYRIDER_CLOSE_TO_CHOPPER</a> ] )
<a name="l03633"></a>03633             {
<a name="l03634"></a>03634                   <a class="code" href="Soldier_01Profile_8cpp.html#1bcff2c50b375b1eb32800aa12000289">gMercProfiles</a>[ <a class="code" href="Soldier_01Profile_8h.html#acaa92dcb344e96138c964deae3e2fa164abf8ac58e0b23e1e6525ac79396bac">SKYRIDER</a> ].<a class="code" href="structMERCPROFILESTRUCT.html#125ec7e3aa89a6f65e8cdb438a917c78">fUseProfileInsertionInfo</a> = FALSE;
<a name="l03635"></a>03635             }
<a name="l03636"></a>03636       }
<a name="l03637"></a>03637 
<a name="l03638"></a>03638       <span class="comment">//KM : July 21, 1999 patch fix</span>
<a name="l03639"></a>03639       <span class="keywordflow">if</span>( ubSAIVersion &lt; 26 )
<a name="l03640"></a>03640       {
<a name="l03641"></a>03641             <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a> i;
<a name="l03642"></a>03642             <span class="keywordflow">for</span>( i = 0; i &lt; 255; i++ )
<a name="l03643"></a>03643             {
<a name="l03644"></a>03644                   <span class="keywordflow">if</span>( <a class="code" href="Campaign_01Types_8h.html#d83c6f699f17a47cf6a662c91d959126">SectorInfo</a>[ i ].ubNumberOfCivsAtLevel[ <a class="code" href="Campaign_01Types_8h.html#6fde86696b9fb4575b16ddc150ff0a840b225c8d872b15875355f348d6e3335b">GREEN_MILITIA</a> ] + 
<a name="l03645"></a>03645                               <a class="code" href="Campaign_01Types_8h.html#d83c6f699f17a47cf6a662c91d959126">SectorInfo</a>[ i ].ubNumberOfCivsAtLevel[ <a class="code" href="Campaign_01Types_8h.html#6fde86696b9fb4575b16ddc150ff0a845612214b681e2988ea93890806802cc9">REGULAR_MILITIA</a> ] + 
<a name="l03646"></a>03646                               <a class="code" href="Campaign_01Types_8h.html#d83c6f699f17a47cf6a662c91d959126">SectorInfo</a>[ i ].ubNumberOfCivsAtLevel[ <a class="code" href="Campaign_01Types_8h.html#6fde86696b9fb4575b16ddc150ff0a840fcf7fc556b8af2f6d3ec39652d3a927">ELITE_MILITIA</a> ] &gt; 20 )
<a name="l03647"></a>03647                   {
<a name="l03648"></a>03648                         <a class="code" href="Campaign_01Types_8h.html#d83c6f699f17a47cf6a662c91d959126">SectorInfo</a>[ i ].ubNumberOfCivsAtLevel[ <a class="code" href="Campaign_01Types_8h.html#6fde86696b9fb4575b16ddc150ff0a840b225c8d872b15875355f348d6e3335b">GREEN_MILITIA</a> ] = 0;
<a name="l03649"></a>03649                         <a class="code" href="Campaign_01Types_8h.html#d83c6f699f17a47cf6a662c91d959126">SectorInfo</a>[ i ].<a class="code" href="structSECTORINFO.html#71d253db041a4884b9ae6335f52fb082">ubNumberOfCivsAtLevel</a>[ <a class="code" href="Campaign_01Types_8h.html#6fde86696b9fb4575b16ddc150ff0a845612214b681e2988ea93890806802cc9">REGULAR_MILITIA</a> ] = 20; 
<a name="l03650"></a>03650                         <a class="code" href="Campaign_01Types_8h.html#d83c6f699f17a47cf6a662c91d959126">SectorInfo</a>[ i ].<a class="code" href="structSECTORINFO.html#71d253db041a4884b9ae6335f52fb082">ubNumberOfCivsAtLevel</a>[ <a class="code" href="Campaign_01Types_8h.html#6fde86696b9fb4575b16ddc150ff0a840fcf7fc556b8af2f6d3ec39652d3a927">ELITE_MILITIA</a> ] = 0;
<a name="l03651"></a>03651                   }
<a name="l03652"></a>03652             }
<a name="l03653"></a>03653       }
<a name="l03654"></a>03654       
<a name="l03655"></a>03655       <span class="comment">//KM : August 4, 1999 patch fix</span>
<a name="l03656"></a>03656       <span class="comment">//     This addresses the problem of not having any soldiers in sector N7 when playing the game under easy difficulty.</span>
<a name="l03657"></a>03657       <span class="comment">//           If captured and interrogated, the player would find no soldiers defending the sector.  This changes the composition</span>
<a name="l03658"></a>03658       <span class="comment">//     so that it will always be there, and adds the soldiers accordingly if the sector isn't loaded when the update is made.</span>
<a name="l03659"></a>03659       <span class="keywordflow">if</span>( ubSAIVersion &lt; 27 )
<a name="l03660"></a>03660       {
<a name="l03661"></a>03661             <span class="keywordflow">if</span>( <a class="code" href="GameSettings_8cpp.html#f9f2d5fd368ccadcc26bebc202d52ae7">gGameOptions</a>.<a class="code" href="structGAME__OPTIONS.html#4fb44167906152722f6af5cc9f7c1a99">ubDifficultyLevel</a> == <a class="code" href="GameSettings_8h.html#c205be2172292384dd687b5471a87eddbd3b0d23f4dc30ef17b50a14c3f54589">DIF_LEVEL_EASY</a> )
<a name="l03662"></a>03662             {
<a name="l03663"></a>03663                   <span class="keywordflow">if</span>( <a class="code" href="strategicmap_8cpp.html#49d9aed144a633fda4ba1990f002d703">gWorldSectorX</a> != 7 || <a class="code" href="strategicmap_8cpp.html#ea322310ced0e35ee18a2ee7b32aac5b">gWorldSectorY</a> != 14 || <a class="code" href="strategicmap_8cpp.html#da715721a8ceedd42acf6ddb33e63ce0">gbWorldSectorZ</a> )
<a name="l03664"></a>03664                   {
<a name="l03665"></a>03665                         <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a> cnt, iRandom;
<a name="l03666"></a>03666                         <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a> iEliteChance, iTroopChance, iAdminChance;
<a name="l03667"></a>03667                         <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a> iStartPop, iDesiredPop, iPriority;
<a name="l03668"></a>03668                         <a class="code" href="structSECTORINFO.html">SECTORINFO</a> *pSector = NULL;
<a name="l03669"></a>03669 
<a name="l03670"></a>03670                         <span class="comment">//Change the garrison composition to LEVEL1_DEFENCE from LEVEL2_DEFENCE</span>
<a name="l03671"></a>03671                         pSector = &amp;<a class="code" href="Campaign_01Types_8h.html#d83c6f699f17a47cf6a662c91d959126">SectorInfo</a>[ <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c660264395584191ad2ce3459b97befd503aeb7c">SEC_N7</a> ];
<a name="l03672"></a>03672                         <a class="code" href="AI_01Viewer_8cpp.html#a9f940d7f3a6d6698bfaeb7c747d74a9">gGarrisonGroup</a>[ pSector-&gt;ubGarrisonID ].ubComposition = <a class="code" href="Strategic_01AI_8h.html#a9908284c0827729f14cf9b2489e14796cbe0f336c72d76846995060b0336228">LEVEL1_DEFENCE</a>;
<a name="l03673"></a>03673                         
<a name="l03674"></a>03674                         iStartPop = <a class="code" href="AI_01Viewer_8cpp.html#77e448d1f208bd120f861571e6d0098f">gArmyComp</a>[ <a class="code" href="AI_01Viewer_8cpp.html#a9f940d7f3a6d6698bfaeb7c747d74a9">gGarrisonGroup</a>[ pSector-&gt;ubGarrisonID ].ubComposition ].bStartPopulation;
<a name="l03675"></a>03675                         iDesiredPop = <a class="code" href="AI_01Viewer_8cpp.html#77e448d1f208bd120f861571e6d0098f">gArmyComp</a>[ <a class="code" href="AI_01Viewer_8cpp.html#a9f940d7f3a6d6698bfaeb7c747d74a9">gGarrisonGroup</a>[ pSector-&gt;ubGarrisonID ].ubComposition ].bDesiredPopulation;
<a name="l03676"></a>03676                         iPriority = <a class="code" href="AI_01Viewer_8cpp.html#77e448d1f208bd120f861571e6d0098f">gArmyComp</a>[ <a class="code" href="AI_01Viewer_8cpp.html#a9f940d7f3a6d6698bfaeb7c747d74a9">gGarrisonGroup</a>[ pSector-&gt;ubGarrisonID ].ubComposition ].bPriority;
<a name="l03677"></a>03677                         iEliteChance = <a class="code" href="AI_01Viewer_8cpp.html#77e448d1f208bd120f861571e6d0098f">gArmyComp</a>[ <a class="code" href="AI_01Viewer_8cpp.html#a9f940d7f3a6d6698bfaeb7c747d74a9">gGarrisonGroup</a>[ pSector-&gt;ubGarrisonID ].ubComposition ].bElitePercentage;
<a name="l03678"></a>03678                         iTroopChance = <a class="code" href="AI_01Viewer_8cpp.html#77e448d1f208bd120f861571e6d0098f">gArmyComp</a>[ <a class="code" href="AI_01Viewer_8cpp.html#a9f940d7f3a6d6698bfaeb7c747d74a9">gGarrisonGroup</a>[ pSector-&gt;ubGarrisonID ].ubComposition ].bTroopPercentage + iEliteChance;
<a name="l03679"></a>03679                         iAdminChance = <a class="code" href="AI_01Viewer_8cpp.html#77e448d1f208bd120f861571e6d0098f">gArmyComp</a>[ <a class="code" href="AI_01Viewer_8cpp.html#a9f940d7f3a6d6698bfaeb7c747d74a9">gGarrisonGroup</a>[ pSector-&gt;ubGarrisonID ].ubComposition ].bAdminPercentage;
<a name="l03680"></a>03680 
<a name="l03681"></a>03681                         <span class="keywordflow">if</span>( iStartPop )
<a name="l03682"></a>03682                         {
<a name="l03683"></a>03683                               <span class="comment">// if population is less than maximum</span>
<a name="l03684"></a>03684                               <span class="keywordflow">if</span>( iStartPop != iMaxEnemyGroupSize )
<a name="l03685"></a>03685                               {
<a name="l03686"></a>03686                                     <span class="comment">// then vary it a bit (+/- 25%)</span>
<a name="l03687"></a>03687                                     iStartPop = iStartPop * ( 100 + ( <a class="code" href="Random_8cpp.html#49f938d1313ab6ef09ac6223a16ac334">Random</a> ( 51 ) - 25 ) ) / 100;
<a name="l03688"></a>03688                               }
<a name="l03689"></a>03689 
<a name="l03690"></a>03690                               iStartPop = max( <a class="code" href="Strategic_01AI_8cpp.html#12b5525b1f3dabeac40700eecd3219e7">gubMinEnemyGroupSize</a>, min( iMaxEnemyGroupSize, iStartPop ) );
<a name="l03691"></a>03691                               cnt = iStartPop;
<a name="l03692"></a>03692 
<a name="l03693"></a>03693                               <span class="keywordflow">if</span>( iAdminChance )
<a name="l03694"></a>03694                               {
<a name="l03695"></a>03695                                     pSector-&gt;<a class="code" href="structUNDERGROUND__SECTORINFO.html#b235caae8385eb38122d8c6e550447bb">ubNumAdmins</a> = iAdminChance * iStartPop / 100;
<a name="l03696"></a>03696                               }
<a name="l03697"></a>03697                               <span class="keywordflow">else</span> <span class="keywordflow">while</span>( cnt-- )
<a name="l03698"></a>03698                               { <span class="comment">//for each person, randomly determine the types of each soldier.</span>
<a name="l03699"></a>03699                                     {
<a name="l03700"></a>03700                                           iRandom = <a class="code" href="Random_8cpp.html#49f938d1313ab6ef09ac6223a16ac334">Random</a>( 100 );
<a name="l03701"></a>03701                                           <span class="keywordflow">if</span>( iRandom &lt; iEliteChance )
<a name="l03702"></a>03702                                           {
<a name="l03703"></a>03703                                                 pSector-&gt;<a class="code" href="structUNDERGROUND__SECTORINFO.html#d87e227edee7612bd3e96539eeb46d92">ubNumElites</a>++;
<a name="l03704"></a>03704                                           }
<a name="l03705"></a>03705                                           <span class="keywordflow">else</span> <span class="keywordflow">if</span>( iRandom &lt; iTroopChance )
<a name="l03706"></a>03706                                           {
<a name="l03707"></a>03707                                                 pSector-&gt;<a class="code" href="structUNDERGROUND__SECTORINFO.html#bc461084597b30a130197b28a4051ada">ubNumTroops</a>++;
<a name="l03708"></a>03708                                           }
<a name="l03709"></a>03709                                     }
<a name="l03710"></a>03710                               }
<a name="l03711"></a>03711                         }
<a name="l03712"></a>03712                   }
<a name="l03713"></a>03713             }
<a name="l03714"></a>03714       }
<a name="l03715"></a>03715 
<a name="l03716"></a>03716       <span class="keywordflow">if</span>( ubSAIVersion &lt; 28 )
<a name="l03717"></a>03717       {
<a name="l03718"></a>03718             <a class="code" href="structGROUP.html">GROUP</a> *pNext;
<a name="l03719"></a>03719             <span class="keywordflow">if</span>( !<a class="code" href="strategic_8cpp.html#6f48fb0ea28e3d4889423290f1a6ede8">StrategicMap</a>[ CALCULATE_STRATEGIC_INDEX( 3, 16 ) ].fEnemyControlled )
<a name="l03720"></a>03720             { <span class="comment">//Eliminate all enemy groups in this sector, because the player owns the sector, and it is not</span>
<a name="l03721"></a>03721                   <span class="comment">//possible for them to spawn there!</span>
<a name="l03722"></a>03722                   pGroup = <a class="code" href="Strategic_01Movement_8cpp.html#eb63397419934df48a7149753dff164e">gpGroupList</a>;
<a name="l03723"></a>03723                   <span class="keywordflow">while</span>( pGroup )
<a name="l03724"></a>03724                   {
<a name="l03725"></a>03725                         pNext = pGroup-&gt;<a class="code" href="structGROUP.html#6ebc46983b08a66450c23516af0a3f72">next</a>;
<a name="l03726"></a>03726                         <span class="keywordflow">if</span>( !pGroup-&gt;fPlayer )
<a name="l03727"></a>03727                         {
<a name="l03728"></a>03728                               <span class="keywordflow">if</span>( pGroup-&gt;ubSectorX == 3 &amp;&amp; pGroup-&gt;ubSectorY == 16 &amp;&amp; !pGroup-&gt;ubPrevX &amp;&amp; !pGroup-&gt;ubPrevY )
<a name="l03729"></a>03729                               {
<a name="l03730"></a>03730                                     <a class="code" href="Auto_01Resolve_8cpp.html#bf99843dcb604b6d631665205f1a3d42">ClearPreviousAIGroupAssignment</a>( pGroup );
<a name="l03731"></a>03731                                     <a class="code" href="Strategic_01Movement_8cpp.html#4c74797932f53c0eeed849a864ba4522">RemovePGroup</a>( pGroup );
<a name="l03732"></a>03732                               }
<a name="l03733"></a>03733                         }
<a name="l03734"></a>03734                         pGroup = pNext;
<a name="l03735"></a>03735                   }
<a name="l03736"></a>03736             }
<a name="l03737"></a>03737       }
<a name="l03738"></a>03738       <span class="keywordflow">if</span>( ubSAIVersion &lt; 29 )
<a name="l03739"></a>03739       {
<a name="l03740"></a>03740             <a class="code" href="Campaign_01Init_8cpp.html#526499b5451f84a74376a66b349e28be">InitStrategicMovementCosts</a>();
<a name="l03741"></a>03741       }
<a name="l03742"></a>03742 
<a name="l03743"></a>03743       <span class="comment">//KM : Aug 11, 1999 -- Patch fix:  Blindly update the airspace control.  There is a bug somewhere </span>
<a name="l03744"></a>03744       <span class="comment">//           that is failing to keep this information up to date, and I failed to find it.  At least this </span>
<a name="l03745"></a>03745       <span class="comment">//           will patch saves.</span>
<a name="l03746"></a>03746       <a class="code" href="strategicmap_8cpp.html#87800185621638e2150e614a03733808">UpdateAirspaceControl</a>( );
<a name="l03747"></a>03747 
<a name="l03748"></a>03748       <a class="code" href="Strategic_01AI_8cpp.html#d07e8dc3510ffd7b3bf0713c0a152ae2">EvolveQueenPriorityPhase</a>( TRUE );
<a name="l03749"></a>03749 
<a name="l03750"></a>03750       <span class="comment">//Count and correct the floating groups</span>
<a name="l03751"></a>03751       pGroup = <a class="code" href="Strategic_01Movement_8cpp.html#eb63397419934df48a7149753dff164e">gpGroupList</a>;
<a name="l03752"></a>03752       <span class="keywordflow">while</span>( pGroup )
<a name="l03753"></a>03753       {
<a name="l03754"></a>03754             next = pGroup-&gt;<a class="code" href="structGROUP.html#6ebc46983b08a66450c23516af0a3f72">next</a>; <span class="comment">//store the next node as pGroup could be deleted!</span>
<a name="l03755"></a>03755             <span class="keywordflow">if</span>( !pGroup-&gt;fPlayer )
<a name="l03756"></a>03756             {
<a name="l03757"></a>03757                   <span class="keywordflow">if</span>( !pGroup-&gt;fBetweenSectors )
<a name="l03758"></a>03758                   {
<a name="l03759"></a>03759                         <span class="keywordflow">if</span>( pGroup-&gt;ubSectorX != <a class="code" href="strategicmap_8cpp.html#49d9aed144a633fda4ba1990f002d703">gWorldSectorX</a> ||
<a name="l03760"></a>03760                                     pGroup-&gt;ubSectorY != <a class="code" href="strategicmap_8cpp.html#ea322310ced0e35ee18a2ee7b32aac5b">gWorldSectorY</a> ||
<a name="l03761"></a>03761                                     <a class="code" href="strategicmap_8cpp.html#da715721a8ceedd42acf6ddb33e63ce0">gbWorldSectorZ</a> )
<a name="l03762"></a>03762                         {
<a name="l03763"></a>03763                               <a class="code" href="Strategic_01AI_8cpp.html#e0836a6d95b37a4b2ba93e1e1980ecca">RepollSAIGroup</a>( pGroup );
<a name="l03764"></a>03764                               <a class="code" href="Strategic_01AI_8cpp.html#3c3091ef7361288e9f4f6a95cb067980">ValidateGroup</a>( pGroup );
<a name="l03765"></a>03765                         }
<a name="l03766"></a>03766                   }
<a name="l03767"></a>03767             }
<a name="l03768"></a>03768             pGroup = next; <span class="comment">//advance the node</span>
<a name="l03769"></a>03769       }
<a name="l03770"></a>03770 
<a name="l03771"></a>03771 <span class="preprocessor">      #ifdef JA2BETAVERSION</span>
<a name="l03772"></a>03772 <span class="preprocessor"></span>            <a class="code" href="Strategic_01AI_8cpp.html#d90b3ef039d953753e7b2637c16229cf">LogStrategicMsg</a>( <span class="stringliteral">""</span> );
<a name="l03773"></a>03773             <a class="code" href="Strategic_01AI_8cpp.html#d90b3ef039d953753e7b2637c16229cf">LogStrategicMsg</a>( <span class="stringliteral">"-------------------------------------------------"</span> );
<a name="l03774"></a>03774             <a class="code" href="Strategic_01AI_8cpp.html#d90b3ef039d953753e7b2637c16229cf">LogStrategicMsg</a>( <span class="stringliteral">"Restoring saved game at Day %02d, %02d:%02d "</span>, <a class="code" href="Game_01Clock_8cpp.html#41db6fb136e18cfede5f7c1eea89d7fb">GetWorldDay</a>(), <a class="code" href="Game_01Clock_8cpp.html#aa4fa6e3482d5d15cd7c6fb1d37892e1">GetWorldHour</a>(), <a class="code" href="Game_01Clock_8cpp.html#c52790b3f2caff24dbd9d8aa2f4b8194">GetWorldMinutesInDay</a>()%60 );
<a name="l03775"></a>03775             <a class="code" href="Strategic_01AI_8cpp.html#d90b3ef039d953753e7b2637c16229cf">LogStrategicMsg</a>( <span class="stringliteral">"-------------------------------------------------"</span> );
<a name="l03776"></a>03776             <a class="code" href="Strategic_01AI_8cpp.html#d90b3ef039d953753e7b2637c16229cf">LogStrategicMsg</a>( <span class="stringliteral">""</span> );
<a name="l03777"></a>03777 <span class="preprocessor">      #endif</span>
<a name="l03778"></a>03778 <span class="preprocessor"></span>
<a name="l03779"></a>03779       <span class="comment">//Update the version number to the most current.</span>
<a name="l03780"></a>03780       <a class="code" href="Strategic_01AI_8cpp.html#4f25955839f4d03d6e72fcb14e00fc96">gubSAIVersion</a> = SAI_VERSION;
<a name="l03781"></a>03781       
<a name="l03782"></a>03782       <a class="code" href="Strategic_01AI_8cpp.html#75d774eb03c41b5fe422edfef6e445d4">ValidateWeights</a>( 28 );
<a name="l03783"></a>03783       <a class="code" href="Strategic_01AI_8cpp.html#6447b1863729a0af153094f1246a27e8">ValidatePendingGroups</a>();
<a name="l03784"></a>03784 <span class="preprocessor">      #ifdef JA2BETAVERSION</span>
<a name="l03785"></a>03785 <span class="preprocessor"></span>            <a class="code" href="Strategic_01AI_8cpp.html#6ad6e766f5a175739a5295f19d0f0bd0">ValidatePlayersAreInOneGroupOnly</a>();
<a name="l03786"></a>03786 <span class="preprocessor">      #endif</span>
<a name="l03787"></a>03787 <span class="preprocessor"></span>
<a name="l03788"></a>03788       <span class="keywordflow">return</span> TRUE;
<a name="l03789"></a>03789 }
<a name="l03790"></a>03790 
<a name="l03791"></a><a class="code" href="Strategic_01AI_8cpp.html#d07e8dc3510ffd7b3bf0713c0a152ae2">03791</a> <span class="keywordtype">void</span> <a class="code" href="Strategic_01AI_8cpp.html#d07e8dc3510ffd7b3bf0713c0a152ae2">EvolveQueenPriorityPhase</a>( <a class="code" href="Types_8h.html#112e3146cb38b6ee95e64d85842e380a">BOOLEAN</a> fForceChange )
<a name="l03792"></a>03792 {
<a name="l03793"></a>03793       <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a> i, <a class="code" href="Mss-old_8h.html#1055c751d84f86b769064b5c89d2e1c8">index</a>, num, iFactor;
<a name="l03794"></a>03794       <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a> iChange, iNew, iNumSoldiers, iNumPromotions;
<a name="l03795"></a>03795       <a class="code" href="structSECTORINFO.html">SECTORINFO</a> *pSector;
<a name="l03796"></a>03796       <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubOwned[ <a class="code" href="Strategic_01AI_8h.html#a9908284c0827729f14cf9b2489e1479d2a0278d1458eaa8c2bb99d2d4b55f00">NUM_ARMY_COMPOSITIONS</a> ];
<a name="l03797"></a>03797       <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubTotal[ <a class="code" href="Strategic_01AI_8h.html#a9908284c0827729f14cf9b2489e1479d2a0278d1458eaa8c2bb99d2d4b55f00">NUM_ARMY_COMPOSITIONS</a> ];
<a name="l03798"></a>03798       <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubNewPhase;
<a name="l03799"></a>03799       ubNewPhase = <a class="code" href="Campaign_8cpp.html#96236f8fe1389ac2394c491ab8dd6924">CurrentPlayerProgressPercentage</a>() / 10;
<a name="l03800"></a>03800       <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a> iMaxEnemyGroupSize = <a class="code" href="GameSettings_8cpp.html#5c32f930e2fef384505c4b91803a92c2">gGameExternalOptions</a>.<a class="code" href="structGAME__EXTERNAL__OPTIONS.html#e0dd958b9c8219730a767a875dda20d5">iMaxEnemyGroupSize</a>;
<a name="l03801"></a>03801 DebugMsg (<a class="code" href="DEBUG_8cpp.html#a7985c2fd033797fc67a03b2c26e07c6">TOPIC_JA2</a>,DBG_LEVEL_3,<span class="stringliteral">"Strategic7"</span>);
<a name="l03802"></a>03802 
<a name="l03803"></a>03803       <span class="keywordflow">if</span>( !fForceChange &amp;&amp; ubNewPhase == <a class="code" href="Strategic_01AI_8cpp.html#b6506b3e47eb797cd604d652eb70cdc3">gubQueenPriorityPhase</a> )
<a name="l03804"></a>03804       {
<a name="l03805"></a>03805             <span class="keywordflow">return</span>;
<a name="l03806"></a>03806       }
<a name="l03807"></a>03807 
<a name="l03808"></a>03808       <span class="keywordflow">if</span>( <a class="code" href="Strategic_01AI_8cpp.html#b6506b3e47eb797cd604d652eb70cdc3">gubQueenPriorityPhase</a> &gt; ubNewPhase )
<a name="l03809"></a>03809       {
<a name="l03810"></a>03810 <span class="preprocessor">            #ifdef JA2BETAVERSION</span>
<a name="l03811"></a>03811 <span class="preprocessor"></span>                  <a class="code" href="Strategic_01AI_8cpp.html#984e97af1f29d3b417cc5bdcd126cfca">LogStrategicEvent</a>( <span class="stringliteral">"The queen's defence priority has decreased from %d0%% to %d0%%."</span>, <a class="code" href="Strategic_01AI_8cpp.html#b6506b3e47eb797cd604d652eb70cdc3">gubQueenPriorityPhase</a>, ubNewPhase );
<a name="l03812"></a>03812 <span class="preprocessor">            #endif</span>
<a name="l03813"></a>03813 <span class="preprocessor"></span>      }
<a name="l03814"></a>03814       <span class="keywordflow">else</span> <span class="keywordflow">if</span>( <a class="code" href="Strategic_01AI_8cpp.html#b6506b3e47eb797cd604d652eb70cdc3">gubQueenPriorityPhase</a> &lt; ubNewPhase )
<a name="l03815"></a>03815       {
<a name="l03816"></a>03816 <span class="preprocessor">            #ifdef JA2BETAVERSION</span>
<a name="l03817"></a>03817 <span class="preprocessor"></span>                  <a class="code" href="Strategic_01AI_8cpp.html#984e97af1f29d3b417cc5bdcd126cfca">LogStrategicEvent</a>( <span class="stringliteral">"The queen's defence priority has increased from %d0%% to %d0%%."</span>, <a class="code" href="Strategic_01AI_8cpp.html#b6506b3e47eb797cd604d652eb70cdc3">gubQueenPriorityPhase</a>, ubNewPhase );
<a name="l03818"></a>03818 <span class="preprocessor">            #endif</span>
<a name="l03819"></a>03819 <span class="preprocessor"></span>      } 
<a name="l03820"></a>03820   <span class="keywordflow">else</span> 
<a name="l03821"></a>03821   {
<a name="l03822"></a>03822 <span class="preprocessor">            #ifdef JA2BETAVERSION</span>
<a name="l03823"></a>03823 <span class="preprocessor"></span>                  <a class="code" href="Strategic_01AI_8cpp.html#984e97af1f29d3b417cc5bdcd126cfca">LogStrategicEvent</a>( <span class="stringliteral">"The queen's defence priority is the same (%d0%%), but has been forced to update."</span>, <a class="code" href="Strategic_01AI_8cpp.html#b6506b3e47eb797cd604d652eb70cdc3">gubQueenPriorityPhase</a> );
<a name="l03824"></a>03824 <span class="preprocessor">            #endif</span>
<a name="l03825"></a>03825 <span class="preprocessor"></span>  }
<a name="l03826"></a>03826 
<a name="l03827"></a>03827       <a class="code" href="Strategic_01AI_8cpp.html#b6506b3e47eb797cd604d652eb70cdc3">gubQueenPriorityPhase</a> = ubNewPhase;
<a name="l03828"></a>03828 
<a name="l03829"></a>03829       <span class="comment">//The phase value refers to the deviation percentage she will apply to original garrison values.  </span>
<a name="l03830"></a>03830       <span class="comment">//All sector values are evaluated to see how many of those sectors are enemy controlled.  If they </span>
<a name="l03831"></a>03831       <span class="comment">//are controlled by her, the desired number will be increased as well as the priority.  On the other</span>
<a name="l03832"></a>03832       <span class="comment">//hand, if she doesn't own those sectors, the values will be decreased instead.  All values are based off of</span>
<a name="l03833"></a>03833       <span class="comment">//the originals.</span>
<a name="l03834"></a>03834       memset( ubOwned, 0, <a class="code" href="Strategic_01AI_8h.html#a9908284c0827729f14cf9b2489e1479d2a0278d1458eaa8c2bb99d2d4b55f00">NUM_ARMY_COMPOSITIONS</a> );
<a name="l03835"></a>03835       memset( ubTotal, 0, <a class="code" href="Strategic_01AI_8h.html#a9908284c0827729f14cf9b2489e1479d2a0278d1458eaa8c2bb99d2d4b55f00">NUM_ARMY_COMPOSITIONS</a> );
<a name="l03836"></a>03836 
<a name="l03837"></a>03837       <span class="comment">//Record the values required to calculate the percentage of each composition type that the queen controls.</span>
<a name="l03838"></a>03838       <span class="keywordflow">for</span>( i = 0; i &lt; giGarrisonArraySize; i++ )
<a name="l03839"></a>03839       {
<a name="l03840"></a>03840             index = <a class="code" href="AI_01Viewer_8cpp.html#a9f940d7f3a6d6698bfaeb7c747d74a9">gGarrisonGroup</a>[ i ].ubComposition;
<a name="l03841"></a>03841             <span class="keywordflow">if</span>( <a class="code" href="strategic_8cpp.html#6f48fb0ea28e3d4889423290f1a6ede8">StrategicMap</a>[ SECTOR_INFO_TO_STRATEGIC_INDEX( <a class="code" href="AI_01Viewer_8cpp.html#a9f940d7f3a6d6698bfaeb7c747d74a9">gGarrisonGroup</a>[ i ].ubSectorID ) ].fEnemyControlled )
<a name="l03842"></a>03842             {
<a name="l03843"></a>03843                   ubOwned[ index ]++;
<a name="l03844"></a>03844             }
<a name="l03845"></a>03845             ubTotal[ index ]++;
<a name="l03846"></a>03846       }
<a name="l03847"></a>03847 
<a name="l03848"></a>03848       <span class="comment">//Go through the *majority* of compositions and modify the priority/desired values.</span>
<a name="l03849"></a>03849       <span class="keywordflow">for</span>( i = 0; i &lt; <a class="code" href="Strategic_01AI_8h.html#a9908284c0827729f14cf9b2489e1479d2a0278d1458eaa8c2bb99d2d4b55f00">NUM_ARMY_COMPOSITIONS</a>; i++ )
<a name="l03850"></a>03850       {
<a name="l03851"></a>03851             <span class="keywordflow">switch</span>( i )
<a name="l03852"></a>03852             {
<a name="l03853"></a>03853                   <span class="keywordflow">case</span> <a class="code" href="Strategic_01AI_8h.html#a9908284c0827729f14cf9b2489e147965167f5cd578be3792270cad11996571">QUEEN_DEFENCE</a>:
<a name="l03854"></a>03854                   <span class="keywordflow">case</span> <a class="code" href="Strategic_01AI_8h.html#a9908284c0827729f14cf9b2489e14793e66ffb942bed0fab28ff4d79f69e15e">MEDUNA_DEFENCE</a>:
<a name="l03855"></a>03855                   <span class="keywordflow">case</span> <a class="code" href="Strategic_01AI_8h.html#a9908284c0827729f14cf9b2489e1479a91a1f25028af94853c7302608b93300">MEDUNA_SAMSITE</a>:
<a name="l03856"></a>03856                   <span class="keywordflow">case</span> <a class="code" href="Strategic_01AI_8h.html#a9908284c0827729f14cf9b2489e14796cbe0f336c72d76846995060b0336228">LEVEL1_DEFENCE</a>:
<a name="l03857"></a>03857                   <span class="keywordflow">case</span> <a class="code" href="Strategic_01AI_8h.html#a9908284c0827729f14cf9b2489e1479a20161605655b8a279cc33b5b05ef22e">LEVEL2_DEFENCE</a>:
<a name="l03858"></a>03858                   <span class="keywordflow">case</span> <a class="code" href="Strategic_01AI_8h.html#a9908284c0827729f14cf9b2489e1479af824648f2c39e0defaa7dc6488a18b6">LEVEL3_DEFENCE</a>:
<a name="l03859"></a>03859                   <span class="keywordflow">case</span> <a class="code" href="Strategic_01AI_8h.html#a9908284c0827729f14cf9b2489e1479f2728e546e13a252b4ab14fb153f189f">OMERTA_WELCOME_WAGON</a>:
<a name="l03860"></a>03860                   <span class="keywordflow">case</span> <a class="code" href="Strategic_01AI_8h.html#a9908284c0827729f14cf9b2489e14791d6fc6dded07a09f3dddfd8789f69eb0">ROADBLOCK</a>:
<a name="l03861"></a>03861                   <span class="comment">//case SANMONA_SMALL:</span>
<a name="l03862"></a>03862                         <span class="comment">//don't consider these compositions</span>
<a name="l03863"></a>03863                         <span class="keywordflow">continue</span>;
<a name="l03864"></a>03864             }
<a name="l03865"></a>03865             <span class="comment">//If the queen owns them ALL, then she gets the maximum defensive bonus.  If she owns NONE,</span>
<a name="l03866"></a>03866             <span class="comment">//then she gets a maximum defensive penalty.  Everything else lies in the middle.  The legal</span>
<a name="l03867"></a>03867             <span class="comment">//range is +-50.</span>
<a name="l03868"></a>03868             <span class="keywordflow">if</span>( ubTotal[ i ] )
<a name="l03869"></a>03869             {
<a name="l03870"></a>03870                   iFactor = (ubOwned[ i ] * 100 / ubTotal[ i ]) - 50;
<a name="l03871"></a>03871             }
<a name="l03872"></a>03872             <span class="keywordflow">else</span>
<a name="l03873"></a>03873             {
<a name="l03874"></a>03874                   iFactor = -50;
<a name="l03875"></a>03875             }
<a name="l03876"></a>03876 
<a name="l03877"></a>03877             <span class="keywordflow">if</span> ( <a class="code" href="Strategic_01AI_8cpp.html#03888c7c25d0c7d4585ed03317d64c53">gfAggressiveQueen</a> )
<a name="l03878"></a>03878                   iFactor = abs(iFactor); <span class="comment">// Madd: The Queen never gets a defensive penalty.  The range for iFactor becomes 0-50.  This should increase the priorities for sectors outside Meduna as the queen loses sectors and keep up the attacks.  This is only going to work well if the reinforcement pool is unlimited, as sectors priorities won't ever go down really low.  </span>
<a name="l03879"></a>03879 
<a name="l03880"></a>03880             iFactor = iFactor * <a class="code" href="Strategic_01AI_8cpp.html#b6506b3e47eb797cd604d652eb70cdc3">gubQueenPriorityPhase</a> / 10;
<a name="l03881"></a>03881 
<a name="l03882"></a>03882             <span class="comment">//modify priority by + or - 25% of original</span>
<a name="l03883"></a>03883             <span class="keywordflow">if</span>( <a class="code" href="AI_01Viewer_8cpp.html#77e448d1f208bd120f861571e6d0098f">gArmyComp</a>[ i ].bPriority )
<a name="l03884"></a>03884             {
<a name="l03885"></a>03885                   num = <a class="code" href="Strategic_01AI_8cpp.html#ea7005fc7ef74a7dbbc1cb66d6520a89">gOrigArmyComp</a>[ i ].bPriority + iFactor / 2; 
<a name="l03886"></a>03886                   num = min( max( 0, num ), 100 );
<a name="l03887"></a>03887                   <a class="code" href="AI_01Viewer_8cpp.html#77e448d1f208bd120f861571e6d0098f">gArmyComp</a>[ i ].<a class="code" href="structARMY__COMPOSITION.html#ae9820933dc13e0351dbd9fe1daf8ab4">bPriority</a> = (<a class="code" href="Types_8h.html#7ebe70ceca856797319175e30bcf003d">INT8</a>)num;
<a name="l03888"></a>03888             }
<a name="l03889"></a>03889 
<a name="l03890"></a>03890             <span class="comment">//modify desired population by + or - 50% of original population</span>
<a name="l03891"></a>03891             num = <a class="code" href="Strategic_01AI_8cpp.html#ea7005fc7ef74a7dbbc1cb66d6520a89">gOrigArmyComp</a>[ i ].<a class="code" href="structARMY__COMPOSITION.html#164db6c6c30629f43d42469671367c86">bDesiredPopulation</a> * (100 + iFactor) / 100;
<a name="l03892"></a>03892             num = min( max( 6, num ), iMaxEnemyGroupSize );
<a name="l03893"></a>03893             <a class="code" href="AI_01Viewer_8cpp.html#77e448d1f208bd120f861571e6d0098f">gArmyComp</a>[ i ].<a class="code" href="structARMY__COMPOSITION.html#164db6c6c30629f43d42469671367c86">bDesiredPopulation</a> = (<a class="code" href="Types_8h.html#7ebe70ceca856797319175e30bcf003d">INT8</a>)num;
<a name="l03894"></a>03894 
<a name="l03895"></a>03895             <span class="comment">//if gfExtraElites is set, then augment the composition sizes</span>
<a name="l03896"></a>03896             <span class="keywordflow">if</span>( <a class="code" href="Strategic_01AI_8cpp.html#da8cb507523142e34aa6a62793f76a88">gfExtraElites</a> &amp;&amp; iFactor &gt;= 15 &amp;&amp; <a class="code" href="AI_01Viewer_8cpp.html#77e448d1f208bd120f861571e6d0098f">gArmyComp</a>[ i ].bElitePercentage )
<a name="l03897"></a>03897             {
<a name="l03898"></a>03898                   iChange = <a class="code" href="GameSettings_8cpp.html#f9f2d5fd368ccadcc26bebc202d52ae7">gGameOptions</a>.<a class="code" href="structGAME__OPTIONS.html#4fb44167906152722f6af5cc9f7c1a99">ubDifficultyLevel</a> * 5;
<a name="l03899"></a>03899 
<a name="l03900"></a>03900                   <span class="comment">//increase elite % (max 100)</span>
<a name="l03901"></a>03901                   iNew = <a class="code" href="AI_01Viewer_8cpp.html#77e448d1f208bd120f861571e6d0098f">gArmyComp</a>[ i ].<a class="code" href="structARMY__COMPOSITION.html#2b7c33a62b43654cd8f66ebe2e7afaa0">bElitePercentage</a> + iChange;
<a name="l03902"></a>03902                   iNew = (<a class="code" href="Types_8h.html#7ebe70ceca856797319175e30bcf003d">INT8</a>)min( 100, iNew );
<a name="l03903"></a>03903                   <a class="code" href="AI_01Viewer_8cpp.html#77e448d1f208bd120f861571e6d0098f">gArmyComp</a>[ i ].<a class="code" href="structARMY__COMPOSITION.html#2b7c33a62b43654cd8f66ebe2e7afaa0">bElitePercentage</a> = (<a class="code" href="Types_8h.html#7ebe70ceca856797319175e30bcf003d">INT8</a>)iNew;
<a name="l03904"></a>03904 
<a name="l03905"></a>03905                   <span class="comment">//decrease troop % (min 0)</span>
<a name="l03906"></a>03906                   iNew = <a class="code" href="AI_01Viewer_8cpp.html#77e448d1f208bd120f861571e6d0098f">gArmyComp</a>[ i ].<a class="code" href="structARMY__COMPOSITION.html#dcd9feb9bbaf14485e7151ae0c0652d2">bTroopPercentage</a> - iChange;
<a name="l03907"></a>03907                   iNew = (<a class="code" href="Types_8h.html#7ebe70ceca856797319175e30bcf003d">INT8</a>)max( 0, iNew );
<a name="l03908"></a>03908                   <a class="code" href="AI_01Viewer_8cpp.html#77e448d1f208bd120f861571e6d0098f">gArmyComp</a>[ i ].<a class="code" href="structARMY__COMPOSITION.html#dcd9feb9bbaf14485e7151ae0c0652d2">bTroopPercentage</a> = (<a class="code" href="Types_8h.html#7ebe70ceca856797319175e30bcf003d">INT8</a>)iNew;
<a name="l03909"></a>03909             }
<a name="l03910"></a>03910       }
<a name="l03911"></a>03911       <span class="keywordflow">if</span>( <a class="code" href="Strategic_01AI_8cpp.html#da8cb507523142e34aa6a62793f76a88">gfExtraElites</a> )
<a name="l03912"></a>03912       {
<a name="l03913"></a>03913             <span class="comment">//Turn off the flag so that this doesn't happen everytime this function is called!</span>
<a name="l03914"></a>03914             gfExtraElites = FALSE;
<a name="l03915"></a>03915 
<a name="l03916"></a>03916             <span class="keywordflow">for</span>( i = 0; i &lt; giGarrisonArraySize; i++ )
<a name="l03917"></a>03917             {
<a name="l03918"></a>03918                   <span class="comment">//if we are dealing with extra elites, then augment elite compositions (but only if they exist in the sector).  </span>
<a name="l03919"></a>03919                   <span class="comment">//If the queen still owns the town by more than 65% (iFactor &gt;= 15), then upgrade troops to elites in those sectors.</span>
<a name="l03920"></a>03920                   index = <a class="code" href="AI_01Viewer_8cpp.html#a9f940d7f3a6d6698bfaeb7c747d74a9">gGarrisonGroup</a>[ i ].ubComposition;
<a name="l03921"></a>03921                   <span class="keywordflow">switch</span>( index )
<a name="l03922"></a>03922                   {
<a name="l03923"></a>03923                         <span class="keywordflow">case</span> <a class="code" href="Strategic_01AI_8h.html#a9908284c0827729f14cf9b2489e147965167f5cd578be3792270cad11996571">QUEEN_DEFENCE</a>:
<a name="l03924"></a>03924                         <span class="keywordflow">case</span> <a class="code" href="Strategic_01AI_8h.html#a9908284c0827729f14cf9b2489e14793e66ffb942bed0fab28ff4d79f69e15e">MEDUNA_DEFENCE</a>:
<a name="l03925"></a>03925                         <span class="keywordflow">case</span> <a class="code" href="Strategic_01AI_8h.html#a9908284c0827729f14cf9b2489e1479a91a1f25028af94853c7302608b93300">MEDUNA_SAMSITE</a>:
<a name="l03926"></a>03926                         <span class="keywordflow">case</span> <a class="code" href="Strategic_01AI_8h.html#a9908284c0827729f14cf9b2489e14796cbe0f336c72d76846995060b0336228">LEVEL1_DEFENCE</a>:
<a name="l03927"></a>03927                         <span class="keywordflow">case</span> <a class="code" href="Strategic_01AI_8h.html#a9908284c0827729f14cf9b2489e1479a20161605655b8a279cc33b5b05ef22e">LEVEL2_DEFENCE</a>:
<a name="l03928"></a>03928                         <span class="keywordflow">case</span> <a class="code" href="Strategic_01AI_8h.html#a9908284c0827729f14cf9b2489e1479af824648f2c39e0defaa7dc6488a18b6">LEVEL3_DEFENCE</a>:
<a name="l03929"></a>03929                         <span class="keywordflow">case</span> <a class="code" href="Strategic_01AI_8h.html#a9908284c0827729f14cf9b2489e1479f2728e546e13a252b4ab14fb153f189f">OMERTA_WELCOME_WAGON</a>:
<a name="l03930"></a>03930                         <span class="keywordflow">case</span> <a class="code" href="Strategic_01AI_8h.html#a9908284c0827729f14cf9b2489e14791d6fc6dded07a09f3dddfd8789f69eb0">ROADBLOCK</a>:
<a name="l03931"></a>03931                         <span class="comment">//case SANMONA_SMALL:</span>
<a name="l03932"></a>03932                               <span class="comment">//don't consider these compositions</span>
<a name="l03933"></a>03933                               <span class="keywordflow">continue</span>;
<a name="l03934"></a>03934                   }
<a name="l03935"></a>03935                   pSector = &amp;<a class="code" href="Campaign_01Types_8h.html#d83c6f699f17a47cf6a662c91d959126">SectorInfo</a>[ <a class="code" href="AI_01Viewer_8cpp.html#a9f940d7f3a6d6698bfaeb7c747d74a9">gGarrisonGroup</a>[ i ].<a class="code" href="structGARRISON__GROUP.html#fb130d3c9211374d87a85cca787fe0dd">ubSectorID</a> ];
<a name="l03936"></a>03936                   <span class="keywordflow">if</span>( ubTotal[ index ] )
<a name="l03937"></a>03937                   {
<a name="l03938"></a>03938                         iFactor = (ubOwned[ index ] * 100 / ubTotal[ index ]) - 50;
<a name="l03939"></a>03939                   }
<a name="l03940"></a>03940                   <span class="keywordflow">else</span>
<a name="l03941"></a>03941                   {
<a name="l03942"></a>03942                         iFactor = -50;
<a name="l03943"></a>03943                   }
<a name="l03944"></a>03944                   <span class="keywordflow">if</span>( iFactor &gt;= 15 )
<a name="l03945"></a>03945                   { <span class="comment">//Make the actual elites in sector match the new garrison percentage</span>
<a name="l03946"></a>03946                         <span class="keywordflow">if</span>( !<a class="code" href="Map_01Information_8cpp.html#0d739dcb74321d819ef2bfcb1eb5a669">gfWorldLoaded</a> || <a class="code" href="strategicmap_8cpp.html#da715721a8ceedd42acf6ddb33e63ce0">gbWorldSectorZ</a> || 
<a name="l03947"></a>03947                                     <a class="code" href="strategicmap_8cpp.html#49d9aed144a633fda4ba1990f002d703">gWorldSectorX</a> != SECTORX( gGarrisonGroup[ i ].ubSectorID ) ||
<a name="l03948"></a>03948                                     <a class="code" href="strategicmap_8cpp.html#ea322310ced0e35ee18a2ee7b32aac5b">gWorldSectorY</a> != SECTORY( gGarrisonGroup[ i ].ubSectorID ) )
<a name="l03949"></a>03949                         { <span class="comment">//Also make sure the sector isn't currently loaded!</span>
<a name="l03950"></a>03950                               iNumSoldiers = pSector-&gt;<a class="code" href="structSECTORINFO.html#d7d5ee63c0dc2ad3164c83541bd80906">ubNumAdmins</a> + pSector-&gt;<a class="code" href="structSECTORINFO.html#e36540b93256cfa71e45382f133d3696">ubNumTroops</a> + pSector-&gt;<a class="code" href="structSECTORINFO.html#3c5312672399c40ec5a395e8bcfb0104">ubNumElites</a>;
<a name="l03951"></a>03951                               iNumPromotions = <a class="code" href="AI_01Viewer_8cpp.html#77e448d1f208bd120f861571e6d0098f">gArmyComp</a>[ index ].<a class="code" href="structARMY__COMPOSITION.html#2b7c33a62b43654cd8f66ebe2e7afaa0">bElitePercentage</a> * iNumSoldiers / 100 - pSector-&gt;<a class="code" href="structSECTORINFO.html#3c5312672399c40ec5a395e8bcfb0104">ubNumElites</a>;
<a name="l03952"></a>03952 
<a name="l03953"></a>03953                               <span class="keywordflow">if</span>( iNumPromotions &gt; 0 )
<a name="l03954"></a>03954                               {
<a name="l03955"></a>03955                                     <span class="keywordflow">while</span>( iNumPromotions-- )
<a name="l03956"></a>03956                                     {
<a name="l03957"></a>03957                                           <span class="keywordflow">if</span>( pSector-&gt;<a class="code" href="structSECTORINFO.html#d7d5ee63c0dc2ad3164c83541bd80906">ubNumAdmins</a> )
<a name="l03958"></a>03958                                           {     
<a name="l03959"></a>03959                                                 pSector-&gt;<a class="code" href="structSECTORINFO.html#d7d5ee63c0dc2ad3164c83541bd80906">ubNumAdmins</a>--;
<a name="l03960"></a>03960                                           }     
<a name="l03961"></a>03961                                           <span class="keywordflow">else</span> <span class="keywordflow">if</span>( pSector-&gt;<a class="code" href="structSECTORINFO.html#e36540b93256cfa71e45382f133d3696">ubNumTroops</a> )
<a name="l03962"></a>03962                                           {
<a name="l03963"></a>03963                                                 pSector-&gt;<a class="code" href="structSECTORINFO.html#e36540b93256cfa71e45382f133d3696">ubNumTroops</a>--;
<a name="l03964"></a>03964                                           }
<a name="l03965"></a>03965                                           <span class="keywordflow">else</span>
<a name="l03966"></a>03966                                           {
<a name="l03967"></a>03967                                                 Assert( 0 );
<a name="l03968"></a>03968                                           }
<a name="l03969"></a>03969                                           pSector-&gt;<a class="code" href="structSECTORINFO.html#3c5312672399c40ec5a395e8bcfb0104">ubNumElites</a>++;
<a name="l03970"></a>03970                                     }
<a name="l03971"></a>03971                                     Assert( iNumSoldiers == pSector-&gt;<a class="code" href="structSECTORINFO.html#d7d5ee63c0dc2ad3164c83541bd80906">ubNumAdmins</a> + pSector-&gt;<a class="code" href="structSECTORINFO.html#e36540b93256cfa71e45382f133d3696">ubNumTroops</a> + pSector-&gt;<a class="code" href="structSECTORINFO.html#3c5312672399c40ec5a395e8bcfb0104">ubNumElites</a> );
<a name="l03972"></a>03972                               }
<a name="l03973"></a>03973                         }
<a name="l03974"></a>03974                   }
<a name="l03975"></a>03975             }
<a name="l03976"></a>03976       }
<a name="l03977"></a>03977       <span class="comment">//Recalculate all of the weights.</span>
<a name="l03978"></a>03978       <span class="keywordflow">for</span>( i = 0; i &lt; giGarrisonArraySize; i++ )
<a name="l03979"></a>03979       {
<a name="l03980"></a>03980             <a class="code" href="Strategic_01AI_8cpp.html#c9af29ba59f70cabda683c1d3e7de1d0">RecalculateGarrisonWeight</a>( i );
<a name="l03981"></a>03981       }
<a name="l03982"></a>03982 }
<a name="l03983"></a>03983 
<a name="l03984"></a><a class="code" href="Strategic_01AI_8h.html#230d26f39269ac3fbef951d4dda19c6d">03984</a> <span class="keywordtype">void</span> <a class="code" href="Strategic_01AI_8cpp.html#230d26f39269ac3fbef951d4dda19c6d">ExecuteStrategicAIAction</a>( <a class="code" href="Types_8h.html#09f1a1fb2293e33483cc8d44aefb1eb1">UINT16</a> usActionCode, <a class="code" href="Types_8h.html#30f500129d8c688af07726d5d34ce52d">INT16</a> sSectorX, <a class="code" href="Types_8h.html#30f500129d8c688af07726d5d34ce52d">INT16</a> sSectorY )
<a name="l03985"></a>03985 {
<a name="l03986"></a>03986       <a class="code" href="structGROUP.html">GROUP</a> *pGroup, *pGroup0, *pGroup1, *pGroup2, *pGroup3, *pPendingGroup = NULL;
<a name="l03987"></a>03987       <a class="code" href="structSECTORINFO.html">SECTORINFO</a> *pSector;
<a name="l03988"></a>03988       <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubSectorID;
<a name="l03989"></a>03989       <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubSourceSectorID;
<a name="l03990"></a>03990       <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubTargetSectorID;
<a name="l03991"></a>03991       <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubNumSoldiers;
<a name="l03992"></a>03992 
<a name="l03993"></a>03993       <span class="keywordflow">switch</span>( usActionCode )
<a name="l03994"></a>03994       {
<a name="l03995"></a>03995             <span class="keywordflow">case</span> <a class="code" href="Strategic_01AI_8h.html#b79db5277fcbe695243c6d68332cbf4cc6dfe62b651f77f4837391448d452c04">STRATEGIC_AI_ACTION_WAKE_QUEEN</a>:
<a name="l03996"></a>03996                   <a class="code" href="Strategic_01AI_8cpp.html#079d19a6a3eb516e60dc98132a6cc5f8">WakeUpQueen</a>();
<a name="l03997"></a>03997                   <span class="keywordflow">break</span>;
<a name="l03998"></a>03998 
<a name="l03999"></a>03999             <span class="keywordflow">case</span> <a class="code" href="Strategic_01AI_8h.html#b79db5277fcbe695243c6d68332cbf4c9d4b5dd879dcd0dc23de6868a4d42f01">STRATEGIC_AI_ACTION_QUEEN_DEAD</a>:
<a name="l04000"></a>04000                   <a class="code" href="AI_01Viewer_8cpp.html#38284bd39764812fb8a27fe4d3d2b0cd">gfQueenAIAwake</a> = FALSE;
<a name="l04001"></a>04001                   <span class="keywordflow">break</span>;
<a name="l04002"></a>04002 
<a name="l04003"></a>04003             <span class="keywordflow">case</span> <a class="code" href="Strategic_01AI_8h.html#b79db5277fcbe695243c6d68332cbf4c03de45947107ca9799ecf603b300d0a4">STRATEGIC_AI_ACTION_KINGPIN_DEAD</a>:
<a name="l04004"></a>04004                   <span class="comment">//Immediate send a small garrison to C5 (to discourage access to Tony the dealer)</span>
<a name="l04005"></a>04005                   <span class="comment">/*</span>
<a name="l04006"></a>04006 <span class="comment">                  for( i = 0; i &lt; giGarrisonArraySize; i++ )</span>
<a name="l04007"></a>04007 <span class="comment">                  {</span>
<a name="l04008"></a>04008 <span class="comment">                        if( gGarrisonGroup[ i ].ubComposition == SANMONA_SMALL )</span>
<a name="l04009"></a>04009 <span class="comment">                        {</span>
<a name="l04010"></a>04010 <span class="comment">                              //Setup the composition so from now on the queen will consider this an important sector</span>
<a name="l04011"></a>04011 <span class="comment">                              //to hold.</span>
<a name="l04012"></a>04012 <span class="comment">                              gArmyComp[ gGarrisonGroup[ i ].ubComposition ].bPriority = 65;</span>
<a name="l04013"></a>04013 <span class="comment">                              gArmyComp[ gGarrisonGroup[ i ].ubComposition ].bTroopPercentage = 100;</span>
<a name="l04014"></a>04014 <span class="comment">                              gArmyComp[ gGarrisonGroup[ i ].ubComposition ].bDesiredPopulation = 5;</span>
<a name="l04015"></a>04015 <span class="comment">                              RequestHighPriorityGarrisonReinforcements( i, (UINT8)(2 + Random( 4 )) ); //send 2-5 soldiers now.</span>
<a name="l04016"></a>04016 <span class="comment">                              break;</span>
<a name="l04017"></a>04017 <span class="comment">                        }</span>
<a name="l04018"></a>04018 <span class="comment">                  }</span>
<a name="l04019"></a>04019 <span class="comment">                  */</span>
<a name="l04020"></a>04020                   <span class="keywordflow">break</span>;
<a name="l04021"></a>04021 
<a name="l04022"></a>04022             <span class="keywordflow">case</span> <a class="code" href="interface_01Dialogue_8h.html#2ae95ea8e60178fe99580d5142f0ec7ef8f949ca2f7f72fb9aa87858f80e50f4">NPC_ACTION_SEND_SOLDIERS_TO_DRASSEN</a>:
<a name="l04023"></a>04023                   <span class="comment">//Send 6, 9, or 12 troops (based on difficulty) one of the Drassen sectors.  If nobody is there when they arrive,</span>
<a name="l04024"></a>04024                   <span class="comment">//those troops will get reassigned.</span>
<a name="l04025"></a>04025 
<a name="l04026"></a>04026                   <span class="comment">//if( Chance( 50 ) )</span>
<a name="l04027"></a>04027                   <span class="comment">//{</span>
<a name="l04028"></a>04028                   <span class="comment">//    ubSectorID = SEC_D13;</span>
<a name="l04029"></a>04029                   <span class="comment">//}</span>
<a name="l04030"></a>04030                   <span class="comment">//else if( Chance( 60 ) )</span>
<a name="l04031"></a>04031                   <span class="comment">//{</span>
<a name="l04032"></a>04032                   <span class="comment">//    ubSectorID = SEC_B13;</span>
<a name="l04033"></a>04033                   <span class="comment">//}</span>
<a name="l04034"></a>04034                   <span class="comment">//else</span>
<a name="l04035"></a>04035                   <span class="comment">//{</span>
<a name="l04036"></a>04036                   <span class="comment">//    ubSectorID = SEC_C13;</span>
<a name="l04037"></a>04037                   <span class="comment">//}</span>
<a name="l04038"></a>04038                   <span class="comment">//ubNumSoldiers = (UINT8)(3 + gGameOptions.ubDifficultyLevel * 3);</span>
<a name="l04039"></a>04039                   <span class="comment">//pGroup = CreateNewEnemyGroupDepartingFromSector( SEC_P3, 0, ubNumSoldiers, 0 );</span>
<a name="l04040"></a>04040 
<a name="l04041"></a>04041                   <span class="comment">//if( !gGarrisonGroup[ SectorInfo[ ubSectorID ].ubGarrisonID ].ubPendingGroupID )</span>
<a name="l04042"></a>04042                   <span class="comment">//{</span>
<a name="l04043"></a>04043                   <span class="comment">//    pGroup-&gt;pEnemyGroup-&gt;ubIntention = STAGE;</span>
<a name="l04044"></a>04044                   <span class="comment">//    gGarrisonGroup[ SectorInfo[ ubSectorID ].ubGarrisonID ].ubPendingGroupID = pGroup-&gt;ubGroupID;</span>
<a name="l04045"></a>04045                   <span class="comment">//}</span>
<a name="l04046"></a>04046                   <span class="comment">//else</span>
<a name="l04047"></a>04047                   <span class="comment">//{ //this should never happen (but if it did, then this is the best way to deal with it).</span>
<a name="l04048"></a>04048                   <span class="comment">//    pGroup-&gt;pEnemyGroup-&gt;ubIntention = PURSUIT;</span>
<a name="l04049"></a>04049                   <span class="comment">//}</span>
<a name="l04050"></a>04050 
<a name="l04051"></a>04051                   <span class="comment">//Madd: unlimited reinforcements?</span>
<a name="l04052"></a>04052                   <span class="comment">//if ( !gfUnlimitedTroops )</span>
<a name="l04053"></a>04053                   <span class="comment">//    giReinforcementPool -= ubNumSoldiers;</span>
<a name="l04054"></a>04054       
<a name="l04055"></a>04055                   <span class="comment">//giReinforcementPool = max( giReinforcementPool, 0 );</span>
<a name="l04056"></a>04056 
<a name="l04057"></a>04057                   <span class="comment">//MoveSAIGroupToSector( &amp;pGroup, ubSectorID, EVASIVE, pGroup-&gt;pEnemyGroup-&gt;ubIntention );</span>
<a name="l04058"></a>04058 
<a name="l04059"></a>04059                   <span class="keywordflow">if</span> ( !<a class="code" href="GameSettings_8cpp.html#5c32f930e2fef384505c4b91803a92c2">gGameExternalOptions</a>.<a class="code" href="structGAME__EXTERNAL__OPTIONS.html#c073f1004a11e164a9eeaa757caf5eba">ubSendTroopsToDrassen</a> )
<a name="l04060"></a>04060                         <span class="keywordflow">break</span>;
<a name="l04061"></a>04061 
<a name="l04062"></a>04062                   ubSourceSectorID = <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c66026438001804c2db19d8207f0a9c3831c1641">SEC_H13</a>;
<a name="l04063"></a>04063                   ubTargetSectorID = <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c66026435b0fbd8598540769dcf8f24e3134f48c">SEC_D13</a>;
<a name="l04064"></a>04064 
<a name="l04065"></a>04065                   <span class="keywordflow">if</span> ( !(<a class="code" href="Campaign_01Types_8h.html#d83c6f699f17a47cf6a662c91d959126">SectorInfo</a>[ ubSourceSectorID ].ubNumTroops &gt; 0) )
<a name="l04066"></a>04066                   {
<a name="l04067"></a>04067                         ubSourceSectorID = <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c66026438a2eb9999a6ad7c69c9ddbe2d95696ca">SEC_P3</a>;
<a name="l04068"></a>04068                   }
<a name="l04069"></a>04069                   
<a name="l04070"></a>04070                   ubNumSoldiers = (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)( <a class="code" href="Strategic_01AI_8cpp.html#12b5525b1f3dabeac40700eecd3219e7">gubMinEnemyGroupSize</a> + <a class="code" href="GameSettings_8cpp.html#f9f2d5fd368ccadcc26bebc202d52ae7">gGameOptions</a>.<a class="code" href="structGAME__OPTIONS.html#4fb44167906152722f6af5cc9f7c1a99">ubDifficultyLevel</a> * 3);
<a name="l04071"></a>04071                   
<a name="l04072"></a>04072                   pGroup0 = <a class="code" href="Strategic_01Movement_8cpp.html#a6ac42d3d57b37a44bc39b3cd55ec008">CreateNewEnemyGroupDepartingFromSector</a>( ubSourceSectorID, 0, ubNumSoldiers, ubNumSoldiers - ubNumSoldiers / <a class="code" href="GameSettings_8cpp.html#f9f2d5fd368ccadcc26bebc202d52ae7">gGameOptions</a>.<a class="code" href="structGAME__OPTIONS.html#4fb44167906152722f6af5cc9f7c1a99">ubDifficultyLevel</a> );
<a name="l04073"></a>04073                   pGroup1 = <a class="code" href="Strategic_01Movement_8cpp.html#a6ac42d3d57b37a44bc39b3cd55ec008">CreateNewEnemyGroupDepartingFromSector</a>( ubSourceSectorID, 0, ubNumSoldiers, ubNumSoldiers - ubNumSoldiers / <a class="code" href="GameSettings_8cpp.html#f9f2d5fd368ccadcc26bebc202d52ae7">gGameOptions</a>.<a class="code" href="structGAME__OPTIONS.html#4fb44167906152722f6af5cc9f7c1a99">ubDifficultyLevel</a> );
<a name="l04074"></a>04074                   pGroup2 = <a class="code" href="Strategic_01Movement_8cpp.html#a6ac42d3d57b37a44bc39b3cd55ec008">CreateNewEnemyGroupDepartingFromSector</a>( ubSourceSectorID, 0, ubNumSoldiers, ubNumSoldiers - ubNumSoldiers / <a class="code" href="GameSettings_8cpp.html#f9f2d5fd368ccadcc26bebc202d52ae7">gGameOptions</a>.<a class="code" href="structGAME__OPTIONS.html#4fb44167906152722f6af5cc9f7c1a99">ubDifficultyLevel</a> );
<a name="l04075"></a>04075                   pGroup3 = <a class="code" href="Strategic_01Movement_8cpp.html#a6ac42d3d57b37a44bc39b3cd55ec008">CreateNewEnemyGroupDepartingFromSector</a>( ubSourceSectorID, 0, ubNumSoldiers, ubNumSoldiers - ubNumSoldiers / <a class="code" href="GameSettings_8cpp.html#f9f2d5fd368ccadcc26bebc202d52ae7">gGameOptions</a>.<a class="code" href="structGAME__OPTIONS.html#4fb44167906152722f6af5cc9f7c1a99">ubDifficultyLevel</a> );
<a name="l04076"></a>04076 
<a name="l04077"></a>04077 
<a name="l04078"></a>04078                   <span class="keywordflow">if</span>( !<a class="code" href="AI_01Viewer_8cpp.html#a9f940d7f3a6d6698bfaeb7c747d74a9">gGarrisonGroup</a>[ <a class="code" href="Campaign_01Types_8h.html#d83c6f699f17a47cf6a662c91d959126">SectorInfo</a>[ ubTargetSectorID ].ubGarrisonID ].ubPendingGroupID )
<a name="l04079"></a>04079                   {
<a name="l04080"></a>04080                         pGroup0-&gt;<a class="code" href="structGROUP.html#f82ff4c3e504e4bb10feb65491f79471">pEnemyGroup</a>-&gt;<a class="code" href="structENEMYGROUP.html#6d1d418460b3704699f5e058925897e2">ubIntention</a> = <a class="code" href="Strategic_01AI_8cpp.html#2282261c2887b2d4d1183cf5249e1529abdf346cfc40be1a014cf4295888c888">STAGE</a>;
<a name="l04081"></a>04081                         pGroup1-&gt;<a class="code" href="structGROUP.html#f82ff4c3e504e4bb10feb65491f79471">pEnemyGroup</a>-&gt;<a class="code" href="structENEMYGROUP.html#6d1d418460b3704699f5e058925897e2">ubIntention</a> = <a class="code" href="Strategic_01AI_8cpp.html#2282261c2887b2d4d1183cf5249e1529abdf346cfc40be1a014cf4295888c888">STAGE</a>;
<a name="l04082"></a>04082                         pGroup2-&gt;<a class="code" href="structGROUP.html#f82ff4c3e504e4bb10feb65491f79471">pEnemyGroup</a>-&gt;<a class="code" href="structENEMYGROUP.html#6d1d418460b3704699f5e058925897e2">ubIntention</a> = <a class="code" href="Strategic_01AI_8cpp.html#2282261c2887b2d4d1183cf5249e1529abdf346cfc40be1a014cf4295888c888">STAGE</a>;
<a name="l04083"></a>04083                         pGroup3-&gt;<a class="code" href="structGROUP.html#f82ff4c3e504e4bb10feb65491f79471">pEnemyGroup</a>-&gt;<a class="code" href="structENEMYGROUP.html#6d1d418460b3704699f5e058925897e2">ubIntention</a> = <a class="code" href="Strategic_01Movement_8h.html#b59c1bec446b10af208f977a871d910b095b1f433b659c686164f67bb7b89cb1">REINFORCEMENTS</a>;
<a name="l04084"></a>04084 
<a name="l04085"></a>04085                         <a class="code" href="AI_01Viewer_8cpp.html#a9f940d7f3a6d6698bfaeb7c747d74a9">gGarrisonGroup</a>[ <a class="code" href="Campaign_01Types_8h.html#d83c6f699f17a47cf6a662c91d959126">SectorInfo</a>[ ubTargetSectorID ].<a class="code" href="structSECTORINFO.html#9465931dad0e164d7d47814b66e454f0">ubGarrisonID</a> ].<a class="code" href="structGARRISON__GROUP.html#ea8325bf63e1d81924fb5fab93b37d8e">ubPendingGroupID</a> = pGroup3-&gt;<a class="code" href="structGROUP.html#9149379b9355afda87a382af5a88d728">ubGroupID</a>;
<a name="l04086"></a>04086 
<a name="l04087"></a>04087                   }
<a name="l04088"></a>04088                   <span class="keywordflow">else</span>
<a name="l04089"></a>04089                   { <span class="comment">//this should never happen (but if it did, then this is the best way to deal with it).</span>
<a name="l04090"></a>04090                         pGroup0-&gt;<a class="code" href="structGROUP.html#f82ff4c3e504e4bb10feb65491f79471">pEnemyGroup</a>-&gt;<a class="code" href="structENEMYGROUP.html#6d1d418460b3704699f5e058925897e2">ubIntention</a> = <a class="code" href="Strategic_01Movement_8h.html#b59c1bec446b10af208f977a871d910bede7846a7ab284d348a227dc5858530f">PURSUIT</a>;
<a name="l04091"></a>04091                         pGroup1-&gt;<a class="code" href="structGROUP.html#f82ff4c3e504e4bb10feb65491f79471">pEnemyGroup</a>-&gt;<a class="code" href="structENEMYGROUP.html#6d1d418460b3704699f5e058925897e2">ubIntention</a> = <a class="code" href="Strategic_01Movement_8h.html#b59c1bec446b10af208f977a871d910bede7846a7ab284d348a227dc5858530f">PURSUIT</a>;
<a name="l04092"></a>04092                         pGroup2-&gt;<a class="code" href="structGROUP.html#f82ff4c3e504e4bb10feb65491f79471">pEnemyGroup</a>-&gt;<a class="code" href="structENEMYGROUP.html#6d1d418460b3704699f5e058925897e2">ubIntention</a> = <a class="code" href="Strategic_01Movement_8h.html#b59c1bec446b10af208f977a871d910bede7846a7ab284d348a227dc5858530f">PURSUIT</a>;
<a name="l04093"></a>04093                         pGroup3-&gt;<a class="code" href="structGROUP.html#f82ff4c3e504e4bb10feb65491f79471">pEnemyGroup</a>-&gt;<a class="code" href="structENEMYGROUP.html#6d1d418460b3704699f5e058925897e2">ubIntention</a> = <a class="code" href="Strategic_01Movement_8h.html#b59c1bec446b10af208f977a871d910bede7846a7ab284d348a227dc5858530f">PURSUIT</a>;
<a name="l04094"></a>04094                   }
<a name="l04095"></a>04095 
<a name="l04096"></a>04096                   <span class="comment">//Madd: unlimited reinforcements?</span>
<a name="l04097"></a>04097                   <span class="comment">//if ( !gfUnlimitedTroops )</span>
<a name="l04098"></a>04098                   <span class="comment">//    giReinforcementPool -= ubNumSoldiers;</span>
<a name="l04099"></a>04099             
<a name="l04100"></a>04100                   <a class="code" href="AI_01Viewer_8cpp.html#c86cd58021961af10f1eb15108a79023">giReinforcementPool</a> = max( <a class="code" href="AI_01Viewer_8cpp.html#c86cd58021961af10f1eb15108a79023">giReinforcementPool</a>, 0 );
<a name="l04101"></a>04101 
<a name="l04102"></a>04102                   <a class="code" href="Strategic_01AI_8cpp.html#3865b55f00d5df7710bd4325ddf83bfc">MoveSAIGroupToSector</a>( &amp;pGroup0, <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643b3710d366ebaae2239b96773f4a26e76">SEC_D14</a>, <a class="code" href="Strategic_01AI_8cpp.html#2282261c2887b2d4d1183cf5249e1529a4d4adb90ccd2b0775d4429cac476900">EVASIVE</a>, pGroup0-&gt;<a class="code" href="structGROUP.html#f82ff4c3e504e4bb10feb65491f79471">pEnemyGroup</a>-&gt;<a class="code" href="structENEMYGROUP.html#6d1d418460b3704699f5e058925897e2">ubIntention</a> );
<a name="l04103"></a>04103                   <a class="code" href="Strategic_01AI_8cpp.html#3865b55f00d5df7710bd4325ddf83bfc">MoveSAIGroupToSector</a>( &amp;pGroup1, <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c660264379208189c749fece42d995546ebdb1dc">SEC_E13</a>, <a class="code" href="Strategic_01AI_8cpp.html#2282261c2887b2d4d1183cf5249e1529a4d4adb90ccd2b0775d4429cac476900">EVASIVE</a>, pGroup1-&gt;<a class="code" href="structGROUP.html#f82ff4c3e504e4bb10feb65491f79471">pEnemyGroup</a>-&gt;<a class="code" href="structENEMYGROUP.html#6d1d418460b3704699f5e058925897e2">ubIntention</a> );
<a name="l04104"></a>04104                   <a class="code" href="Strategic_01AI_8cpp.html#3865b55f00d5df7710bd4325ddf83bfc">MoveSAIGroupToSector</a>( &amp;pGroup2, <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c660264330c1a637430db2a5433858b2f9cb2331">SEC_D12</a>, <a class="code" href="Strategic_01AI_8cpp.html#2282261c2887b2d4d1183cf5249e1529a4d4adb90ccd2b0775d4429cac476900">EVASIVE</a>, pGroup2-&gt;<a class="code" href="structGROUP.html#f82ff4c3e504e4bb10feb65491f79471">pEnemyGroup</a>-&gt;<a class="code" href="structENEMYGROUP.html#6d1d418460b3704699f5e058925897e2">ubIntention</a> );
<a name="l04105"></a>04105                   <a class="code" href="Strategic_01AI_8cpp.html#3865b55f00d5df7710bd4325ddf83bfc">MoveSAIGroupToSector</a>( &amp;pGroup3, <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643b3710d366ebaae2239b96773f4a26e76">SEC_D14</a>, <a class="code" href="Strategic_01AI_8cpp.html#2282261c2887b2d4d1183cf5249e1529a4d4adb90ccd2b0775d4429cac476900">EVASIVE</a>, pGroup3-&gt;<a class="code" href="structGROUP.html#f82ff4c3e504e4bb10feb65491f79471">pEnemyGroup</a>-&gt;<a class="code" href="structENEMYGROUP.html#6d1d418460b3704699f5e058925897e2">ubIntention</a> );
<a name="l04106"></a>04106 
<a name="l04107"></a>04107                   <span class="keywordflow">break</span>;
<a name="l04108"></a>04108 
<a name="l04109"></a>04109 
<a name="l04110"></a>04110             <span class="keywordflow">case</span> <a class="code" href="interface_01Dialogue_8h.html#2ae95ea8e60178fe99580d5142f0ec7eb4d495d93072e5209a8a328bd62c38ba">NPC_ACTION_SEND_SOLDIERS_TO_BATTLE_LOCATION</a>:
<a name="l04111"></a>04111                   <span class="comment">//Send 4, 8, or 12 troops (based on difficulty) to the location of the first battle.  If nobody is there when they arrive,</span>
<a name="l04112"></a>04112                   <span class="comment">//those troops will get reassigned.</span>
<a name="l04113"></a>04113                   ubSectorID = (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)STRATEGIC_INDEX_TO_SECTOR_INFO( <a class="code" href="SaveLoadGame_8cpp.html#b14c016f3d2b7115306c10ecd23f9d68">sWorldSectorLocationOfFirstBattle</a> ); 
<a name="l04114"></a>04114                   pSector = &amp;<a class="code" href="Campaign_01Types_8h.html#d83c6f699f17a47cf6a662c91d959126">SectorInfo</a>[ ubSectorID ];
<a name="l04115"></a>04115                   ubNumSoldiers = (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)( <a class="code" href="Strategic_01AI_8cpp.html#12b5525b1f3dabeac40700eecd3219e7">gubMinEnemyGroupSize</a> + <a class="code" href="GameSettings_8cpp.html#f9f2d5fd368ccadcc26bebc202d52ae7">gGameOptions</a>.<a class="code" href="structGAME__OPTIONS.html#4fb44167906152722f6af5cc9f7c1a99">ubDifficultyLevel</a> * 4);
<a name="l04116"></a>04116                   pGroup = <a class="code" href="Strategic_01Movement_8cpp.html#a6ac42d3d57b37a44bc39b3cd55ec008">CreateNewEnemyGroupDepartingFromSector</a>( <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c66026438a2eb9999a6ad7c69c9ddbe2d95696ca">SEC_P3</a>, 0, ubNumSoldiers, 0 );
<a name="l04117"></a>04117 
<a name="l04118"></a>04118                   <span class="comment">//Madd: unlimited reinforcements?</span>
<a name="l04119"></a>04119                   <span class="keywordflow">if</span> ( !<a class="code" href="Strategic_01AI_8cpp.html#b0c12688f38630da4e064c85394ca570">gfUnlimitedTroops</a> )
<a name="l04120"></a>04120                         <a class="code" href="AI_01Viewer_8cpp.html#c86cd58021961af10f1eb15108a79023">giReinforcementPool</a> -= ubNumSoldiers;
<a name="l04121"></a>04121                   
<a name="l04122"></a>04122                   <a class="code" href="AI_01Viewer_8cpp.html#c86cd58021961af10f1eb15108a79023">giReinforcementPool</a> = max( <a class="code" href="AI_01Viewer_8cpp.html#c86cd58021961af10f1eb15108a79023">giReinforcementPool</a>, 0 );
<a name="l04123"></a>04123 
<a name="l04124"></a>04124                   <span class="comment">//Determine if the battle location actually has a garrison assignment.  If so, and the following</span>
<a name="l04125"></a>04125                   <span class="comment">//checks succeed, the enemies will be sent to attack and reinforce that sector.  Otherwise, the</span>
<a name="l04126"></a>04126                   <span class="comment">//enemies will simply check it out, then leave.</span>
<a name="l04127"></a>04127                   <span class="keywordflow">if</span>( pSector-&gt;<a class="code" href="structSECTORINFO.html#9465931dad0e164d7d47814b66e454f0">ubGarrisonID</a> != NO_GARRISON )
<a name="l04128"></a>04128                   { <span class="comment">//sector has a garrison</span>
<a name="l04129"></a>04129                         <span class="keywordflow">if</span>( !<a class="code" href="Queen_01Command_8cpp.html#d8bc05237d5fab5063d680045f945c48">NumEnemiesInSector</a>( (<a class="code" href="Types_8h.html#30f500129d8c688af07726d5d34ce52d">INT16</a>)SECTORX( ubSectorID ), (<a class="code" href="Types_8h.html#30f500129d8c688af07726d5d34ce52d">INT16</a>)SECTORY( ubSectorID ) ) )
<a name="l04130"></a>04130                         { <span class="comment">//no enemies are here</span>
<a name="l04131"></a>04131                               <span class="keywordflow">if</span>( <a class="code" href="AI_01Viewer_8cpp.html#77e448d1f208bd120f861571e6d0098f">gArmyComp</a>[ !<a class="code" href="AI_01Viewer_8cpp.html#a9f940d7f3a6d6698bfaeb7c747d74a9">gGarrisonGroup</a>[ pSector-&gt;<a class="code" href="structSECTORINFO.html#9465931dad0e164d7d47814b66e454f0">ubGarrisonID</a> ].ubComposition ].bPriority )
<a name="l04132"></a>04132                               { <span class="comment">//the garrison is important</span>
<a name="l04133"></a>04133                                     <span class="keywordflow">if</span>( !<a class="code" href="AI_01Viewer_8cpp.html#a9f940d7f3a6d6698bfaeb7c747d74a9">gGarrisonGroup</a>[ pSector-&gt;<a class="code" href="structSECTORINFO.html#9465931dad0e164d7d47814b66e454f0">ubGarrisonID</a> ].ubPendingGroupID )
<a name="l04134"></a>04134                                     { <span class="comment">//the garrison doesn't have reinforcements already on route.</span>
<a name="l04135"></a>04135                                           <a class="code" href="AI_01Viewer_8cpp.html#a9f940d7f3a6d6698bfaeb7c747d74a9">gGarrisonGroup</a>[ pSector-&gt;<a class="code" href="structSECTORINFO.html#9465931dad0e164d7d47814b66e454f0">ubGarrisonID</a> ].<a class="code" href="structGARRISON__GROUP.html#ea8325bf63e1d81924fb5fab93b37d8e">ubPendingGroupID</a> = pGroup-&gt;<a class="code" href="structGROUP.html#9149379b9355afda87a382af5a88d728">ubGroupID</a>;
<a name="l04136"></a>04136                                           <a class="code" href="Strategic_01AI_8cpp.html#3865b55f00d5df7710bd4325ddf83bfc">MoveSAIGroupToSector</a>( &amp;pGroup, ubSectorID, <a class="code" href="Strategic_01AI_8cpp.html#2282261c2887b2d4d1183cf5249e1529abdf346cfc40be1a014cf4295888c888">STAGE</a>, <a class="code" href="Strategic_01Movement_8h.html#b59c1bec446b10af208f977a871d910b095b1f433b659c686164f67bb7b89cb1">REINFORCEMENTS</a> );
<a name="l04137"></a>04137                                           <span class="keywordflow">break</span>;
<a name="l04138"></a>04138                                     }
<a name="l04139"></a>04139                               }
<a name="l04140"></a>04140                         }
<a name="l04141"></a>04141                   }
<a name="l04142"></a>04142                   <span class="keywordflow">else</span>
<a name="l04143"></a>04143                   {
<a name="l04144"></a>04144                         <a class="code" href="Strategic_01AI_8cpp.html#3865b55f00d5df7710bd4325ddf83bfc">MoveSAIGroupToSector</a>( &amp;pGroup, ubSectorID, <a class="code" href="Strategic_01AI_8cpp.html#2282261c2887b2d4d1183cf5249e1529a4d4adb90ccd2b0775d4429cac476900">EVASIVE</a>, <a class="code" href="Strategic_01Movement_8h.html#b59c1bec446b10af208f977a871d910bede7846a7ab284d348a227dc5858530f">PURSUIT</a> );
<a name="l04145"></a>04145                   }
<a name="l04146"></a>04146 
<a name="l04147"></a>04147                   <span class="keywordflow">break</span>;
<a name="l04148"></a>04148 
<a name="l04149"></a>04149             <span class="keywordflow">case</span> <a class="code" href="interface_01Dialogue_8h.html#2ae95ea8e60178fe99580d5142f0ec7efc11c463da1b2f761beb4e618d98a3fd">NPC_ACTION_SEND_SOLDIERS_TO_OMERTA</a>:
<a name="l04150"></a>04150                   ubNumSoldiers = (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)( <a class="code" href="Strategic_01AI_8cpp.html#12b5525b1f3dabeac40700eecd3219e7">gubMinEnemyGroupSize</a> + <a class="code" href="GameSettings_8cpp.html#f9f2d5fd368ccadcc26bebc202d52ae7">gGameOptions</a>.<a class="code" href="structGAME__OPTIONS.html#4fb44167906152722f6af5cc9f7c1a99">ubDifficultyLevel</a> * 6); <span class="comment">//6, 12, or 18 based on difficulty.</span>
<a name="l04151"></a>04151                   pGroup = <a class="code" href="Strategic_01Movement_8cpp.html#a6ac42d3d57b37a44bc39b3cd55ec008">CreateNewEnemyGroupDepartingFromSector</a>( <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c66026438a2eb9999a6ad7c69c9ddbe2d95696ca">SEC_P3</a>, 0, ubNumSoldiers, (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)(ubNumSoldiers/7) ); <span class="comment">//add 1 elite to normal, and 2 for hard</span>
<a name="l04152"></a>04152                   ubNumSoldiers = (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)(ubNumSoldiers + ubNumSoldiers / 7);
<a name="l04153"></a>04153 
<a name="l04154"></a>04154                   <span class="comment">//Madd: unlimited reinforcements</span>
<a name="l04155"></a>04155                   <span class="keywordflow">if</span> ( !<a class="code" href="Strategic_01AI_8cpp.html#b0c12688f38630da4e064c85394ca570">gfUnlimitedTroops</a> )
<a name="l04156"></a>04156                         <a class="code" href="AI_01Viewer_8cpp.html#c86cd58021961af10f1eb15108a79023">giReinforcementPool</a> -= ubNumSoldiers;
<a name="l04157"></a>04157       
<a name="l04158"></a>04158                   <a class="code" href="AI_01Viewer_8cpp.html#c86cd58021961af10f1eb15108a79023">giReinforcementPool</a> = max( <a class="code" href="AI_01Viewer_8cpp.html#c86cd58021961af10f1eb15108a79023">giReinforcementPool</a>, 0 );
<a name="l04159"></a>04159                   <span class="keywordflow">if</span>( <a class="code" href="Strategic_01Movement_8cpp.html#39531a1493c62a63a373c7e8125ca7f7">PlayerMercsInSector</a>( 9, 1, 1 ) &amp;&amp; !<a class="code" href="Strategic_01Movement_8cpp.html#39531a1493c62a63a373c7e8125ca7f7">PlayerMercsInSector</a>( 10, 1, 1 ) &amp;&amp; !<a class="code" href="Strategic_01Movement_8cpp.html#39531a1493c62a63a373c7e8125ca7f7">PlayerMercsInSector</a>( 10, 1, 2 ) )
<a name="l04160"></a>04160                   { <span class="comment">//send to A9 (if mercs in A9, but not in A10 or A10 basement)</span>
<a name="l04161"></a>04161                         ubSectorID = <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c660264391d2dc0712c8c1f845d2997d13220831">SEC_A9</a>;
<a name="l04162"></a>04162                   }
<a name="l04163"></a>04163                   <span class="keywordflow">else</span>
<a name="l04164"></a>04164                   { <span class="comment">//send to A10</span>
<a name="l04165"></a>04165                         ubSectorID = <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c660264397a66a28fcba55b268aca2df88ae2ad0">SEC_A10</a>;
<a name="l04166"></a>04166                   }
<a name="l04167"></a>04167 
<a name="l04168"></a>04168                   <a class="code" href="Strategic_01AI_8cpp.html#3865b55f00d5df7710bd4325ddf83bfc">MoveSAIGroupToSector</a>( &amp;pGroup, ubSectorID, <a class="code" href="Strategic_01AI_8cpp.html#2282261c2887b2d4d1183cf5249e1529a4d4adb90ccd2b0775d4429cac476900">EVASIVE</a>, <a class="code" href="Strategic_01Movement_8h.html#b59c1bec446b10af208f977a871d910bede7846a7ab284d348a227dc5858530f">PURSUIT</a> );
<a name="l04169"></a>04169 
<a name="l04170"></a>04170                   <a class="code" href="Strategic_01AI_8cpp.html#3c3091ef7361288e9f4f6a95cb067980">ValidateGroup</a>( pGroup );
<a name="l04171"></a>04171                   <span class="keywordflow">break</span>;
<a name="l04172"></a>04172 
<a name="l04173"></a>04173             <span class="keywordflow">case</span> <a class="code" href="interface_01Dialogue_8h.html#2ae95ea8e60178fe99580d5142f0ec7e9f13da050b090138638c57e3c03a24de">NPC_ACTION_SEND_TROOPS_TO_SAM</a>:
<a name="l04174"></a>04174                   ubSectorID = (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)SECTOR( sSectorX, sSectorY );
<a name="l04175"></a>04175                   ubNumSoldiers = (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)( <a class="code" href="Strategic_01AI_8cpp.html#12b5525b1f3dabeac40700eecd3219e7">gubMinEnemyGroupSize</a> + <a class="code" href="GameSettings_8cpp.html#f9f2d5fd368ccadcc26bebc202d52ae7">gGameOptions</a>.<a class="code" href="structGAME__OPTIONS.html#4fb44167906152722f6af5cc9f7c1a99">ubDifficultyLevel</a> + <a class="code" href="Campaign_8cpp.html#c301f0385a7e0d276efe888024738b09">HighestPlayerProgressPercentage</a>() / 15 );
<a name="l04176"></a>04176 
<a name="l04177"></a>04177                   <span class="comment">//Madd: unlimited reinforcements?</span>
<a name="l04178"></a>04178                   <span class="keywordflow">if</span> ( !<a class="code" href="Strategic_01AI_8cpp.html#b0c12688f38630da4e064c85394ca570">gfUnlimitedTroops</a> )
<a name="l04179"></a>04179                         <a class="code" href="AI_01Viewer_8cpp.html#c86cd58021961af10f1eb15108a79023">giReinforcementPool</a> -= ubNumSoldiers;
<a name="l04180"></a>04180             
<a name="l04181"></a>04181                   <a class="code" href="AI_01Viewer_8cpp.html#c86cd58021961af10f1eb15108a79023">giReinforcementPool</a> = max( <a class="code" href="AI_01Viewer_8cpp.html#c86cd58021961af10f1eb15108a79023">giReinforcementPool</a>, 0 );
<a name="l04182"></a>04182                   pGroup = <a class="code" href="Strategic_01Movement_8cpp.html#a6ac42d3d57b37a44bc39b3cd55ec008">CreateNewEnemyGroupDepartingFromSector</a>( <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c66026438a2eb9999a6ad7c69c9ddbe2d95696ca">SEC_P3</a>, 0, 0, ubNumSoldiers );
<a name="l04183"></a>04183                   <a class="code" href="Strategic_01AI_8cpp.html#3865b55f00d5df7710bd4325ddf83bfc">MoveSAIGroupToSector</a>( &amp;pGroup, ubSectorID, <a class="code" href="Strategic_01AI_8cpp.html#2282261c2887b2d4d1183cf5249e1529abdf346cfc40be1a014cf4295888c888">STAGE</a>, <a class="code" href="Strategic_01Movement_8h.html#b59c1bec446b10af208f977a871d910b095b1f433b659c686164f67bb7b89cb1">REINFORCEMENTS</a> );
<a name="l04184"></a>04184 
<a name="l04185"></a>04185                   <span class="keywordflow">if</span>( <a class="code" href="AI_01Viewer_8cpp.html#a9f940d7f3a6d6698bfaeb7c747d74a9">gGarrisonGroup</a>[ <a class="code" href="Campaign_01Types_8h.html#d83c6f699f17a47cf6a662c91d959126">SectorInfo</a>[ ubSectorID ].ubGarrisonID ].ubPendingGroupID )
<a name="l04186"></a>04186                   {     <span class="comment">//Clear the pending group's assignment.</span>
<a name="l04187"></a>04187                         pPendingGroup = <a class="code" href="Strategic_01Movement_8cpp.html#33138746a238bdc5c684e9aa2c86691c">GetGroup</a>( <a class="code" href="AI_01Viewer_8cpp.html#a9f940d7f3a6d6698bfaeb7c747d74a9">gGarrisonGroup</a>[ <a class="code" href="Campaign_01Types_8h.html#d83c6f699f17a47cf6a662c91d959126">SectorInfo</a>[ ubSectorID ].ubGarrisonID ].ubPendingGroupID );
<a name="l04188"></a>04188                         Assert( pPendingGroup );
<a name="l04189"></a>04189                         <a class="code" href="Auto_01Resolve_8cpp.html#bf99843dcb604b6d631665205f1a3d42">ClearPreviousAIGroupAssignment</a>( pPendingGroup );
<a name="l04190"></a>04190                   }
<a name="l04191"></a>04191                   <span class="comment">//Assign the elite squad to attack the SAM site</span>
<a name="l04192"></a>04192                   pGroup-&gt;<a class="code" href="structGROUP.html#f82ff4c3e504e4bb10feb65491f79471">pEnemyGroup</a>-&gt;<a class="code" href="structENEMYGROUP.html#6d1d418460b3704699f5e058925897e2">ubIntention</a> = <a class="code" href="Strategic_01Movement_8h.html#b59c1bec446b10af208f977a871d910b095b1f433b659c686164f67bb7b89cb1">REINFORCEMENTS</a>;
<a name="l04193"></a>04193                   <a class="code" href="AI_01Viewer_8cpp.html#a9f940d7f3a6d6698bfaeb7c747d74a9">gGarrisonGroup</a>[ <a class="code" href="Campaign_01Types_8h.html#d83c6f699f17a47cf6a662c91d959126">SectorInfo</a>[ ubSectorID ].<a class="code" href="structSECTORINFO.html#9465931dad0e164d7d47814b66e454f0">ubGarrisonID</a> ].<a class="code" href="structGARRISON__GROUP.html#ea8325bf63e1d81924fb5fab93b37d8e">ubPendingGroupID</a> = pGroup-&gt;<a class="code" href="structGROUP.html#9149379b9355afda87a382af5a88d728">ubGroupID</a>;
<a name="l04194"></a>04194 
<a name="l04195"></a>04195                   <span class="keywordflow">if</span>( pPendingGroup )
<a name="l04196"></a>04196                   { <span class="comment">//Reassign the pending group</span>
<a name="l04197"></a>04197                         <a class="code" href="Strategic_01AI_8cpp.html#0ecd8a8d61c81aa34eeec15760348ffe">ReassignAIGroup</a>( &amp;pPendingGroup );
<a name="l04198"></a>04198                   }                 
<a name="l04199"></a>04199                   <span class="keywordflow">break</span>;
<a name="l04200"></a>04200 
<a name="l04201"></a>04201             <span class="keywordflow">case</span> <a class="code" href="interface_01Dialogue_8h.html#2ae95ea8e60178fe99580d5142f0ec7e388fd9c97c5db0e0fbdd4750d5ca4aec">NPC_ACTION_ADD_MORE_ELITES</a>:
<a name="l04202"></a>04202                   <a class="code" href="Strategic_01AI_8cpp.html#da8cb507523142e34aa6a62793f76a88">gfExtraElites</a> = TRUE;
<a name="l04203"></a>04203                   <a class="code" href="Strategic_01AI_8cpp.html#d07e8dc3510ffd7b3bf0713c0a152ae2">EvolveQueenPriorityPhase</a>( TRUE );
<a name="l04204"></a>04204                   <span class="keywordflow">break</span>;
<a name="l04205"></a>04205 
<a name="l04206"></a>04206             <span class="keywordflow">case</span> <a class="code" href="interface_01Dialogue_8h.html#2ae95ea8e60178fe99580d5142f0ec7ebeba19c9ffad39900066f8fe509ee008">NPC_ACTION_GIVE_KNOWLEDGE_OF_ALL_MERCS</a>:
<a name="l04207"></a>04207                   <span class="comment">//temporarily make the queen's forces more aware (high alert)</span>
<a name="l04208"></a>04208                   <span class="keywordflow">switch</span>( <a class="code" href="GameSettings_8cpp.html#f9f2d5fd368ccadcc26bebc202d52ae7">gGameOptions</a>.<a class="code" href="structGAME__OPTIONS.html#4fb44167906152722f6af5cc9f7c1a99">ubDifficultyLevel</a> )
<a name="l04209"></a>04209                   {
<a name="l04210"></a>04210                         <span class="keywordflow">case</span> <a class="code" href="GameSettings_8h.html#c205be2172292384dd687b5471a87eddbd3b0d23f4dc30ef17b50a14c3f54589">DIF_LEVEL_EASY</a>:
<a name="l04211"></a>04211                               <a class="code" href="Strategic_01AI_8cpp.html#ab475b2c021e0d3a27bc5f4c7bd22639">gubNumAwareBattles</a> = <a class="code" href="GameSettings_8cpp.html#5c32f930e2fef384505c4b91803a92c2">gGameExternalOptions</a>.<a class="code" href="structGAME__EXTERNAL__OPTIONS.html#68078c17e9cdb11ce593d39f050f2c42">ubEasyNumAwareBattles</a>;
<a name="l04212"></a>04212                               <span class="keywordflow">break</span>;
<a name="l04213"></a>04213                         <span class="keywordflow">case</span> <a class="code" href="GameSettings_8h.html#c205be2172292384dd687b5471a87edddd0259b09fef163c6aa62268574191cb">DIF_LEVEL_MEDIUM</a>:
<a name="l04214"></a>04214                               <a class="code" href="Strategic_01AI_8cpp.html#ab475b2c021e0d3a27bc5f4c7bd22639">gubNumAwareBattles</a> = <a class="code" href="GameSettings_8cpp.html#5c32f930e2fef384505c4b91803a92c2">gGameExternalOptions</a>.<a class="code" href="structGAME__EXTERNAL__OPTIONS.html#cc70d6fe1e8cc881f885d6e74b932b2c">ubNormalNumAwareBattles</a>;
<a name="l04215"></a>04215                               <span class="keywordflow">break</span>;
<a name="l04216"></a>04216                         <span class="keywordflow">case</span> <a class="code" href="GameSettings_8h.html#c205be2172292384dd687b5471a87edd3d0b73026f1c7122798d578613aa4575">DIF_LEVEL_HARD</a>:
<a name="l04217"></a>04217                               <a class="code" href="Strategic_01AI_8cpp.html#ab475b2c021e0d3a27bc5f4c7bd22639">gubNumAwareBattles</a> = <a class="code" href="GameSettings_8cpp.html#5c32f930e2fef384505c4b91803a92c2">gGameExternalOptions</a>.<a class="code" href="structGAME__EXTERNAL__OPTIONS.html#2f2e1a69816cc6c22b394cf6bf78fce6">ubHardNumAwareBattles</a>;
<a name="l04218"></a>04218                               <span class="keywordflow">break</span>;
<a name="l04219"></a>04219                         <span class="keywordflow">case</span> <a class="code" href="GameSettings_8h.html#c205be2172292384dd687b5471a87eddc657c89fd754a6f20b3869250288a702">DIF_LEVEL_INSANE</a>:
<a name="l04220"></a>04220                               <a class="code" href="Strategic_01AI_8cpp.html#ab475b2c021e0d3a27bc5f4c7bd22639">gubNumAwareBattles</a> = <a class="code" href="GameSettings_8cpp.html#5c32f930e2fef384505c4b91803a92c2">gGameExternalOptions</a>.<a class="code" href="structGAME__EXTERNAL__OPTIONS.html#e73b4cfa538eb25fee0bfee2fd3791fb">ubInsaneNumAwareBattles</a>;
<a name="l04221"></a>04221                               <span class="keywordflow">break</span>;
<a name="l04222"></a>04222                   }
<a name="l04223"></a>04223                   <span class="keywordflow">break</span>;
<a name="l04224"></a>04224 
<a name="l04225"></a>04225             <span class="keywordflow">default</span>:
<a name="l04226"></a>04226                   <a class="code" href="message_8cpp.html#818e47bc59bd5a5755f06ec51cd74928">ScreenMsg</a>( FONT_RED, MSG_DEBUG, L<span class="stringliteral">"QueenAI failed to handle action code %d."</span>, usActionCode );
<a name="l04227"></a>04227                   <span class="keywordflow">break</span>;
<a name="l04228"></a>04228       }
<a name="l04229"></a>04229 }
<a name="l04230"></a>04230 
<a name="l04231"></a>04231 <span class="preprocessor">#ifdef JA2BETAVERSION</span>
<a name="l04232"></a>04232 <span class="preprocessor"></span>
<a name="l04233"></a><a class="code" href="Strategic_01AI_8cpp.html#d90b3ef039d953753e7b2637c16229cf">04233</a> <span class="keywordtype">void</span> <a class="code" href="Strategic_01AI_8cpp.html#d90b3ef039d953753e7b2637c16229cf">LogStrategicMsg</a>( <span class="keywordtype">char</span> * <a class="code" href="Button_01System_8cpp.html#ac22642f3052cc77a6991a262ce4ad23">str</a>, ... )
<a name="l04234"></a>04234 {
<a name="l04235"></a>04235       va_list argptr;
<a name="l04236"></a>04236       <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> string[512];
<a name="l04237"></a>04237 
<a name="l04238"></a>04238       FILE *fp;
<a name="l04239"></a>04239 
<a name="l04240"></a>04240       fp = fopen( <span class="stringliteral">"Strategic Decisions.txt"</span>, <span class="stringliteral">"a"</span> );
<a name="l04241"></a>04241       <span class="keywordflow">if</span>( !fp )
<a name="l04242"></a>04242             <span class="keywordflow">return</span>;
<a name="l04243"></a>04243 
<a name="l04244"></a>04244       va_start(argptr, str );             
<a name="l04245"></a>04245       vsprintf( (<span class="keywordtype">char</span> *)string, str, argptr);                     
<a name="l04246"></a>04246       va_end(argptr);
<a name="l04247"></a>04247 
<a name="l04248"></a>04248       fprintf( fp, <span class="stringliteral">"%s\n"</span>, string );
<a name="l04249"></a>04249 
<a name="l04250"></a>04250       <span class="keywordflow">if</span>( <a class="code" href="Strategic_01AI_8cpp.html#9b562b638dab71449e22ac59b9c090e0">gfDisplayStrategicAILogs</a> )
<a name="l04251"></a>04251       {
<a name="l04252"></a>04252             <a class="code" href="message_8cpp.html#818e47bc59bd5a5755f06ec51cd74928">ScreenMsg</a>( FONT_LTKHAKI, MSG_DIALOG, L<span class="stringliteral">"%S"</span>, string );
<a name="l04253"></a>04253       }
<a name="l04254"></a>04254       <span class="keywordflow">if</span>( <a class="code" href="gameloop_8cpp.html#8cd832c7f0ec6ab02ba9fddd4a2257aa">guiCurrentScreen</a> == <a class="code" href="screenids_8h.html#a4ee5dea8709d2b490486a62df77faf2eddea7bb8551411e5bfb6f052177bc01">AIVIEWER_SCREEN</a> )
<a name="l04255"></a>04255       {
<a name="l04256"></a>04256             OutputDebugString( (LPCSTR)<a class="code" href="DEBUG_8cpp.html#88565bf27eec0b2003eb5bc9426b8e4b">String</a>( <span class="stringliteral">"%s\n"</span>, string ) );
<a name="l04257"></a>04257       }
<a name="l04258"></a>04258 
<a name="l04259"></a>04259       fclose( fp );
<a name="l04260"></a>04260 }
<a name="l04261"></a>04261 
<a name="l04262"></a><a class="code" href="Strategic_01AI_8cpp.html#984e97af1f29d3b417cc5bdcd126cfca">04262</a> <span class="keywordtype">void</span> <a class="code" href="Strategic_01AI_8cpp.html#984e97af1f29d3b417cc5bdcd126cfca">LogStrategicEvent</a>( <span class="keywordtype">char</span> * <a class="code" href="Button_01System_8cpp.html#ac22642f3052cc77a6991a262ce4ad23">str</a>, ... )
<a name="l04263"></a>04263 {
<a name="l04264"></a>04264       va_list argptr;
<a name="l04265"></a>04265       <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> string[512];
<a name="l04266"></a>04266 
<a name="l04267"></a>04267       FILE *fp;
<a name="l04268"></a>04268 
<a name="l04269"></a>04269       fp = fopen( <span class="stringliteral">"Strategic Decisions.txt"</span>, <span class="stringliteral">"a"</span> );
<a name="l04270"></a>04270       <span class="keywordflow">if</span>( !fp )
<a name="l04271"></a>04271             <span class="keywordflow">return</span>;
<a name="l04272"></a>04272 
<a name="l04273"></a>04273       va_start(argptr, str );             
<a name="l04274"></a>04274       vsprintf( (<span class="keywordtype">char</span> *)string, str, argptr);                     
<a name="l04275"></a>04275       va_end(argptr);
<a name="l04276"></a>04276 
<a name="l04277"></a>04277       
<a name="l04278"></a>04278       fprintf( fp, <span class="stringliteral">"\n%S:\n"</span>, WORLDTIMESTR );
<a name="l04279"></a>04279       fprintf( fp, <span class="stringliteral">"%s\n"</span>, string );
<a name="l04280"></a>04280 
<a name="l04281"></a>04281       <span class="keywordflow">if</span>( <a class="code" href="Strategic_01AI_8cpp.html#9b562b638dab71449e22ac59b9c090e0">gfDisplayStrategicAILogs</a> )
<a name="l04282"></a>04282       {
<a name="l04283"></a>04283             <a class="code" href="message_8cpp.html#818e47bc59bd5a5755f06ec51cd74928">ScreenMsg</a>( FONT_LTKHAKI, MSG_DIALOG, L<span class="stringliteral">"%S"</span>, string );
<a name="l04284"></a>04284       }
<a name="l04285"></a>04285       <span class="keywordflow">if</span>( <a class="code" href="gameloop_8cpp.html#8cd832c7f0ec6ab02ba9fddd4a2257aa">guiCurrentScreen</a> == <a class="code" href="screenids_8h.html#a4ee5dea8709d2b490486a62df77faf2eddea7bb8551411e5bfb6f052177bc01">AIVIEWER_SCREEN</a> )
<a name="l04286"></a>04286       {
<a name="l04287"></a>04287             OutputDebugString( (LPCSTR)<a class="code" href="DEBUG_8cpp.html#88565bf27eec0b2003eb5bc9426b8e4b">String</a>( <span class="stringliteral">"%s\n"</span>, string ) );
<a name="l04288"></a>04288       }
<a name="l04289"></a>04289 
<a name="l04290"></a>04290       fclose( fp );
<a name="l04291"></a>04291 }
<a name="l04292"></a>04292 
<a name="l04293"></a><a class="code" href="Strategic_01AI_8cpp.html#2b956b276d118fb0236c612ff42925ab">04293</a> <span class="keywordtype">void</span> <a class="code" href="Strategic_01AI_8cpp.html#2b956b276d118fb0236c612ff42925ab">ClearStrategicLog</a>()
<a name="l04294"></a>04294 {
<a name="l04295"></a>04295       FILE *fp;
<a name="l04296"></a>04296       fp = fopen( <span class="stringliteral">"Strategic Decisions.txt"</span>, <span class="stringliteral">"w"</span> );
<a name="l04297"></a>04297       <span class="keywordflow">if</span>( !fp )
<a name="l04298"></a>04298             <span class="keywordflow">return</span>;
<a name="l04299"></a>04299 
<a name="l04300"></a>04300       fprintf( fp, <span class="stringliteral">"STRATEGIC LOG\n"</span> );
<a name="l04301"></a>04301 
<a name="l04302"></a>04302       fclose( fp );
<a name="l04303"></a>04303 }
<a name="l04304"></a>04304 <span class="preprocessor">#endif</span>
<a name="l04305"></a>04305 <span class="preprocessor"></span>
<a name="l04306"></a><a class="code" href="Strategic_01AI_8h.html#989f4b1d35b53f0de7bd255368ea3c80">04306</a> <span class="keywordtype">void</span> <a class="code" href="Strategic_01AI_8cpp.html#989f4b1d35b53f0de7bd255368ea3c80">InvestigateSector</a>( <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubSectorID )
<a name="l04307"></a>04307 {
<a name="l04308"></a>04308 <span class="comment">/*</span>
<a name="l04309"></a>04309 <span class="comment">      INT32 i;</span>
<a name="l04310"></a>04310 <span class="comment">      SECTORINFO *pSector;</span>
<a name="l04311"></a>04311 <span class="comment">      INT16 sSectorX, sSectorY;</span>
<a name="l04312"></a>04312 <span class="comment">      UINT8 ubAdmins[4], ubTroops[4], ubElites[4], ubNumToSend, ubTotal;</span>
<a name="l04313"></a>04313 <span class="comment"></span>
<a name="l04314"></a>04314 <span class="comment">      //@@@ Disabled!  Also commented out the posting of the event</span>
<a name="l04315"></a>04315 <span class="comment">      return;</span>
<a name="l04316"></a>04316 <span class="comment"></span>
<a name="l04317"></a>04317 <span class="comment">      sSectorX = (INT16)SECTORX( ubSectorID );</span>
<a name="l04318"></a>04318 <span class="comment">      sSectorY = (INT16)SECTORY( ubSectorID );</span>
<a name="l04319"></a>04319 <span class="comment"></span>
<a name="l04320"></a>04320 <span class="comment">      if( guiCurrentScreen != GAME_SCREEN )</span>
<a name="l04321"></a>04321 <span class="comment">      { //If we aren't in tactical, then don't do this.  It is strictly added flavour and would be irritating if</span>
<a name="l04322"></a>04322 <span class="comment">            //you got the prebattle interface in mapscreen while compressing time (right after clearing it...)</span>
<a name="l04323"></a>04323 <span class="comment">            return;</span>
<a name="l04324"></a>04324 <span class="comment">      }</span>
<a name="l04325"></a>04325 <span class="comment"></span>
<a name="l04326"></a>04326 <span class="comment">      if( sSectorX != gWorldSectorX || sSectorY != gWorldSectorY || gbWorldSectorZ )</span>
<a name="l04327"></a>04327 <span class="comment">      { //The sector isn't loaded, so don't bother...</span>
<a name="l04328"></a>04328 <span class="comment">            return;</span>
<a name="l04329"></a>04329 <span class="comment">      }</span>
<a name="l04330"></a>04330 <span class="comment"></span>
<a name="l04331"></a>04331 <span class="comment">      //Now, we will investigate this sector if there are forces in adjacent towns.  For each </span>
<a name="l04332"></a>04332 <span class="comment">      //sector that applies, we will add 1-2 soldiers.</span>
<a name="l04333"></a>04333 <span class="comment"></span>
<a name="l04334"></a>04334 <span class="comment">      ubTotal = 0;</span>
<a name="l04335"></a>04335 <span class="comment">      for( i = 0; i &lt; 4; i++ )</span>
<a name="l04336"></a>04336 <span class="comment">      {</span>
<a name="l04337"></a>04337 <span class="comment">            ubAdmins[i] = ubTroops[i] = ubElites[i] = 0;</span>
<a name="l04338"></a>04338 <span class="comment">            switch( i )</span>
<a name="l04339"></a>04339 <span class="comment">            {</span>
<a name="l04340"></a>04340 <span class="comment">                  case 0: //NORTH</span>
<a name="l04341"></a>04341 <span class="comment">                        if( sSectorY == 1 )</span>
<a name="l04342"></a>04342 <span class="comment">                              continue;</span>
<a name="l04343"></a>04343 <span class="comment">                        pSector = &amp;SectorInfo[ ubSectorID - 16 ];</span>
<a name="l04344"></a>04344 <span class="comment">                        break;</span>
<a name="l04345"></a>04345 <span class="comment">                  case 1: //EAST</span>
<a name="l04346"></a>04346 <span class="comment">                        if( sSectorX == 16 )</span>
<a name="l04347"></a>04347 <span class="comment">                              continue;</span>
<a name="l04348"></a>04348 <span class="comment">                        pSector = &amp;SectorInfo[ ubSectorID + 1 ];</span>
<a name="l04349"></a>04349 <span class="comment">                        break;</span>
<a name="l04350"></a>04350 <span class="comment">                  case 2: //SOUTH</span>
<a name="l04351"></a>04351 <span class="comment">                        if( sSectorY == 16 )</span>
<a name="l04352"></a>04352 <span class="comment">                              continue;</span>
<a name="l04353"></a>04353 <span class="comment">                        pSector = &amp;SectorInfo[ ubSectorID + 16 ];</span>
<a name="l04354"></a>04354 <span class="comment">                        break;</span>
<a name="l04355"></a>04355 <span class="comment">                  case 3: //WEST</span>
<a name="l04356"></a>04356 <span class="comment">                        if( sSectorX == 1 )</span>
<a name="l04357"></a>04357 <span class="comment">                              continue;</span>
<a name="l04358"></a>04358 <span class="comment">                        pSector = &amp;SectorInfo[ ubSectorID - 1 ];</span>
<a name="l04359"></a>04359 <span class="comment">                        break;</span>
<a name="l04360"></a>04360 <span class="comment">            }</span>
<a name="l04361"></a>04361 <span class="comment">            if( pSector-&gt;ubNumAdmins + pSector-&gt;ubNumTroops + pSector-&gt;ubNumElites &gt; 4 )</span>
<a name="l04362"></a>04362 <span class="comment">            {</span>
<a name="l04363"></a>04363 <span class="comment">                  ubNumToSend = (UINT8)(Random( 2 ) + 1);</span>
<a name="l04364"></a>04364 <span class="comment">                  while( ubNumToSend )</span>
<a name="l04365"></a>04365 <span class="comment">                  {</span>
<a name="l04366"></a>04366 <span class="comment">                        if( pSector-&gt;ubNumAdmins )</span>
<a name="l04367"></a>04367 <span class="comment">                        {</span>
<a name="l04368"></a>04368 <span class="comment">                              pSector-&gt;ubNumAdmins--;</span>
<a name="l04369"></a>04369 <span class="comment">                              ubNumToSend--;</span>
<a name="l04370"></a>04370 <span class="comment">                              ubAdmins[i]++;</span>
<a name="l04371"></a>04371 <span class="comment">                              ubTotal++;</span>
<a name="l04372"></a>04372 <span class="comment">                        }</span>
<a name="l04373"></a>04373 <span class="comment">                        else if( pSector-&gt;ubNumTroops )</span>
<a name="l04374"></a>04374 <span class="comment">                        {</span>
<a name="l04375"></a>04375 <span class="comment">                              pSector-&gt;ubNumTroops--;</span>
<a name="l04376"></a>04376 <span class="comment">                              ubNumToSend--;</span>
<a name="l04377"></a>04377 <span class="comment">                              ubTroops[i]++;</span>
<a name="l04378"></a>04378 <span class="comment">                              ubTotal++;</span>
<a name="l04379"></a>04379 <span class="comment">                        }</span>
<a name="l04380"></a>04380 <span class="comment">                        else if( pSector-&gt;ubNumElites )</span>
<a name="l04381"></a>04381 <span class="comment">                        {</span>
<a name="l04382"></a>04382 <span class="comment">                              pSector-&gt;ubNumTroops--;</span>
<a name="l04383"></a>04383 <span class="comment">                              ubNumToSend--;</span>
<a name="l04384"></a>04384 <span class="comment">                              ubTroops[i]++;</span>
<a name="l04385"></a>04385 <span class="comment">                              ubTotal++;</span>
<a name="l04386"></a>04386 <span class="comment">                        }</span>
<a name="l04387"></a>04387 <span class="comment">                        else</span>
<a name="l04388"></a>04388 <span class="comment">                        {</span>
<a name="l04389"></a>04389 <span class="comment">                              break; //???</span>
<a name="l04390"></a>04390 <span class="comment">                        }</span>
<a name="l04391"></a>04391 <span class="comment">                  }</span>
<a name="l04392"></a>04392 <span class="comment">            }</span>
<a name="l04393"></a>04393 <span class="comment">      }</span>
<a name="l04394"></a>04394 <span class="comment">      if( !ubTotal )</span>
<a name="l04395"></a>04395 <span class="comment">      { //Nobody is available to investigate</span>
<a name="l04396"></a>04396 <span class="comment">            return;</span>
<a name="l04397"></a>04397 <span class="comment">      }</span>
<a name="l04398"></a>04398 <span class="comment">      //Now we have decided who to send, so send them.</span>
<a name="l04399"></a>04399 <span class="comment">      for( i = 0; i &lt; 4; i++ )</span>
<a name="l04400"></a>04400 <span class="comment">      {</span>
<a name="l04401"></a>04401 <span class="comment">            if( ubAdmins[i] + ubTroops[i] + ubElites[i] )</span>
<a name="l04402"></a>04402 <span class="comment">            {</span>
<a name="l04403"></a>04403 <span class="comment">                  switch( i )</span>
<a name="l04404"></a>04404 <span class="comment">                  {</span>
<a name="l04405"></a>04405 <span class="comment">                        case 0: //NORTH </span>
<a name="l04406"></a>04406 <span class="comment">                              AddEnemiesToBattle( NULL, INSERTION_CODE_NORTH, ubAdmins[i], ubTroops[i], ubElites[i], TRUE );  </span>
<a name="l04407"></a>04407 <span class="comment">                              break;</span>
<a name="l04408"></a>04408 <span class="comment">                        case 1: //EAST </span>
<a name="l04409"></a>04409 <span class="comment">                              AddEnemiesToBattle( NULL, INSERTION_CODE_EAST, ubAdmins[i], ubTroops[i], ubElites[i], TRUE );   </span>
<a name="l04410"></a>04410 <span class="comment">                              break;</span>
<a name="l04411"></a>04411 <span class="comment">                        case 2: //SOUTH </span>
<a name="l04412"></a>04412 <span class="comment">                              AddEnemiesToBattle( NULL, INSERTION_CODE_SOUTH, ubAdmins[i], ubTroops[i], ubElites[i], TRUE );  </span>
<a name="l04413"></a>04413 <span class="comment">                              break;</span>
<a name="l04414"></a>04414 <span class="comment">                        case 3: //WEST </span>
<a name="l04415"></a>04415 <span class="comment">                              AddEnemiesToBattle( NULL, INSERTION_CODE_WEST, ubAdmins[i], ubTroops[i], ubElites[i], TRUE );   </span>
<a name="l04416"></a>04416 <span class="comment">                              break;</span>
<a name="l04417"></a>04417 <span class="comment">                  }</span>
<a name="l04418"></a>04418 <span class="comment">            }</span>
<a name="l04419"></a>04419 <span class="comment">      }</span>
<a name="l04420"></a>04420 <span class="comment">      if( !gfQueenAIAwake )</span>
<a name="l04421"></a>04421 <span class="comment">      {</span>
<a name="l04422"></a>04422 <span class="comment">            gfFirstBattleMeanwhileScenePending = TRUE;</span>
<a name="l04423"></a>04423 <span class="comment">      }</span>
<a name="l04424"></a>04424 <span class="comment">*/</span>
<a name="l04425"></a>04425 }
<a name="l04426"></a>04426 
<a name="l04427"></a><a class="code" href="Strategic_01AI_8h.html#ca8b5b235d7467d218b7a259585ceaf6">04427</a> <span class="keywordtype">void</span> <a class="code" href="Strategic_01AI_8cpp.html#ca8b5b235d7467d218b7a259585ceaf6">StrategicHandleQueenLosingControlOfSector</a>( <a class="code" href="Types_8h.html#30f500129d8c688af07726d5d34ce52d">INT16</a> sSectorX, <a class="code" href="Types_8h.html#30f500129d8c688af07726d5d34ce52d">INT16</a> sSectorY, <a class="code" href="Types_8h.html#30f500129d8c688af07726d5d34ce52d">INT16</a> sSectorZ )
<a name="l04428"></a>04428 {
<a name="l04429"></a>04429       <a class="code" href="structSECTORINFO.html">SECTORINFO</a> *pSector;
<a name="l04430"></a>04430       <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubSectorID;
<a name="l04431"></a>04431       <span class="keywordflow">if</span>( sSectorZ )
<a name="l04432"></a>04432       { <span class="comment">//The queen doesn't care about anything happening under the ground.</span>
<a name="l04433"></a>04433             <span class="keywordflow">return</span>;
<a name="l04434"></a>04434       }
<a name="l04435"></a>04435       
<a name="l04436"></a>04436       <span class="keywordflow">if</span>( <a class="code" href="strategic_8cpp.html#6f48fb0ea28e3d4889423290f1a6ede8">StrategicMap</a>[ sSectorX + sSectorY * MAP_WORLD_X ].fEnemyControlled )
<a name="l04437"></a>04437       { <span class="comment">//If the sector doesn't belong to the player, then we shouldn't be calling this function!</span>
<a name="l04438"></a>04438             <a class="code" href="Strategic_01AI_8cpp.html#8690badaeb456b31a18dda93bcc1d8df">SAIReportError</a>( L<span class="stringliteral">"StrategicHandleQueenLosingControlOfSector() was called for a sector that is internally considered to be enemy controlled."</span> );
<a name="l04439"></a>04439             <span class="keywordflow">return</span>;
<a name="l04440"></a>04440       }
<a name="l04441"></a>04441 
<a name="l04442"></a>04442       ubSectorID = SECTOR( sSectorX, sSectorY );
<a name="l04443"></a>04443       pSector = &amp;<a class="code" href="Campaign_01Types_8h.html#d83c6f699f17a47cf6a662c91d959126">SectorInfo</a>[ ubSectorID ];
<a name="l04444"></a>04444 
<a name="l04445"></a>04445       <span class="comment">//Keep track of victories and wake up the queen after x number of battles.</span>
<a name="l04446"></a>04446       <a class="code" href="Strategic_01AI_8cpp.html#711cdebe533db7c45a8e7e88c6f312d6">gusPlayerBattleVictories</a>++;
<a name="l04447"></a>04447       <span class="keywordflow">if</span>( <a class="code" href="Strategic_01AI_8cpp.html#711cdebe533db7c45a8e7e88c6f312d6">gusPlayerBattleVictories</a> == 5 - <a class="code" href="GameSettings_8cpp.html#f9f2d5fd368ccadcc26bebc202d52ae7">gGameOptions</a>.<a class="code" href="structGAME__OPTIONS.html#4fb44167906152722f6af5cc9f7c1a99">ubDifficultyLevel</a> )
<a name="l04448"></a>04448       { <span class="comment">//4 victories for easy, 3 for normal, 2 for hard</span>
<a name="l04449"></a>04449             <a class="code" href="Strategic_01AI_8cpp.html#079d19a6a3eb516e60dc98132a6cc5f8">WakeUpQueen</a>();
<a name="l04450"></a>04450       }
<a name="l04451"></a>04451 
<a name="l04452"></a>04452       <span class="keywordflow">if</span>( pSector-&gt;<a class="code" href="structSECTORINFO.html#9465931dad0e164d7d47814b66e454f0">ubGarrisonID</a> == NO_GARRISON )
<a name="l04453"></a>04453       { <span class="comment">//Queen doesn't care if the sector lost wasn't a garrison sector.</span>
<a name="l04454"></a>04454             <span class="keywordflow">return</span>;
<a name="l04455"></a>04455       }
<a name="l04456"></a>04456       <span class="keywordflow">else</span>
<a name="l04457"></a>04457       { <span class="comment">//check to see if there are any pending reinforcements.  If so, then cancel their orders and have them</span>
<a name="l04458"></a>04458             <span class="comment">//reassigned, so the player doesn't get pestered.  This is a feature that *dumbs* down the AI, and is done</span>
<a name="l04459"></a>04459             <span class="comment">//for the sake of gameplay.  We don't want the game to be tedious.</span>
<a name="l04460"></a>04460             <span class="keywordflow">if</span>( !pSector-&gt;<a class="code" href="structSECTORINFO.html#128d73ad43a437241fd20e5a93923db9">uiTimeLastPlayerLiberated</a> )
<a name="l04461"></a>04461             {
<a name="l04462"></a>04462                   pSector-&gt;<a class="code" href="structSECTORINFO.html#128d73ad43a437241fd20e5a93923db9">uiTimeLastPlayerLiberated</a> = <a class="code" href="Game_01Clock_8cpp.html#44b17d324c70be123694dba2deca1b89">GetWorldTotalSeconds</a>();
<a name="l04463"></a>04463             }
<a name="l04464"></a>04464             <span class="keywordflow">else</span>
<a name="l04465"></a>04465             { <span class="comment">//convert hours to seconds and subtract up to half of it randomly "seconds - (hours*3600 / 2)"</span>
<a name="l04466"></a>04466                   pSector-&gt;<a class="code" href="structSECTORINFO.html#128d73ad43a437241fd20e5a93923db9">uiTimeLastPlayerLiberated</a> = <a class="code" href="Game_01Clock_8cpp.html#44b17d324c70be123694dba2deca1b89">GetWorldTotalSeconds</a>() - <a class="code" href="Random_8cpp.html#49f938d1313ab6ef09ac6223a16ac334">Random</a>( <a class="code" href="Strategic_01AI_8cpp.html#123935928b8e3146a1edda9d78cfea62">gubHoursGracePeriod</a> * 1800 );
<a name="l04467"></a>04467             }
<a name="l04468"></a>04468             <span class="keywordflow">if</span>( <a class="code" href="AI_01Viewer_8cpp.html#a9f940d7f3a6d6698bfaeb7c747d74a9">gGarrisonGroup</a>[ pSector-&gt;<a class="code" href="structSECTORINFO.html#9465931dad0e164d7d47814b66e454f0">ubGarrisonID</a> ].ubPendingGroupID )
<a name="l04469"></a>04469             {
<a name="l04470"></a>04470                   <a class="code" href="structGROUP.html">GROUP</a> *pGroup;
<a name="l04471"></a>04471                   pGroup = <a class="code" href="Strategic_01Movement_8cpp.html#33138746a238bdc5c684e9aa2c86691c">GetGroup</a>( <a class="code" href="AI_01Viewer_8cpp.html#a9f940d7f3a6d6698bfaeb7c747d74a9">gGarrisonGroup</a>[ pSector-&gt;<a class="code" href="structSECTORINFO.html#9465931dad0e164d7d47814b66e454f0">ubGarrisonID</a> ].ubPendingGroupID );
<a name="l04472"></a>04472                   <span class="keywordflow">if</span>( pGroup )
<a name="l04473"></a>04473                   {
<a name="l04474"></a>04474                         <a class="code" href="Strategic_01AI_8cpp.html#0ecd8a8d61c81aa34eeec15760348ffe">ReassignAIGroup</a>( &amp;pGroup );
<a name="l04475"></a>04475                   }
<a name="l04476"></a>04476                   <a class="code" href="AI_01Viewer_8cpp.html#a9f940d7f3a6d6698bfaeb7c747d74a9">gGarrisonGroup</a>[ pSector-&gt;<a class="code" href="structSECTORINFO.html#9465931dad0e164d7d47814b66e454f0">ubGarrisonID</a> ].<a class="code" href="structGARRISON__GROUP.html#ea8325bf63e1d81924fb5fab93b37d8e">ubPendingGroupID</a> = 0;
<a name="l04477"></a>04477             }
<a name="l04478"></a>04478       }
<a name="l04479"></a>04479 
<a name="l04480"></a>04480       <span class="comment">//If there are any enemy groups that will be moving through this sector due, they will have to repath which</span>
<a name="l04481"></a>04481       <span class="comment">//will cause them to avoid the sector.  Returns the number of redirected groups.</span>
<a name="l04482"></a>04482       <a class="code" href="Strategic_01AI_8cpp.html#a59392985568cf90cc017a406b3b6e0f">RedirectEnemyGroupsMovingThroughSector</a>( (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)sSectorX, (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)sSectorY );
<a name="l04483"></a>04483 
<a name="l04484"></a>04484       <span class="comment">//For the purposes of a town being lost, we shall check to see if the queen wishes to investigate quickly after</span>
<a name="l04485"></a>04485       <span class="comment">//losing.  This is done in town sectors when the character first takes it.</span>
<a name="l04486"></a>04486       <span class="keywordflow">switch</span>( ubSectorID )
<a name="l04487"></a>04487       {
<a name="l04488"></a>04488             <span class="keywordflow">case</span> <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c66026436d911e0461303edb9fe227735f787c22">SEC_B13</a>:
<a name="l04489"></a>04489             <span class="keywordflow">case</span> <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643e84863fb1442cf38c7311021990a9bc3">SEC_C13</a>:
<a name="l04490"></a>04490             <span class="keywordflow">case</span> <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c66026435b0fbd8598540769dcf8f24e3134f48c">SEC_D13</a>:
<a name="l04491"></a>04491                   <span class="comment">//Drassen</span>
<a name="l04492"></a>04492                   <a class="code" href="Campaign_01Types_8h.html#d83c6f699f17a47cf6a662c91d959126">SectorInfo</a>[ <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c66026436d911e0461303edb9fe227735f787c22">SEC_B13</a> ].<a class="code" href="structSECTORINFO.html#4c9548e98307ee6a1fef7db4edea04e4">ubInvestigativeState</a>++;
<a name="l04493"></a>04493                   <a class="code" href="Campaign_01Types_8h.html#d83c6f699f17a47cf6a662c91d959126">SectorInfo</a>[ <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643e84863fb1442cf38c7311021990a9bc3">SEC_C13</a> ].<a class="code" href="structSECTORINFO.html#4c9548e98307ee6a1fef7db4edea04e4">ubInvestigativeState</a>++;
<a name="l04494"></a>04494                   <a class="code" href="Campaign_01Types_8h.html#d83c6f699f17a47cf6a662c91d959126">SectorInfo</a>[ <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c66026435b0fbd8598540769dcf8f24e3134f48c">SEC_D13</a> ].<a class="code" href="structSECTORINFO.html#4c9548e98307ee6a1fef7db4edea04e4">ubInvestigativeState</a>++;
<a name="l04495"></a>04495                   <span class="keywordflow">break</span>;
<a name="l04496"></a>04496             <span class="keywordflow">case</span> <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643ddb3565a81ff778bd1d7d0720e7beb1f">SEC_A2</a>:
<a name="l04497"></a>04497             <span class="keywordflow">case</span> <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643a9584a4fb3b1d601490ee1f4703cdab2">SEC_B2</a>:
<a name="l04498"></a>04498                   <span class="comment">//Chitzena</span>
<a name="l04499"></a>04499                   <a class="code" href="Campaign_01Types_8h.html#d83c6f699f17a47cf6a662c91d959126">SectorInfo</a>[ <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643ddb3565a81ff778bd1d7d0720e7beb1f">SEC_A2</a> ].<a class="code" href="structSECTORINFO.html#4c9548e98307ee6a1fef7db4edea04e4">ubInvestigativeState</a>++;
<a name="l04500"></a>04500                   <a class="code" href="Campaign_01Types_8h.html#d83c6f699f17a47cf6a662c91d959126">SectorInfo</a>[ <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643a9584a4fb3b1d601490ee1f4703cdab2">SEC_B2</a> ].<a class="code" href="structSECTORINFO.html#4c9548e98307ee6a1fef7db4edea04e4">ubInvestigativeState</a>++;
<a name="l04501"></a>04501                   <span class="keywordflow">break</span>;
<a name="l04502"></a>04502             <span class="keywordflow">case</span> <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643017ca621475f0a51e675ed5e1e87d3f6">SEC_G1</a>:
<a name="l04503"></a>04503             <span class="keywordflow">case</span> <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c660264309137054660d73ef1f5301d5ff96144b">SEC_G2</a>:
<a name="l04504"></a>04504             <span class="keywordflow">case</span> <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643a24273723441a8bfdfc7367e2d2a29b1">SEC_H1</a>:
<a name="l04505"></a>04505             <span class="keywordflow">case</span> <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c660264379c7198e0d00238a4c3cfe6454fa6936">SEC_H2</a>:
<a name="l04506"></a>04506             <span class="keywordflow">case</span> <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643c6ced202c824aa65d9d2f53922400fa1">SEC_H3</a>:
<a name="l04507"></a>04507                   <span class="comment">//Grumm</span>
<a name="l04508"></a>04508                   <a class="code" href="Campaign_01Types_8h.html#d83c6f699f17a47cf6a662c91d959126">SectorInfo</a>[ <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643017ca621475f0a51e675ed5e1e87d3f6">SEC_G1</a> ].<a class="code" href="structSECTORINFO.html#4c9548e98307ee6a1fef7db4edea04e4">ubInvestigativeState</a>++;
<a name="l04509"></a>04509                   <a class="code" href="Campaign_01Types_8h.html#d83c6f699f17a47cf6a662c91d959126">SectorInfo</a>[ <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c660264309137054660d73ef1f5301d5ff96144b">SEC_G2</a> ].<a class="code" href="structSECTORINFO.html#4c9548e98307ee6a1fef7db4edea04e4">ubInvestigativeState</a>++;
<a name="l04510"></a>04510                   <a class="code" href="Campaign_01Types_8h.html#d83c6f699f17a47cf6a662c91d959126">SectorInfo</a>[ <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643a24273723441a8bfdfc7367e2d2a29b1">SEC_H1</a> ].<a class="code" href="structSECTORINFO.html#4c9548e98307ee6a1fef7db4edea04e4">ubInvestigativeState</a>++;
<a name="l04511"></a>04511                   <a class="code" href="Campaign_01Types_8h.html#d83c6f699f17a47cf6a662c91d959126">SectorInfo</a>[ <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c660264379c7198e0d00238a4c3cfe6454fa6936">SEC_H2</a> ].<a class="code" href="structSECTORINFO.html#4c9548e98307ee6a1fef7db4edea04e4">ubInvestigativeState</a>++;
<a name="l04512"></a>04512                   <a class="code" href="Campaign_01Types_8h.html#d83c6f699f17a47cf6a662c91d959126">SectorInfo</a>[ <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643c6ced202c824aa65d9d2f53922400fa1">SEC_H3</a> ].<a class="code" href="structSECTORINFO.html#4c9548e98307ee6a1fef7db4edea04e4">ubInvestigativeState</a>++;
<a name="l04513"></a>04513                   <span class="keywordflow">break</span>;
<a name="l04514"></a>04514             <span class="keywordflow">case</span> <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643e0a7185e05270b8ffacff9816031ae8e">SEC_F8</a>:
<a name="l04515"></a>04515             <span class="keywordflow">case</span> <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643a20fa3a3e3da7996c9d5fab6d2fb6e84">SEC_F9</a>:
<a name="l04516"></a>04516             <span class="keywordflow">case</span> <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643d037ec147301d1498cd5ea0307da2d34">SEC_G8</a>:
<a name="l04517"></a>04517             <span class="keywordflow">case</span> <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643fa4b17f23c10d54767184540803edce8">SEC_G9</a>:
<a name="l04518"></a>04518             <span class="keywordflow">case</span> <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643897f1cfaae4b38d8022feec3521887df">SEC_H8</a>:
<a name="l04519"></a>04519                   <span class="comment">//Cambria</span>
<a name="l04520"></a>04520                   <a class="code" href="Campaign_01Types_8h.html#d83c6f699f17a47cf6a662c91d959126">SectorInfo</a>[ <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643e0a7185e05270b8ffacff9816031ae8e">SEC_F8</a> ].<a class="code" href="structSECTORINFO.html#4c9548e98307ee6a1fef7db4edea04e4">ubInvestigativeState</a>++;
<a name="l04521"></a>04521                   <a class="code" href="Campaign_01Types_8h.html#d83c6f699f17a47cf6a662c91d959126">SectorInfo</a>[ <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643a20fa3a3e3da7996c9d5fab6d2fb6e84">SEC_F9</a> ].<a class="code" href="structSECTORINFO.html#4c9548e98307ee6a1fef7db4edea04e4">ubInvestigativeState</a>++;
<a name="l04522"></a>04522                   <a class="code" href="Campaign_01Types_8h.html#d83c6f699f17a47cf6a662c91d959126">SectorInfo</a>[ <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643d037ec147301d1498cd5ea0307da2d34">SEC_G8</a> ].<a class="code" href="structSECTORINFO.html#4c9548e98307ee6a1fef7db4edea04e4">ubInvestigativeState</a>++;
<a name="l04523"></a>04523                   <a class="code" href="Campaign_01Types_8h.html#d83c6f699f17a47cf6a662c91d959126">SectorInfo</a>[ <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643fa4b17f23c10d54767184540803edce8">SEC_G9</a> ].<a class="code" href="structSECTORINFO.html#4c9548e98307ee6a1fef7db4edea04e4">ubInvestigativeState</a>++;
<a name="l04524"></a>04524                   <a class="code" href="Campaign_01Types_8h.html#d83c6f699f17a47cf6a662c91d959126">SectorInfo</a>[ <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643897f1cfaae4b38d8022feec3521887df">SEC_H8</a> ].<a class="code" href="structSECTORINFO.html#4c9548e98307ee6a1fef7db4edea04e4">ubInvestigativeState</a>++;
<a name="l04525"></a>04525                   <span class="keywordflow">break</span>;
<a name="l04526"></a>04526             <span class="keywordflow">case</span> <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c66026438001804c2db19d8207f0a9c3831c1641">SEC_H13</a>:
<a name="l04527"></a>04527             <span class="keywordflow">case</span> <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c660264366323a5525ca3cd54932950695c8568f">SEC_H14</a>:
<a name="l04528"></a>04528             <span class="keywordflow">case</span> <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c66026434c49cae4ea3baeedd77443968a3166c0">SEC_I13</a>:
<a name="l04529"></a>04529             <span class="keywordflow">case</span> <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643c236a562a9b38d2ee3c7d7ed06e88faf">SEC_I14</a>:
<a name="l04530"></a>04530                   <span class="comment">//Alma</span>
<a name="l04531"></a>04531                   <a class="code" href="Campaign_01Types_8h.html#d83c6f699f17a47cf6a662c91d959126">SectorInfo</a>[ <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c66026438001804c2db19d8207f0a9c3831c1641">SEC_H13</a> ].<a class="code" href="structSECTORINFO.html#4c9548e98307ee6a1fef7db4edea04e4">ubInvestigativeState</a>++;
<a name="l04532"></a>04532                   <a class="code" href="Campaign_01Types_8h.html#d83c6f699f17a47cf6a662c91d959126">SectorInfo</a>[ <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c660264366323a5525ca3cd54932950695c8568f">SEC_H14</a> ].<a class="code" href="structSECTORINFO.html#4c9548e98307ee6a1fef7db4edea04e4">ubInvestigativeState</a>++;
<a name="l04533"></a>04533                   <a class="code" href="Campaign_01Types_8h.html#d83c6f699f17a47cf6a662c91d959126">SectorInfo</a>[ <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c66026434c49cae4ea3baeedd77443968a3166c0">SEC_I13</a> ].<a class="code" href="structSECTORINFO.html#4c9548e98307ee6a1fef7db4edea04e4">ubInvestigativeState</a>++;
<a name="l04534"></a>04534                   <a class="code" href="Campaign_01Types_8h.html#d83c6f699f17a47cf6a662c91d959126">SectorInfo</a>[ <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643c236a562a9b38d2ee3c7d7ed06e88faf">SEC_I14</a> ].<a class="code" href="structSECTORINFO.html#4c9548e98307ee6a1fef7db4edea04e4">ubInvestigativeState</a>++;
<a name="l04535"></a>04535                   <span class="keywordflow">break</span>;
<a name="l04536"></a>04536             <span class="keywordflow">case</span> <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c66026437f0f7646790ef9e89f4fae8f11c2f30a">SEC_L11</a>:
<a name="l04537"></a>04537             <span class="keywordflow">case</span> <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c660264361fb89a0c647c8f639c74c64df117097">SEC_L12</a>:
<a name="l04538"></a>04538                   <span class="comment">//Balime</span>
<a name="l04539"></a>04539                   <a class="code" href="Campaign_01Types_8h.html#d83c6f699f17a47cf6a662c91d959126">SectorInfo</a>[ <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c66026437f0f7646790ef9e89f4fae8f11c2f30a">SEC_L11</a> ].<a class="code" href="structSECTORINFO.html#4c9548e98307ee6a1fef7db4edea04e4">ubInvestigativeState</a>++;
<a name="l04540"></a>04540                   <a class="code" href="Campaign_01Types_8h.html#d83c6f699f17a47cf6a662c91d959126">SectorInfo</a>[ <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c660264361fb89a0c647c8f639c74c64df117097">SEC_L12</a> ].<a class="code" href="structSECTORINFO.html#4c9548e98307ee6a1fef7db4edea04e4">ubInvestigativeState</a>++;
<a name="l04541"></a>04541                   <span class="keywordflow">break</span>;
<a name="l04542"></a>04542             <span class="keywordflow">case</span> <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643a36f934059c25f9a7548ad011f65ec3b">SEC_N3</a>:
<a name="l04543"></a>04543             <span class="keywordflow">case</span> <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643a1f02b8d49f15ade9e5c53145d967651">SEC_N4</a>:
<a name="l04544"></a>04544             <span class="keywordflow">case</span> <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c66026436e2a46748c66280f0d844e72da8249da">SEC_N5</a>:
<a name="l04545"></a>04545             <span class="keywordflow">case</span> <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643e6f2813ad83edbf7f6e4e9069e9b5af9">SEC_O3</a>:
<a name="l04546"></a>04546             <span class="keywordflow">case</span> <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c66026430ee75d7f56db66473f34db57c8dbf564">SEC_O4</a>:
<a name="l04547"></a>04547             <span class="keywordflow">case</span> <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c66026438a2eb9999a6ad7c69c9ddbe2d95696ca">SEC_P3</a>:
<a name="l04548"></a>04548                   <span class="comment">//Meduna</span>
<a name="l04549"></a>04549                   <a class="code" href="Campaign_01Types_8h.html#d83c6f699f17a47cf6a662c91d959126">SectorInfo</a>[ <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643a36f934059c25f9a7548ad011f65ec3b">SEC_N3</a> ].<a class="code" href="structSECTORINFO.html#4c9548e98307ee6a1fef7db4edea04e4">ubInvestigativeState</a>++;
<a name="l04550"></a>04550                   <a class="code" href="Campaign_01Types_8h.html#d83c6f699f17a47cf6a662c91d959126">SectorInfo</a>[ <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643a1f02b8d49f15ade9e5c53145d967651">SEC_N4</a> ].<a class="code" href="structSECTORINFO.html#4c9548e98307ee6a1fef7db4edea04e4">ubInvestigativeState</a>++;
<a name="l04551"></a>04551                   <a class="code" href="Campaign_01Types_8h.html#d83c6f699f17a47cf6a662c91d959126">SectorInfo</a>[ <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c66026436e2a46748c66280f0d844e72da8249da">SEC_N5</a> ].<a class="code" href="structSECTORINFO.html#4c9548e98307ee6a1fef7db4edea04e4">ubInvestigativeState</a>++;
<a name="l04552"></a>04552                   <a class="code" href="Campaign_01Types_8h.html#d83c6f699f17a47cf6a662c91d959126">SectorInfo</a>[ <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643e6f2813ad83edbf7f6e4e9069e9b5af9">SEC_O3</a> ].<a class="code" href="structSECTORINFO.html#4c9548e98307ee6a1fef7db4edea04e4">ubInvestigativeState</a>++;
<a name="l04553"></a>04553                   <a class="code" href="Campaign_01Types_8h.html#d83c6f699f17a47cf6a662c91d959126">SectorInfo</a>[ <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c66026430ee75d7f56db66473f34db57c8dbf564">SEC_O4</a> ].<a class="code" href="structSECTORINFO.html#4c9548e98307ee6a1fef7db4edea04e4">ubInvestigativeState</a>++;
<a name="l04554"></a>04554                   <a class="code" href="Campaign_01Types_8h.html#d83c6f699f17a47cf6a662c91d959126">SectorInfo</a>[ <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c66026438a2eb9999a6ad7c69c9ddbe2d95696ca">SEC_P3</a> ].<a class="code" href="structSECTORINFO.html#4c9548e98307ee6a1fef7db4edea04e4">ubInvestigativeState</a>++;
<a name="l04555"></a>04555                   <span class="keywordflow">break</span>;
<a name="l04556"></a>04556             <span class="keywordflow">default</span>:
<a name="l04557"></a>04557                   <span class="keywordflow">return</span>;
<a name="l04558"></a>04558       }
<a name="l04559"></a>04559       
<a name="l04560"></a>04560       <span class="keywordflow">if</span>( pSector-&gt;<a class="code" href="structSECTORINFO.html#4c9548e98307ee6a1fef7db4edea04e4">ubInvestigativeState</a> &gt;= ( 4 * <a class="code" href="GameSettings_8cpp.html#f9f2d5fd368ccadcc26bebc202d52ae7">gGameOptions</a>.<a class="code" href="structGAME__OPTIONS.html#4fb44167906152722f6af5cc9f7c1a99">ubDifficultyLevel</a> ) &amp;&amp; <a class="code" href="GameSettings_8cpp.html#f9f2d5fd368ccadcc26bebc202d52ae7">gGameOptions</a>.<a class="code" href="structGAME__OPTIONS.html#4fb44167906152722f6af5cc9f7c1a99">ubDifficultyLevel</a> &lt; <a class="code" href="GameSettings_8h.html#c205be2172292384dd687b5471a87eddc657c89fd754a6f20b3869250288a702">DIF_LEVEL_INSANE</a> )  <span class="comment">//Madd: tweaked to increase attacks for experienced and expert to 8 and 12, and unlimited for insane</span>
<a name="l04561"></a>04561       { <span class="comment">//This is the 4th time the player has conquered this sector.  We won't pester the player with probing attacks here anymore.</span>
<a name="l04562"></a>04562             <span class="keywordflow">return</span>;  
<a name="l04563"></a>04563       }
<a name="l04564"></a>04564       <span class="keywordflow">if</span>( sSectorX != <a class="code" href="strategicmap_8cpp.html#49d9aed144a633fda4ba1990f002d703">gWorldSectorX</a> || sSectorY != <a class="code" href="strategicmap_8cpp.html#ea322310ced0e35ee18a2ee7b32aac5b">gWorldSectorY</a> )
<a name="l04565"></a>04565       { <span class="comment">//The sector isn't loaded, so don't probe attack it.  Otherwise, autoresolve would get them smoked!</span>
<a name="l04566"></a>04566             <span class="keywordflow">return</span>;
<a name="l04567"></a>04567       }
<a name="l04568"></a>04568       <span class="comment">//@@@ disabled</span>
<a name="l04569"></a>04569       <span class="comment">//AddStrategicEventUsingSeconds( EVENT_INVESTIGATE_SECTOR, GetWorldTotalSeconds() + 45 * pSector-&gt;ubInvestigativeState + Random( 60 ), SECTOR( sSectorX, sSectorY ) );</span>
<a name="l04570"></a>04570 }
<a name="l04571"></a>04571 
<a name="l04572"></a><a class="code" href="Strategic_01AI_8cpp.html#5742912187ab0b5495a1cc8894341057">04572</a> <span class="keywordtype">void</span> <a class="code" href="Strategic_01AI_8cpp.html#5742912187ab0b5495a1cc8894341057">RequestHighPriorityStagingGroupReinforcements</a>( <a class="code" href="structGROUP.html">GROUP</a> *pGroup )
<a name="l04573"></a>04573 {
<a name="l04574"></a>04574 <span class="comment">//    GROUP *pClosestGroup;</span>
<a name="l04575"></a>04575       <span class="keywordflow">if</span>( !pGroup-&gt;<a class="code" href="structGROUP.html#f82ff4c3e504e4bb10feb65491f79471">pEnemyGroup</a>-&gt;<a class="code" href="structENEMYGROUP.html#a447d1ef7bb91286580af1f04bb4f4c2">ubPendingReinforcements</a> )
<a name="l04576"></a>04576       {
<a name="l04577"></a>04577             <span class="keywordflow">return</span>;
<a name="l04578"></a>04578       }
<a name="l04579"></a>04579       <span class="comment">//pClosestGroup = SearchForClosestGroup( pGroup );</span>
<a name="l04580"></a>04580 }
<a name="l04581"></a>04581 
<a name="l04582"></a>04582 
<a name="l04583"></a><a class="code" href="Strategic_01AI_8cpp.html#2799799f66e73a59f9f2ad7ccbb07451">04583</a> <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> <a class="code" href="Strategic_01AI_8cpp.html#2799799f66e73a59f9f2ad7ccbb07451">SectorDistance</a>( <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubSectorID1, <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubSectorID2 )
<a name="l04584"></a>04584 {
<a name="l04585"></a>04585       <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubSectorX1, ubSectorX2, ubSectorY1, ubSectorY2;
<a name="l04586"></a>04586       <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubDist;
<a name="l04587"></a>04587       ubSectorX1 = (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)SECTORX( ubSectorID1 );
<a name="l04588"></a>04588       ubSectorX2 = (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)SECTORX( ubSectorID2 );
<a name="l04589"></a>04589       ubSectorY1 = (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)SECTORY( ubSectorID1 );
<a name="l04590"></a>04590       ubSectorY2 = (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)SECTORY( ubSectorID2 );
<a name="l04591"></a>04591       
<a name="l04592"></a>04592       ubDist = (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)( abs( ubSectorX1 - ubSectorX2 ) + abs( ubSectorY1 - ubSectorY2 ) );
<a name="l04593"></a>04593 
<a name="l04594"></a>04594       <span class="keywordflow">return</span> ubDist;
<a name="l04595"></a>04595 }
<a name="l04596"></a>04596 
<a name="l04597"></a><a class="code" href="Strategic_01AI_8cpp.html#2fa0b96eae51a7e2732753424608b833">04597</a> <span class="keywordtype">void</span> <a class="code" href="Strategic_01AI_8cpp.html#2fa0b96eae51a7e2732753424608b833">RequestHighPriorityGarrisonReinforcements</a>( <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a> iGarrisonID, <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubSoldiersRequested )
<a name="l04598"></a>04598 {
<a name="l04599"></a>04599       <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a> i, iBestIndex;
<a name="l04600"></a>04600       <a class="code" href="structGROUP.html">GROUP</a> *pGroup;
<a name="l04601"></a>04601       <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubBestDist, ubDist;
<a name="l04602"></a>04602       <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubDstSectorX, ubDstSectorY;
<a name="l04603"></a>04603       <span class="comment">//AssertMsg( giPatrolArraySize == PATROL_GROUPS &amp;&amp; giGarrisonArraySize == GARRISON_GROUPS, "Strategic AI -- Patrol and/or garrison group definition mismatch." );</span>
<a name="l04604"></a>04604       ubBestDist = 255;
<a name="l04605"></a>04605       iBestIndex = -1;
<a name="l04606"></a>04606       <span class="keywordflow">for</span>( i = 0; i &lt; giPatrolArraySize; i++ )
<a name="l04607"></a>04607       {
<a name="l04608"></a>04608             <span class="keywordflow">if</span>( <a class="code" href="Strategic_01AI_8cpp.html#9e00ccb0e77cec57208c519e8f831f53">gPatrolGroup</a>[ i ].ubGroupID )
<a name="l04609"></a>04609             {
<a name="l04610"></a>04610                   pGroup = <a class="code" href="Strategic_01Movement_8cpp.html#33138746a238bdc5c684e9aa2c86691c">GetGroup</a>( <a class="code" href="Strategic_01AI_8cpp.html#9e00ccb0e77cec57208c519e8f831f53">gPatrolGroup</a>[ i ].ubGroupID );
<a name="l04611"></a>04611                   <span class="keywordflow">if</span>( pGroup &amp;&amp; pGroup-&gt;<a class="code" href="structGROUP.html#2a98517c894019ee794e04ea05d1aeaf">ubGroupSize</a> &gt;= ubSoldiersRequested )
<a name="l04612"></a>04612                   {
<a name="l04613"></a>04613                         ubDist = <a class="code" href="Strategic_01AI_8cpp.html#2799799f66e73a59f9f2ad7ccbb07451">SectorDistance</a>( (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)SECTOR( pGroup-&gt;<a class="code" href="structGROUP.html#eee29372e834112984eab1dc714466c0">ubSectorX</a>, pGroup-&gt;<a class="code" href="structGROUP.html#11cd63715d9daf1488cca330690db007">ubSectorY</a> ), <a class="code" href="AI_01Viewer_8cpp.html#a9f940d7f3a6d6698bfaeb7c747d74a9">gGarrisonGroup</a>[ iGarrisonID ].<a class="code" href="structGARRISON__GROUP.html#fb130d3c9211374d87a85cca787fe0dd">ubSectorID</a> );
<a name="l04614"></a>04614                         <span class="keywordflow">if</span>( ubDist &lt; ubBestDist )
<a name="l04615"></a>04615                         {
<a name="l04616"></a>04616                               ubBestDist = ubDist;
<a name="l04617"></a>04617                               iBestIndex = i;
<a name="l04618"></a>04618                         }
<a name="l04619"></a>04619                   }
<a name="l04620"></a>04620             }
<a name="l04621"></a>04621       }
<a name="l04622"></a>04622       ubDstSectorX = (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)SECTORX( <a class="code" href="AI_01Viewer_8cpp.html#a9f940d7f3a6d6698bfaeb7c747d74a9">gGarrisonGroup</a>[ iGarrisonID ].ubSectorID );
<a name="l04623"></a>04623       ubDstSectorY = (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)SECTORY( <a class="code" href="AI_01Viewer_8cpp.html#a9f940d7f3a6d6698bfaeb7c747d74a9">gGarrisonGroup</a>[ iGarrisonID ].ubSectorID );
<a name="l04624"></a>04624       <span class="keywordflow">if</span>( iBestIndex != -1 )
<a name="l04625"></a>04625       { <span class="comment">//Send the group to the garrison</span>
<a name="l04626"></a>04626             pGroup = <a class="code" href="Strategic_01Movement_8cpp.html#33138746a238bdc5c684e9aa2c86691c">GetGroup</a>( <a class="code" href="Strategic_01AI_8cpp.html#9e00ccb0e77cec57208c519e8f831f53">gPatrolGroup</a>[ iBestIndex ].ubGroupID );
<a name="l04627"></a>04627             <span class="keywordflow">if</span>( pGroup-&gt;ubGroupSize &gt; ubSoldiersRequested &amp;&amp; pGroup-&gt;ubGroupSize - ubSoldiersRequested &gt;= <a class="code" href="Strategic_01AI_8cpp.html#12b5525b1f3dabeac40700eecd3219e7">gubMinEnemyGroupSize</a> )
<a name="l04628"></a>04628             { <span class="comment">//Split the group, and send to location</span>
<a name="l04629"></a>04629                   <a class="code" href="structGROUP.html">GROUP</a> *pNewGroup;
<a name="l04630"></a>04630                   pNewGroup = <a class="code" href="Strategic_01Movement_8cpp.html#a6ac42d3d57b37a44bc39b3cd55ec008">CreateNewEnemyGroupDepartingFromSector</a>( (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)SECTOR( pGroup-&gt;ubSectorX, pGroup-&gt;ubSectorY ), 0, 0, 0 );
<a name="l04631"></a>04631                   <span class="comment">//Transfer the troops from group to new group</span>
<a name="l04632"></a>04632                   <span class="keywordflow">if</span>( pGroup-&gt;pEnemyGroup-&gt;ubNumTroops &gt;= ubSoldiersRequested )
<a name="l04633"></a>04633                   { <span class="comment">//All of them are troops, so do it in one shot.</span>
<a name="l04634"></a>04634                         pGroup-&gt;<a class="code" href="structGROUP.html#f82ff4c3e504e4bb10feb65491f79471">pEnemyGroup</a>-&gt;<a class="code" href="structENEMYGROUP.html#27eaaea857408bc6c6358054c19f2d07">ubNumTroops</a> -= ubSoldiersRequested;
<a name="l04635"></a>04635                         pGroup-&gt;ubGroupSize -= ubSoldiersRequested;
<a name="l04636"></a>04636                         pNewGroup-&gt;pEnemyGroup-&gt;ubNumTroops = ubSoldiersRequested;
<a name="l04637"></a>04637                         pNewGroup-&gt;ubGroupSize += ubSoldiersRequested;
<a name="l04638"></a>04638                         <a class="code" href="Strategic_01AI_8cpp.html#cc36ad74d06a3b8b211a4e06c8528a43">ValidateLargeGroup</a>( pGroup );
<a name="l04639"></a>04639                         <a class="code" href="Strategic_01AI_8cpp.html#cc36ad74d06a3b8b211a4e06c8528a43">ValidateLargeGroup</a>( pNewGroup );
<a name="l04640"></a>04640                   }
<a name="l04641"></a>04641                   <span class="keywordflow">else</span> <span class="keywordflow">while</span>( ubSoldiersRequested )
<a name="l04642"></a>04642                   { <span class="comment">//There aren't enough troops, so transfer other types when we run out of troops, prioritizing admins, then elites.</span>
<a name="l04643"></a>04643                         <span class="keywordflow">if</span>( pGroup-&gt;pEnemyGroup-&gt;ubNumTroops )
<a name="l04644"></a>04644                         {
<a name="l04645"></a>04645                               pGroup-&gt;pEnemyGroup-&gt;ubNumTroops--;
<a name="l04646"></a>04646                               pGroup-&gt;ubGroupSize--;
<a name="l04647"></a>04647                               pNewGroup-&gt;pEnemyGroup-&gt;ubNumTroops++;
<a name="l04648"></a>04648                               pNewGroup-&gt;ubGroupSize++;
<a name="l04649"></a>04649                               ubSoldiersRequested--;
<a name="l04650"></a>04650                               <a class="code" href="Strategic_01AI_8cpp.html#cc36ad74d06a3b8b211a4e06c8528a43">ValidateLargeGroup</a>( pGroup );
<a name="l04651"></a>04651                               <a class="code" href="Strategic_01AI_8cpp.html#cc36ad74d06a3b8b211a4e06c8528a43">ValidateLargeGroup</a>( pNewGroup );
<a name="l04652"></a>04652                         }
<a name="l04653"></a>04653                         <span class="keywordflow">else</span> <span class="keywordflow">if</span>( pGroup-&gt;pEnemyGroup-&gt;ubNumAdmins )
<a name="l04654"></a>04654                         {
<a name="l04655"></a>04655                               pGroup-&gt;pEnemyGroup-&gt;ubNumAdmins--;
<a name="l04656"></a>04656                               pGroup-&gt;ubGroupSize--;
<a name="l04657"></a>04657                               pNewGroup-&gt;pEnemyGroup-&gt;ubNumAdmins++;
<a name="l04658"></a>04658                               pNewGroup-&gt;ubGroupSize++;
<a name="l04659"></a>04659                               ubSoldiersRequested--;
<a name="l04660"></a>04660                               <a class="code" href="Strategic_01AI_8cpp.html#cc36ad74d06a3b8b211a4e06c8528a43">ValidateLargeGroup</a>( pGroup );
<a name="l04661"></a>04661                               <a class="code" href="Strategic_01AI_8cpp.html#cc36ad74d06a3b8b211a4e06c8528a43">ValidateLargeGroup</a>( pNewGroup );
<a name="l04662"></a>04662                         }
<a name="l04663"></a>04663                         <span class="keywordflow">else</span> <span class="keywordflow">if</span>( pGroup-&gt;pEnemyGroup-&gt;ubNumElites )
<a name="l04664"></a>04664                         {
<a name="l04665"></a>04665                               pGroup-&gt;pEnemyGroup-&gt;ubNumElites--;
<a name="l04666"></a>04666                               pGroup-&gt;ubGroupSize--;
<a name="l04667"></a>04667                               pNewGroup-&gt;pEnemyGroup-&gt;ubNumElites++;
<a name="l04668"></a>04668                               pNewGroup-&gt;ubGroupSize++;
<a name="l04669"></a>04669                               ubSoldiersRequested--;
<a name="l04670"></a>04670                               <a class="code" href="Strategic_01AI_8cpp.html#cc36ad74d06a3b8b211a4e06c8528a43">ValidateLargeGroup</a>( pGroup );
<a name="l04671"></a>04671                               <a class="code" href="Strategic_01AI_8cpp.html#cc36ad74d06a3b8b211a4e06c8528a43">ValidateLargeGroup</a>( pNewGroup );
<a name="l04672"></a>04672                         }
<a name="l04673"></a>04673                         <span class="keywordflow">else</span>
<a name="l04674"></a>04674                         {
<a name="l04675"></a>04675                               AssertMsg( 0, <span class="stringliteral">"Strategic AI group transfer error.  KM : 0"</span> );
<a name="l04676"></a>04676                               <span class="keywordflow">return</span>;
<a name="l04677"></a>04677                         }
<a name="l04678"></a>04678                   }
<a name="l04679"></a>04679                   pNewGroup-&gt;ubOriginalSector = (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)SECTOR( ubDstSectorX, ubDstSectorY );
<a name="l04680"></a>04680                   <a class="code" href="AI_01Viewer_8cpp.html#a9f940d7f3a6d6698bfaeb7c747d74a9">gGarrisonGroup</a>[ iGarrisonID ].<a class="code" href="structGARRISON__GROUP.html#ea8325bf63e1d81924fb5fab93b37d8e">ubPendingGroupID</a> = pNewGroup-&gt;ubGroupID;
<a name="l04681"></a>04681                   <a class="code" href="Strategic_01AI_8cpp.html#d11803600200a4f8e0f5d842132fc140">RecalculatePatrolWeight</a>( iBestIndex );
<a name="l04682"></a>04682                   
<a name="l04683"></a>04683                   <a class="code" href="Strategic_01AI_8cpp.html#3865b55f00d5df7710bd4325ddf83bfc">MoveSAIGroupToSector</a>( &amp;pNewGroup, <a class="code" href="AI_01Viewer_8cpp.html#a9f940d7f3a6d6698bfaeb7c747d74a9">gGarrisonGroup</a>[ iGarrisonID ].ubSectorID, <a class="code" href="Strategic_01AI_8cpp.html#2282261c2887b2d4d1183cf5249e1529a4d4adb90ccd2b0775d4429cac476900">EVASIVE</a>, <a class="code" href="Strategic_01Movement_8h.html#b59c1bec446b10af208f977a871d910b095b1f433b659c686164f67bb7b89cb1">REINFORCEMENTS</a> );
<a name="l04684"></a>04684             }
<a name="l04685"></a>04685             <span class="keywordflow">else</span>
<a name="l04686"></a>04686             { <span class="comment">//Send the whole group and kill it's patrol assignment.</span>
<a name="l04687"></a>04687                   <a class="code" href="Strategic_01AI_8cpp.html#9e00ccb0e77cec57208c519e8f831f53">gPatrolGroup</a>[ iBestIndex ].<a class="code" href="structPATROL__GROUP.html#a94d3c610977f7a6fab94b302493d084">ubGroupID</a> = 0;
<a name="l04688"></a>04688                   <a class="code" href="AI_01Viewer_8cpp.html#a9f940d7f3a6d6698bfaeb7c747d74a9">gGarrisonGroup</a>[ iGarrisonID ].<a class="code" href="structGARRISON__GROUP.html#ea8325bf63e1d81924fb5fab93b37d8e">ubPendingGroupID</a> = pGroup-&gt;ubGroupID;
<a name="l04689"></a>04689                   pGroup-&gt;ubOriginalSector = (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)SECTOR( ubDstSectorX, ubDstSectorY );
<a name="l04690"></a>04690                   <a class="code" href="Strategic_01AI_8cpp.html#d11803600200a4f8e0f5d842132fc140">RecalculatePatrolWeight</a>( iBestIndex );
<a name="l04691"></a>04691                   <span class="comment">//The ONLY case where the group is told to move somewhere else when they could be BETWEEN sectors.  The movegroup functions</span>
<a name="l04692"></a>04692                   <span class="comment">//don't work if this is the case.  Teleporting them to their previous sector is the best and easiest way to deal with this.</span>
<a name="l04693"></a>04693                   <a class="code" href="Strategic_01Movement_8cpp.html#a19abf3a81cb603e5721889a627be6af">SetEnemyGroupSector</a>( pGroup, (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)SECTOR( pGroup-&gt;ubSectorX, pGroup-&gt;ubSectorY ) );
<a name="l04694"></a>04694                   
<a name="l04695"></a>04695                   <a class="code" href="Strategic_01AI_8cpp.html#3865b55f00d5df7710bd4325ddf83bfc">MoveSAIGroupToSector</a>( &amp;pGroup, <a class="code" href="AI_01Viewer_8cpp.html#a9f940d7f3a6d6698bfaeb7c747d74a9">gGarrisonGroup</a>[ iGarrisonID ].ubSectorID, <a class="code" href="Strategic_01AI_8cpp.html#2282261c2887b2d4d1183cf5249e1529a4d4adb90ccd2b0775d4429cac476900">EVASIVE</a>, <a class="code" href="Strategic_01Movement_8h.html#b59c1bec446b10af208f977a871d910b095b1f433b659c686164f67bb7b89cb1">REINFORCEMENTS</a> );
<a name="l04696"></a>04696                   <a class="code" href="Strategic_01AI_8cpp.html#3c3091ef7361288e9f4f6a95cb067980">ValidateGroup</a>( pGroup );
<a name="l04697"></a>04697             }
<a name="l04698"></a>04698       }
<a name="l04699"></a>04699       <span class="keywordflow">else</span>
<a name="l04700"></a>04700       { <span class="comment">//There are no groups that have enough troops.  Send a new force from the palace instead.</span>
<a name="l04701"></a>04701             pGroup = <a class="code" href="Strategic_01Movement_8cpp.html#a6ac42d3d57b37a44bc39b3cd55ec008">CreateNewEnemyGroupDepartingFromSector</a>( <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c66026438a2eb9999a6ad7c69c9ddbe2d95696ca">SEC_P3</a>, 0, ubSoldiersRequested, 0 );
<a name="l04702"></a>04702             pGroup-&gt;ubMoveType = <a class="code" href="Strategic_01Movement_8h.html#456ac33d49271d3e2c371351cd1d637147c377372bfc5fcfc2f8a70afb906a04">ONE_WAY</a>;
<a name="l04703"></a>04703             pGroup-&gt;pEnemyGroup-&gt;ubIntention = <a class="code" href="Strategic_01Movement_8h.html#b59c1bec446b10af208f977a871d910b095b1f433b659c686164f67bb7b89cb1">REINFORCEMENTS</a>;
<a name="l04704"></a>04704             <a class="code" href="AI_01Viewer_8cpp.html#a9f940d7f3a6d6698bfaeb7c747d74a9">gGarrisonGroup</a>[ iGarrisonID ].<a class="code" href="structGARRISON__GROUP.html#ea8325bf63e1d81924fb5fab93b37d8e">ubPendingGroupID</a> = pGroup-&gt;ubGroupID;
<a name="l04705"></a>04705             pGroup-&gt;ubOriginalSector = (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)SECTOR( ubDstSectorX, ubDstSectorY );
<a name="l04706"></a>04706 
<a name="l04707"></a>04707             <span class="comment">//Madd: unlimited reinforcements?</span>
<a name="l04708"></a>04708             <span class="keywordflow">if</span> ( !<a class="code" href="Strategic_01AI_8cpp.html#b0c12688f38630da4e064c85394ca570">gfUnlimitedTroops</a> )
<a name="l04709"></a>04709                   <a class="code" href="AI_01Viewer_8cpp.html#c86cd58021961af10f1eb15108a79023">giReinforcementPool</a> -= (<a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a>)ubSoldiersRequested;
<a name="l04710"></a>04710             
<a name="l04711"></a>04711             <a class="code" href="Strategic_01AI_8cpp.html#3865b55f00d5df7710bd4325ddf83bfc">MoveSAIGroupToSector</a>( &amp;pGroup, <a class="code" href="AI_01Viewer_8cpp.html#a9f940d7f3a6d6698bfaeb7c747d74a9">gGarrisonGroup</a>[ iGarrisonID ].ubSectorID, <a class="code" href="Strategic_01AI_8cpp.html#2282261c2887b2d4d1183cf5249e1529a4d4adb90ccd2b0775d4429cac476900">EVASIVE</a>, <a class="code" href="Strategic_01Movement_8h.html#b59c1bec446b10af208f977a871d910b095b1f433b659c686164f67bb7b89cb1">REINFORCEMENTS</a> );
<a name="l04712"></a>04712             <a class="code" href="Strategic_01AI_8cpp.html#3c3091ef7361288e9f4f6a95cb067980">ValidateGroup</a>( pGroup );
<a name="l04713"></a>04713       }
<a name="l04714"></a>04714 }
<a name="l04715"></a>04715 
<a name="l04716"></a><a class="code" href="Strategic_01AI_8h.html#079d19a6a3eb516e60dc98132a6cc5f8">04716</a> <span class="keywordtype">void</span> <a class="code" href="Strategic_01AI_8cpp.html#079d19a6a3eb516e60dc98132a6cc5f8">WakeUpQueen</a>()
<a name="l04717"></a>04717 {
<a name="l04718"></a>04718       <a class="code" href="AI_01Viewer_8cpp.html#38284bd39764812fb8a27fe4d3d2b0cd">gfQueenAIAwake</a> = TRUE;
<a name="l04719"></a>04719       <span class="keywordflow">if</span>( !<a class="code" href="Strategic_01AI_8cpp.html#ace9c47ca01a402ca45743ff70c9d70c">gfMassFortificationOrdered</a> )
<a name="l04720"></a>04720       {
<a name="l04721"></a>04721             <a class="code" href="Strategic_01AI_8cpp.html#ace9c47ca01a402ca45743ff70c9d70c">gfMassFortificationOrdered</a> = TRUE;
<a name="l04722"></a>04722             <a class="code" href="Strategic_01AI_8cpp.html#1da08834def823266558f351d9cbeb45">MassFortifyTowns</a>();
<a name="l04723"></a>04723       }
<a name="l04724"></a>04724 }
<a name="l04725"></a>04725 
<a name="l04726"></a><a class="code" href="Strategic_01AI_8cpp.html#1da08834def823266558f351d9cbeb45">04726</a> <span class="keywordtype">void</span> <a class="code" href="Strategic_01AI_8cpp.html#1da08834def823266558f351d9cbeb45">MassFortifyTowns</a>()
<a name="l04727"></a>04727 {
<a name="l04728"></a>04728       <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a> i;
<a name="l04729"></a>04729       <a class="code" href="structSECTORINFO.html">SECTORINFO</a> *pSector;
<a name="l04730"></a>04730       <a class="code" href="structGROUP.html">GROUP</a> *pGroup;
<a name="l04731"></a>04731       <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubNumTroops, ubDesiredTroops;
<a name="l04732"></a>04732       <span class="keywordflow">for</span>( i = 0; i &lt; giGarrisonArraySize; i++ )
<a name="l04733"></a>04733       {
<a name="l04734"></a>04734             pSector = &amp;<a class="code" href="Campaign_01Types_8h.html#d83c6f699f17a47cf6a662c91d959126">SectorInfo</a>[ <a class="code" href="AI_01Viewer_8cpp.html#a9f940d7f3a6d6698bfaeb7c747d74a9">gGarrisonGroup</a>[ i ].ubSectorID ];
<a name="l04735"></a>04735             ubNumTroops = pSector-&gt;<a class="code" href="structSECTORINFO.html#d7d5ee63c0dc2ad3164c83541bd80906">ubNumAdmins</a> + pSector-&gt;<a class="code" href="structSECTORINFO.html#e36540b93256cfa71e45382f133d3696">ubNumTroops</a> + pSector-&gt;<a class="code" href="structSECTORINFO.html#3c5312672399c40ec5a395e8bcfb0104">ubNumElites</a>;
<a name="l04736"></a>04736             ubDesiredTroops = (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)<a class="code" href="AI_01Viewer_8cpp.html#77e448d1f208bd120f861571e6d0098f">gArmyComp</a>[ <a class="code" href="AI_01Viewer_8cpp.html#a9f940d7f3a6d6698bfaeb7c747d74a9">gGarrisonGroup</a>[ i ].ubComposition ].bDesiredPopulation;
<a name="l04737"></a>04737             <span class="keywordflow">if</span>( ubNumTroops &lt; ubDesiredTroops  )
<a name="l04738"></a>04738             {
<a name="l04739"></a>04739                   <span class="keywordflow">if</span>( !<a class="code" href="AI_01Viewer_8cpp.html#a9f940d7f3a6d6698bfaeb7c747d74a9">gGarrisonGroup</a>[ i ].ubPendingGroupID &amp;&amp; 
<a name="l04740"></a>04740                               <a class="code" href="AI_01Viewer_8cpp.html#a9f940d7f3a6d6698bfaeb7c747d74a9">gGarrisonGroup</a>[ i ].ubComposition != <a class="code" href="Strategic_01AI_8h.html#a9908284c0827729f14cf9b2489e14791d6fc6dded07a09f3dddfd8789f69eb0">ROADBLOCK</a> &amp;&amp;
<a name="l04741"></a>04741                               <a class="code" href="Strategic_01AI_8cpp.html#f8f6673c3fc186e8d92341498a455679">EnemyPermittedToAttackSector</a>( NULL, <a class="code" href="AI_01Viewer_8cpp.html#a9f940d7f3a6d6698bfaeb7c747d74a9">gGarrisonGroup</a>[ i ].ubSectorID ) )
<a name="l04742"></a>04742                   {
<a name="l04743"></a>04743                         <a class="code" href="Strategic_01AI_8cpp.html#2fa0b96eae51a7e2732753424608b833">RequestHighPriorityGarrisonReinforcements</a>( i, (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)(ubDesiredTroops - ubNumTroops) );
<a name="l04744"></a>04744                   }
<a name="l04745"></a>04745             }
<a name="l04746"></a>04746       }
<a name="l04747"></a>04747       <span class="comment">//Convert the garrison sitting in Omerta (if alive), and reassign them</span>
<a name="l04748"></a>04748       pSector = &amp;<a class="code" href="Campaign_01Types_8h.html#d83c6f699f17a47cf6a662c91d959126">SectorInfo</a>[ <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c660264391d2dc0712c8c1f845d2997d13220831">SEC_A9</a> ];
<a name="l04749"></a>04749       <span class="keywordflow">if</span>( pSector-&gt;<a class="code" href="structSECTORINFO.html#e36540b93256cfa71e45382f133d3696">ubNumTroops</a> )
<a name="l04750"></a>04750       {
<a name="l04751"></a>04751             pGroup = <a class="code" href="Strategic_01Movement_8cpp.html#a6ac42d3d57b37a44bc39b3cd55ec008">CreateNewEnemyGroupDepartingFromSector</a>( <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c660264391d2dc0712c8c1f845d2997d13220831">SEC_A9</a>, 0, pSector-&gt;<a class="code" href="structSECTORINFO.html#e36540b93256cfa71e45382f133d3696">ubNumTroops</a>, 0 );
<a name="l04752"></a>04752             Assert( pGroup );
<a name="l04753"></a>04753             pSector-&gt;<a class="code" href="structSECTORINFO.html#e36540b93256cfa71e45382f133d3696">ubNumTroops</a> = 0;
<a name="l04754"></a>04754             pGroup-&gt;<a class="code" href="structGROUP.html#f82ff4c3e504e4bb10feb65491f79471">pEnemyGroup</a>-&gt;<a class="code" href="structENEMYGROUP.html#6d1d418460b3704699f5e058925897e2">ubIntention</a> = <a class="code" href="Strategic_01Movement_8h.html#b59c1bec446b10af208f977a871d910b132923eff5652e6e103b2734f1160e0a">PATROL</a>;
<a name="l04755"></a>04755             pGroup-&gt;<a class="code" href="structGROUP.html#d11970aeea229972cf65f9f169e90451">ubMoveType</a> = <a class="code" href="Strategic_01Movement_8h.html#456ac33d49271d3e2c371351cd1d637147c377372bfc5fcfc2f8a70afb906a04">ONE_WAY</a>;
<a name="l04756"></a>04756             <a class="code" href="Strategic_01AI_8cpp.html#0ecd8a8d61c81aa34eeec15760348ffe">ReassignAIGroup</a>( &amp;pGroup );
<a name="l04757"></a>04757             <a class="code" href="Strategic_01AI_8cpp.html#3c3091ef7361288e9f4f6a95cb067980">ValidateGroup</a>( pGroup );
<a name="l04758"></a>04758             <a class="code" href="Strategic_01AI_8cpp.html#2ac233d8185907c372e75f5f48e56673">RecalculateSectorWeight</a>( <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c660264391d2dc0712c8c1f845d2997d13220831">SEC_A9</a> );
<a name="l04759"></a>04759       }
<a name="l04760"></a>04760 }
<a name="l04761"></a>04761 
<a name="l04762"></a><a class="code" href="Strategic_01AI_8cpp.html#3ad707626ec95cab456926ce1188bef1">04762</a> <span class="keywordtype">void</span> <a class="code" href="Strategic_01AI_8cpp.html#3ad707626ec95cab456926ce1188bef1">RenderAIViewerGarrisonInfo</a>( <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a> <a class="code" href="Sound_01Control_8cpp.html#6150e0515f7202e2fb518f7206ed97dc">x</a>, <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a> y, <a class="code" href="structSECTORINFO.html">SECTORINFO</a> *pSector )
<a name="l04763"></a>04763 {
<a name="l04764"></a>04764       <span class="keywordflow">if</span>( pSector-&gt;<a class="code" href="structSECTORINFO.html#9465931dad0e164d7d47814b66e454f0">ubGarrisonID</a> != NO_GARRISON )
<a name="l04765"></a>04765       {
<a name="l04766"></a>04766             <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a> iDesired, iSurplus;
<a name="l04767"></a>04767             iDesired = <a class="code" href="AI_01Viewer_8cpp.html#77e448d1f208bd120f861571e6d0098f">gArmyComp</a>[ <a class="code" href="AI_01Viewer_8cpp.html#a9f940d7f3a6d6698bfaeb7c747d74a9">gGarrisonGroup</a>[ pSector-&gt;<a class="code" href="structSECTORINFO.html#9465931dad0e164d7d47814b66e454f0">ubGarrisonID</a> ].<a class="code" href="structGARRISON__GROUP.html#a8feee88c982ca594b5bb1fcd2971ea5">ubComposition</a> ].<a class="code" href="structARMY__COMPOSITION.html#164db6c6c30629f43d42469671367c86">bDesiredPopulation</a>;
<a name="l04768"></a>04768             iSurplus = pSector-&gt;<a class="code" href="structSECTORINFO.html#e36540b93256cfa71e45382f133d3696">ubNumTroops</a> + pSector-&gt;<a class="code" href="structSECTORINFO.html#d7d5ee63c0dc2ad3164c83541bd80906">ubNumAdmins</a> + pSector-&gt;<a class="code" href="structSECTORINFO.html#3c5312672399c40ec5a395e8bcfb0104">ubNumElites</a> - iDesired;
<a name="l04769"></a>04769             <a class="code" href="Font_8cpp.html#388be5810478c3f3bdb861f144085d70">SetFontForeground</a>( FONT_WHITE );
<a name="l04770"></a>04770             <span class="keywordflow">if</span>( iSurplus &gt;= 0 )
<a name="l04771"></a>04771             {
<a name="l04772"></a>04772                   <a class="code" href="Font_8cpp.html#b3e12cf19a0ca58abf6689cc8eca3ead">mprintf</a>( x, y, L<span class="stringliteral">"%d desired, %d surplus troops"</span>, iDesired, iSurplus );
<a name="l04773"></a>04773             }
<a name="l04774"></a>04774             <span class="keywordflow">else</span>
<a name="l04775"></a>04775             {
<a name="l04776"></a>04776                   <a class="code" href="Font_8cpp.html#b3e12cf19a0ca58abf6689cc8eca3ead">mprintf</a>( x, y, L<span class="stringliteral">"%d desired, %d reinforcements requested"</span>, iDesired, -iSurplus );
<a name="l04777"></a>04777             }
<a name="l04778"></a>04778             <span class="keywordflow">if</span>( <a class="code" href="AI_01Viewer_8cpp.html#a9f940d7f3a6d6698bfaeb7c747d74a9">gGarrisonGroup</a>[ pSector-&gt;<a class="code" href="structSECTORINFO.html#9465931dad0e164d7d47814b66e454f0">ubGarrisonID</a> ].ubPendingGroupID )
<a name="l04779"></a>04779             {
<a name="l04780"></a>04780                   <a class="code" href="structGROUP.html">GROUP</a> *pGroup;
<a name="l04781"></a>04781                   pGroup = <a class="code" href="Strategic_01Movement_8cpp.html#33138746a238bdc5c684e9aa2c86691c">GetGroup</a>( <a class="code" href="AI_01Viewer_8cpp.html#a9f940d7f3a6d6698bfaeb7c747d74a9">gGarrisonGroup</a>[ pSector-&gt;<a class="code" href="structSECTORINFO.html#9465931dad0e164d7d47814b66e454f0">ubGarrisonID</a> ].ubPendingGroupID );
<a name="l04782"></a>04782                   <a class="code" href="Font_8cpp.html#b3e12cf19a0ca58abf6689cc8eca3ead">mprintf</a>( x, y+10, L<span class="stringliteral">"%d reinforcements on route from group %d in %c%d"</span>, pGroup-&gt;<a class="code" href="structGROUP.html#2a98517c894019ee794e04ea05d1aeaf">ubGroupSize</a>, pGroup-&gt;<a class="code" href="structGROUP.html#9149379b9355afda87a382af5a88d728">ubGroupID</a>, 
<a name="l04783"></a>04783                         pGroup-&gt;<a class="code" href="structGROUP.html#11cd63715d9daf1488cca330690db007">ubSectorY</a> + <span class="charliteral">'A'</span> - 1, pGroup-&gt;<a class="code" href="structGROUP.html#eee29372e834112984eab1dc714466c0">ubSectorX</a> );
<a name="l04784"></a>04784             }
<a name="l04785"></a>04785             <span class="keywordflow">else</span>
<a name="l04786"></a>04786             {
<a name="l04787"></a>04787                   <a class="code" href="Font_8cpp.html#b3e12cf19a0ca58abf6689cc8eca3ead">mprintf</a>( x, y+10, L<span class="stringliteral">"No pending reinforcements for this sector."</span> );
<a name="l04788"></a>04788             }
<a name="l04789"></a>04789       }
<a name="l04790"></a>04790       <span class="keywordflow">else</span>
<a name="l04791"></a>04791       {
<a name="l04792"></a>04792             <a class="code" href="Font_8cpp.html#388be5810478c3f3bdb861f144085d70">SetFontForeground</a>( FONT_GRAY2 );
<a name="l04793"></a>04793             <a class="code" href="Font_8cpp.html#b3e12cf19a0ca58abf6689cc8eca3ead">mprintf</a>( x, y, L<span class="stringliteral">"No garrison information for this sector."</span> );
<a name="l04794"></a>04794       }
<a name="l04795"></a>04795 }
<a name="l04796"></a>04796 
<a name="l04797"></a><a class="code" href="Strategic_01AI_8h.html#a417b057ad87186b6e2528d9fe035aaa">04797</a> <span class="keywordtype">void</span> <a class="code" href="Strategic_01AI_8cpp.html#a417b057ad87186b6e2528d9fe035aaa">StrategicHandleMineThatRanOut</a>( <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubSectorID )
<a name="l04798"></a>04798 {
<a name="l04799"></a>04799       <span class="keywordflow">switch</span>( ubSectorID )
<a name="l04800"></a>04800       {
<a name="l04801"></a>04801             <span class="keywordflow">case</span> <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643a9584a4fb3b1d601490ee1f4703cdab2">SEC_B2</a>:
<a name="l04802"></a>04802                   <a class="code" href="AI_01Viewer_8cpp.html#77e448d1f208bd120f861571e6d0098f">gArmyComp</a>[ <a class="code" href="AI_01Viewer_8cpp.html#a9f940d7f3a6d6698bfaeb7c747d74a9">gGarrisonGroup</a>[ <a class="code" href="Campaign_01Types_8h.html#d83c6f699f17a47cf6a662c91d959126">SectorInfo</a>[ <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643ddb3565a81ff778bd1d7d0720e7beb1f">SEC_A2</a> ].<a class="code" href="structSECTORINFO.html#9465931dad0e164d7d47814b66e454f0">ubGarrisonID</a> ].<a class="code" href="structGARRISON__GROUP.html#a8feee88c982ca594b5bb1fcd2971ea5">ubComposition</a> ].<a class="code" href="structARMY__COMPOSITION.html#ae9820933dc13e0351dbd9fe1daf8ab4">bPriority</a> /= 4;
<a name="l04803"></a>04803                   <a class="code" href="AI_01Viewer_8cpp.html#77e448d1f208bd120f861571e6d0098f">gArmyComp</a>[ <a class="code" href="AI_01Viewer_8cpp.html#a9f940d7f3a6d6698bfaeb7c747d74a9">gGarrisonGroup</a>[ <a class="code" href="Campaign_01Types_8h.html#d83c6f699f17a47cf6a662c91d959126">SectorInfo</a>[ <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643a9584a4fb3b1d601490ee1f4703cdab2">SEC_B2</a> ].<a class="code" href="structSECTORINFO.html#9465931dad0e164d7d47814b66e454f0">ubGarrisonID</a> ].<a class="code" href="structGARRISON__GROUP.html#a8feee88c982ca594b5bb1fcd2971ea5">ubComposition</a> ].<a class="code" href="structARMY__COMPOSITION.html#ae9820933dc13e0351dbd9fe1daf8ab4">bPriority</a> /= 4;
<a name="l04804"></a>04804                   <span class="keywordflow">break</span>;
<a name="l04805"></a>04805             <span class="keywordflow">case</span> <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c66026435b0fbd8598540769dcf8f24e3134f48c">SEC_D13</a>:
<a name="l04806"></a>04806                   <a class="code" href="AI_01Viewer_8cpp.html#77e448d1f208bd120f861571e6d0098f">gArmyComp</a>[ <a class="code" href="AI_01Viewer_8cpp.html#a9f940d7f3a6d6698bfaeb7c747d74a9">gGarrisonGroup</a>[ <a class="code" href="Campaign_01Types_8h.html#d83c6f699f17a47cf6a662c91d959126">SectorInfo</a>[ <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c66026436d911e0461303edb9fe227735f787c22">SEC_B13</a> ].<a class="code" href="structSECTORINFO.html#9465931dad0e164d7d47814b66e454f0">ubGarrisonID</a> ].<a class="code" href="structGARRISON__GROUP.html#a8feee88c982ca594b5bb1fcd2971ea5">ubComposition</a> ].<a class="code" href="structARMY__COMPOSITION.html#ae9820933dc13e0351dbd9fe1daf8ab4">bPriority</a> /= 4;
<a name="l04807"></a>04807                   <a class="code" href="AI_01Viewer_8cpp.html#77e448d1f208bd120f861571e6d0098f">gArmyComp</a>[ <a class="code" href="AI_01Viewer_8cpp.html#a9f940d7f3a6d6698bfaeb7c747d74a9">gGarrisonGroup</a>[ <a class="code" href="Campaign_01Types_8h.html#d83c6f699f17a47cf6a662c91d959126">SectorInfo</a>[ <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643e84863fb1442cf38c7311021990a9bc3">SEC_C13</a> ].<a class="code" href="structSECTORINFO.html#9465931dad0e164d7d47814b66e454f0">ubGarrisonID</a> ].<a class="code" href="structGARRISON__GROUP.html#a8feee88c982ca594b5bb1fcd2971ea5">ubComposition</a> ].<a class="code" href="structARMY__COMPOSITION.html#ae9820933dc13e0351dbd9fe1daf8ab4">bPriority</a> /= 4;
<a name="l04808"></a>04808                   <a class="code" href="AI_01Viewer_8cpp.html#77e448d1f208bd120f861571e6d0098f">gArmyComp</a>[ <a class="code" href="AI_01Viewer_8cpp.html#a9f940d7f3a6d6698bfaeb7c747d74a9">gGarrisonGroup</a>[ <a class="code" href="Campaign_01Types_8h.html#d83c6f699f17a47cf6a662c91d959126">SectorInfo</a>[ <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c66026435b0fbd8598540769dcf8f24e3134f48c">SEC_D13</a> ].<a class="code" href="structSECTORINFO.html#9465931dad0e164d7d47814b66e454f0">ubGarrisonID</a> ].<a class="code" href="structGARRISON__GROUP.html#a8feee88c982ca594b5bb1fcd2971ea5">ubComposition</a> ].<a class="code" href="structARMY__COMPOSITION.html#ae9820933dc13e0351dbd9fe1daf8ab4">bPriority</a> /= 4;
<a name="l04809"></a>04809                   <span class="keywordflow">break</span>;
<a name="l04810"></a>04810             <span class="keywordflow">case</span> <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643897f1cfaae4b38d8022feec3521887df">SEC_H8</a>:
<a name="l04811"></a>04811                   <a class="code" href="AI_01Viewer_8cpp.html#77e448d1f208bd120f861571e6d0098f">gArmyComp</a>[ <a class="code" href="AI_01Viewer_8cpp.html#a9f940d7f3a6d6698bfaeb7c747d74a9">gGarrisonGroup</a>[ <a class="code" href="Campaign_01Types_8h.html#d83c6f699f17a47cf6a662c91d959126">SectorInfo</a>[ <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643e0a7185e05270b8ffacff9816031ae8e">SEC_F8</a> ].<a class="code" href="structSECTORINFO.html#9465931dad0e164d7d47814b66e454f0">ubGarrisonID</a> ].<a class="code" href="structGARRISON__GROUP.html#a8feee88c982ca594b5bb1fcd2971ea5">ubComposition</a> ].<a class="code" href="structARMY__COMPOSITION.html#ae9820933dc13e0351dbd9fe1daf8ab4">bPriority</a> /= 4;
<a name="l04812"></a>04812                   <a class="code" href="AI_01Viewer_8cpp.html#77e448d1f208bd120f861571e6d0098f">gArmyComp</a>[ <a class="code" href="AI_01Viewer_8cpp.html#a9f940d7f3a6d6698bfaeb7c747d74a9">gGarrisonGroup</a>[ <a class="code" href="Campaign_01Types_8h.html#d83c6f699f17a47cf6a662c91d959126">SectorInfo</a>[ <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643a20fa3a3e3da7996c9d5fab6d2fb6e84">SEC_F9</a> ].<a class="code" href="structSECTORINFO.html#9465931dad0e164d7d47814b66e454f0">ubGarrisonID</a> ].<a class="code" href="structGARRISON__GROUP.html#a8feee88c982ca594b5bb1fcd2971ea5">ubComposition</a> ].<a class="code" href="structARMY__COMPOSITION.html#ae9820933dc13e0351dbd9fe1daf8ab4">bPriority</a> /= 4;
<a name="l04813"></a>04813                   <a class="code" href="AI_01Viewer_8cpp.html#77e448d1f208bd120f861571e6d0098f">gArmyComp</a>[ <a class="code" href="AI_01Viewer_8cpp.html#a9f940d7f3a6d6698bfaeb7c747d74a9">gGarrisonGroup</a>[ <a class="code" href="Campaign_01Types_8h.html#d83c6f699f17a47cf6a662c91d959126">SectorInfo</a>[ <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643d037ec147301d1498cd5ea0307da2d34">SEC_G8</a> ].<a class="code" href="structSECTORINFO.html#9465931dad0e164d7d47814b66e454f0">ubGarrisonID</a> ].<a class="code" href="structGARRISON__GROUP.html#a8feee88c982ca594b5bb1fcd2971ea5">ubComposition</a> ].<a class="code" href="structARMY__COMPOSITION.html#ae9820933dc13e0351dbd9fe1daf8ab4">bPriority</a> /= 4;
<a name="l04814"></a>04814                   <a class="code" href="AI_01Viewer_8cpp.html#77e448d1f208bd120f861571e6d0098f">gArmyComp</a>[ <a class="code" href="AI_01Viewer_8cpp.html#a9f940d7f3a6d6698bfaeb7c747d74a9">gGarrisonGroup</a>[ <a class="code" href="Campaign_01Types_8h.html#d83c6f699f17a47cf6a662c91d959126">SectorInfo</a>[ <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643fa4b17f23c10d54767184540803edce8">SEC_G9</a> ].<a class="code" href="structSECTORINFO.html#9465931dad0e164d7d47814b66e454f0">ubGarrisonID</a> ].<a class="code" href="structGARRISON__GROUP.html#a8feee88c982ca594b5bb1fcd2971ea5">ubComposition</a> ].<a class="code" href="structARMY__COMPOSITION.html#ae9820933dc13e0351dbd9fe1daf8ab4">bPriority</a> /= 4;
<a name="l04815"></a>04815                   <a class="code" href="AI_01Viewer_8cpp.html#77e448d1f208bd120f861571e6d0098f">gArmyComp</a>[ <a class="code" href="AI_01Viewer_8cpp.html#a9f940d7f3a6d6698bfaeb7c747d74a9">gGarrisonGroup</a>[ <a class="code" href="Campaign_01Types_8h.html#d83c6f699f17a47cf6a662c91d959126">SectorInfo</a>[ <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643897f1cfaae4b38d8022feec3521887df">SEC_H8</a> ].<a class="code" href="structSECTORINFO.html#9465931dad0e164d7d47814b66e454f0">ubGarrisonID</a> ].<a class="code" href="structGARRISON__GROUP.html#a8feee88c982ca594b5bb1fcd2971ea5">ubComposition</a> ].<a class="code" href="structARMY__COMPOSITION.html#ae9820933dc13e0351dbd9fe1daf8ab4">bPriority</a> /= 4;
<a name="l04816"></a>04816                   <span class="keywordflow">break</span>;
<a name="l04817"></a>04817             <span class="keywordflow">case</span> <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643c236a562a9b38d2ee3c7d7ed06e88faf">SEC_I14</a>:
<a name="l04818"></a>04818                   <a class="code" href="AI_01Viewer_8cpp.html#77e448d1f208bd120f861571e6d0098f">gArmyComp</a>[ <a class="code" href="AI_01Viewer_8cpp.html#a9f940d7f3a6d6698bfaeb7c747d74a9">gGarrisonGroup</a>[ <a class="code" href="Campaign_01Types_8h.html#d83c6f699f17a47cf6a662c91d959126">SectorInfo</a>[ <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c66026438001804c2db19d8207f0a9c3831c1641">SEC_H13</a> ].<a class="code" href="structSECTORINFO.html#9465931dad0e164d7d47814b66e454f0">ubGarrisonID</a> ].<a class="code" href="structGARRISON__GROUP.html#a8feee88c982ca594b5bb1fcd2971ea5">ubComposition</a> ].<a class="code" href="structARMY__COMPOSITION.html#ae9820933dc13e0351dbd9fe1daf8ab4">bPriority</a> /= 4;
<a name="l04819"></a>04819                   <a class="code" href="AI_01Viewer_8cpp.html#77e448d1f208bd120f861571e6d0098f">gArmyComp</a>[ <a class="code" href="AI_01Viewer_8cpp.html#a9f940d7f3a6d6698bfaeb7c747d74a9">gGarrisonGroup</a>[ <a class="code" href="Campaign_01Types_8h.html#d83c6f699f17a47cf6a662c91d959126">SectorInfo</a>[ <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c660264366323a5525ca3cd54932950695c8568f">SEC_H14</a> ].<a class="code" href="structSECTORINFO.html#9465931dad0e164d7d47814b66e454f0">ubGarrisonID</a> ].<a class="code" href="structGARRISON__GROUP.html#a8feee88c982ca594b5bb1fcd2971ea5">ubComposition</a> ].<a class="code" href="structARMY__COMPOSITION.html#ae9820933dc13e0351dbd9fe1daf8ab4">bPriority</a> /= 4;
<a name="l04820"></a>04820                   <a class="code" href="AI_01Viewer_8cpp.html#77e448d1f208bd120f861571e6d0098f">gArmyComp</a>[ <a class="code" href="AI_01Viewer_8cpp.html#a9f940d7f3a6d6698bfaeb7c747d74a9">gGarrisonGroup</a>[ <a class="code" href="Campaign_01Types_8h.html#d83c6f699f17a47cf6a662c91d959126">SectorInfo</a>[ <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c66026434c49cae4ea3baeedd77443968a3166c0">SEC_I13</a> ].<a class="code" href="structSECTORINFO.html#9465931dad0e164d7d47814b66e454f0">ubGarrisonID</a> ].<a class="code" href="structGARRISON__GROUP.html#a8feee88c982ca594b5bb1fcd2971ea5">ubComposition</a> ].<a class="code" href="structARMY__COMPOSITION.html#ae9820933dc13e0351dbd9fe1daf8ab4">bPriority</a> /= 4;
<a name="l04821"></a>04821                   <a class="code" href="AI_01Viewer_8cpp.html#77e448d1f208bd120f861571e6d0098f">gArmyComp</a>[ <a class="code" href="AI_01Viewer_8cpp.html#a9f940d7f3a6d6698bfaeb7c747d74a9">gGarrisonGroup</a>[ <a class="code" href="Campaign_01Types_8h.html#d83c6f699f17a47cf6a662c91d959126">SectorInfo</a>[ <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c6602643c236a562a9b38d2ee3c7d7ed06e88faf">SEC_I14</a> ].<a class="code" href="structSECTORINFO.html#9465931dad0e164d7d47814b66e454f0">ubGarrisonID</a> ].<a class="code" href="structGARRISON__GROUP.html#a8feee88c982ca594b5bb1fcd2971ea5">ubComposition</a> ].<a class="code" href="structARMY__COMPOSITION.html#ae9820933dc13e0351dbd9fe1daf8ab4">bPriority</a> /= 4;
<a name="l04822"></a>04822                   <span class="keywordflow">break</span>;
<a name="l04823"></a>04823       }
<a name="l04824"></a>04824 }
<a name="l04825"></a>04825 
<a name="l04826"></a><a class="code" href="Strategic_01AI_8cpp.html#54faeb29802e301239709cc407576cd1">04826</a> <a class="code" href="Types_8h.html#112e3146cb38b6ee95e64d85842e380a">BOOLEAN</a> <a class="code" href="Strategic_01AI_8cpp.html#54faeb29802e301239709cc407576cd1">GarrisonCanProvideMinimumReinforcements</a>( <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a> iGarrisonID )
<a name="l04827"></a>04827 {
<a name="l04828"></a>04828       <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a> iAvailable;
<a name="l04829"></a>04829       <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a> iDesired;
<a name="l04830"></a>04830       <a class="code" href="structSECTORINFO.html">SECTORINFO</a> *pSector;
<a name="l04831"></a>04831       <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubSectorX, ubSectorY;
<a name="l04832"></a>04832 
<a name="l04833"></a>04833       pSector = &amp;<a class="code" href="Campaign_01Types_8h.html#d83c6f699f17a47cf6a662c91d959126">SectorInfo</a>[ <a class="code" href="AI_01Viewer_8cpp.html#a9f940d7f3a6d6698bfaeb7c747d74a9">gGarrisonGroup</a>[ iGarrisonID ].<a class="code" href="structGARRISON__GROUP.html#fb130d3c9211374d87a85cca787fe0dd">ubSectorID</a> ];
<a name="l04834"></a>04834 
<a name="l04835"></a>04835       iAvailable = pSector-&gt;<a class="code" href="structSECTORINFO.html#d7d5ee63c0dc2ad3164c83541bd80906">ubNumAdmins</a> + pSector-&gt;<a class="code" href="structSECTORINFO.html#e36540b93256cfa71e45382f133d3696">ubNumTroops</a> + pSector-&gt;<a class="code" href="structSECTORINFO.html#3c5312672399c40ec5a395e8bcfb0104">ubNumElites</a>;
<a name="l04836"></a>04836       iDesired = <a class="code" href="AI_01Viewer_8cpp.html#77e448d1f208bd120f861571e6d0098f">gArmyComp</a>[ gGarrisonGroup[ iGarrisonID ].ubComposition ].<a class="code" href="structARMY__COMPOSITION.html#164db6c6c30629f43d42469671367c86">bDesiredPopulation</a>;
<a name="l04837"></a>04837 
<a name="l04838"></a>04838       <span class="keywordflow">if</span>( iAvailable - iDesired &gt;= <a class="code" href="Strategic_01AI_8cpp.html#12b5525b1f3dabeac40700eecd3219e7">gubMinEnemyGroupSize</a> )
<a name="l04839"></a>04839       {
<a name="l04840"></a>04840             <span class="comment">//Do a more expensive check first to determine if there is a player presence here (combat in progress)</span>
<a name="l04841"></a>04841             <span class="comment">//If so, do not provide reinforcements from here.</span>
<a name="l04842"></a>04842             ubSectorX = (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)SECTORX( gGarrisonGroup[ iGarrisonID ].ubSectorID );
<a name="l04843"></a>04843             ubSectorY = (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)SECTORY( gGarrisonGroup[ iGarrisonID ].ubSectorID );
<a name="l04844"></a>04844             <span class="keywordflow">if</span>( <a class="code" href="Strategic_01Movement_8cpp.html#39531a1493c62a63a373c7e8125ca7f7">PlayerMercsInSector</a>( ubSectorX, ubSectorY, 0 ) || <a class="code" href="Town_01Militia_8cpp.html#d5f4d1a7e2d1489b786239270acbdda1">CountAllMilitiaInSector</a>( ubSectorX, ubSectorY ) )
<a name="l04845"></a>04845             {
<a name="l04846"></a>04846                   <span class="keywordflow">return</span> FALSE;
<a name="l04847"></a>04847             }
<a name="l04848"></a>04848             <span class="keywordflow">return</span> TRUE;
<a name="l04849"></a>04849       }
<a name="l04850"></a>04850       <span class="keywordflow">return</span> FALSE;
<a name="l04851"></a>04851 }
<a name="l04852"></a>04852 
<a name="l04853"></a><a class="code" href="Strategic_01AI_8cpp.html#acc69c670c9bac13b5e41484b4648552">04853</a> <a class="code" href="Types_8h.html#112e3146cb38b6ee95e64d85842e380a">BOOLEAN</a> <a class="code" href="Strategic_01AI_8cpp.html#acc69c670c9bac13b5e41484b4648552">GarrisonRequestingMinimumReinforcements</a>( <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a> iGarrisonID )
<a name="l04854"></a>04854 {
<a name="l04855"></a>04855       <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a> iAvailable;
<a name="l04856"></a>04856       <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a> iDesired;
<a name="l04857"></a>04857       <a class="code" href="structSECTORINFO.html">SECTORINFO</a> *pSector;
<a name="l04858"></a>04858 
<a name="l04859"></a>04859       <span class="keywordflow">if</span>( <a class="code" href="AI_01Viewer_8cpp.html#a9f940d7f3a6d6698bfaeb7c747d74a9">gGarrisonGroup</a>[ iGarrisonID ].ubPendingGroupID )
<a name="l04860"></a>04860       {
<a name="l04861"></a>04861             <span class="keywordflow">return</span> FALSE;
<a name="l04862"></a>04862       }
<a name="l04863"></a>04863 
<a name="l04864"></a>04864       pSector = &amp;<a class="code" href="Campaign_01Types_8h.html#d83c6f699f17a47cf6a662c91d959126">SectorInfo</a>[ <a class="code" href="AI_01Viewer_8cpp.html#a9f940d7f3a6d6698bfaeb7c747d74a9">gGarrisonGroup</a>[ iGarrisonID ].<a class="code" href="structGARRISON__GROUP.html#fb130d3c9211374d87a85cca787fe0dd">ubSectorID</a> ];
<a name="l04865"></a>04865       iAvailable = pSector-&gt;<a class="code" href="structSECTORINFO.html#d7d5ee63c0dc2ad3164c83541bd80906">ubNumAdmins</a> + pSector-&gt;<a class="code" href="structSECTORINFO.html#e36540b93256cfa71e45382f133d3696">ubNumTroops</a> + pSector-&gt;<a class="code" href="structSECTORINFO.html#3c5312672399c40ec5a395e8bcfb0104">ubNumElites</a>;
<a name="l04866"></a>04866       iDesired = <a class="code" href="AI_01Viewer_8cpp.html#77e448d1f208bd120f861571e6d0098f">gArmyComp</a>[ gGarrisonGroup[ iGarrisonID ].ubComposition ].<a class="code" href="structARMY__COMPOSITION.html#164db6c6c30629f43d42469671367c86">bDesiredPopulation</a>;
<a name="l04867"></a>04867 
<a name="l04868"></a>04868       <span class="keywordflow">if</span>( iDesired - iAvailable &gt;= <a class="code" href="Strategic_01AI_8cpp.html#12b5525b1f3dabeac40700eecd3219e7">gubMinEnemyGroupSize</a> )
<a name="l04869"></a>04869       {
<a name="l04870"></a>04870             <span class="keywordflow">return</span> TRUE;
<a name="l04871"></a>04871       }
<a name="l04872"></a>04872       <span class="keywordflow">return</span> FALSE;
<a name="l04873"></a>04873 }
<a name="l04874"></a>04874 
<a name="l04875"></a><a class="code" href="Strategic_01AI_8cpp.html#6e02787740c45d04fbbd7ca50ca23064">04875</a> <a class="code" href="Types_8h.html#112e3146cb38b6ee95e64d85842e380a">BOOLEAN</a> <a class="code" href="Strategic_01AI_8cpp.html#6e02787740c45d04fbbd7ca50ca23064">PatrolRequestingMinimumReinforcements</a>( <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a> iPatrolID )
<a name="l04876"></a>04876 {
<a name="l04877"></a>04877       <a class="code" href="structGROUP.html">GROUP</a> *pGroup;
<a name="l04878"></a>04878 
<a name="l04879"></a>04879       <span class="keywordflow">if</span>( <a class="code" href="Strategic_01AI_8cpp.html#9e00ccb0e77cec57208c519e8f831f53">gPatrolGroup</a>[ iPatrolID ].ubPendingGroupID )
<a name="l04880"></a>04880       {
<a name="l04881"></a>04881             <span class="keywordflow">return</span> FALSE;
<a name="l04882"></a>04882       }
<a name="l04883"></a>04883       <span class="keywordflow">if</span>( !<a class="code" href="Strategic_01AI_8cpp.html#3ce548a65fa1537749a3a8871d4bb143">PermittedToFillPatrolGroup</a>( iPatrolID ) )
<a name="l04884"></a>04884       { <span class="comment">//if the group was defeated, it won't be considered for reinforcements again for several days</span>
<a name="l04885"></a>04885             <span class="keywordflow">return</span> FALSE;
<a name="l04886"></a>04886       }
<a name="l04887"></a>04887       pGroup = <a class="code" href="Strategic_01Movement_8cpp.html#33138746a238bdc5c684e9aa2c86691c">GetGroup</a>( <a class="code" href="Strategic_01AI_8cpp.html#9e00ccb0e77cec57208c519e8f831f53">gPatrolGroup</a>[ iPatrolID ].ubGroupID );
<a name="l04888"></a>04888       <span class="keywordflow">if</span>( pGroup )
<a name="l04889"></a>04889       {
<a name="l04890"></a>04890             <span class="keywordflow">if</span>( <a class="code" href="Strategic_01AI_8cpp.html#9e00ccb0e77cec57208c519e8f831f53">gPatrolGroup</a>[ iPatrolID ].bSize - pGroup-&gt;<a class="code" href="structGROUP.html#2a98517c894019ee794e04ea05d1aeaf">ubGroupSize</a> &gt;= <a class="code" href="Strategic_01AI_8cpp.html#12b5525b1f3dabeac40700eecd3219e7">gubMinEnemyGroupSize</a> )
<a name="l04891"></a>04891             {
<a name="l04892"></a>04892                   <span class="keywordflow">return</span> TRUE;
<a name="l04893"></a>04893             }
<a name="l04894"></a>04894       }
<a name="l04895"></a>04895       <span class="keywordflow">return</span> FALSE;
<a name="l04896"></a>04896 }
<a name="l04897"></a>04897 
<a name="l04898"></a>04898 
<a name="l04899"></a><a class="code" href="Strategic_01AI_8cpp.html#989554da82194ffa19f0648cb09a26c4">04899</a> <span class="keywordtype">void</span> <a class="code" href="Strategic_01AI_8cpp.html#989554da82194ffa19f0648cb09a26c4">EliminateSurplusTroopsForGarrison</a>( <a class="code" href="structGROUP.html">GROUP</a> *pGroup, <a class="code" href="structSECTORINFO.html">SECTORINFO</a> *pSector )
<a name="l04900"></a>04900 {
<a name="l04901"></a>04901       <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a> iTotal;
<a name="l04902"></a>04902       <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a> iMaxEnemyGroupSize = <a class="code" href="GameSettings_8cpp.html#5c32f930e2fef384505c4b91803a92c2">gGameExternalOptions</a>.<a class="code" href="structGAME__EXTERNAL__OPTIONS.html#e0dd958b9c8219730a767a875dda20d5">iMaxEnemyGroupSize</a>;
<a name="l04903"></a>04903 DebugMsg (<a class="code" href="DEBUG_8cpp.html#a7985c2fd033797fc67a03b2c26e07c6">TOPIC_JA2</a>,DBG_LEVEL_3,<span class="stringliteral">"Strategic8"</span>);
<a name="l04904"></a>04904 
<a name="l04905"></a>04905       iTotal = pGroup-&gt;<a class="code" href="structGROUP.html#f82ff4c3e504e4bb10feb65491f79471">pEnemyGroup</a>-&gt;<a class="code" href="structENEMYGROUP.html#27eaaea857408bc6c6358054c19f2d07">ubNumTroops</a> + pGroup-&gt;<a class="code" href="structGROUP.html#f82ff4c3e504e4bb10feb65491f79471">pEnemyGroup</a>-&gt;<a class="code" href="structENEMYGROUP.html#5f20a703a3c536505126979265b10558">ubNumElites</a> + pGroup-&gt;<a class="code" href="structGROUP.html#f82ff4c3e504e4bb10feb65491f79471">pEnemyGroup</a>-&gt;<a class="code" href="structENEMYGROUP.html#61d6f824f39709580afa7a81317e241b">ubNumAdmins</a> +
<a name="l04906"></a>04906                                pSector-&gt;<a class="code" href="structSECTORINFO.html#e36540b93256cfa71e45382f133d3696">ubNumTroops</a> + pSector-&gt;<a class="code" href="structSECTORINFO.html#3c5312672399c40ec5a395e8bcfb0104">ubNumElites</a> + pSector-&gt;<a class="code" href="structSECTORINFO.html#d7d5ee63c0dc2ad3164c83541bd80906">ubNumAdmins</a>;
<a name="l04907"></a>04907       <span class="keywordflow">if</span>( iTotal &lt;= iMaxEnemyGroupSize )
<a name="l04908"></a>04908       {
<a name="l04909"></a>04909             <span class="keywordflow">return</span>;
<a name="l04910"></a>04910       }
<a name="l04911"></a>04911       iTotal -= iMaxEnemyGroupSize;
<a name="l04912"></a>04912       <span class="keywordflow">while</span>( iTotal )
<a name="l04913"></a>04913       {
<a name="l04914"></a>04914             <span class="keywordflow">if</span>( pGroup-&gt;<a class="code" href="structGROUP.html#f82ff4c3e504e4bb10feb65491f79471">pEnemyGroup</a>-&gt;<a class="code" href="structENEMYGROUP.html#61d6f824f39709580afa7a81317e241b">ubNumAdmins</a> )
<a name="l04915"></a>04915             {
<a name="l04916"></a>04916                   <span class="keywordflow">if</span>( pGroup-&gt;<a class="code" href="structGROUP.html#f82ff4c3e504e4bb10feb65491f79471">pEnemyGroup</a>-&gt;<a class="code" href="structENEMYGROUP.html#61d6f824f39709580afa7a81317e241b">ubNumAdmins</a> &lt; iTotal )
<a name="l04917"></a>04917                   {
<a name="l04918"></a>04918                         iTotal -= pGroup-&gt;<a class="code" href="structGROUP.html#f82ff4c3e504e4bb10feb65491f79471">pEnemyGroup</a>-&gt;<a class="code" href="structENEMYGROUP.html#61d6f824f39709580afa7a81317e241b">ubNumAdmins</a>;
<a name="l04919"></a>04919                         pGroup-&gt;<a class="code" href="structGROUP.html#f82ff4c3e504e4bb10feb65491f79471">pEnemyGroup</a>-&gt;<a class="code" href="structENEMYGROUP.html#61d6f824f39709580afa7a81317e241b">ubNumAdmins</a> = 0;
<a name="l04920"></a>04920                   }
<a name="l04921"></a>04921                   <span class="keywordflow">else</span>
<a name="l04922"></a>04922                   {
<a name="l04923"></a>04923                         pGroup-&gt;<a class="code" href="structGROUP.html#f82ff4c3e504e4bb10feb65491f79471">pEnemyGroup</a>-&gt;<a class="code" href="structENEMYGROUP.html#61d6f824f39709580afa7a81317e241b">ubNumAdmins</a> -= (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)iTotal;
<a name="l04924"></a>04924                         iTotal = 0;
<a name="l04925"></a>04925                   }
<a name="l04926"></a>04926             }
<a name="l04927"></a>04927             <span class="keywordflow">else</span> <span class="keywordflow">if</span>( pSector-&gt;<a class="code" href="structSECTORINFO.html#d7d5ee63c0dc2ad3164c83541bd80906">ubNumAdmins</a> )
<a name="l04928"></a>04928             {
<a name="l04929"></a>04929                   <span class="keywordflow">if</span>( pSector-&gt;<a class="code" href="structSECTORINFO.html#d7d5ee63c0dc2ad3164c83541bd80906">ubNumAdmins</a> &lt; iTotal )
<a name="l04930"></a>04930                   {
<a name="l04931"></a>04931                         iTotal -= pSector-&gt;<a class="code" href="structSECTORINFO.html#d7d5ee63c0dc2ad3164c83541bd80906">ubNumAdmins</a>;
<a name="l04932"></a>04932                         pSector-&gt;<a class="code" href="structSECTORINFO.html#d7d5ee63c0dc2ad3164c83541bd80906">ubNumAdmins</a> = 0;
<a name="l04933"></a>04933                   }
<a name="l04934"></a>04934                   <span class="keywordflow">else</span>
<a name="l04935"></a>04935                   {           
<a name="l04936"></a>04936                         pSector-&gt;<a class="code" href="structSECTORINFO.html#d7d5ee63c0dc2ad3164c83541bd80906">ubNumAdmins</a> -= (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)iTotal;
<a name="l04937"></a>04937                         iTotal = 0;
<a name="l04938"></a>04938                   }
<a name="l04939"></a>04939             }
<a name="l04940"></a>04940             <span class="keywordflow">else</span> <span class="keywordflow">if</span>( pGroup-&gt;<a class="code" href="structGROUP.html#f82ff4c3e504e4bb10feb65491f79471">pEnemyGroup</a>-&gt;<a class="code" href="structENEMYGROUP.html#27eaaea857408bc6c6358054c19f2d07">ubNumTroops</a> )
<a name="l04941"></a>04941             {
<a name="l04942"></a>04942                   <span class="keywordflow">if</span>( pGroup-&gt;<a class="code" href="structGROUP.html#f82ff4c3e504e4bb10feb65491f79471">pEnemyGroup</a>-&gt;<a class="code" href="structENEMYGROUP.html#27eaaea857408bc6c6358054c19f2d07">ubNumTroops</a> &lt; iTotal )
<a name="l04943"></a>04943                   {
<a name="l04944"></a>04944                         iTotal -= pGroup-&gt;<a class="code" href="structGROUP.html#f82ff4c3e504e4bb10feb65491f79471">pEnemyGroup</a>-&gt;<a class="code" href="structENEMYGROUP.html#27eaaea857408bc6c6358054c19f2d07">ubNumTroops</a>;
<a name="l04945"></a>04945                         pGroup-&gt;<a class="code" href="structGROUP.html#f82ff4c3e504e4bb10feb65491f79471">pEnemyGroup</a>-&gt;<a class="code" href="structENEMYGROUP.html#27eaaea857408bc6c6358054c19f2d07">ubNumTroops</a> = 0;
<a name="l04946"></a>04946                   }
<a name="l04947"></a>04947                   <span class="keywordflow">else</span>
<a name="l04948"></a>04948                   {
<a name="l04949"></a>04949                         pGroup-&gt;<a class="code" href="structGROUP.html#f82ff4c3e504e4bb10feb65491f79471">pEnemyGroup</a>-&gt;<a class="code" href="structENEMYGROUP.html#27eaaea857408bc6c6358054c19f2d07">ubNumTroops</a> -= (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)iTotal;
<a name="l04950"></a>04950                         iTotal = 0;
<a name="l04951"></a>04951                   }
<a name="l04952"></a>04952             }
<a name="l04953"></a>04953             <span class="keywordflow">else</span> <span class="keywordflow">if</span>( pSector-&gt;<a class="code" href="structSECTORINFO.html#e36540b93256cfa71e45382f133d3696">ubNumTroops</a> )
<a name="l04954"></a>04954             {
<a name="l04955"></a>04955                   <span class="keywordflow">if</span>( pSector-&gt;<a class="code" href="structSECTORINFO.html#e36540b93256cfa71e45382f133d3696">ubNumTroops</a> &lt; iTotal )
<a name="l04956"></a>04956                   {
<a name="l04957"></a>04957                         iTotal -= pSector-&gt;<a class="code" href="structSECTORINFO.html#e36540b93256cfa71e45382f133d3696">ubNumTroops</a>;
<a name="l04958"></a>04958                         pSector-&gt;<a class="code" href="structSECTORINFO.html#e36540b93256cfa71e45382f133d3696">ubNumTroops</a> = 0;
<a name="l04959"></a>04959                   }
<a name="l04960"></a>04960                   <span class="keywordflow">else</span>
<a name="l04961"></a>04961                   {           
<a name="l04962"></a>04962                         pSector-&gt;<a class="code" href="structSECTORINFO.html#e36540b93256cfa71e45382f133d3696">ubNumTroops</a> -= (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)iTotal;
<a name="l04963"></a>04963                         iTotal = 0;
<a name="l04964"></a>04964                   }
<a name="l04965"></a>04965             }
<a name="l04966"></a>04966             <span class="keywordflow">else</span> <span class="keywordflow">if</span>( pGroup-&gt;<a class="code" href="structGROUP.html#f82ff4c3e504e4bb10feb65491f79471">pEnemyGroup</a>-&gt;<a class="code" href="structENEMYGROUP.html#5f20a703a3c536505126979265b10558">ubNumElites</a> )
<a name="l04967"></a>04967             {
<a name="l04968"></a>04968                   <span class="keywordflow">if</span>( pGroup-&gt;<a class="code" href="structGROUP.html#f82ff4c3e504e4bb10feb65491f79471">pEnemyGroup</a>-&gt;<a class="code" href="structENEMYGROUP.html#5f20a703a3c536505126979265b10558">ubNumElites</a> &lt; iTotal )
<a name="l04969"></a>04969                   {
<a name="l04970"></a>04970                         iTotal -= pGroup-&gt;<a class="code" href="structGROUP.html#f82ff4c3e504e4bb10feb65491f79471">pEnemyGroup</a>-&gt;<a class="code" href="structENEMYGROUP.html#5f20a703a3c536505126979265b10558">ubNumElites</a>;
<a name="l04971"></a>04971                         pGroup-&gt;<a class="code" href="structGROUP.html#f82ff4c3e504e4bb10feb65491f79471">pEnemyGroup</a>-&gt;<a class="code" href="structENEMYGROUP.html#5f20a703a3c536505126979265b10558">ubNumElites</a> = 0;
<a name="l04972"></a>04972                   }
<a name="l04973"></a>04973                   <span class="keywordflow">else</span>
<a name="l04974"></a>04974                   {
<a name="l04975"></a>04975                         pGroup-&gt;<a class="code" href="structGROUP.html#f82ff4c3e504e4bb10feb65491f79471">pEnemyGroup</a>-&gt;<a class="code" href="structENEMYGROUP.html#5f20a703a3c536505126979265b10558">ubNumElites</a> -= (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)iTotal;
<a name="l04976"></a>04976                         iTotal = 0;
<a name="l04977"></a>04977                   }
<a name="l04978"></a>04978             }
<a name="l04979"></a>04979             <span class="keywordflow">else</span> <span class="keywordflow">if</span>( pSector-&gt;<a class="code" href="structSECTORINFO.html#3c5312672399c40ec5a395e8bcfb0104">ubNumElites</a> )
<a name="l04980"></a>04980             {
<a name="l04981"></a>04981                   <span class="keywordflow">if</span>( pSector-&gt;<a class="code" href="structSECTORINFO.html#3c5312672399c40ec5a395e8bcfb0104">ubNumElites</a> &lt; iTotal )
<a name="l04982"></a>04982                   {
<a name="l04983"></a>04983                         iTotal -= pSector-&gt;<a class="code" href="structSECTORINFO.html#3c5312672399c40ec5a395e8bcfb0104">ubNumElites</a>;
<a name="l04984"></a>04984                         pSector-&gt;<a class="code" href="structSECTORINFO.html#3c5312672399c40ec5a395e8bcfb0104">ubNumElites</a> = 0;
<a name="l04985"></a>04985                   }
<a name="l04986"></a>04986                   <span class="keywordflow">else</span>
<a name="l04987"></a>04987                   {           
<a name="l04988"></a>04988                         pSector-&gt;<a class="code" href="structSECTORINFO.html#3c5312672399c40ec5a395e8bcfb0104">ubNumElites</a> -= (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)iTotal;
<a name="l04989"></a>04989                         iTotal = 0;
<a name="l04990"></a>04990                   }
<a name="l04991"></a>04991             }
<a name="l04992"></a>04992       }
<a name="l04993"></a>04993 }
<a name="l04994"></a>04994 
<a name="l04995"></a>04995 
<a name="l04996"></a>04996 
<a name="l04997"></a>04997 <span class="comment">// once Queen is awake, she'll gradually begin replacing admins with regular troops.  This is mainly to keep player from</span>
<a name="l04998"></a>04998 <span class="comment">// fighting many more admins once they are no longer any challenge for him.  Eventually all admins will vanish off map.</span>
<a name="l04999"></a><a class="code" href="Strategic_01AI_8cpp.html#5ce042820a296b25287965de76aa9e9b">04999</a> <span class="keywordtype">void</span> <a class="code" href="Strategic_01AI_8cpp.html#5ce042820a296b25287965de76aa9e9b">UpgradeAdminsToTroops</a>()
<a name="l05000"></a>05000 {
<a name="l05001"></a>05001       <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a> i;
<a name="l05002"></a>05002       <a class="code" href="structSECTORINFO.html">SECTORINFO</a> *pSector;
<a name="l05003"></a>05003       <a class="code" href="Types_8h.html#7ebe70ceca856797319175e30bcf003d">INT8</a> bPriority;
<a name="l05004"></a>05004       <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubAdminsToCheck;
<a name="l05005"></a>05005       <a class="code" href="structGROUP.html">GROUP</a> *pGroup;
<a name="l05006"></a>05006       <a class="code" href="Types_8h.html#30f500129d8c688af07726d5d34ce52d">INT16</a> sPatrolIndex;
<a name="l05007"></a>05007 
<a name="l05008"></a>05008 
<a name="l05009"></a>05009       <span class="comment">// on normal, AI evaluates approximately every 10 hrs.  There are about 130 administrators seeded on the map.</span>
<a name="l05010"></a>05010       <span class="comment">// Some of these will be killed by the player.</span>
<a name="l05011"></a>05011 
<a name="l05012"></a>05012       <span class="comment">// check all garrisons for administrators</span>
<a name="l05013"></a>05013       <span class="keywordflow">for</span>( i = 0; i &lt; giGarrisonArraySize; i++ )
<a name="l05014"></a>05014       {
<a name="l05015"></a>05015             <span class="comment">// skip sector if it's currently loaded, we'll never upgrade guys in those</span>
<a name="l05016"></a>05016             <span class="keywordflow">if</span> ( SECTOR( <a class="code" href="strategicmap_8cpp.html#49d9aed144a633fda4ba1990f002d703">gWorldSectorX</a>, <a class="code" href="strategicmap_8cpp.html#ea322310ced0e35ee18a2ee7b32aac5b">gWorldSectorY</a> ) == <a class="code" href="AI_01Viewer_8cpp.html#a9f940d7f3a6d6698bfaeb7c747d74a9">gGarrisonGroup</a>[ i ].ubSectorID )
<a name="l05017"></a>05017             {
<a name="l05018"></a>05018                   <span class="keywordflow">continue</span>;
<a name="l05019"></a>05019             }
<a name="l05020"></a>05020 
<a name="l05021"></a>05021             pSector = &amp;<a class="code" href="Campaign_01Types_8h.html#d83c6f699f17a47cf6a662c91d959126">SectorInfo</a>[ <a class="code" href="AI_01Viewer_8cpp.html#a9f940d7f3a6d6698bfaeb7c747d74a9">gGarrisonGroup</a>[ i ].<a class="code" href="structGARRISON__GROUP.html#fb130d3c9211374d87a85cca787fe0dd">ubSectorID</a> ];
<a name="l05022"></a>05022 
<a name="l05023"></a>05023             <span class="comment">// if there are any admins currently in this garrison</span>
<a name="l05024"></a>05024             <span class="keywordflow">if</span> ( pSector-&gt;<a class="code" href="structSECTORINFO.html#d7d5ee63c0dc2ad3164c83541bd80906">ubNumAdmins</a> &gt; 0 )
<a name="l05025"></a>05025             {
<a name="l05026"></a>05026                   bPriority = <a class="code" href="AI_01Viewer_8cpp.html#77e448d1f208bd120f861571e6d0098f">gArmyComp</a>[ gGarrisonGroup[ i ].ubComposition ].<a class="code" href="structARMY__COMPOSITION.html#ae9820933dc13e0351dbd9fe1daf8ab4">bPriority</a>;
<a name="l05027"></a>05027             
<a name="l05028"></a>05028                   <span class="comment">// highest priority sectors are upgraded first. Each 1% of progress lower the </span>
<a name="l05029"></a>05029                   <span class="comment">// priority threshold required to start triggering upgrades by 10%.</span>
<a name="l05030"></a>05030                   <a class="code" href="Soldier_01Ani_8cpp.html#c294aa65f0375eb6343a2de2a25dafcc">if</a> ( ( 100 - ( 10 * <a class="code" href="Campaign_8cpp.html#c301f0385a7e0d276efe888024738b09">HighestPlayerProgressPercentage</a>() ) ) &lt; bPriority )
<a name="l05031"></a>05031                   {
<a name="l05032"></a>05032                         ubAdminsToCheck = pSector-&gt;<a class="code" href="structSECTORINFO.html#d7d5ee63c0dc2ad3164c83541bd80906">ubNumAdmins</a>;
<a name="l05033"></a>05033 
<a name="l05034"></a>05034                         while ( ubAdminsToCheck &gt; 0)
<a name="l05035"></a>05035                         {
<a name="l05036"></a>05036                               <span class="comment">// chance to upgrade at each check is random, and also dependant on the garrison's priority</span>
<a name="l05037"></a>05037                               <span class="keywordflow">if</span> ( <a class="code" href="Random_8cpp.html#742221657b584d8416ada22fa8ff23dd">Chance</a> ( bPriority ) || <a class="code" href="GameSettings_8cpp.html#f9f2d5fd368ccadcc26bebc202d52ae7">gGameOptions</a>.<a class="code" href="structGAME__OPTIONS.html#4fb44167906152722f6af5cc9f7c1a99">ubDifficultyLevel</a> &gt; <a class="code" href="GameSettings_8h.html#c205be2172292384dd687b5471a87edd3d0b73026f1c7122798d578613aa4575">DIF_LEVEL_HARD</a> ) <span class="comment">// Madd: Always happens on Insane</span>
<a name="l05038"></a>05038                               {
<a name="l05039"></a>05039                                     pSector-&gt;<a class="code" href="structSECTORINFO.html#d7d5ee63c0dc2ad3164c83541bd80906">ubNumAdmins</a>--;
<a name="l05040"></a>05040                                     pSector-&gt;<a class="code" href="structSECTORINFO.html#e36540b93256cfa71e45382f133d3696">ubNumTroops</a>++;
<a name="l05041"></a>05041                               }
<a name="l05042"></a>05042 
<a name="l05043"></a>05043                               ubAdminsToCheck--;
<a name="l05044"></a>05044                         }
<a name="l05045"></a>05045                   }
<a name="l05046"></a>05046             }
<a name="l05047"></a>05047       }
<a name="l05048"></a>05048 
<a name="l05049"></a>05049 
<a name="l05050"></a>05050       <span class="comment">// check all moving enemy groups for administrators</span>
<a name="l05051"></a>05051       pGroup = <a class="code" href="Strategic_01Movement_8cpp.html#eb63397419934df48a7149753dff164e">gpGroupList</a>;
<a name="l05052"></a>05052       <span class="keywordflow">while</span>( pGroup )
<a name="l05053"></a>05053       {
<a name="l05054"></a>05054             <span class="keywordflow">if</span>( pGroup-&gt;ubGroupSize &amp;&amp; !pGroup-&gt;fPlayer &amp;&amp; !pGroup-&gt;fVehicle)
<a name="l05055"></a>05055             {
<a name="l05056"></a>05056                   Assert ( pGroup-&gt;pEnemyGroup );
<a name="l05057"></a>05057 
<a name="l05058"></a>05058                   <span class="comment">// skip sector if it's currently loaded, we'll never upgrade guys in those</span>
<a name="l05059"></a>05059                   <a class="code" href="Soldier_01Ani_8cpp.html#c294aa65f0375eb6343a2de2a25dafcc">if</a> ( ( pGroup-&gt;ubSectorX == <a class="code" href="strategicmap_8cpp.html#49d9aed144a633fda4ba1990f002d703">gWorldSectorX</a> ) &amp;&amp; ( pGroup-&gt;ubSectorY == <a class="code" href="strategicmap_8cpp.html#ea322310ced0e35ee18a2ee7b32aac5b">gWorldSectorY</a> ) )
<a name="l05060"></a>05060                   {
<a name="l05061"></a>05061                         pGroup = pGroup-&gt;next;
<a name="l05062"></a>05062                         <span class="keywordflow">continue</span>;
<a name="l05063"></a>05063                   }
<a name="l05064"></a>05064 
<a name="l05065"></a>05065                   <span class="comment">// if there are any admins currently in this group</span>
<a name="l05066"></a>05066                   <span class="keywordflow">if</span> ( pGroup-&gt;pEnemyGroup-&gt;ubNumAdmins &gt; 0 )
<a name="l05067"></a>05067                   {
<a name="l05068"></a>05068                         <span class="comment">// if it's a patrol group</span>
<a name="l05069"></a>05069                         <a class="code" href="Soldier_01Ani_8cpp.html#c294aa65f0375eb6343a2de2a25dafcc">if</a> ( pGroup-&gt;pEnemyGroup-&gt;ubIntention == <a class="code" href="Strategic_01Movement_8h.html#b59c1bec446b10af208f977a871d910b132923eff5652e6e103b2734f1160e0a">PATROL</a> )
<a name="l05070"></a>05070                         {
<a name="l05071"></a>05071                               sPatrolIndex = <a class="code" href="Strategic_01AI_8cpp.html#ec4412ba6a1b889020e3869d14b4d65b">FindPatrolGroupIndexForGroupID</a>( pGroup-&gt;ubGroupID );
<a name="l05072"></a>05072                               Assert( sPatrolIndex != -1 );
<a name="l05073"></a>05073 
<a name="l05074"></a>05074                               <span class="comment">// use that patrol's priority</span>
<a name="l05075"></a>05075                               bPriority = <a class="code" href="Strategic_01AI_8cpp.html#9e00ccb0e77cec57208c519e8f831f53">gPatrolGroup</a>[ sPatrolIndex ].<a class="code" href="structPATROL__GROUP.html#93640ff8c9775890352727ed0053b6bd">bPriority</a>;
<a name="l05076"></a>05076                         }
<a name="l05077"></a>05077                         <span class="keywordflow">else</span>  <span class="comment">// not a patrol group</span>
<a name="l05078"></a>05078                         {
<a name="l05079"></a>05079                               <span class="comment">// use a default priority</span>
<a name="l05080"></a>05080                               bPriority = 50;
<a name="l05081"></a>05081                         }
<a name="l05082"></a>05082 
<a name="l05083"></a>05083                         <span class="comment">// highest priority groups are upgraded first. Each 1% of progress lower the </span>
<a name="l05084"></a>05084                         <span class="comment">// priority threshold required to start triggering upgrades by 10%.</span>
<a name="l05085"></a>05085                         <span class="keywordflow">if</span> ( ( 100 - ( 10 * <a class="code" href="Campaign_8cpp.html#c301f0385a7e0d276efe888024738b09">HighestPlayerProgressPercentage</a>() ) ) &lt; bPriority )
<a name="l05086"></a>05086                         {
<a name="l05087"></a>05087                               ubAdminsToCheck = pGroup-&gt;pEnemyGroup-&gt;ubNumAdmins;
<a name="l05088"></a>05088 
<a name="l05089"></a>05089                               while ( ubAdminsToCheck &gt; 0)
<a name="l05090"></a>05090                               {
<a name="l05091"></a>05091                                     <span class="comment">// chance to upgrade at each check is random, and also dependant on the group's priority</span>
<a name="l05092"></a>05092                                     <span class="keywordflow">if</span> ( <a class="code" href="Random_8cpp.html#742221657b584d8416ada22fa8ff23dd">Chance</a> ( bPriority ) || <a class="code" href="GameSettings_8cpp.html#f9f2d5fd368ccadcc26bebc202d52ae7">gGameOptions</a>.<a class="code" href="structGAME__OPTIONS.html#4fb44167906152722f6af5cc9f7c1a99">ubDifficultyLevel</a> &gt;= <a class="code" href="GameSettings_8h.html#c205be2172292384dd687b5471a87edd3d0b73026f1c7122798d578613aa4575">DIF_LEVEL_HARD</a> )<span class="comment">// Madd: Always happens on Expert and Insane</span>
<a name="l05093"></a>05093                                     {
<a name="l05094"></a>05094                                           pGroup-&gt;pEnemyGroup-&gt;ubNumAdmins--;
<a name="l05095"></a>05095                                           pGroup-&gt;pEnemyGroup-&gt;ubNumTroops++;
<a name="l05096"></a>05096                                     }
<a name="l05097"></a>05097 
<a name="l05098"></a>05098                                     ubAdminsToCheck--;
<a name="l05099"></a>05099                               }
<a name="l05100"></a>05100                         }
<a name="l05101"></a>05101                   }
<a name="l05102"></a>05102             }
<a name="l05103"></a>05103       
<a name="l05104"></a>05104             pGroup = pGroup-&gt;next;
<a name="l05105"></a>05105       }
<a name="l05106"></a>05106 }
<a name="l05107"></a>05107 
<a name="l05108"></a>05108 
<a name="l05109"></a><a class="code" href="Strategic_01AI_8h.html#ec4412ba6a1b889020e3869d14b4d65b">05109</a> <a class="code" href="Types_8h.html#30f500129d8c688af07726d5d34ce52d">INT16</a> <a class="code" href="Strategic_01AI_8cpp.html#ec4412ba6a1b889020e3869d14b4d65b">FindPatrolGroupIndexForGroupID</a>( <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubGroupID )
<a name="l05110"></a>05110 {
<a name="l05111"></a>05111       <a class="code" href="Types_8h.html#30f500129d8c688af07726d5d34ce52d">INT16</a> sPatrolIndex;
<a name="l05112"></a>05112 
<a name="l05113"></a>05113       <span class="keywordflow">for</span>( sPatrolIndex = 0; sPatrolIndex &lt; giPatrolArraySize; sPatrolIndex++ )
<a name="l05114"></a>05114       {
<a name="l05115"></a>05115             <span class="keywordflow">if</span> ( <a class="code" href="Strategic_01AI_8cpp.html#9e00ccb0e77cec57208c519e8f831f53">gPatrolGroup</a>[ sPatrolIndex ].ubGroupID == ubGroupID )
<a name="l05116"></a>05116             {
<a name="l05117"></a>05117                   <span class="comment">// found it</span>
<a name="l05118"></a>05118                   <span class="keywordflow">return</span>( sPatrolIndex );
<a name="l05119"></a>05119             }
<a name="l05120"></a>05120       }
<a name="l05121"></a>05121 
<a name="l05122"></a>05122       <span class="comment">// not there!</span>
<a name="l05123"></a>05123       <span class="keywordflow">return</span>( -1 );
<a name="l05124"></a>05124 }
<a name="l05125"></a>05125 
<a name="l05126"></a>05126 
<a name="l05127"></a><a class="code" href="Strategic_01AI_8h.html#763e6f1495b77369545b14364d90c1ad">05127</a> <a class="code" href="Types_8h.html#30f500129d8c688af07726d5d34ce52d">INT16</a> <a class="code" href="Strategic_01AI_8cpp.html#763e6f1495b77369545b14364d90c1ad">FindPatrolGroupIndexForGroupIDPending</a>( <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubGroupID )
<a name="l05128"></a>05128 {
<a name="l05129"></a>05129       <a class="code" href="Types_8h.html#30f500129d8c688af07726d5d34ce52d">INT16</a> sPatrolIndex;
<a name="l05130"></a>05130 
<a name="l05131"></a>05131       <span class="keywordflow">for</span>( sPatrolIndex = 0; sPatrolIndex &lt; giPatrolArraySize; sPatrolIndex++ )
<a name="l05132"></a>05132       {
<a name="l05133"></a>05133             <span class="keywordflow">if</span> ( <a class="code" href="Strategic_01AI_8cpp.html#9e00ccb0e77cec57208c519e8f831f53">gPatrolGroup</a>[ sPatrolIndex ].ubPendingGroupID == ubGroupID )
<a name="l05134"></a>05134             {
<a name="l05135"></a>05135                   <span class="comment">// found it</span>
<a name="l05136"></a>05136                   <span class="keywordflow">return</span>( sPatrolIndex );
<a name="l05137"></a>05137             }
<a name="l05138"></a>05138       }
<a name="l05139"></a>05139 
<a name="l05140"></a>05140       <span class="comment">// not there!</span>
<a name="l05141"></a>05141       <span class="keywordflow">return</span>( -1 );
<a name="l05142"></a>05142 }
<a name="l05143"></a>05143 
<a name="l05144"></a>05144 
<a name="l05145"></a><a class="code" href="Strategic_01AI_8h.html#8f98ee346a45cde5f42b5bbce61f28bc">05145</a> <a class="code" href="Types_8h.html#30f500129d8c688af07726d5d34ce52d">INT16</a> <a class="code" href="Strategic_01AI_8cpp.html#8f98ee346a45cde5f42b5bbce61f28bc">FindGarrisonIndexForGroupIDPending</a>( <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubGroupID )
<a name="l05146"></a>05146 {
<a name="l05147"></a>05147       <a class="code" href="Types_8h.html#30f500129d8c688af07726d5d34ce52d">INT16</a> sGarrisonIndex;
<a name="l05148"></a>05148 
<a name="l05149"></a>05149       <span class="keywordflow">for</span>( sGarrisonIndex = 0; sGarrisonIndex &lt; giGarrisonArraySize; sGarrisonIndex++ )
<a name="l05150"></a>05150       {
<a name="l05151"></a>05151             <span class="keywordflow">if</span> ( <a class="code" href="AI_01Viewer_8cpp.html#a9f940d7f3a6d6698bfaeb7c747d74a9">gGarrisonGroup</a>[ sGarrisonIndex ].ubPendingGroupID == ubGroupID )
<a name="l05152"></a>05152             {
<a name="l05153"></a>05153                   <span class="comment">// found it</span>
<a name="l05154"></a>05154                   <span class="keywordflow">return</span>( sGarrisonIndex );
<a name="l05155"></a>05155             }
<a name="l05156"></a>05156       }
<a name="l05157"></a>05157 
<a name="l05158"></a>05158       <span class="comment">// not there!</span>
<a name="l05159"></a>05159       <span class="keywordflow">return</span>( -1 );
<a name="l05160"></a>05160 }
<a name="l05161"></a>05161 
<a name="l05162"></a><a class="code" href="Strategic_01AI_8cpp.html#aedf834c1be3774f0024f959b4847210">05162</a> <span class="keywordtype">void</span> <a class="code" href="Strategic_01AI_8cpp.html#aedf834c1be3774f0024f959b4847210">TransferGroupToPool</a>( <a class="code" href="structGROUP.html">GROUP</a> **pGroup )
<a name="l05163"></a>05163 {
<a name="l05164"></a>05164       <span class="comment">//Madd: unlimited reinforcements?</span>
<a name="l05165"></a>05165       <span class="keywordflow">if</span> ( !<a class="code" href="Strategic_01AI_8cpp.html#b0c12688f38630da4e064c85394ca570">gfUnlimitedTroops</a> )
<a name="l05166"></a>05166             <a class="code" href="AI_01Viewer_8cpp.html#c86cd58021961af10f1eb15108a79023">giReinforcementPool</a> += (*pGroup)-&gt;ubGroupSize;
<a name="l05167"></a>05167       
<a name="l05168"></a>05168       <a class="code" href="Strategic_01Movement_8cpp.html#4c74797932f53c0eeed849a864ba4522">RemovePGroup</a>( *pGroup );
<a name="l05169"></a>05169       *pGroup = NULL;
<a name="l05170"></a>05170 }
<a name="l05171"></a>05171 
<a name="l05172"></a>05172 <span class="comment">//NOTE:  Make sure you call SetEnemyGroupSector() first if the group is between sectors!!  See example in ReassignAIGroup()...</span>
<a name="l05173"></a><a class="code" href="Strategic_01AI_8cpp.html#3af587307171a6bbdd4a76889ae15a3a">05173</a> <span class="keywordtype">void</span> <a class="code" href="Strategic_01AI_8cpp.html#3af587307171a6bbdd4a76889ae15a3a">SendGroupToPool</a>( <a class="code" href="structGROUP.html">GROUP</a> **pGroup )
<a name="l05174"></a>05174 {
<a name="l05175"></a>05175       <span class="keywordflow">if</span>( (*pGroup)-&gt;ubSectorX == 3 &amp;&amp; (*pGroup)-&gt;ubSectorY == 16 )
<a name="l05176"></a>05176       {
<a name="l05177"></a>05177             <a class="code" href="Strategic_01AI_8cpp.html#aedf834c1be3774f0024f959b4847210">TransferGroupToPool</a>( pGroup );
<a name="l05178"></a>05178       }
<a name="l05179"></a>05179       <span class="keywordflow">else</span>
<a name="l05180"></a>05180       {
<a name="l05181"></a>05181             (*pGroup)-&gt;ubSectorIDOfLastReassignment = (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)SECTOR( (*pGroup)-&gt;ubSectorX, (*pGroup)-&gt;ubSectorY );
<a name="l05182"></a>05182             <a class="code" href="Strategic_01AI_8cpp.html#3865b55f00d5df7710bd4325ddf83bfc">MoveSAIGroupToSector</a>( pGroup, <a class="code" href="Campaign_01Types_8h.html#38436632403fcee6aacb5b18c66026438a2eb9999a6ad7c69c9ddbe2d95696ca">SEC_P3</a>, <a class="code" href="Strategic_01AI_8cpp.html#2282261c2887b2d4d1183cf5249e1529a4d4adb90ccd2b0775d4429cac476900">EVASIVE</a>, <a class="code" href="Strategic_01Movement_8h.html#b59c1bec446b10af208f977a871d910b095b1f433b659c686164f67bb7b89cb1">REINFORCEMENTS</a> );
<a name="l05183"></a>05183       }
<a name="l05184"></a>05184 }
<a name="l05185"></a>05185 
<a name="l05186"></a><a class="code" href="Strategic_01AI_8cpp.html#0ecd8a8d61c81aa34eeec15760348ffe">05186</a> <span class="keywordtype">void</span> <a class="code" href="Strategic_01AI_8cpp.html#0ecd8a8d61c81aa34eeec15760348ffe">ReassignAIGroup</a>( <a class="code" href="structGROUP.html">GROUP</a> **pGroup )
<a name="l05187"></a>05187 {
<a name="l05188"></a>05188       <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a> i, iRandom;
<a name="l05189"></a>05189       <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a> iWeight;
<a name="l05190"></a>05190       <a class="code" href="Types_8h.html#09f1a1fb2293e33483cc8d44aefb1eb1">UINT16</a> usDefencePoints;
<a name="l05191"></a>05191       <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a> iReloopLastIndex = -1;
<a name="l05192"></a>05192       <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubSectorID;
<a name="l05193"></a>05193 
<a name="l05194"></a>05194       ubSectorID = (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)SECTOR( (*pGroup)-&gt;ubSectorX, (*pGroup)-&gt;ubSectorY );
<a name="l05195"></a>05195 
<a name="l05196"></a>05196       (*pGroup)-&gt;ubSectorIDOfLastReassignment = ubSectorID;
<a name="l05197"></a>05197 
<a name="l05198"></a>05198       <a class="code" href="Auto_01Resolve_8cpp.html#bf99843dcb604b6d631665205f1a3d42">ClearPreviousAIGroupAssignment</a>( *pGroup );
<a name="l05199"></a>05199 
<a name="l05200"></a>05200       <span class="comment">//First thing to do, is teleport the group to be AT the sector he is currently moving from.  Otherwise, the </span>
<a name="l05201"></a>05201       <span class="comment">//strategic pathing can break if the group is between sectors upon reassignment.</span>
<a name="l05202"></a>05202       <a class="code" href="Strategic_01Movement_8cpp.html#a19abf3a81cb603e5721889a627be6af">SetEnemyGroupSector</a>( *pGroup, ubSectorID );
<a name="l05203"></a>05203 
<a name="l05204"></a>05204       <span class="keywordflow">if</span>( <a class="code" href="AI_01Viewer_8cpp.html#c3390da297cb8068458f459fe9fc094f">giRequestPoints</a> &lt;= 0  )
<a name="l05205"></a>05205       { <span class="comment">//we have no request for reinforcements, so send the group to Meduna for reassignment in the pool.</span>
<a name="l05206"></a>05206             <a class="code" href="Strategic_01AI_8cpp.html#3af587307171a6bbdd4a76889ae15a3a">SendGroupToPool</a>( pGroup );
<a name="l05207"></a>05207             <span class="keywordflow">return</span>;
<a name="l05208"></a>05208       }
<a name="l05209"></a>05209 
<a name="l05210"></a>05210       <span class="comment">//now randomly choose who gets the reinforcements.</span>
<a name="l05211"></a>05211       <span class="comment">// giRequestPoints is the combined sum of all the individual weights of all garrisons and patrols requesting reinforcements</span>
<a name="l05212"></a>05212       iRandom = <a class="code" href="Random_8cpp.html#49f938d1313ab6ef09ac6223a16ac334">Random</a>( <a class="code" href="AI_01Viewer_8cpp.html#c3390da297cb8068458f459fe9fc094f">giRequestPoints</a> );
<a name="l05213"></a>05213 
<a name="l05214"></a>05214       <span class="comment">//go through garrisons first and begin considering where the random value dictates.  If that garrison doesn't require </span>
<a name="l05215"></a>05215       <span class="comment">//reinforcements, it'll continue on considering all subsequent garrisons till the end of the array.  If it fails at that</span>
<a name="l05216"></a>05216       <span class="comment">//point, it'll restart the loop at zero, and consider all garrisons to the index that was first considered by the random value.</span>
<a name="l05217"></a>05217       <span class="keywordflow">for</span>( i = 0; i &lt; giGarrisonArraySize; i++ )
<a name="l05218"></a>05218       {
<a name="l05219"></a>05219             <a class="code" href="Strategic_01AI_8cpp.html#c9af29ba59f70cabda683c1d3e7de1d0">RecalculateGarrisonWeight</a>( i );
<a name="l05220"></a>05220             iWeight = <a class="code" href="AI_01Viewer_8cpp.html#a9f940d7f3a6d6698bfaeb7c747d74a9">gGarrisonGroup</a>[ i ].<a class="code" href="structGARRISON__GROUP.html#54fcf91b97b56e3cc75ef302b34ecf48">bWeight</a>;
<a name="l05221"></a>05221             <span class="keywordflow">if</span>( iWeight &gt; 0 )
<a name="l05222"></a>05222             {     <span class="comment">//if group is requesting reinforcements.</span>
<a name="l05223"></a>05223                   <span class="keywordflow">if</span>( iRandom &lt; iWeight )
<a name="l05224"></a>05224                   {
<a name="l05225"></a>05225                         <span class="keywordflow">if</span>( !<a class="code" href="AI_01Viewer_8cpp.html#a9f940d7f3a6d6698bfaeb7c747d74a9">gGarrisonGroup</a>[ i ].ubPendingGroupID &amp;&amp; 
<a name="l05226"></a>05226                                     <a class="code" href="Strategic_01AI_8cpp.html#f8f6673c3fc186e8d92341498a455679">EnemyPermittedToAttackSector</a>( NULL, <a class="code" href="AI_01Viewer_8cpp.html#a9f940d7f3a6d6698bfaeb7c747d74a9">gGarrisonGroup</a>[ i ].ubSectorID ) &amp;&amp;
<a name="l05227"></a>05227                                     <a class="code" href="Strategic_01AI_8cpp.html#acc69c670c9bac13b5e41484b4648552">GarrisonRequestingMinimumReinforcements</a>( i ) )
<a name="l05228"></a>05228                         { <span class="comment">//This is the group that gets the reinforcements!</span>
<a name="l05229"></a>05229                               <span class="keywordflow">if</span>( <a class="code" href="Strategic_01AI_8cpp.html#0cccefb435b3d940d9bf817c88224d6f">ReinforcementsApproved</a>( i, &amp;usDefencePoints ) )
<a name="l05230"></a>05230                               {
<a name="l05231"></a>05231                                     <a class="code" href="Strategic_01AI_8cpp.html#a5149c8e5d77cd98583fe9f8abf93657">SendReinforcementsForGarrison</a>( i, usDefencePoints, pGroup );
<a name="l05232"></a>05232                                     <span class="keywordflow">return</span>;
<a name="l05233"></a>05233                               }
<a name="l05234"></a>05234                         }
<a name="l05235"></a>05235                         <span class="keywordflow">if</span>( iReloopLastIndex == -1 )
<a name="l05236"></a>05236                         { <span class="comment">//go to the next garrison and clear the iRandom value so it attempts to use all subsequent groups.</span>
<a name="l05237"></a>05237                               iReloopLastIndex = i - 1;
<a name="l05238"></a>05238                               iRandom = 0;
<a name="l05239"></a>05239                         }
<a name="l05240"></a>05240                   }
<a name="l05241"></a>05241                   <span class="comment">//Decrease the iRandom value until it hits 0.  When that happens, all garrisons will get considered until</span>
<a name="l05242"></a>05242                   <span class="comment">//we either have a match or process all of the garrisons.</span>
<a name="l05243"></a>05243                   iRandom -= iWeight;
<a name="l05244"></a>05244             }
<a name="l05245"></a>05245       }
<a name="l05246"></a>05246       <span class="keywordflow">if</span>( iReloopLastIndex &gt;= 0 )
<a name="l05247"></a>05247       { <span class="comment">//Process the loop again to the point where the original random slot started considering, and consider</span>
<a name="l05248"></a>05248             <span class="comment">//all of the garrisons.  If this fails, all patrol groups will be considered next.</span>
<a name="l05249"></a>05249             <span class="keywordflow">for</span>( i = 0; i &lt;= iReloopLastIndex; i++ )
<a name="l05250"></a>05250             {
<a name="l05251"></a>05251                   <a class="code" href="Strategic_01AI_8cpp.html#c9af29ba59f70cabda683c1d3e7de1d0">RecalculateGarrisonWeight</a>( i );
<a name="l05252"></a>05252                   iWeight = <a class="code" href="AI_01Viewer_8cpp.html#a9f940d7f3a6d6698bfaeb7c747d74a9">gGarrisonGroup</a>[ i ].<a class="code" href="structGARRISON__GROUP.html#54fcf91b97b56e3cc75ef302b34ecf48">bWeight</a>;
<a name="l05253"></a>05253                   <span class="keywordflow">if</span>( iWeight &gt; 0 )
<a name="l05254"></a>05254                   {     <span class="comment">//if group is requesting reinforcements.</span>
<a name="l05255"></a>05255                         <span class="keywordflow">if</span>( !<a class="code" href="AI_01Viewer_8cpp.html#a9f940d7f3a6d6698bfaeb7c747d74a9">gGarrisonGroup</a>[ i ].ubPendingGroupID &amp;&amp; 
<a name="l05256"></a>05256                                     <a class="code" href="Strategic_01AI_8cpp.html#f8f6673c3fc186e8d92341498a455679">EnemyPermittedToAttackSector</a>( NULL, <a class="code" href="AI_01Viewer_8cpp.html#a9f940d7f3a6d6698bfaeb7c747d74a9">gGarrisonGroup</a>[ i ].ubSectorID ) &amp;&amp;
<a name="l05257"></a>05257                                     <a class="code" href="Strategic_01AI_8cpp.html#acc69c670c9bac13b5e41484b4648552">GarrisonRequestingMinimumReinforcements</a>( i ) )
<a name="l05258"></a>05258                         { <span class="comment">//This is the group that gets the reinforcements!</span>
<a name="l05259"></a>05259                               <span class="keywordflow">if</span>( <a class="code" href="Strategic_01AI_8cpp.html#0cccefb435b3d940d9bf817c88224d6f">ReinforcementsApproved</a>( i, &amp;usDefencePoints ) )
<a name="l05260"></a>05260                               {
<a name="l05261"></a>05261                                     <a class="code" href="Strategic_01AI_8cpp.html#a5149c8e5d77cd98583fe9f8abf93657">SendReinforcementsForGarrison</a>( i, usDefencePoints, pGroup );
<a name="l05262"></a>05262                                     <span class="keywordflow">return</span>;
<a name="l05263"></a>05263                               }
<a name="l05264"></a>05264                         }
<a name="l05265"></a>05265                   }
<a name="l05266"></a>05266             }
<a name="l05267"></a>05267       }
<a name="l05268"></a>05268       <span class="keywordflow">if</span>( iReloopLastIndex == -1 )
<a name="l05269"></a>05269       {
<a name="l05270"></a>05270             <span class="comment">//go through the patrol groups</span>
<a name="l05271"></a>05271             <span class="keywordflow">for</span>( i = 0; i &lt; giPatrolArraySize; i++ )
<a name="l05272"></a>05272             {
<a name="l05273"></a>05273                   <a class="code" href="Strategic_01AI_8cpp.html#d11803600200a4f8e0f5d842132fc140">RecalculatePatrolWeight</a>( i );
<a name="l05274"></a>05274                   iWeight = <a class="code" href="Strategic_01AI_8cpp.html#9e00ccb0e77cec57208c519e8f831f53">gPatrolGroup</a>[ i ].<a class="code" href="structPATROL__GROUP.html#dd4d329226457571a40c1855943ef39b">bWeight</a>;
<a name="l05275"></a>05275                   <span class="keywordflow">if</span>( iWeight &gt; 0 )
<a name="l05276"></a>05276                   {
<a name="l05277"></a>05277                         <span class="keywordflow">if</span>( iRandom &lt; iWeight )
<a name="l05278"></a>05278                         {
<a name="l05279"></a>05279                               <span class="keywordflow">if</span>( !<a class="code" href="Strategic_01AI_8cpp.html#9e00ccb0e77cec57208c519e8f831f53">gPatrolGroup</a>[ i ].ubPendingGroupID &amp;&amp; <a class="code" href="Strategic_01AI_8cpp.html#6e02787740c45d04fbbd7ca50ca23064">PatrolRequestingMinimumReinforcements</a>( i ) ) 
<a name="l05280"></a>05280                               { <span class="comment">//This is the group that gets the reinforcements!</span>
<a name="l05281"></a>05281                                     <a class="code" href="Strategic_01AI_8cpp.html#8b154858f03533e0134728bee6602276">SendReinforcementsForPatrol</a>( i, pGroup );
<a name="l05282"></a>05282                                     <span class="keywordflow">return</span>;
<a name="l05283"></a>05283                               }
<a name="l05284"></a>05284                         }
<a name="l05285"></a>05285                         <span class="keywordflow">if</span>( iReloopLastIndex == -1 )
<a name="l05286"></a>05286                         {
<a name="l05287"></a>05287                               iReloopLastIndex = i - 1;
<a name="l05288"></a>05288                               iRandom = 0;
<a name="l05289"></a>05289                         }
<a name="l05290"></a>05290                         iRandom -= iWeight;
<a name="l05291"></a>05291                   }
<a name="l05292"></a>05292             }
<a name="l05293"></a>05293       }
<a name="l05294"></a>05294       <span class="keywordflow">else</span>
<a name="l05295"></a>05295       {
<a name="l05296"></a>05296             iReloopLastIndex = giPatrolArraySize - 1;
<a name="l05297"></a>05297       }
<a name="l05298"></a>05298 
<a name="l05299"></a>05299       <span class="keywordflow">for</span>( i = 0; i &lt;= iReloopLastIndex; i++ )
<a name="l05300"></a>05300       {
<a name="l05301"></a>05301             <a class="code" href="Strategic_01AI_8cpp.html#d11803600200a4f8e0f5d842132fc140">RecalculatePatrolWeight</a>( i );
<a name="l05302"></a>05302             iWeight = <a class="code" href="Strategic_01AI_8cpp.html#9e00ccb0e77cec57208c519e8f831f53">gPatrolGroup</a>[ i ].<a class="code" href="structPATROL__GROUP.html#dd4d329226457571a40c1855943ef39b">bWeight</a>;
<a name="l05303"></a>05303             <span class="keywordflow">if</span>( iWeight &gt; 0 )
<a name="l05304"></a>05304             {
<a name="l05305"></a>05305                   <span class="keywordflow">if</span>( !<a class="code" href="Strategic_01AI_8cpp.html#9e00ccb0e77cec57208c519e8f831f53">gPatrolGroup</a>[ i ].ubPendingGroupID &amp;&amp; <a class="code" href="Strategic_01AI_8cpp.html#6e02787740c45d04fbbd7ca50ca23064">PatrolRequestingMinimumReinforcements</a>( i ) ) 
<a name="l05306"></a>05306                   { <span class="comment">//This is the group that gets the reinforcements!</span>
<a name="l05307"></a>05307                         <a class="code" href="Strategic_01AI_8cpp.html#8b154858f03533e0134728bee6602276">SendReinforcementsForPatrol</a>( i, pGroup );
<a name="l05308"></a>05308                         <span class="keywordflow">return</span>;
<a name="l05309"></a>05309                   }
<a name="l05310"></a>05310             }
<a name="l05311"></a>05311       }
<a name="l05312"></a>05312       <a class="code" href="Strategic_01AI_8cpp.html#aedf834c1be3774f0024f959b4847210">TransferGroupToPool</a>( pGroup );
<a name="l05313"></a>05313 }
<a name="l05314"></a>05314 
<a name="l05315"></a>05315 <span class="comment">//When an enemy AI group is eliminated by the player, apply a grace period in which the </span>
<a name="l05316"></a>05316 <span class="comment">//group isn't allowed to be filled for several days.</span>
<a name="l05317"></a><a class="code" href="Strategic_01AI_8h.html#626dbbe3f6ab416e4ca04ee09063042f">05317</a> <span class="keywordtype">void</span> <a class="code" href="Strategic_01AI_8cpp.html#626dbbe3f6ab416e4ca04ee09063042f">TagSAIGroupWithGracePeriod</a>( <a class="code" href="structGROUP.html">GROUP</a> *pGroup )
<a name="l05318"></a>05318 {
<a name="l05319"></a>05319       <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a> iPatrolID;
<a name="l05320"></a>05320       <span class="keywordflow">if</span>( pGroup )
<a name="l05321"></a>05321       {
<a name="l05322"></a>05322             iPatrolID = <a class="code" href="Strategic_01AI_8cpp.html#ec4412ba6a1b889020e3869d14b4d65b">FindPatrolGroupIndexForGroupID</a>( pGroup-&gt;<a class="code" href="structGROUP.html#9149379b9355afda87a382af5a88d728">ubGroupID</a> );
<a name="l05323"></a>05323             <span class="keywordflow">if</span>( iPatrolID != -1 )
<a name="l05324"></a>05324             {
<a name="l05325"></a>05325                   <span class="keywordflow">switch</span>( <a class="code" href="GameSettings_8cpp.html#f9f2d5fd368ccadcc26bebc202d52ae7">gGameOptions</a>.<a class="code" href="structGAME__OPTIONS.html#4fb44167906152722f6af5cc9f7c1a99">ubDifficultyLevel</a> )
<a name="l05326"></a>05326                   {
<a name="l05327"></a>05327                         <span class="keywordflow">case</span> <a class="code" href="GameSettings_8h.html#c205be2172292384dd687b5471a87eddbd3b0d23f4dc30ef17b50a14c3f54589">DIF_LEVEL_EASY</a>:
<a name="l05328"></a>05328                               <a class="code" href="Strategic_01AI_8cpp.html#9e00ccb0e77cec57208c519e8f831f53">gPatrolGroup</a>[ iPatrolID ].<a class="code" href="structPATROL__GROUP.html#3f8498e5b45a4998bd270f417cc45f53">bFillPermittedAfterDayMod100</a> = (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)((<a class="code" href="Game_01Clock_8cpp.html#41db6fb136e18cfede5f7c1eea89d7fb">GetWorldDay</a>() + <a class="code" href="GameSettings_8cpp.html#5c32f930e2fef384505c4b91803a92c2">gGameExternalOptions</a>.<a class="code" href="structGAME__EXTERNAL__OPTIONS.html#b9a2b3a3ac3dc3b1a5c406406c41d362">ubEasyPatrolGracePeriodInDays</a>) % 100);
<a name="l05329"></a>05329                               <span class="keywordflow">break</span>;
<a name="l05330"></a>05330                         <span class="keywordflow">case</span> <a class="code" href="GameSettings_8h.html#c205be2172292384dd687b5471a87edddd0259b09fef163c6aa62268574191cb">DIF_LEVEL_MEDIUM</a>:
<a name="l05331"></a>05331                               <a class="code" href="Strategic_01AI_8cpp.html#9e00ccb0e77cec57208c519e8f831f53">gPatrolGroup</a>[ iPatrolID ].<a class="code" href="structPATROL__GROUP.html#3f8498e5b45a4998bd270f417cc45f53">bFillPermittedAfterDayMod100</a> = (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)((<a class="code" href="Game_01Clock_8cpp.html#41db6fb136e18cfede5f7c1eea89d7fb">GetWorldDay</a>() + <a class="code" href="GameSettings_8cpp.html#5c32f930e2fef384505c4b91803a92c2">gGameExternalOptions</a>.<a class="code" href="structGAME__EXTERNAL__OPTIONS.html#92f510b689ed6ae9467e1cdb50399112">ubNormalPatrolGracePeriodInDays</a>) % 100);
<a name="l05332"></a>05332                               <span class="keywordflow">break</span>;
<a name="l05333"></a>05333                         <span class="keywordflow">case</span> <a class="code" href="GameSettings_8h.html#c205be2172292384dd687b5471a87edd3d0b73026f1c7122798d578613aa4575">DIF_LEVEL_HARD</a>:
<a name="l05334"></a>05334                               <a class="code" href="Strategic_01AI_8cpp.html#9e00ccb0e77cec57208c519e8f831f53">gPatrolGroup</a>[ iPatrolID ].<a class="code" href="structPATROL__GROUP.html#3f8498e5b45a4998bd270f417cc45f53">bFillPermittedAfterDayMod100</a> = (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)((<a class="code" href="Game_01Clock_8cpp.html#41db6fb136e18cfede5f7c1eea89d7fb">GetWorldDay</a>() + <a class="code" href="GameSettings_8cpp.html#5c32f930e2fef384505c4b91803a92c2">gGameExternalOptions</a>.<a class="code" href="structGAME__EXTERNAL__OPTIONS.html#3fc462bef4cc5678aab90dd2a48689f2">ubHardPatrolGracePeriodInDays</a>) % 100);
<a name="l05335"></a>05335                               <span class="keywordflow">break</span>;
<a name="l05336"></a>05336                         <span class="keywordflow">case</span> <a class="code" href="GameSettings_8h.html#c205be2172292384dd687b5471a87eddc657c89fd754a6f20b3869250288a702">DIF_LEVEL_INSANE</a>:
<a name="l05337"></a>05337                               <a class="code" href="Strategic_01AI_8cpp.html#9e00ccb0e77cec57208c519e8f831f53">gPatrolGroup</a>[ iPatrolID ].<a class="code" href="structPATROL__GROUP.html#3f8498e5b45a4998bd270f417cc45f53">bFillPermittedAfterDayMod100</a> = (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)((<a class="code" href="Game_01Clock_8cpp.html#41db6fb136e18cfede5f7c1eea89d7fb">GetWorldDay</a>() + <a class="code" href="GameSettings_8cpp.html#5c32f930e2fef384505c4b91803a92c2">gGameExternalOptions</a>.<a class="code" href="structGAME__EXTERNAL__OPTIONS.html#b5d7754f748cc6eae1fab60a7b8ef02c">ubInsanePatrolGracePeriodInDays</a>) % 100);
<a name="l05338"></a>05338                               <span class="keywordflow">break</span>;
<a name="l05339"></a>05339                   }
<a name="l05340"></a>05340             }
<a name="l05341"></a>05341       }
<a name="l05342"></a>05342 }
<a name="l05343"></a>05343 
<a name="l05344"></a><a class="code" href="Strategic_01AI_8h.html#3ce548a65fa1537749a3a8871d4bb143">05344</a> <a class="code" href="Types_8h.html#112e3146cb38b6ee95e64d85842e380a">BOOLEAN</a> <a class="code" href="Strategic_01AI_8cpp.html#3ce548a65fa1537749a3a8871d4bb143">PermittedToFillPatrolGroup</a>( <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a> iPatrolID )
<a name="l05345"></a>05345 {
<a name="l05346"></a>05346       <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a> iDay;
<a name="l05347"></a>05347       <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a> iDayAllowed;
<a name="l05348"></a>05348       iDay = <a class="code" href="Game_01Clock_8cpp.html#41db6fb136e18cfede5f7c1eea89d7fb">GetWorldDay</a>();
<a name="l05349"></a>05349       iDayAllowed = <a class="code" href="Strategic_01AI_8cpp.html#9e00ccb0e77cec57208c519e8f831f53">gPatrolGroup</a>[ iPatrolID ].<a class="code" href="structPATROL__GROUP.html#3f8498e5b45a4998bd270f417cc45f53">bFillPermittedAfterDayMod100</a> + (iDay / 100) * 100;
<a name="l05350"></a>05350       <span class="keywordflow">return</span> iDay &gt;= iDayAllowed;
<a name="l05351"></a>05351 }
<a name="l05352"></a>05352 
<a name="l05353"></a><a class="code" href="Strategic_01AI_8h.html#e0836a6d95b37a4b2ba93e1e1980ecca">05353</a> <span class="keywordtype">void</span> <a class="code" href="Strategic_01AI_8cpp.html#e0836a6d95b37a4b2ba93e1e1980ecca">RepollSAIGroup</a>( <a class="code" href="structGROUP.html">GROUP</a> *pGroup )
<a name="l05354"></a>05354 {
<a name="l05355"></a>05355       <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a> i;
<a name="l05356"></a>05356       Assert( !pGroup-&gt;<a class="code" href="structGROUP.html#1420d1afb0a1876a85b6b93308fbaf68">fPlayer</a> );
<a name="l05357"></a>05357       <span class="keywordflow">if</span>( <a class="code" href="Strategic_01Movement_8cpp.html#5bffbc0549f4fb0c8829436f9ee6e907">GroupAtFinalDestination</a>( pGroup ) )
<a name="l05358"></a>05358       {
<a name="l05359"></a>05359             <a class="code" href="Strategic_01AI_8cpp.html#42d5667c02da82d67a9a81191ca32064">EvaluateGroupSituation</a>( pGroup );
<a name="l05360"></a>05360             <span class="keywordflow">return</span>;
<a name="l05361"></a>05361       }
<a name="l05362"></a>05362       <span class="keywordflow">for</span>( i = 0; i &lt; giPatrolArraySize; i++ )
<a name="l05363"></a>05363       {
<a name="l05364"></a>05364             <span class="keywordflow">if</span>( <a class="code" href="Strategic_01AI_8cpp.html#9e00ccb0e77cec57208c519e8f831f53">gPatrolGroup</a>[ i ].ubGroupID == pGroup-&gt;<a class="code" href="structGROUP.html#9149379b9355afda87a382af5a88d728">ubGroupID</a> )
<a name="l05365"></a>05365             {
<a name="l05366"></a>05366                   <a class="code" href="Strategic_01AI_8cpp.html#d11803600200a4f8e0f5d842132fc140">RecalculatePatrolWeight</a>( i ); <span class="comment">//in case there are any dead enemies</span>
<a name="l05367"></a>05367                   <a class="code" href="Strategic_01Movement_8cpp.html#4006125525d0f9e40235efef470af9af">CalculateNextMoveIntention</a>( pGroup );
<a name="l05368"></a>05368                   <span class="keywordflow">return</span>;
<a name="l05369"></a>05369             }
<a name="l05370"></a>05370       }
<a name="l05371"></a>05371       <span class="keywordflow">for</span>( i = 0; i &lt; giGarrisonArraySize; i++ )
<a name="l05372"></a>05372       {
<a name="l05373"></a>05373             <span class="comment">//KM : August 6, 1999 Patch fix</span>
<a name="l05374"></a>05374             <span class="comment">//     Ack, wasn't checking for the matching group to garrison</span>
<a name="l05375"></a>05375             <span class="keywordflow">if</span>( <a class="code" href="AI_01Viewer_8cpp.html#a9f940d7f3a6d6698bfaeb7c747d74a9">gGarrisonGroup</a>[ i ].ubPendingGroupID == pGroup-&gt;ubGroupID )
<a name="l05376"></a>05376             <span class="comment">//end</span>
<a name="l05377"></a>05377             {
<a name="l05378"></a>05378                   <a class="code" href="Strategic_01AI_8cpp.html#c9af29ba59f70cabda683c1d3e7de1d0">RecalculateGarrisonWeight</a>( i ); <span class="comment">//in case there are any dead enemies</span>
<a name="l05379"></a>05379                   <a class="code" href="Strategic_01Movement_8cpp.html#4006125525d0f9e40235efef470af9af">CalculateNextMoveIntention</a>( pGroup );
<a name="l05380"></a>05380                   <span class="keywordflow">return</span>;
<a name="l05381"></a>05381             }
<a name="l05382"></a>05382       }
<a name="l05383"></a>05383 }
<a name="l05384"></a>05384 
<a name="l05385"></a><a class="code" href="Auto_01Resolve_8cpp.html#bf99843dcb604b6d631665205f1a3d42">05385</a> <span class="keywordtype">void</span> <a class="code" href="Auto_01Resolve_8cpp.html#bf99843dcb604b6d631665205f1a3d42">ClearPreviousAIGroupAssignment</a>( <a class="code" href="structGROUP.html">GROUP</a> *pGroup )
<a name="l05386"></a>05386 {
<a name="l05387"></a>05387       <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a> i;
<a name="l05388"></a>05388       <span class="keywordflow">for</span>( i = 0; i &lt; giPatrolArraySize; i++ )
<a name="l05389"></a>05389       {
<a name="l05390"></a>05390             <span class="keywordflow">if</span>( <a class="code" href="Strategic_01AI_8cpp.html#9e00ccb0e77cec57208c519e8f831f53">gPatrolGroup</a>[ i ].ubGroupID == pGroup-&gt;<a class="code" href="structGROUP.html#9149379b9355afda87a382af5a88d728">ubGroupID</a> )
<a name="l05391"></a>05391             {
<a name="l05392"></a>05392                   <a class="code" href="Strategic_01AI_8cpp.html#9e00ccb0e77cec57208c519e8f831f53">gPatrolGroup</a>[ i ].<a class="code" href="structPATROL__GROUP.html#a94d3c610977f7a6fab94b302493d084">ubGroupID</a> = 0;
<a name="l05393"></a>05393                   <a class="code" href="Strategic_01AI_8cpp.html#d11803600200a4f8e0f5d842132fc140">RecalculatePatrolWeight</a>( i );
<a name="l05394"></a>05394                   <span class="keywordflow">return</span>;
<a name="l05395"></a>05395             }
<a name="l05396"></a>05396             <span class="keywordflow">if</span>( <a class="code" href="Strategic_01AI_8cpp.html#9e00ccb0e77cec57208c519e8f831f53">gPatrolGroup</a>[ i ].ubPendingGroupID == pGroup-&gt;<a class="code" href="structGROUP.html#9149379b9355afda87a382af5a88d728">ubGroupID</a> )
<a name="l05397"></a>05397             {
<a name="l05398"></a>05398                   <a class="code" href="Strategic_01AI_8cpp.html#9e00ccb0e77cec57208c519e8f831f53">gPatrolGroup</a>[ i ].<a class="code" href="structPATROL__GROUP.html#85b82707f42868bcdd678a1d7ba9c257">ubPendingGroupID</a> = 0;
<a name="l05399"></a>05399                   <span class="keywordflow">return</span>;
<a name="l05400"></a>05400             }
<a name="l05401"></a>05401       }
<a name="l05402"></a>05402       <span class="comment">//Also check if this group was a garrison's pending group</span>
<a name="l05403"></a>05403       <span class="keywordflow">for</span>( i = 0; i &lt; giGarrisonArraySize; i++ )
<a name="l05404"></a>05404       {
<a name="l05405"></a>05405             <span class="keywordflow">if</span>( <a class="code" href="AI_01Viewer_8cpp.html#a9f940d7f3a6d6698bfaeb7c747d74a9">gGarrisonGroup</a>[ i ].ubPendingGroupID == pGroup-&gt;ubGroupID )
<a name="l05406"></a>05406             {
<a name="l05407"></a>05407                   <a class="code" href="AI_01Viewer_8cpp.html#a9f940d7f3a6d6698bfaeb7c747d74a9">gGarrisonGroup</a>[ i ].<a class="code" href="structGARRISON__GROUP.html#ea8325bf63e1d81924fb5fab93b37d8e">ubPendingGroupID</a> = 0;
<a name="l05408"></a>05408                   <span class="keywordflow">return</span>;
<a name="l05409"></a>05409             }
<a name="l05410"></a>05410       }
<a name="l05411"></a>05411 }
<a name="l05412"></a>05412 
<a name="l05413"></a><a class="code" href="Strategic_01AI_8cpp.html#c348102993f2e72a7b73cc2f93cf7ac3">05413</a> <span class="keywordtype">void</span> <a class="code" href="Strategic_01AI_8cpp.html#c348102993f2e72a7b73cc2f93cf7ac3">CalcNumTroopsBasedOnComposition</a>( <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> *pubNumTroops, <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> *pubNumElites, <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubTotal, <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a> iCompositionID )
<a name="l05414"></a>05414 {
<a name="l05415"></a>05415       *pubNumTroops = <a class="code" href="AI_01Viewer_8cpp.html#77e448d1f208bd120f861571e6d0098f">gArmyComp</a>[ iCompositionID ].<a class="code" href="structARMY__COMPOSITION.html#dcd9feb9bbaf14485e7151ae0c0652d2">bTroopPercentage</a> * ubTotal / 100;
<a name="l05416"></a>05416       *pubNumElites = <a class="code" href="AI_01Viewer_8cpp.html#77e448d1f208bd120f861571e6d0098f">gArmyComp</a>[ iCompositionID ].<a class="code" href="structARMY__COMPOSITION.html#2b7c33a62b43654cd8f66ebe2e7afaa0">bElitePercentage</a> * ubTotal / 100;
<a name="l05417"></a>05417 
<a name="l05418"></a>05418       <span class="comment">//Due to low roundoff, it is highly possible that we will be short one soldier.</span>
<a name="l05419"></a>05419       <span class="keywordflow">while</span>( *pubNumTroops + *pubNumElites &lt; ubTotal )
<a name="l05420"></a>05420       {
<a name="l05421"></a>05421             <span class="keywordflow">if</span>( <a class="code" href="Random_8cpp.html#742221657b584d8416ada22fa8ff23dd">Chance</a>( <a class="code" href="AI_01Viewer_8cpp.html#77e448d1f208bd120f861571e6d0098f">gArmyComp</a>[ iCompositionID ].bTroopPercentage ) )
<a name="l05422"></a>05422             {
<a name="l05423"></a>05423                   (*pubNumTroops)++;
<a name="l05424"></a>05424             }
<a name="l05425"></a>05425             <span class="keywordflow">else</span>
<a name="l05426"></a>05426             {
<a name="l05427"></a>05427                   (*pubNumElites)++;
<a name="l05428"></a>05428             }
<a name="l05429"></a>05429       }
<a name="l05430"></a>05430       Assert( *pubNumTroops + *pubNumElites == ubTotal );
<a name="l05431"></a>05431 }
<a name="l05432"></a>05432 
<a name="l05433"></a><a class="code" href="Strategic_01AI_8cpp.html#d4c479be89206291565d9795d7515967">05433</a> <span class="keywordtype">void</span> <a class="code" href="Strategic_01AI_8cpp.html#d4c479be89206291565d9795d7515967">ConvertGroupTroopsToComposition</a>( <a class="code" href="structGROUP.html">GROUP</a> *pGroup, <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a> iCompositionID )
<a name="l05434"></a>05434 {
<a name="l05435"></a>05435       Assert( pGroup );
<a name="l05436"></a>05436       Assert( !pGroup-&gt;<a class="code" href="structGROUP.html#1420d1afb0a1876a85b6b93308fbaf68">fPlayer</a> );
<a name="l05437"></a>05437       <a class="code" href="Strategic_01AI_8cpp.html#c348102993f2e72a7b73cc2f93cf7ac3">CalcNumTroopsBasedOnComposition</a>( &amp;pGroup-&gt;<a class="code" href="structGROUP.html#f82ff4c3e504e4bb10feb65491f79471">pEnemyGroup</a>-&gt;<a class="code" href="structENEMYGROUP.html#27eaaea857408bc6c6358054c19f2d07">ubNumTroops</a>, &amp;pGroup-&gt;<a class="code" href="structGROUP.html#f82ff4c3e504e4bb10feb65491f79471">pEnemyGroup</a>-&gt;<a class="code" href="structENEMYGROUP.html#5f20a703a3c536505126979265b10558">ubNumElites</a>, pGroup-&gt;<a class="code" href="structGROUP.html#2a98517c894019ee794e04ea05d1aeaf">ubGroupSize</a>, iCompositionID );
<a name="l05438"></a>05438       pGroup-&gt;<a class="code" href="structGROUP.html#f82ff4c3e504e4bb10feb65491f79471">pEnemyGroup</a>-&gt;<a class="code" href="structENEMYGROUP.html#61d6f824f39709580afa7a81317e241b">ubNumAdmins</a> = 0;
<a name="l05439"></a>05439       pGroup-&gt;<a class="code" href="structGROUP.html#2a98517c894019ee794e04ea05d1aeaf">ubGroupSize</a> = pGroup-&gt;<a class="code" href="structGROUP.html#f82ff4c3e504e4bb10feb65491f79471">pEnemyGroup</a>-&gt;<a class="code" href="structENEMYGROUP.html#27eaaea857408bc6c6358054c19f2d07">ubNumTroops</a> + pGroup-&gt;<a class="code" href="structGROUP.html#f82ff4c3e504e4bb10feb65491f79471">pEnemyGroup</a>-&gt;<a class="code" href="structENEMYGROUP.html#5f20a703a3c536505126979265b10558">ubNumElites</a>;
<a name="l05440"></a>05440       <a class="code" href="Strategic_01AI_8cpp.html#cc36ad74d06a3b8b211a4e06c8528a43">ValidateLargeGroup</a>( pGroup );
<a name="l05441"></a>05441 }
<a name="l05442"></a>05442 
<a name="l05443"></a><a class="code" href="Strategic_01AI_8cpp.html#b07cff54af372d6ec184957cb7b51266">05443</a> <span class="keywordtype">void</span> <a class="code" href="Strategic_01AI_8cpp.html#b07cff54af372d6ec184957cb7b51266">RemoveSoldiersFromGarrisonBasedOnComposition</a>( <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a> iGarrisonID, <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubSize )
<a name="l05444"></a>05444 {
<a name="l05445"></a>05445       <a class="code" href="structSECTORINFO.html">SECTORINFO</a> *pSector;
<a name="l05446"></a>05446       <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a> iCompositionID;
<a name="l05447"></a>05447       <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubNumTroops, ubNumElites;
<a name="l05448"></a>05448 
<a name="l05449"></a>05449       <span class="comment">//debug stuff</span>
<a name="l05450"></a>05450       <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubOrigSectorAdmins;
<a name="l05451"></a>05451       <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubOrigSectorTroops;
<a name="l05452"></a>05452       <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubOrigSectorElites;
<a name="l05453"></a>05453       <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubOrigNumElites;
<a name="l05454"></a>05454       <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubOrigNumTroops;
<a name="l05455"></a>05455       <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubOrigSize;
<a name="l05456"></a>05456 
<a name="l05457"></a>05457       iCompositionID = <a class="code" href="AI_01Viewer_8cpp.html#a9f940d7f3a6d6698bfaeb7c747d74a9">gGarrisonGroup</a>[ iGarrisonID ].<a class="code" href="structGARRISON__GROUP.html#a8feee88c982ca594b5bb1fcd2971ea5">ubComposition</a>;
<a name="l05458"></a>05458 
<a name="l05459"></a>05459       <a class="code" href="Strategic_01AI_8cpp.html#c348102993f2e72a7b73cc2f93cf7ac3">CalcNumTroopsBasedOnComposition</a>( &amp;ubNumTroops, &amp;ubNumElites, ubSize, iCompositionID );
<a name="l05460"></a>05460       pSector = &amp;<a class="code" href="Campaign_01Types_8h.html#d83c6f699f17a47cf6a662c91d959126">SectorInfo</a>[ <a class="code" href="AI_01Viewer_8cpp.html#a9f940d7f3a6d6698bfaeb7c747d74a9">gGarrisonGroup</a>[ iGarrisonID ].<a class="code" href="structGARRISON__GROUP.html#fb130d3c9211374d87a85cca787fe0dd">ubSectorID</a> ];
<a name="l05461"></a>05461       <span class="comment">//if there are administrators in this sector, remove them first.</span>
<a name="l05462"></a>05462 
<a name="l05463"></a>05463       ubOrigNumElites = ubNumElites;
<a name="l05464"></a>05464       ubOrigNumTroops = ubNumTroops;
<a name="l05465"></a>05465       ubOrigSectorAdmins = pSector-&gt;<a class="code" href="structSECTORINFO.html#d7d5ee63c0dc2ad3164c83541bd80906">ubNumAdmins</a>;
<a name="l05466"></a>05466       ubOrigSectorTroops = pSector-&gt;<a class="code" href="structSECTORINFO.html#e36540b93256cfa71e45382f133d3696">ubNumTroops</a>;
<a name="l05467"></a>05467       ubOrigSectorElites = pSector-&gt;<a class="code" href="structSECTORINFO.html#3c5312672399c40ec5a395e8bcfb0104">ubNumElites</a>;
<a name="l05468"></a>05468       ubOrigSize = ubSize;
<a name="l05469"></a>05469 
<a name="l05470"></a>05470       <span class="keywordflow">while</span>( ubSize &amp;&amp; pSector-&gt;<a class="code" href="structSECTORINFO.html#d7d5ee63c0dc2ad3164c83541bd80906">ubNumAdmins</a> )
<a name="l05471"></a>05471       {
<a name="l05472"></a>05472             pSector-&gt;<a class="code" href="structSECTORINFO.html#d7d5ee63c0dc2ad3164c83541bd80906">ubNumAdmins</a>--;
<a name="l05473"></a>05473             ubSize--;
<a name="l05474"></a>05474             <span class="keywordflow">if</span>( ubNumTroops )
<a name="l05475"></a>05475             {
<a name="l05476"></a>05476                   ubNumTroops--;
<a name="l05477"></a>05477             }
<a name="l05478"></a>05478             <span class="keywordflow">else</span>
<a name="l05479"></a>05479             {
<a name="l05480"></a>05480                   ubNumElites--;
<a name="l05481"></a>05481             }
<a name="l05482"></a>05482       }
<a name="l05483"></a>05483       <span class="comment">//No administrators are left.  </span>
<a name="l05484"></a>05484       
<a name="l05485"></a>05485       <span class="comment">//Eliminate the troops</span>
<a name="l05486"></a>05486       <span class="keywordflow">while</span>( ubNumTroops )
<a name="l05487"></a>05487       {
<a name="l05488"></a>05488             <span class="keywordflow">if</span>( pSector-&gt;<a class="code" href="structSECTORINFO.html#e36540b93256cfa71e45382f133d3696">ubNumTroops</a> )
<a name="l05489"></a>05489             {
<a name="l05490"></a>05490                   pSector-&gt;<a class="code" href="structSECTORINFO.html#e36540b93256cfa71e45382f133d3696">ubNumTroops</a>--;
<a name="l05491"></a>05491             }
<a name="l05492"></a>05492             <span class="keywordflow">else</span> <span class="keywordflow">if</span>( pSector-&gt;<a class="code" href="structSECTORINFO.html#3c5312672399c40ec5a395e8bcfb0104">ubNumElites</a> )
<a name="l05493"></a>05493             {
<a name="l05494"></a>05494                   pSector-&gt;<a class="code" href="structSECTORINFO.html#3c5312672399c40ec5a395e8bcfb0104">ubNumElites</a>--;
<a name="l05495"></a>05495             }
<a name="l05496"></a>05496             <span class="keywordflow">else</span>
<a name="l05497"></a>05497             {
<a name="l05498"></a>05498                   Assert( 0 );
<a name="l05499"></a>05499             }
<a name="l05500"></a>05500             ubNumTroops--;
<a name="l05501"></a>05501       }
<a name="l05502"></a>05502 
<a name="l05503"></a>05503       <span class="comment">//Eliminate the elites </span>
<a name="l05504"></a>05504       <span class="keywordflow">while</span>( ubNumElites )
<a name="l05505"></a>05505       {
<a name="l05506"></a>05506             <span class="keywordflow">if</span>( pSector-&gt;<a class="code" href="structSECTORINFO.html#3c5312672399c40ec5a395e8bcfb0104">ubNumElites</a> )
<a name="l05507"></a>05507             {
<a name="l05508"></a>05508                   pSector-&gt;<a class="code" href="structSECTORINFO.html#3c5312672399c40ec5a395e8bcfb0104">ubNumElites</a>--;
<a name="l05509"></a>05509             }
<a name="l05510"></a>05510             <span class="keywordflow">else</span> <span class="keywordflow">if</span>( pSector-&gt;<a class="code" href="structSECTORINFO.html#e36540b93256cfa71e45382f133d3696">ubNumTroops</a> )
<a name="l05511"></a>05511             {
<a name="l05512"></a>05512                   pSector-&gt;<a class="code" href="structSECTORINFO.html#e36540b93256cfa71e45382f133d3696">ubNumTroops</a>--;
<a name="l05513"></a>05513             }
<a name="l05514"></a>05514             <span class="keywordflow">else</span>
<a name="l05515"></a>05515             {
<a name="l05516"></a>05516                   Assert( 0 );
<a name="l05517"></a>05517             }
<a name="l05518"></a>05518             ubNumElites--;
<a name="l05519"></a>05519       }
<a name="l05520"></a>05520 
<a name="l05521"></a>05521       <a class="code" href="Strategic_01AI_8cpp.html#c9af29ba59f70cabda683c1d3e7de1d0">RecalculateGarrisonWeight</a>( iGarrisonID );
<a name="l05522"></a>05522 }
<a name="l05523"></a>05523 
<a name="l05524"></a><a class="code" href="Strategic_01AI_8cpp.html#3865b55f00d5df7710bd4325ddf83bfc">05524</a> <span class="keywordtype">void</span> <a class="code" href="Strategic_01AI_8cpp.html#3865b55f00d5df7710bd4325ddf83bfc">MoveSAIGroupToSector</a>( <a class="code" href="structGROUP.html">GROUP</a> **pGroup, <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubSectorID, <a class="code" href="Types_8h.html#e1e6edbbc26d6fbc71a90190d0266018">UINT32</a> uiMoveCode, <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubIntention )
<a name="l05525"></a>05525 {
<a name="l05526"></a>05526       <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubDstSectorX, ubDstSectorY;
<a name="l05527"></a>05527 
<a name="l05528"></a>05528       ubDstSectorX = (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)SECTORX( ubSectorID );
<a name="l05529"></a>05529       ubDstSectorY = (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)SECTORY( ubSectorID );
<a name="l05530"></a>05530 
<a name="l05531"></a>05531       <span class="keywordflow">if</span>( (*pGroup)-&gt;fBetweenSectors )
<a name="l05532"></a>05532       {
<a name="l05533"></a>05533             <a class="code" href="Strategic_01Movement_8cpp.html#a19abf3a81cb603e5721889a627be6af">SetEnemyGroupSector</a>( *pGroup, (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)SECTOR( (*pGroup)-&gt;ubSectorX, (*pGroup)-&gt;ubSectorY ) );
<a name="l05534"></a>05534       }
<a name="l05535"></a>05535 
<a name="l05536"></a>05536       (*pGroup)-&gt;pEnemyGroup-&gt;ubIntention = ubIntention;
<a name="l05537"></a>05537       (*pGroup)-&gt;ubMoveType = <a class="code" href="Strategic_01Movement_8h.html#456ac33d49271d3e2c371351cd1d637147c377372bfc5fcfc2f8a70afb906a04">ONE_WAY</a>;
<a name="l05538"></a>05538 
<a name="l05539"></a>05539       <span class="keywordflow">if</span>( ubIntention == <a class="code" href="Strategic_01Movement_8h.html#b59c1bec446b10af208f977a871d910bede7846a7ab284d348a227dc5858530f">PURSUIT</a> )
<a name="l05540"></a>05540       {     <span class="comment">//Make sure that the group isn't moving into a garrison sector.  These sectors should be using ASSAULT intentions!</span>
<a name="l05541"></a>05541             <span class="keywordflow">if</span>( <a class="code" href="Campaign_01Types_8h.html#d83c6f699f17a47cf6a662c91d959126">SectorInfo</a>[ ubSectorID ].ubGarrisonID != NO_GARRISON )
<a name="l05542"></a>05542             {
<a name="l05543"></a>05543                   <span class="comment">//Good place for a breakpoint.</span>
<a name="l05544"></a>05544                   pGroup = pGroup;
<a name="l05545"></a>05545             }
<a name="l05546"></a>05546       }
<a name="l05547"></a>05547 
<a name="l05548"></a>05548       <span class="keywordflow">if</span>( (*pGroup)-&gt;ubSectorX == ubDstSectorX &amp;&amp; (*pGroup)-&gt;ubSectorY == ubDstSectorY )
<a name="l05549"></a>05549       { <span class="comment">//The destination sector is the current location.  Instead of causing code logic problems,</span>
<a name="l05550"></a>05550             <span class="comment">//simply process them as if they just arrived.</span>
<a name="l05551"></a>05551             <span class="keywordflow">if</span>( <a class="code" href="Strategic_01AI_8cpp.html#42d5667c02da82d67a9a81191ca32064">EvaluateGroupSituation</a>( *pGroup ) )
<a name="l05552"></a>05552             { <span class="comment">//The group was deleted.</span>
<a name="l05553"></a>05553                   *pGroup = NULL;
<a name="l05554"></a>05554                   <span class="keywordflow">return</span>;
<a name="l05555"></a>05555             }
<a name="l05556"></a>05556       }
<a name="l05557"></a>05557 
<a name="l05558"></a>05558       <span class="keywordflow">switch</span>( uiMoveCode )
<a name="l05559"></a>05559       {
<a name="l05560"></a>05560             <span class="keywordflow">case</span> <a class="code" href="Strategic_01AI_8cpp.html#2282261c2887b2d4d1183cf5249e1529abdf346cfc40be1a014cf4295888c888">STAGE</a>:
<a name="l05561"></a>05561                   <a class="code" href="Strategic_01Pathing_8cpp.html#b417063b8710fd98ea88b8c24f57faca">MoveGroupFromSectorToSectorButAvoidPlayerInfluencedSectorsAndStopOneSectorBeforeEnd</a>( (*pGroup)-&gt;ubGroupID, (*pGroup)-&gt;ubSectorX, (*pGroup)-&gt;ubSectorY, ubDstSectorX, ubDstSectorY );
<a name="l05562"></a>05562                   <span class="keywordflow">break</span>;
<a name="l05563"></a>05563             <span class="keywordflow">case</span> <a class="code" href="Strategic_01AI_8cpp.html#2282261c2887b2d4d1183cf5249e1529a4d4adb90ccd2b0775d4429cac476900">EVASIVE</a>:
<a name="l05564"></a>05564                   <a class="code" href="Strategic_01Pathing_8cpp.html#f99de934d66ce5ba78552745ba812a22">MoveGroupFromSectorToSectorButAvoidPlayerInfluencedSectors</a>( (*pGroup)-&gt;ubGroupID, (*pGroup)-&gt;ubSectorX, (*pGroup)-&gt;ubSectorY, ubDstSectorX, ubDstSectorY );
<a name="l05565"></a>05565                   <span class="keywordflow">break</span>;
<a name="l05566"></a>05566             <span class="keywordflow">case</span> <a class="code" href="Strategic_01AI_8cpp.html#2282261c2887b2d4d1183cf5249e15291ea328a644e627283a35716a54108248">DIRECT</a>:
<a name="l05567"></a>05567             <span class="keywordflow">default</span>:
<a name="l05568"></a>05568                   <a class="code" href="Strategic_01Pathing_8cpp.html#4555bf679407b3df9ad875521622431f">MoveGroupFromSectorToSector</a>( (*pGroup)-&gt;ubGroupID, (*pGroup)-&gt;ubSectorX, (*pGroup)-&gt;ubSectorY, ubDstSectorX, ubDstSectorY );
<a name="l05569"></a>05569                   <span class="keywordflow">break</span>;
<a name="l05570"></a>05570       }
<a name="l05571"></a>05571       <span class="comment">//Make sure that the group is moving.  If this fails, then the pathing may have failed for some reason.</span>
<a name="l05572"></a>05572       <a class="code" href="Strategic_01AI_8cpp.html#3c3091ef7361288e9f4f6a95cb067980">ValidateGroup</a>( *pGroup );
<a name="l05573"></a>05573 }
<a name="l05574"></a>05574 
<a name="l05575"></a>05575 <span class="comment">//If there are any enemy groups that will be moving through this sector due, they will have to repath which</span>
<a name="l05576"></a>05576 <span class="comment">//will cause them to avoid the sector.  Returns the number of redirected groups.</span>
<a name="l05577"></a><a class="code" href="Strategic_01AI_8cpp.html#a59392985568cf90cc017a406b3b6e0f">05577</a> <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> <a class="code" href="Strategic_01AI_8cpp.html#a59392985568cf90cc017a406b3b6e0f">RedirectEnemyGroupsMovingThroughSector</a>( <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubSectorX, <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubSectorY )
<a name="l05578"></a>05578 {
<a name="l05579"></a>05579       <a class="code" href="structGROUP.html">GROUP</a> *pGroup;
<a name="l05580"></a>05580       <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubNumGroupsRedirected = 0;
<a name="l05581"></a>05581       <a class="code" href="structWAYPOINT.html">WAYPOINT</a> *pWaypoint;
<a name="l05582"></a>05582       <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubDestSectorID;
<a name="l05583"></a>05583       pGroup = <a class="code" href="Strategic_01Movement_8cpp.html#eb63397419934df48a7149753dff164e">gpGroupList</a>;
<a name="l05584"></a>05584       <span class="keywordflow">while</span>( pGroup )
<a name="l05585"></a>05585       {
<a name="l05586"></a>05586             <span class="keywordflow">if</span>( !pGroup-&gt;<a class="code" href="structGROUP.html#1420d1afb0a1876a85b6b93308fbaf68">fPlayer</a> &amp;&amp; pGroup-&gt;<a class="code" href="structGROUP.html#d11970aeea229972cf65f9f169e90451">ubMoveType</a> == <a class="code" href="Strategic_01Movement_8h.html#456ac33d49271d3e2c371351cd1d637147c377372bfc5fcfc2f8a70afb906a04">ONE_WAY</a> )
<a name="l05587"></a>05587             { <span class="comment">//check the waypoint list</span>
<a name="l05588"></a>05588                   <span class="keywordflow">if</span>( <a class="code" href="Strategic_01Movement_8cpp.html#507639353f6aec31fa7aeb0a029a7a6b">GroupWillMoveThroughSector</a>( pGroup, ubSectorX, ubSectorY ) )
<a name="l05589"></a>05589                   { 
<a name="l05590"></a>05590                         <span class="comment">//extract the group's destination.</span>
<a name="l05591"></a>05591                         pWaypoint = <a class="code" href="Strategic_01Movement_8cpp.html#6720dacedc20203e6e0e7a61d24dd774">GetFinalWaypoint</a>( pGroup );
<a name="l05592"></a>05592                         Assert( pWaypoint );
<a name="l05593"></a>05593                         ubDestSectorID = (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)SECTOR( pWaypoint-&gt;<a class="code" href="structWAYPOINT.html#3e93b9f60301737519c61ab5816573ce">x</a>, pWaypoint-&gt;<a class="code" href="structWAYPOINT.html#dda8b6a82915d635e96417b928a81d6f">y</a> );
<a name="l05594"></a>05594                         <a class="code" href="Strategic_01Movement_8cpp.html#a19abf3a81cb603e5721889a627be6af">SetEnemyGroupSector</a>( pGroup, (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)SECTOR( pGroup-&gt;ubSectorX, pGroup-&gt;ubSectorY ) );
<a name="l05595"></a>05595                         <a class="code" href="Strategic_01AI_8cpp.html#3865b55f00d5df7710bd4325ddf83bfc">MoveSAIGroupToSector</a>( &amp;pGroup, ubDestSectorID, <a class="code" href="Strategic_01AI_8cpp.html#2282261c2887b2d4d1183cf5249e1529a4d4adb90ccd2b0775d4429cac476900">EVASIVE</a>, pGroup-&gt;pEnemyGroup-&gt;ubIntention );
<a name="l05596"></a>05596                         ubNumGroupsRedirected++;
<a name="l05597"></a>05597                   }
<a name="l05598"></a>05598             }
<a name="l05599"></a>05599             pGroup = pGroup-&gt;<a class="code" href="structGROUP.html#6ebc46983b08a66450c23516af0a3f72">next</a>;
<a name="l05600"></a>05600       }
<a name="l05601"></a>05601       <span class="keywordflow">if</span>( ubNumGroupsRedirected )
<a name="l05602"></a>05602       {
<a name="l05603"></a>05603             <a class="code" href="message_8cpp.html#818e47bc59bd5a5755f06ec51cd74928">ScreenMsg</a>( FONT_LTBLUE, MSG_BETAVERSION, L<span class="stringliteral">"Test message for new feature:  %d enemy groups were redirected away from moving through sector %c%d.  Please don't report unless this number is greater than 5."</span>,
<a name="l05604"></a>05604                   ubNumGroupsRedirected, ubSectorY + <span class="charliteral">'A'</span> - 1, ubSectorX );
<a name="l05605"></a>05605       }
<a name="l05606"></a>05606       <span class="keywordflow">return</span> ubNumGroupsRedirected;
<a name="l05607"></a>05607 }
<a name="l05608"></a>05608 
<a name="l05609"></a>05609 <span class="comment">//when the SAI compositions change, it is necessary to call this function upon version load,</span>
<a name="l05610"></a>05610 <span class="comment">//to reflect the changes of the compositions to the sector that haven't been visited yet.</span>
<a name="l05611"></a><a class="code" href="Strategic_01AI_8cpp.html#02069a813bd2498057799d302da2c08f">05611</a> <span class="keywordtype">void</span> <a class="code" href="Strategic_01AI_8cpp.html#02069a813bd2498057799d302da2c08f">ReinitializeUnvisitedGarrisons</a>()
<a name="l05612"></a>05612 {
<a name="l05613"></a>05613       <a class="code" href="structSECTORINFO.html">SECTORINFO</a> *pSector;
<a name="l05614"></a>05614       <a class="code" href="structARMY__COMPOSITION.html">ARMY_COMPOSITION</a> *pArmyComp;
<a name="l05615"></a>05615       <a class="code" href="structGROUP.html">GROUP</a> *pGroup;
<a name="l05616"></a>05616       <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a> i, cnt, iEliteChance, iAdminChance;
<a name="l05617"></a>05617       
<a name="l05618"></a>05618       <span class="comment">//Recreate the compositions</span>
<a name="l05619"></a>05619       memcpy( <a class="code" href="AI_01Viewer_8cpp.html#77e448d1f208bd120f861571e6d0098f">gArmyComp</a>, <a class="code" href="Strategic_01AI_8cpp.html#ea7005fc7ef74a7dbbc1cb66d6520a89">gOrigArmyComp</a>, <a class="code" href="Strategic_01AI_8h.html#a9908284c0827729f14cf9b2489e1479d2a0278d1458eaa8c2bb99d2d4b55f00">NUM_ARMY_COMPOSITIONS</a> * <span class="keyword">sizeof</span>( <a class="code" href="structARMY__COMPOSITION.html">ARMY_COMPOSITION</a> ) );
<a name="l05620"></a>05620       <a class="code" href="Strategic_01AI_8cpp.html#d07e8dc3510ffd7b3bf0713c0a152ae2">EvolveQueenPriorityPhase</a>( TRUE );
<a name="l05621"></a>05621 
<a name="l05622"></a>05622       <span class="comment">//Go through each unvisited sector and recreate the garrison forces based on </span>
<a name="l05623"></a>05623       <span class="comment">//the desired population.</span>
<a name="l05624"></a>05624       <span class="keywordflow">for</span>( i = 0; i &lt; giGarrisonArraySize; i++ )
<a name="l05625"></a>05625       {
<a name="l05626"></a>05626             <span class="keywordflow">if</span>( <a class="code" href="AI_01Viewer_8cpp.html#a9f940d7f3a6d6698bfaeb7c747d74a9">gGarrisonGroup</a>[ i ].ubComposition &gt;= <a class="code" href="Strategic_01AI_8h.html#a9908284c0827729f14cf9b2489e14796cbe0f336c72d76846995060b0336228">LEVEL1_DEFENCE</a> &amp;&amp; <a class="code" href="AI_01Viewer_8cpp.html#a9f940d7f3a6d6698bfaeb7c747d74a9">gGarrisonGroup</a>[ i ].ubComposition &lt;= <a class="code" href="Strategic_01AI_8h.html#a9908284c0827729f14cf9b2489e1479af824648f2c39e0defaa7dc6488a18b6">LEVEL3_DEFENCE</a> )
<a name="l05627"></a>05627             { <span class="comment">//These 3 compositions make up the perimeter around Meduna.  The existance of these are based on the</span>
<a name="l05628"></a>05628                   <span class="comment">//difficulty level, and we don't want to reset these anyways, due to the fact that many of the reinforcements</span>
<a name="l05629"></a>05629                   <span class="comment">//come from these sectors, and it could potentially add upwards of 150 extra troops which would seriously</span>
<a name="l05630"></a>05630                   <span class="comment">//unbalance the difficulty.</span>
<a name="l05631"></a>05631                   <span class="keywordflow">continue</span>;
<a name="l05632"></a>05632             }
<a name="l05633"></a>05633             pSector = &amp;<a class="code" href="Campaign_01Types_8h.html#d83c6f699f17a47cf6a662c91d959126">SectorInfo</a>[ <a class="code" href="AI_01Viewer_8cpp.html#a9f940d7f3a6d6698bfaeb7c747d74a9">gGarrisonGroup</a>[ i ].<a class="code" href="structGARRISON__GROUP.html#fb130d3c9211374d87a85cca787fe0dd">ubSectorID</a> ];
<a name="l05634"></a>05634             pArmyComp = &amp;<a class="code" href="AI_01Viewer_8cpp.html#77e448d1f208bd120f861571e6d0098f">gArmyComp</a>[ gGarrisonGroup[ i ].ubComposition ];
<a name="l05635"></a>05635             <span class="keywordflow">if</span>( !(pSector-&gt;<a class="code" href="structSECTORINFO.html#ee318422648cb0f466777759ced21e13">uiFlags</a> &amp; SF_ALREADY_VISITED) )
<a name="l05636"></a>05636             {
<a name="l05637"></a>05637                   pSector-&gt;<a class="code" href="structSECTORINFO.html#d7d5ee63c0dc2ad3164c83541bd80906">ubNumAdmins</a> = 0;
<a name="l05638"></a>05638                   pSector-&gt;<a class="code" href="structSECTORINFO.html#e36540b93256cfa71e45382f133d3696">ubNumTroops</a> = 0;
<a name="l05639"></a>05639                   pSector-&gt;<a class="code" href="structSECTORINFO.html#3c5312672399c40ec5a395e8bcfb0104">ubNumElites</a> = 0;
<a name="l05640"></a>05640                   <span class="keywordflow">if</span>( <a class="code" href="AI_01Viewer_8cpp.html#38284bd39764812fb8a27fe4d3d2b0cd">gfQueenAIAwake</a> )
<a name="l05641"></a>05641                   {
<a name="l05642"></a>05642                         cnt = pArmyComp-&gt;<a class="code" href="structARMY__COMPOSITION.html#164db6c6c30629f43d42469671367c86">bDesiredPopulation</a>;
<a name="l05643"></a>05643                   }
<a name="l05644"></a>05644                   <span class="keywordflow">else</span>
<a name="l05645"></a>05645                   {
<a name="l05646"></a>05646                         cnt = pArmyComp-&gt;<a class="code" href="structARMY__COMPOSITION.html#0ad2c386ad91eab0cad973b734a30e3a">bStartPopulation</a>;
<a name="l05647"></a>05647                   }
<a name="l05648"></a>05648 
<a name="l05649"></a>05649                   <span class="keywordflow">if</span>( <a class="code" href="AI_01Viewer_8cpp.html#a9f940d7f3a6d6698bfaeb7c747d74a9">gGarrisonGroup</a>[ i ].ubPendingGroupID )
<a name="l05650"></a>05650                   { <span class="comment">//if the garrison has reinforcements on route, then subtract the number of </span>
<a name="l05651"></a>05651                         <span class="comment">//reinforcements from the value we reset the size of the garrison.  This is to </span>
<a name="l05652"></a>05652                         <span class="comment">//prevent overfilling the group.</span>
<a name="l05653"></a>05653                         pGroup = <a class="code" href="Strategic_01Movement_8cpp.html#33138746a238bdc5c684e9aa2c86691c">GetGroup</a>( <a class="code" href="AI_01Viewer_8cpp.html#a9f940d7f3a6d6698bfaeb7c747d74a9">gGarrisonGroup</a>[ i ].ubPendingGroupID );
<a name="l05654"></a>05654                         <span class="keywordflow">if</span>( pGroup )
<a name="l05655"></a>05655                         {
<a name="l05656"></a>05656                               cnt -= pGroup-&gt;<a class="code" href="structGROUP.html#2a98517c894019ee794e04ea05d1aeaf">ubGroupSize</a>;
<a name="l05657"></a>05657                               cnt = max( cnt, 0 );
<a name="l05658"></a>05658                         }
<a name="l05659"></a>05659                   }
<a name="l05660"></a>05660                   
<a name="l05661"></a>05661                   iEliteChance = pArmyComp-&gt;<a class="code" href="structARMY__COMPOSITION.html#2b7c33a62b43654cd8f66ebe2e7afaa0">bElitePercentage</a>;
<a name="l05662"></a>05662                   iAdminChance = pArmyComp-&gt;<a class="code" href="structARMY__COMPOSITION.html#0ea39c434cb665d1e66172eba1d3c256">bAdminPercentage</a>;
<a name="l05663"></a>05663                   <span class="keywordflow">if</span>( iAdminChance &amp;&amp; !<a class="code" href="AI_01Viewer_8cpp.html#38284bd39764812fb8a27fe4d3d2b0cd">gfQueenAIAwake</a> &amp;&amp; cnt )
<a name="l05664"></a>05664                   {
<a name="l05665"></a>05665                         pSector-&gt;<a class="code" href="structSECTORINFO.html#d7d5ee63c0dc2ad3164c83541bd80906">ubNumAdmins</a> = iAdminChance * cnt / 100;
<a name="l05666"></a>05666                   }
<a name="l05667"></a>05667                   <span class="keywordflow">else</span> <span class="keywordflow">while</span>( cnt-- )
<a name="l05668"></a>05668                   { <span class="comment">//for each person, randomly determine the types of each soldier.</span>
<a name="l05669"></a>05669                         <span class="keywordflow">if</span>( <a class="code" href="Random_8cpp.html#742221657b584d8416ada22fa8ff23dd">Chance</a>( iEliteChance ) )
<a name="l05670"></a>05670                         {
<a name="l05671"></a>05671                               pSector-&gt;<a class="code" href="structSECTORINFO.html#3c5312672399c40ec5a395e8bcfb0104">ubNumElites</a>++;
<a name="l05672"></a>05672                         }
<a name="l05673"></a>05673                         <span class="keywordflow">else</span>
<a name="l05674"></a>05674                         {
<a name="l05675"></a>05675                               pSector-&gt;<a class="code" href="structSECTORINFO.html#e36540b93256cfa71e45382f133d3696">ubNumTroops</a>++;
<a name="l05676"></a>05676                         }
<a name="l05677"></a>05677                   }
<a name="l05678"></a>05678             }
<a name="l05679"></a>05679       }
<a name="l05680"></a>05680 }
<a name="l05681"></a>05681 
<a name="l05682"></a><a class="code" href="Strategic_01AI_8cpp.html#5876be07ca1ac517de4789e9f778dd27">05682</a> <a class="code" href="structGROUP.html">GROUP</a>* <a class="code" href="Strategic_01AI_8cpp.html#5876be07ca1ac517de4789e9f778dd27">FindPendingGroupForGarrisonSector</a>( <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubSectorID )
<a name="l05683"></a>05683 {
<a name="l05684"></a>05684       <a class="code" href="structGROUP.html">GROUP</a> *pGroup;
<a name="l05685"></a>05685       <a class="code" href="structSECTORINFO.html">SECTORINFO</a> *pSector;
<a name="l05686"></a>05686       pSector = &amp;<a class="code" href="Campaign_01Types_8h.html#d83c6f699f17a47cf6a662c91d959126">SectorInfo</a>[ ubSectorID ];
<a name="l05687"></a>05687       <span class="keywordflow">if</span>( pSector-&gt;<a class="code" href="structSECTORINFO.html#9465931dad0e164d7d47814b66e454f0">ubGarrisonID</a> != NO_GARRISON )
<a name="l05688"></a>05688       {
<a name="l05689"></a>05689             <span class="keywordflow">if</span>( <a class="code" href="AI_01Viewer_8cpp.html#a9f940d7f3a6d6698bfaeb7c747d74a9">gGarrisonGroup</a>[ pSector-&gt;<a class="code" href="structSECTORINFO.html#9465931dad0e164d7d47814b66e454f0">ubGarrisonID</a> ].ubPendingGroupID )
<a name="l05690"></a>05690             {
<a name="l05691"></a>05691                   pGroup = <a class="code" href="Strategic_01Movement_8cpp.html#33138746a238bdc5c684e9aa2c86691c">GetGroup</a>( gGarrisonGroup[ pSector-&gt;<a class="code" href="structSECTORINFO.html#9465931dad0e164d7d47814b66e454f0">ubGarrisonID</a> ].ubPendingGroupID );
<a name="l05692"></a>05692                   Assert( pGroup );
<a name="l05693"></a>05693                   <span class="keywordflow">return</span> pGroup;
<a name="l05694"></a>05694             }
<a name="l05695"></a>05695       }
<a name="l05696"></a>05696       <span class="keywordflow">return</span> NULL;
<a name="l05697"></a>05697 }
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Sat Sep 9 13:49:04 2006 for Build by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.4.7 </small></address>
</body>
</html>
