<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>Build: Strategic Event Handler.cpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.4.7 -->
<div class="tabs">
  <ul>
    <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="classes.html"><span>Classes</span></a></li>
    <li id="current"><a href="files.html"><span>Files</span></a></li>
    <li><a href="dirs.html"><span>Directories</span></a></li>
    <li>
      <form action="search.php" method="get">
        <table cellspacing="0" cellpadding="0" border="0">
          <tr>
            <td><label>&nbsp;<u>S</u>earch&nbsp;for&nbsp;</label></td>
            <td><input type="text" name="query" value="" size="20" accesskey="s"/></td>
          </tr>
        </table>
      </form>
    </li>
  </ul></div>
<div class="tabs">
  <ul>
    <li><a href="files.html"><span>File&nbsp;List</span></a></li>
    <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
  </ul></div>
<div class="nav">
<a class="el" href="dir_3179ea33d55a76dc38212d9eab798728.html">export</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_e5664b4b56927c8728eb3192fa60e338.html">hdc2</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_1eb12a41a47efb9efcd82fa98f4f4dbd.html">FTP</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_80cc1f21a78ab7941088ea567f236150.html">ja2src</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_994ab287602efefceafe55287a3657d6.html">Build</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_5aba590d477d4824a9090ab3f8850834.html">Strategic</a></div>
<h1>Strategic Event Handler.cpp</h1><a href="Strategic_01Event_01Handler_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="preprocessor">#ifdef PRECOMPILEDHEADERS</span>
<a name="l00002"></a>00002 <span class="preprocessor"></span><span class="preprocessor">      #include "<a class="code" href="Strategic_01All_8h.html">Strategic All.h</a>"</span>
<a name="l00003"></a>00003 <span class="preprocessor">#else</span>
<a name="l00004"></a>00004 <span class="preprocessor"></span><span class="preprocessor">      #include "<a class="code" href="Strategic_01Event_01Handler_8h.html">Strategic Event Handler.h</a>"</span>
<a name="l00005"></a>00005 <span class="preprocessor">      #include "<a class="code" href="MemMan_8h.html">MemMan.h</a>"</span>
<a name="l00006"></a>00006 <span class="preprocessor">      #include "<a class="code" href="message_8h.html">message.h</a>"</span>
<a name="l00007"></a>00007 <span class="preprocessor">      #include "<a class="code" href="Item_01Types_8h.html">Item Types.h</a>"</span>
<a name="l00008"></a>00008 <span class="preprocessor">      #include "<a class="code" href="Items_8h.html">Items.h</a>"</span>
<a name="l00009"></a>00009 <span class="preprocessor">      #include "<a class="code" href="Handle_01Items_8h.html">Handle Items.h</a>"</span>
<a name="l00010"></a>00010 <span class="preprocessor">      #include "<a class="code" href="LaptopSave_8h.html">LaptopSave.h</a>"</span>
<a name="l00011"></a>00011 <span class="preprocessor">      #include "<a class="code" href="Tactical_01Save_8h.html">Tactical Save.h</a>"</span>
<a name="l00012"></a>00012 <span class="preprocessor">      #include "StrategicMap.h"</span>
<a name="l00013"></a>00013 <span class="preprocessor">      #include "<a class="code" href="Quests_8h.html">Quests.h</a>"</span>
<a name="l00014"></a>00014 <span class="preprocessor">      #include "<a class="code" href="Soldier_01Profile_8h.html">Soldier Profile.h</a>"</span>
<a name="l00015"></a>00015 <span class="preprocessor">      #include "<a class="code" href="Game_01Event_01Hook_8h.html">Game Event Hook.h</a>"</span>
<a name="l00016"></a>00016 <span class="preprocessor">      #include "<a class="code" href="Game_01Clock_8h.html">Game Clock.h</a>"</span>
<a name="l00017"></a>00017 <span class="preprocessor">      #include "Interface Dialogue.h"</span>
<a name="l00018"></a>00018 <span class="preprocessor">      #include "Random.h"</span>
<a name="l00019"></a>00019 <span class="preprocessor">      #include "<a class="code" href="Overhead_8h.html">Overhead.h</a>"</span>
<a name="l00020"></a>00020 <span class="preprocessor">      #include "<a class="code" href="Strategic_01Town_01Loyalty_8h.html">Strategic Town Loyalty.h</a>"</span>
<a name="l00021"></a>00021 <span class="preprocessor">      #include "<a class="code" href="Soldier_01Init_01List_8h.html">Soldier Init List.h</a>"</span>
<a name="l00022"></a>00022 <span class="preprocessor">      #include "<a class="code" href="SaveLoadMap_8h.html">SaveLoadMap.h</a>"</span>
<a name="l00023"></a>00023 <span class="preprocessor">      #include "Worldman.h"</span>
<a name="l00024"></a>00024 <span class="preprocessor">      #include "<a class="code" href="Soldier_01Create_8h.html">Soldier Create.h</a>"</span>
<a name="l00025"></a>00025 <span class="preprocessor">      #include "<a class="code" href="Soldier_01Add_8h.html">Soldier Add.h</a>"</span>
<a name="l00026"></a>00026 <span class="preprocessor">      #include "Opplist.h"</span>
<a name="l00027"></a>00027 <span class="preprocessor">      #include "Renderworld.h"</span>
<a name="l00028"></a>00028 <span class="preprocessor">      #include "<a class="code" href="Soldier_01Profile_8h.html">Soldier Profile.h</a>"</span>
<a name="l00029"></a>00029 <span class="preprocessor">      #include "<a class="code" href="email_8h.html">email.h</a>"</span>
<a name="l00030"></a>00030 <span class="preprocessor">#endif</span>
<a name="l00031"></a>00031 <span class="preprocessor"></span><span class="preprocessor">#include "<a class="code" href="BobbyRMailOrder_8h.html">BobbyRMailOrder.h</a>"</span>
<a name="l00032"></a>00032 
<a name="l00033"></a>00033 <span class="preprocessor">#define           MEDUNA_ITEM_DROP_OFF_GRIDNO               10959</span>
<a name="l00034"></a>00034 <span class="preprocessor"></span><span class="preprocessor">#define           MEDUNA_ITEM_DROP_OFF_SECTOR_X       3</span>
<a name="l00035"></a>00035 <span class="preprocessor"></span><span class="preprocessor">#define           MEDUNA_ITEM_DROP_OFF_SECTOR_Y       14</span>
<a name="l00036"></a>00036 <span class="preprocessor"></span><span class="preprocessor">#define           MEDUNA_ITEM_DROP_OFF_SECTOR_Z       0</span>
<a name="l00037"></a>00037 <span class="preprocessor"></span>
<a name="l00038"></a>00038 
<a name="l00039"></a>00039 <span class="keyword">extern</span> <a class="code" href="Types_8h.html#30f500129d8c688af07726d5d34ce52d">INT16</a> <a class="code" href="Strategic_01Event_01Handler_8cpp.html#c86ef993ba6b9d7aa987639aeff5edc5">gsRobotGridNo</a>;
<a name="l00040"></a>00040 
<a name="l00041"></a>00041 
<a name="l00042"></a><a class="code" href="Strategic_01Event_01Handler_8cpp.html#d2162c7d8c66a6a360c38e8bf6aeb9b4">00042</a> <a class="code" href="Types_8h.html#e1e6edbbc26d6fbc71a90190d0266018">UINT32</a> <a class="code" href="Strategic_01Event_01Handler_8cpp.html#d2162c7d8c66a6a360c38e8bf6aeb9b4">guiPabloExtraDaysBribed</a> = 0;
<a name="l00043"></a>00043 
<a name="l00044"></a><a class="code" href="Strategic_01Event_01Handler_8h.html#df871888aadad702be6d55074e0998fc">00044</a> <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>       <a class="code" href="Strategic_01Event_01Handler_8cpp.html#df871888aadad702be6d55074e0998fc">gubCambriaMedicalObjects</a>;
<a name="l00045"></a>00045 
<a name="l00046"></a>00046 
<a name="l00047"></a>00047 <span class="keywordtype">void</span> <a class="code" href="Strategic_01Event_01Handler_8cpp.html#d42b1520f13e8f601195e5adf94ef298">DropOffItemsInMeduna</a>( <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubOrderNum );
<a name="l00048"></a>00048 
<a name="l00049"></a><a class="code" href="Strategic_01Event_01Handler_8h.html#917a0912f17e1110bfe9a6294fc48b51">00049</a> <span class="keywordtype">void</span> <a class="code" href="Strategic_01Event_01Handler_8cpp.html#917a0912f17e1110bfe9a6294fc48b51">BobbyRayPurchaseEventCallback</a>( <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubOrderID )
<a name="l00050"></a>00050 {
<a name="l00051"></a>00051       <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> i,j;
<a name="l00052"></a>00052       <a class="code" href="Types_8h.html#09f1a1fb2293e33483cc8d44aefb1eb1">UINT16</a>      usItem;
<a name="l00053"></a>00053       <a class="code" href="structOBJECTTYPE.html">OBJECTTYPE</a>        Object;
<a name="l00054"></a>00054       <a class="code" href="Types_8h.html#09f1a1fb2293e33483cc8d44aefb1eb1">UINT16</a> usMapPos, usStandardMapPos;
<a name="l00055"></a>00055       <a class="code" href="Types_8h.html#09f1a1fb2293e33483cc8d44aefb1eb1">UINT16</a> usNumberOfItems;
<a name="l00056"></a>00056       <a class="code" href="Types_8h.html#112e3146cb38b6ee95e64d85842e380a">BOOLEAN</a>     fSectorLoaded = FALSE;
<a name="l00057"></a>00057       <a class="code" href="Types_8h.html#09f1a1fb2293e33483cc8d44aefb1eb1">UINT16</a>      usTotalNumberOfItemTypes;
<a name="l00058"></a>00058       <a class="code" href="Types_8h.html#e1e6edbbc26d6fbc71a90190d0266018">UINT32</a>      uiCount = 0,uiStolenCount = 0;
<a name="l00059"></a>00059       <span class="keyword">static</span> <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubShipmentsSinceNoBribes = 0;
<a name="l00060"></a>00060       <a class="code" href="Types_8h.html#e1e6edbbc26d6fbc71a90190d0266018">UINT32</a>      uiChanceOfTheft;
<a name="l00061"></a>00061       <a class="code" href="Types_8h.html#112e3146cb38b6ee95e64d85842e380a">BOOLEAN</a>           fPablosStoleSomething = FALSE;
<a name="l00062"></a>00062       <a class="code" href="Types_8h.html#112e3146cb38b6ee95e64d85842e380a">BOOLEAN</a>           fPablosStoleLastItem = FALSE;
<a name="l00063"></a>00063       <a class="code" href="structOBJECTTYPE.html">OBJECTTYPE</a>  *pObject=NULL;
<a name="l00064"></a>00064       <a class="code" href="structOBJECTTYPE.html">OBJECTTYPE</a>  *pStolenObject=NULL;
<a name="l00065"></a>00065       <a class="code" href="Types_8h.html#112e3146cb38b6ee95e64d85842e380a">BOOLEAN</a>                 fThisShipmentIsFromJohnKulba = FALSE;     <span class="comment">//if it is, dont add an email</span>
<a name="l00066"></a>00066       <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>       ubItemsDelivered;
<a name="l00067"></a>00067       <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>       ubTempNumItems;
<a name="l00068"></a>00068       <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>       ubItemsPurchased;
<a name="l00069"></a>00069 
<a name="l00070"></a>00070       usStandardMapPos = BOBBYR_SHIPPING_DEST_GRIDNO;
<a name="l00071"></a>00071 
<a name="l00072"></a>00072       <span class="comment">// if the delivery is for meduna, drop the items off there instead</span>
<a name="l00073"></a>00073       <span class="keywordflow">if</span>( <a class="code" href="BobbyRMailOrder_8cpp.html#9753076f963c32ac9de3b35e7ee8a3c5">gpNewBobbyrShipments</a>[ ubOrderID ].fActive &amp;&amp; <a class="code" href="BobbyRMailOrder_8cpp.html#9753076f963c32ac9de3b35e7ee8a3c5">gpNewBobbyrShipments</a>[ ubOrderID ].ubDeliveryLoc == <a class="code" href="BobbyRMailOrder_8h.html#de9ca5088d171ad20b4c237f1c2d6260fd5f06281bda068f4ea914d355a26032">BR_MEDUNA</a> )
<a name="l00074"></a>00074       {
<a name="l00075"></a>00075             <a class="code" href="Strategic_01Event_01Handler_8cpp.html#d42b1520f13e8f601195e5adf94ef298">DropOffItemsInMeduna</a>( ubOrderID );
<a name="l00076"></a>00076             <span class="keywordflow">return</span>;
<a name="l00077"></a>00077       }
<a name="l00078"></a>00078 
<a name="l00079"></a>00079       <span class="keywordflow">if</span> (<a class="code" href="Quests_8cpp.html#6744b59d27bf2791d0c2fefe18e548d3">CheckFact</a>( <a class="code" href="Quests_8h.html#aead3e57f613f07868a1b2afb6b943f1ca6a48ff3104f1ffa339e9576d8cf194">FACT_NEXT_PACKAGE_CAN_BE_LOST</a>, 0 ))
<a name="l00080"></a>00080       {
<a name="l00081"></a>00081             <a class="code" href="Quests_8cpp.html#367aad061aefa5a73a4ac3fda10511b3">SetFactFalse</a>( <a class="code" href="Quests_8h.html#aead3e57f613f07868a1b2afb6b943f1ca6a48ff3104f1ffa339e9576d8cf194">FACT_NEXT_PACKAGE_CAN_BE_LOST</a> );
<a name="l00082"></a>00082             <span class="keywordflow">if</span> (<a class="code" href="Random_8cpp.html#49f938d1313ab6ef09ac6223a16ac334">Random</a>( 100 ) &lt; 50)
<a name="l00083"></a>00083             {
<a name="l00084"></a>00084                   <span class="comment">// lose the whole shipment!</span>
<a name="l00085"></a>00085                   <a class="code" href="BobbyRMailOrder_8cpp.html#9753076f963c32ac9de3b35e7ee8a3c5">gpNewBobbyrShipments</a>[ ubOrderID ].<a class="code" href="structNewBobbyRayOrderStruct.html#873da9e8bc226b20c83084970e3a4951">fActive</a> = FALSE;
<a name="l00086"></a>00086                   <a class="code" href="Quests_8cpp.html#d7278c1ec0f9cc2ac9af20f8a6b446db">SetFactTrue</a>( <a class="code" href="Quests_8h.html#aead3e57f613f07868a1b2afb6b943f196d91ff8a6bfda4af344ff8d56a6c713">FACT_LAST_SHIPMENT_CRASHED</a> );
<a name="l00087"></a>00087                   <span class="keywordflow">return</span>;
<a name="l00088"></a>00088             }
<a name="l00089"></a>00089 
<a name="l00090"></a>00090       }
<a name="l00091"></a>00091       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="Quests_8cpp.html#6744b59d27bf2791d0c2fefe18e548d3">CheckFact</a>( <a class="code" href="Quests_8h.html#aead3e57f613f07868a1b2afb6b943f15023cfb049a1a5758c39f26106f20961">FACT_NEXT_PACKAGE_CAN_BE_DELAYED</a>, 0 ))
<a name="l00092"></a>00092       {
<a name="l00093"></a>00093             <span class="comment">// shipment went to wrong airport... reroute all items to a temporary</span>
<a name="l00094"></a>00094             <span class="comment">// gridno to represent the other airport (and damage them)</span>
<a name="l00095"></a>00095             <a class="code" href="Quests_8cpp.html#d7278c1ec0f9cc2ac9af20f8a6b446db">SetFactTrue</a>( <a class="code" href="Quests_8h.html#aead3e57f613f07868a1b2afb6b943f1136c85c0829195f4feed6a8f0b5333a2">FACT_LAST_SHIPMENT_WENT_TO_WRONG_AIRPORT</a> );    
<a name="l00096"></a>00096             usStandardMapPos = LOST_SHIPMENT_GRIDNO;
<a name="l00097"></a>00097             <a class="code" href="Quests_8cpp.html#367aad061aefa5a73a4ac3fda10511b3">SetFactFalse</a>( <a class="code" href="Quests_8h.html#aead3e57f613f07868a1b2afb6b943f15023cfb049a1a5758c39f26106f20961">FACT_NEXT_PACKAGE_CAN_BE_DELAYED</a> );
<a name="l00098"></a>00098       }
<a name="l00099"></a>00099       <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( (<a class="code" href="Strategic_01Town_01Loyalty_8cpp.html#53aef3e8e8681f01397608fbb9dcf56e">gTownLoyalty</a>[ <a class="code" href="mapscreen_8h.html#4d1dc70bee62b945929c96dfafebe1052d90315dc5189006a917572886dd5919">DRASSEN</a> ].ubRating &lt; 20) || <a class="code" href="strategic_8cpp.html#6f48fb0ea28e3d4889423290f1a6ede8">StrategicMap</a>[ CALCULATE_STRATEGIC_INDEX( 13, MAP_ROW_B ) ].fEnemyControlled )
<a name="l00100"></a>00100       {
<a name="l00101"></a>00101             <span class="comment">// loss of the whole shipment</span>
<a name="l00102"></a>00102             <a class="code" href="BobbyRMailOrder_8cpp.html#9753076f963c32ac9de3b35e7ee8a3c5">gpNewBobbyrShipments</a>[ ubOrderID ].<a class="code" href="structNewBobbyRayOrderStruct.html#873da9e8bc226b20c83084970e3a4951">fActive</a> = FALSE;
<a name="l00103"></a>00103 
<a name="l00104"></a>00104             <a class="code" href="Quests_8cpp.html#d7278c1ec0f9cc2ac9af20f8a6b446db">SetFactTrue</a>( <a class="code" href="Quests_8h.html#aead3e57f613f07868a1b2afb6b943f1054d1467dec3c1ee6de930bb0f7957fc">FACT_AGENTS_PREVENTED_SHIPMENT</a> );
<a name="l00105"></a>00105             <span class="keywordflow">return</span>;
<a name="l00106"></a>00106       }
<a name="l00107"></a>00107 
<a name="l00108"></a>00108       <span class="comment">//Get the number of item types</span>
<a name="l00109"></a>00109       usTotalNumberOfItemTypes = <a class="code" href="BobbyRMailOrder_8cpp.html#9753076f963c32ac9de3b35e7ee8a3c5">gpNewBobbyrShipments</a>[ ubOrderID ].<a class="code" href="structNewBobbyRayOrderStruct.html#d65ef400b66e1541bb66fb925ae17add">ubNumberPurchases</a>;
<a name="l00110"></a>00110 
<a name="l00111"></a>00111       <span class="comment">//Must get the total number of items ( all item types plus how many of each item type ordered )</span>
<a name="l00112"></a>00112       usNumberOfItems = 0;
<a name="l00113"></a>00113       <span class="keywordflow">for</span>(i=0; i&lt;<a class="code" href="BobbyRMailOrder_8cpp.html#9753076f963c32ac9de3b35e7ee8a3c5">gpNewBobbyrShipments</a>[ ubOrderID ].<a class="code" href="structNewBobbyRayOrderStruct.html#d65ef400b66e1541bb66fb925ae17add">ubNumberPurchases</a>; i++)
<a name="l00114"></a>00114       {
<a name="l00115"></a>00115             <span class="comment">// Count how many items were purchased</span>
<a name="l00116"></a>00116             usNumberOfItems += <a class="code" href="BobbyRMailOrder_8cpp.html#9753076f963c32ac9de3b35e7ee8a3c5">gpNewBobbyrShipments</a>[ ubOrderID ].BobbyRayPurchase[i].ubNumberPurchased;
<a name="l00117"></a>00117 
<a name="l00118"></a>00118             <span class="comment">//if any items are AutoMags</span>
<a name="l00119"></a>00119             <span class="keywordflow">if</span>( <a class="code" href="BobbyRMailOrder_8cpp.html#9753076f963c32ac9de3b35e7ee8a3c5">gpNewBobbyrShipments</a>[ ubOrderID ].BobbyRayPurchase[i].usItemIndex == <a class="code" href="Item_01Types_8h.html#572f9555da77e1b21f4cd40aed8d20f4a6c861193b2e52c7623e2165dcd4027d">AUTOMAG_III</a> )
<a name="l00120"></a>00120             {
<a name="l00121"></a>00121                   <span class="comment">//This shipment is from John Kulba, dont add an email from bobby ray</span>
<a name="l00122"></a>00122                   fThisShipmentIsFromJohnKulba = TRUE;
<a name="l00123"></a>00123             }
<a name="l00124"></a>00124       }
<a name="l00125"></a>00125 
<a name="l00126"></a>00126       <span class="comment">// determine if the sector is loaded</span>
<a name="l00127"></a>00127       <span class="keywordflow">if</span>( ( <a class="code" href="strategicmap_8cpp.html#49d9aed144a633fda4ba1990f002d703">gWorldSectorX</a> == BOBBYR_SHIPPING_DEST_SECTOR_X ) &amp;&amp; ( <a class="code" href="strategicmap_8cpp.html#ea322310ced0e35ee18a2ee7b32aac5b">gWorldSectorY</a> == BOBBYR_SHIPPING_DEST_SECTOR_Y ) &amp;&amp; ( <a class="code" href="strategicmap_8cpp.html#da715721a8ceedd42acf6ddb33e63ce0">gbWorldSectorZ</a> == BOBBYR_SHIPPING_DEST_SECTOR_Z ) )
<a name="l00128"></a>00128             fSectorLoaded = TRUE;
<a name="l00129"></a>00129       <span class="keywordflow">else</span>
<a name="l00130"></a>00130             fSectorLoaded = FALSE;
<a name="l00131"></a>00131 
<a name="l00132"></a>00132       <span class="comment">// set crate to closed!</span>
<a name="l00133"></a>00133       <span class="keywordflow">if</span> ( fSectorLoaded )
<a name="l00134"></a>00134       {
<a name="l00135"></a>00135             <a class="code" href="Structure_01Wrap_8cpp.html#a189110b98431949966c24f13afe261f">SetOpenableStructureToClosed</a>( BOBBYR_SHIPPING_DEST_GRIDNO, 0 );
<a name="l00136"></a>00136       }
<a name="l00137"></a>00137       <span class="keywordflow">else</span>
<a name="l00138"></a>00138       {
<a name="l00139"></a>00139             <a class="code" href="SaveLoadMap_8cpp.html#9050febf7079af325a50a8bb9e4168d5">ChangeStatusOfOpenableStructInUnloadedSector</a>( BOBBYR_SHIPPING_DEST_SECTOR_X, BOBBYR_SHIPPING_DEST_SECTOR_Y, BOBBYR_SHIPPING_DEST_SECTOR_Z, BOBBYR_SHIPPING_DEST_GRIDNO, FALSE );
<a name="l00140"></a>00140       }
<a name="l00141"></a>00141 
<a name="l00142"></a>00142       <span class="comment">//if we are NOT currently in the right sector</span>
<a name="l00143"></a>00143       <span class="keywordflow">if</span>( !fSectorLoaded )
<a name="l00144"></a>00144       {
<a name="l00145"></a>00145             <span class="comment">//build an array of objects to be added</span>
<a name="l00146"></a>00146             pObject = (<a class="code" href="structOBJECTTYPE.html">OBJECTTYPE</a> *) MemAlloc( <span class="keyword">sizeof</span>( <a class="code" href="structOBJECTTYPE.html">OBJECTTYPE</a> ) * usNumberOfItems );
<a name="l00147"></a>00147             pStolenObject = (OBJECTTYPE *) MemAlloc( <span class="keyword">sizeof</span>( OBJECTTYPE ) * usNumberOfItems );
<a name="l00148"></a>00148             <span class="keywordflow">if</span>( pObject == NULL || pStolenObject == NULL)
<a name="l00149"></a>00149                   <span class="keywordflow">return</span>;
<a name="l00150"></a>00150             memset( pObject, 0, <span class="keyword">sizeof</span>( OBJECTTYPE ) * usNumberOfItems );
<a name="l00151"></a>00151             memset( pStolenObject, 0, <span class="keyword">sizeof</span>( OBJECTTYPE ) * usNumberOfItems );
<a name="l00152"></a>00152       }
<a name="l00153"></a>00153 
<a name="l00154"></a>00154       <span class="comment">// check for potential theft</span>
<a name="l00155"></a>00155       <span class="keywordflow">if</span> (<a class="code" href="Quests_8cpp.html#6744b59d27bf2791d0c2fefe18e548d3">CheckFact</a>( <a class="code" href="Quests_8h.html#aead3e57f613f07868a1b2afb6b943f19e5ce5059aba265324c0c2d7da465fb4">FACT_PABLO_WONT_STEAL</a>, 0 ))
<a name="l00156"></a>00156       {
<a name="l00157"></a>00157             uiChanceOfTheft = 0;
<a name="l00158"></a>00158       }
<a name="l00159"></a>00159       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="Quests_8cpp.html#6744b59d27bf2791d0c2fefe18e548d3">CheckFact</a>( <a class="code" href="Quests_8h.html#aead3e57f613f07868a1b2afb6b943f195ef56e476ac8bb9b6ba7283f41d29da">FACT_PABLOS_BRIBED</a>, 0 ))
<a name="l00160"></a>00160       {
<a name="l00161"></a>00161             <span class="comment">// Since Pacos has some money, reduce record of # of shipments since last bribed... </span>
<a name="l00162"></a>00162             ubShipmentsSinceNoBribes /= 2;
<a name="l00163"></a>00163             uiChanceOfTheft = 0;
<a name="l00164"></a>00164       }
<a name="l00165"></a>00165       <span class="keywordflow">else</span>
<a name="l00166"></a>00166       {
<a name="l00167"></a>00167             ubShipmentsSinceNoBribes++;
<a name="l00168"></a>00168             <span class="comment">// this chance might seem high but it's only applied at most to every second item</span>
<a name="l00169"></a>00169             uiChanceOfTheft = 12 + <a class="code" href="Random_8cpp.html#49f938d1313ab6ef09ac6223a16ac334">Random</a>( 4 * ubShipmentsSinceNoBribes );
<a name="l00170"></a>00170       }
<a name="l00171"></a>00171 
<a name="l00172"></a>00172       uiCount=0;
<a name="l00173"></a>00173       <span class="keywordflow">for</span> ( i=0; i&lt;<a class="code" href="BobbyRMailOrder_8cpp.html#9753076f963c32ac9de3b35e7ee8a3c5">gpNewBobbyrShipments</a>[ ubOrderID ].<a class="code" href="structNewBobbyRayOrderStruct.html#d65ef400b66e1541bb66fb925ae17add">ubNumberPurchases</a>; i++ )
<a name="l00174"></a>00174       {
<a name="l00175"></a>00175             <span class="comment">//Get the item</span>
<a name="l00176"></a>00176             usItem = <a class="code" href="BobbyRMailOrder_8cpp.html#9753076f963c32ac9de3b35e7ee8a3c5">gpNewBobbyrShipments</a>[ ubOrderID ].BobbyRayPurchase[i].usItemIndex;
<a name="l00177"></a>00177 
<a name="l00178"></a>00178             <span class="comment">//Create the item</span>
<a name="l00179"></a>00179             <a class="code" href="Items_8cpp.html#153f1fcda178d6758ff8b01cf7999170">CreateItem</a>( usItem, <a class="code" href="BobbyRMailOrder_8cpp.html#9753076f963c32ac9de3b35e7ee8a3c5">gpNewBobbyrShipments</a>[ ubOrderID ].BobbyRayPurchase[i].bItemQuality, &amp;Object );
<a name="l00180"></a>00180 
<a name="l00181"></a>00181             <span class="comment">// if it's a gun</span>
<a name="l00182"></a>00182             <span class="keywordflow">if</span> (<a class="code" href="Item_01Types_8h.html#f9dc4cc7a3a99ad5944940cfb7c82237">Item</a> [ usItem ].usItemClass == IC_GUN )
<a name="l00183"></a>00183             {
<a name="l00184"></a>00184                   <span class="comment">// Empty out the bullets put in by CreateItem().  We now sell all guns empty of bullets.  This is done for BobbyR</span>
<a name="l00185"></a>00185                   <span class="comment">// simply to be consistent with the dealers in Arulco, who must sell guns empty to prevent ammo cheats by players.</span>
<a name="l00186"></a>00186                   Object.<a class="code" href="structOBJECTTYPE.html#d8f322b99df185cfeb027d9e0ec42964">ubGunShotsLeft</a> = 0;
<a name="l00187"></a>00187             }
<a name="l00188"></a>00188 
<a name="l00189"></a>00189             ubItemsDelivered = 0;
<a name="l00190"></a>00190 
<a name="l00191"></a>00191             <span class="comment">//add all the items that were purchased</span>
<a name="l00192"></a>00192             ubItemsPurchased = <a class="code" href="BobbyRMailOrder_8cpp.html#9753076f963c32ac9de3b35e7ee8a3c5">gpNewBobbyrShipments</a>[ ubOrderID ].<a class="code" href="structNewBobbyRayOrderStruct.html#a773ae8afdaeced6fcac990e9da887ec">BobbyRayPurchase</a>[i].<a class="code" href="structBobbyRayPurchaseStruct.html#a7386094f885e465a5409bab949ebfbf">ubNumberPurchased</a>;
<a name="l00193"></a>00193             <span class="keywordflow">for</span>( j=0; j &lt; ubItemsPurchased; j++)
<a name="l00194"></a>00194             {
<a name="l00195"></a>00195                   <span class="comment">// Pablos might steal stuff but only:</span>
<a name="l00196"></a>00196                   <span class="comment">// - if it's one of a group of items</span>
<a name="l00197"></a>00197                   <span class="comment">// - if he didn't steal the previous item in the group (so he never steals &gt; 50%)</span>
<a name="l00198"></a>00198                   <span class="comment">// - if he has been bribed, he only sneaks out stuff which is cheap</span>
<a name="l00199"></a>00199                   <span class="keywordflow">if</span>( fSectorLoaded )
<a name="l00200"></a>00200                   {
<a name="l00201"></a>00201                         <span class="comment">// add ubItemsPurchased to the chance of theft so the chance increases when there are more items of a kind being ordered</span>
<a name="l00202"></a>00202                         <span class="keywordflow">if</span> ( !fPablosStoleLastItem &amp;&amp; uiChanceOfTheft &gt; 0 &amp;&amp; <a class="code" href="Random_8cpp.html#49f938d1313ab6ef09ac6223a16ac334">Random</a>( 100 ) &lt; (uiChanceOfTheft + ubItemsPurchased) )
<a name="l00203"></a>00203                         {
<a name="l00204"></a>00204                               uiStolenCount++;
<a name="l00205"></a>00205                               usMapPos = PABLOS_STOLEN_DEST_GRIDNO; <span class="comment">// off screen!</span>
<a name="l00206"></a>00206                               fPablosStoleSomething = TRUE;
<a name="l00207"></a>00207                               fPablosStoleLastItem = TRUE;
<a name="l00208"></a>00208                         }
<a name="l00209"></a>00209                         <span class="keywordflow">else</span>
<a name="l00210"></a>00210                         {
<a name="l00211"></a>00211                               usMapPos = usStandardMapPos;
<a name="l00212"></a>00212                               fPablosStoleLastItem = FALSE;
<a name="l00213"></a>00213 
<a name="l00214"></a>00214                               <span class="keywordflow">if</span> (usStandardMapPos == LOST_SHIPMENT_GRIDNO)
<a name="l00215"></a>00215                               {
<a name="l00216"></a>00216                                     <span class="comment">// damage the item a random amount!</span>
<a name="l00217"></a>00217                                     Object.<a class="code" href="structOBJECTTYPE.html#aa0827e15c8e54d285d2850ea5ffbb07">bStatus</a>[0] = (<a class="code" href="Types_8h.html#7ebe70ceca856797319175e30bcf003d">INT8</a>) ( ( (70 + <a class="code" href="Random_8cpp.html#49f938d1313ab6ef09ac6223a16ac334">Random</a>( 11 )) * (<a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a>) Object.<a class="code" href="structOBJECTTYPE.html#aa0827e15c8e54d285d2850ea5ffbb07">bStatus</a>[0] ) / 100 );
<a name="l00218"></a>00218                                     <span class="comment">// make damn sure it can't hit 0</span>
<a name="l00219"></a>00219                                     <a class="code" href="Soldier_01Ani_8cpp.html#c294aa65f0375eb6343a2de2a25dafcc">if</a> (Object.<a class="code" href="structOBJECTTYPE.html#aa0827e15c8e54d285d2850ea5ffbb07">bStatus</a>[0] == 0)
<a name="l00220"></a>00220                                     {
<a name="l00221"></a>00221                                           Object.<a class="code" href="structOBJECTTYPE.html#aa0827e15c8e54d285d2850ea5ffbb07">bStatus</a>[0] = 1;
<a name="l00222"></a>00222                                     }
<a name="l00223"></a>00223                                     <a class="code" href="Handle_01Items_8cpp.html#ca7f6f6da97e9a4c2b737296485f5c84">AddItemToPool</a>( usMapPos, &amp;Object, -1, 0, 0, 0 );
<a name="l00224"></a>00224                               }
<a name="l00225"></a>00225                               <span class="keywordflow">else</span>
<a name="l00226"></a>00226                               {
<a name="l00227"></a>00227                                     <span class="comment">// record # delivered for later addition...</span>
<a name="l00228"></a>00228                                     ubItemsDelivered++;
<a name="l00229"></a>00229                               }
<a name="l00230"></a>00230                         }
<a name="l00231"></a>00231                   }
<a name="l00232"></a>00232                   <span class="keywordflow">else</span>
<a name="l00233"></a>00233                   {
<a name="l00234"></a>00234                         <span class="keywordflow">if</span> ( j &gt; 1 &amp;&amp; !fPablosStoleLastItem &amp;&amp; uiChanceOfTheft &gt; 0 &amp;&amp; <a class="code" href="Random_8cpp.html#49f938d1313ab6ef09ac6223a16ac334">Random</a>( 100 ) &lt; (uiChanceOfTheft + j) )
<a name="l00235"></a>00235                         {
<a name="l00236"></a>00236                               memcpy( &amp;pStolenObject[ uiStolenCount ], &amp;Object, <span class="keyword">sizeof</span>( <a class="code" href="structOBJECTTYPE.html">OBJECTTYPE</a> ) );
<a name="l00237"></a>00237                               uiStolenCount++;
<a name="l00238"></a>00238                               fPablosStoleSomething = TRUE;
<a name="l00239"></a>00239                               fPablosStoleLastItem = TRUE;
<a name="l00240"></a>00240                         }
<a name="l00241"></a>00241                         <span class="keywordflow">else</span>
<a name="l00242"></a>00242                         {
<a name="l00243"></a>00243                               fPablosStoleLastItem = FALSE;
<a name="l00244"></a>00244 
<a name="l00245"></a>00245                               <span class="comment">//else we are not currently in the sector, so we build an array of items to add in one lump</span>
<a name="l00246"></a>00246                               <span class="comment">//add the item to the item array</span>
<a name="l00247"></a>00247 
<a name="l00248"></a>00248                               <span class="keywordflow">if</span> (usStandardMapPos == LOST_SHIPMENT_GRIDNO)
<a name="l00249"></a>00249                               {
<a name="l00250"></a>00250                                     <span class="comment">// damage the item a random amount!</span>
<a name="l00251"></a>00251                                     Object.<a class="code" href="structOBJECTTYPE.html#aa0827e15c8e54d285d2850ea5ffbb07">bStatus</a>[0] = (<a class="code" href="Types_8h.html#7ebe70ceca856797319175e30bcf003d">INT8</a>) ( ( (70 + <a class="code" href="Random_8cpp.html#49f938d1313ab6ef09ac6223a16ac334">Random</a>( 11 )) * (<a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a>) Object.<a class="code" href="structOBJECTTYPE.html#aa0827e15c8e54d285d2850ea5ffbb07">bStatus</a>[0] ) / 100 );
<a name="l00252"></a>00252                                     <span class="comment">// make damn sure it can't hit 0</span>
<a name="l00253"></a>00253                                     <span class="keywordflow">if</span> (Object.<a class="code" href="structOBJECTTYPE.html#aa0827e15c8e54d285d2850ea5ffbb07">bStatus</a>[0] == 0)
<a name="l00254"></a>00254                                     {
<a name="l00255"></a>00255                                           Object.<a class="code" href="structOBJECTTYPE.html#aa0827e15c8e54d285d2850ea5ffbb07">bStatus</a>[0] = 1;
<a name="l00256"></a>00256                                     }
<a name="l00257"></a>00257                                     memcpy( &amp;pObject[ uiCount ], &amp;Object, <span class="keyword">sizeof</span>( <a class="code" href="structOBJECTTYPE.html">OBJECTTYPE</a> ) );
<a name="l00258"></a>00258                                     uiCount++;
<a name="l00259"></a>00259                               }
<a name="l00260"></a>00260                               <span class="keywordflow">else</span>
<a name="l00261"></a>00261                               {
<a name="l00262"></a>00262                                     ubItemsDelivered++;
<a name="l00263"></a>00263                               }
<a name="l00264"></a>00264                         }
<a name="l00265"></a>00265                   }
<a name="l00266"></a>00266             }
<a name="l00267"></a>00267 
<a name="l00268"></a>00268             <span class="keywordflow">if</span> ( <a class="code" href="BobbyRMailOrder_8cpp.html#9753076f963c32ac9de3b35e7ee8a3c5">gpNewBobbyrShipments</a>[ ubOrderID ].BobbyRayPurchase[i].ubNumberPurchased == 1 &amp;&amp; ubItemsDelivered == 1 )
<a name="l00269"></a>00269             {
<a name="l00270"></a>00270                   <span class="comment">// the item in Object will be the item to deliver</span>
<a name="l00271"></a>00271                   <span class="keywordflow">if</span>( fSectorLoaded )
<a name="l00272"></a>00272                   {
<a name="l00273"></a>00273                         <a class="code" href="Handle_01Items_8cpp.html#ca7f6f6da97e9a4c2b737296485f5c84">AddItemToPool</a>( usStandardMapPos, &amp;Object, -1, 0, 0, 0 );
<a name="l00274"></a>00274                   }
<a name="l00275"></a>00275                   <span class="keywordflow">else</span>
<a name="l00276"></a>00276                   {
<a name="l00277"></a>00277                         memcpy( &amp;pObject[ uiCount ], &amp;Object, <span class="keyword">sizeof</span>( <a class="code" href="structOBJECTTYPE.html">OBJECTTYPE</a> ) );
<a name="l00278"></a>00278                         uiCount++;
<a name="l00279"></a>00279                   }
<a name="l00280"></a>00280             }
<a name="l00281"></a>00281             <span class="keywordflow">else</span>
<a name="l00282"></a>00282             {
<a name="l00283"></a>00283                   <span class="keywordflow">while</span> ( ubItemsDelivered )
<a name="l00284"></a>00284                   {
<a name="l00285"></a>00285                         <span class="comment">// treat 0s as 1s :-)</span>
<a name="l00286"></a>00286                         ubTempNumItems = __min( ubItemsDelivered, __max( 1, <a class="code" href="Item_01Types_8h.html#f9dc4cc7a3a99ad5944940cfb7c82237">Item</a>[ usItem ].ubPerPocket ) );
<a name="l00287"></a>00287                         <a class="code" href="Items_8cpp.html#19aed5cbf530232ff0e01c7d6e58bd8e">CreateItems</a>( usItem, <a class="code" href="BobbyRMailOrder_8cpp.html#9753076f963c32ac9de3b35e7ee8a3c5">gpNewBobbyrShipments</a>[ ubOrderID ].BobbyRayPurchase[i].bItemQuality, ubTempNumItems, &amp;Object );
<a name="l00288"></a>00288 
<a name="l00289"></a>00289                         <span class="comment">// stack as many as possible</span>
<a name="l00290"></a>00290                         <span class="keywordflow">if</span>( fSectorLoaded )
<a name="l00291"></a>00291                         {
<a name="l00292"></a>00292                               <a class="code" href="Handle_01Items_8cpp.html#ca7f6f6da97e9a4c2b737296485f5c84">AddItemToPool</a>( usStandardMapPos, &amp;Object, -1, 0, 0, 0 );
<a name="l00293"></a>00293                         }
<a name="l00294"></a>00294                         <span class="keywordflow">else</span>
<a name="l00295"></a>00295                         {
<a name="l00296"></a>00296                               memcpy( &amp;pObject[ uiCount ], &amp;Object, <span class="keyword">sizeof</span>( <a class="code" href="structOBJECTTYPE.html">OBJECTTYPE</a> ) );
<a name="l00297"></a>00297                               uiCount++;
<a name="l00298"></a>00298                         }
<a name="l00299"></a>00299 
<a name="l00300"></a>00300                         ubItemsDelivered -= ubTempNumItems;
<a name="l00301"></a>00301                   }
<a name="l00302"></a>00302             }
<a name="l00303"></a>00303       }
<a name="l00304"></a>00304 
<a name="l00305"></a>00305       <span class="comment">//if we are NOT currently in the sector</span>
<a name="l00306"></a>00306       <span class="keywordflow">if</span>( !fSectorLoaded )
<a name="l00307"></a>00307       {
<a name="l00308"></a>00308             <span class="comment">//add all the items from the array that was built above</span>
<a name="l00309"></a>00309             usMapPos = PABLOS_STOLEN_DEST_GRIDNO;
<a name="l00310"></a>00310             <span class="comment">//The item are to be added to the Top part of Drassen, grid loc's  10112, 9950</span>
<a name="l00311"></a>00311             <span class="keywordflow">if</span>( !<a class="code" href="Tactical_01Save_8cpp.html#adcc93e85d8b0ce0a47643071fe0f82d">AddItemsToUnLoadedSector</a>( BOBBYR_SHIPPING_DEST_SECTOR_X, BOBBYR_SHIPPING_DEST_SECTOR_Y, BOBBYR_SHIPPING_DEST_SECTOR_Z, usStandardMapPos, uiCount, pObject, 0, 0, 0, -1, FALSE ) )
<a name="l00312"></a>00312             {
<a name="l00313"></a>00313                   <span class="comment">//Error adding the items</span>
<a name="l00314"></a>00314                   <span class="comment">//return;</span>
<a name="l00315"></a>00315             }
<a name="l00316"></a>00316             <span class="keywordflow">if</span> (uiStolenCount &gt; 0)
<a name="l00317"></a>00317             {
<a name="l00318"></a>00318                   <span class="keywordflow">if</span>( !<a class="code" href="Tactical_01Save_8cpp.html#adcc93e85d8b0ce0a47643071fe0f82d">AddItemsToUnLoadedSector</a>( BOBBYR_SHIPPING_DEST_SECTOR_X, BOBBYR_SHIPPING_DEST_SECTOR_Y, BOBBYR_SHIPPING_DEST_SECTOR_Z, PABLOS_STOLEN_DEST_GRIDNO, uiStolenCount, pStolenObject, 0, 0, 0, -1, FALSE ) )
<a name="l00319"></a>00319                   {
<a name="l00320"></a>00320                         <span class="comment">//Error adding the items</span>
<a name="l00321"></a>00321                         <span class="comment">//return;</span>
<a name="l00322"></a>00322                   }
<a name="l00323"></a>00323             }
<a name="l00324"></a>00324             MemFree( pObject );
<a name="l00325"></a>00325             MemFree( pStolenObject );
<a name="l00326"></a>00326             pObject = NULL;
<a name="l00327"></a>00327             pStolenObject = NULL;
<a name="l00328"></a>00328       }
<a name="l00329"></a>00329 
<a name="l00330"></a>00330       <span class="keywordflow">if</span> (fPablosStoleSomething)
<a name="l00331"></a>00331       {
<a name="l00332"></a>00332             <a class="code" href="Quests_8cpp.html#d7278c1ec0f9cc2ac9af20f8a6b446db">SetFactTrue</a>( <a class="code" href="Quests_8h.html#aead3e57f613f07868a1b2afb6b943f111be90923ef4b414991a4c13490b6dc9">FACT_PABLOS_STOLE_FROM_LATEST_SHIPMENT</a> );
<a name="l00333"></a>00333       }
<a name="l00334"></a>00334       <span class="keywordflow">else</span>
<a name="l00335"></a>00335       {
<a name="l00336"></a>00336             <a class="code" href="Quests_8cpp.html#367aad061aefa5a73a4ac3fda10511b3">SetFactFalse</a>( <a class="code" href="Quests_8h.html#aead3e57f613f07868a1b2afb6b943f111be90923ef4b414991a4c13490b6dc9">FACT_PABLOS_STOLE_FROM_LATEST_SHIPMENT</a> );
<a name="l00337"></a>00337       }
<a name="l00338"></a>00338 
<a name="l00339"></a>00339       <a class="code" href="Quests_8cpp.html#367aad061aefa5a73a4ac3fda10511b3">SetFactFalse</a>( <a class="code" href="Quests_8h.html#aead3e57f613f07868a1b2afb6b943f1a45a42d888603845215916a6d0388bc7">FACT_LARGE_SIZED_OLD_SHIPMENT_WAITING</a> );
<a name="l00340"></a>00340 
<a name="l00341"></a>00341       <span class="keywordflow">if</span> ( <a class="code" href="Quests_8cpp.html#6744b59d27bf2791d0c2fefe18e548d3">CheckFact</a>( <a class="code" href="Quests_8h.html#aead3e57f613f07868a1b2afb6b943f15023cfb049a1a5758c39f26106f20961">FACT_NEXT_PACKAGE_CAN_BE_DELAYED</a>, 0 ) )
<a name="l00342"></a>00342       {
<a name="l00343"></a>00343             <a class="code" href="Quests_8cpp.html#367aad061aefa5a73a4ac3fda10511b3">SetFactFalse</a>( <a class="code" href="Quests_8h.html#aead3e57f613f07868a1b2afb6b943f1d47e4ec4f8f5ffedf351a818f0dd5b69">FACT_MEDIUM_SIZED_SHIPMENT_WAITING</a> );
<a name="l00344"></a>00344             <a class="code" href="Quests_8cpp.html#367aad061aefa5a73a4ac3fda10511b3">SetFactFalse</a>( <a class="code" href="Quests_8h.html#aead3e57f613f07868a1b2afb6b943f1d2c2d0d90f1e7beb6e871f1a0acf2431">FACT_LARGE_SIZED_SHIPMENT_WAITING</a> );
<a name="l00345"></a>00345             <a class="code" href="Quests_8cpp.html#367aad061aefa5a73a4ac3fda10511b3">SetFactFalse</a>( <a class="code" href="Quests_8h.html#aead3e57f613f07868a1b2afb6b943f1893a0b265758ee66e4c912cef1b9e75b">FACT_REALLY_NEW_BOBBYRAY_SHIPMENT_WAITING</a> );
<a name="l00346"></a>00346       }
<a name="l00347"></a>00347       <span class="keywordflow">else</span>
<a name="l00348"></a>00348       {
<a name="l00349"></a>00349             <span class="keywordflow">if</span> (usNumberOfItems - uiStolenCount &lt;= 5)
<a name="l00350"></a>00350             {
<a name="l00351"></a>00351                   <a class="code" href="Quests_8cpp.html#367aad061aefa5a73a4ac3fda10511b3">SetFactFalse</a>( <a class="code" href="Quests_8h.html#aead3e57f613f07868a1b2afb6b943f1d47e4ec4f8f5ffedf351a818f0dd5b69">FACT_MEDIUM_SIZED_SHIPMENT_WAITING</a> );
<a name="l00352"></a>00352                   <a class="code" href="Quests_8cpp.html#367aad061aefa5a73a4ac3fda10511b3">SetFactFalse</a>( <a class="code" href="Quests_8h.html#aead3e57f613f07868a1b2afb6b943f1d2c2d0d90f1e7beb6e871f1a0acf2431">FACT_LARGE_SIZED_SHIPMENT_WAITING</a> );
<a name="l00353"></a>00353             }
<a name="l00354"></a>00354             <span class="keywordflow">else</span> <span class="keywordflow">if</span> (usNumberOfItems - uiStolenCount &lt;= 15)
<a name="l00355"></a>00355             {
<a name="l00356"></a>00356                   <a class="code" href="Quests_8cpp.html#d7278c1ec0f9cc2ac9af20f8a6b446db">SetFactTrue</a>( <a class="code" href="Quests_8h.html#aead3e57f613f07868a1b2afb6b943f1d47e4ec4f8f5ffedf351a818f0dd5b69">FACT_MEDIUM_SIZED_SHIPMENT_WAITING</a> );
<a name="l00357"></a>00357                   <a class="code" href="Quests_8cpp.html#367aad061aefa5a73a4ac3fda10511b3">SetFactFalse</a>( <a class="code" href="Quests_8h.html#aead3e57f613f07868a1b2afb6b943f1d2c2d0d90f1e7beb6e871f1a0acf2431">FACT_LARGE_SIZED_SHIPMENT_WAITING</a> );
<a name="l00358"></a>00358             }
<a name="l00359"></a>00359             <span class="keywordflow">else</span>
<a name="l00360"></a>00360             {
<a name="l00361"></a>00361                   <a class="code" href="Quests_8cpp.html#367aad061aefa5a73a4ac3fda10511b3">SetFactFalse</a>( <a class="code" href="Quests_8h.html#aead3e57f613f07868a1b2afb6b943f1d47e4ec4f8f5ffedf351a818f0dd5b69">FACT_MEDIUM_SIZED_SHIPMENT_WAITING</a> );
<a name="l00362"></a>00362                   <a class="code" href="Quests_8cpp.html#d7278c1ec0f9cc2ac9af20f8a6b446db">SetFactTrue</a>( <a class="code" href="Quests_8h.html#aead3e57f613f07868a1b2afb6b943f1d2c2d0d90f1e7beb6e871f1a0acf2431">FACT_LARGE_SIZED_SHIPMENT_WAITING</a> );
<a name="l00363"></a>00363             }
<a name="l00364"></a>00364 
<a name="l00365"></a>00365             <span class="comment">// this shipment isn't old yet...</span>
<a name="l00366"></a>00366             <a class="code" href="Quests_8cpp.html#d7278c1ec0f9cc2ac9af20f8a6b446db">SetFactTrue</a>( <a class="code" href="Quests_8h.html#aead3e57f613f07868a1b2afb6b943f1893a0b265758ee66e4c912cef1b9e75b">FACT_REALLY_NEW_BOBBYRAY_SHIPMENT_WAITING</a> );
<a name="l00367"></a>00367 
<a name="l00368"></a>00368             <span class="comment">// set up even to make shipment "old"</span>
<a name="l00369"></a>00369             <a class="code" href="Game_01Event_01Hook_8h.html#089bf822fe842514390c4e5774327ffa">AddSameDayStrategicEvent</a>( <a class="code" href="Game_01Event_01Hook_8h.html#08f51f22ad2ed13a25181c2604573110d63b1218e6668df425e6205a5e270f41">EVENT_SET_BY_NPC_SYSTEM</a>, <a class="code" href="Game_01Clock_8cpp.html#c52790b3f2caff24dbd9d8aa2f4b8194">GetWorldMinutesInDay</a>() + 120, <a class="code" href="Quests_8h.html#aead3e57f613f07868a1b2afb6b943f1893a0b265758ee66e4c912cef1b9e75b">FACT_REALLY_NEW_BOBBYRAY_SHIPMENT_WAITING</a> );
<a name="l00370"></a>00370       }
<a name="l00371"></a>00371 
<a name="l00372"></a>00372       <span class="comment">//We have received the shipment so fActice becomes fALSE</span>
<a name="l00373"></a>00373       <a class="code" href="BobbyRMailOrder_8cpp.html#9753076f963c32ac9de3b35e7ee8a3c5">gpNewBobbyrShipments</a>[ ubOrderID ].<a class="code" href="structNewBobbyRayOrderStruct.html#873da9e8bc226b20c83084970e3a4951">fActive</a> = FALSE;
<a name="l00374"></a>00374 
<a name="l00375"></a>00375       <span class="comment">//Stop time compression the game</span>
<a name="l00376"></a>00376       <a class="code" href="Game_01Clock_8cpp.html#571d623de0660dfd350dbbc43ac0cd90">StopTimeCompression</a>( );
<a name="l00377"></a>00377 
<a name="l00378"></a>00378       <span class="comment">//if the shipment is NOT from John Kulba, send an email</span>
<a name="l00379"></a>00379       <span class="keywordflow">if</span>( !fThisShipmentIsFromJohnKulba )
<a name="l00380"></a>00380       {
<a name="l00381"></a>00381             <span class="comment">//Add an email from Bobby r telling the user the shipment 'Should' be there</span>
<a name="l00382"></a>00382             <a class="code" href="email_8cpp.html#a8c94e8b550c28723c1e587381bd874e">AddEmail</a>( BOBBYR_SHIPMENT_ARRIVED, BOBBYR_SHIPMENT_ARRIVED_LENGTH, <a class="code" href="email_8h.html#83e8bc15645f9d99ab91a152bb3dc8ceb9739e8530e4b1d34801b201464d32ee">BOBBY_R</a>, <a class="code" href="Game_01Clock_8cpp.html#4d255e800fba4d64144a7639d5f3421d">GetWorldTotalMin</a>() );
<a name="l00383"></a>00383       }
<a name="l00384"></a>00384       <span class="keywordflow">else</span>
<a name="l00385"></a>00385       {
<a name="l00386"></a>00386             <span class="comment">//if the shipment is from John Kulba</span>
<a name="l00387"></a>00387 
<a name="l00388"></a>00388             <span class="comment">//Add an email from kulba telling the user the shipment is there</span>
<a name="l00389"></a>00389             <a class="code" href="email_8cpp.html#a8c94e8b550c28723c1e587381bd874e">AddEmail</a>( JOHN_KULBA_GIFT_IN_DRASSEN, JOHN_KULBA_GIFT_IN_DRASSEN_LENGTH, <a class="code" href="email_8h.html#83e8bc15645f9d99ab91a152bb3dc8cee08be94bec07c9f46d82543af0d8432c">JOHN_KULBA</a>, <a class="code" href="Game_01Clock_8cpp.html#4d255e800fba4d64144a7639d5f3421d">GetWorldTotalMin</a>() );
<a name="l00390"></a>00390       }
<a name="l00391"></a>00391 }
<a name="l00392"></a>00392 
<a name="l00393"></a>00393 
<a name="l00394"></a>00394 
<a name="l00395"></a><a class="code" href="Strategic_01Event_01Handler_8cpp.html#717a5aa48b207596c1044d6300206780">00395</a> <span class="keywordtype">void</span> <a class="code" href="Strategic_01Event_01Handler_8cpp.html#717a5aa48b207596c1044d6300206780">HandleDelayedItemsArrival</a>( <a class="code" href="Types_8h.html#e1e6edbbc26d6fbc71a90190d0266018">UINT32</a> uiReason )
<a name="l00396"></a>00396 {
<a name="l00397"></a>00397       <span class="comment">// This function moves all the items that Pablos has stolen </span>
<a name="l00398"></a>00398       <span class="comment">// (or items that were delayed) to the arrival location for new shipments, </span>
<a name="l00399"></a>00399       <a class="code" href="Types_8h.html#30f500129d8c688af07726d5d34ce52d">INT16</a>             sStartGridNo;
<a name="l00400"></a>00400       <a class="code" href="Types_8h.html#e1e6edbbc26d6fbc71a90190d0266018">UINT32</a>            uiNumWorldItems, uiLoop;
<a name="l00401"></a>00401       <a class="code" href="Types_8h.html#112e3146cb38b6ee95e64d85842e380a">BOOLEAN</a>           fOk;
<a name="l00402"></a>00402       <a class="code" href="structWORLDITEM.html">WORLDITEM</a> * pTemp;
<a name="l00403"></a>00403       <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>             ubLoop;
<a name="l00404"></a>00404       <a class="code" href="structOBJECTTYPE.html">OBJECTTYPE</a> Object;
<a name="l00405"></a>00405       
<a name="l00406"></a>00406       <span class="keywordflow">if</span> (uiReason == NPC_SYSTEM_EVENT_ACTION_PARAM_BONUS + <a class="code" href="interface_01Dialogue_8h.html#2ae95ea8e60178fe99580d5142f0ec7ee9681222789a30d98eccb652eb8a23b6">NPC_ACTION_RETURN_STOLEN_SHIPMENT_ITEMS</a> )
<a name="l00407"></a>00407       {
<a name="l00408"></a>00408             <span class="keywordflow">if</span> ( <a class="code" href="Soldier_01Profile_8cpp.html#1bcff2c50b375b1eb32800aa12000289">gMercProfiles</a>[ <a class="code" href="Soldier_01Profile_8h.html#acaa92dcb344e96138c964deae3e2fa1827fd2772c02066525f9c9964dafab6c">PABLO</a> ].bMercStatus == MERC_IS_DEAD )
<a name="l00409"></a>00409             {
<a name="l00410"></a>00410                   <span class="comment">// nothing arrives then!</span>
<a name="l00411"></a>00411                   <span class="keywordflow">return</span>;
<a name="l00412"></a>00412             }
<a name="l00413"></a>00413             <span class="comment">// update some facts...</span>
<a name="l00414"></a>00414             <a class="code" href="Quests_8cpp.html#d7278c1ec0f9cc2ac9af20f8a6b446db">SetFactTrue</a>( <a class="code" href="Quests_8h.html#aead3e57f613f07868a1b2afb6b943f1736a8d7111ceb5f8ec469a44c7b58559">FACT_PABLO_RETURNED_GOODS</a> );
<a name="l00415"></a>00415             <a class="code" href="Quests_8cpp.html#367aad061aefa5a73a4ac3fda10511b3">SetFactFalse</a>( <a class="code" href="Quests_8h.html#aead3e57f613f07868a1b2afb6b943f197443b4d7c56d0189974f4fc36855b32">FACT_PABLO_PUNISHED_BY_PLAYER</a> );
<a name="l00416"></a>00416             sStartGridNo = PABLOS_STOLEN_DEST_GRIDNO;
<a name="l00417"></a>00417 
<a name="l00418"></a>00418             <span class="comment">// add random items</span>
<a name="l00419"></a>00419 
<a name="l00420"></a>00420             <span class="keywordflow">for</span> (ubLoop = 0; ubLoop &lt; 2; ubLoop++)
<a name="l00421"></a>00421             {
<a name="l00422"></a>00422                   <span class="keywordflow">switch</span>( <a class="code" href="Random_8cpp.html#49f938d1313ab6ef09ac6223a16ac334">Random</a>( 10 ) )
<a name="l00423"></a>00423                   {
<a name="l00424"></a>00424                         <span class="keywordflow">case</span> 0:
<a name="l00425"></a>00425                               <span class="comment">// 1 in 10 chance of a badly damaged gas mask</span>
<a name="l00426"></a>00426                               <a class="code" href="Items_8cpp.html#153f1fcda178d6758ff8b01cf7999170">CreateItem</a>( <a class="code" href="Item_01Types_8h.html#572f9555da77e1b21f4cd40aed8d20f4fed9ba8f87155786005ac56632aaec65">GASMASK</a>, (<a class="code" href="Types_8h.html#7ebe70ceca856797319175e30bcf003d">INT8</a>) (20 + <a class="code" href="Random_8cpp.html#49f938d1313ab6ef09ac6223a16ac334">Random</a>( 10 )), &amp;Object );
<a name="l00427"></a>00427                               <span class="keywordflow">break</span>;
<a name="l00428"></a>00428                         <span class="keywordflow">case</span> 1:
<a name="l00429"></a>00429                         <span class="keywordflow">case</span> 2:
<a name="l00430"></a>00430                               <span class="comment">// 2 in 10 chance of a battered Desert Eagle</span>
<a name="l00431"></a>00431                               <a class="code" href="Items_8cpp.html#153f1fcda178d6758ff8b01cf7999170">CreateItem</a>( <a class="code" href="Item_01Types_8h.html#572f9555da77e1b21f4cd40aed8d20f4840bb62eb75a475abe62986113e4a1f3">DESERTEAGLE</a>, (<a class="code" href="Types_8h.html#7ebe70ceca856797319175e30bcf003d">INT8</a>) (40 + <a class="code" href="Random_8cpp.html#49f938d1313ab6ef09ac6223a16ac334">Random</a>( 10 )), &amp;Object );
<a name="l00432"></a>00432                               <span class="keywordflow">break</span>;
<a name="l00433"></a>00433                         <span class="keywordflow">case</span> 3:
<a name="l00434"></a>00434                         <span class="keywordflow">case</span> 4:
<a name="l00435"></a>00435                         <span class="keywordflow">case</span> 5:
<a name="l00436"></a>00436                               <span class="comment">// 3 in 10 chance of a stun grenade</span>
<a name="l00437"></a>00437                               <a class="code" href="Items_8cpp.html#153f1fcda178d6758ff8b01cf7999170">CreateItem</a>( <a class="code" href="Item_01Types_8h.html#572f9555da77e1b21f4cd40aed8d20f4dcd3e57e71ae8f6fd71641cc68928cfc">STUN_GRENADE</a>, (<a class="code" href="Types_8h.html#7ebe70ceca856797319175e30bcf003d">INT8</a>) (70 + <a class="code" href="Random_8cpp.html#49f938d1313ab6ef09ac6223a16ac334">Random</a>( 10 )), &amp;Object );
<a name="l00438"></a>00438                               <span class="keywordflow">break</span>;
<a name="l00439"></a>00439                         <span class="keywordflow">case</span> 6:
<a name="l00440"></a>00440                         <span class="keywordflow">case</span> 7:
<a name="l00441"></a>00441                         <span class="keywordflow">case</span> 8:
<a name="l00442"></a>00442                         <span class="keywordflow">case</span> 9:
<a name="l00443"></a>00443                               <span class="comment">// 4 in 10 chance of two 38s!</span>
<a name="l00444"></a>00444                               <a class="code" href="Items_8cpp.html#19aed5cbf530232ff0e01c7d6e58bd8e">CreateItems</a>( <a class="code" href="Item_01Types_8h.html#572f9555da77e1b21f4cd40aed8d20f46c1c44f20d205421819801f5ccf21a93">SW38</a>, (<a class="code" href="Types_8h.html#7ebe70ceca856797319175e30bcf003d">INT8</a>) (90 + <a class="code" href="Random_8cpp.html#49f938d1313ab6ef09ac6223a16ac334">Random</a>( 10 )), 2, &amp;Object );
<a name="l00445"></a>00445                               <span class="keywordflow">break</span>;
<a name="l00446"></a>00446                   }
<a name="l00447"></a>00447                   <span class="keywordflow">if</span> ( ( <a class="code" href="strategicmap_8cpp.html#49d9aed144a633fda4ba1990f002d703">gWorldSectorX</a> == BOBBYR_SHIPPING_DEST_SECTOR_X ) &amp;&amp; ( <a class="code" href="strategicmap_8cpp.html#ea322310ced0e35ee18a2ee7b32aac5b">gWorldSectorY</a> == BOBBYR_SHIPPING_DEST_SECTOR_Y ) &amp;&amp; ( <a class="code" href="strategicmap_8cpp.html#da715721a8ceedd42acf6ddb33e63ce0">gbWorldSectorZ</a> == BOBBYR_SHIPPING_DEST_SECTOR_Z ) )
<a name="l00448"></a>00448                   {
<a name="l00449"></a>00449                         <a class="code" href="Handle_01Items_8cpp.html#ca7f6f6da97e9a4c2b737296485f5c84">AddItemToPool</a>( BOBBYR_SHIPPING_DEST_GRIDNO, &amp;Object, -1, 0, 0, 0 );
<a name="l00450"></a>00450                   }
<a name="l00451"></a>00451                   <span class="keywordflow">else</span>
<a name="l00452"></a>00452                   {
<a name="l00453"></a>00453                         <a class="code" href="Tactical_01Save_8cpp.html#adcc93e85d8b0ce0a47643071fe0f82d">AddItemsToUnLoadedSector</a>( BOBBYR_SHIPPING_DEST_SECTOR_X, BOBBYR_SHIPPING_DEST_SECTOR_Y, BOBBYR_SHIPPING_DEST_SECTOR_Z, BOBBYR_SHIPPING_DEST_GRIDNO, 1, &amp;Object, 0, 0, 0, -1, FALSE );
<a name="l00454"></a>00454                   }
<a name="l00455"></a>00455             }
<a name="l00456"></a>00456       }
<a name="l00457"></a>00457       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (uiReason == <a class="code" href="Quests_8h.html#aead3e57f613f07868a1b2afb6b943f166ae44b163b55035fed188a2d88f0310">FACT_PACKAGE_DAMAGED</a>)
<a name="l00458"></a>00458       {
<a name="l00459"></a>00459             sStartGridNo = LOST_SHIPMENT_GRIDNO;
<a name="l00460"></a>00460       }
<a name="l00461"></a>00461       <span class="keywordflow">else</span>
<a name="l00462"></a>00462       {
<a name="l00463"></a>00463             <span class="keywordflow">return</span>;
<a name="l00464"></a>00464       }
<a name="l00465"></a>00465 
<a name="l00466"></a>00466       <span class="comment">// If the Drassen airport sector is already loaded, move the item pools...</span>
<a name="l00467"></a>00467       <span class="keywordflow">if</span> ( ( <a class="code" href="strategicmap_8cpp.html#49d9aed144a633fda4ba1990f002d703">gWorldSectorX</a> == BOBBYR_SHIPPING_DEST_SECTOR_X ) &amp;&amp; ( <a class="code" href="strategicmap_8cpp.html#ea322310ced0e35ee18a2ee7b32aac5b">gWorldSectorY</a> == BOBBYR_SHIPPING_DEST_SECTOR_Y ) &amp;&amp; ( <a class="code" href="strategicmap_8cpp.html#da715721a8ceedd42acf6ddb33e63ce0">gbWorldSectorZ</a> == BOBBYR_SHIPPING_DEST_SECTOR_Z ) )
<a name="l00468"></a>00468       {
<a name="l00469"></a>00469             <span class="comment">// sector is loaded!</span>
<a name="l00470"></a>00470             <span class="comment">// just move the hidden item pool</span>
<a name="l00471"></a>00471             <a class="code" href="Handle_01Items_8cpp.html#5fb3f882e72fa47505d032f333224fc5">MoveItemPools</a>( sStartGridNo, BOBBYR_SHIPPING_DEST_GRIDNO );
<a name="l00472"></a>00472       }
<a name="l00473"></a>00473       <span class="keywordflow">else</span>
<a name="l00474"></a>00474       {
<a name="l00475"></a>00475             <span class="comment">// otherwise load the saved items from the item file and change the records of their locations</span>
<a name="l00476"></a>00476             fOk = <a class="code" href="Tactical_01Save_8cpp.html#2eec19d347694e8b5f024d9c6eff2981">GetNumberOfWorldItemsFromTempItemFile</a>( BOBBYR_SHIPPING_DEST_SECTOR_X, BOBBYR_SHIPPING_DEST_SECTOR_Y, BOBBYR_SHIPPING_DEST_SECTOR_Z, &amp;uiNumWorldItems, FALSE );
<a name="l00477"></a>00477             <span class="keywordflow">if</span> (!fOk)
<a name="l00478"></a>00478             {
<a name="l00479"></a>00479                   <span class="keywordflow">return</span>;
<a name="l00480"></a>00480             }
<a name="l00481"></a>00481             pTemp = (<a class="code" href="structWORLDITEM.html">WORLDITEM</a> *) MemAlloc( <span class="keyword">sizeof</span>( <a class="code" href="structWORLDITEM.html">WORLDITEM</a> ) * uiNumWorldItems);
<a name="l00482"></a>00482             <span class="keywordflow">if</span> (!pTemp)
<a name="l00483"></a>00483             {
<a name="l00484"></a>00484                   <span class="keywordflow">return</span>;
<a name="l00485"></a>00485             }
<a name="l00486"></a>00486             fOk = <a class="code" href="Tactical_01Save_8cpp.html#2412d6d05d48a7a3229faf49906f6f0d">LoadWorldItemsFromTempItemFile</a>( BOBBYR_SHIPPING_DEST_SECTOR_X, BOBBYR_SHIPPING_DEST_SECTOR_Y, BOBBYR_SHIPPING_DEST_SECTOR_Z, pTemp );     
<a name="l00487"></a>00487             <span class="keywordflow">if</span> (fOk)
<a name="l00488"></a>00488             {
<a name="l00489"></a>00489                   <span class="keywordflow">for</span> (uiLoop = 0; uiLoop &lt; uiNumWorldItems; uiLoop++)
<a name="l00490"></a>00490                   {
<a name="l00491"></a>00491                         <span class="keywordflow">if</span> (pTemp[uiLoop].sGridNo == PABLOS_STOLEN_DEST_GRIDNO)
<a name="l00492"></a>00492                         {
<a name="l00493"></a>00493                               pTemp[uiLoop].sGridNo = BOBBYR_SHIPPING_DEST_GRIDNO;
<a name="l00494"></a>00494                         }
<a name="l00495"></a>00495                   }
<a name="l00496"></a>00496                   <a class="code" href="Tactical_01Save_8cpp.html#bbf82e5569006b24e7825f0642f822d1">AddWorldItemsToUnLoadedSector</a>( BOBBYR_SHIPPING_DEST_SECTOR_X, BOBBYR_SHIPPING_DEST_SECTOR_Y, BOBBYR_SHIPPING_DEST_SECTOR_Z, 0, uiNumWorldItems, pTemp, TRUE );
<a name="l00497"></a>00497             }
<a name="l00498"></a>00498       }
<a name="l00499"></a>00499 
<a name="l00500"></a>00500 
<a name="l00501"></a>00501 }
<a name="l00502"></a>00502 
<a name="l00503"></a><a class="code" href="Strategic_01Event_01Handler_8h.html#09a5525f1968667823a17d1b7f040194">00503</a> <span class="keywordtype">void</span> <a class="code" href="Strategic_01Event_01Handler_8cpp.html#09a5525f1968667823a17d1b7f040194">AddSecondAirportAttendant</a>( <span class="keywordtype">void</span> )
<a name="l00504"></a>00504 {
<a name="l00505"></a>00505       <span class="comment">// add the second airport attendant to the Drassen airport...</span>
<a name="l00506"></a>00506       <a class="code" href="Soldier_01Profile_8cpp.html#1bcff2c50b375b1eb32800aa12000289">gMercProfiles</a>[99].<a class="code" href="structMERCPROFILESTRUCT.html#b0d6f66ec41a0d9c87fbc03dd9fed965">sSectorX</a> = BOBBYR_SHIPPING_DEST_SECTOR_X;
<a name="l00507"></a>00507       <a class="code" href="Soldier_01Profile_8cpp.html#1bcff2c50b375b1eb32800aa12000289">gMercProfiles</a>[99].<a class="code" href="structMERCPROFILESTRUCT.html#e3caff1f000b3ed3c382e8a1f0d5fdbc">sSectorY</a> = BOBBYR_SHIPPING_DEST_SECTOR_Y;
<a name="l00508"></a>00508       <a class="code" href="Soldier_01Profile_8cpp.html#1bcff2c50b375b1eb32800aa12000289">gMercProfiles</a>[99].<a class="code" href="structMERCPROFILESTRUCT.html#9dfd2271b790d94f55f142e71ab18065">bSectorZ</a> = BOBBYR_SHIPPING_DEST_SECTOR_Z; 
<a name="l00509"></a>00509 }
<a name="l00510"></a>00510 
<a name="l00511"></a><a class="code" href="Strategic_01Event_01Handler_8h.html#3d9a93eb956813e42bda14827350a656">00511</a> <span class="keywordtype">void</span> <a class="code" href="Strategic_01Event_01Handler_8cpp.html#3d9a93eb956813e42bda14827350a656">SetPabloToUnbribed</a>( <span class="keywordtype">void</span> )
<a name="l00512"></a>00512 {
<a name="l00513"></a>00513       <span class="keywordflow">if</span> (<a class="code" href="Strategic_01Event_01Handler_8cpp.html#d2162c7d8c66a6a360c38e8bf6aeb9b4">guiPabloExtraDaysBribed</a> &gt; 0)
<a name="l00514"></a>00514       {
<a name="l00515"></a>00515             <span class="comment">// set new event for later on, because the player gave Pablo more money!</span>
<a name="l00516"></a>00516             <a class="code" href="Game_01Event_01Hook_8h.html#c1e7564b090f3b2dc02297940efbedc1">AddFutureDayStrategicEvent</a>( <a class="code" href="Game_01Event_01Hook_8h.html#08f51f22ad2ed13a25181c2604573110d63b1218e6668df425e6205a5e270f41">EVENT_SET_BY_NPC_SYSTEM</a>, <a class="code" href="Game_01Clock_8cpp.html#c52790b3f2caff24dbd9d8aa2f4b8194">GetWorldMinutesInDay</a>(), <a class="code" href="Quests_8h.html#aead3e57f613f07868a1b2afb6b943f195ef56e476ac8bb9b6ba7283f41d29da">FACT_PABLOS_BRIBED</a>, <a class="code" href="Strategic_01Event_01Handler_8cpp.html#d2162c7d8c66a6a360c38e8bf6aeb9b4">guiPabloExtraDaysBribed</a> );
<a name="l00517"></a>00517             <a class="code" href="Strategic_01Event_01Handler_8cpp.html#d2162c7d8c66a6a360c38e8bf6aeb9b4">guiPabloExtraDaysBribed</a> = 0;
<a name="l00518"></a>00518       }
<a name="l00519"></a>00519       <span class="keywordflow">else</span>
<a name="l00520"></a>00520       {
<a name="l00521"></a>00521             <a class="code" href="Quests_8cpp.html#367aad061aefa5a73a4ac3fda10511b3">SetFactFalse</a>( <a class="code" href="Quests_8h.html#aead3e57f613f07868a1b2afb6b943f195ef56e476ac8bb9b6ba7283f41d29da">FACT_PABLOS_BRIBED</a> );
<a name="l00522"></a>00522       }
<a name="l00523"></a>00523 }
<a name="l00524"></a>00524 
<a name="l00525"></a><a class="code" href="Strategic_01Event_01Handler_8cpp.html#f713d9d01c600cd8c13ab5d88d404f4a">00525</a> <span class="keywordtype">void</span> <a class="code" href="Strategic_01Event_01Handler_8cpp.html#f713d9d01c600cd8c13ab5d88d404f4a">HandlePossiblyDamagedPackage</a>( <span class="keywordtype">void</span> )
<a name="l00526"></a>00526 {
<a name="l00527"></a>00527       <span class="keywordflow">if</span> (<a class="code" href="Random_8cpp.html#49f938d1313ab6ef09ac6223a16ac334">Random</a>( 100 ) &lt; 70)
<a name="l00528"></a>00528       {
<a name="l00529"></a>00529             <a class="code" href="Quests_8cpp.html#d7278c1ec0f9cc2ac9af20f8a6b446db">SetFactTrue</a>( <a class="code" href="Quests_8h.html#aead3e57f613f07868a1b2afb6b943f166ae44b163b55035fed188a2d88f0310">FACT_PACKAGE_DAMAGED</a> );
<a name="l00530"></a>00530             <a class="code" href="Strategic_01Event_01Handler_8cpp.html#717a5aa48b207596c1044d6300206780">HandleDelayedItemsArrival</a>( <a class="code" href="Quests_8h.html#aead3e57f613f07868a1b2afb6b943f166ae44b163b55035fed188a2d88f0310">FACT_PACKAGE_DAMAGED</a> );
<a name="l00531"></a>00531       }
<a name="l00532"></a>00532       <span class="keywordflow">else</span>
<a name="l00533"></a>00533       {
<a name="l00534"></a>00534             <span class="comment">// shipment lost forever!</span>
<a name="l00535"></a>00535             <a class="code" href="Quests_8cpp.html#d7278c1ec0f9cc2ac9af20f8a6b446db">SetFactTrue</a>( <a class="code" href="Quests_8h.html#aead3e57f613f07868a1b2afb6b943f19824d2f063a10bb8edab6aa6f2d69ab9">FACT_PACKAGE_LOST_PERMANENTLY</a> );
<a name="l00536"></a>00536       }
<a name="l00537"></a>00537       <span class="comment">// whatever happened, the shipment is no longer delayed</span>
<a name="l00538"></a>00538       <a class="code" href="Quests_8cpp.html#367aad061aefa5a73a4ac3fda10511b3">SetFactFalse</a>( <a class="code" href="Quests_8h.html#aead3e57f613f07868a1b2afb6b943f1e6769109027a1890620bdcc5ee83bb2f">FACT_SHIPMENT_DELAYED_24_HOURS</a> );
<a name="l00539"></a>00539 }
<a name="l00540"></a>00540 
<a name="l00541"></a><a class="code" href="Strategic_01Event_01Handler_8h.html#114f3a51b15d80423c5cf2f25601ff5d">00541</a> <span class="keywordtype">void</span> <a class="code" href="Strategic_01Event_01Handler_8cpp.html#114f3a51b15d80423c5cf2f25601ff5d">CheckForKingpinsMoneyMissing</a>( <a class="code" href="Types_8h.html#112e3146cb38b6ee95e64d85842e380a">BOOLEAN</a> fFirstCheck )
<a name="l00542"></a>00542 {
<a name="l00543"></a>00543       <a class="code" href="Types_8h.html#e1e6edbbc26d6fbc71a90190d0266018">UINT32</a>                        uiLoop;
<a name="l00544"></a>00544       <a class="code" href="Types_8h.html#e1e6edbbc26d6fbc71a90190d0266018">UINT32</a>                        uiTotalCash = 0;
<a name="l00545"></a>00545       <a class="code" href="Types_8h.html#112e3146cb38b6ee95e64d85842e380a">BOOLEAN</a>                       fKingpinWillDiscover = FALSE, fKingpinDiscovers = FALSE;
<a name="l00546"></a>00546 
<a name="l00547"></a>00547       <span class="comment">// money in D5b1 must be less than 30k</span>
<a name="l00548"></a>00548 
<a name="l00549"></a>00549       <span class="keywordflow">for</span> ( uiLoop = 0; uiLoop &lt; <a class="code" href="Map_01Screen_01Interface_01Map_01Inventory_8cpp.html#28a0f1d5abf53af570a6a2a140617788">guiNumWorldItems</a>; uiLoop++ )
<a name="l00550"></a>00550       {
<a name="l00551"></a>00551             <span class="comment">// loop through all items, look for ownership</span>
<a name="l00552"></a>00552             <span class="keywordflow">if</span> ( <a class="code" href="World_01Items_8cpp.html#3d02de7bbc850b7f4c6318b8d1125dee">gWorldItems</a>[ uiLoop ].fExists &amp;&amp; <a class="code" href="World_01Items_8cpp.html#3d02de7bbc850b7f4c6318b8d1125dee">gWorldItems</a>[ uiLoop ].o.usItem == <a class="code" href="Item_01Types_8h.html#572f9555da77e1b21f4cd40aed8d20f4fbf7e82d9551a181f32f99564541f312">MONEY</a> )
<a name="l00553"></a>00553             {
<a name="l00554"></a>00554                   uiTotalCash += <a class="code" href="World_01Items_8cpp.html#3d02de7bbc850b7f4c6318b8d1125dee">gWorldItems</a>[uiLoop].<a class="code" href="structWORLDITEM.html#0f219e2d7aafd3aeca85991add1ef5f8">o</a>.<a class="code" href="structOBJECTTYPE.html#c1c1aff6f6a60e1a522bbe3cac327a88">uiMoneyAmount</a>;
<a name="l00555"></a>00555             }
<a name="l00556"></a>00556       }
<a name="l00557"></a>00557 
<a name="l00558"></a>00558       <span class="comment">// This function should be called every time sector D5/B1 is unloaded!</span>
<a name="l00559"></a>00559       <span class="keywordflow">if</span> ( fFirstCheck )
<a name="l00560"></a>00560       {
<a name="l00561"></a>00561             <span class="keywordflow">if</span> ( <a class="code" href="Quests_8cpp.html#6744b59d27bf2791d0c2fefe18e548d3">CheckFact</a>( <a class="code" href="Quests_8h.html#aead3e57f613f07868a1b2afb6b943f10e11efc1b41fe8b7022087d7828bbc0c">FACT_KINGPIN_WILL_LEARN_OF_MONEY_GONE</a>, 0 ) == TRUE )
<a name="l00562"></a>00562             {
<a name="l00563"></a>00563                   <span class="comment">// unnecessary</span>
<a name="l00564"></a>00564                   <span class="keywordflow">return</span>;
<a name="l00565"></a>00565             }
<a name="l00566"></a>00566 
<a name="l00567"></a>00567             <span class="keywordflow">if</span> ( uiTotalCash &lt; 30000 )
<a name="l00568"></a>00568             {
<a name="l00569"></a>00569                   <span class="comment">// add history log here</span>
<a name="l00570"></a>00570                   <a class="code" href="history_8cpp.html#1c2cf05b6c7bafb693481f84d1fd80ae">AddHistoryToPlayersLog</a>( <a class="code" href="history_8h.html#70ad55be767ca0a42c9150d24618e4ca7420a900ddea733e8fda8e5d1e604260">HISTORY_FOUND_MONEY</a>, 0, <a class="code" href="Game_01Clock_8cpp.html#4d255e800fba4d64144a7639d5f3421d">GetWorldTotalMin</a>(), <a class="code" href="strategicmap_8cpp.html#49d9aed144a633fda4ba1990f002d703">gWorldSectorX</a>, <a class="code" href="strategicmap_8cpp.html#ea322310ced0e35ee18a2ee7b32aac5b">gWorldSectorY</a> );
<a name="l00571"></a>00571 
<a name="l00572"></a>00572                   <a class="code" href="Quests_8cpp.html#d7278c1ec0f9cc2ac9af20f8a6b446db">SetFactTrue</a>( FACT_KINGPIN_WILL_LEARN_OF_MONEY_GONE ); 
<a name="l00573"></a>00573             }
<a name="l00574"></a>00574       }
<a name="l00575"></a>00575 
<a name="l00576"></a>00576       <span class="keywordflow">if</span> ( <a class="code" href="Quests_8cpp.html#6744b59d27bf2791d0c2fefe18e548d3">CheckFact</a>( <a class="code" href="Quests_8h.html#aead3e57f613f07868a1b2afb6b943f113228fb280e0247224b96156f3bcbbde">FACT_KINGPIN_DEAD</a>, 0 ) == TRUE )
<a name="l00577"></a>00577       {
<a name="l00578"></a>00578             <span class="keywordflow">return</span>;
<a name="l00579"></a>00579       }
<a name="l00580"></a>00580 
<a name="l00581"></a>00581       <span class="keywordflow">if</span> ( uiTotalCash &lt; 30000 )
<a name="l00582"></a>00582       {
<a name="l00583"></a>00583             <span class="keywordflow">if</span> ( fFirstCheck )
<a name="l00584"></a>00584             {
<a name="l00585"></a>00585                   <span class="comment">// add event to make Kingpin aware, two days from now</span>
<a name="l00586"></a>00586                   fKingpinWillDiscover = TRUE;              
<a name="l00587"></a>00587             }
<a name="l00588"></a>00588             <span class="keywordflow">else</span>
<a name="l00589"></a>00589             {
<a name="l00590"></a>00590                   fKingpinDiscovers = TRUE;
<a name="l00591"></a>00591             }
<a name="l00592"></a>00592       }
<a name="l00593"></a>00593             
<a name="l00594"></a>00594       <span class="keywordflow">if</span> ( fKingpinWillDiscover )
<a name="l00595"></a>00595       {
<a name="l00596"></a>00596             <span class="comment">// set event for next day to check for real                 </span>
<a name="l00597"></a>00597             <a class="code" href="Game_01Event_01Hook_8h.html#c1e7564b090f3b2dc02297940efbedc1">AddFutureDayStrategicEvent</a>( <a class="code" href="Game_01Event_01Hook_8h.html#08f51f22ad2ed13a25181c2604573110d63b1218e6668df425e6205a5e270f41">EVENT_SET_BY_NPC_SYSTEM</a>, <a class="code" href="Random_8cpp.html#49f938d1313ab6ef09ac6223a16ac334">Random</a>( 120 ), <a class="code" href="Quests_8h.html#aead3e57f613f07868a1b2afb6b943f1584a50ad594bb5dd94e526123cc7c7a2">FACT_KINGPIN_KNOWS_MONEY_GONE</a>, 1 );
<a name="l00598"></a>00598 
<a name="l00599"></a>00599             <span class="comment">// the sector is unloaded NOW so set Kingpin's balance and remove the cash</span>
<a name="l00600"></a>00600             <a class="code" href="Soldier_01Profile_8cpp.html#1bcff2c50b375b1eb32800aa12000289">gMercProfiles</a>[ <a class="code" href="Soldier_01Profile_8h.html#acaa92dcb344e96138c964deae3e2fa1f321e5d58d7caf62b9a303b6d6b461f8">KINGPIN</a> ].<a class="code" href="structMERCPROFILESTRUCT.html#c35cc0ea235c0ee715cac81a684c7380">iBalance</a> = - (30000 - (<a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a>) uiTotalCash);
<a name="l00601"></a>00601             <span class="comment">// remove all money from map</span>
<a name="l00602"></a>00602             <span class="keywordflow">for</span> ( uiLoop = 0; uiLoop &lt; <a class="code" href="Map_01Screen_01Interface_01Map_01Inventory_8cpp.html#28a0f1d5abf53af570a6a2a140617788">guiNumWorldItems</a>; uiLoop++ )
<a name="l00603"></a>00603             {
<a name="l00604"></a>00604                   <span class="comment">// loop through all items, look for ownership</span>
<a name="l00605"></a>00605                   <span class="keywordflow">if</span> ( <a class="code" href="World_01Items_8cpp.html#3d02de7bbc850b7f4c6318b8d1125dee">gWorldItems</a>[ uiLoop ].fExists &amp;&amp; <a class="code" href="World_01Items_8cpp.html#3d02de7bbc850b7f4c6318b8d1125dee">gWorldItems</a>[ uiLoop ].o.usItem == <a class="code" href="Item_01Types_8h.html#572f9555da77e1b21f4cd40aed8d20f4fbf7e82d9551a181f32f99564541f312">MONEY</a> )
<a name="l00606"></a>00606                   {
<a name="l00607"></a>00607                         <span class="comment">// remove!</span>
<a name="l00608"></a>00608                         <a class="code" href="World_01Items_8cpp.html#3d02de7bbc850b7f4c6318b8d1125dee">gWorldItems</a>[ uiLoop ].<a class="code" href="structWORLDITEM.html#7c56243fa499bb3d0bd5b905f74881ed">fExists</a> = FALSE;
<a name="l00609"></a>00609                   }
<a name="l00610"></a>00610             }
<a name="l00611"></a>00611       }
<a name="l00612"></a>00612       <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( fKingpinDiscovers )
<a name="l00613"></a>00613       {
<a name="l00614"></a>00614             <span class="comment">// ok start things up here!</span>
<a name="l00615"></a>00615             <a class="code" href="Quests_8cpp.html#d7278c1ec0f9cc2ac9af20f8a6b446db">SetFactTrue</a>( <a class="code" href="Quests_8h.html#aead3e57f613f07868a1b2afb6b943f1584a50ad594bb5dd94e526123cc7c7a2">FACT_KINGPIN_KNOWS_MONEY_GONE</a> );
<a name="l00616"></a>00616 
<a name="l00617"></a>00617             <span class="comment">// set event 2 days from now that if the player has not given Kingpin his money back,</span>
<a name="l00618"></a>00618             <span class="comment">// he sends email to the player</span>
<a name="l00619"></a>00619             <a class="code" href="Game_01Event_01Hook_8h.html#c1e7564b090f3b2dc02297940efbedc1">AddFutureDayStrategicEvent</a>( EVENT_SET_BY_NPC_SYSTEM, <a class="code" href="Random_8cpp.html#49f938d1313ab6ef09ac6223a16ac334">Random</a>( 120 ), <a class="code" href="Quests_8h.html#aead3e57f613f07868a1b2afb6b943f1584a50ad594bb5dd94e526123cc7c7a2">FACT_KINGPIN_KNOWS_MONEY_GONE</a>, 2 );
<a name="l00620"></a>00620       }
<a name="l00621"></a>00621 
<a name="l00622"></a>00622 }
<a name="l00623"></a>00623 
<a name="l00624"></a><a class="code" href="Strategic_01Event_01Handler_8h.html#3440cdc0d2215221d29787ca9982afa6">00624</a> <span class="keywordtype">void</span> <a class="code" href="Strategic_01Event_01Handler_8cpp.html#3440cdc0d2215221d29787ca9982afa6">HandleNPCSystemEvent</a>( <a class="code" href="Types_8h.html#e1e6edbbc26d6fbc71a90190d0266018">UINT32</a> uiEvent )
<a name="l00625"></a>00625 {
<a name="l00626"></a>00626       <span class="keywordflow">if</span> (uiEvent &lt; NPC_SYSTEM_EVENT_ACTION_PARAM_BONUS)
<a name="l00627"></a>00627       {
<a name="l00628"></a>00628             <span class="keywordflow">switch</span>( uiEvent )
<a name="l00629"></a>00629             {
<a name="l00630"></a>00630                   <span class="keywordflow">case</span> <a class="code" href="Quests_8h.html#aead3e57f613f07868a1b2afb6b943f195ef56e476ac8bb9b6ba7283f41d29da">FACT_PABLOS_BRIBED</a>:
<a name="l00631"></a>00631                         <span class="comment">// set Pacos to unbribed</span>
<a name="l00632"></a>00632                         <a class="code" href="Strategic_01Event_01Handler_8cpp.html#3d9a93eb956813e42bda14827350a656">SetPabloToUnbribed</a>();
<a name="l00633"></a>00633                         <span class="keywordflow">break</span>;
<a name="l00634"></a>00634 
<a name="l00635"></a>00635                   <span class="keywordflow">case</span> <a class="code" href="Quests_8h.html#aead3e57f613f07868a1b2afb6b943f1893a0b265758ee66e4c912cef1b9e75b">FACT_REALLY_NEW_BOBBYRAY_SHIPMENT_WAITING</a>:
<a name="l00636"></a>00636                         <span class="comment">// the shipment is no longer really new</span>
<a name="l00637"></a>00637                         <a class="code" href="Quests_8cpp.html#367aad061aefa5a73a4ac3fda10511b3">SetFactFalse</a>( <a class="code" href="Quests_8h.html#aead3e57f613f07868a1b2afb6b943f1893a0b265758ee66e4c912cef1b9e75b">FACT_REALLY_NEW_BOBBYRAY_SHIPMENT_WAITING</a> );
<a name="l00638"></a>00638                         <span class="keywordflow">if</span> (<a class="code" href="Quests_8cpp.html#6744b59d27bf2791d0c2fefe18e548d3">CheckFact</a>( <a class="code" href="Quests_8h.html#aead3e57f613f07868a1b2afb6b943f1d2c2d0d90f1e7beb6e871f1a0acf2431">FACT_LARGE_SIZED_SHIPMENT_WAITING</a>, 0 ))
<a name="l00639"></a>00639                         {
<a name="l00640"></a>00640                               <span class="comment">// set "really heavy old shipment" fact</span>
<a name="l00641"></a>00641                               <a class="code" href="Quests_8cpp.html#d7278c1ec0f9cc2ac9af20f8a6b446db">SetFactTrue</a>( <a class="code" href="Quests_8h.html#aead3e57f613f07868a1b2afb6b943f1a45a42d888603845215916a6d0388bc7">FACT_LARGE_SIZED_OLD_SHIPMENT_WAITING</a> );
<a name="l00642"></a>00642                         }                       
<a name="l00643"></a>00643                         <span class="keywordflow">break</span>;
<a name="l00644"></a>00644 
<a name="l00645"></a>00645                   <span class="keywordflow">case</span> <a class="code" href="Quests_8h.html#aead3e57f613f07868a1b2afb6b943f1e6769109027a1890620bdcc5ee83bb2f">FACT_SHIPMENT_DELAYED_24_HOURS</a>:
<a name="l00646"></a>00646                   <span class="keywordflow">case</span> <a class="code" href="Quests_8h.html#aead3e57f613f07868a1b2afb6b943f1953b50d02a0d2a67eece2167e9ce3341">FACT_24_HOURS_SINCE_DOCTOR_TALKED_TO</a>:
<a name="l00647"></a>00647                   <span class="keywordflow">case</span> <a class="code" href="Quests_8h.html#aead3e57f613f07868a1b2afb6b943f1bbdf63d42f179a3a30d96e371338125e">FACT_24_HOURS_SINCE_JOEY_RESCUED</a>:
<a name="l00648"></a>00648                         <a class="code" href="Quests_8cpp.html#d7278c1ec0f9cc2ac9af20f8a6b446db">SetFactTrue</a>( (<a class="code" href="Types_8h.html#09f1a1fb2293e33483cc8d44aefb1eb1">UINT16</a>) uiEvent );
<a name="l00649"></a>00649                         <span class="keywordflow">break</span>;
<a name="l00650"></a>00650 
<a name="l00651"></a>00651                   <span class="keywordflow">case</span> <a class="code" href="Quests_8h.html#aead3e57f613f07868a1b2afb6b943f1584a50ad594bb5dd94e526123cc7c7a2">FACT_KINGPIN_KNOWS_MONEY_GONE</a>:
<a name="l00652"></a>00652                         <span class="comment">// more generally events for kingpin quest</span>
<a name="l00653"></a>00653                         <span class="keywordflow">if</span> ( <a class="code" href="Quests_8cpp.html#6744b59d27bf2791d0c2fefe18e548d3">CheckFact</a>( <a class="code" href="Quests_8h.html#aead3e57f613f07868a1b2afb6b943f1584a50ad594bb5dd94e526123cc7c7a2">FACT_KINGPIN_KNOWS_MONEY_GONE</a>, 0 ) == FALSE )
<a name="l00654"></a>00654                         {
<a name="l00655"></a>00655                               <span class="comment">// check for real whether to start quest</span>
<a name="l00656"></a>00656                               <a class="code" href="Strategic_01Event_01Handler_8cpp.html#114f3a51b15d80423c5cf2f25601ff5d">CheckForKingpinsMoneyMissing</a>( FALSE );
<a name="l00657"></a>00657                         }
<a name="l00658"></a>00658                         <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( <a class="code" href="Quests_8cpp.html#6744b59d27bf2791d0c2fefe18e548d3">CheckFact</a>( <a class="code" href="Quests_8h.html#aead3e57f613f07868a1b2afb6b943f113228fb280e0247224b96156f3bcbbde">FACT_KINGPIN_DEAD</a>, 0 ) == FALSE )
<a name="l00659"></a>00659                         {
<a name="l00660"></a>00660                               <span class="keywordflow">if</span> ( <a class="code" href="Quests_8cpp.html#b371f5479136d9c6e6debcb700a5c809">gubQuest</a>[ <a class="code" href="Quests_8h.html#2f2591166460d6d958c50f3317939e2284a47dcaec1227deb6065c1122e4948c">QUEST_KINGPIN_MONEY</a> ] == QUESTNOTSTARTED )
<a name="l00661"></a>00661                               {
<a name="l00662"></a>00662                                     <span class="comment">// KP knows money is gone, hasn't told player, if this event is called then the 2</span>
<a name="l00663"></a>00663                                     <span class="comment">// days are up... send email</span>
<a name="l00664"></a>00664                                     <a class="code" href="email_8cpp.html#a8c94e8b550c28723c1e587381bd874e">AddEmail</a>( KING_PIN_LETTER, KING_PIN_LETTER_LENGTH, <a class="code" href="email_8h.html#83e8bc15645f9d99ab91a152bb3dc8ceefafc14f5bc24fd5379151192881993b">KING_PIN</a>, <a class="code" href="Game_01Clock_8cpp.html#4d255e800fba4d64144a7639d5f3421d">GetWorldTotalMin</a>() );
<a name="l00665"></a>00665                                     <a class="code" href="Quests_8cpp.html#b15ae2863af85cdf282fef27e4e33efb">StartQuest</a>( <a class="code" href="Quests_8h.html#2f2591166460d6d958c50f3317939e2284a47dcaec1227deb6065c1122e4948c">QUEST_KINGPIN_MONEY</a>, 5, MAP_ROW_D );
<a name="l00666"></a>00666                                     <span class="comment">// add event to send terrorists two days from now</span>
<a name="l00667"></a>00667                                     <a class="code" href="Game_01Event_01Hook_8h.html#c1e7564b090f3b2dc02297940efbedc1">AddFutureDayStrategicEvent</a>( EVENT_SET_BY_NPC_SYSTEM, <a class="code" href="Random_8cpp.html#49f938d1313ab6ef09ac6223a16ac334">Random</a>( 120 ), <a class="code" href="Quests_8h.html#aead3e57f613f07868a1b2afb6b943f1584a50ad594bb5dd94e526123cc7c7a2">FACT_KINGPIN_KNOWS_MONEY_GONE</a>, 2 );
<a name="l00668"></a>00668                               }
<a name="l00669"></a>00669                               <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( <a class="code" href="Quests_8cpp.html#b371f5479136d9c6e6debcb700a5c809">gubQuest</a>[ <a class="code" href="Quests_8h.html#2f2591166460d6d958c50f3317939e2284a47dcaec1227deb6065c1122e4948c">QUEST_KINGPIN_MONEY</a> ] == QUESTINPROGRESS )
<a name="l00670"></a>00670                               {
<a name="l00671"></a>00671                                     <span class="comment">// knows money gone, quest is still in progress</span>
<a name="l00672"></a>00672                                     <span class="comment">// event indicates Kingpin can start to send terrorists</span>
<a name="l00673"></a>00673                                     <a class="code" href="Quests_8cpp.html#d7278c1ec0f9cc2ac9af20f8a6b446db">SetFactTrue</a>( <a class="code" href="Quests_8h.html#aead3e57f613f07868a1b2afb6b943f125f963c19ca8717e55664cb663404dc4">FACT_KINGPIN_CAN_SEND_ASSASSINS</a> );
<a name="l00674"></a>00674                                     <a class="code" href="Soldier_01Profile_8cpp.html#1bcff2c50b375b1eb32800aa12000289">gMercProfiles</a>[ <a class="code" href="Soldier_01Profile_8h.html#acaa92dcb344e96138c964deae3e2fa10274d7d073c57904888268c294f4820a">SPIKE</a> ].<a class="code" href="structMERCPROFILESTRUCT.html#b0d6f66ec41a0d9c87fbc03dd9fed965">sSectorX</a> = 5;
<a name="l00675"></a>00675                                     <a class="code" href="Soldier_01Profile_8cpp.html#1bcff2c50b375b1eb32800aa12000289">gMercProfiles</a>[ <a class="code" href="Soldier_01Profile_8h.html#acaa92dcb344e96138c964deae3e2fa10274d7d073c57904888268c294f4820a">SPIKE</a> ].<a class="code" href="structMERCPROFILESTRUCT.html#e3caff1f000b3ed3c382e8a1f0d5fdbc">sSectorY</a> = MAP_ROW_C;
<a name="l00676"></a>00676                                     <a class="code" href="Overhead_8cpp.html#46bd754f8875c305ab18731ed10e3364">gTacticalStatus</a>.<a class="code" href="structTacticalStatusType.html#879449ac79e1f0135ef15c76469bc7a8">fCivGroupHostile</a>[ <a class="code" href="Overhead_01Types_8h.html#e6cdb622357fec6e889e47579a0785249cebb97519ab2d7c94dabe2509bef978">KINGPIN_CIV_GROUP</a> ] = CIV_GROUP_WILL_BECOME_HOSTILE;
<a name="l00677"></a>00677                               }
<a name="l00678"></a>00678                         }
<a name="l00679"></a>00679                         <span class="keywordflow">break</span>;
<a name="l00680"></a>00680             }
<a name="l00681"></a>00681       }
<a name="l00682"></a>00682       <span class="keywordflow">else</span>
<a name="l00683"></a>00683       {
<a name="l00684"></a>00684             <span class="keywordflow">switch</span>( uiEvent - NPC_SYSTEM_EVENT_ACTION_PARAM_BONUS )
<a name="l00685"></a>00685             {
<a name="l00686"></a>00686                   <span class="keywordflow">case</span> <a class="code" href="interface_01Dialogue_8h.html#2ae95ea8e60178fe99580d5142f0ec7ee9681222789a30d98eccb652eb8a23b6">NPC_ACTION_RETURN_STOLEN_SHIPMENT_ITEMS</a>:
<a name="l00687"></a>00687                         <a class="code" href="Strategic_01Event_01Handler_8cpp.html#717a5aa48b207596c1044d6300206780">HandleDelayedItemsArrival</a>( uiEvent );
<a name="l00688"></a>00688                         <span class="keywordflow">break</span>;
<a name="l00689"></a>00689                   <span class="keywordflow">case</span> <a class="code" href="interface_01Dialogue_8h.html#2ae95ea8e60178fe99580d5142f0ec7e44d2e1388bdab3fc137c145ebd1a943e">NPC_ACTION_SET_RANDOM_PACKAGE_DAMAGE_TIMER</a>:
<a name="l00690"></a>00690                         <a class="code" href="Strategic_01Event_01Handler_8cpp.html#f713d9d01c600cd8c13ab5d88d404f4a">HandlePossiblyDamagedPackage</a>();
<a name="l00691"></a>00691                         <span class="keywordflow">break</span>;
<a name="l00692"></a>00692                   <span class="keywordflow">case</span> <a class="code" href="interface_01Dialogue_8h.html#2ae95ea8e60178fe99580d5142f0ec7e7d45ed6fd9159882b82949f332e796d7">NPC_ACTION_ENABLE_CAMBRIA_DOCTOR_BONUS</a>:
<a name="l00693"></a>00693                         <a class="code" href="Quests_8cpp.html#d7278c1ec0f9cc2ac9af20f8a6b446db">SetFactTrue</a>( <a class="code" href="Quests_8h.html#aead3e57f613f07868a1b2afb6b943f1fdab375baa695f712a348a408d091912">FACT_WILLIS_HEARD_ABOUT_JOEY_RESCUE</a> );
<a name="l00694"></a>00694                         <span class="keywordflow">break</span>;
<a name="l00695"></a>00695                   <span class="keywordflow">case</span> <a class="code" href="interface_01Dialogue_8h.html#2ae95ea8e60178fe99580d5142f0ec7e0debc0be288e7448cbacd90967faedd2">NPC_ACTION_TRIGGER_END_OF_FOOD_QUEST</a>:
<a name="l00696"></a>00696                         <span class="keywordflow">if</span> ( <a class="code" href="Soldier_01Profile_8cpp.html#1bcff2c50b375b1eb32800aa12000289">gMercProfiles</a>[ <a class="code" href="Soldier_01Profile_8h.html#acaa92dcb344e96138c964deae3e2fa178cb5bfb5a33927e8291aff708638b59">FATHER</a> ].bMercStatus != MERC_IS_DEAD )
<a name="l00697"></a>00697                         {
<a name="l00698"></a>00698                               <a class="code" href="Quests_8cpp.html#f692eb37d514044c56e66c65c84805aa">EndQuest</a>( <a class="code" href="Quests_8h.html#2f2591166460d6d958c50f3317939e223537111203a6fa21715f8cf70738451a">QUEST_FOOD_ROUTE</a>, 10, MAP_ROW_A );
<a name="l00699"></a>00699                               <a class="code" href="Quests_8cpp.html#d7278c1ec0f9cc2ac9af20f8a6b446db">SetFactTrue</a>( <a class="code" href="Quests_8h.html#aead3e57f613f07868a1b2afb6b943f107968fd82283e4dff701aa985a5b1850">FACT_FOOD_QUEST_OVER</a> );
<a name="l00700"></a>00700                         }
<a name="l00701"></a>00701                         <span class="keywordflow">break</span>;
<a name="l00702"></a>00702                   <span class="keywordflow">case</span> <a class="code" href="interface_01Dialogue_8h.html#2ae95ea8e60178fe99580d5142f0ec7e4c9d773a17e9b6b7c728f9a12a3821d3">NPC_ACTION_DELAYED_MAKE_BRENDA_LEAVE</a>:
<a name="l00703"></a>00703                         <span class="comment">//IC:  </span>
<a name="l00704"></a>00704                         <span class="comment">//TriggerNPCRecord( 85, 9 );</span>
<a name="l00705"></a>00705                         <a class="code" href="Quests_8cpp.html#d7278c1ec0f9cc2ac9af20f8a6b446db">SetFactTrue</a>( <a class="code" href="Quests_8h.html#aead3e57f613f07868a1b2afb6b943f1702a870da8cb0080d8255526affface7">FACT_BRENDA_PATIENCE_TIMER_EXPIRED</a> );
<a name="l00706"></a>00706                         <span class="keywordflow">break</span>;
<a name="l00707"></a>00707                   <span class="keywordflow">case</span> <a class="code" href="interface_01Dialogue_8h.html#2ae95ea8e60178fe99580d5142f0ec7edb8ba516a18255bc54c159faaf02f854">NPC_ACTION_SET_DELAY_TILL_GIRLS_AVAILABLE</a>:
<a name="l00708"></a>00708                         <a class="code" href="Interface_01Dialogue_8cpp.html#584dff7dd6df4aa518083d0fe53a8bf5">HandleNPCDoAction</a>( 107, <a class="code" href="interface_01Dialogue_8h.html#2ae95ea8e60178fe99580d5142f0ec7e87bd802ddc2797173e453875f9d2f247">NPC_ACTION_SET_GIRLS_AVAILABLE</a>, 0 );
<a name="l00709"></a>00709                         <span class="keywordflow">break</span>;
<a name="l00710"></a>00710 
<a name="l00711"></a>00711                   <span class="keywordflow">case</span> <a class="code" href="interface_01Dialogue_8h.html#2ae95ea8e60178fe99580d5142f0ec7e69abce1bed28e34516b097410db47b09">NPC_ACTION_READY_ROBOT</a>:
<a name="l00712"></a>00712                         {
<a name="l00713"></a>00713                               <span class="keywordflow">if</span> ( <a class="code" href="Quests_8cpp.html#6744b59d27bf2791d0c2fefe18e548d3">CheckFact</a>( <a class="code" href="Quests_8h.html#aead3e57f613f07868a1b2afb6b943f196bb7fb4dc6ac352b0473f350c6cb682">FACT_FIRST_ROBOT_DESTROYED</a>, 0 ) )
<a name="l00714"></a>00714                               {
<a name="l00715"></a>00715                                     <span class="comment">// second robot ready</span>
<a name="l00716"></a>00716                                     <a class="code" href="Quests_8cpp.html#d7278c1ec0f9cc2ac9af20f8a6b446db">SetFactTrue</a>( <a class="code" href="Quests_8h.html#aead3e57f613f07868a1b2afb6b943f18c78e40483ea86239fffe924bd47c4b5">FACT_ROBOT_READY_SECOND_TIME</a> );
<a name="l00717"></a>00717                                     <span class="comment">// resurrect robot</span>
<a name="l00718"></a>00718                                     <a class="code" href="Soldier_01Profile_8cpp.html#1bcff2c50b375b1eb32800aa12000289">gMercProfiles</a>[ <a class="code" href="Soldier_01Profile_8h.html#acaa92dcb344e96138c964deae3e2fa1abea9be20feeb2150a8ffbd68625beb4">ROBOT</a> ].<a class="code" href="structMERCPROFILESTRUCT.html#09fbcd22d7fc230711c52e75231d8f79">bLife</a> = <a class="code" href="Soldier_01Profile_8cpp.html#1bcff2c50b375b1eb32800aa12000289">gMercProfiles</a>[ <a class="code" href="Soldier_01Profile_8h.html#acaa92dcb344e96138c964deae3e2fa1abea9be20feeb2150a8ffbd68625beb4">ROBOT</a> ].<a class="code" href="structMERCPROFILESTRUCT.html#fa85b8afa8461cbbdb7eb533eed28e31">bLifeMax</a>;
<a name="l00719"></a>00719                                     <a class="code" href="Soldier_01Profile_8cpp.html#1bcff2c50b375b1eb32800aa12000289">gMercProfiles</a>[ <a class="code" href="Soldier_01Profile_8h.html#acaa92dcb344e96138c964deae3e2fa1abea9be20feeb2150a8ffbd68625beb4">ROBOT</a> ].<a class="code" href="structMERCPROFILESTRUCT.html#9ec016a24fb8317378ec2dce36253b0c">bMercStatus</a> = MERC_OK;
<a name="l00720"></a>00720                               }
<a name="l00721"></a>00721                               <span class="keywordflow">else</span>
<a name="l00722"></a>00722                               {
<a name="l00723"></a>00723                                     <span class="comment">// first robot ready</span>
<a name="l00724"></a>00724                                     <a class="code" href="Quests_8cpp.html#d7278c1ec0f9cc2ac9af20f8a6b446db">SetFactTrue</a>( <a class="code" href="Quests_8h.html#aead3e57f613f07868a1b2afb6b943f15e483ab2290fdb05cd8bda1a0ee5bd2d">FACT_ROBOT_READY</a> );
<a name="l00725"></a>00725                               }
<a name="l00726"></a>00726 
<a name="l00727"></a>00727                               <a class="code" href="Soldier_01Profile_8cpp.html#1bcff2c50b375b1eb32800aa12000289">gMercProfiles</a>[ <a class="code" href="Soldier_01Profile_8h.html#acaa92dcb344e96138c964deae3e2fa1abea9be20feeb2150a8ffbd68625beb4">ROBOT</a> ].<a class="code" href="structMERCPROFILESTRUCT.html#b0d6f66ec41a0d9c87fbc03dd9fed965">sSectorX</a> = <a class="code" href="Soldier_01Profile_8cpp.html#1bcff2c50b375b1eb32800aa12000289">gMercProfiles</a>[ <a class="code" href="Soldier_01Profile_8h.html#acaa92dcb344e96138c964deae3e2fa1e3e70fd0c3400c224c8acd33955e52e6">MADLAB</a> ].<a class="code" href="structMERCPROFILESTRUCT.html#b0d6f66ec41a0d9c87fbc03dd9fed965">sSectorX</a>;
<a name="l00728"></a>00728                               <a class="code" href="Soldier_01Profile_8cpp.html#1bcff2c50b375b1eb32800aa12000289">gMercProfiles</a>[ <a class="code" href="Soldier_01Profile_8h.html#acaa92dcb344e96138c964deae3e2fa1abea9be20feeb2150a8ffbd68625beb4">ROBOT</a> ].<a class="code" href="structMERCPROFILESTRUCT.html#e3caff1f000b3ed3c382e8a1f0d5fdbc">sSectorY</a> = <a class="code" href="Soldier_01Profile_8cpp.html#1bcff2c50b375b1eb32800aa12000289">gMercProfiles</a>[ <a class="code" href="Soldier_01Profile_8h.html#acaa92dcb344e96138c964deae3e2fa1e3e70fd0c3400c224c8acd33955e52e6">MADLAB</a> ].<a class="code" href="structMERCPROFILESTRUCT.html#e3caff1f000b3ed3c382e8a1f0d5fdbc">sSectorY</a>;
<a name="l00729"></a>00729                               <a class="code" href="Soldier_01Profile_8cpp.html#1bcff2c50b375b1eb32800aa12000289">gMercProfiles</a>[ <a class="code" href="Soldier_01Profile_8h.html#acaa92dcb344e96138c964deae3e2fa1abea9be20feeb2150a8ffbd68625beb4">ROBOT</a> ].<a class="code" href="structMERCPROFILESTRUCT.html#9dfd2271b790d94f55f142e71ab18065">bSectorZ</a> = <a class="code" href="Soldier_01Profile_8cpp.html#1bcff2c50b375b1eb32800aa12000289">gMercProfiles</a>[ <a class="code" href="Soldier_01Profile_8h.html#acaa92dcb344e96138c964deae3e2fa1e3e70fd0c3400c224c8acd33955e52e6">MADLAB</a> ].<a class="code" href="structMERCPROFILESTRUCT.html#9dfd2271b790d94f55f142e71ab18065">bSectorZ</a>;
<a name="l00730"></a>00730 
<a name="l00731"></a>00731 
<a name="l00732"></a>00732                         }
<a name="l00733"></a>00733                         <span class="keywordflow">break</span>;
<a name="l00734"></a>00734 
<a name="l00735"></a>00735                   <span class="keywordflow">case</span> <a class="code" href="interface_01Dialogue_8h.html#2ae95ea8e60178fe99580d5142f0ec7e76d5f847b7d192501f6eef7601012202">NPC_ACTION_ADD_JOEY_TO_WORLD</a>:
<a name="l00736"></a>00736                         <span class="comment">// If Joey is not dead, escorted, or already delivered</span>
<a name="l00737"></a>00737                         <span class="keywordflow">if</span> ( <a class="code" href="Soldier_01Profile_8cpp.html#1bcff2c50b375b1eb32800aa12000289">gMercProfiles</a>[ <a class="code" href="Soldier_01Profile_8h.html#acaa92dcb344e96138c964deae3e2fa150d65436faea8fa17961a3d6d8723fbb">JOEY</a> ].bMercStatus != MERC_IS_DEAD &amp;&amp; !<a class="code" href="Quests_8cpp.html#6744b59d27bf2791d0c2fefe18e548d3">CheckFact</a>( <a class="code" href="Quests_8h.html#aead3e57f613f07868a1b2afb6b943f13a74f8e53123b842c15ea02edb3bdf64">FACT_JOEY_ESCORTED</a>, 0 ) &amp;&amp; 
<a name="l00738"></a>00738                               <a class="code" href="Soldier_01Profile_8cpp.html#1bcff2c50b375b1eb32800aa12000289">gMercProfiles</a>[ <a class="code" href="Soldier_01Profile_8h.html#acaa92dcb344e96138c964deae3e2fa150d65436faea8fa17961a3d6d8723fbb">JOEY</a> ].sSectorX == 4 &amp;&amp;
<a name="l00739"></a>00739                               <a class="code" href="Soldier_01Profile_8cpp.html#1bcff2c50b375b1eb32800aa12000289">gMercProfiles</a>[ <a class="code" href="Soldier_01Profile_8h.html#acaa92dcb344e96138c964deae3e2fa150d65436faea8fa17961a3d6d8723fbb">JOEY</a> ].sSectorY == MAP_ROW_D &amp;&amp;
<a name="l00740"></a>00740                               <a class="code" href="Soldier_01Profile_8cpp.html#1bcff2c50b375b1eb32800aa12000289">gMercProfiles</a>[ <a class="code" href="Soldier_01Profile_8h.html#acaa92dcb344e96138c964deae3e2fa150d65436faea8fa17961a3d6d8723fbb">JOEY</a> ].bSectorZ == 1 )
<a name="l00741"></a>00741                         {
<a name="l00742"></a>00742                               <a class="code" href="structSOLDIERTYPE.html">SOLDIERTYPE</a> * pJoey;
<a name="l00743"></a>00743 
<a name="l00744"></a>00744                               pJoey = <a class="code" href="Soldier_01Profile_8cpp.html#2a54c4a06df8ed61529646f23682ef9d">FindSoldierByProfileID</a>( <a class="code" href="Soldier_01Profile_8h.html#acaa92dcb344e96138c964deae3e2fa150d65436faea8fa17961a3d6d8723fbb">JOEY</a>, FALSE );
<a name="l00745"></a>00745                               <span class="keywordflow">if</span> (pJoey )
<a name="l00746"></a>00746                               {
<a name="l00747"></a>00747                                     <span class="comment">// he's in the currently loaded sector...delay this an hour!</span>
<a name="l00748"></a>00748                                     <a class="code" href="Game_01Event_01Hook_8h.html#089bf822fe842514390c4e5774327ffa">AddSameDayStrategicEvent</a>( EVENT_SET_BY_NPC_SYSTEM, <a class="code" href="Game_01Clock_8cpp.html#c52790b3f2caff24dbd9d8aa2f4b8194">GetWorldMinutesInDay</a>() + 60, NPC_SYSTEM_EVENT_ACTION_PARAM_BONUS + <a class="code" href="interface_01Dialogue_8h.html#2ae95ea8e60178fe99580d5142f0ec7e76d5f847b7d192501f6eef7601012202">NPC_ACTION_ADD_JOEY_TO_WORLD</a> );
<a name="l00749"></a>00749                               }
<a name="l00750"></a>00750                               <span class="keywordflow">else</span>
<a name="l00751"></a>00751                               {
<a name="l00752"></a>00752                                     <span class="comment">// move Joey from caves to San Mona</span>
<a name="l00753"></a>00753                                     <a class="code" href="Soldier_01Profile_8cpp.html#1bcff2c50b375b1eb32800aa12000289">gMercProfiles</a>[ <a class="code" href="Soldier_01Profile_8h.html#acaa92dcb344e96138c964deae3e2fa150d65436faea8fa17961a3d6d8723fbb">JOEY</a> ].<a class="code" href="structMERCPROFILESTRUCT.html#b0d6f66ec41a0d9c87fbc03dd9fed965">sSectorX</a> = 5;
<a name="l00754"></a>00754                                     <a class="code" href="Soldier_01Profile_8cpp.html#1bcff2c50b375b1eb32800aa12000289">gMercProfiles</a>[ <a class="code" href="Soldier_01Profile_8h.html#acaa92dcb344e96138c964deae3e2fa150d65436faea8fa17961a3d6d8723fbb">JOEY</a> ].<a class="code" href="structMERCPROFILESTRUCT.html#e3caff1f000b3ed3c382e8a1f0d5fdbc">sSectorY</a> = MAP_ROW_C;
<a name="l00755"></a>00755                                     <a class="code" href="Soldier_01Profile_8cpp.html#1bcff2c50b375b1eb32800aa12000289">gMercProfiles</a>[ <a class="code" href="Soldier_01Profile_8h.html#acaa92dcb344e96138c964deae3e2fa150d65436faea8fa17961a3d6d8723fbb">JOEY</a> ].<a class="code" href="structMERCPROFILESTRUCT.html#9dfd2271b790d94f55f142e71ab18065">bSectorZ</a> = 0;
<a name="l00756"></a>00756                               }
<a name="l00757"></a>00757                         }
<a name="l00758"></a>00758                         <span class="keywordflow">break</span>;
<a name="l00759"></a>00759 
<a name="l00760"></a>00760                   <span class="keywordflow">case</span> <a class="code" href="interface_01Dialogue_8h.html#2ae95ea8e60178fe99580d5142f0ec7e8ea37cd9ebb1e2a727a9954f0dc8f2fd">NPC_ACTION_SEND_ENRICO_MIGUEL_EMAIL</a>:
<a name="l00761"></a>00761                         <a class="code" href="email_8cpp.html#a8c94e8b550c28723c1e587381bd874e">AddEmail</a>( ENRICO_MIGUEL, ENRICO_MIGUEL_LENGTH, <a class="code" href="email_8h.html#83e8bc15645f9d99ab91a152bb3dc8ce5bfd66eed0e2525e355ddaa593703e35">MAIL_ENRICO</a>, <a class="code" href="Game_01Clock_8cpp.html#4d255e800fba4d64144a7639d5f3421d">GetWorldTotalMin</a>() );
<a name="l00762"></a>00762                         <span class="keywordflow">break</span>;
<a name="l00763"></a>00763 
<a name="l00764"></a>00764                   <span class="keywordflow">case</span> <a class="code" href="interface_01Dialogue_8h.html#2ae95ea8e60178fe99580d5142f0ec7e5afc1844952f3f5be8db05d4a3ce71b6">NPC_ACTION_TIMER_FOR_VEHICLE</a>:
<a name="l00765"></a>00765                         <a class="code" href="Quests_8cpp.html#d7278c1ec0f9cc2ac9af20f8a6b446db">SetFactTrue</a>( <a class="code" href="Quests_8h.html#aead3e57f613f07868a1b2afb6b943f1989b9dab7ec30abf69706c185010e8a8">FACT_OK_USE_HUMMER</a> );
<a name="l00766"></a>00766                         <span class="keywordflow">break</span>;
<a name="l00767"></a>00767 
<a name="l00768"></a>00768                   <span class="keywordflow">case</span> <a class="code" href="interface_01Dialogue_8h.html#2ae95ea8e60178fe99580d5142f0ec7eacec4e8883c08143c695bab68ca071ca">NPC_ACTION_FREE_KIDS</a>:
<a name="l00769"></a>00769                         <a class="code" href="Quests_8cpp.html#d7278c1ec0f9cc2ac9af20f8a6b446db">SetFactTrue</a>( <a class="code" href="Quests_8h.html#aead3e57f613f07868a1b2afb6b943f1b096d8c2783a3657e0d4d562fba9abbc">FACT_KIDS_ARE_FREE</a> );
<a name="l00770"></a>00770                         <span class="keywordflow">break</span>;
<a name="l00771"></a>00771 
<a name="l00772"></a>00772                   <span class="keywordflow">default</span>:
<a name="l00773"></a>00773                         <span class="keywordflow">break</span>;
<a name="l00774"></a>00774             }
<a name="l00775"></a>00775       }
<a name="l00776"></a>00776 }
<a name="l00777"></a>00777 
<a name="l00778"></a><a class="code" href="Strategic_01Event_01Handler_8h.html#7eb0eb6e2ada1e8e675bc9a38fa8065a">00778</a> <span class="keywordtype">void</span> <a class="code" href="Strategic_01Event_01Handler_8cpp.html#7eb0eb6e2ada1e8e675bc9a38fa8065a">HandleEarlyMorningEvents</a>( <span class="keywordtype">void</span> )
<a name="l00779"></a>00779 {
<a name="l00780"></a>00780       <a class="code" href="Types_8h.html#e1e6edbbc26d6fbc71a90190d0266018">UINT32</a>                              cnt;
<a name="l00781"></a>00781       <a class="code" href="Types_8h.html#e1e6edbbc26d6fbc71a90190d0266018">UINT32</a>                              uiAmount;
<a name="l00782"></a>00782 
<a name="l00783"></a>00783       <span class="comment">// loop through all *NPCs* and reset "default response used recently" flags</span>
<a name="l00784"></a>00784       <span class="keywordflow">for</span> (cnt = FIRST_RPC; cnt &lt; <a class="code" href="Soldier_01Profile_8h.html#acaa92dcb344e96138c964deae3e2fa150c510db5aaca8d588a456f077a86a2d">GASTON</a>; cnt++)
<a name="l00785"></a>00785       {
<a name="l00786"></a>00786             <a class="code" href="Soldier_01Profile_8cpp.html#1bcff2c50b375b1eb32800aa12000289">gMercProfiles</a>[cnt].bFriendlyOrDirectDefaultResponseUsedRecently = FALSE;
<a name="l00787"></a>00787             <a class="code" href="Soldier_01Profile_8cpp.html#1bcff2c50b375b1eb32800aa12000289">gMercProfiles</a>[cnt].<a class="code" href="structMERCPROFILESTRUCT.html#451da30b88c4a9f17d086488e49558f7">bRecruitDefaultResponseUsedRecently</a> = FALSE;
<a name="l00788"></a>00788             <a class="code" href="Soldier_01Profile_8cpp.html#1bcff2c50b375b1eb32800aa12000289">gMercProfiles</a>[cnt].<a class="code" href="structMERCPROFILESTRUCT.html#05e3f545bc0d05686b22453106aac3a4">bThreatenDefaultResponseUsedRecently</a> = FALSE;
<a name="l00789"></a>00789             <a class="code" href="Soldier_01Profile_8cpp.html#1bcff2c50b375b1eb32800aa12000289">gMercProfiles</a>[cnt].<a class="code" href="structMERCPROFILESTRUCT.html#5870da43a6570a9906fa8e5439ac9991">ubMiscFlags2</a> &amp;= (~PROFILE_MISC_FLAG2_BANDAGED_TODAY);
<a name="l00790"></a>00790       }
<a name="l00791"></a>00791       <span class="comment">// reset Father Walker's drunkenness level!</span>
<a name="l00792"></a>00792       <a class="code" href="Soldier_01Profile_8cpp.html#1bcff2c50b375b1eb32800aa12000289">gMercProfiles</a>[ <a class="code" href="Soldier_01Profile_8h.html#acaa92dcb344e96138c964deae3e2fa178cb5bfb5a33927e8291aff708638b59">FATHER</a> ].<a class="code" href="structMERCPROFILESTRUCT.html#2383e5671eb993c3061bad92ab884550">bNPCData</a> = (<a class="code" href="Types_8h.html#7ebe70ceca856797319175e30bcf003d">INT8</a>) <a class="code" href="Random_8cpp.html#49f938d1313ab6ef09ac6223a16ac334">Random</a>( 4 );
<a name="l00793"></a>00793       <span class="comment">// set Walker's location</span>
<a name="l00794"></a>00794       <span class="keywordflow">if</span> ( <a class="code" href="Random_8cpp.html#49f938d1313ab6ef09ac6223a16ac334">Random</a>( 2 ) )
<a name="l00795"></a>00795       {
<a name="l00796"></a>00796             <span class="comment">// move the father to the other sector, provided neither are loaded</span>
<a name="l00797"></a>00797             <span class="keywordflow">if</span> ( ! ( ( <a class="code" href="strategicmap_8cpp.html#49d9aed144a633fda4ba1990f002d703">gWorldSectorX</a> == 13) &amp;&amp; ( ( <a class="code" href="strategicmap_8cpp.html#ea322310ced0e35ee18a2ee7b32aac5b">gWorldSectorY</a> == MAP_ROW_C) || <a class="code" href="strategicmap_8cpp.html#ea322310ced0e35ee18a2ee7b32aac5b">gWorldSectorY</a> == MAP_ROW_D ) &amp;&amp; ( <a class="code" href="strategicmap_8cpp.html#da715721a8ceedd42acf6ddb33e63ce0">gbWorldSectorZ</a> == 0 ) ) )
<a name="l00798"></a>00798             {
<a name="l00799"></a>00799                   <a class="code" href="Soldier_01Profile_8cpp.html#1bcff2c50b375b1eb32800aa12000289">gMercProfiles</a>[ <a class="code" href="Soldier_01Profile_8h.html#acaa92dcb344e96138c964deae3e2fa178cb5bfb5a33927e8291aff708638b59">FATHER</a> ].sSectorX = 13;
<a name="l00800"></a>00800                   <span class="comment">// swap his location</span>
<a name="l00801"></a>00801                   <span class="keywordflow">if</span> (<a class="code" href="Soldier_01Profile_8cpp.html#1bcff2c50b375b1eb32800aa12000289">gMercProfiles</a>[ <a class="code" href="Soldier_01Profile_8h.html#acaa92dcb344e96138c964deae3e2fa178cb5bfb5a33927e8291aff708638b59">FATHER</a> ].sSectorY == MAP_ROW_C)
<a name="l00802"></a>00802                   {
<a name="l00803"></a>00803                         <a class="code" href="Soldier_01Profile_8cpp.html#1bcff2c50b375b1eb32800aa12000289">gMercProfiles</a>[ <a class="code" href="Soldier_01Profile_8h.html#acaa92dcb344e96138c964deae3e2fa178cb5bfb5a33927e8291aff708638b59">FATHER</a> ].sSectorY = MAP_ROW_D;
<a name="l00804"></a>00804                   }
<a name="l00805"></a>00805                   <span class="keywordflow">else</span>
<a name="l00806"></a>00806                   {
<a name="l00807"></a>00807                         <a class="code" href="Soldier_01Profile_8cpp.html#1bcff2c50b375b1eb32800aa12000289">gMercProfiles</a>[ <a class="code" href="Soldier_01Profile_8h.html#acaa92dcb344e96138c964deae3e2fa178cb5bfb5a33927e8291aff708638b59">FATHER</a> ].<a class="code" href="structMERCPROFILESTRUCT.html#e3caff1f000b3ed3c382e8a1f0d5fdbc">sSectorY</a> = MAP_ROW_C;
<a name="l00808"></a>00808                   }
<a name="l00809"></a>00809             }
<a name="l00810"></a>00810       }
<a name="l00811"></a>00811       
<a name="l00812"></a>00812 
<a name="l00813"></a>00813       <span class="keywordflow">if</span>( <a class="code" href="Soldier_01Profile_8cpp.html#1bcff2c50b375b1eb32800aa12000289">gMercProfiles</a>[ <a class="code" href="Soldier_01Profile_8h.html#acaa92dcb344e96138c964deae3e2fa1cf72cbaf4c89fc240465f4d1397a5b8c">TONY</a> ].ubLastDateSpokenTo &gt; 0 &amp;&amp; !( <a class="code" href="strategicmap_8cpp.html#49d9aed144a633fda4ba1990f002d703">gWorldSectorX</a> == 5 &amp;&amp; <a class="code" href="strategicmap_8cpp.html#ea322310ced0e35ee18a2ee7b32aac5b">gWorldSectorY</a> == MAP_ROW_C &amp;&amp; <a class="code" href="strategicmap_8cpp.html#da715721a8ceedd42acf6ddb33e63ce0">gbWorldSectorZ</a> == 0 ) )
<a name="l00814"></a>00814       {
<a name="l00815"></a>00815             <span class="comment">// San Mona C5 is not loaded so make Tony possibly not available</span>
<a name="l00816"></a>00816             <span class="keywordflow">if</span> (<a class="code" href="Random_8cpp.html#49f938d1313ab6ef09ac6223a16ac334">Random</a>( 4 ))
<a name="l00817"></a>00817             {
<a name="l00818"></a>00818                   <span class="comment">// Tony IS available</span>
<a name="l00819"></a>00819                   <a class="code" href="Quests_8cpp.html#367aad061aefa5a73a4ac3fda10511b3">SetFactFalse</a>( <a class="code" href="Quests_8h.html#aead3e57f613f07868a1b2afb6b943f14170888e83e132a457ed8310bcb723e1">FACT_TONY_NOT_AVAILABLE</a> );
<a name="l00820"></a>00820                   <a class="code" href="Soldier_01Profile_8cpp.html#1bcff2c50b375b1eb32800aa12000289">gMercProfiles</a>[ <a class="code" href="Soldier_01Profile_8h.html#acaa92dcb344e96138c964deae3e2fa1cf72cbaf4c89fc240465f4d1397a5b8c">TONY</a> ].<a class="code" href="structMERCPROFILESTRUCT.html#b0d6f66ec41a0d9c87fbc03dd9fed965">sSectorX</a> = 5;
<a name="l00821"></a>00821                   <a class="code" href="Soldier_01Profile_8cpp.html#1bcff2c50b375b1eb32800aa12000289">gMercProfiles</a>[ <a class="code" href="Soldier_01Profile_8h.html#acaa92dcb344e96138c964deae3e2fa1cf72cbaf4c89fc240465f4d1397a5b8c">TONY</a> ].<a class="code" href="structMERCPROFILESTRUCT.html#e3caff1f000b3ed3c382e8a1f0d5fdbc">sSectorY</a> = MAP_ROW_C;
<a name="l00822"></a>00822             }
<a name="l00823"></a>00823             <span class="keywordflow">else</span>
<a name="l00824"></a>00824             {
<a name="l00825"></a>00825                   <span class="comment">// Tony is NOT available</span>
<a name="l00826"></a>00826                   <a class="code" href="Quests_8cpp.html#d7278c1ec0f9cc2ac9af20f8a6b446db">SetFactTrue</a>( <a class="code" href="Quests_8h.html#aead3e57f613f07868a1b2afb6b943f14170888e83e132a457ed8310bcb723e1">FACT_TONY_NOT_AVAILABLE</a> );
<a name="l00827"></a>00827                   <a class="code" href="Soldier_01Profile_8cpp.html#1bcff2c50b375b1eb32800aa12000289">gMercProfiles</a>[ <a class="code" href="Soldier_01Profile_8h.html#acaa92dcb344e96138c964deae3e2fa1cf72cbaf4c89fc240465f4d1397a5b8c">TONY</a> ].<a class="code" href="structMERCPROFILESTRUCT.html#b0d6f66ec41a0d9c87fbc03dd9fed965">sSectorX</a> = 0;
<a name="l00828"></a>00828                   <a class="code" href="Soldier_01Profile_8cpp.html#1bcff2c50b375b1eb32800aa12000289">gMercProfiles</a>[ <a class="code" href="Soldier_01Profile_8h.html#acaa92dcb344e96138c964deae3e2fa1cf72cbaf4c89fc240465f4d1397a5b8c">TONY</a> ].<a class="code" href="structMERCPROFILESTRUCT.html#e3caff1f000b3ed3c382e8a1f0d5fdbc">sSectorY</a> = 0;
<a name="l00829"></a>00829             }
<a name="l00830"></a>00830       }
<a name="l00831"></a>00831 
<a name="l00832"></a>00832 
<a name="l00833"></a>00833       <span class="keywordflow">if</span> ( <a class="code" href="Soldier_01Profile_8cpp.html#1bcff2c50b375b1eb32800aa12000289">gMercProfiles</a>[ <a class="code" href="Soldier_01Profile_8h.html#acaa92dcb344e96138c964deae3e2fa1a7b01111f61e6e4c37c9083bd91b0d20">DEVIN</a> ].ubLastDateSpokenTo == 0 )
<a name="l00834"></a>00834       {
<a name="l00835"></a>00835             <span class="comment">// Does Devin move?</span>
<a name="l00836"></a>00836             <a class="code" href="Soldier_01Profile_8cpp.html#1bcff2c50b375b1eb32800aa12000289">gMercProfiles</a>[ <a class="code" href="Soldier_01Profile_8h.html#acaa92dcb344e96138c964deae3e2fa1a7b01111f61e6e4c37c9083bd91b0d20">DEVIN</a> ].<a class="code" href="structMERCPROFILESTRUCT.html#2383e5671eb993c3061bad92ab884550">bNPCData</a>++;
<a name="l00837"></a>00837             <span class="keywordflow">if</span> ( <a class="code" href="Soldier_01Profile_8cpp.html#1bcff2c50b375b1eb32800aa12000289">gMercProfiles</a>[ <a class="code" href="Soldier_01Profile_8h.html#acaa92dcb344e96138c964deae3e2fa1a7b01111f61e6e4c37c9083bd91b0d20">DEVIN</a> ].bNPCData &gt; 3 )
<a name="l00838"></a>00838             {
<a name="l00839"></a>00839                   <span class="keywordflow">if</span> ( ! ( (<a class="code" href="strategicmap_8cpp.html#49d9aed144a633fda4ba1990f002d703">gWorldSectorX</a> == <a class="code" href="Soldier_01Profile_8cpp.html#1bcff2c50b375b1eb32800aa12000289">gMercProfiles</a>[ <a class="code" href="Soldier_01Profile_8h.html#acaa92dcb344e96138c964deae3e2fa1a7b01111f61e6e4c37c9083bd91b0d20">DEVIN</a> ].sSectorX) &amp;&amp; (<a class="code" href="strategicmap_8cpp.html#ea322310ced0e35ee18a2ee7b32aac5b">gWorldSectorY</a> == <a class="code" href="Soldier_01Profile_8cpp.html#1bcff2c50b375b1eb32800aa12000289">gMercProfiles</a>[<a class="code" href="Soldier_01Profile_8h.html#acaa92dcb344e96138c964deae3e2fa1a7b01111f61e6e4c37c9083bd91b0d20">DEVIN</a>].sSectorY) &amp;&amp; (<a class="code" href="strategicmap_8cpp.html#da715721a8ceedd42acf6ddb33e63ce0">gbWorldSectorZ</a> == 0) ) )
<a name="l00840"></a>00840                   {
<a name="l00841"></a>00841                         <span class="comment">// ok, Devin's sector not loaded, so time to move!</span>
<a name="l00842"></a>00842                         <span class="comment">// might be same sector as before, if so, oh well!</span>
<a name="l00843"></a>00843                         <span class="keywordflow">switch</span>( <a class="code" href="Random_8cpp.html#49f938d1313ab6ef09ac6223a16ac334">Random</a>( 5 ) )
<a name="l00844"></a>00844                         {
<a name="l00845"></a>00845                               <span class="keywordflow">case</span> 0:
<a name="l00846"></a>00846                                     <a class="code" href="Soldier_01Profile_8cpp.html#1bcff2c50b375b1eb32800aa12000289">gMercProfiles</a>[ <a class="code" href="Soldier_01Profile_8h.html#acaa92dcb344e96138c964deae3e2fa1a7b01111f61e6e4c37c9083bd91b0d20">DEVIN</a> ].<a class="code" href="structMERCPROFILESTRUCT.html#b0d6f66ec41a0d9c87fbc03dd9fed965">sSectorX</a> = 9;
<a name="l00847"></a>00847                                     <a class="code" href="Soldier_01Profile_8cpp.html#1bcff2c50b375b1eb32800aa12000289">gMercProfiles</a>[ <a class="code" href="Soldier_01Profile_8h.html#acaa92dcb344e96138c964deae3e2fa1a7b01111f61e6e4c37c9083bd91b0d20">DEVIN</a> ].<a class="code" href="structMERCPROFILESTRUCT.html#e3caff1f000b3ed3c382e8a1f0d5fdbc">sSectorY</a> = MAP_ROW_G;
<a name="l00848"></a>00848                                     <span class="keywordflow">break</span>;
<a name="l00849"></a>00849                               <span class="keywordflow">case</span> 1:
<a name="l00850"></a>00850                                     <a class="code" href="Soldier_01Profile_8cpp.html#1bcff2c50b375b1eb32800aa12000289">gMercProfiles</a>[ <a class="code" href="Soldier_01Profile_8h.html#acaa92dcb344e96138c964deae3e2fa1a7b01111f61e6e4c37c9083bd91b0d20">DEVIN</a> ].<a class="code" href="structMERCPROFILESTRUCT.html#b0d6f66ec41a0d9c87fbc03dd9fed965">sSectorX</a> = 13;
<a name="l00851"></a>00851                                     <a class="code" href="Soldier_01Profile_8cpp.html#1bcff2c50b375b1eb32800aa12000289">gMercProfiles</a>[ <a class="code" href="Soldier_01Profile_8h.html#acaa92dcb344e96138c964deae3e2fa1a7b01111f61e6e4c37c9083bd91b0d20">DEVIN</a> ].<a class="code" href="structMERCPROFILESTRUCT.html#e3caff1f000b3ed3c382e8a1f0d5fdbc">sSectorY</a> = MAP_ROW_D;
<a name="l00852"></a>00852                                     <span class="keywordflow">break</span>;
<a name="l00853"></a>00853                               <span class="keywordflow">case</span> 2:
<a name="l00854"></a>00854                                     <a class="code" href="Soldier_01Profile_8cpp.html#1bcff2c50b375b1eb32800aa12000289">gMercProfiles</a>[ <a class="code" href="Soldier_01Profile_8h.html#acaa92dcb344e96138c964deae3e2fa1a7b01111f61e6e4c37c9083bd91b0d20">DEVIN</a> ].<a class="code" href="structMERCPROFILESTRUCT.html#b0d6f66ec41a0d9c87fbc03dd9fed965">sSectorX</a> = 5;
<a name="l00855"></a>00855                                     <a class="code" href="Soldier_01Profile_8cpp.html#1bcff2c50b375b1eb32800aa12000289">gMercProfiles</a>[ <a class="code" href="Soldier_01Profile_8h.html#acaa92dcb344e96138c964deae3e2fa1a7b01111f61e6e4c37c9083bd91b0d20">DEVIN</a> ].<a class="code" href="structMERCPROFILESTRUCT.html#e3caff1f000b3ed3c382e8a1f0d5fdbc">sSectorY</a> = MAP_ROW_C;
<a name="l00856"></a>00856                                     <span class="keywordflow">break</span>;
<a name="l00857"></a>00857                               <span class="keywordflow">case</span> 3:
<a name="l00858"></a>00858                                     <a class="code" href="Soldier_01Profile_8cpp.html#1bcff2c50b375b1eb32800aa12000289">gMercProfiles</a>[ <a class="code" href="Soldier_01Profile_8h.html#acaa92dcb344e96138c964deae3e2fa1a7b01111f61e6e4c37c9083bd91b0d20">DEVIN</a> ].<a class="code" href="structMERCPROFILESTRUCT.html#b0d6f66ec41a0d9c87fbc03dd9fed965">sSectorX</a> = 2;
<a name="l00859"></a>00859                                     <a class="code" href="Soldier_01Profile_8cpp.html#1bcff2c50b375b1eb32800aa12000289">gMercProfiles</a>[ <a class="code" href="Soldier_01Profile_8h.html#acaa92dcb344e96138c964deae3e2fa1a7b01111f61e6e4c37c9083bd91b0d20">DEVIN</a> ].<a class="code" href="structMERCPROFILESTRUCT.html#e3caff1f000b3ed3c382e8a1f0d5fdbc">sSectorY</a> = MAP_ROW_H;
<a name="l00860"></a>00860                                     <span class="keywordflow">break</span>;
<a name="l00861"></a>00861                               <span class="keywordflow">case</span> 4:
<a name="l00862"></a>00862                                     <a class="code" href="Soldier_01Profile_8cpp.html#1bcff2c50b375b1eb32800aa12000289">gMercProfiles</a>[ <a class="code" href="Soldier_01Profile_8h.html#acaa92dcb344e96138c964deae3e2fa1a7b01111f61e6e4c37c9083bd91b0d20">DEVIN</a> ].<a class="code" href="structMERCPROFILESTRUCT.html#b0d6f66ec41a0d9c87fbc03dd9fed965">sSectorX</a> = 6;
<a name="l00863"></a>00863                                     <a class="code" href="Soldier_01Profile_8cpp.html#1bcff2c50b375b1eb32800aa12000289">gMercProfiles</a>[ <a class="code" href="Soldier_01Profile_8h.html#acaa92dcb344e96138c964deae3e2fa1a7b01111f61e6e4c37c9083bd91b0d20">DEVIN</a> ].<a class="code" href="structMERCPROFILESTRUCT.html#e3caff1f000b3ed3c382e8a1f0d5fdbc">sSectorY</a> = MAP_ROW_C;
<a name="l00864"></a>00864                                     <span class="keywordflow">break</span>;                        
<a name="l00865"></a>00865                         }
<a name="l00866"></a>00866                   }
<a name="l00867"></a>00867             }
<a name="l00868"></a>00868       }
<a name="l00869"></a>00869 
<a name="l00870"></a>00870       <span class="comment">// Does Hamous move?</span>
<a name="l00871"></a>00871 
<a name="l00872"></a>00872       <span class="comment">// stop moving the truck if Hamous is dead!!</span>
<a name="l00873"></a>00873       <span class="comment">// stop moving them if the player has the truck or Hamous is hired!</span>
<a name="l00874"></a>00874       <span class="keywordflow">if</span> ( <a class="code" href="Soldier_01Profile_8cpp.html#1bcff2c50b375b1eb32800aa12000289">gMercProfiles</a>[ <a class="code" href="Soldier_01Profile_8h.html#acaa92dcb344e96138c964deae3e2fa1f11f73297a43c153b8691874f1444585">HAMOUS</a> ].bLife &gt; 0 &amp;&amp; <a class="code" href="Soldier_01Profile_8cpp.html#2a54c4a06df8ed61529646f23682ef9d">FindSoldierByProfileID</a>( <a class="code" href="Soldier_01Profile_8h.html#acaa92dcb344e96138c964deae3e2fa1f11f73297a43c153b8691874f1444585">HAMOUS</a>, TRUE ) == NULL &amp;&amp; <a class="code" href="Soldier_01Profile_8cpp.html#2a54c4a06df8ed61529646f23682ef9d">FindSoldierByProfileID</a>( <a class="code" href="Soldier_01Profile_8h.html#acaa92dcb344e96138c964deae3e2fa1e7e45b19afff6f86809bcd0b2df757f8">PROF_ICECREAM</a>, TRUE ) == NULL &amp;&amp; (! ( (<a class="code" href="strategicmap_8cpp.html#49d9aed144a633fda4ba1990f002d703">gWorldSectorX</a> == <a class="code" href="Soldier_01Profile_8cpp.html#1bcff2c50b375b1eb32800aa12000289">gMercProfiles</a>[ <a class="code" href="Soldier_01Profile_8h.html#acaa92dcb344e96138c964deae3e2fa1f11f73297a43c153b8691874f1444585">HAMOUS</a> ].sSectorX) &amp;&amp; (<a class="code" href="strategicmap_8cpp.html#ea322310ced0e35ee18a2ee7b32aac5b">gWorldSectorY</a> == <a class="code" href="Soldier_01Profile_8cpp.html#1bcff2c50b375b1eb32800aa12000289">gMercProfiles</a>[<a class="code" href="Soldier_01Profile_8h.html#acaa92dcb344e96138c964deae3e2fa1f11f73297a43c153b8691874f1444585">HAMOUS</a>].sSectorY) &amp;&amp; (<a class="code" href="strategicmap_8cpp.html#da715721a8ceedd42acf6ddb33e63ce0">gbWorldSectorZ</a> == 0) )) )
<a name="l00875"></a>00875       {
<a name="l00876"></a>00876             <span class="comment">// ok, HAMOUS's sector not loaded, so time to move!</span>
<a name="l00877"></a>00877             <span class="comment">// might be same sector as before, if so, oh well!</span>
<a name="l00878"></a>00878             <span class="keywordflow">switch</span>( <a class="code" href="Random_8cpp.html#49f938d1313ab6ef09ac6223a16ac334">Random</a>( 5 ) )
<a name="l00879"></a>00879             {
<a name="l00880"></a>00880                   <span class="keywordflow">case</span> 0:
<a name="l00881"></a>00881                         <a class="code" href="Soldier_01Profile_8cpp.html#1bcff2c50b375b1eb32800aa12000289">gMercProfiles</a>[ <a class="code" href="Soldier_01Profile_8h.html#acaa92dcb344e96138c964deae3e2fa1f11f73297a43c153b8691874f1444585">HAMOUS</a> ].<a class="code" href="structMERCPROFILESTRUCT.html#b0d6f66ec41a0d9c87fbc03dd9fed965">sSectorX</a> = 6;
<a name="l00882"></a>00882                         <a class="code" href="Soldier_01Profile_8cpp.html#1bcff2c50b375b1eb32800aa12000289">gMercProfiles</a>[ <a class="code" href="Soldier_01Profile_8h.html#acaa92dcb344e96138c964deae3e2fa1f11f73297a43c153b8691874f1444585">HAMOUS</a> ].<a class="code" href="structMERCPROFILESTRUCT.html#e3caff1f000b3ed3c382e8a1f0d5fdbc">sSectorY</a> = MAP_ROW_G;
<a name="l00883"></a>00883                         <a class="code" href="Soldier_01Profile_8cpp.html#1bcff2c50b375b1eb32800aa12000289">gMercProfiles</a>[ <a class="code" href="Soldier_01Profile_8h.html#acaa92dcb344e96138c964deae3e2fa1e7e45b19afff6f86809bcd0b2df757f8">PROF_ICECREAM</a> ].<a class="code" href="structMERCPROFILESTRUCT.html#b0d6f66ec41a0d9c87fbc03dd9fed965">sSectorX</a> = 6;
<a name="l00884"></a>00884                         <a class="code" href="Soldier_01Profile_8cpp.html#1bcff2c50b375b1eb32800aa12000289">gMercProfiles</a>[ <a class="code" href="Soldier_01Profile_8h.html#acaa92dcb344e96138c964deae3e2fa1e7e45b19afff6f86809bcd0b2df757f8">PROF_ICECREAM</a> ].<a class="code" href="structMERCPROFILESTRUCT.html#e3caff1f000b3ed3c382e8a1f0d5fdbc">sSectorY</a> = MAP_ROW_G;
<a name="l00885"></a>00885                         <span class="keywordflow">break</span>;
<a name="l00886"></a>00886                   <span class="keywordflow">case</span> 1:
<a name="l00887"></a>00887                         <a class="code" href="Soldier_01Profile_8cpp.html#1bcff2c50b375b1eb32800aa12000289">gMercProfiles</a>[ <a class="code" href="Soldier_01Profile_8h.html#acaa92dcb344e96138c964deae3e2fa1f11f73297a43c153b8691874f1444585">HAMOUS</a> ].<a class="code" href="structMERCPROFILESTRUCT.html#b0d6f66ec41a0d9c87fbc03dd9fed965">sSectorX</a> = 12;
<a name="l00888"></a>00888                         <a class="code" href="Soldier_01Profile_8cpp.html#1bcff2c50b375b1eb32800aa12000289">gMercProfiles</a>[ <a class="code" href="Soldier_01Profile_8h.html#acaa92dcb344e96138c964deae3e2fa1f11f73297a43c153b8691874f1444585">HAMOUS</a> ].<a class="code" href="structMERCPROFILESTRUCT.html#e3caff1f000b3ed3c382e8a1f0d5fdbc">sSectorY</a> = MAP_ROW_F;
<a name="l00889"></a>00889                         <a class="code" href="Soldier_01Profile_8cpp.html#1bcff2c50b375b1eb32800aa12000289">gMercProfiles</a>[ <a class="code" href="Soldier_01Profile_8h.html#acaa92dcb344e96138c964deae3e2fa1e7e45b19afff6f86809bcd0b2df757f8">PROF_ICECREAM</a> ].<a class="code" href="structMERCPROFILESTRUCT.html#b0d6f66ec41a0d9c87fbc03dd9fed965">sSectorX</a> = 12;
<a name="l00890"></a>00890                         <a class="code" href="Soldier_01Profile_8cpp.html#1bcff2c50b375b1eb32800aa12000289">gMercProfiles</a>[ <a class="code" href="Soldier_01Profile_8h.html#acaa92dcb344e96138c964deae3e2fa1e7e45b19afff6f86809bcd0b2df757f8">PROF_ICECREAM</a> ].<a class="code" href="structMERCPROFILESTRUCT.html#e3caff1f000b3ed3c382e8a1f0d5fdbc">sSectorY</a> = MAP_ROW_F;
<a name="l00891"></a>00891                         <span class="keywordflow">break</span>;
<a name="l00892"></a>00892                   <span class="keywordflow">case</span> 2:
<a name="l00893"></a>00893                         <a class="code" href="Soldier_01Profile_8cpp.html#1bcff2c50b375b1eb32800aa12000289">gMercProfiles</a>[ <a class="code" href="Soldier_01Profile_8h.html#acaa92dcb344e96138c964deae3e2fa1f11f73297a43c153b8691874f1444585">HAMOUS</a> ].<a class="code" href="structMERCPROFILESTRUCT.html#b0d6f66ec41a0d9c87fbc03dd9fed965">sSectorX</a> = 7;
<a name="l00894"></a>00894                         <a class="code" href="Soldier_01Profile_8cpp.html#1bcff2c50b375b1eb32800aa12000289">gMercProfiles</a>[ <a class="code" href="Soldier_01Profile_8h.html#acaa92dcb344e96138c964deae3e2fa1f11f73297a43c153b8691874f1444585">HAMOUS</a> ].<a class="code" href="structMERCPROFILESTRUCT.html#e3caff1f000b3ed3c382e8a1f0d5fdbc">sSectorY</a> = MAP_ROW_D;
<a name="l00895"></a>00895                         <a class="code" href="Soldier_01Profile_8cpp.html#1bcff2c50b375b1eb32800aa12000289">gMercProfiles</a>[ <a class="code" href="Soldier_01Profile_8h.html#acaa92dcb344e96138c964deae3e2fa1e7e45b19afff6f86809bcd0b2df757f8">PROF_ICECREAM</a> ].<a class="code" href="structMERCPROFILESTRUCT.html#b0d6f66ec41a0d9c87fbc03dd9fed965">sSectorX</a> = 7;
<a name="l00896"></a>00896                         <a class="code" href="Soldier_01Profile_8cpp.html#1bcff2c50b375b1eb32800aa12000289">gMercProfiles</a>[ <a class="code" href="Soldier_01Profile_8h.html#acaa92dcb344e96138c964deae3e2fa1e7e45b19afff6f86809bcd0b2df757f8">PROF_ICECREAM</a> ].<a class="code" href="structMERCPROFILESTRUCT.html#e3caff1f000b3ed3c382e8a1f0d5fdbc">sSectorY</a> = MAP_ROW_D;
<a name="l00897"></a>00897                         <span class="keywordflow">break</span>;
<a name="l00898"></a>00898                   <span class="keywordflow">case</span> 3:
<a name="l00899"></a>00899                         <a class="code" href="Soldier_01Profile_8cpp.html#1bcff2c50b375b1eb32800aa12000289">gMercProfiles</a>[ <a class="code" href="Soldier_01Profile_8h.html#acaa92dcb344e96138c964deae3e2fa1f11f73297a43c153b8691874f1444585">HAMOUS</a> ].<a class="code" href="structMERCPROFILESTRUCT.html#b0d6f66ec41a0d9c87fbc03dd9fed965">sSectorX</a> = 3;
<a name="l00900"></a>00900                         <a class="code" href="Soldier_01Profile_8cpp.html#1bcff2c50b375b1eb32800aa12000289">gMercProfiles</a>[ <a class="code" href="Soldier_01Profile_8h.html#acaa92dcb344e96138c964deae3e2fa1f11f73297a43c153b8691874f1444585">HAMOUS</a> ].<a class="code" href="structMERCPROFILESTRUCT.html#e3caff1f000b3ed3c382e8a1f0d5fdbc">sSectorY</a> = MAP_ROW_D;
<a name="l00901"></a>00901                         <a class="code" href="Soldier_01Profile_8cpp.html#1bcff2c50b375b1eb32800aa12000289">gMercProfiles</a>[ <a class="code" href="Soldier_01Profile_8h.html#acaa92dcb344e96138c964deae3e2fa1e7e45b19afff6f86809bcd0b2df757f8">PROF_ICECREAM</a> ].<a class="code" href="structMERCPROFILESTRUCT.html#b0d6f66ec41a0d9c87fbc03dd9fed965">sSectorX</a> = 3;
<a name="l00902"></a>00902                         <a class="code" href="Soldier_01Profile_8cpp.html#1bcff2c50b375b1eb32800aa12000289">gMercProfiles</a>[ <a class="code" href="Soldier_01Profile_8h.html#acaa92dcb344e96138c964deae3e2fa1e7e45b19afff6f86809bcd0b2df757f8">PROF_ICECREAM</a> ].<a class="code" href="structMERCPROFILESTRUCT.html#e3caff1f000b3ed3c382e8a1f0d5fdbc">sSectorY</a> = MAP_ROW_D;
<a name="l00903"></a>00903                         <span class="keywordflow">break</span>;
<a name="l00904"></a>00904                   <span class="keywordflow">case</span> 4:
<a name="l00905"></a>00905                         <a class="code" href="Soldier_01Profile_8cpp.html#1bcff2c50b375b1eb32800aa12000289">gMercProfiles</a>[ <a class="code" href="Soldier_01Profile_8h.html#acaa92dcb344e96138c964deae3e2fa1f11f73297a43c153b8691874f1444585">HAMOUS</a> ].<a class="code" href="structMERCPROFILESTRUCT.html#b0d6f66ec41a0d9c87fbc03dd9fed965">sSectorX</a> = 9;
<a name="l00906"></a>00906                         <a class="code" href="Soldier_01Profile_8cpp.html#1bcff2c50b375b1eb32800aa12000289">gMercProfiles</a>[ <a class="code" href="Soldier_01Profile_8h.html#acaa92dcb344e96138c964deae3e2fa1f11f73297a43c153b8691874f1444585">HAMOUS</a> ].<a class="code" href="structMERCPROFILESTRUCT.html#e3caff1f000b3ed3c382e8a1f0d5fdbc">sSectorY</a> = MAP_ROW_D;
<a name="l00907"></a>00907                         <a class="code" href="Soldier_01Profile_8cpp.html#1bcff2c50b375b1eb32800aa12000289">gMercProfiles</a>[ <a class="code" href="Soldier_01Profile_8h.html#acaa92dcb344e96138c964deae3e2fa1e7e45b19afff6f86809bcd0b2df757f8">PROF_ICECREAM</a> ].<a class="code" href="structMERCPROFILESTRUCT.html#b0d6f66ec41a0d9c87fbc03dd9fed965">sSectorX</a> = 9;
<a name="l00908"></a>00908                         <a class="code" href="Soldier_01Profile_8cpp.html#1bcff2c50b375b1eb32800aa12000289">gMercProfiles</a>[ <a class="code" href="Soldier_01Profile_8h.html#acaa92dcb344e96138c964deae3e2fa1e7e45b19afff6f86809bcd0b2df757f8">PROF_ICECREAM</a> ].<a class="code" href="structMERCPROFILESTRUCT.html#e3caff1f000b3ed3c382e8a1f0d5fdbc">sSectorY</a> = MAP_ROW_D;
<a name="l00909"></a>00909                         <span class="keywordflow">break</span>;                        
<a name="l00910"></a>00910             }
<a name="l00911"></a>00911       }
<a name="l00912"></a>00912 
<a name="l00913"></a>00913       <span class="comment">// Does Rat take off?</span>
<a name="l00914"></a>00914       <span class="keywordflow">if</span> ( <a class="code" href="Soldier_01Profile_8cpp.html#1bcff2c50b375b1eb32800aa12000289">gMercProfiles</a>[ <a class="code" href="Soldier_01Profile_8h.html#acaa92dcb344e96138c964deae3e2fa1c27bc063b0fa3ec825d20ab088cc1c0f">RAT</a> ].bNPCData != 0 )
<a name="l00915"></a>00915       {
<a name="l00916"></a>00916             <a class="code" href="Soldier_01Profile_8cpp.html#1bcff2c50b375b1eb32800aa12000289">gMercProfiles</a>[ <a class="code" href="Soldier_01Profile_8h.html#acaa92dcb344e96138c964deae3e2fa1c27bc063b0fa3ec825d20ab088cc1c0f">RAT</a> ].<a class="code" href="structMERCPROFILESTRUCT.html#b0d6f66ec41a0d9c87fbc03dd9fed965">sSectorX</a> = 0;
<a name="l00917"></a>00917             <a class="code" href="Soldier_01Profile_8cpp.html#1bcff2c50b375b1eb32800aa12000289">gMercProfiles</a>[ <a class="code" href="Soldier_01Profile_8h.html#acaa92dcb344e96138c964deae3e2fa1c27bc063b0fa3ec825d20ab088cc1c0f">RAT</a> ].<a class="code" href="structMERCPROFILESTRUCT.html#e3caff1f000b3ed3c382e8a1f0d5fdbc">sSectorY</a> = 0;
<a name="l00918"></a>00918             <a class="code" href="Soldier_01Profile_8cpp.html#1bcff2c50b375b1eb32800aa12000289">gMercProfiles</a>[ <a class="code" href="Soldier_01Profile_8h.html#acaa92dcb344e96138c964deae3e2fa1c27bc063b0fa3ec825d20ab088cc1c0f">RAT</a> ].<a class="code" href="structMERCPROFILESTRUCT.html#9dfd2271b790d94f55f142e71ab18065">bSectorZ</a> = 0;
<a name="l00919"></a>00919       }
<a name="l00920"></a>00920 
<a name="l00921"></a>00921 
<a name="l00922"></a>00922       <span class="comment">// Empty money from pockets of Vince 69, Willis 80, and Jenny 132</span>
<a name="l00923"></a>00923       <a class="code" href="Items_8cpp.html#a2ec3d53cbf38b3f5916bf754893946f">SetMoneyInSoldierProfile</a>( <a class="code" href="Soldier_01Profile_8h.html#acaa92dcb344e96138c964deae3e2fa153e948a1aeafa0be208d93c8da5f49a4">VINCE</a>, 0 );
<a name="l00924"></a>00924       <a class="code" href="Items_8cpp.html#a2ec3d53cbf38b3f5916bf754893946f">SetMoneyInSoldierProfile</a>( <a class="code" href="Soldier_01Profile_8h.html#acaa92dcb344e96138c964deae3e2fa1a5a515be2536de341cbf6ddd9562e5a1">STEVE</a>, 0 ); <span class="comment">// Steven Willis</span>
<a name="l00925"></a>00925       <a class="code" href="Items_8cpp.html#a2ec3d53cbf38b3f5916bf754893946f">SetMoneyInSoldierProfile</a>( <a class="code" href="Soldier_01Profile_8h.html#acaa92dcb344e96138c964deae3e2fa1b3d28e3c3ca28b1cd82219efca584b48">JENNY</a>, 0 );
<a name="l00926"></a>00926 
<a name="l00927"></a>00927       <span class="comment">// Vince is no longer expecting money</span>
<a name="l00928"></a>00928       <a class="code" href="Quests_8cpp.html#367aad061aefa5a73a4ac3fda10511b3">SetFactFalse</a>( <a class="code" href="Quests_8h.html#aead3e57f613f07868a1b2afb6b943f149007f7421402f37abc055fe082a64bf">FACT_VINCE_EXPECTING_MONEY</a> );
<a name="l00929"></a>00929 
<a name="l00930"></a>00930       <span class="comment">// Reset Darren's balance and money</span>
<a name="l00931"></a>00931       <a class="code" href="Soldier_01Profile_8cpp.html#1bcff2c50b375b1eb32800aa12000289">gMercProfiles</a>[ <a class="code" href="Soldier_01Profile_8h.html#acaa92dcb344e96138c964deae3e2fa1ff474cda9c0583bf5147c3fcaa586f28">DARREN</a> ].<a class="code" href="structMERCPROFILESTRUCT.html#c35cc0ea235c0ee715cac81a684c7380">iBalance</a> = 0;
<a name="l00932"></a>00932       <a class="code" href="Items_8cpp.html#a2ec3d53cbf38b3f5916bf754893946f">SetMoneyInSoldierProfile</a>( <a class="code" href="Soldier_01Profile_8h.html#acaa92dcb344e96138c964deae3e2fa1ff474cda9c0583bf5147c3fcaa586f28">DARREN</a>, 15000 );
<a name="l00933"></a>00933 
<a name="l00934"></a>00934       <span class="comment">// set Carmen to be placed on the map in case he moved and is waiting off screen</span>
<a name="l00935"></a>00935       <span class="keywordflow">if</span> (<a class="code" href="Soldier_01Profile_8cpp.html#1bcff2c50b375b1eb32800aa12000289">gMercProfiles</a>[ <a class="code" href="Soldier_01Profile_8h.html#acaa92dcb344e96138c964deae3e2fa18ef3c1fa23f86676dffe0ec678800eb5">CARMEN</a> ].ubMiscFlags2 &amp; PROFILE_MISC_FLAG2_DONT_ADD_TO_SECTOR)
<a name="l00936"></a>00936       {
<a name="l00937"></a>00937             <a class="code" href="Soldier_01Profile_8cpp.html#1bcff2c50b375b1eb32800aa12000289">gMercProfiles</a>[ <a class="code" href="Soldier_01Profile_8h.html#acaa92dcb344e96138c964deae3e2fa18ef3c1fa23f86676dffe0ec678800eb5">CARMEN</a> ].<a class="code" href="structMERCPROFILESTRUCT.html#5870da43a6570a9906fa8e5439ac9991">ubMiscFlags2</a> &amp;= ~(PROFILE_MISC_FLAG2_DONT_ADD_TO_SECTOR);
<a name="l00938"></a>00938             <span class="comment">// move Carmen to C13</span>
<a name="l00939"></a>00939             <a class="code" href="Soldier_01Profile_8cpp.html#1bcff2c50b375b1eb32800aa12000289">gMercProfiles</a>[ <a class="code" href="Soldier_01Profile_8h.html#acaa92dcb344e96138c964deae3e2fa18ef3c1fa23f86676dffe0ec678800eb5">CARMEN</a> ].<a class="code" href="structMERCPROFILESTRUCT.html#b0d6f66ec41a0d9c87fbc03dd9fed965">sSectorX</a> = 13;
<a name="l00940"></a>00940             <a class="code" href="Soldier_01Profile_8cpp.html#1bcff2c50b375b1eb32800aa12000289">gMercProfiles</a>[ <a class="code" href="Soldier_01Profile_8h.html#acaa92dcb344e96138c964deae3e2fa18ef3c1fa23f86676dffe0ec678800eb5">CARMEN</a> ].<a class="code" href="structMERCPROFILESTRUCT.html#e3caff1f000b3ed3c382e8a1f0d5fdbc">sSectorY</a> = MAP_ROW_C;
<a name="l00941"></a>00941             <a class="code" href="Soldier_01Profile_8cpp.html#1bcff2c50b375b1eb32800aa12000289">gMercProfiles</a>[ <a class="code" href="Soldier_01Profile_8h.html#acaa92dcb344e96138c964deae3e2fa18ef3c1fa23f86676dffe0ec678800eb5">CARMEN</a> ].<a class="code" href="structMERCPROFILESTRUCT.html#9dfd2271b790d94f55f142e71ab18065">bSectorZ</a> = 0;
<a name="l00942"></a>00942 
<a name="l00943"></a>00943             <span class="comment">// we should also reset # of terrorist heads and give him cash </span>
<a name="l00944"></a>00944             <span class="keywordflow">if</span> (<a class="code" href="Soldier_01Profile_8cpp.html#1bcff2c50b375b1eb32800aa12000289">gMercProfiles</a>[ <a class="code" href="Soldier_01Profile_8h.html#acaa92dcb344e96138c964deae3e2fa18ef3c1fa23f86676dffe0ec678800eb5">CARMEN</a> ].bNPCData2 &gt; 0)
<a name="l00945"></a>00945             {
<a name="l00946"></a>00946                   <span class="keywordflow">if</span> (<a class="code" href="Soldier_01Profile_8cpp.html#1bcff2c50b375b1eb32800aa12000289">gMercProfiles</a>[ <a class="code" href="Soldier_01Profile_8h.html#acaa92dcb344e96138c964deae3e2fa18ef3c1fa23f86676dffe0ec678800eb5">CARMEN</a> ].uiMoney &lt; 10000)
<a name="l00947"></a>00947                   {
<a name="l00948"></a>00948                         uiAmount = 0;
<a name="l00949"></a>00949                   }
<a name="l00950"></a>00950                   <span class="keywordflow">else</span>
<a name="l00951"></a>00951                   {
<a name="l00952"></a>00952                         uiAmount = <a class="code" href="Soldier_01Profile_8cpp.html#1bcff2c50b375b1eb32800aa12000289">gMercProfiles</a>[ <a class="code" href="Soldier_01Profile_8h.html#acaa92dcb344e96138c964deae3e2fa18ef3c1fa23f86676dffe0ec678800eb5">CARMEN</a> ].<a class="code" href="structMERCPROFILESTRUCT.html#fe0ebd3e695c50f66579ec2877e85a36">uiMoney</a>;
<a name="l00953"></a>00953                   }
<a name="l00954"></a>00954                   uiAmount += 10000 * <a class="code" href="Soldier_01Profile_8cpp.html#1bcff2c50b375b1eb32800aa12000289">gMercProfiles</a>[ <a class="code" href="Soldier_01Profile_8h.html#acaa92dcb344e96138c964deae3e2fa18ef3c1fa23f86676dffe0ec678800eb5">CARMEN</a> ].<a class="code" href="structMERCPROFILESTRUCT.html#9b84060a344ee8f7751fa148de9bf8e9">bNPCData2</a>;
<a name="l00955"></a>00955                   <a class="code" href="Items_8cpp.html#a2ec3d53cbf38b3f5916bf754893946f">SetMoneyInSoldierProfile</a>( <a class="code" href="Soldier_01Profile_8h.html#acaa92dcb344e96138c964deae3e2fa18ef3c1fa23f86676dffe0ec678800eb5">CARMEN</a>, uiAmount );
<a name="l00956"></a>00956                   <a class="code" href="Soldier_01Profile_8cpp.html#1bcff2c50b375b1eb32800aa12000289">gMercProfiles</a>[ <a class="code" href="Soldier_01Profile_8h.html#acaa92dcb344e96138c964deae3e2fa18ef3c1fa23f86676dffe0ec678800eb5">CARMEN</a> ].<a class="code" href="structMERCPROFILESTRUCT.html#9b84060a344ee8f7751fa148de9bf8e9">bNPCData2</a> = 0;
<a name="l00957"></a>00957 
<a name="l00958"></a>00958                   <span class="keywordflow">for</span> ( cnt = <a class="code" href="Item_01Types_8h.html#572f9555da77e1b21f4cd40aed8d20f44f061aabff0d23a9cd566b7be9155e18">HEAD_1</a>; cnt &lt;= <a class="code" href="Item_01Types_8h.html#572f9555da77e1b21f4cd40aed8d20f4214ae16a2aa7d5cd1e2ce99070d58ae6">HEAD_7</a>; cnt++ )
<a name="l00959"></a>00959                   {
<a name="l00960"></a>00960                         <a class="code" href="Items_8cpp.html#2d9760d2538e0c0cd384db82b507e3a1">RemoveObjectFromSoldierProfile</a>( <a class="code" href="Soldier_01Profile_8h.html#acaa92dcb344e96138c964deae3e2fa18ef3c1fa23f86676dffe0ec678800eb5">CARMEN</a>, (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>) cnt );
<a name="l00961"></a>00961                   }
<a name="l00962"></a>00962 
<a name="l00963"></a>00963             }
<a name="l00964"></a>00964       }
<a name="l00965"></a>00965       <span class="keywordflow">else</span>
<a name="l00966"></a>00966       {
<a name="l00967"></a>00967             <span class="comment">// randomize where he'll be today... so long as his sector's not loaded</span>
<a name="l00968"></a>00968 
<a name="l00969"></a>00969             <span class="keywordflow">if</span> ( <a class="code" href="Soldier_01Profile_8cpp.html#1bcff2c50b375b1eb32800aa12000289">gMercProfiles</a>[ <a class="code" href="Soldier_01Profile_8h.html#acaa92dcb344e96138c964deae3e2fa18ef3c1fa23f86676dffe0ec678800eb5">CARMEN</a> ].sSectorX != <a class="code" href="strategicmap_8cpp.html#49d9aed144a633fda4ba1990f002d703">gWorldSectorX</a> || <a class="code" href="Soldier_01Profile_8cpp.html#1bcff2c50b375b1eb32800aa12000289">gMercProfiles</a>[ <a class="code" href="Soldier_01Profile_8h.html#acaa92dcb344e96138c964deae3e2fa18ef3c1fa23f86676dffe0ec678800eb5">CARMEN</a> ].sSectorY != <a class="code" href="strategicmap_8cpp.html#ea322310ced0e35ee18a2ee7b32aac5b">gWorldSectorY</a> )
<a name="l00970"></a>00970             {
<a name="l00971"></a>00971                   <span class="keywordflow">switch</span>( <a class="code" href="Random_8cpp.html#49f938d1313ab6ef09ac6223a16ac334">Random</a>( 3 ) )
<a name="l00972"></a>00972                   {
<a name="l00973"></a>00973                         <span class="keywordflow">case</span> 0:
<a name="l00974"></a>00974                               <a class="code" href="Soldier_01Profile_8cpp.html#1bcff2c50b375b1eb32800aa12000289">gMercProfiles</a>[ <a class="code" href="Soldier_01Profile_8h.html#acaa92dcb344e96138c964deae3e2fa18ef3c1fa23f86676dffe0ec678800eb5">CARMEN</a> ].sSectorX = 5;
<a name="l00975"></a>00975                               <a class="code" href="Soldier_01Profile_8cpp.html#1bcff2c50b375b1eb32800aa12000289">gMercProfiles</a>[ <a class="code" href="Soldier_01Profile_8h.html#acaa92dcb344e96138c964deae3e2fa18ef3c1fa23f86676dffe0ec678800eb5">CARMEN</a> ].<a class="code" href="structMERCPROFILESTRUCT.html#e3caff1f000b3ed3c382e8a1f0d5fdbc">sSectorY</a> = MAP_ROW_C;
<a name="l00976"></a>00976                               <span class="keywordflow">break</span>;
<a name="l00977"></a>00977                         <span class="keywordflow">case</span> 1:
<a name="l00978"></a>00978                               <a class="code" href="Soldier_01Profile_8cpp.html#1bcff2c50b375b1eb32800aa12000289">gMercProfiles</a>[ <a class="code" href="Soldier_01Profile_8h.html#acaa92dcb344e96138c964deae3e2fa18ef3c1fa23f86676dffe0ec678800eb5">CARMEN</a> ].<a class="code" href="structMERCPROFILESTRUCT.html#b0d6f66ec41a0d9c87fbc03dd9fed965">sSectorX</a> = 13;
<a name="l00979"></a>00979                               <a class="code" href="Soldier_01Profile_8cpp.html#1bcff2c50b375b1eb32800aa12000289">gMercProfiles</a>[ <a class="code" href="Soldier_01Profile_8h.html#acaa92dcb344e96138c964deae3e2fa18ef3c1fa23f86676dffe0ec678800eb5">CARMEN</a> ].<a class="code" href="structMERCPROFILESTRUCT.html#e3caff1f000b3ed3c382e8a1f0d5fdbc">sSectorY</a> = MAP_ROW_C;
<a name="l00980"></a>00980                               <span class="keywordflow">break</span>;
<a name="l00981"></a>00981                         <span class="keywordflow">case</span> 2:
<a name="l00982"></a>00982                               <a class="code" href="Soldier_01Profile_8cpp.html#1bcff2c50b375b1eb32800aa12000289">gMercProfiles</a>[ <a class="code" href="Soldier_01Profile_8h.html#acaa92dcb344e96138c964deae3e2fa18ef3c1fa23f86676dffe0ec678800eb5">CARMEN</a> ].<a class="code" href="structMERCPROFILESTRUCT.html#b0d6f66ec41a0d9c87fbc03dd9fed965">sSectorX</a> = 9;
<a name="l00983"></a>00983                               <a class="code" href="Soldier_01Profile_8cpp.html#1bcff2c50b375b1eb32800aa12000289">gMercProfiles</a>[ <a class="code" href="Soldier_01Profile_8h.html#acaa92dcb344e96138c964deae3e2fa18ef3c1fa23f86676dffe0ec678800eb5">CARMEN</a> ].<a class="code" href="structMERCPROFILESTRUCT.html#e3caff1f000b3ed3c382e8a1f0d5fdbc">sSectorY</a> = MAP_ROW_G;
<a name="l00984"></a>00984                               <span class="keywordflow">break</span>;
<a name="l00985"></a>00985                   }
<a name="l00986"></a>00986                   <span class="comment">// he should have $5000... unless the player forgot to meet him </span>
<a name="l00987"></a>00987                   <span class="keywordflow">if</span> (<a class="code" href="Soldier_01Profile_8cpp.html#1bcff2c50b375b1eb32800aa12000289">gMercProfiles</a>[ <a class="code" href="Soldier_01Profile_8h.html#acaa92dcb344e96138c964deae3e2fa18ef3c1fa23f86676dffe0ec678800eb5">CARMEN</a> ].uiMoney &lt; 5000)
<a name="l00988"></a>00988                   {
<a name="l00989"></a>00989                         <a class="code" href="Items_8cpp.html#a2ec3d53cbf38b3f5916bf754893946f">SetMoneyInSoldierProfile</a>( <a class="code" href="Soldier_01Profile_8h.html#acaa92dcb344e96138c964deae3e2fa18ef3c1fa23f86676dffe0ec678800eb5">CARMEN</a>, 5000 );
<a name="l00990"></a>00990                   }
<a name="l00991"></a>00991             }
<a name="l00992"></a>00992       }
<a name="l00993"></a>00993 
<a name="l00994"></a>00994       <span class="keywordflow">if</span> ( <a class="code" href="Random_8cpp.html#ca9f12606e77e67e4a79ee8ec0cba956">PreRandom</a>( 3 ) == 0 )
<a name="l00995"></a>00995       {
<a name="l00996"></a>00996             <a class="code" href="Quests_8cpp.html#d7278c1ec0f9cc2ac9af20f8a6b446db">SetFactTrue</a>( <a class="code" href="Quests_8h.html#aead3e57f613f07868a1b2afb6b943f1b1abbdf5d5a9b6ece322d9c9bfbae938">FACT_DAVE_HAS_GAS</a> );
<a name="l00997"></a>00997       }
<a name="l00998"></a>00998       <span class="keywordflow">else</span>
<a name="l00999"></a>00999       {
<a name="l01000"></a>01000             <a class="code" href="Quests_8cpp.html#367aad061aefa5a73a4ac3fda10511b3">SetFactFalse</a>( <a class="code" href="Quests_8h.html#aead3e57f613f07868a1b2afb6b943f1b1abbdf5d5a9b6ece322d9c9bfbae938">FACT_DAVE_HAS_GAS</a> );
<a name="l01001"></a>01001       }
<a name="l01002"></a>01002 
<a name="l01003"></a>01003       <span class="keywordflow">if</span> ( <a class="code" href="strategicmap_8cpp.html#49d9aed144a633fda4ba1990f002d703">gWorldSectorX</a> == HOSPITAL_SECTOR_X &amp;&amp; <a class="code" href="strategicmap_8cpp.html#ea322310ced0e35ee18a2ee7b32aac5b">gWorldSectorY</a> == HOSPITAL_SECTOR_Y &amp;&amp; <a class="code" href="strategicmap_8cpp.html#da715721a8ceedd42acf6ddb33e63ce0">gbWorldSectorZ</a> == HOSPITAL_SECTOR_Z )
<a name="l01004"></a>01004       {
<a name="l01005"></a>01005             <a class="code" href="Strategic_01Event_01Handler_8cpp.html#920586460bbf751f1274dddacea6950b">CheckForMissingHospitalSupplies</a>();
<a name="l01006"></a>01006       }
<a name="l01007"></a>01007 
<a name="l01008"></a>01008 }
<a name="l01009"></a>01009 
<a name="l01010"></a><a class="code" href="Strategic_01Event_01Handler_8h.html#09a7605cdaa144f56857b85d5006fd0c">01010</a> <span class="keywordtype">void</span> <a class="code" href="Strategic_01Event_01Handler_8cpp.html#09a7605cdaa144f56857b85d5006fd0c">MakeCivGroupHostileOnNextSectorEntrance</a>( <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubCivGroup )
<a name="l01011"></a>01011 {
<a name="l01012"></a>01012       <span class="comment">// if it's the rebels that will become hostile, reduce town loyalties NOW, not later</span>
<a name="l01013"></a>01013       <span class="keywordflow">if</span> ( ubCivGroup == <a class="code" href="Overhead_01Types_8h.html#e6cdb622357fec6e889e47579a0785241787570cc516fbde66bef1057d466c0e">REBEL_CIV_GROUP</a> &amp;&amp; <a class="code" href="Overhead_8cpp.html#46bd754f8875c305ab18731ed10e3364">gTacticalStatus</a>.<a class="code" href="structTacticalStatusType.html#879449ac79e1f0135ef15c76469bc7a8">fCivGroupHostile</a>[ ubCivGroup ] == CIV_GROUP_NEUTRAL )
<a name="l01014"></a>01014       {
<a name="l01015"></a>01015             <a class="code" href="Strategic_01Town_01Loyalty_8cpp.html#4796174001d18d2fabd011cc74c8aff9">ReduceLoyaltyForRebelsBetrayed</a>();
<a name="l01016"></a>01016       }
<a name="l01017"></a>01017 
<a name="l01018"></a>01018       <a class="code" href="Overhead_8cpp.html#46bd754f8875c305ab18731ed10e3364">gTacticalStatus</a>.<a class="code" href="structTacticalStatusType.html#879449ac79e1f0135ef15c76469bc7a8">fCivGroupHostile</a>[ ubCivGroup ] = CIV_GROUP_WILL_BECOME_HOSTILE;
<a name="l01019"></a>01019 }
<a name="l01020"></a>01020 
<a name="l01021"></a><a class="code" href="Strategic_01Event_01Handler_8h.html#46efa2b9c5fc8a9b9b9d30ac3e0439ab">01021</a> <span class="keywordtype">void</span> <a class="code" href="Strategic_01Event_01Handler_8cpp.html#46efa2b9c5fc8a9b9b9d30ac3e0439ab">RemoveAssassin</a>( <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubProfile )
<a name="l01022"></a>01022 {
<a name="l01023"></a>01023       <a class="code" href="Soldier_01Profile_8cpp.html#1bcff2c50b375b1eb32800aa12000289">gMercProfiles</a>[ ubProfile ].<a class="code" href="structMERCPROFILESTRUCT.html#b0d6f66ec41a0d9c87fbc03dd9fed965">sSectorX</a> = 0;
<a name="l01024"></a>01024       <a class="code" href="Soldier_01Profile_8cpp.html#1bcff2c50b375b1eb32800aa12000289">gMercProfiles</a>[ ubProfile ].<a class="code" href="structMERCPROFILESTRUCT.html#e3caff1f000b3ed3c382e8a1f0d5fdbc">sSectorY</a> = 0;
<a name="l01025"></a>01025       <a class="code" href="Soldier_01Profile_8cpp.html#1bcff2c50b375b1eb32800aa12000289">gMercProfiles</a>[ ubProfile ].<a class="code" href="structMERCPROFILESTRUCT.html#09fbcd22d7fc230711c52e75231d8f79">bLife</a> = <a class="code" href="Soldier_01Profile_8cpp.html#1bcff2c50b375b1eb32800aa12000289">gMercProfiles</a>[ ubProfile ].<a class="code" href="structMERCPROFILESTRUCT.html#fa85b8afa8461cbbdb7eb533eed28e31">bLifeMax</a>;
<a name="l01026"></a>01026 }
<a name="l01027"></a>01027 
<a name="l01028"></a><a class="code" href="Strategic_01Event_01Handler_8h.html#920586460bbf751f1274dddacea6950b">01028</a> <span class="keywordtype">void</span> <a class="code" href="Strategic_01Event_01Handler_8cpp.html#920586460bbf751f1274dddacea6950b">CheckForMissingHospitalSupplies</a>( <span class="keywordtype">void</span> )
<a name="l01029"></a>01029 {
<a name="l01030"></a>01030       <a class="code" href="Types_8h.html#e1e6edbbc26d6fbc71a90190d0266018">UINT32</a>                        uiLoop;
<a name="l01031"></a>01031       <a class="code" href="structTAG__ITEM__POOL.html">ITEM_POOL</a> *       pItemPool;
<a name="l01032"></a>01032       <a class="code" href="structOBJECTTYPE.html">OBJECTTYPE</a> *      pObj;
<a name="l01033"></a>01033       <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>                         ubMedicalObjects = 0;
<a name="l01034"></a>01034 
<a name="l01035"></a>01035       <span class="keywordflow">for</span> ( uiLoop = 0; uiLoop &lt; guiNumWorldItems; uiLoop++ )
<a name="l01036"></a>01036       {
<a name="l01037"></a>01037             <span class="comment">// loop through all items, look for ownership</span>
<a name="l01038"></a>01038             <span class="keywordflow">if</span> ( <a class="code" href="World_01Items_8cpp.html#3d02de7bbc850b7f4c6318b8d1125dee">gWorldItems</a>[ uiLoop ].fExists &amp;&amp; <a class="code" href="World_01Items_8cpp.html#3d02de7bbc850b7f4c6318b8d1125dee">gWorldItems</a>[ uiLoop ].o.usItem == <a class="code" href="Item_01Types_8h.html#572f9555da77e1b21f4cd40aed8d20f4f8504500da6b5018e9afcfb429a4768d">OWNERSHIP</a> &amp;&amp; <a class="code" href="World_01Items_8cpp.html#3d02de7bbc850b7f4c6318b8d1125dee">gWorldItems</a>[ uiLoop ].<a class="code" href="structWORLDITEM.html#0f219e2d7aafd3aeca85991add1ef5f8">o</a>.<a class="code" href="structOBJECTTYPE.html#ddfe9a40daf403fb9175bebb1d289262">ubOwnerCivGroup</a> == <a class="code" href="Overhead_01Types_8h.html#e6cdb622357fec6e889e47579a07852421a6c11705d5d1dc63330ac4f4f1ef44">DOCTORS_CIV_GROUP</a> )
<a name="l01039"></a>01039             {
<a name="l01040"></a>01040                   <a class="code" href="Handle_01Items_8cpp.html#f3115ef99b74538fde1620eee4e58261">GetItemPool</a>( <a class="code" href="World_01Items_8cpp.html#3d02de7bbc850b7f4c6318b8d1125dee">gWorldItems</a>[ uiLoop ].sGridNo, &amp;pItemPool, 0 ) ;
<a name="l01041"></a>01041                   <span class="keywordflow">while</span>( pItemPool ) 
<a name="l01042"></a>01042                   {
<a name="l01043"></a>01043                         pObj = &amp;( <a class="code" href="World_01Items_8cpp.html#3d02de7bbc850b7f4c6318b8d1125dee">gWorldItems</a>[ pItemPool-&gt;<a class="code" href="structTAG__ITEM__POOL.html#8b7c8953da8316b6921b514e2c1cef36">iItemIndex</a> ].o );
<a name="l01044"></a>01044 
<a name="l01045"></a>01045                         <a class="code" href="Soldier_01Ani_8cpp.html#c294aa65f0375eb6343a2de2a25dafcc">if</a> ( pObj-&gt;<a class="code" href="structOBJECTTYPE.html#aa0827e15c8e54d285d2850ea5ffbb07">bStatus</a>[ 0 ] &gt; 60 )
<a name="l01046"></a>01046                         {
<a name="l01047"></a>01047                               <a class="code" href="Soldier_01Ani_8cpp.html#c294aa65f0375eb6343a2de2a25dafcc">if</a> ( <a class="code" href="Item_01Types_8h.html#f9dc4cc7a3a99ad5944940cfb7c82237">Item</a>[pObj-&gt;<a class="code" href="structOBJECTTYPE.html#4fbe05335f161f08f354566b8e5a0a19">usItem</a>].firstaidkit || <a class="code" href="Item_01Types_8h.html#f9dc4cc7a3a99ad5944940cfb7c82237">Item</a>[pObj-&gt;<a class="code" href="structOBJECTTYPE.html#4fbe05335f161f08f354566b8e5a0a19">usItem</a>].medicalkit || pObj-&gt;<a class="code" href="structOBJECTTYPE.html#4fbe05335f161f08f354566b8e5a0a19">usItem</a> == <a class="code" href="Item_01Types_8h.html#572f9555da77e1b21f4cd40aed8d20f461efebed6251128952afebc4be7d9570">REGEN_BOOSTER</a> || pObj-&gt;<a class="code" href="structOBJECTTYPE.html#4fbe05335f161f08f354566b8e5a0a19">usItem</a> == <a class="code" href="Item_01Types_8h.html#572f9555da77e1b21f4cd40aed8d20f42e9a12dd5905de5a3b474bada8e5fd9b">ADRENALINE_BOOSTER</a> )
<a name="l01048"></a>01048                               {
<a name="l01049"></a>01049                                     ubMedicalObjects++;
<a name="l01050"></a>01050                               }
<a name="l01051"></a>01051                         }
<a name="l01052"></a>01052 
<a name="l01053"></a>01053                         pItemPool = pItemPool-&gt;<a class="code" href="structTAG__ITEM__POOL.html#9a6b2d91332d94678076c494658fc522">pNext</a>;
<a name="l01054"></a>01054                   }
<a name="l01055"></a>01055             }
<a name="l01056"></a>01056       }
<a name="l01057"></a>01057 
<a name="l01058"></a>01058       <span class="keywordflow">if</span> ( <a class="code" href="Quests_8cpp.html#6744b59d27bf2791d0c2fefe18e548d3">CheckFact</a>( <a class="code" href="Quests_8h.html#aead3e57f613f07868a1b2afb6b943f11c05c4c9954dbb4fea63379eeb646cf4">FACT_PLAYER_STOLE_MEDICAL_SUPPLIES_AGAIN</a>, 0 ) == TRUE )
<a name="l01059"></a>01059       {
<a name="l01060"></a>01060             <span class="comment">// player returning stuff!  if back to full then can operate</span>
<a name="l01061"></a>01061             <span class="keywordflow">if</span> ( ubMedicalObjects &gt;= <a class="code" href="Strategic_01Event_01Handler_8cpp.html#df871888aadad702be6d55074e0998fc">gubCambriaMedicalObjects</a> )
<a name="l01062"></a>01062             {
<a name="l01063"></a>01063                   <a class="code" href="Quests_8cpp.html#367aad061aefa5a73a4ac3fda10511b3">SetFactFalse</a>( <a class="code" href="Quests_8h.html#aead3e57f613f07868a1b2afb6b943f11c05c4c9954dbb4fea63379eeb646cf4">FACT_PLAYER_STOLE_MEDICAL_SUPPLIES_AGAIN</a> );
<a name="l01064"></a>01064                   <a class="code" href="Quests_8cpp.html#367aad061aefa5a73a4ac3fda10511b3">SetFactFalse</a>( <a class="code" href="Quests_8h.html#aead3e57f613f07868a1b2afb6b943f1f53842a944f79cc3ff395e6bdbad1ad4">FACT_PLAYER_STOLE_MEDICAL_SUPPLIES</a> );
<a name="l01065"></a>01065                   <span class="keywordflow">return</span>;
<a name="l01066"></a>01066             }
<a name="l01067"></a>01067       }
<a name="l01068"></a>01068       
<a name="l01069"></a>01069       <span class="keywordflow">if</span> ( ubMedicalObjects &lt; <a class="code" href="Strategic_01Event_01Handler_8cpp.html#df871888aadad702be6d55074e0998fc">gubCambriaMedicalObjects</a> )
<a name="l01070"></a>01070       {
<a name="l01071"></a>01071             <span class="comment">// player's stolen something!</span>
<a name="l01072"></a>01072             <span class="keywordflow">if</span> ( <a class="code" href="Quests_8cpp.html#6744b59d27bf2791d0c2fefe18e548d3">CheckFact</a>( <a class="code" href="Quests_8h.html#aead3e57f613f07868a1b2afb6b943f1f53842a944f79cc3ff395e6bdbad1ad4">FACT_PLAYER_STOLE_MEDICAL_SUPPLIES</a>, 0 ) == FALSE )
<a name="l01073"></a>01073             {
<a name="l01074"></a>01074                   <a class="code" href="Quests_8cpp.html#d7278c1ec0f9cc2ac9af20f8a6b446db">SetFactTrue</a>( FACT_PLAYER_STOLE_MEDICAL_SUPPLIES );
<a name="l01075"></a>01075             }
<a name="l01076"></a>01076 
<a name="l01077"></a>01077             <span class="comment">// if only 1/5 or less left, give up the ghost</span>
<a name="l01078"></a>01078             <span class="keywordflow">if</span> ( ubMedicalObjects * 5 &lt;= <a class="code" href="Strategic_01Event_01Handler_8cpp.html#df871888aadad702be6d55074e0998fc">gubCambriaMedicalObjects</a> )
<a name="l01079"></a>01079             {
<a name="l01080"></a>01080                   <span class="comment">// run out!</span>
<a name="l01081"></a>01081                   <a class="code" href="Quests_8cpp.html#d7278c1ec0f9cc2ac9af20f8a6b446db">SetFactTrue</a>( <a class="code" href="Quests_8h.html#aead3e57f613f07868a1b2afb6b943f11c05c4c9954dbb4fea63379eeb646cf4">FACT_PLAYER_STOLE_MEDICAL_SUPPLIES_AGAIN</a> );
<a name="l01082"></a>01082             }
<a name="l01083"></a>01083       }
<a name="l01084"></a>01084       
<a name="l01085"></a>01085 }
<a name="l01086"></a>01086 
<a name="l01087"></a>01087 
<a name="l01088"></a><a class="code" href="Strategic_01Event_01Handler_8cpp.html#d42b1520f13e8f601195e5adf94ef298">01088</a> <span class="keywordtype">void</span> <a class="code" href="Strategic_01Event_01Handler_8cpp.html#d42b1520f13e8f601195e5adf94ef298">DropOffItemsInMeduna</a>( <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubOrderNum )
<a name="l01089"></a>01089 {
<a name="l01090"></a>01090       <a class="code" href="Types_8h.html#112e3146cb38b6ee95e64d85842e380a">BOOLEAN</a>     fSectorLoaded = FALSE;
<a name="l01091"></a>01091       <a class="code" href="structOBJECTTYPE.html">OBJECTTYPE</a>        Object;
<a name="l01092"></a>01092       <a class="code" href="Types_8h.html#e1e6edbbc26d6fbc71a90190d0266018">UINT32</a>      uiCount = 0;
<a name="l01093"></a>01093       <a class="code" href="structOBJECTTYPE.html">OBJECTTYPE</a>  *pObject=NULL;
<a name="l01094"></a>01094       <a class="code" href="Types_8h.html#09f1a1fb2293e33483cc8d44aefb1eb1">UINT16</a>      usNumberOfItems=0, usItem;
<a name="l01095"></a>01095       <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>       ubItemsDelivered, ubTempNumItems;
<a name="l01096"></a>01096       <a class="code" href="Types_8h.html#e1e6edbbc26d6fbc71a90190d0266018">UINT32</a>      i;
<a name="l01097"></a>01097 
<a name="l01098"></a>01098       <span class="comment">//if the player doesnt "own" the sector,</span>
<a name="l01099"></a>01099       <span class="keywordflow">if</span>( <a class="code" href="strategic_8cpp.html#6f48fb0ea28e3d4889423290f1a6ede8">StrategicMap</a>[ CALCULATE_STRATEGIC_INDEX( MEDUNA_ITEM_DROP_OFF_SECTOR_X, MEDUNA_ITEM_DROP_OFF_SECTOR_Y ) ].fEnemyControlled )
<a name="l01100"></a>01100       {
<a name="l01101"></a>01101             <span class="comment">//the items disappear</span>
<a name="l01102"></a>01102             <a class="code" href="BobbyRMailOrder_8cpp.html#9753076f963c32ac9de3b35e7ee8a3c5">gpNewBobbyrShipments</a>[ ubOrderNum ].<a class="code" href="structNewBobbyRayOrderStruct.html#873da9e8bc226b20c83084970e3a4951">fActive</a> = FALSE;
<a name="l01103"></a>01103             <span class="keywordflow">return</span>;
<a name="l01104"></a>01104       }
<a name="l01105"></a>01105 
<a name="l01106"></a>01106       <span class="comment">// determine if the sector is loaded</span>
<a name="l01107"></a>01107       <span class="keywordflow">if</span>( ( <a class="code" href="strategicmap_8cpp.html#49d9aed144a633fda4ba1990f002d703">gWorldSectorX</a> == MEDUNA_ITEM_DROP_OFF_SECTOR_X ) &amp;&amp; ( <a class="code" href="strategicmap_8cpp.html#ea322310ced0e35ee18a2ee7b32aac5b">gWorldSectorY</a> == MEDUNA_ITEM_DROP_OFF_SECTOR_Y ) &amp;&amp; ( <a class="code" href="strategicmap_8cpp.html#da715721a8ceedd42acf6ddb33e63ce0">gbWorldSectorZ</a> == MEDUNA_ITEM_DROP_OFF_SECTOR_Z ) )
<a name="l01108"></a>01108             fSectorLoaded = TRUE;
<a name="l01109"></a>01109       <span class="keywordflow">else</span>
<a name="l01110"></a>01110             fSectorLoaded = FALSE;
<a name="l01111"></a>01111 
<a name="l01112"></a>01112       <span class="comment">// set crate to closed!</span>
<a name="l01113"></a>01113       <span class="keywordflow">if</span> ( fSectorLoaded )
<a name="l01114"></a>01114       {
<a name="l01115"></a>01115             <a class="code" href="Structure_01Wrap_8cpp.html#a189110b98431949966c24f13afe261f">SetOpenableStructureToClosed</a>( MEDUNA_ITEM_DROP_OFF_GRIDNO, 0 );
<a name="l01116"></a>01116       }
<a name="l01117"></a>01117       <span class="keywordflow">else</span>
<a name="l01118"></a>01118       {
<a name="l01119"></a>01119             <a class="code" href="SaveLoadMap_8cpp.html#9050febf7079af325a50a8bb9e4168d5">ChangeStatusOfOpenableStructInUnloadedSector</a>( MEDUNA_ITEM_DROP_OFF_SECTOR_X, MEDUNA_ITEM_DROP_OFF_SECTOR_Y, MEDUNA_ITEM_DROP_OFF_SECTOR_Z, MEDUNA_ITEM_DROP_OFF_GRIDNO, FALSE );
<a name="l01120"></a>01120       }
<a name="l01121"></a>01121 
<a name="l01122"></a>01122       
<a name="l01123"></a>01123       <span class="keywordflow">for</span>(i=0; i&lt;<a class="code" href="BobbyRMailOrder_8cpp.html#9753076f963c32ac9de3b35e7ee8a3c5">gpNewBobbyrShipments</a>[ ubOrderNum ].<a class="code" href="structNewBobbyRayOrderStruct.html#d65ef400b66e1541bb66fb925ae17add">ubNumberPurchases</a>; i++)
<a name="l01124"></a>01124       {
<a name="l01125"></a>01125             <span class="comment">// Count how many items were purchased</span>
<a name="l01126"></a>01126             usNumberOfItems += <a class="code" href="BobbyRMailOrder_8cpp.html#9753076f963c32ac9de3b35e7ee8a3c5">gpNewBobbyrShipments</a>[ ubOrderNum ].BobbyRayPurchase[i].ubNumberPurchased;
<a name="l01127"></a>01127       }
<a name="l01128"></a>01128 
<a name="l01129"></a>01129       <span class="comment">//if we are NOT currently in the right sector</span>
<a name="l01130"></a>01130       <span class="keywordflow">if</span>( !fSectorLoaded )
<a name="l01131"></a>01131       {
<a name="l01132"></a>01132             <span class="comment">//build an array of objects to be added</span>
<a name="l01133"></a>01133             pObject = (<a class="code" href="structOBJECTTYPE.html">OBJECTTYPE</a> *) MemAlloc( <span class="keyword">sizeof</span>( <a class="code" href="structOBJECTTYPE.html">OBJECTTYPE</a> ) * usNumberOfItems );
<a name="l01134"></a>01134             <span class="keywordflow">if</span>( pObject == NULL )
<a name="l01135"></a>01135                   <span class="keywordflow">return</span>;
<a name="l01136"></a>01136             memset( pObject, 0, <span class="keyword">sizeof</span>( OBJECTTYPE ) * usNumberOfItems );
<a name="l01137"></a>01137       }
<a name="l01138"></a>01138 
<a name="l01139"></a>01139 
<a name="l01140"></a>01140       uiCount = 0;
<a name="l01141"></a>01141 
<a name="l01142"></a>01142       <span class="comment">//loop through the number of purchases</span>
<a name="l01143"></a>01143       <span class="keywordflow">for</span>( i=0; i&lt; <a class="code" href="BobbyRMailOrder_8cpp.html#9753076f963c32ac9de3b35e7ee8a3c5">gpNewBobbyrShipments</a>-&gt;<a class="code" href="structNewBobbyRayOrderStruct.html#d65ef400b66e1541bb66fb925ae17add">ubNumberPurchases</a>; i++)
<a name="l01144"></a>01144       {
<a name="l01145"></a>01145             ubItemsDelivered = <a class="code" href="BobbyRMailOrder_8cpp.html#9753076f963c32ac9de3b35e7ee8a3c5">gpNewBobbyrShipments</a>[ ubOrderNum ].BobbyRayPurchase[i].ubNumberPurchased;
<a name="l01146"></a>01146             usItem = <a class="code" href="BobbyRMailOrder_8cpp.html#9753076f963c32ac9de3b35e7ee8a3c5">gpNewBobbyrShipments</a>[ ubOrderNum ].<a class="code" href="structNewBobbyRayOrderStruct.html#a773ae8afdaeced6fcac990e9da887ec">BobbyRayPurchase</a>[i].<a class="code" href="structBobbyRayPurchaseStruct.html#63ac524baea181fbcb9a6d9f3ad939c5">usItemIndex</a>;
<a name="l01147"></a>01147 
<a name="l01148"></a>01148             <span class="keywordflow">while</span> ( ubItemsDelivered )
<a name="l01149"></a>01149             {
<a name="l01150"></a>01150                   <span class="comment">// treat 0s as 1s :-)</span>
<a name="l01151"></a>01151                   ubTempNumItems = __min( ubItemsDelivered, __max( 1, <a class="code" href="Item_01Types_8h.html#f9dc4cc7a3a99ad5944940cfb7c82237">Item</a>[ usItem ].ubPerPocket ) );
<a name="l01152"></a>01152                   <a class="code" href="Items_8cpp.html#19aed5cbf530232ff0e01c7d6e58bd8e">CreateItems</a>( usItem, <a class="code" href="BobbyRMailOrder_8cpp.html#9753076f963c32ac9de3b35e7ee8a3c5">gpNewBobbyrShipments</a>[ ubOrderNum ].BobbyRayPurchase[i].bItemQuality, ubTempNumItems, &amp;Object );
<a name="l01153"></a>01153 
<a name="l01154"></a>01154                   <span class="comment">// stack as many as possible</span>
<a name="l01155"></a>01155                   <span class="keywordflow">if</span>( fSectorLoaded )
<a name="l01156"></a>01156                   {
<a name="l01157"></a>01157                         <a class="code" href="Handle_01Items_8cpp.html#ca7f6f6da97e9a4c2b737296485f5c84">AddItemToPool</a>( MEDUNA_ITEM_DROP_OFF_GRIDNO, &amp;Object, -1, 0, 0, 0 );
<a name="l01158"></a>01158                   }
<a name="l01159"></a>01159                   <span class="keywordflow">else</span>
<a name="l01160"></a>01160                   {
<a name="l01161"></a>01161                         memcpy( &amp;pObject[ uiCount ], &amp;Object, <span class="keyword">sizeof</span>( <a class="code" href="structOBJECTTYPE.html">OBJECTTYPE</a> ) );
<a name="l01162"></a>01162                         uiCount++;
<a name="l01163"></a>01163                   }
<a name="l01164"></a>01164 
<a name="l01165"></a>01165                   ubItemsDelivered -= ubTempNumItems;
<a name="l01166"></a>01166             }
<a name="l01167"></a>01167       }
<a name="l01168"></a>01168 
<a name="l01169"></a>01169       <span class="comment">//if the sector WASNT loaded</span>
<a name="l01170"></a>01170       <span class="keywordflow">if</span>( !fSectorLoaded )
<a name="l01171"></a>01171       {
<a name="l01172"></a>01172             <span class="comment">//add all the items from the array that was built above</span>
<a name="l01173"></a>01173 
<a name="l01174"></a>01174             <span class="comment">//The item are to be added to the Top part of Drassen, grid loc's  10112, 9950</span>
<a name="l01175"></a>01175             <span class="keywordflow">if</span>( !<a class="code" href="Tactical_01Save_8cpp.html#adcc93e85d8b0ce0a47643071fe0f82d">AddItemsToUnLoadedSector</a>( MEDUNA_ITEM_DROP_OFF_SECTOR_X, MEDUNA_ITEM_DROP_OFF_SECTOR_Y, MEDUNA_ITEM_DROP_OFF_SECTOR_Z, MEDUNA_ITEM_DROP_OFF_GRIDNO, uiCount, pObject, 0, 0, 0, -1, FALSE ) )
<a name="l01176"></a>01176             {
<a name="l01177"></a>01177                   <span class="comment">//error</span>
<a name="l01178"></a>01178                   Assert( 0 );
<a name="l01179"></a>01179             }
<a name="l01180"></a>01180             MemFree( pObject );
<a name="l01181"></a>01181             pObject = NULL;
<a name="l01182"></a>01182       }
<a name="l01183"></a>01183 
<a name="l01184"></a>01184       <span class="comment">//mark that the shipment has arrived</span>
<a name="l01185"></a>01185       <a class="code" href="BobbyRMailOrder_8cpp.html#9753076f963c32ac9de3b35e7ee8a3c5">gpNewBobbyrShipments</a>[ ubOrderNum ].<a class="code" href="structNewBobbyRayOrderStruct.html#873da9e8bc226b20c83084970e3a4951">fActive</a> = FALSE;
<a name="l01186"></a>01186 
<a name="l01187"></a>01187       <span class="comment">//Add an email from kulba telling the user the shipment is there</span>
<a name="l01188"></a>01188       <a class="code" href="email_8cpp.html#a8c94e8b550c28723c1e587381bd874e">AddEmail</a>( BOBBY_R_MEDUNA_SHIPMENT, BOBBY_R_MEDUNA_SHIPMENT_LENGTH, <a class="code" href="email_8h.html#83e8bc15645f9d99ab91a152bb3dc8ceb9739e8530e4b1d34801b201464d32ee">BOBBY_R</a>, <a class="code" href="Game_01Clock_8cpp.html#4d255e800fba4d64144a7639d5f3421d">GetWorldTotalMin</a>() );
<a name="l01189"></a>01189 }
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Sat Sep 9 13:49:04 2006 for Build by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.4.7 </small></address>
</body>
</html>
