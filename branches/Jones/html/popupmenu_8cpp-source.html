<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>Build: popupmenu.cpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.4.7 -->
<div class="tabs">
  <ul>
    <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="classes.html"><span>Classes</span></a></li>
    <li id="current"><a href="files.html"><span>Files</span></a></li>
    <li><a href="dirs.html"><span>Directories</span></a></li>
    <li>
      <form action="search.php" method="get">
        <table cellspacing="0" cellpadding="0" border="0">
          <tr>
            <td><label>&nbsp;<u>S</u>earch&nbsp;for&nbsp;</label></td>
            <td><input type="text" name="query" value="" size="20" accesskey="s"/></td>
          </tr>
        </table>
      </form>
    </li>
  </ul></div>
<div class="tabs">
  <ul>
    <li><a href="files.html"><span>File&nbsp;List</span></a></li>
    <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
  </ul></div>
<div class="nav">
<a class="el" href="dir_3179ea33d55a76dc38212d9eab798728.html">export</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_e5664b4b56927c8728eb3192fa60e338.html">hdc2</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_1eb12a41a47efb9efcd82fa98f4f4dbd.html">FTP</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_80cc1f21a78ab7941088ea567f236150.html">ja2src</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_994ab287602efefceafe55287a3657d6.html">Build</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_33ea1c43094532be6a81f120546fc3d7.html">Editor</a></div>
<h1>popupmenu.cpp</h1><a href="popupmenu_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">//FUNCTIONALITY:</span>
<a name="l00002"></a>00002 <span class="comment">//This popup menu functions IDENTICALLY to Windows95's methodology.  You can use the arrow keys, or the </span>
<a name="l00003"></a>00003 <span class="comment">//mouse in two methods.  The first method is where you release the mouse button before</span>
<a name="l00004"></a>00004 <span class="comment">//moving the cursor inside the popup menu, which makes it persistant (it won't go away until you click again),</span>
<a name="l00005"></a>00005 <span class="comment">//or non-persistant, where you release the button inside the menu after your initial click (non-persistant).</span>
<a name="l00006"></a>00006 <span class="comment">//IMPORTANT NOTE:</span>
<a name="l00007"></a>00007 <span class="comment">//Linda Currie, the main user of the editor dislikes the non-persistant functionality, however, it is still</span>
<a name="l00008"></a>00008 <span class="comment">//supported.  Just remove the commented line of code (search for UNCOMMENT), and it's fixed -- it is</span>
<a name="l00009"></a>00009 <span class="comment">//currently disabled.</span>
<a name="l00010"></a>00010 
<a name="l00011"></a>00011 <span class="preprocessor">#ifdef PRECOMPILEDHEADERS</span>
<a name="l00012"></a>00012 <span class="preprocessor"></span><span class="preprocessor">      #include "<a class="code" href="Editor_01All_8h.html">Editor All.h</a>"</span>
<a name="l00013"></a>00013 <span class="preprocessor">#else</span>
<a name="l00014"></a>00014 <span class="preprocessor"></span><span class="preprocessor">      #include "<a class="code" href="builddefines_8h.html">builddefines.h</a>"</span>
<a name="l00015"></a>00015 <span class="preprocessor">#endif</span>
<a name="l00016"></a>00016 <span class="preprocessor"></span>
<a name="l00017"></a>00017 <span class="preprocessor">#ifdef JA2EDITOR</span>
<a name="l00018"></a>00018 <span class="preprocessor"></span>
<a name="l00019"></a>00019 <span class="preprocessor">#ifndef PRECOMPILEDHEADERS</span>
<a name="l00020"></a>00020 <span class="preprocessor"></span><span class="preprocessor">      #include "<a class="code" href="tiledef_8h.html">tiledef.h</a>"</span>
<a name="l00021"></a>00021 <span class="preprocessor">      #include "<a class="code" href="sysutil_8h.html">sysutil.h</a>"</span>
<a name="l00022"></a>00022 <span class="preprocessor">      #include "font.h"</span>
<a name="l00023"></a>00023 <span class="preprocessor">      #include "<a class="code" href="Font_01Control_8h.html">Font Control.h</a>"</span>
<a name="l00024"></a>00024 <span class="preprocessor">      #include "<a class="code" href="line_8h.html">line.h</a>"</span>
<a name="l00025"></a>00025 <span class="preprocessor">      #include "worlddat.h"</span>
<a name="l00026"></a>00026 <span class="preprocessor">      #include "<a class="code" href="selectwin_8h.html">selectwin.h</a>"</span>
<a name="l00027"></a>00027 <span class="preprocessor">      #include "<a class="code" href="popupmenu_8h.html">popupmenu.h</a>"</span>
<a name="l00028"></a>00028 <span class="preprocessor">      #include "<a class="code" href="EditorDefines_8h.html">EditorDefines.h</a>"</span>
<a name="l00029"></a>00029 <span class="preprocessor">      #include "render dirty.h"</span>
<a name="l00030"></a>00030 <span class="preprocessor">      #include "debug.h"</span>
<a name="l00031"></a>00031 <span class="preprocessor">      #include "<a class="code" href="mousesystem_8h.html">mousesystem.h</a>"</span>
<a name="l00032"></a>00032 <span class="preprocessor">      #include "cursors.h"</span>
<a name="l00033"></a>00033 <span class="preprocessor">      #include "overhead types.h"</span>
<a name="l00034"></a>00034 <span class="preprocessor">      #include "<a class="code" href="EditorMercs_8h.html">EditorMercs.h</a>"</span>
<a name="l00035"></a>00035 <span class="preprocessor">      #include "<a class="code" href="Scheduling_8h.html">Scheduling.h</a>"</span>
<a name="l00036"></a>00036 <span class="preprocessor">      #include "<a class="code" href="english_8h.html">english.h</a>"</span>
<a name="l00037"></a>00037 <span class="preprocessor">      #include "<a class="code" href="Item_01Statistics_8h.html">Item Statistics.h</a>"</span>
<a name="l00038"></a>00038 <span class="preprocessor">#endif</span>
<a name="l00039"></a>00039 <span class="preprocessor"></span>
<a name="l00040"></a><a class="code" href="popupmenu_8h.html#6863733f90425b49ec95a46d5329d753">00040</a> <a class="code" href="structcurrentPopupMenuInformation.html">CurrentPopupMenuInformation</a> <a class="code" href="popupmenu_8cpp.html#6863733f90425b49ec95a46d5329d753">gPopup</a>;
<a name="l00041"></a>00041 
<a name="l00042"></a><a class="code" href="popupmenu_8cpp.html#9ac92ecd81b37ec4eb46293d5463f3b4">00042</a> <a class="code" href="struct__MOUSE__REGION.html">MOUSE_REGION</a> <a class="code" href="popupmenu_8cpp.html#9ac92ecd81b37ec4eb46293d5463f3b4">popupRegion</a>;
<a name="l00043"></a>00043 
<a name="l00044"></a><a class="code" href="popupmenu_8cpp.html#5396d66bd511e00322a6ea63447e05ba">00044</a> <a class="code" href="Types_8h.html#09f1a1fb2293e33483cc8d44aefb1eb1">UINT16</a> <a class="code" href="popupmenu_8cpp.html#5396d66bd511e00322a6ea63447e05ba">gusEntryHeight</a>;
<a name="l00045"></a><a class="code" href="popupmenu_8cpp.html#df0f3777f20c12c5e1656334ad7dc416">00045</a> <a class="code" href="Types_8h.html#112e3146cb38b6ee95e64d85842e380a">BOOLEAN</a> <a class="code" href="popupmenu_8cpp.html#df0f3777f20c12c5e1656334ad7dc416">fWaitingForLButtonRelease</a> = FALSE;
<a name="l00046"></a>00046 
<a name="l00047"></a>00047 <span class="keyword">extern</span> <a class="code" href="Types_8h.html#09f1a1fb2293e33483cc8d44aefb1eb1">UINT16</a> <a class="code" href="EditorMercs_8cpp.html#91651ad3ee5934403424f95b71e1607c">gszScheduleActions</a>[ <a class="code" href="Scheduling_8h.html#9e9505a91a84992d04ba4e85217fb4e4144a57a94163da39a3070169847c6a42">NUM_SCHEDULE_ACTIONS</a> ][20];
<a name="l00048"></a>00048 
<a name="l00049"></a>00049 <span class="comment">//Finds the string for any popup menu in JA2 -- the strings are stored</span>
<a name="l00050"></a>00050 <span class="comment">//in different ways in each instance.</span>
<a name="l00051"></a><a class="code" href="popupmenu_8cpp.html#7a0bf124dedffb00ce483488c723ae61">00051</a> <a class="code" href="Types_8h.html#30f500129d8c688af07726d5d34ce52d">INT16</a>* <a class="code" href="popupmenu_8cpp.html#7a0bf124dedffb00ce483488c723ae61">GetPopupMenuString</a>( <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubIndex )
<a name="l00052"></a>00052 {
<a name="l00053"></a>00053       <span class="keywordflow">switch</span>( <a class="code" href="popupmenu_8cpp.html#6863733f90425b49ec95a46d5329d753">gPopup</a>.<a class="code" href="structcurrentPopupMenuInformation.html#f5219f5db955a19969ac24ba39a1b89a">ubPopupMenuID</a> )
<a name="l00054"></a>00054       {
<a name="l00055"></a>00055             <span class="keywordflow">case</span> <a class="code" href="popupmenu_8h.html#3bb3f6a1e767f9dfd54e62a4cd99f2b454f95e727bafeae7f94f8b606b214ec7">CHANGETSET_POPUP</a>: <span class="comment">//tile sets</span>
<a name="l00056"></a>00056                   <span class="keywordflow">return</span> <a class="code" href="WorldDat_8cpp.html#b51408144fadc1be07416ec14b35e260">gTilesets</a>[ ubIndex ].<a class="code" href="structTILESET.html#56f42f0f7f7ba6c46964239477763c47">zName</a>;
<a name="l00057"></a>00057             <span class="keywordflow">case</span> <a class="code" href="popupmenu_8h.html#3bb3f6a1e767f9dfd54e62a4cd99f2b402acce30c34ff72bafd7b542e16aafd4">OWNERSHIPGROUP_POPUP</a>: <span class="comment">//civilian groups</span>
<a name="l00058"></a>00058             <span class="keywordflow">case</span> <a class="code" href="popupmenu_8h.html#3bb3f6a1e767f9dfd54e62a4cd99f2b4f5e4da5c90a983e431e147f7af09b633">CHANGECIVGROUP_POPUP</a>: <span class="comment">//civilian groups</span>
<a name="l00059"></a>00059                   <span class="keywordflow">return</span> (<a class="code" href="Types_8h.html#30f500129d8c688af07726d5d34ce52d">INT16</a> *)<a class="code" href="EditorMercs_8cpp.html#f66d3aaa0318dca6feaac3a43266e42e">gszCivGroupNames</a>[ ubIndex ];
<a name="l00060"></a>00060             <span class="keywordflow">case</span> <a class="code" href="popupmenu_8h.html#3bb3f6a1e767f9dfd54e62a4cd99f2b450f1d397c283ba96a0e61f2179bec86c">SCHEDULEACTION_POPUP</a>: <span class="comment">//setting scheduling actions</span>
<a name="l00061"></a>00061                   <span class="keywordflow">return</span> (<a class="code" href="Types_8h.html#30f500129d8c688af07726d5d34ce52d">INT16</a> *)<a class="code" href="EditorMercs_8cpp.html#91651ad3ee5934403424f95b71e1607c">gszScheduleActions</a>[ ubIndex ];
<a name="l00062"></a>00062             <span class="keywordflow">case</span> <a class="code" href="popupmenu_8h.html#3bb3f6a1e767f9dfd54e62a4cd99f2b4be81337738ca088aa2224eede374788a">ACTIONITEM_POPUP</a>:
<a name="l00063"></a>00063                   <span class="keywordflow">return</span> (<a class="code" href="Types_8h.html#30f500129d8c688af07726d5d34ce52d">INT16</a> *)<a class="code" href="Item_01Statistics_8cpp.html#12ab72bb32de32af846220bc5b7819d0">gszActionItemDesc</a>[ ubIndex ];
<a name="l00064"></a>00064             <span class="keywordflow">default</span>:
<a name="l00065"></a>00065                   <span class="keywordflow">return</span> 0;
<a name="l00066"></a>00066       }
<a name="l00067"></a>00067 }
<a name="l00068"></a>00068 <span class="comment">/*</span>
<a name="l00069"></a>00069 <span class="comment">InitPopUpMenu</span>
<a name="l00070"></a>00070 <span class="comment">---------------</span>
<a name="l00071"></a>00071 <span class="comment">Creates the popup menu, then takes control of the i/o</span>
<a name="l00072"></a>00072 <span class="comment">effectively turning the popup into a modal system (forcing the</span>
<a name="l00073"></a>00073 <span class="comment">user to make a selection or cancel before doing anything else.</span>
<a name="l00074"></a>00074 <span class="comment">There are two modes of operation as soon as the user presses the mouse</span>
<a name="l00075"></a>00075 <span class="comment">on a popup menu activation button.</span>
<a name="l00076"></a>00076 <span class="comment">      1)  The user releases the mouse before moving the cursor onto</span>
<a name="l00077"></a>00077 <span class="comment">                  the popup region.  The popup menu will end as soon as the </span>
<a name="l00078"></a>00078 <span class="comment">                  user presses the mouse button.  If the cursor is out of the</span>
<a name="l00079"></a>00079 <span class="comment">                  popup region, then it returns 0.</span>
<a name="l00080"></a>00080 <span class="comment">      2)  The user holds the mouse while moving the cursor onto the</span>
<a name="l00081"></a>00081 <span class="comment">                  popup region.  The popup menu will end as soon as the user</span>
<a name="l00082"></a>00082 <span class="comment">                  releases the mouse button.  If the cursor is out of the popup</span>
<a name="l00083"></a>00083 <span class="comment">                  region, then it returns 0.</span>
<a name="l00084"></a>00084 <span class="comment">            </span>
<a name="l00085"></a>00085 <span class="comment"></span>
<a name="l00086"></a>00086 <span class="comment">Returns 0 if nothing in menu was selected, else</span>
<a name="l00087"></a>00087 <span class="comment">returns the menu entry number starting from 1.</span>
<a name="l00088"></a>00088 <span class="comment">*/</span>
<a name="l00089"></a>00089 
<a name="l00090"></a><a class="code" href="popupmenu_8h.html#4ac3fdf970793ef611ad5d0768985d5d">00090</a> <span class="keywordtype">void</span> <a class="code" href="popupmenu_8cpp.html#4ac3fdf970793ef611ad5d0768985d5d">InitPopupMenu</a>( <a class="code" href="Types_8h.html#1137216524060afd426c34677fed058b">INT32</a> iButtonID, <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubPopupMenuID, <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubDirection )
<a name="l00091"></a>00091 {
<a name="l00092"></a>00092       <a class="code" href="Types_8h.html#09f1a1fb2293e33483cc8d44aefb1eb1">UINT16</a> usX, usY;
<a name="l00093"></a>00093       <a class="code" href="Types_8h.html#09f1a1fb2293e33483cc8d44aefb1eb1">UINT16</a> usMenuHeight;
<a name="l00094"></a>00094       <a class="code" href="Types_8h.html#09f1a1fb2293e33483cc8d44aefb1eb1">UINT16</a> usMenuWidth = 0;
<a name="l00095"></a>00095       <a class="code" href="Types_8h.html#09f1a1fb2293e33483cc8d44aefb1eb1">UINT16</a> usCurrStrWidth;
<a name="l00096"></a>00096       <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubColumn, ubEntry;
<a name="l00097"></a>00097       <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubCounter;
<a name="l00098"></a>00098       <a class="code" href="struct__GUI__BUTTON.html">GUI_BUTTON</a> *button;
<a name="l00099"></a>00099       <span class="comment">//calculate the location of the menu based on the button position.</span>
<a name="l00100"></a>00100       <span class="comment">//This also calculates the menu's direction based on position.</span>
<a name="l00101"></a>00101 
<a name="l00102"></a>00102       <a class="code" href="popupmenu_8cpp.html#6863733f90425b49ec95a46d5329d753">gPopup</a>.<a class="code" href="structcurrentPopupMenuInformation.html#d82324f65623520c29cb7ccbfb628aed">usFont</a> = (<a class="code" href="Types_8h.html#09f1a1fb2293e33483cc8d44aefb1eb1">UINT16</a>)SMALLFONT1;
<a name="l00103"></a>00103       <a class="code" href="popupmenu_8cpp.html#5396d66bd511e00322a6ea63447e05ba">gusEntryHeight</a> = <a class="code" href="Font_8cpp.html#35cddf34696d33489efb820caf968907">GetFontHeight</a>( <a class="code" href="popupmenu_8cpp.html#6863733f90425b49ec95a46d5329d753">gPopup</a>.<a class="code" href="structcurrentPopupMenuInformation.html#d82324f65623520c29cb7ccbfb628aed">usFont</a> );
<a name="l00104"></a>00104 
<a name="l00105"></a>00105       button = <a class="code" href="Button_01System_8cpp.html#99f9e9d9b2c22bc0d2d8166c4bb2f353">ButtonList</a>[ iButtonID ];
<a name="l00106"></a>00106       <a class="code" href="mousesystem_8cpp.html#615c54bb2bb679d4ea40c755fbabd8bd">MSYS_DisableRegion</a>( &amp;<a class="code" href="Interface_8cpp.html#c6f5197961d423b1c7063b01c21c83ce">gBottomPanalRegion</a> );
<a name="l00107"></a>00107 
<a name="l00108"></a>00108       <span class="keywordflow">switch</span>( ubDirection )
<a name="l00109"></a>00109       {
<a name="l00110"></a>00110             <span class="keywordflow">case</span> DIR_UPRIGHT:
<a name="l00111"></a>00111                   usX = button-&gt;<a class="code" href="struct__GUI__BUTTON.html#4beb6551bc217db6f0979437cfdd1abb">Area</a>.<a class="code" href="struct__MOUSE__REGION.html#650c51d846b36cb1a2b59d2a0e927637">RegionTopLeftX</a>;
<a name="l00112"></a>00112                   usY = button-&gt;<a class="code" href="struct__GUI__BUTTON.html#4beb6551bc217db6f0979437cfdd1abb">Area</a>.<a class="code" href="struct__MOUSE__REGION.html#c7338c24114866626ec62cbba0b9c76b">RegionTopLeftY</a>;
<a name="l00113"></a>00113                   <span class="keywordflow">break</span>;
<a name="l00114"></a>00114             <span class="keywordflow">case</span> DIR_UPLEFT:
<a name="l00115"></a>00115                   usX = button-&gt;<a class="code" href="struct__GUI__BUTTON.html#4beb6551bc217db6f0979437cfdd1abb">Area</a>.<a class="code" href="struct__MOUSE__REGION.html#590a9300e4817bd9e2cdebbb8501dd5c">RegionBottomRightX</a>;
<a name="l00116"></a>00116                   usY = button-&gt;<a class="code" href="struct__GUI__BUTTON.html#4beb6551bc217db6f0979437cfdd1abb">Area</a>.<a class="code" href="struct__MOUSE__REGION.html#c7338c24114866626ec62cbba0b9c76b">RegionTopLeftY</a>;
<a name="l00117"></a>00117                   <span class="keywordflow">break</span>;
<a name="l00118"></a>00118             <span class="keywordflow">case</span> DIR_DOWNRIGHT:
<a name="l00119"></a>00119                   usX = button-&gt;<a class="code" href="struct__GUI__BUTTON.html#4beb6551bc217db6f0979437cfdd1abb">Area</a>.<a class="code" href="struct__MOUSE__REGION.html#650c51d846b36cb1a2b59d2a0e927637">RegionTopLeftX</a>;
<a name="l00120"></a>00120                   usY = button-&gt;<a class="code" href="struct__GUI__BUTTON.html#4beb6551bc217db6f0979437cfdd1abb">Area</a>.<a class="code" href="struct__MOUSE__REGION.html#383db9862ad729274d56bce2a2ec9340">RegionBottomRightY</a>;
<a name="l00121"></a>00121                   <span class="keywordflow">break</span>;
<a name="l00122"></a>00122             <span class="keywordflow">case</span> DIR_DOWNLEFT:
<a name="l00123"></a>00123                   usX = button-&gt;<a class="code" href="struct__GUI__BUTTON.html#4beb6551bc217db6f0979437cfdd1abb">Area</a>.<a class="code" href="struct__MOUSE__REGION.html#590a9300e4817bd9e2cdebbb8501dd5c">RegionBottomRightX</a>;
<a name="l00124"></a>00124                   usY = button-&gt;<a class="code" href="struct__GUI__BUTTON.html#4beb6551bc217db6f0979437cfdd1abb">Area</a>.<a class="code" href="struct__MOUSE__REGION.html#383db9862ad729274d56bce2a2ec9340">RegionBottomRightY</a>;
<a name="l00125"></a>00125                   <span class="keywordflow">break</span>;
<a name="l00126"></a>00126       }
<a name="l00127"></a>00127 
<a name="l00128"></a>00128       <span class="comment">//Decipher the popupMenuID</span>
<a name="l00129"></a>00129       <span class="keywordflow">switch</span>( ubPopupMenuID )
<a name="l00130"></a>00130       {
<a name="l00131"></a>00131             <span class="keywordflow">case</span> <a class="code" href="popupmenu_8h.html#3bb3f6a1e767f9dfd54e62a4cd99f2b454f95e727bafeae7f94f8b606b214ec7">CHANGETSET_POPUP</a>:  <span class="comment">//change tileset</span>
<a name="l00132"></a>00132                   <a class="code" href="popupmenu_8cpp.html#6863733f90425b49ec95a46d5329d753">gPopup</a>.<a class="code" href="structcurrentPopupMenuInformation.html#4b10ca634fb11915fb893956cb7ae9c7">ubNumEntries</a> = <a class="code" href="World_01Tileset_01Enums_8h.html#e95976356426d8250bb4a21b73c3f6db1393918d2229694095020cee3593df7d">NUM_TILESETS</a>;
<a name="l00133"></a>00133                   <span class="keywordflow">break</span>;
<a name="l00134"></a>00134             <span class="keywordflow">case</span> <a class="code" href="popupmenu_8h.html#3bb3f6a1e767f9dfd54e62a4cd99f2b402acce30c34ff72bafd7b542e16aafd4">OWNERSHIPGROUP_POPUP</a>:
<a name="l00135"></a>00135             <span class="keywordflow">case</span> <a class="code" href="popupmenu_8h.html#3bb3f6a1e767f9dfd54e62a4cd99f2b4f5e4da5c90a983e431e147f7af09b633">CHANGECIVGROUP_POPUP</a>:
<a name="l00136"></a>00136                   <a class="code" href="popupmenu_8cpp.html#6863733f90425b49ec95a46d5329d753">gPopup</a>.<a class="code" href="structcurrentPopupMenuInformation.html#4b10ca634fb11915fb893956cb7ae9c7">ubNumEntries</a> = <a class="code" href="Overhead_01Types_8h.html#e6cdb622357fec6e889e47579a0785243f6e24328cb224b93d72e04eb3a34e76">NUM_CIV_GROUPS</a>;
<a name="l00137"></a>00137                   <span class="keywordflow">break</span>;
<a name="l00138"></a>00138             <span class="keywordflow">case</span> <a class="code" href="popupmenu_8h.html#3bb3f6a1e767f9dfd54e62a4cd99f2b450f1d397c283ba96a0e61f2179bec86c">SCHEDULEACTION_POPUP</a>:
<a name="l00139"></a>00139                   <a class="code" href="popupmenu_8cpp.html#6863733f90425b49ec95a46d5329d753">gPopup</a>.<a class="code" href="structcurrentPopupMenuInformation.html#4b10ca634fb11915fb893956cb7ae9c7">ubNumEntries</a> = <a class="code" href="Scheduling_8h.html#9e9505a91a84992d04ba4e85217fb4e4144a57a94163da39a3070169847c6a42">NUM_SCHEDULE_ACTIONS</a>;
<a name="l00140"></a>00140                   <span class="keywordflow">break</span>;
<a name="l00141"></a>00141             <span class="keywordflow">case</span> <a class="code" href="popupmenu_8h.html#3bb3f6a1e767f9dfd54e62a4cd99f2b4be81337738ca088aa2224eede374788a">ACTIONITEM_POPUP</a>:
<a name="l00142"></a>00142                   <a class="code" href="popupmenu_8cpp.html#6863733f90425b49ec95a46d5329d753">gPopup</a>.<a class="code" href="structcurrentPopupMenuInformation.html#4b10ca634fb11915fb893956cb7ae9c7">ubNumEntries</a> = <a class="code" href="Item_01Statistics_8h.html#6b7b47dd702d9e331586d485013fd1ead7bab823235712224789ce756fe5765b">NUM_ACTIONITEMS</a>;
<a name="l00143"></a>00143                   <span class="keywordflow">break</span>;
<a name="l00144"></a>00144             <span class="keywordflow">default</span>:
<a name="l00145"></a>00145                   <span class="keywordflow">return</span>;
<a name="l00146"></a>00146       }
<a name="l00147"></a>00147 
<a name="l00148"></a>00148       <a class="code" href="popupmenu_8cpp.html#6863733f90425b49ec95a46d5329d753">gPopup</a>.<a class="code" href="structcurrentPopupMenuInformation.html#d82324f65623520c29cb7ccbfb628aed">usFont</a> = (<a class="code" href="Types_8h.html#09f1a1fb2293e33483cc8d44aefb1eb1">UINT16</a>)SMALLFONT1;
<a name="l00149"></a>00149       <a class="code" href="popupmenu_8cpp.html#5396d66bd511e00322a6ea63447e05ba">gusEntryHeight</a> = <a class="code" href="Font_8cpp.html#35cddf34696d33489efb820caf968907">GetFontHeight</a>( <a class="code" href="popupmenu_8cpp.html#6863733f90425b49ec95a46d5329d753">gPopup</a>.<a class="code" href="structcurrentPopupMenuInformation.html#d82324f65623520c29cb7ccbfb628aed">usFont</a> );
<a name="l00150"></a>00150 
<a name="l00151"></a>00151       button = <a class="code" href="Button_01System_8cpp.html#99f9e9d9b2c22bc0d2d8166c4bb2f353">ButtonList</a>[ iButtonID ];
<a name="l00152"></a>00152       <a class="code" href="mousesystem_8cpp.html#615c54bb2bb679d4ea40c755fbabd8bd">MSYS_DisableRegion</a>( &amp;<a class="code" href="Interface_8cpp.html#c6f5197961d423b1c7063b01c21c83ce">gBottomPanalRegion</a> );
<a name="l00153"></a>00153 
<a name="l00154"></a>00154       <a class="code" href="popupmenu_8cpp.html#6863733f90425b49ec95a46d5329d753">gPopup</a>.<a class="code" href="structcurrentPopupMenuInformation.html#f5219f5db955a19969ac24ba39a1b89a">ubPopupMenuID</a> = ubPopupMenuID;
<a name="l00155"></a>00155       <a class="code" href="popupmenu_8cpp.html#6863733f90425b49ec95a46d5329d753">gPopup</a>.<a class="code" href="structcurrentPopupMenuInformation.html#e6e20c6f2dfcd6035ab94c41ec217fcb">ubSelectedIndex</a> = 0;
<a name="l00156"></a>00156       <a class="code" href="popupmenu_8cpp.html#6863733f90425b49ec95a46d5329d753">gPopup</a>.<a class="code" href="structcurrentPopupMenuInformation.html#c351d329debfd74d1875c42a04fbacc3">ubActiveType</a> = POPUP_ACTIVETYPE_NOT_YET_DETERMINED;
<a name="l00157"></a>00157       <a class="code" href="popupmenu_8cpp.html#6863733f90425b49ec95a46d5329d753">gPopup</a>.<a class="code" href="structcurrentPopupMenuInformation.html#b2adda7fd50140063f80079d6b4670f7">fActive</a> = TRUE;
<a name="l00158"></a>00158       <a class="code" href="popupmenu_8cpp.html#df0f3777f20c12c5e1656334ad7dc416">fWaitingForLButtonRelease</a> = FALSE;
<a name="l00159"></a>00159       <a class="code" href="popupmenu_8cpp.html#6863733f90425b49ec95a46d5329d753">gPopup</a>.<a class="code" href="structcurrentPopupMenuInformation.html#0e6efc116c87b10c754bffd8b996131c">fUseKeyboardInfoUntilMouseMoves</a> = FALSE;
<a name="l00160"></a>00160       <span class="comment">//Initialize the last mouse position to be out of bounds.</span>
<a name="l00161"></a>00161       <a class="code" href="popupmenu_8cpp.html#6863733f90425b49ec95a46d5329d753">gPopup</a>.<a class="code" href="structcurrentPopupMenuInformation.html#5a9ad1aa996a6cf7cc468f52045be034">usLastMouseX</a> = 1000;
<a name="l00162"></a>00162       <a class="code" href="popupmenu_8cpp.html#6863733f90425b49ec95a46d5329d753">gPopup</a>.<a class="code" href="structcurrentPopupMenuInformation.html#24f1e88ca439f71823fb97c31b8d5942">usLastMouseY</a> = 1000;
<a name="l00163"></a>00163       <span class="comment">//clear the column widths.</span>
<a name="l00164"></a>00164       <span class="keywordflow">for</span>( ubColumn = 0; ubColumn &lt; MAX_COLUMNS; ubColumn++ )
<a name="l00165"></a>00165             <a class="code" href="popupmenu_8cpp.html#6863733f90425b49ec95a46d5329d753">gPopup</a>.<a class="code" href="structcurrentPopupMenuInformation.html#490360f4f981974378187ee25a6efc22">ubColumnWidth</a>[ ubColumn ] = 0;
<a name="l00166"></a>00166 
<a name="l00167"></a>00167       <span class="comment">//1) Calc total entry height of the popup region.</span>
<a name="l00168"></a>00168       <a class="code" href="popupmenu_8cpp.html#6863733f90425b49ec95a46d5329d753">gPopup</a>.<a class="code" href="structcurrentPopupMenuInformation.html#3f420776d943c15208f4228633931348">ubColumns</a> = 1;
<a name="l00169"></a>00169       <a class="code" href="popupmenu_8cpp.html#6863733f90425b49ec95a46d5329d753">gPopup</a>.<a class="code" href="structcurrentPopupMenuInformation.html#1524b388dd8258fc06805354ba03bdf5">ubMaxEntriesPerColumn</a> = <a class="code" href="popupmenu_8cpp.html#6863733f90425b49ec95a46d5329d753">gPopup</a>.<a class="code" href="structcurrentPopupMenuInformation.html#4b10ca634fb11915fb893956cb7ae9c7">ubNumEntries</a>;
<a name="l00170"></a>00170       usMenuHeight = <a class="code" href="popupmenu_8cpp.html#6863733f90425b49ec95a46d5329d753">gPopup</a>.<a class="code" href="structcurrentPopupMenuInformation.html#4b10ca634fb11915fb893956cb7ae9c7">ubNumEntries</a> * <a class="code" href="popupmenu_8cpp.html#5396d66bd511e00322a6ea63447e05ba">gusEntryHeight</a> + 3;
<a name="l00171"></a>00171       <span class="keywordflow">while</span>( usMenuHeight &gt;= usY &amp;&amp; ( ubDirection == DIR_UPLEFT || ubDirection == DIR_UPRIGHT ) ||
<a name="l00172"></a>00172                          480-usMenuHeight &gt;= usY &amp;&amp; ( ubDirection == DIR_DOWNLEFT || ubDirection == DIR_DOWNRIGHT ) )
<a name="l00173"></a>00173       { <span class="comment">//menu has too many entries.  Increase the number of columns until the height is</span>
<a name="l00174"></a>00174             <span class="comment">//less than the max height.</span>
<a name="l00175"></a>00175             <a class="code" href="popupmenu_8cpp.html#6863733f90425b49ec95a46d5329d753">gPopup</a>.<a class="code" href="structcurrentPopupMenuInformation.html#1524b388dd8258fc06805354ba03bdf5">ubMaxEntriesPerColumn</a> = (<a class="code" href="popupmenu_8cpp.html#6863733f90425b49ec95a46d5329d753">gPopup</a>.<a class="code" href="structcurrentPopupMenuInformation.html#4b10ca634fb11915fb893956cb7ae9c7">ubNumEntries</a>+<a class="code" href="popupmenu_8cpp.html#6863733f90425b49ec95a46d5329d753">gPopup</a>.<a class="code" href="structcurrentPopupMenuInformation.html#3f420776d943c15208f4228633931348">ubColumns</a>)/(<a class="code" href="popupmenu_8cpp.html#6863733f90425b49ec95a46d5329d753">gPopup</a>.<a class="code" href="structcurrentPopupMenuInformation.html#3f420776d943c15208f4228633931348">ubColumns</a>+1);
<a name="l00176"></a>00176             usMenuHeight = <a class="code" href="popupmenu_8cpp.html#6863733f90425b49ec95a46d5329d753">gPopup</a>.<a class="code" href="structcurrentPopupMenuInformation.html#1524b388dd8258fc06805354ba03bdf5">ubMaxEntriesPerColumn</a> * <a class="code" href="popupmenu_8cpp.html#5396d66bd511e00322a6ea63447e05ba">gusEntryHeight</a> + 3;
<a name="l00177"></a>00177             <a class="code" href="popupmenu_8cpp.html#6863733f90425b49ec95a46d5329d753">gPopup</a>.<a class="code" href="structcurrentPopupMenuInformation.html#3f420776d943c15208f4228633931348">ubColumns</a>++;
<a name="l00178"></a>00178       }
<a name="l00179"></a>00179       <span class="comment">//now we have the number of columns as well as the max number of entries per column, and</span>
<a name="l00180"></a>00180       <span class="comment">//the total menu height.  </span>
<a name="l00181"></a>00181 
<a name="l00182"></a>00182       <span class="comment">//We now calculate the total width of the menu as well as the max width of each column.</span>
<a name="l00183"></a>00183       ubCounter = 0;
<a name="l00184"></a>00184       usMenuWidth = 0;
<a name="l00185"></a>00185       <span class="keywordflow">for</span>( ubColumn = 0; ubColumn &lt; <a class="code" href="popupmenu_8cpp.html#6863733f90425b49ec95a46d5329d753">gPopup</a>.<a class="code" href="structcurrentPopupMenuInformation.html#3f420776d943c15208f4228633931348">ubColumns</a>; ubColumn++ )
<a name="l00186"></a>00186       {
<a name="l00187"></a>00187             <span class="keywordflow">for</span>( ubEntry = 0; ubEntry &lt; <a class="code" href="popupmenu_8cpp.html#6863733f90425b49ec95a46d5329d753">gPopup</a>.<a class="code" href="structcurrentPopupMenuInformation.html#1524b388dd8258fc06805354ba03bdf5">ubMaxEntriesPerColumn</a>; ubEntry++ )
<a name="l00188"></a>00188             {
<a name="l00189"></a>00189                   <span class="keywordflow">if</span>( ubCounter &gt;= <a class="code" href="popupmenu_8cpp.html#6863733f90425b49ec95a46d5329d753">gPopup</a>.<a class="code" href="structcurrentPopupMenuInformation.html#4b10ca634fb11915fb893956cb7ae9c7">ubNumEntries</a> )
<a name="l00190"></a>00190                         <span class="keywordflow">break</span>; <span class="comment">//done (don't want to process undefined entries...)</span>
<a name="l00191"></a>00191                   usCurrStrWidth = 16 + <a class="code" href="Font_8cpp.html#3bbbfeabebae07a03f719f35607c6e4f">StringPixLength</a>( <a class="code" href="popupmenu_8cpp.html#7a0bf124dedffb00ce483488c723ae61">GetPopupMenuString</a>( ubCounter ) , <a class="code" href="popupmenu_8cpp.html#6863733f90425b49ec95a46d5329d753">gPopup</a>.<a class="code" href="structcurrentPopupMenuInformation.html#d82324f65623520c29cb7ccbfb628aed">usFont</a> );
<a name="l00192"></a>00192                   <span class="keywordflow">if</span>( usCurrStrWidth &gt; <a class="code" href="popupmenu_8cpp.html#6863733f90425b49ec95a46d5329d753">gPopup</a>.<a class="code" href="structcurrentPopupMenuInformation.html#490360f4f981974378187ee25a6efc22">ubColumnWidth</a>[ ubColumn ] )
<a name="l00193"></a>00193                   {
<a name="l00194"></a>00194                         <a class="code" href="popupmenu_8cpp.html#6863733f90425b49ec95a46d5329d753">gPopup</a>.<a class="code" href="structcurrentPopupMenuInformation.html#490360f4f981974378187ee25a6efc22">ubColumnWidth</a>[ ubColumn ] = (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)usCurrStrWidth;
<a name="l00195"></a>00195                   }
<a name="l00196"></a>00196                   ubCounter++;
<a name="l00197"></a>00197             }
<a name="l00198"></a>00198             usMenuWidth += <a class="code" href="popupmenu_8cpp.html#6863733f90425b49ec95a46d5329d753">gPopup</a>.<a class="code" href="structcurrentPopupMenuInformation.html#490360f4f981974378187ee25a6efc22">ubColumnWidth</a>[ ubColumn ];
<a name="l00199"></a>00199       }
<a name="l00200"></a>00200       
<a name="l00201"></a>00201       <span class="comment">//Calculate popup menu boundaries based on direction from argument point.</span>
<a name="l00202"></a>00202       <span class="keywordflow">switch</span>( ubDirection )
<a name="l00203"></a>00203       {
<a name="l00204"></a>00204             <span class="keywordflow">case</span> DIR_UPRIGHT:
<a name="l00205"></a>00205                   <a class="code" href="popupmenu_8cpp.html#6863733f90425b49ec95a46d5329d753">gPopup</a>.<a class="code" href="structcurrentPopupMenuInformation.html#9d466de3ec3573e83ba294351178e248">usLeft</a> = usX;
<a name="l00206"></a>00206                   <a class="code" href="popupmenu_8cpp.html#6863733f90425b49ec95a46d5329d753">gPopup</a>.<a class="code" href="structcurrentPopupMenuInformation.html#b29012ad5c9bf01c3b5a5bec9b1f130a">usTop</a> = usY - usMenuHeight - 1;
<a name="l00207"></a>00207                   <a class="code" href="popupmenu_8cpp.html#6863733f90425b49ec95a46d5329d753">gPopup</a>.<a class="code" href="structcurrentPopupMenuInformation.html#4bfeb6fdd0f32e1ced06f51d8bcc4dfc">usRight</a> = usX + usMenuWidth;
<a name="l00208"></a>00208                   <a class="code" href="popupmenu_8cpp.html#6863733f90425b49ec95a46d5329d753">gPopup</a>.<a class="code" href="structcurrentPopupMenuInformation.html#58227169591938c92f43219f75aad348">usBottom</a> = usY - 1;
<a name="l00209"></a>00209                   <span class="keywordflow">break</span>;
<a name="l00210"></a>00210             <span class="keywordflow">case</span> DIR_UPLEFT:
<a name="l00211"></a>00211                   <a class="code" href="popupmenu_8cpp.html#6863733f90425b49ec95a46d5329d753">gPopup</a>.<a class="code" href="structcurrentPopupMenuInformation.html#9d466de3ec3573e83ba294351178e248">usLeft</a> = usX - usMenuWidth;
<a name="l00212"></a>00212                   <a class="code" href="popupmenu_8cpp.html#6863733f90425b49ec95a46d5329d753">gPopup</a>.<a class="code" href="structcurrentPopupMenuInformation.html#b29012ad5c9bf01c3b5a5bec9b1f130a">usTop</a> = usY - usMenuHeight - 1; 
<a name="l00213"></a>00213                   <a class="code" href="popupmenu_8cpp.html#6863733f90425b49ec95a46d5329d753">gPopup</a>.<a class="code" href="structcurrentPopupMenuInformation.html#4bfeb6fdd0f32e1ced06f51d8bcc4dfc">usRight</a> = usX; 
<a name="l00214"></a>00214                   <a class="code" href="popupmenu_8cpp.html#6863733f90425b49ec95a46d5329d753">gPopup</a>.<a class="code" href="structcurrentPopupMenuInformation.html#58227169591938c92f43219f75aad348">usBottom</a> = usY - 1;
<a name="l00215"></a>00215                   <span class="keywordflow">break</span>;
<a name="l00216"></a>00216             <span class="keywordflow">case</span> DIR_DOWNRIGHT:
<a name="l00217"></a>00217                   <a class="code" href="popupmenu_8cpp.html#6863733f90425b49ec95a46d5329d753">gPopup</a>.<a class="code" href="structcurrentPopupMenuInformation.html#9d466de3ec3573e83ba294351178e248">usLeft</a> = usX;
<a name="l00218"></a>00218                   <a class="code" href="popupmenu_8cpp.html#6863733f90425b49ec95a46d5329d753">gPopup</a>.<a class="code" href="structcurrentPopupMenuInformation.html#b29012ad5c9bf01c3b5a5bec9b1f130a">usTop</a> = usY + 1;
<a name="l00219"></a>00219                   <a class="code" href="popupmenu_8cpp.html#6863733f90425b49ec95a46d5329d753">gPopup</a>.<a class="code" href="structcurrentPopupMenuInformation.html#4bfeb6fdd0f32e1ced06f51d8bcc4dfc">usRight</a> = usX + usMenuWidth;
<a name="l00220"></a>00220                   <a class="code" href="popupmenu_8cpp.html#6863733f90425b49ec95a46d5329d753">gPopup</a>.<a class="code" href="structcurrentPopupMenuInformation.html#58227169591938c92f43219f75aad348">usBottom</a> = usY + usMenuHeight + 1;
<a name="l00221"></a>00221                   <span class="keywordflow">break</span>;
<a name="l00222"></a>00222             <span class="keywordflow">case</span> DIR_DOWNLEFT:
<a name="l00223"></a>00223                   <a class="code" href="popupmenu_8cpp.html#6863733f90425b49ec95a46d5329d753">gPopup</a>.<a class="code" href="structcurrentPopupMenuInformation.html#9d466de3ec3573e83ba294351178e248">usLeft</a> = usX - usMenuWidth;
<a name="l00224"></a>00224                   <a class="code" href="popupmenu_8cpp.html#6863733f90425b49ec95a46d5329d753">gPopup</a>.<a class="code" href="structcurrentPopupMenuInformation.html#b29012ad5c9bf01c3b5a5bec9b1f130a">usTop</a> = usY + 1; 
<a name="l00225"></a>00225                   <a class="code" href="popupmenu_8cpp.html#6863733f90425b49ec95a46d5329d753">gPopup</a>.<a class="code" href="structcurrentPopupMenuInformation.html#4bfeb6fdd0f32e1ced06f51d8bcc4dfc">usRight</a> = usX; 
<a name="l00226"></a>00226                   <a class="code" href="popupmenu_8cpp.html#6863733f90425b49ec95a46d5329d753">gPopup</a>.<a class="code" href="structcurrentPopupMenuInformation.html#58227169591938c92f43219f75aad348">usBottom</a> = usY + usMenuHeight + 1;
<a name="l00227"></a>00227                   <span class="keywordflow">break</span>;
<a name="l00228"></a>00228       }
<a name="l00229"></a>00229       <a class="code" href="mousesystem_8cpp.html#dce08766ef4cbacb9372efe12d26a1e0">MSYS_DefineRegion</a>( &amp;<a class="code" href="popupmenu_8cpp.html#9ac92ecd81b37ec4eb46293d5463f3b4">popupRegion</a>, 0, 0, 640, 480, MSYS_PRIORITY_HIGHEST,
<a name="l00230"></a>00230                                      <a class="code" href="Cursors_8h.html#5e184f913c35dbf305f3c369dee23e19b855da01a6ebcbd6bdad89a28b4ce5c8">CURSOR_NORMAL</a>, MSYS_NO_CALLBACK, MSYS_NO_CALLBACK ); 
<a name="l00231"></a>00231 
<a name="l00232"></a>00232       <a class="code" href="popupmenu_8cpp.html#b9748180bec875bd9beb4d64fd0cf6f3">RenderPopupMenu</a>();
<a name="l00233"></a>00233 }
<a name="l00234"></a>00234 
<a name="l00235"></a><a class="code" href="popupmenu_8h.html#b9748180bec875bd9beb4d64fd0cf6f3">00235</a> <span class="keywordtype">void</span> <a class="code" href="popupmenu_8cpp.html#b9748180bec875bd9beb4d64fd0cf6f3">RenderPopupMenu</a>()
<a name="l00236"></a>00236 {
<a name="l00237"></a>00237       <a class="code" href="Types_8h.html#09f1a1fb2293e33483cc8d44aefb1eb1">UINT16</a> usX, usY;
<a name="l00238"></a>00238       <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubColumn, ubEntry, ubCounter;
<a name="l00239"></a>00239       <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> *pDestBuf;
<a name="l00240"></a>00240       <a class="code" href="Types_8h.html#e1e6edbbc26d6fbc71a90190d0266018">UINT32</a> uiDestPitchBYTES;
<a name="l00241"></a>00241       <a class="code" href="Types_8h.html#09f1a1fb2293e33483cc8d44aefb1eb1">UINT16</a> usLineColor;
<a name="l00242"></a>00242       <a class="code" href="Types_8h.html#09f1a1fb2293e33483cc8d44aefb1eb1">UINT16</a> usStringWidth;
<a name="l00243"></a>00243       <a class="code" href="Types_8h.html#09f1a1fb2293e33483cc8d44aefb1eb1">UINT16</a> usStart;
<a name="l00244"></a>00244 
<a name="l00245"></a>00245       <span class="comment">//Draw the menu</span>
<a name="l00246"></a>00246       <a class="code" href="vsurface_8cpp.html#10d0257b54c4d27b2d82ead2a46cd581">ColorFillVideoSurfaceArea</a>(FRAME_BUFFER, 
<a name="l00247"></a>00247             <a class="code" href="popupmenu_8cpp.html#6863733f90425b49ec95a46d5329d753">gPopup</a>.<a class="code" href="structcurrentPopupMenuInformation.html#9d466de3ec3573e83ba294351178e248">usLeft</a>, <a class="code" href="popupmenu_8cpp.html#6863733f90425b49ec95a46d5329d753">gPopup</a>.<a class="code" href="structcurrentPopupMenuInformation.html#b29012ad5c9bf01c3b5a5bec9b1f130a">usTop</a>, <a class="code" href="popupmenu_8cpp.html#6863733f90425b49ec95a46d5329d753">gPopup</a>.<a class="code" href="structcurrentPopupMenuInformation.html#4bfeb6fdd0f32e1ced06f51d8bcc4dfc">usRight</a>, <a class="code" href="popupmenu_8cpp.html#6863733f90425b49ec95a46d5329d753">gPopup</a>.<a class="code" href="structcurrentPopupMenuInformation.html#58227169591938c92f43219f75aad348">usBottom</a>, 
<a name="l00248"></a>00248             <a class="code" href="himage_8cpp.html#d29939ffcd39c7d1cc0a91222702d361">Get16BPPColor</a>(FROMRGB(128, 128, 128) ) );
<a name="l00249"></a>00249       pDestBuf = <a class="code" href="vsurface_8cpp.html#592b2aeda6075fcbf9d7c67dc44fbd47">LockVideoSurface</a>( FRAME_BUFFER, &amp;uiDestPitchBYTES );               
<a name="l00250"></a>00250       <a class="code" href="line_8cpp.html#03cb6a8fa3b4bbdfcdab02c903bc7b7e">SetClippingRegionAndImageWidth</a>( uiDestPitchBYTES, 0, 0, 640, 480 );
<a name="l00251"></a>00251       usLineColor = <a class="code" href="himage_8cpp.html#d29939ffcd39c7d1cc0a91222702d361">Get16BPPColor</a>( FROMRGB( 64, 64, 64 ) );
<a name="l00252"></a>00252       <a class="code" href="line_8cpp.html#2806e958344a513567053e98757e64b3">RectangleDraw</a>( TRUE, <a class="code" href="popupmenu_8cpp.html#6863733f90425b49ec95a46d5329d753">gPopup</a>.<a class="code" href="structcurrentPopupMenuInformation.html#9d466de3ec3573e83ba294351178e248">usLeft</a>, <a class="code" href="popupmenu_8cpp.html#6863733f90425b49ec95a46d5329d753">gPopup</a>.<a class="code" href="structcurrentPopupMenuInformation.html#b29012ad5c9bf01c3b5a5bec9b1f130a">usTop</a>, <a class="code" href="popupmenu_8cpp.html#6863733f90425b49ec95a46d5329d753">gPopup</a>.<a class="code" href="structcurrentPopupMenuInformation.html#4bfeb6fdd0f32e1ced06f51d8bcc4dfc">usRight</a>, <a class="code" href="popupmenu_8cpp.html#6863733f90425b49ec95a46d5329d753">gPopup</a>.<a class="code" href="structcurrentPopupMenuInformation.html#58227169591938c92f43219f75aad348">usBottom</a>, 
<a name="l00253"></a>00253             usLineColor, pDestBuf );
<a name="l00254"></a>00254       <span class="keywordflow">if</span>( <a class="code" href="popupmenu_8cpp.html#6863733f90425b49ec95a46d5329d753">gPopup</a>.<a class="code" href="structcurrentPopupMenuInformation.html#3f420776d943c15208f4228633931348">ubColumns</a> &gt; 1 )
<a name="l00255"></a>00255       { <span class="comment">//draw a vertical line between each column</span>
<a name="l00256"></a>00256             usStart = <a class="code" href="popupmenu_8cpp.html#6863733f90425b49ec95a46d5329d753">gPopup</a>.<a class="code" href="structcurrentPopupMenuInformation.html#9d466de3ec3573e83ba294351178e248">usLeft</a> + <a class="code" href="popupmenu_8cpp.html#6863733f90425b49ec95a46d5329d753">gPopup</a>.<a class="code" href="structcurrentPopupMenuInformation.html#490360f4f981974378187ee25a6efc22">ubColumnWidth</a>[ 0 ];
<a name="l00257"></a>00257             <span class="keywordflow">for</span>( ubColumn = 1; ubColumn &lt; <a class="code" href="popupmenu_8cpp.html#6863733f90425b49ec95a46d5329d753">gPopup</a>.<a class="code" href="structcurrentPopupMenuInformation.html#3f420776d943c15208f4228633931348">ubColumns</a>; ubColumn++ )
<a name="l00258"></a>00258             {
<a name="l00259"></a>00259                   <a class="code" href="line_8cpp.html#aa92e189d27648ae67b8b8f5de610f42">LineDraw</a>( TRUE, usStart, <a class="code" href="popupmenu_8cpp.html#6863733f90425b49ec95a46d5329d753">gPopup</a>.<a class="code" href="structcurrentPopupMenuInformation.html#b29012ad5c9bf01c3b5a5bec9b1f130a">usTop</a>, usStart, <a class="code" href="popupmenu_8cpp.html#6863733f90425b49ec95a46d5329d753">gPopup</a>.<a class="code" href="structcurrentPopupMenuInformation.html#58227169591938c92f43219f75aad348">usBottom</a>, usLineColor, pDestBuf );
<a name="l00260"></a>00260             }
<a name="l00261"></a>00261             usStart += (<a class="code" href="Types_8h.html#09f1a1fb2293e33483cc8d44aefb1eb1">UINT16</a>)<a class="code" href="popupmenu_8cpp.html#6863733f90425b49ec95a46d5329d753">gPopup</a>.<a class="code" href="structcurrentPopupMenuInformation.html#490360f4f981974378187ee25a6efc22">ubColumnWidth</a>[ ubColumn ];
<a name="l00262"></a>00262       }
<a name="l00263"></a>00263       <a class="code" href="vsurface_8cpp.html#abe4e4124597b70b046a3b3567002cb2">UnLockVideoSurface</a>( FRAME_BUFFER );
<a name="l00264"></a>00264 
<a name="l00265"></a>00265       <span class="comment">//Set up the text attributes.</span>
<a name="l00266"></a>00266       <a class="code" href="Font_8cpp.html#fa4871009f0473cca0380217753947dc">SetFont</a>( <a class="code" href="popupmenu_8cpp.html#6863733f90425b49ec95a46d5329d753">gPopup</a>.<a class="code" href="structcurrentPopupMenuInformation.html#d82324f65623520c29cb7ccbfb628aed">usFont</a>);
<a name="l00267"></a>00267       <a class="code" href="Font_8cpp.html#a1fe8cc526be9e2c96b5dd66e348506f">SetFontBackground</a>( FONT_MCOLOR_BLACK );
<a name="l00268"></a>00268       <a class="code" href="Font_8cpp.html#388be5810478c3f3bdb861f144085d70">SetFontForeground</a>( FONT_MCOLOR_WHITE );
<a name="l00269"></a>00269       
<a name="l00270"></a>00270       usX = <a class="code" href="popupmenu_8cpp.html#6863733f90425b49ec95a46d5329d753">gPopup</a>.<a class="code" href="structcurrentPopupMenuInformation.html#9d466de3ec3573e83ba294351178e248">usLeft</a> + 1;
<a name="l00271"></a>00271       ubCounter = 0;
<a name="l00272"></a>00272       usStart = <a class="code" href="popupmenu_8cpp.html#6863733f90425b49ec95a46d5329d753">gPopup</a>.<a class="code" href="structcurrentPopupMenuInformation.html#9d466de3ec3573e83ba294351178e248">usLeft</a>;
<a name="l00273"></a>00273       <span class="keywordflow">for</span>( ubColumn = 0; ubColumn &lt; <a class="code" href="popupmenu_8cpp.html#6863733f90425b49ec95a46d5329d753">gPopup</a>.<a class="code" href="structcurrentPopupMenuInformation.html#3f420776d943c15208f4228633931348">ubColumns</a>; ubColumn++ )
<a name="l00274"></a>00274       {
<a name="l00275"></a>00275             <span class="keywordflow">for</span>( ubEntry = 0; ubEntry &lt; <a class="code" href="popupmenu_8cpp.html#6863733f90425b49ec95a46d5329d753">gPopup</a>.<a class="code" href="structcurrentPopupMenuInformation.html#1524b388dd8258fc06805354ba03bdf5">ubMaxEntriesPerColumn</a>; ubEntry++ )
<a name="l00276"></a>00276             {
<a name="l00277"></a>00277                   <span class="keywordflow">if</span>( ubCounter &gt;= <a class="code" href="popupmenu_8cpp.html#6863733f90425b49ec95a46d5329d753">gPopup</a>.<a class="code" href="structcurrentPopupMenuInformation.html#4b10ca634fb11915fb893956cb7ae9c7">ubNumEntries</a> )
<a name="l00278"></a>00278                         <span class="keywordflow">return</span>; <span class="comment">//done</span>
<a name="l00279"></a>00279                   <span class="comment">//Calc current string's width in pixels.  Adding 14 pixels which is the width of</span>
<a name="l00280"></a>00280                   <span class="comment">//two padded gPopup.usFont spaces not stored in the string.</span>
<a name="l00281"></a>00281                   usStringWidth = 14 + <a class="code" href="Font_8cpp.html#3bbbfeabebae07a03f719f35607c6e4f">StringPixLength</a>( <a class="code" href="popupmenu_8cpp.html#7a0bf124dedffb00ce483488c723ae61">GetPopupMenuString</a>( ubCounter ), <a class="code" href="popupmenu_8cpp.html#6863733f90425b49ec95a46d5329d753">gPopup</a>.<a class="code" href="structcurrentPopupMenuInformation.html#d82324f65623520c29cb7ccbfb628aed">usFont</a> );
<a name="l00282"></a>00282                   <span class="comment">//Horizontally center the string inside the popup menu</span>
<a name="l00283"></a>00283                   usX = usStart + ( <a class="code" href="popupmenu_8cpp.html#6863733f90425b49ec95a46d5329d753">gPopup</a>.<a class="code" href="structcurrentPopupMenuInformation.html#490360f4f981974378187ee25a6efc22">ubColumnWidth</a>[ ubColumn ] - usStringWidth ) / 2;
<a name="l00284"></a>00284                   usY = <a class="code" href="popupmenu_8cpp.html#6863733f90425b49ec95a46d5329d753">gPopup</a>.<a class="code" href="structcurrentPopupMenuInformation.html#b29012ad5c9bf01c3b5a5bec9b1f130a">usTop</a> + 1 + ubEntry * <a class="code" href="popupmenu_8cpp.html#5396d66bd511e00322a6ea63447e05ba">gusEntryHeight</a>;
<a name="l00285"></a>00285                   <span class="keywordflow">if</span>( ubCounter == <a class="code" href="popupmenu_8cpp.html#6863733f90425b49ec95a46d5329d753">gPopup</a>.<a class="code" href="structcurrentPopupMenuInformation.html#e6e20c6f2dfcd6035ab94c41ec217fcb">ubSelectedIndex</a> - 1 )
<a name="l00286"></a>00286                   {
<a name="l00287"></a>00287                         <span class="comment">//This is the highlighted menu entry.</span>
<a name="l00288"></a>00288                         <a class="code" href="Font_8cpp.html#388be5810478c3f3bdb861f144085d70">SetFontForeground</a>( FONT_MCOLOR_LTBLUE );
<a name="l00289"></a>00289                         <a class="code" href="Font_8cpp.html#b3e12cf19a0ca58abf6689cc8eca3ead">mprintf</a>( usX, usY, L<span class="stringliteral">" %s "</span>, <a class="code" href="popupmenu_8cpp.html#7a0bf124dedffb00ce483488c723ae61">GetPopupMenuString</a>( ubCounter ) );
<a name="l00290"></a>00290                         <a class="code" href="Font_8cpp.html#388be5810478c3f3bdb861f144085d70">SetFontForeground</a>( FONT_MCOLOR_WHITE );
<a name="l00291"></a>00291                   }
<a name="l00292"></a>00292                   <span class="keywordflow">else</span>
<a name="l00293"></a>00293                   {
<a name="l00294"></a>00294                         <a class="code" href="Font_8cpp.html#b3e12cf19a0ca58abf6689cc8eca3ead">mprintf</a>( usX, usY, L<span class="stringliteral">" %s "</span>, <a class="code" href="popupmenu_8cpp.html#7a0bf124dedffb00ce483488c723ae61">GetPopupMenuString</a>( ubCounter ) );
<a name="l00295"></a>00295                   }
<a name="l00296"></a>00296                   ubCounter++;
<a name="l00297"></a>00297             }
<a name="l00298"></a>00298             usStart += <a class="code" href="popupmenu_8cpp.html#6863733f90425b49ec95a46d5329d753">gPopup</a>.<a class="code" href="structcurrentPopupMenuInformation.html#490360f4f981974378187ee25a6efc22">ubColumnWidth</a>[ ubColumn ];
<a name="l00299"></a>00299       }
<a name="l00300"></a>00300 }
<a name="l00301"></a>00301 
<a name="l00302"></a>00302 <span class="comment">//This private function of PopupMenuHandle determines which menu entry</span>
<a name="l00303"></a>00303 <span class="comment">//is highlighted based on the mouse cursor position.  Returns 0 if the</span>
<a name="l00304"></a>00304 <span class="comment">//mouse is out of the menu region.</span>
<a name="l00305"></a><a class="code" href="popupmenu_8cpp.html#886c6b44d499762b248cddc0128b6478">00305</a> <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> <a class="code" href="popupmenu_8cpp.html#886c6b44d499762b248cddc0128b6478">GetPopupIndexFromMousePosition</a>()
<a name="l00306"></a>00306 {
<a name="l00307"></a>00307       <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubNumEntriesDown;
<a name="l00308"></a>00308       <a class="code" href="Types_8h.html#09f1a1fb2293e33483cc8d44aefb1eb1">UINT16</a> usRelX;
<a name="l00309"></a>00309       <a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a> ubCount;
<a name="l00310"></a>00310       <span class="keywordflow">if</span>( <a class="code" href="input_8cpp.html#01dea51e8a845c10078bb3e9fde80209">gusMouseXPos</a> &gt;= <a class="code" href="popupmenu_8cpp.html#6863733f90425b49ec95a46d5329d753">gPopup</a>.<a class="code" href="structcurrentPopupMenuInformation.html#9d466de3ec3573e83ba294351178e248">usLeft</a> 
<a name="l00311"></a>00311             &amp;&amp; <a class="code" href="input_8cpp.html#01dea51e8a845c10078bb3e9fde80209">gusMouseXPos</a> &lt;= <a class="code" href="popupmenu_8cpp.html#6863733f90425b49ec95a46d5329d753">gPopup</a>.<a class="code" href="structcurrentPopupMenuInformation.html#4bfeb6fdd0f32e1ced06f51d8bcc4dfc">usRight</a>
<a name="l00312"></a>00312             &amp;&amp; <a class="code" href="input_8cpp.html#cb09b6d6d53490d8a11992dd51f582f3">gusMouseYPos</a> &gt; <a class="code" href="popupmenu_8cpp.html#6863733f90425b49ec95a46d5329d753">gPopup</a>.<a class="code" href="structcurrentPopupMenuInformation.html#b29012ad5c9bf01c3b5a5bec9b1f130a">usTop</a>                                    <span class="comment">//one pixel gap on top ignored</span>
<a name="l00313"></a>00313             &amp;&amp; <a class="code" href="input_8cpp.html#cb09b6d6d53490d8a11992dd51f582f3">gusMouseYPos</a> &lt; <a class="code" href="popupmenu_8cpp.html#6863733f90425b49ec95a46d5329d753">gPopup</a>.<a class="code" href="structcurrentPopupMenuInformation.html#58227169591938c92f43219f75aad348">usBottom</a> - 2 )         <span class="comment">//two pixel gap on bottom ignored</span>
<a name="l00314"></a>00314       {
<a name="l00315"></a>00315             <span class="comment">//subtract the top y coord of the popup region from the mouse's yPos as well</span>
<a name="l00316"></a>00316             <span class="comment">//as an extra pixel at the top of the region which is ignored in menu selection,</span>
<a name="l00317"></a>00317             <span class="comment">//divide this number by the height of a menu entry, then add one.  This will</span>
<a name="l00318"></a>00318             <span class="comment">//return the menu index from 1 (at the top) to n (at the bottom).</span>
<a name="l00319"></a>00319             ubNumEntriesDown = (<a class="code" href="input_8cpp.html#cb09b6d6d53490d8a11992dd51f582f3">gusMouseYPos</a> - <a class="code" href="popupmenu_8cpp.html#6863733f90425b49ec95a46d5329d753">gPopup</a>.<a class="code" href="structcurrentPopupMenuInformation.html#b29012ad5c9bf01c3b5a5bec9b1f130a">usTop</a> - 1) / <a class="code" href="popupmenu_8cpp.html#5396d66bd511e00322a6ea63447e05ba">gusEntryHeight</a> + 1;
<a name="l00320"></a>00320             usRelX = <a class="code" href="input_8cpp.html#01dea51e8a845c10078bb3e9fde80209">gusMouseXPos</a> - <a class="code" href="popupmenu_8cpp.html#6863733f90425b49ec95a46d5329d753">gPopup</a>.<a class="code" href="structcurrentPopupMenuInformation.html#9d466de3ec3573e83ba294351178e248">usLeft</a>;
<a name="l00321"></a>00321             ubCount=0;
<a name="l00322"></a>00322             <span class="keywordflow">while</span>( usRelX &gt; <a class="code" href="popupmenu_8cpp.html#6863733f90425b49ec95a46d5329d753">gPopup</a>.<a class="code" href="structcurrentPopupMenuInformation.html#490360f4f981974378187ee25a6efc22">ubColumnWidth</a>[ ubCount ] )
<a name="l00323"></a>00323             {
<a name="l00324"></a>00324                   usRelX -= <a class="code" href="popupmenu_8cpp.html#6863733f90425b49ec95a46d5329d753">gPopup</a>.<a class="code" href="structcurrentPopupMenuInformation.html#490360f4f981974378187ee25a6efc22">ubColumnWidth</a>[ ubCount ];
<a name="l00325"></a>00325                   ubCount++;
<a name="l00326"></a>00326                   ubNumEntriesDown += <a class="code" href="popupmenu_8cpp.html#6863733f90425b49ec95a46d5329d753">gPopup</a>.<a class="code" href="structcurrentPopupMenuInformation.html#1524b388dd8258fc06805354ba03bdf5">ubMaxEntriesPerColumn</a>;
<a name="l00327"></a>00327             }
<a name="l00328"></a>00328             <span class="keywordflow">if</span>( ubNumEntriesDown &gt;= <a class="code" href="popupmenu_8cpp.html#6863733f90425b49ec95a46d5329d753">gPopup</a>.<a class="code" href="structcurrentPopupMenuInformation.html#4b10ca634fb11915fb893956cb7ae9c7">ubNumEntries</a> )
<a name="l00329"></a>00329                   ubNumEntriesDown = <a class="code" href="popupmenu_8cpp.html#6863733f90425b49ec95a46d5329d753">gPopup</a>.<a class="code" href="structcurrentPopupMenuInformation.html#4b10ca634fb11915fb893956cb7ae9c7">ubNumEntries</a>;
<a name="l00330"></a>00330             <span class="keywordflow">return</span> ubNumEntriesDown;
<a name="l00331"></a>00331       }
<a name="l00332"></a>00332       <span class="keywordflow">return</span> 0; <span class="comment">//mouse not in valid region.</span>
<a name="l00333"></a>00333 }
<a name="l00334"></a>00334 
<a name="l00335"></a><a class="code" href="popupmenu_8h.html#bdfc512bef94c1c3fb95fed6762c3528">00335</a> <span class="keywordtype">void</span> <a class="code" href="popupmenu_8cpp.html#bdfc512bef94c1c3fb95fed6762c3528">PopupMenuHandle</a>()
<a name="l00336"></a>00336 {
<a name="l00337"></a>00337       <a class="code" href="structInputAtom.html">InputAtom</a> InputEvent;
<a name="l00338"></a>00338 
<a name="l00339"></a>00339       <span class="keywordflow">if</span>( <a class="code" href="popupmenu_8cpp.html#6863733f90425b49ec95a46d5329d753">gPopup</a>.<a class="code" href="structcurrentPopupMenuInformation.html#c351d329debfd74d1875c42a04fbacc3">ubActiveType</a> == POPUP_ACTIVETYPE_NOT_YET_DETERMINED )
<a name="l00340"></a>00340       {
<a name="l00341"></a>00341             <span class="comment">//Attempt to determine if the menu will be persistant or not.</span>
<a name="l00342"></a>00342             <span class="comment">//Determination is made when the mouse's left button is released or if</span>
<a name="l00343"></a>00343             <span class="comment">//the mouse cursor enters the menu region.</span>
<a name="l00344"></a>00344             <span class="keywordflow">if</span>( <a class="code" href="input_8cpp.html#01dea51e8a845c10078bb3e9fde80209">gusMouseXPos</a> &gt;= <a class="code" href="popupmenu_8cpp.html#6863733f90425b49ec95a46d5329d753">gPopup</a>.<a class="code" href="structcurrentPopupMenuInformation.html#9d466de3ec3573e83ba294351178e248">usLeft</a> 
<a name="l00345"></a>00345                   &amp;&amp; <a class="code" href="input_8cpp.html#01dea51e8a845c10078bb3e9fde80209">gusMouseXPos</a> &lt;= <a class="code" href="popupmenu_8cpp.html#6863733f90425b49ec95a46d5329d753">gPopup</a>.<a class="code" href="structcurrentPopupMenuInformation.html#4bfeb6fdd0f32e1ced06f51d8bcc4dfc">usRight</a>
<a name="l00346"></a>00346                   &amp;&amp; <a class="code" href="input_8cpp.html#cb09b6d6d53490d8a11992dd51f582f3">gusMouseYPos</a> &gt; <a class="code" href="popupmenu_8cpp.html#6863733f90425b49ec95a46d5329d753">gPopup</a>.<a class="code" href="structcurrentPopupMenuInformation.html#b29012ad5c9bf01c3b5a5bec9b1f130a">usTop</a>                                    <span class="comment">//one pixel gap on top ignored</span>
<a name="l00347"></a>00347                   &amp;&amp; <a class="code" href="input_8cpp.html#cb09b6d6d53490d8a11992dd51f582f3">gusMouseYPos</a> &lt; <a class="code" href="popupmenu_8cpp.html#6863733f90425b49ec95a46d5329d753">gPopup</a>.<a class="code" href="structcurrentPopupMenuInformation.html#58227169591938c92f43219f75aad348">usBottom</a> - 1 )         <span class="comment">//two pixel gap on bottom ignored</span>
<a name="l00348"></a>00348             {
<a name="l00349"></a>00349                   <span class="comment">//mouse cursor has just entered the menu region -- nonpersistant.</span>
<a name="l00350"></a>00350 
<a name="l00351"></a>00351                   <span class="comment">//KRIS:  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!</span>
<a name="l00352"></a>00352                   <span class="comment">//Disabled this because Linda doesn't like it... (I like it though, and it works)</span><span class="comment"></span>
<a name="l00353"></a>00353 <span class="comment">                  //!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!</span>
<a name="l00354"></a>00354 <span class="comment"></span>                  <span class="comment">//UNCOMMENT IF NONPERSISTANT IS ALLOWED</span>
<a name="l00355"></a>00355                   <span class="comment">//gPopup.ubActiveType = POPUP_ACTIVETYPE_NONPERSISTANT;</span>
<a name="l00356"></a>00356 
<a name="l00357"></a>00357                   <span class="keywordflow">return</span>;
<a name="l00358"></a>00358             }
<a name="l00359"></a>00359             <span class="keywordflow">else</span> <span class="keywordflow">if</span>( !<a class="code" href="input_8cpp.html#fb2dcc39ce3dcb01df1593baa94e3c62">gfLeftButtonState</a> )
<a name="l00360"></a>00360             {     <span class="comment">//left button has been released before entering region -- persistant</span>
<a name="l00361"></a>00361                   <a class="code" href="popupmenu_8cpp.html#6863733f90425b49ec95a46d5329d753">gPopup</a>.<a class="code" href="structcurrentPopupMenuInformation.html#c351d329debfd74d1875c42a04fbacc3">ubActiveType</a> = POPUP_ACTIVETYPE_PERSISTANT;
<a name="l00362"></a>00362                   <span class="keywordflow">return</span>;
<a name="l00363"></a>00363             }
<a name="l00364"></a>00364       }
<a name="l00365"></a>00365       <span class="keywordflow">if</span>( !<a class="code" href="popupmenu_8cpp.html#6863733f90425b49ec95a46d5329d753">gPopup</a>.<a class="code" href="structcurrentPopupMenuInformation.html#0e6efc116c87b10c754bffd8b996131c">fUseKeyboardInfoUntilMouseMoves</a> )
<a name="l00366"></a>00366       {
<a name="l00367"></a>00367             <span class="comment">//check menu entry based on mouse position</span>
<a name="l00368"></a>00368             <a class="code" href="popupmenu_8cpp.html#6863733f90425b49ec95a46d5329d753">gPopup</a>.<a class="code" href="structcurrentPopupMenuInformation.html#e6e20c6f2dfcd6035ab94c41ec217fcb">ubSelectedIndex</a> = <a class="code" href="popupmenu_8cpp.html#886c6b44d499762b248cddc0128b6478">GetPopupIndexFromMousePosition</a>();
<a name="l00369"></a>00369       }
<a name="l00370"></a>00370       <span class="keywordflow">else</span> <span class="keywordflow">if</span>( <a class="code" href="input_8cpp.html#01dea51e8a845c10078bb3e9fde80209">gusMouseXPos</a> != <a class="code" href="popupmenu_8cpp.html#6863733f90425b49ec95a46d5329d753">gPopup</a>.<a class="code" href="structcurrentPopupMenuInformation.html#5a9ad1aa996a6cf7cc468f52045be034">usLastMouseX</a> || <a class="code" href="input_8cpp.html#cb09b6d6d53490d8a11992dd51f582f3">gusMouseYPos</a> != <a class="code" href="popupmenu_8cpp.html#6863733f90425b49ec95a46d5329d753">gPopup</a>.<a class="code" href="structcurrentPopupMenuInformation.html#24f1e88ca439f71823fb97c31b8d5942">usLastMouseY</a> )
<a name="l00371"></a>00371       {
<a name="l00372"></a>00372             <span class="comment">//The keyboard determined the last entry, but the mouse has moved,</span>
<a name="l00373"></a>00373             <span class="comment">//so use the mouse to determine the new entry.</span>
<a name="l00374"></a>00374             <a class="code" href="popupmenu_8cpp.html#6863733f90425b49ec95a46d5329d753">gPopup</a>.<a class="code" href="structcurrentPopupMenuInformation.html#0e6efc116c87b10c754bffd8b996131c">fUseKeyboardInfoUntilMouseMoves</a> = FALSE;
<a name="l00375"></a>00375             <a class="code" href="popupmenu_8cpp.html#6863733f90425b49ec95a46d5329d753">gPopup</a>.<a class="code" href="structcurrentPopupMenuInformation.html#e6e20c6f2dfcd6035ab94c41ec217fcb">ubSelectedIndex</a> = <a class="code" href="popupmenu_8cpp.html#886c6b44d499762b248cddc0128b6478">GetPopupIndexFromMousePosition</a>();
<a name="l00376"></a>00376       }
<a name="l00377"></a>00377       <span class="comment">//Check terminating conditions for persistant states.</span>
<a name="l00378"></a>00378       <span class="keywordflow">if</span>( <a class="code" href="input_8cpp.html#fb2dcc39ce3dcb01df1593baa94e3c62">gfLeftButtonState</a> &amp;&amp; <a class="code" href="popupmenu_8cpp.html#6863733f90425b49ec95a46d5329d753">gPopup</a>.<a class="code" href="structcurrentPopupMenuInformation.html#c351d329debfd74d1875c42a04fbacc3">ubActiveType</a> == POPUP_ACTIVETYPE_PERSISTANT )
<a name="l00379"></a>00379             <a class="code" href="popupmenu_8cpp.html#df0f3777f20c12c5e1656334ad7dc416">fWaitingForLButtonRelease</a> = TRUE;
<a name="l00380"></a>00380       <span class="keywordflow">if</span>( <a class="code" href="input_8cpp.html#fb2dcc39ce3dcb01df1593baa94e3c62">gfLeftButtonState</a> &amp;&amp; <a class="code" href="popupmenu_8cpp.html#6863733f90425b49ec95a46d5329d753">gPopup</a>.<a class="code" href="structcurrentPopupMenuInformation.html#c351d329debfd74d1875c42a04fbacc3">ubActiveType</a> == POPUP_ACTIVETYPE_PERSISTANT 
<a name="l00381"></a>00381             || !<a class="code" href="input_8cpp.html#fb2dcc39ce3dcb01df1593baa94e3c62">gfLeftButtonState</a> &amp;&amp; <a class="code" href="popupmenu_8cpp.html#6863733f90425b49ec95a46d5329d753">gPopup</a>.<a class="code" href="structcurrentPopupMenuInformation.html#c351d329debfd74d1875c42a04fbacc3">ubActiveType</a> == POPUP_ACTIVETYPE_NONPERSISTANT )
<a name="l00382"></a>00382       {
<a name="l00383"></a>00383             <span class="comment">//Selection conditions via mouse have been met whether the mouse is in the </span>
<a name="l00384"></a>00384             <span class="comment">//menu region or not.</span>
<a name="l00385"></a>00385             <a class="code" href="popupmenu_8cpp.html#6863733f90425b49ec95a46d5329d753">gPopup</a>.<a class="code" href="structcurrentPopupMenuInformation.html#e6e20c6f2dfcd6035ab94c41ec217fcb">ubSelectedIndex</a> = <a class="code" href="popupmenu_8cpp.html#886c6b44d499762b248cddc0128b6478">GetPopupIndexFromMousePosition</a>();
<a name="l00386"></a>00386             <span class="keywordflow">if</span>( <a class="code" href="popupmenu_8cpp.html#6863733f90425b49ec95a46d5329d753">gPopup</a>.<a class="code" href="structcurrentPopupMenuInformation.html#e6e20c6f2dfcd6035ab94c41ec217fcb">ubSelectedIndex</a> )
<a name="l00387"></a>00387             {
<a name="l00388"></a>00388                   <a class="code" href="popupmenu_8cpp.html#d856c0fc546f832f5b3d20901c2326b4">ProcessPopupMenuSelection</a>();  
<a name="l00389"></a>00389             }
<a name="l00390"></a>00390             <a class="code" href="popupmenu_8cpp.html#6863733f90425b49ec95a46d5329d753">gPopup</a>.<a class="code" href="structcurrentPopupMenuInformation.html#b2adda7fd50140063f80079d6b4670f7">fActive</a> = FALSE;
<a name="l00391"></a>00391             <a class="code" href="mousesystem_8cpp.html#f2581a6cadb531c87ebd6b3f5b70f258">MSYS_RemoveRegion</a>( &amp;<a class="code" href="popupmenu_8cpp.html#9ac92ecd81b37ec4eb46293d5463f3b4">popupRegion</a> );
<a name="l00392"></a>00392             <a class="code" href="EditorDefines_8h.html#5a075eed02dac8017c99a606bc7124c3">gfRenderWorld</a> = TRUE;
<a name="l00393"></a>00393             <a class="code" href="EditorDefines_8h.html#3a8478611d591d976e9e594885e1811a">gfRenderTaskbar</a> = TRUE;
<a name="l00394"></a>00394             <span class="keywordflow">return</span>;
<a name="l00395"></a>00395       }
<a name="l00396"></a>00396       <span class="comment">//Use keyboard input as well.</span>
<a name="l00397"></a>00397       <span class="keywordflow">while</span>( <a class="code" href="input_8cpp.html#aa80627b666beae961462d3619bfa8b3">DequeueEvent</a>( &amp;InputEvent ) )
<a name="l00398"></a>00398       {
<a name="l00399"></a>00399             <span class="keywordflow">switch</span>(InputEvent.<a class="code" href="structInputAtom.html#3cf53aa0e37277ff1a69bb6230e600ce">usEvent</a>)
<a name="l00400"></a>00400             {
<a name="l00401"></a>00401                   <span class="keywordflow">case</span> KEY_DOWN:
<a name="l00402"></a>00402                         <span class="keywordflow">switch</span>( InputEvent.<a class="code" href="structInputAtom.html#c171abb99b6fe1f56f9bae755bdac911">usParam</a> )
<a name="l00403"></a>00403                         {
<a name="l00404"></a>00404                               <span class="keywordflow">case</span> DNARROW:
<a name="l00405"></a>00405                                     <a class="code" href="popupmenu_8cpp.html#6863733f90425b49ec95a46d5329d753">gPopup</a>.<a class="code" href="structcurrentPopupMenuInformation.html#0e6efc116c87b10c754bffd8b996131c">fUseKeyboardInfoUntilMouseMoves</a> = TRUE;
<a name="l00406"></a>00406                                     <a class="code" href="popupmenu_8cpp.html#6863733f90425b49ec95a46d5329d753">gPopup</a>.<a class="code" href="structcurrentPopupMenuInformation.html#5a9ad1aa996a6cf7cc468f52045be034">usLastMouseX</a> = <a class="code" href="input_8cpp.html#01dea51e8a845c10078bb3e9fde80209">gusMouseXPos</a>;
<a name="l00407"></a>00407                                     <a class="code" href="popupmenu_8cpp.html#6863733f90425b49ec95a46d5329d753">gPopup</a>.<a class="code" href="structcurrentPopupMenuInformation.html#24f1e88ca439f71823fb97c31b8d5942">usLastMouseY</a> = <a class="code" href="input_8cpp.html#cb09b6d6d53490d8a11992dd51f582f3">gusMouseYPos</a>;
<a name="l00408"></a>00408                                     <a class="code" href="popupmenu_8cpp.html#6863733f90425b49ec95a46d5329d753">gPopup</a>.<a class="code" href="structcurrentPopupMenuInformation.html#e6e20c6f2dfcd6035ab94c41ec217fcb">ubSelectedIndex</a>++;
<a name="l00409"></a>00409                                     <span class="keywordflow">if</span>( <a class="code" href="popupmenu_8cpp.html#6863733f90425b49ec95a46d5329d753">gPopup</a>.<a class="code" href="structcurrentPopupMenuInformation.html#e6e20c6f2dfcd6035ab94c41ec217fcb">ubSelectedIndex</a> &gt; <a class="code" href="popupmenu_8cpp.html#6863733f90425b49ec95a46d5329d753">gPopup</a>.<a class="code" href="structcurrentPopupMenuInformation.html#4b10ca634fb11915fb893956cb7ae9c7">ubNumEntries</a> )
<a name="l00410"></a>00410                                     {
<a name="l00411"></a>00411                                           <a class="code" href="popupmenu_8cpp.html#6863733f90425b49ec95a46d5329d753">gPopup</a>.<a class="code" href="structcurrentPopupMenuInformation.html#e6e20c6f2dfcd6035ab94c41ec217fcb">ubSelectedIndex</a> = 1;
<a name="l00412"></a>00412                                     }
<a name="l00413"></a>00413                                     <span class="keywordflow">break</span>;
<a name="l00414"></a>00414                               <span class="keywordflow">case</span> UPARROW:
<a name="l00415"></a>00415                                     <a class="code" href="popupmenu_8cpp.html#6863733f90425b49ec95a46d5329d753">gPopup</a>.<a class="code" href="structcurrentPopupMenuInformation.html#0e6efc116c87b10c754bffd8b996131c">fUseKeyboardInfoUntilMouseMoves</a> = TRUE;
<a name="l00416"></a>00416                                     <a class="code" href="popupmenu_8cpp.html#6863733f90425b49ec95a46d5329d753">gPopup</a>.<a class="code" href="structcurrentPopupMenuInformation.html#5a9ad1aa996a6cf7cc468f52045be034">usLastMouseX</a> = <a class="code" href="input_8cpp.html#01dea51e8a845c10078bb3e9fde80209">gusMouseXPos</a>;
<a name="l00417"></a>00417                                     <a class="code" href="popupmenu_8cpp.html#6863733f90425b49ec95a46d5329d753">gPopup</a>.<a class="code" href="structcurrentPopupMenuInformation.html#24f1e88ca439f71823fb97c31b8d5942">usLastMouseY</a> = <a class="code" href="input_8cpp.html#cb09b6d6d53490d8a11992dd51f582f3">gusMouseYPos</a>;
<a name="l00418"></a>00418                                     <span class="keywordflow">if</span>( <a class="code" href="popupmenu_8cpp.html#6863733f90425b49ec95a46d5329d753">gPopup</a>.<a class="code" href="structcurrentPopupMenuInformation.html#e6e20c6f2dfcd6035ab94c41ec217fcb">ubSelectedIndex</a> &lt; 2 )
<a name="l00419"></a>00419                                     {
<a name="l00420"></a>00420                                           <a class="code" href="popupmenu_8cpp.html#6863733f90425b49ec95a46d5329d753">gPopup</a>.<a class="code" href="structcurrentPopupMenuInformation.html#e6e20c6f2dfcd6035ab94c41ec217fcb">ubSelectedIndex</a> = <a class="code" href="popupmenu_8cpp.html#6863733f90425b49ec95a46d5329d753">gPopup</a>.<a class="code" href="structcurrentPopupMenuInformation.html#4b10ca634fb11915fb893956cb7ae9c7">ubNumEntries</a>;
<a name="l00421"></a>00421                                     }
<a name="l00422"></a>00422                                     <span class="keywordflow">else</span>
<a name="l00423"></a>00423                                     {
<a name="l00424"></a>00424                                           <a class="code" href="popupmenu_8cpp.html#6863733f90425b49ec95a46d5329d753">gPopup</a>.<a class="code" href="structcurrentPopupMenuInformation.html#e6e20c6f2dfcd6035ab94c41ec217fcb">ubSelectedIndex</a>--;
<a name="l00425"></a>00425                                     }
<a name="l00426"></a>00426                                     <span class="keywordflow">break</span>;
<a name="l00427"></a>00427                               <span class="keywordflow">case</span> ESC:
<a name="l00428"></a>00428                                     <a class="code" href="popupmenu_8cpp.html#6863733f90425b49ec95a46d5329d753">gPopup</a>.<a class="code" href="structcurrentPopupMenuInformation.html#b2adda7fd50140063f80079d6b4670f7">fActive</a> = FALSE;
<a name="l00429"></a>00429                                     <a class="code" href="mousesystem_8cpp.html#f2581a6cadb531c87ebd6b3f5b70f258">MSYS_RemoveRegion</a>( &amp;<a class="code" href="popupmenu_8cpp.html#9ac92ecd81b37ec4eb46293d5463f3b4">popupRegion</a> );
<a name="l00430"></a>00430                                     <a class="code" href="EditorDefines_8h.html#5a075eed02dac8017c99a606bc7124c3">gfRenderWorld</a> = TRUE;
<a name="l00431"></a>00431                                     <a class="code" href="EditorDefines_8h.html#3a8478611d591d976e9e594885e1811a">gfRenderTaskbar</a> = TRUE;
<a name="l00432"></a>00432                                     <span class="keywordflow">break</span>;
<a name="l00433"></a>00433                               <span class="keywordflow">case</span> ENTER:
<a name="l00434"></a>00434                                     <a class="code" href="popupmenu_8cpp.html#d856c0fc546f832f5b3d20901c2326b4">ProcessPopupMenuSelection</a>();
<a name="l00435"></a>00435                                     <a class="code" href="popupmenu_8cpp.html#6863733f90425b49ec95a46d5329d753">gPopup</a>.<a class="code" href="structcurrentPopupMenuInformation.html#b2adda7fd50140063f80079d6b4670f7">fActive</a> = FALSE;
<a name="l00436"></a>00436                                     <a class="code" href="mousesystem_8cpp.html#f2581a6cadb531c87ebd6b3f5b70f258">MSYS_RemoveRegion</a>( &amp;<a class="code" href="popupmenu_8cpp.html#9ac92ecd81b37ec4eb46293d5463f3b4">popupRegion</a> );
<a name="l00437"></a>00437                                     <a class="code" href="EditorDefines_8h.html#5a075eed02dac8017c99a606bc7124c3">gfRenderWorld</a> = TRUE;
<a name="l00438"></a>00438                                     <a class="code" href="EditorDefines_8h.html#3a8478611d591d976e9e594885e1811a">gfRenderTaskbar</a> = TRUE;
<a name="l00439"></a>00439                                     <span class="keywordflow">break</span>;
<a name="l00440"></a>00440                         }
<a name="l00441"></a>00441                         <span class="keywordflow">break</span>;
<a name="l00442"></a>00442             }
<a name="l00443"></a>00443   }
<a name="l00444"></a>00444 }
<a name="l00445"></a>00445 
<a name="l00446"></a><a class="code" href="popupmenu_8h.html#d856c0fc546f832f5b3d20901c2326b4">00446</a> <span class="keywordtype">void</span> <a class="code" href="popupmenu_8cpp.html#d856c0fc546f832f5b3d20901c2326b4">ProcessPopupMenuSelection</a>()
<a name="l00447"></a>00447 {
<a name="l00448"></a>00448       <span class="keywordflow">switch</span>( <a class="code" href="popupmenu_8cpp.html#6863733f90425b49ec95a46d5329d753">gPopup</a>.<a class="code" href="structcurrentPopupMenuInformation.html#f5219f5db955a19969ac24ba39a1b89a">ubPopupMenuID</a> )
<a name="l00449"></a>00449       {
<a name="l00450"></a>00450             <span class="keywordflow">case</span> <a class="code" href="popupmenu_8h.html#3bb3f6a1e767f9dfd54e62a4cd99f2b454f95e727bafeae7f94f8b606b214ec7">CHANGETSET_POPUP</a>:
<a name="l00451"></a>00451                   <span class="comment">//change the tileset here.</span>
<a name="l00452"></a>00452                   <a class="code" href="worlddef_8cpp.html#262020df11087dd74365c57cd5ac3d07">ReloadTileset</a>( (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)(<a class="code" href="popupmenu_8cpp.html#6863733f90425b49ec95a46d5329d753">gPopup</a>.<a class="code" href="structcurrentPopupMenuInformation.html#e6e20c6f2dfcd6035ab94c41ec217fcb">ubSelectedIndex</a> - 1 ) );
<a name="l00453"></a>00453                   <a class="code" href="selectwin_8cpp.html#551062510eedc768983fcb4d87e8377f">InitJA2SelectionWindow</a>( );
<a name="l00454"></a>00454                   <span class="keywordflow">break</span>;
<a name="l00455"></a>00455             <span class="keywordflow">case</span> <a class="code" href="popupmenu_8h.html#3bb3f6a1e767f9dfd54e62a4cd99f2b4f5e4da5c90a983e431e147f7af09b633">CHANGECIVGROUP_POPUP</a>:
<a name="l00456"></a>00456                   <a class="code" href="EditorMercs_8cpp.html#2911409a58f041f97af83c44aaeb5ef5">ChangeCivGroup</a>( (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)(<a class="code" href="popupmenu_8cpp.html#6863733f90425b49ec95a46d5329d753">gPopup</a>.<a class="code" href="structcurrentPopupMenuInformation.html#e6e20c6f2dfcd6035ab94c41ec217fcb">ubSelectedIndex</a> - 1) );
<a name="l00457"></a>00457                   <span class="keywordflow">break</span>;
<a name="l00458"></a>00458             <span class="keywordflow">case</span> <a class="code" href="popupmenu_8h.html#3bb3f6a1e767f9dfd54e62a4cd99f2b450f1d397c283ba96a0e61f2179bec86c">SCHEDULEACTION_POPUP</a>:
<a name="l00459"></a>00459                   <a class="code" href="EditorMercs_8cpp.html#4e6633bb17eec4453f988802bd5f594e">UpdateScheduleAction</a>( (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)(<a class="code" href="popupmenu_8cpp.html#6863733f90425b49ec95a46d5329d753">gPopup</a>.<a class="code" href="structcurrentPopupMenuInformation.html#e6e20c6f2dfcd6035ab94c41ec217fcb">ubSelectedIndex</a> - 1) );
<a name="l00460"></a>00460                   <span class="keywordflow">break</span>;
<a name="l00461"></a>00461             <span class="keywordflow">case</span> <a class="code" href="popupmenu_8h.html#3bb3f6a1e767f9dfd54e62a4cd99f2b4be81337738ca088aa2224eede374788a">ACTIONITEM_POPUP</a>:
<a name="l00462"></a>00462                   <a class="code" href="Item_01Statistics_8cpp.html#6363fbd21f6310b8ef61d95d69ced968">UpdateActionItem</a>( (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)(<a class="code" href="popupmenu_8cpp.html#6863733f90425b49ec95a46d5329d753">gPopup</a>.<a class="code" href="structcurrentPopupMenuInformation.html#e6e20c6f2dfcd6035ab94c41ec217fcb">ubSelectedIndex</a> - 1) );
<a name="l00463"></a>00463                   <span class="keywordflow">break</span>;
<a name="l00464"></a>00464             <span class="keywordflow">case</span> <a class="code" href="popupmenu_8h.html#3bb3f6a1e767f9dfd54e62a4cd99f2b402acce30c34ff72bafd7b542e16aafd4">OWNERSHIPGROUP_POPUP</a>:
<a name="l00465"></a>00465                   <a class="code" href="Item_01Statistics_8cpp.html#498b7088027451c8e93b1296e8d80def">SetOwnershipGroup</a>( (<a class="code" href="Types_8h.html#b27e9918b538ce9d8ca692479b375b6a">UINT8</a>)(<a class="code" href="popupmenu_8cpp.html#6863733f90425b49ec95a46d5329d753">gPopup</a>.<a class="code" href="structcurrentPopupMenuInformation.html#e6e20c6f2dfcd6035ab94c41ec217fcb">ubSelectedIndex</a> - 1) );
<a name="l00466"></a>00466                   <span class="keywordflow">break</span>;
<a name="l00467"></a>00467       }
<a name="l00468"></a>00468 }
<a name="l00469"></a>00469 
<a name="l00470"></a><a class="code" href="popupmenu_8h.html#05c2053703ef8d577efd1b676c361f3e">00470</a> <a class="code" href="Types_8h.html#112e3146cb38b6ee95e64d85842e380a">BOOLEAN</a> <a class="code" href="popupmenu_8cpp.html#05c2053703ef8d577efd1b676c361f3e">ProcessPopupMenuIfActive</a>( )
<a name="l00471"></a>00471 {
<a name="l00472"></a>00472       <span class="keywordflow">if</span>( !<a class="code" href="popupmenu_8cpp.html#6863733f90425b49ec95a46d5329d753">gPopup</a>.<a class="code" href="structcurrentPopupMenuInformation.html#b2adda7fd50140063f80079d6b4670f7">fActive</a> &amp;&amp; !<a class="code" href="popupmenu_8cpp.html#df0f3777f20c12c5e1656334ad7dc416">fWaitingForLButtonRelease</a> )
<a name="l00473"></a>00473             <span class="keywordflow">return</span> FALSE;
<a name="l00474"></a>00474       <span class="keywordflow">if</span>( <a class="code" href="popupmenu_8cpp.html#df0f3777f20c12c5e1656334ad7dc416">fWaitingForLButtonRelease</a> )
<a name="l00475"></a>00475       {
<a name="l00476"></a>00476             <span class="keywordflow">if</span>( !<a class="code" href="input_8cpp.html#fb2dcc39ce3dcb01df1593baa94e3c62">gfLeftButtonState</a> )
<a name="l00477"></a>00477             {
<a name="l00478"></a>00478                   <a class="code" href="popupmenu_8cpp.html#df0f3777f20c12c5e1656334ad7dc416">fWaitingForLButtonRelease</a> = FALSE;
<a name="l00479"></a>00479                   <span class="keywordflow">return</span> FALSE;
<a name="l00480"></a>00480             }
<a name="l00481"></a>00481             <span class="keywordflow">return</span> TRUE;
<a name="l00482"></a>00482       }
<a name="l00483"></a>00483       <a class="code" href="popupmenu_8cpp.html#bdfc512bef94c1c3fb95fed6762c3528">PopupMenuHandle</a>();
<a name="l00484"></a>00484       <a class="code" href="popupmenu_8cpp.html#b9748180bec875bd9beb4d64fd0cf6f3">RenderPopupMenu</a>();
<a name="l00485"></a>00485       <a class="code" href="video_8cpp.html#4ed7790da612ff97bf9c05cf186823bc">InvalidateRegion</a>( <a class="code" href="popupmenu_8cpp.html#6863733f90425b49ec95a46d5329d753">gPopup</a>.<a class="code" href="structcurrentPopupMenuInformation.html#9d466de3ec3573e83ba294351178e248">usLeft</a>, <a class="code" href="popupmenu_8cpp.html#6863733f90425b49ec95a46d5329d753">gPopup</a>.<a class="code" href="structcurrentPopupMenuInformation.html#b29012ad5c9bf01c3b5a5bec9b1f130a">usTop</a>, <a class="code" href="popupmenu_8cpp.html#6863733f90425b49ec95a46d5329d753">gPopup</a>.<a class="code" href="structcurrentPopupMenuInformation.html#4bfeb6fdd0f32e1ced06f51d8bcc4dfc">usRight</a>, <a class="code" href="popupmenu_8cpp.html#6863733f90425b49ec95a46d5329d753">gPopup</a>.<a class="code" href="structcurrentPopupMenuInformation.html#58227169591938c92f43219f75aad348">usBottom</a> );
<a name="l00486"></a>00486       <a class="code" href="Render_01Dirty_8cpp.html#8db36a227ea1a41076c6dc7de2a28084">ExecuteBaseDirtyRectQueue</a>();
<a name="l00487"></a>00487       <a class="code" href="video_8cpp.html#cb214b937b77ff6e2f5f80a7fe45ea5a">EndFrameBufferRender</a>( );
<a name="l00488"></a>00488       <span class="keywordflow">return</span> TRUE;
<a name="l00489"></a>00489 }
<a name="l00490"></a>00490 
<a name="l00491"></a>00491 <span class="preprocessor">#endif</span>
<a name="l00492"></a>00492 <span class="preprocessor"></span>
<a name="l00493"></a>00493 
<a name="l00494"></a>00494 
<a name="l00495"></a>00495  
<a name="l00496"></a>00496 
<a name="l00497"></a>00497 
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Sat Sep 9 13:48:48 2006 for Build by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.4.7 </small></address>
</body>
</html>
